(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();/**
* @vue/shared v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function f3(t,e){const r=new Set(t.split(","));return n=>r.has(n)}const oa={},x_=[],Oa=()=>{},rae=()=>!1,_M=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),d3=t=>t.startsWith("onUpdate:"),Ba=Object.assign,p3=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},nae=Object.prototype.hasOwnProperty,ni=(t,e)=>nae.call(t,e),Wr=Array.isArray,b_=t=>db(t)==="[object Map]",yM=t=>db(t)==="[object Set]",K4=t=>db(t)==="[object Date]",Rn=t=>typeof t=="function",wi=t=>typeof t=="string",ch=t=>typeof t=="symbol",fi=t=>t!==null&&typeof t=="object",LW=t=>(fi(t)||Rn(t))&&Rn(t.then)&&Rn(t.catch),RW=Object.prototype.toString,db=t=>RW.call(t),iae=t=>db(t).slice(8,-1),kW=t=>db(t)==="[object Object]",g3=t=>wi(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Xx=f3(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),xM=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},aae=/-(\w)/g,_u=xM(t=>t.replace(aae,(e,r)=>r?r.toUpperCase():"")),oae=/\B([A-Z])/g,K_=xM(t=>t.replace(oae,"-$1").toLowerCase()),pb=xM(t=>t.charAt(0).toUpperCase()+t.slice(1)),xA=xM(t=>t?`on${pb(t)}`:""),fd=(t,e)=>!Object.is(t,e),bA=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},OW=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},sae=t=>{const e=parseFloat(t);return isNaN(e)?t:e},lae=t=>{const e=wi(t)?Number(t):NaN;return isNaN(e)?t:e};let J4;const zW=()=>J4||(J4=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function va(t){if(Wr(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],i=wi(n)?fae(n):va(n);if(i)for(const a in i)e[a]=i[a]}return e}else if(wi(t)||fi(t))return t}const uae=/;(?![^(]*\))/g,cae=/:([^]+)/,hae=/\/\*[^]*?\*\//g;function fae(t){const e={};return t.replace(hae,"").split(uae).forEach(r=>{if(r){const n=r.split(cae);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Lr(t){let e="";if(wi(t))e=t;else if(Wr(t))for(let r=0;r<t.length;r++){const n=Lr(t[r]);n&&(e+=n+" ")}else if(fi(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}const dae="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",pae=f3(dae);function BW(t){return!!t||t===""}function gae(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=bM(t[n],e[n]);return r}function bM(t,e){if(t===e)return!0;let r=K4(t),n=K4(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=ch(t),n=ch(e),r||n)return t===e;if(r=Wr(t),n=Wr(e),r||n)return r&&n?gae(t,e):!1;if(r=fi(t),n=fi(e),r||n){if(!r||!n)return!1;const i=Object.keys(t).length,a=Object.keys(e).length;if(i!==a)return!1;for(const l in t){const c=t.hasOwnProperty(l),o=e.hasOwnProperty(l);if(c&&!o||!c&&o||!bM(t[l],e[l]))return!1}}return String(t)===String(e)}function FW(t,e){return t.findIndex(r=>bM(r,e))}const _n=t=>wi(t)?t:t==null?"":Wr(t)||fi(t)&&(t.toString===RW||!Rn(t.toString))?JSON.stringify(t,NW,2):String(t),NW=(t,e)=>e&&e.__v_isRef?NW(t,e.value):b_(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,i],a)=>(r[FD(n,a)+" =>"]=i,r),{})}:yM(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>FD(r))}:ch(e)?FD(e):fi(e)&&!Wr(e)&&!kW(e)?String(e):e,FD=(t,e="")=>{var r;return ch(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ws;class VW{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ws,!e&&Ws&&(this.index=(Ws.scopes||(Ws.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const r=Ws;try{return Ws=this,e()}finally{Ws=r}}}on(){Ws=this}off(){Ws=this.parent}stop(e){if(this._active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function GW(t){return new VW(t)}function vae(t,e=Ws){e&&e.active&&e.effects.push(t)}function v3(){return Ws}function m3(t){Ws&&Ws.cleanups.push(t)}let Lg;class _3{constructor(e,r,n,i){this.fn=e,this.trigger=r,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=5,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,vae(this,i)}get dirty(){if(this._dirtyLevel===2)return!1;if(this._dirtyLevel===3||this._dirtyLevel===4){this._dirtyLevel=1,wd();for(let e=0;e<this._depsLength;e++){const r=this.deps[e];if(r.computed){if(r.computed.effect._dirtyLevel===2)return!0;if(mae(r.computed),this._dirtyLevel>=5)break}}this._dirtyLevel===1&&(this._dirtyLevel=0),Sd()}return this._dirtyLevel>=5}set dirty(e){this._dirtyLevel=e?5:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=id,r=Lg;try{return id=!0,Lg=this,this._runnings++,eV(this),this.fn()}finally{tV(this),this._runnings--,Lg=r,id=e}}stop(){this.active&&(eV(this),tV(this),this.onStop&&this.onStop(),this.active=!1)}}function mae(t){return t.value}function eV(t){t._trackId++,t._depsLength=0}function tV(t){if(t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)UW(t.deps[e],t);t.deps.length=t._depsLength}}function UW(t,e){const r=t.get(e);r!==void 0&&e._trackId!==r&&(t.delete(e),t.size===0&&t.cleanup())}let id=!0,zR=0;const $W=[];function wd(){$W.push(id),id=!1}function Sd(){const t=$W.pop();id=t===void 0?!0:t}function y3(){zR++}function x3(){for(zR--;!zR&&BR.length;)BR.shift()()}function HW(t,e,r){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const n=t.deps[t._depsLength];n!==e?(n&&UW(n,t),t.deps[t._depsLength++]=e):t._depsLength++}}const BR=[];function jW(t,e,r){y3();for(const n of t.keys()){if(!t.computed&&n.computed&&t.get(n)===n._trackId&&n._runnings>0){n._dirtyLevel=2;continue}let i;n._dirtyLevel<e&&(i??(i=t.get(n)===n._trackId))&&(n._shouldSchedule||(n._shouldSchedule=n._dirtyLevel===0),n.computed&&n._dirtyLevel===2&&(n._shouldSchedule=!0),n._dirtyLevel=e),n._shouldSchedule&&(i??(i=t.get(n)===n._trackId))&&(n.trigger(),(!n._runnings||n.allowRecurse)&&n._dirtyLevel!==3&&(n._shouldSchedule=!1,n.scheduler&&BR.push(n.scheduler)))}x3()}const WW=(t,e)=>{const r=new Map;return r.cleanup=t,r.computed=e,r},iC=new WeakMap,Rg=Symbol(""),FR=Symbol("");function Ms(t,e,r){if(id&&Lg){let n=iC.get(t);n||iC.set(t,n=new Map);let i=n.get(r);i||n.set(r,i=WW(()=>n.delete(r))),HW(Lg,i)}}function nh(t,e,r,n,i,a){const l=iC.get(t);if(!l)return;let c=[];if(e==="clear")c=[...l.values()];else if(r==="length"&&Wr(t)){const o=Number(n);l.forEach((d,g)=>{(g==="length"||!ch(g)&&g>=o)&&c.push(d)})}else switch(r!==void 0&&c.push(l.get(r)),e){case"add":Wr(t)?g3(r)&&c.push(l.get("length")):(c.push(l.get(Rg)),b_(t)&&c.push(l.get(FR)));break;case"delete":Wr(t)||(c.push(l.get(Rg)),b_(t)&&c.push(l.get(FR)));break;case"set":b_(t)&&c.push(l.get(Rg));break}y3();for(const o of c)o&&jW(o,5);x3()}function _ae(t,e){const r=iC.get(t);return r&&r.get(e)}const yae=f3("__proto__,__v_isRef,__isVue"),ZW=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ch)),rV=xae();function xae(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...r){const n=mi(this);for(let a=0,l=this.length;a<l;a++)Ms(n,"get",a+"");const i=n[e](...r);return i===-1||i===!1?n[e](...r.map(mi)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...r){wd(),y3();const n=mi(this)[e].apply(this,r);return x3(),Sd(),n}}),t}function bae(t){ch(t)||(t=String(t));const e=mi(this);return Ms(e,"has",t),e.hasOwnProperty(t)}class qW{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){const i=this._isReadonly,a=this._isShallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return a;if(r==="__v_raw")return n===(i?a?kae:KW:a?QW:XW).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const l=Wr(e);if(!i){if(l&&ni(rV,r))return Reflect.get(rV,r,n);if(r==="hasOwnProperty")return bae}const c=Reflect.get(e,r,n);return(ch(r)?ZW.has(r):yae(r))||(i||Ms(e,"get",r),a)?c:qi(c)?l&&g3(r)?c:c.value:fi(c)?i?gb(c):gc(c):c}}class YW extends qW{constructor(e=!1){super(!1,e)}set(e,r,n,i){let a=e[r];if(!this._isShallow){const o=T1(a);if(!aC(n)&&!T1(n)&&(a=mi(a),n=mi(n)),!Wr(e)&&qi(a)&&!qi(n))return o?!1:(a.value=n,!0)}const l=Wr(e)&&g3(r)?Number(r)<e.length:ni(e,r),c=Reflect.set(e,r,n,i);return e===mi(i)&&(l?fd(n,a)&&nh(e,"set",r,n):nh(e,"add",r,n)),c}deleteProperty(e,r){const n=ni(e,r);e[r];const i=Reflect.deleteProperty(e,r);return i&&n&&nh(e,"delete",r,void 0),i}has(e,r){const n=Reflect.has(e,r);return(!ch(r)||!ZW.has(r))&&Ms(e,"has",r),n}ownKeys(e){return Ms(e,"iterate",Wr(e)?"length":Rg),Reflect.ownKeys(e)}}class wae extends qW{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const Sae=new YW,Tae=new wae,Aae=new YW(!0);const b3=t=>t,wM=t=>Reflect.getPrototypeOf(t);function eT(t,e,r=!1,n=!1){t=t.__v_raw;const i=mi(t),a=mi(e);r||(fd(e,a)&&Ms(i,"get",e),Ms(i,"get",a));const{has:l}=wM(i),c=n?b3:r?A3:A1;if(l.call(i,e))return c(t.get(e));if(l.call(i,a))return c(t.get(a));t!==i&&t.get(e)}function tT(t,e=!1){const r=this.__v_raw,n=mi(r),i=mi(t);return e||(fd(t,i)&&Ms(n,"has",t),Ms(n,"has",i)),t===i?r.has(t):r.has(t)||r.has(i)}function rT(t,e=!1){return t=t.__v_raw,!e&&Ms(mi(t),"iterate",Rg),Reflect.get(t,"size",t)}function nV(t){t=mi(t);const e=mi(this);return wM(e).has.call(e,t)||(e.add(t),nh(e,"add",t,t)),this}function iV(t,e){e=mi(e);const r=mi(this),{has:n,get:i}=wM(r);let a=n.call(r,t);a||(t=mi(t),a=n.call(r,t));const l=i.call(r,t);return r.set(t,e),a?fd(e,l)&&nh(r,"set",t,e):nh(r,"add",t,e),this}function aV(t){const e=mi(this),{has:r,get:n}=wM(e);let i=r.call(e,t);i||(t=mi(t),i=r.call(e,t)),n&&n.call(e,t);const a=e.delete(t);return i&&nh(e,"delete",t,void 0),a}function oV(){const t=mi(this),e=t.size!==0,r=t.clear();return e&&nh(t,"clear",void 0,void 0),r}function nT(t,e){return function(n,i){const a=this,l=a.__v_raw,c=mi(l),o=e?b3:t?A3:A1;return!t&&Ms(c,"iterate",Rg),l.forEach((d,g)=>n.call(i,o(d),o(g),a))}}function iT(t,e,r){return function(...n){const i=this.__v_raw,a=mi(i),l=b_(a),c=t==="entries"||t===Symbol.iterator&&l,o=t==="keys"&&l,d=i[t](...n),g=r?b3:e?A3:A1;return!e&&Ms(a,"iterate",o?FR:Rg),{next(){const{value:m,done:y}=d.next();return y?{value:m,done:y}:{value:c?[g(m[0]),g(m[1])]:g(m),done:y}},[Symbol.iterator](){return this}}}}function _f(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Cae(){const t={get(a){return eT(this,a)},get size(){return rT(this)},has:tT,add:nV,set:iV,delete:aV,clear:oV,forEach:nT(!1,!1)},e={get(a){return eT(this,a,!1,!0)},get size(){return rT(this)},has:tT,add:nV,set:iV,delete:aV,clear:oV,forEach:nT(!1,!0)},r={get(a){return eT(this,a,!0)},get size(){return rT(this,!0)},has(a){return tT.call(this,a,!0)},add:_f("add"),set:_f("set"),delete:_f("delete"),clear:_f("clear"),forEach:nT(!0,!1)},n={get(a){return eT(this,a,!0,!0)},get size(){return rT(this,!0)},has(a){return tT.call(this,a,!0)},add:_f("add"),set:_f("set"),delete:_f("delete"),clear:_f("clear"),forEach:nT(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{t[a]=iT(a,!1,!1),r[a]=iT(a,!0,!1),e[a]=iT(a,!1,!0),n[a]=iT(a,!0,!0)}),[t,r,e,n]}const[Mae,Iae,Eae,Dae]=Cae();function w3(t,e){const r=e?t?Dae:Eae:t?Iae:Mae;return(n,i,a)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?n:Reflect.get(ni(r,i)&&i in n?r:n,i,a)}const Pae={get:w3(!1,!1)},Lae={get:w3(!1,!0)},Rae={get:w3(!0,!1)};const XW=new WeakMap,QW=new WeakMap,KW=new WeakMap,kae=new WeakMap;function Oae(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function zae(t){return t.__v_skip||!Object.isExtensible(t)?0:Oae(iae(t))}function gc(t){return T1(t)?t:S3(t,!1,Sae,Pae,XW)}function Bae(t){return S3(t,!1,Aae,Lae,QW)}function gb(t){return S3(t,!0,Tae,Rae,KW)}function S3(t,e,r,n,i){if(!fi(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const a=i.get(t);if(a)return a;const l=zae(t);if(l===0)return t;const c=new Proxy(t,l===2?n:r);return i.set(t,c),c}function ad(t){return T1(t)?ad(t.__v_raw):!!(t&&t.__v_isReactive)}function T1(t){return!!(t&&t.__v_isReadonly)}function aC(t){return!!(t&&t.__v_isShallow)}function JW(t){return t?!!t.__v_raw:!1}function mi(t){const e=t&&t.__v_raw;return e?mi(e):t}function T3(t){return Object.isExtensible(t)&&OW(t,"__v_skip",!0),t}const A1=t=>fi(t)?gc(t):t,A3=t=>fi(t)?gb(t):t;class e7{constructor(e,r,n,i){this.getter=e,this._setter=r,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new _3(()=>e(this._value),()=>wA(this,this.effect._dirtyLevel===3?3:4)),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const e=mi(this);return(!e._cacheable||e.effect.dirty)&&fd(e._value,e._value=e.effect.run())&&wA(e,5),t7(e),e.effect._dirtyLevel>=2&&wA(e,3),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function Fae(t,e,r=!1){let n,i;const a=Rn(t);return a?(n=t,i=Oa):(n=t.get,i=t.set),new e7(n,i,a||!i,r)}function t7(t){var e;id&&Lg&&(t=mi(t),HW(Lg,(e=t.dep)!=null?e:t.dep=WW(()=>t.dep=void 0,t instanceof e7?t:void 0)))}function wA(t,e=5,r,n){t=mi(t);const i=t.dep;i&&jW(i,e)}function qi(t){return!!(t&&t.__v_isRef===!0)}function at(t){return r7(t,!1)}function C3(t){return r7(t,!0)}function r7(t,e){return qi(t)?t:new Nae(t,e)}class Nae{constructor(e,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?e:mi(e),this._value=r?e:A1(e)}get value(){return t7(this),this._value}set value(e){const r=this.__v_isShallow||aC(e)||T1(e);e=r?e:mi(e),fd(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=r?e:A1(e),wA(this,5))}}function Pe(t){return qi(t)?t.value:t}const Vae={get:(t,e,r)=>Pe(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const i=t[e];return qi(i)&&!qi(r)?(i.value=r,!0):Reflect.set(t,e,r,n)}};function n7(t){return ad(t)?t:new Proxy(t,Vae)}function M3(t){const e=Wr(t)?new Array(t.length):{};for(const r in t)e[r]=i7(t,r);return e}class Gae{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return _ae(mi(this._object),this._key)}}class Uae{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Il(t,e,r){return qi(t)?t:Rn(t)?new Uae(t):fi(t)&&arguments.length>1?i7(t,e,r):at(t)}function i7(t,e,r){const n=t[e];return qi(n)?n:new Gae(t,e,r)}/**
* @vue/runtime-core v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function od(t,e,r,n){try{return n?t(...n):t()}catch(i){SM(i,e,r)}}function Dl(t,e,r,n){if(Rn(t)){const i=od(t,e,r,n);return i&&LW(i)&&i.catch(a=>{SM(a,e,r)}),i}if(Wr(t)){const i=[];for(let a=0;a<t.length;a++)i.push(Dl(t[a],e,r,n));return i}}function SM(t,e,r,n=!0){const i=e?e.vnode:null;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;a;){const d=a.ec;if(d){for(let g=0;g<d.length;g++)if(d[g](t,l,c)===!1)return}a=a.parent}const o=e.appContext.config.errorHandler;if(o){wd(),od(o,null,10,[t,l,c]),Sd();return}}$ae(t,r,i,n)}function $ae(t,e,r,n=!0){console.error(t)}let C1=!1,NR=!1;const zo=[];let Xu=0;const w_=[];let Bf=null,pg=0;const a7=Promise.resolve();let I3=null;function Fa(t){const e=I3||a7;return t?e.then(this?t.bind(this):t):e}function Hae(t){let e=Xu+1,r=zo.length;for(;e<r;){const n=e+r>>>1,i=zo[n],a=M1(i);a<t||a===t&&i.pre?e=n+1:r=n}return e}function E3(t){(!zo.length||!zo.includes(t,C1&&t.allowRecurse?Xu+1:Xu))&&(t.id==null?zo.push(t):zo.splice(Hae(t.id),0,t),o7())}function o7(){!C1&&!NR&&(NR=!0,I3=a7.then(l7))}function jae(t){const e=zo.indexOf(t);e>Xu&&zo.splice(e,1)}function Wae(t){Wr(t)?w_.push(...t):(!Bf||!Bf.includes(t,t.allowRecurse?pg+1:pg))&&w_.push(t),o7()}function sV(t,e,r=C1?Xu+1:0){for(;r<zo.length;r++){const n=zo[r];if(n&&n.pre){if(t&&n.id!==t.uid)continue;zo.splice(r,1),r--,n()}}}function s7(t){if(w_.length){const e=[...new Set(w_)].sort((r,n)=>M1(r)-M1(n));if(w_.length=0,Bf){Bf.push(...e);return}for(Bf=e,pg=0;pg<Bf.length;pg++){const r=Bf[pg];r.active!==!1&&r()}Bf=null,pg=0}}const M1=t=>t.id==null?1/0:t.id,Zae=(t,e)=>{const r=M1(t)-M1(e);if(r===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return r};function l7(t){NR=!1,C1=!0,zo.sort(Zae);try{for(Xu=0;Xu<zo.length;Xu++){const e=zo[Xu];e&&e.active!==!1&&od(e,null,14)}}finally{Xu=0,zo.length=0,s7(),C1=!1,I3=null,(zo.length||w_.length)&&l7()}}function qae(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||oa;let i=r;const a=e.startsWith("update:"),l=a&&e.slice(7);if(l&&l in n){const g=`${l==="modelValue"?"model":l}Modifiers`,{number:m,trim:y}=n[g]||oa;y&&(i=r.map(x=>wi(x)?x.trim():x)),m&&(i=r.map(sae))}let c,o=n[c=xA(e)]||n[c=xA(_u(e))];!o&&a&&(o=n[c=xA(K_(e))]),o&&Dl(o,t,6,i);const d=n[c+"Once"];if(d){if(!t.emitted)t.emitted={};else if(t.emitted[c])return;t.emitted[c]=!0,Dl(d,t,6,i)}}function u7(t,e,r=!1){const n=e.emitsCache,i=n.get(t);if(i!==void 0)return i;const a=t.emits;let l={},c=!1;if(!Rn(t)){const o=d=>{const g=u7(d,e,!0);g&&(c=!0,Ba(l,g))};!r&&e.mixins.length&&e.mixins.forEach(o),t.extends&&o(t.extends),t.mixins&&t.mixins.forEach(o)}return!a&&!c?(fi(t)&&n.set(t,null),null):(Wr(a)?a.forEach(o=>l[o]=null):Ba(l,a),fi(t)&&n.set(t,l),l)}function TM(t,e){return!t||!_M(e)?!1:(e=e.slice(2).replace(/Once$/,""),ni(t,e[0].toLowerCase()+e.slice(1))||ni(t,K_(e))||ni(t,e))}let Qa=null,AM=null;function oC(t){const e=Qa;return Qa=t,AM=t&&t.type.__scopeId||null,e}function c7(t){AM=t}function h7(){AM=null}function pt(t,e=Qa,r){if(!e||t._n)return t;const n=(...i)=>{n._d&&SV(-1);const a=oC(e);let l;try{l=t(...i)}finally{oC(a),n._d&&SV(1)}return l};return n._n=!0,n._c=!0,n._d=!0,n}function ND(t){const{type:e,vnode:r,proxy:n,withProxy:i,propsOptions:[a],slots:l,attrs:c,emit:o,render:d,renderCache:g,props:m,data:y,setupState:x,ctx:A,inheritAttrs:M}=t,D=oC(t);let P,O;try{if(r.shapeFlag&4){const V=i||n,H=V;P=Yu(d.call(H,V,g,m,x,y,A)),O=c}else{const V=e;P=Yu(V.length>1?V(m,{attrs:c,slots:l,emit:o}):V(m,null)),O=e.props?c:Yae(c)}}catch(V){e1.length=0,SM(V,t,1),P=He(Bo)}let z=P;if(O&&M!==!1){const V=Object.keys(O),{shapeFlag:H}=z;V.length&&H&7&&(a&&V.some(d3)&&(O=Xae(O,a)),z=hh(z,O,!1,!0))}return r.dirs&&(z=hh(z,null,!1,!0),z.dirs=z.dirs?z.dirs.concat(r.dirs):r.dirs),r.transition&&(z.transition=r.transition),P=z,oC(D),P}const Yae=t=>{let e;for(const r in t)(r==="class"||r==="style"||_M(r))&&((e||(e={}))[r]=t[r]);return e},Xae=(t,e)=>{const r={};for(const n in t)(!d3(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function Qae(t,e,r){const{props:n,children:i,component:a}=t,{props:l,children:c,patchFlag:o}=e,d=a.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&o>=0){if(o&1024)return!0;if(o&16)return n?lV(n,l,d):!!l;if(o&8){const g=e.dynamicProps;for(let m=0;m<g.length;m++){const y=g[m];if(l[y]!==n[y]&&!TM(d,y))return!0}}}else return(i||c)&&(!c||!c.$stable)?!0:n===l?!1:n?l?lV(n,l,d):!0:!!l;return!1}function lV(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let i=0;i<n.length;i++){const a=n[i];if(e[a]!==t[a]&&!TM(r,a))return!0}return!1}function Kae({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const D3="components",Jae="directives";function Zs(t,e){return P3(D3,t,!0,e)||t}const f7=Symbol.for("v-ndc");function sd(t){return wi(t)?P3(D3,t,!1)||t:t||f7}function d7(t){return P3(Jae,t)}function P3(t,e,r=!0,n=!1){const i=Qa||uo;if(i){const a=i.type;if(t===D3){const c=Zoe(a,!1);if(c&&(c===e||c===_u(e)||c===pb(_u(e))))return a}const l=uV(i[t]||a[t],e)||uV(i.appContext[t],e);return!l&&n?a:l}}function uV(t,e){return t&&(t[e]||t[_u(e)]||t[pb(_u(e))])}const eoe=t=>t.__isSuspense;function toe(t,e){e&&e.pendingBranch?Wr(t)?e.effects.push(...t):e.effects.push(t):Wae(t)}function CM(t,e,r=uo,n=!1){if(r){const i=r[t]||(r[t]=[]),a=e.__weh||(e.__weh=(...l)=>{wd();const c=vb(r),o=Dl(e,r,t,l);return c(),Sd(),o});return n?i.unshift(a):i.push(a),a}}const bh=t=>(e,r=uo)=>{(!DM||t==="sp")&&CM(t,(...n)=>e(...n),r)},MM=bh("bm"),Vn=bh("m"),roe=bh("bu"),IM=bh("u"),Es=bh("bum"),Td=bh("um"),noe=bh("sp"),ioe=bh("rtg"),aoe=bh("rtc");function ooe(t,e=uo){CM("ec",t,e)}function es(t,e){if(Qa===null)return t;const r=PM(Qa),n=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[a,l,c,o=oa]=e[i];a&&(Rn(a)&&(a={mounted:a,updated:a}),a.deep&&$f(l),n.push({dir:a,instance:r,value:l,oldValue:void 0,arg:c,modifiers:o}))}return t}function Rp(t,e,r,n){const i=t.dirs,a=e&&e.dirs;for(let l=0;l<i.length;l++){const c=i[l];a&&(c.oldValue=a[l].value);let o=c.dir[n];o&&(wd(),Dl(o,r,8,[t.el,c,t,e]),Sd())}}function cV(t,e,r,n){let i;const a=r;if(Wr(t)||wi(t)){i=new Array(t.length);for(let l=0,c=t.length;l<c;l++)i[l]=e(t[l],l,void 0,a)}else if(typeof t=="number"){i=new Array(t);for(let l=0;l<t;l++)i[l]=e(l+1,l,void 0,a)}else if(fi(t))if(t[Symbol.iterator])i=Array.from(t,(l,c)=>e(l,c,void 0,a));else{const l=Object.keys(t);i=new Array(l.length);for(let c=0,o=l.length;c<o;c++){const d=l[c];i[c]=e(t[d],d,c,a)}}else i=[];return i}/*! #__NO_SIDE_EFFECTS__ */function Mr(t,e){return Rn(t)?Ba({name:t.name},e,{setup:t}):t}const Qx=t=>!!t.type.__asyncLoader;function Cn(t,e,r={},n,i){if(Qa.isCE||Qa.parent&&Qx(Qa.parent)&&Qa.parent.isCE)return e!=="default"&&(r.name=e),He("slot",r,n&&n());let a=t[e];a&&a._c&&(a._d=!1),Nt();const l=a&&p7(a(r)),c=kr(ha,{key:r.key||l&&l.key||`_${e}`},l||(n?n():[]),l&&t._===1?64:-2);return c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),a&&a._c&&(a._d=!0),c}function p7(t){return t.some(e=>Zg(e)?!(e.type===Bo||e.type===ha&&!p7(e.children)):!0)?t:null}function soe(t,e){const r={};for(const n in t)r[xA(n)]=t[n];return r}const VR=t=>t?B7(t)?PM(t):VR(t.parent):null,Kx=Ba(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>VR(t.parent),$root:t=>VR(t.root),$emit:t=>t.emit,$options:t=>L3(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,E3(t.update)}),$nextTick:t=>t.n||(t.n=Fa.bind(t.proxy)),$watch:t=>Eoe.bind(t)}),VD=(t,e)=>t!==oa&&!t.__isScriptSetup&&ni(t,e),loe={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:i,props:a,accessCache:l,type:c,appContext:o}=t;let d;if(e[0]!=="$"){const x=l[e];if(x!==void 0)switch(x){case 1:return n[e];case 2:return i[e];case 4:return r[e];case 3:return a[e]}else{if(VD(n,e))return l[e]=1,n[e];if(i!==oa&&ni(i,e))return l[e]=2,i[e];if((d=t.propsOptions[0])&&ni(d,e))return l[e]=3,a[e];if(r!==oa&&ni(r,e))return l[e]=4,r[e];GR&&(l[e]=0)}}const g=Kx[e];let m,y;if(g)return e==="$attrs"&&Ms(t.attrs,"get",""),g(t);if((m=c.__cssModules)&&(m=m[e]))return m;if(r!==oa&&ni(r,e))return l[e]=4,r[e];if(y=o.config.globalProperties,ni(y,e))return y[e]},set({_:t},e,r){const{data:n,setupState:i,ctx:a}=t;return VD(i,e)?(i[e]=r,!0):n!==oa&&ni(n,e)?(n[e]=r,!0):ni(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(a[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:i,propsOptions:a}},l){let c;return!!r[l]||t!==oa&&ni(t,l)||VD(e,l)||(c=a[0])&&ni(c,l)||ni(n,l)||ni(Kx,l)||ni(i.config.globalProperties,l)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:ni(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}};function J_(){return uoe().slots}function uoe(){const t=Mi();return t.setupContext||(t.setupContext=N7(t))}function hV(t){return Wr(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}let GR=!0;function coe(t){const e=L3(t),r=t.proxy,n=t.ctx;GR=!1,e.beforeCreate&&fV(e.beforeCreate,t,"bc");const{data:i,computed:a,methods:l,watch:c,provide:o,inject:d,created:g,beforeMount:m,mounted:y,beforeUpdate:x,updated:A,activated:M,deactivated:D,beforeDestroy:P,beforeUnmount:O,destroyed:z,unmounted:V,render:H,renderTracked:$,renderTriggered:X,errorCaptured:W,serverPrefetch:Y,expose:J,inheritAttrs:re,components:ae,directives:pe,filters:de}=e;if(d&&hoe(d,n,null),l)for(const Ie in l){const Le=l[Ie];Rn(Le)&&(n[Ie]=Le.bind(r))}if(i){const Ie=i.call(r,r);fi(Ie)&&(t.data=gc(Ie))}if(GR=!0,a)for(const Ie in a){const Le=a[Ie],Ee=Rn(Le)?Le.bind(r,r):Rn(Le.get)?Le.get.bind(r,r):Oa,Ue=!Rn(Le)&&Rn(Le.set)?Le.set.bind(r):Oa,Ke=gt({get:Ee,set:Ue});Object.defineProperty(n,Ie,{enumerable:!0,configurable:!0,get:()=>Ke.value,set:We=>Ke.value=We})}if(c)for(const Ie in c)g7(c[Ie],n,r,Ie);if(o){const Ie=Rn(o)?o.call(r):o;Reflect.ownKeys(Ie).forEach(Le=>{No(Le,Ie[Le])})}g&&fV(g,t,"c");function me(Ie,Le){Wr(Le)?Le.forEach(Ee=>Ie(Ee.bind(r))):Le&&Ie(Le.bind(r))}if(me(MM,m),me(Vn,y),me(roe,x),me(IM,A),me(Doe,M),me(M7,D),me(ooe,W),me(aoe,$),me(ioe,X),me(Es,O),me(Td,V),me(noe,Y),Wr(J))if(J.length){const Ie=t.exposed||(t.exposed={});J.forEach(Le=>{Object.defineProperty(Ie,Le,{get:()=>r[Le],set:Ee=>r[Le]=Ee})})}else t.exposed||(t.exposed={});H&&t.render===Oa&&(t.render=H),re!=null&&(t.inheritAttrs=re),ae&&(t.components=ae),pe&&(t.directives=pe)}function hoe(t,e,r=Oa){Wr(t)&&(t=UR(t));for(const n in t){const i=t[n];let a;fi(i)?"default"in i?a=Mn(i.from||n,i.default,!0):a=Mn(i.from||n):a=Mn(i),qi(a)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>a.value,set:l=>a.value=l}):e[n]=a}}function fV(t,e,r){Dl(Wr(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function g7(t,e,r,n){const i=n.includes(".")?C7(r,n):()=>r[n];if(wi(t)){const a=e[t];Rn(a)&&un(i,a)}else if(Rn(t))un(i,t.bind(r));else if(fi(t))if(Wr(t))t.forEach(a=>g7(a,e,r,n));else{const a=Rn(t.handler)?t.handler.bind(r):e[t.handler];Rn(a)&&un(i,a,t)}}function L3(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:i,optionsCache:a,config:{optionMergeStrategies:l}}=t.appContext,c=a.get(e);let o;return c?o=c:!i.length&&!r&&!n?o=e:(o={},i.length&&i.forEach(d=>sC(o,d,l,!0)),sC(o,e,l)),fi(e)&&a.set(e,o),o}function sC(t,e,r,n=!1){const{mixins:i,extends:a}=e;a&&sC(t,a,r,!0),i&&i.forEach(l=>sC(t,l,r,!0));for(const l in e)if(!(n&&l==="expose")){const c=foe[l]||r&&r[l];t[l]=c?c(t[l],e[l]):e[l]}return t}const foe={data:dV,props:pV,emits:pV,methods:Bx,computed:Bx,beforeCreate:Yo,created:Yo,beforeMount:Yo,mounted:Yo,beforeUpdate:Yo,updated:Yo,beforeDestroy:Yo,beforeUnmount:Yo,destroyed:Yo,unmounted:Yo,activated:Yo,deactivated:Yo,errorCaptured:Yo,serverPrefetch:Yo,components:Bx,directives:Bx,watch:poe,provide:dV,inject:doe};function dV(t,e){return e?t?function(){return Ba(Rn(t)?t.call(this,this):t,Rn(e)?e.call(this,this):e)}:e:t}function doe(t,e){return Bx(UR(t),UR(e))}function UR(t){if(Wr(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function Yo(t,e){return t?[...new Set([].concat(t,e))]:e}function Bx(t,e){return t?Ba(Object.create(null),t,e):e}function pV(t,e){return t?Wr(t)&&Wr(e)?[...new Set([...t,...e])]:Ba(Object.create(null),hV(t),hV(e??{})):e}function poe(t,e){if(!t)return e;if(!e)return t;const r=Ba(Object.create(null),t);for(const n in e)r[n]=Yo(t[n],e[n]);return r}function v7(){return{app:null,config:{isNativeTag:rae,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let goe=0;function voe(t,e){return function(n,i=null){Rn(n)||(n=Ba({},n)),i!=null&&!fi(i)&&(i=null);const a=v7(),l=new WeakSet;let c=!1;const o=a.app={_uid:goe++,_component:n,_props:i,_container:null,_context:a,_instance:null,version:Yoe,get config(){return a.config},set config(d){},use(d,...g){return l.has(d)||(d&&Rn(d.install)?(l.add(d),d.install(o,...g)):Rn(d)&&(l.add(d),d(o,...g))),o},mixin(d){return a.mixins.includes(d)||a.mixins.push(d),o},component(d,g){return g?(a.components[d]=g,o):a.components[d]},directive(d,g){return g?(a.directives[d]=g,o):a.directives[d]},mount(d,g,m){if(!c){const y=He(n,i);return y.appContext=a,m===!0?m="svg":m===!1&&(m=void 0),g&&e?e(y,d):t(y,d,m),c=!0,o._container=d,d.__vue_app__=o,PM(y.component)}},unmount(){c&&(t(null,o._container),delete o._container.__vue_app__)},provide(d,g){return a.provides[d]=g,o},runWithContext(d){const g=S_;S_=o;try{return d()}finally{S_=g}}};return o}}let S_=null;function No(t,e){if(uo){let r=uo.provides;const n=uo.parent&&uo.parent.provides;n===r&&(r=uo.provides=Object.create(n)),r[t]=e}}function Mn(t,e,r=!1){const n=uo||Qa;if(n||S_){const i=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:S_._context.provides;if(i&&t in i)return i[t];if(arguments.length>1)return r&&Rn(e)?e.call(n&&n.proxy):e}}function moe(){return!!(uo||Qa||S_)}const m7={},_7=()=>Object.create(m7),y7=t=>Object.getPrototypeOf(t)===m7;function _oe(t,e,r,n=!1){const i={},a=_7();t.propsDefaults=Object.create(null),x7(t,e,i,a);for(const l in t.propsOptions[0])l in i||(i[l]=void 0);r?t.props=n?i:Bae(i):t.type.props?t.props=i:t.props=a,t.attrs=a}function yoe(t,e,r,n){const{props:i,attrs:a,vnode:{patchFlag:l}}=t,c=mi(i),[o]=t.propsOptions;let d=!1;if((n||l>0)&&!(l&16)){if(l&8){const g=t.vnode.dynamicProps;for(let m=0;m<g.length;m++){let y=g[m];if(TM(t.emitsOptions,y))continue;const x=e[y];if(o)if(ni(a,y))x!==a[y]&&(a[y]=x,d=!0);else{const A=_u(y);i[A]=$R(o,c,A,x,t,!1)}else x!==a[y]&&(a[y]=x,d=!0)}}}else{x7(t,e,i,a)&&(d=!0);let g;for(const m in c)(!e||!ni(e,m)&&((g=K_(m))===m||!ni(e,g)))&&(o?r&&(r[m]!==void 0||r[g]!==void 0)&&(i[m]=$R(o,c,m,void 0,t,!0)):delete i[m]);if(a!==c)for(const m in a)(!e||!ni(e,m))&&(delete a[m],d=!0)}d&&nh(t.attrs,"set","")}function x7(t,e,r,n){const[i,a]=t.propsOptions;let l=!1,c;if(e)for(let o in e){if(Xx(o))continue;const d=e[o];let g;i&&ni(i,g=_u(o))?!a||!a.includes(g)?r[g]=d:(c||(c={}))[g]=d:TM(t.emitsOptions,o)||(!(o in n)||d!==n[o])&&(n[o]=d,l=!0)}if(a){const o=mi(r),d=c||oa;for(let g=0;g<a.length;g++){const m=a[g];r[m]=$R(i,o,m,d[m],t,!ni(d,m))}}return l}function $R(t,e,r,n,i,a){const l=t[r];if(l!=null){const c=ni(l,"default");if(c&&n===void 0){const o=l.default;if(l.type!==Function&&!l.skipFactory&&Rn(o)){const{propsDefaults:d}=i;if(r in d)n=d[r];else{const g=vb(i);n=d[r]=o.call(null,e),g()}}else n=o}l[0]&&(a&&!c?n=!1:l[1]&&(n===""||n===K_(r))&&(n=!0))}return n}function b7(t,e,r=!1){const n=e.propsCache,i=n.get(t);if(i)return i;const a=t.props,l={},c=[];let o=!1;if(!Rn(t)){const g=m=>{o=!0;const[y,x]=b7(m,e,!0);Ba(l,y),x&&c.push(...x)};!r&&e.mixins.length&&e.mixins.forEach(g),t.extends&&g(t.extends),t.mixins&&t.mixins.forEach(g)}if(!a&&!o)return fi(t)&&n.set(t,x_),x_;if(Wr(a))for(let g=0;g<a.length;g++){const m=_u(a[g]);gV(m)&&(l[m]=oa)}else if(a)for(const g in a){const m=_u(g);if(gV(m)){const y=a[g],x=l[m]=Wr(y)||Rn(y)?{type:y}:Ba({},y);if(x){const A=_V(Boolean,x.type),M=_V(String,x.type);x[0]=A>-1,x[1]=M<0||A<M,(A>-1||ni(x,"default"))&&c.push(m)}}}const d=[l,c];return fi(t)&&n.set(t,d),d}function gV(t){return t[0]!=="$"&&!Xx(t)}function vV(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function mV(t,e){return vV(t)===vV(e)}function _V(t,e){return Wr(e)?e.findIndex(r=>mV(r,t)):Rn(e)&&mV(e,t)?0:-1}const w7=t=>t[0]==="_"||t==="$stable",R3=t=>Wr(t)?t.map(Yu):[Yu(t)],xoe=(t,e,r)=>{if(e._n)return e;const n=pt((...i)=>R3(e(...i)),r);return n._c=!1,n},S7=(t,e,r)=>{const n=t._ctx;for(const i in t){if(w7(i))continue;const a=t[i];if(Rn(a))e[i]=xoe(i,a,n);else if(a!=null){const l=R3(a);e[i]=()=>l}}},T7=(t,e)=>{const r=R3(e);t.slots.default=()=>r},boe=(t,e)=>{const r=t.slots=_7();if(t.vnode.shapeFlag&32){const n=e._;n?(Ba(r,e),OW(r,"_",n,!0)):S7(e,r)}else e&&T7(t,e)},woe=(t,e,r)=>{const{vnode:n,slots:i}=t;let a=!0,l=oa;if(n.shapeFlag&32){const c=e._;c?r&&c===1?a=!1:(Ba(i,e),!r&&c===1&&delete i._):(a=!e.$stable,S7(e,i)),l=e}else e&&(T7(t,e),l={default:1});if(a)for(const c in i)!w7(c)&&l[c]==null&&delete i[c]};function HR(t,e,r,n,i=!1){if(Wr(t)){t.forEach((y,x)=>HR(y,e&&(Wr(e)?e[x]:e),r,n,i));return}if(Qx(n)&&!i)return;const a=n.shapeFlag&4?PM(n.component):n.el,l=i?null:a,{i:c,r:o}=t,d=e&&e.r,g=c.refs===oa?c.refs={}:c.refs,m=c.setupState;if(d!=null&&d!==o&&(wi(d)?(g[d]=null,ni(m,d)&&(m[d]=null)):qi(d)&&(d.value=null)),Rn(o))od(o,c,12,[l,g]);else{const y=wi(o),x=qi(o);if(y||x){const A=()=>{if(t.f){const M=y?ni(m,o)?m[o]:g[o]:o.value;i?Wr(M)&&p3(M,a):Wr(M)?M.includes(a)||M.push(a):y?(g[o]=[a],ni(m,o)&&(m[o]=g[o])):(o.value=[a],t.k&&(g[t.k]=o.value))}else y?(g[o]=l,ni(m,o)&&(m[o]=l)):x&&(o.value=l,t.k&&(g[t.k]=l))};l?(A.id=-1,ys(A,r)):A()}}}const ys=toe;function Soe(t){return Toe(t)}function Toe(t,e){const r=zW();r.__VUE__=!0;const{insert:n,remove:i,patchProp:a,createElement:l,createText:c,createComment:o,setText:d,setElementText:g,parentNode:m,nextSibling:y,setScopeId:x=Oa,insertStaticContent:A}=t,M=(Oe,$e,ct,bt=null,At=null,Jt=null,mt=void 0,ht=null,er=!!$e.dynamicChildren)=>{if(Oe===$e)return;Oe&&!gg(Oe,$e)&&(bt=cr(Oe),We(Oe,At,Jt,!0),Oe=null),$e.patchFlag===-2&&(er=!1,$e.dynamicChildren=null);const{type:Bt,ref:qe,shapeFlag:ge}=$e;switch(Bt){case ey:D(Oe,$e,ct,bt);break;case Bo:P(Oe,$e,ct,bt);break;case $D:Oe==null&&O($e,ct,bt,mt);break;case ha:ae(Oe,$e,ct,bt,At,Jt,mt,ht,er);break;default:ge&1?H(Oe,$e,ct,bt,At,Jt,mt,ht,er):ge&6?pe(Oe,$e,ct,bt,At,Jt,mt,ht,er):(ge&64||ge&128)&&Bt.process(Oe,$e,ct,bt,At,Jt,mt,ht,er,Ut)}qe!=null&&At&&HR(qe,Oe&&Oe.ref,Jt,$e||Oe,!$e)},D=(Oe,$e,ct,bt)=>{if(Oe==null)n($e.el=c($e.children),ct,bt);else{const At=$e.el=Oe.el;$e.children!==Oe.children&&d(At,$e.children)}},P=(Oe,$e,ct,bt)=>{Oe==null?n($e.el=o($e.children||""),ct,bt):$e.el=Oe.el},O=(Oe,$e,ct,bt)=>{[Oe.el,Oe.anchor]=A(Oe.children,$e,ct,bt,Oe.el,Oe.anchor)},z=({el:Oe,anchor:$e},ct,bt)=>{let At;for(;Oe&&Oe!==$e;)At=y(Oe),n(Oe,ct,bt),Oe=At;n($e,ct,bt)},V=({el:Oe,anchor:$e})=>{let ct;for(;Oe&&Oe!==$e;)ct=y(Oe),i(Oe),Oe=ct;i($e)},H=(Oe,$e,ct,bt,At,Jt,mt,ht,er)=>{$e.type==="svg"?mt="svg":$e.type==="math"&&(mt="mathml"),Oe==null?$($e,ct,bt,At,Jt,mt,ht,er):Y(Oe,$e,At,Jt,mt,ht,er)},$=(Oe,$e,ct,bt,At,Jt,mt,ht)=>{let er,Bt;const{props:qe,shapeFlag:ge,transition:be,dirs:ke}=Oe;if(er=Oe.el=l(Oe.type,Jt,qe&&qe.is,qe),ge&8?g(er,Oe.children):ge&16&&W(Oe.children,er,null,bt,At,GD(Oe,Jt),mt,ht),ke&&Rp(Oe,null,bt,"created"),X(er,Oe,Oe.scopeId,mt,bt),qe){for(const ut in qe)ut!=="value"&&!Xx(ut)&&a(er,ut,null,qe[ut],Jt,Oe.children,bt,At,ur);"value"in qe&&a(er,"value",null,qe.value,Jt),(Bt=qe.onVnodeBeforeMount)&&Vu(Bt,bt,Oe)}ke&&Rp(Oe,null,bt,"beforeMount");const tt=Aoe(At,be);tt&&be.beforeEnter(er),n(er,$e,ct),((Bt=qe&&qe.onVnodeMounted)||tt||ke)&&ys(()=>{Bt&&Vu(Bt,bt,Oe),tt&&be.enter(er),ke&&Rp(Oe,null,bt,"mounted")},At)},X=(Oe,$e,ct,bt,At)=>{if(ct&&x(Oe,ct),bt)for(let Jt=0;Jt<bt.length;Jt++)x(Oe,bt[Jt]);if(At){let Jt=At.subTree;if($e===Jt){const mt=At.vnode;X(Oe,mt,mt.scopeId,mt.slotScopeIds,At.parent)}}},W=(Oe,$e,ct,bt,At,Jt,mt,ht,er=0)=>{for(let Bt=er;Bt<Oe.length;Bt++){const qe=Oe[Bt]=ht?Nf(Oe[Bt]):Yu(Oe[Bt]);M(null,qe,$e,ct,bt,At,Jt,mt,ht)}},Y=(Oe,$e,ct,bt,At,Jt,mt)=>{const ht=$e.el=Oe.el;let{patchFlag:er,dynamicChildren:Bt,dirs:qe}=$e;er|=Oe.patchFlag&16;const ge=Oe.props||oa,be=$e.props||oa;let ke;if(ct&&kp(ct,!1),(ke=be.onVnodeBeforeUpdate)&&Vu(ke,ct,$e,Oe),qe&&Rp($e,Oe,ct,"beforeUpdate"),ct&&kp(ct,!0),Bt?J(Oe.dynamicChildren,Bt,ht,ct,bt,GD($e,At),Jt):mt||Le(Oe,$e,ht,null,ct,bt,GD($e,At),Jt,!1),er>0){if(er&16)re(ht,$e,ge,be,ct,bt,At);else if(er&2&&ge.class!==be.class&&a(ht,"class",null,be.class,At),er&4&&a(ht,"style",ge.style,be.style,At),er&8){const tt=$e.dynamicProps;for(let ut=0;ut<tt.length;ut++){const St=tt[ut],vt=ge[St],Ye=be[St];(Ye!==vt||St==="value")&&a(ht,St,vt,Ye,At,Oe.children,ct,bt,ur)}}er&1&&Oe.children!==$e.children&&g(ht,$e.children)}else!mt&&Bt==null&&re(ht,$e,ge,be,ct,bt,At);((ke=be.onVnodeUpdated)||qe)&&ys(()=>{ke&&Vu(ke,ct,$e,Oe),qe&&Rp($e,Oe,ct,"updated")},bt)},J=(Oe,$e,ct,bt,At,Jt,mt)=>{for(let ht=0;ht<$e.length;ht++){const er=Oe[ht],Bt=$e[ht],qe=er.el&&(er.type===ha||!gg(er,Bt)||er.shapeFlag&70)?m(er.el):ct;M(er,Bt,qe,null,bt,At,Jt,mt,!0)}},re=(Oe,$e,ct,bt,At,Jt,mt)=>{if(ct!==bt){if(ct!==oa)for(const ht in ct)!Xx(ht)&&!(ht in bt)&&a(Oe,ht,ct[ht],null,mt,$e.children,At,Jt,ur);for(const ht in bt){if(Xx(ht))continue;const er=bt[ht],Bt=ct[ht];er!==Bt&&ht!=="value"&&a(Oe,ht,Bt,er,mt,$e.children,At,Jt,ur)}"value"in bt&&a(Oe,"value",ct.value,bt.value,mt)}},ae=(Oe,$e,ct,bt,At,Jt,mt,ht,er)=>{const Bt=$e.el=Oe?Oe.el:c(""),qe=$e.anchor=Oe?Oe.anchor:c("");let{patchFlag:ge,dynamicChildren:be,slotScopeIds:ke}=$e;ke&&(ht=ht?ht.concat(ke):ke),Oe==null?(n(Bt,ct,bt),n(qe,ct,bt),W($e.children||[],ct,qe,At,Jt,mt,ht,er)):ge>0&&ge&64&&be&&Oe.dynamicChildren?(J(Oe.dynamicChildren,be,ct,At,Jt,mt,ht),($e.key!=null||At&&$e===At.subTree)&&k3(Oe,$e,!0)):Le(Oe,$e,ct,qe,At,Jt,mt,ht,er)},pe=(Oe,$e,ct,bt,At,Jt,mt,ht,er)=>{$e.slotScopeIds=ht,Oe==null?$e.shapeFlag&512?At.ctx.activate($e,ct,bt,mt,er):de($e,ct,bt,At,Jt,mt,er):ve(Oe,$e,er)},de=(Oe,$e,ct,bt,At,Jt,mt)=>{const ht=Oe.component=$oe(Oe,bt,At);if(EM(Oe)&&(ht.ctx.renderer=Ut),Hoe(ht),ht.asyncDep){if(At&&At.registerDep(ht,me,mt),!Oe.el){const er=ht.subTree=He(Bo);P(null,er,$e,ct)}}else me(ht,Oe,$e,ct,At,Jt,mt)},ve=(Oe,$e,ct)=>{const bt=$e.component=Oe.component;if(Qae(Oe,$e,ct))if(bt.asyncDep&&!bt.asyncResolved){Ie(bt,$e,ct);return}else bt.next=$e,jae(bt.update),bt.effect.dirty=!0,bt.update();else $e.el=Oe.el,bt.vnode=$e},me=(Oe,$e,ct,bt,At,Jt,mt)=>{const ht=()=>{if(Oe.isMounted){let{next:qe,bu:ge,u:be,parent:ke,vnode:tt}=Oe;{const Dt=A7(Oe);if(Dt){qe&&(qe.el=tt.el,Ie(Oe,qe,mt)),Dt.asyncDep.then(()=>{Oe.isUnmounted||ht()});return}}let ut=qe,St;kp(Oe,!1),qe?(qe.el=tt.el,Ie(Oe,qe,mt)):qe=tt,ge&&bA(ge),(St=qe.props&&qe.props.onVnodeBeforeUpdate)&&Vu(St,ke,qe,tt),kp(Oe,!0);const vt=ND(Oe),Ye=Oe.subTree;Oe.subTree=vt,M(Ye,vt,m(Ye.el),cr(Ye),Oe,At,Jt),qe.el=vt.el,ut===null&&Kae(Oe,vt.el),be&&ys(be,At),(St=qe.props&&qe.props.onVnodeUpdated)&&ys(()=>Vu(St,ke,qe,tt),At)}else{let qe;const{el:ge,props:be}=$e,{bm:ke,m:tt,parent:ut}=Oe,St=Qx($e);if(kp(Oe,!1),ke&&bA(ke),!St&&(qe=be&&be.onVnodeBeforeMount)&&Vu(qe,ut,$e),kp(Oe,!0),ge&&br){const vt=()=>{Oe.subTree=ND(Oe),br(ge,Oe.subTree,Oe,At,null)};St?$e.type.__asyncLoader().then(()=>!Oe.isUnmounted&&vt()):vt()}else{const vt=Oe.subTree=ND(Oe);M(null,vt,ct,bt,Oe,At,Jt),$e.el=vt.el}if(tt&&ys(tt,At),!St&&(qe=be&&be.onVnodeMounted)){const vt=$e;ys(()=>Vu(qe,ut,vt),At)}($e.shapeFlag&256||ut&&Qx(ut.vnode)&&ut.vnode.shapeFlag&256)&&Oe.a&&ys(Oe.a,At),Oe.isMounted=!0,$e=ct=bt=null}},er=Oe.effect=new _3(ht,Oa,()=>E3(Bt),Oe.scope),Bt=Oe.update=()=>{er.dirty&&er.run()};Bt.id=Oe.uid,kp(Oe,!0),Bt()},Ie=(Oe,$e,ct)=>{$e.component=Oe;const bt=Oe.vnode.props;Oe.vnode=$e,Oe.next=null,yoe(Oe,$e.props,bt,ct),woe(Oe,$e.children,ct),wd(),sV(Oe),Sd()},Le=(Oe,$e,ct,bt,At,Jt,mt,ht,er=!1)=>{const Bt=Oe&&Oe.children,qe=Oe?Oe.shapeFlag:0,ge=$e.children,{patchFlag:be,shapeFlag:ke}=$e;if(be>0){if(be&128){Ue(Bt,ge,ct,bt,At,Jt,mt,ht,er);return}else if(be&256){Ee(Bt,ge,ct,bt,At,Jt,mt,ht,er);return}}ke&8?(qe&16&&ur(Bt,At,Jt),ge!==Bt&&g(ct,ge)):qe&16?ke&16?Ue(Bt,ge,ct,bt,At,Jt,mt,ht,er):ur(Bt,At,Jt,!0):(qe&8&&g(ct,""),ke&16&&W(ge,ct,bt,At,Jt,mt,ht,er))},Ee=(Oe,$e,ct,bt,At,Jt,mt,ht,er)=>{Oe=Oe||x_,$e=$e||x_;const Bt=Oe.length,qe=$e.length,ge=Math.min(Bt,qe);let be;for(be=0;be<ge;be++){const ke=$e[be]=er?Nf($e[be]):Yu($e[be]);M(Oe[be],ke,ct,null,At,Jt,mt,ht,er)}Bt>qe?ur(Oe,At,Jt,!0,!1,ge):W($e,ct,bt,At,Jt,mt,ht,er,ge)},Ue=(Oe,$e,ct,bt,At,Jt,mt,ht,er)=>{let Bt=0;const qe=$e.length;let ge=Oe.length-1,be=qe-1;for(;Bt<=ge&&Bt<=be;){const ke=Oe[Bt],tt=$e[Bt]=er?Nf($e[Bt]):Yu($e[Bt]);if(gg(ke,tt))M(ke,tt,ct,null,At,Jt,mt,ht,er);else break;Bt++}for(;Bt<=ge&&Bt<=be;){const ke=Oe[ge],tt=$e[be]=er?Nf($e[be]):Yu($e[be]);if(gg(ke,tt))M(ke,tt,ct,null,At,Jt,mt,ht,er);else break;ge--,be--}if(Bt>ge){if(Bt<=be){const ke=be+1,tt=ke<qe?$e[ke].el:bt;for(;Bt<=be;)M(null,$e[Bt]=er?Nf($e[Bt]):Yu($e[Bt]),ct,tt,At,Jt,mt,ht,er),Bt++}}else if(Bt>be)for(;Bt<=ge;)We(Oe[Bt],At,Jt,!0),Bt++;else{const ke=Bt,tt=Bt,ut=new Map;for(Bt=tt;Bt<=be;Bt++){const Nr=$e[Bt]=er?Nf($e[Bt]):Yu($e[Bt]);Nr.key!=null&&ut.set(Nr.key,Bt)}let St,vt=0;const Ye=be-tt+1;let Dt=!1,Vt=0;const jt=new Array(Ye);for(Bt=0;Bt<Ye;Bt++)jt[Bt]=0;for(Bt=ke;Bt<=ge;Bt++){const Nr=Oe[Bt];if(vt>=Ye){We(Nr,At,Jt,!0);continue}let Qr;if(Nr.key!=null)Qr=ut.get(Nr.key);else for(St=tt;St<=be;St++)if(jt[St-tt]===0&&gg(Nr,$e[St])){Qr=St;break}Qr===void 0?We(Nr,At,Jt,!0):(jt[Qr-tt]=Bt+1,Qr>=Vt?Vt=Qr:Dt=!0,M(Nr,$e[Qr],ct,null,At,Jt,mt,ht,er),vt++)}const Yt=Dt?Coe(jt):x_;for(St=Yt.length-1,Bt=Ye-1;Bt>=0;Bt--){const Nr=tt+Bt,Qr=$e[Nr],xn=Nr+1<qe?$e[Nr+1].el:bt;jt[Bt]===0?M(null,Qr,ct,xn,At,Jt,mt,ht,er):Dt&&(St<0||Bt!==Yt[St]?Ke(Qr,ct,xn,2):St--)}}},Ke=(Oe,$e,ct,bt,At=null)=>{const{el:Jt,type:mt,transition:ht,children:er,shapeFlag:Bt}=Oe;if(Bt&6){Ke(Oe.component.subTree,$e,ct,bt);return}if(Bt&128){Oe.suspense.move($e,ct,bt);return}if(Bt&64){mt.move(Oe,$e,ct,Ut);return}if(mt===ha){n(Jt,$e,ct);for(let ge=0;ge<er.length;ge++)Ke(er[ge],$e,ct,bt);n(Oe.anchor,$e,ct);return}if(mt===$D){z(Oe,$e,ct);return}if(bt!==2&&Bt&1&&ht)if(bt===0)ht.beforeEnter(Jt),n(Jt,$e,ct),ys(()=>ht.enter(Jt),At);else{const{leave:ge,delayLeave:be,afterLeave:ke}=ht,tt=()=>n(Jt,$e,ct),ut=()=>{ge(Jt,()=>{tt(),ke&&ke()})};be?be(Jt,tt,ut):ut()}else n(Jt,$e,ct)},We=(Oe,$e,ct,bt=!1,At=!1)=>{const{type:Jt,props:mt,ref:ht,children:er,dynamicChildren:Bt,shapeFlag:qe,patchFlag:ge,dirs:be,memoIndex:ke}=Oe;if(ht!=null&&HR(ht,null,ct,Oe,!0),ke!=null&&($e.renderCache[ke]=void 0),qe&256){$e.ctx.deactivate(Oe);return}const tt=qe&1&&be,ut=!Qx(Oe);let St;if(ut&&(St=mt&&mt.onVnodeBeforeUnmount)&&Vu(St,$e,Oe),qe&6)ar(Oe.component,ct,bt);else{if(qe&128){Oe.suspense.unmount(ct,bt);return}tt&&Rp(Oe,null,$e,"beforeUnmount"),qe&64?Oe.type.remove(Oe,$e,ct,At,Ut,bt):Bt&&(Jt!==ha||ge>0&&ge&64)?ur(Bt,$e,ct,!1,!0):(Jt===ha&&ge&384||!At&&qe&16)&&ur(er,$e,ct),bt&&Rt(Oe)}(ut&&(St=mt&&mt.onVnodeUnmounted)||tt)&&ys(()=>{St&&Vu(St,$e,Oe),tt&&Rp(Oe,null,$e,"unmounted")},ct)},Rt=Oe=>{const{type:$e,el:ct,anchor:bt,transition:At}=Oe;if($e===ha){Et(ct,bt);return}if($e===$D){V(Oe);return}const Jt=()=>{i(ct),At&&!At.persisted&&At.afterLeave&&At.afterLeave()};if(Oe.shapeFlag&1&&At&&!At.persisted){const{leave:mt,delayLeave:ht}=At,er=()=>mt(ct,Jt);ht?ht(Oe.el,Jt,er):er()}else Jt()},Et=(Oe,$e)=>{let ct;for(;Oe!==$e;)ct=y(Oe),i(Oe),Oe=ct;i($e)},ar=(Oe,$e,ct)=>{const{bum:bt,scope:At,update:Jt,subTree:mt,um:ht,m:er,a:Bt}=Oe;yV(er),yV(Bt),bt&&bA(bt),At.stop(),Jt&&(Jt.active=!1,We(mt,Oe,$e,ct)),ht&&ys(ht,$e),ys(()=>{Oe.isUnmounted=!0},$e),$e&&$e.pendingBranch&&!$e.isUnmounted&&Oe.asyncDep&&!Oe.asyncResolved&&Oe.suspenseId===$e.pendingId&&($e.deps--,$e.deps===0&&$e.resolve())},ur=(Oe,$e,ct,bt=!1,At=!1,Jt=0)=>{for(let mt=Jt;mt<Oe.length;mt++)We(Oe[mt],$e,ct,bt,At)},cr=Oe=>Oe.shapeFlag&6?cr(Oe.component.subTree):Oe.shapeFlag&128?Oe.suspense.next():y(Oe.anchor||Oe.el);let lt=!1;const qt=(Oe,$e,ct)=>{Oe==null?$e._vnode&&We($e._vnode,null,null,!0):M($e._vnode||null,Oe,$e,null,null,null,ct),lt||(lt=!0,sV(),s7(),lt=!1),$e._vnode=Oe},Ut={p:M,um:We,m:Ke,r:Rt,mt:de,mc:W,pc:Le,pbc:J,n:cr,o:t};let rr,br;return{render:qt,hydrate:rr,createApp:voe(qt,rr)}}function GD({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function kp({effect:t,update:e},r){t.allowRecurse=e.allowRecurse=r}function Aoe(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function k3(t,e,r=!1){const n=t.children,i=e.children;if(Wr(n)&&Wr(i))for(let a=0;a<n.length;a++){const l=n[a];let c=i[a];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=i[a]=Nf(i[a]),c.el=l.el),!r&&c.patchFlag!==-2&&k3(l,c)),c.type===ey&&(c.el=l.el)}}function Coe(t){const e=t.slice(),r=[0];let n,i,a,l,c;const o=t.length;for(n=0;n<o;n++){const d=t[n];if(d!==0){if(i=r[r.length-1],t[i]<d){e[n]=i,r.push(n);continue}for(a=0,l=r.length-1;a<l;)c=a+l>>1,t[r[c]]<d?a=c+1:l=c;d<t[r[a]]&&(a>0&&(e[n]=r[a-1]),r[a]=n)}}for(a=r.length,l=r[a-1];a-- >0;)r[a]=l,l=e[l];return r}function A7(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:A7(e)}function yV(t){if(t)for(let e=0;e<t.length;e++)t[e].active=!1}const Moe=Symbol.for("v-scx"),Ioe=()=>Mn(Moe);function kg(t,e){return O3(t,null,e)}const aT={};function un(t,e,r){return O3(t,e,r)}function O3(t,e,{immediate:r,deep:n,flush:i,once:a,onTrack:l,onTrigger:c}=oa){if(e&&a){const $=e;e=(...X)=>{$(...X),H()}}const o=uo,d=$=>n===!0?$:$f($,n===!1?1:void 0);let g,m=!1,y=!1;if(qi(t)?(g=()=>t.value,m=aC(t)):ad(t)?(g=()=>d(t),m=!0):Wr(t)?(y=!0,m=t.some($=>ad($)||aC($)),g=()=>t.map($=>{if(qi($))return $.value;if(ad($))return d($);if(Rn($))return od($,o,2)})):Rn(t)?e?g=()=>od(t,o,2):g=()=>(x&&x(),Dl(t,o,3,[A])):g=Oa,e&&n){const $=g;g=()=>$f($())}let x,A=$=>{x=z.onStop=()=>{od($,o,4),x=z.onStop=void 0}},M;if(DM)if(A=Oa,e?r&&Dl(e,o,3,[g(),y?[]:void 0,A]):g(),i==="sync"){const $=Ioe();M=$.__watcherHandles||($.__watcherHandles=[])}else return Oa;let D=y?new Array(t.length).fill(aT):aT;const P=()=>{if(!(!z.active||!z.dirty))if(e){const $=z.run();(n||m||(y?$.some((X,W)=>fd(X,D[W])):fd($,D)))&&(x&&x(),Dl(e,o,3,[$,D===aT?void 0:y&&D[0]===aT?[]:D,A]),D=$)}else z.run()};P.allowRecurse=!!e;let O;i==="sync"?O=P:i==="post"?O=()=>ys(P,o&&o.suspense):(P.pre=!0,o&&(P.id=o.uid),O=()=>E3(P));const z=new _3(g,Oa,O),V=v3(),H=()=>{z.stop(),V&&p3(V.effects,z)};return e?r?P():D=z.run():i==="post"?ys(z.run.bind(z),o&&o.suspense):z.run(),M&&M.push(H),H}function Eoe(t,e,r){const n=this.proxy,i=wi(t)?t.includes(".")?C7(n,t):()=>n[t]:t.bind(n,n);let a;Rn(e)?a=e:(a=e.handler,r=e);const l=vb(this),c=O3(i,a.bind(n),r);return l(),c}function C7(t,e){const r=e.split(".");return()=>{let n=t;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}function $f(t,e=1/0,r){if(e<=0||!fi(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,qi(t))$f(t.value,e,r);else if(Wr(t))for(let n=0;n<t.length;n++)$f(t[n],e,r);else if(yM(t)||b_(t))t.forEach(n=>{$f(n,e,r)});else if(kW(t)){for(const n in t)$f(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&$f(t[n],e,r)}return t}const EM=t=>t.type.__isKeepAlive;function Doe(t,e){I7(t,"a",e)}function M7(t,e){I7(t,"da",e)}function I7(t,e,r=uo){const n=t.__wdc||(t.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(CM(e,n,r),r){let i=r.parent;for(;i&&i.parent;)EM(i.parent.vnode)&&Poe(n,e,r,i),i=i.parent}}function Poe(t,e,r,n){const i=CM(e,t,n,!0);Td(()=>{p3(n[e],i)},r)}const Ff=Symbol("_leaveCb"),oT=Symbol("_enterCb");function Loe(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Vn(()=>{t.isMounted=!0}),Es(()=>{t.isUnmounting=!0}),t}const dl=[Function,Array],E7={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:dl,onEnter:dl,onAfterEnter:dl,onEnterCancelled:dl,onBeforeLeave:dl,onLeave:dl,onAfterLeave:dl,onLeaveCancelled:dl,onBeforeAppear:dl,onAppear:dl,onAfterAppear:dl,onAppearCancelled:dl},D7=t=>{const e=t.subTree;return e.component?D7(e.component):e},Roe={name:"BaseTransition",props:E7,setup(t,{slots:e}){const r=Mi(),n=Loe();return()=>{const i=e.default&&L7(e.default(),!0);if(!i||!i.length)return;let a=i[0];if(i.length>1){for(const y of i)if(y.type!==Bo){a=y;break}}const l=mi(t),{mode:c}=l;if(n.isLeaving)return UD(a);const o=xV(a);if(!o)return UD(a);let d=jR(o,l,n,r,y=>d=y);lC(o,d);const g=r.subTree,m=g&&xV(g);if(m&&m.type!==Bo&&!gg(o,m)&&D7(r).type!==Bo){const y=jR(m,l,n,r);if(lC(m,y),c==="out-in"&&o.type!==Bo)return n.isLeaving=!0,y.afterLeave=()=>{n.isLeaving=!1,r.update.active!==!1&&(r.effect.dirty=!0,r.update())},UD(a);c==="in-out"&&o.type!==Bo&&(y.delayLeave=(x,A,M)=>{const D=P7(n,m);D[String(m.key)]=m,x[Ff]=()=>{A(),x[Ff]=void 0,delete d.delayedLeave},d.delayedLeave=M})}return a}}},koe=Roe;function P7(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function jR(t,e,r,n,i){const{appear:a,mode:l,persisted:c=!1,onBeforeEnter:o,onEnter:d,onAfterEnter:g,onEnterCancelled:m,onBeforeLeave:y,onLeave:x,onAfterLeave:A,onLeaveCancelled:M,onBeforeAppear:D,onAppear:P,onAfterAppear:O,onAppearCancelled:z}=e,V=String(t.key),H=P7(r,t),$=(Y,J)=>{Y&&Dl(Y,n,9,J)},X=(Y,J)=>{const re=J[1];$(Y,J),Wr(Y)?Y.every(ae=>ae.length<=1)&&re():Y.length<=1&&re()},W={mode:l,persisted:c,beforeEnter(Y){let J=o;if(!r.isMounted)if(a)J=D||o;else return;Y[Ff]&&Y[Ff](!0);const re=H[V];re&&gg(t,re)&&re.el[Ff]&&re.el[Ff](),$(J,[Y])},enter(Y){let J=d,re=g,ae=m;if(!r.isMounted)if(a)J=P||d,re=O||g,ae=z||m;else return;let pe=!1;const de=Y[oT]=ve=>{pe||(pe=!0,ve?$(ae,[Y]):$(re,[Y]),W.delayedLeave&&W.delayedLeave(),Y[oT]=void 0)};J?X(J,[Y,de]):de()},leave(Y,J){const re=String(t.key);if(Y[oT]&&Y[oT](!0),r.isUnmounting)return J();$(y,[Y]);let ae=!1;const pe=Y[Ff]=de=>{ae||(ae=!0,J(),de?$(M,[Y]):$(A,[Y]),Y[Ff]=void 0,H[re]===t&&delete H[re])};H[re]=t,x?X(x,[Y,pe]):pe()},clone(Y){const J=jR(Y,e,r,n,i);return i&&i(J),J}};return W}function UD(t){if(EM(t))return t=hh(t),t.children=null,t}function xV(t){if(!EM(t))return t;const{shapeFlag:e,children:r}=t;if(r){if(e&16)return r[0];if(e&32&&Rn(r.default))return r.default()}}function lC(t,e){t.shapeFlag&6&&t.component?lC(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function L7(t,e=!1,r){let n=[],i=0;for(let a=0;a<t.length;a++){let l=t[a];const c=r==null?l.key:String(r)+String(l.key!=null?l.key:a);l.type===ha?(l.patchFlag&128&&i++,n=n.concat(L7(l.children,e,c))):(e||l.type!==Bo)&&n.push(c!=null?hh(l,{key:c}):l)}if(i>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}const Ooe=t=>t.__isTeleport,Jx=t=>t&&(t.disabled||t.disabled===""),bV=t=>typeof SVGElement<"u"&&t instanceof SVGElement,wV=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,WR=(t,e)=>{const r=t&&t.to;return wi(r)?e?e(r):null:r},zoe={name:"Teleport",__isTeleport:!0,process(t,e,r,n,i,a,l,c,o,d){const{mc:g,pc:m,pbc:y,o:{insert:x,querySelector:A,createText:M,createComment:D}}=d,P=Jx(e.props);let{shapeFlag:O,children:z,dynamicChildren:V}=e;if(t==null){const H=e.el=M(""),$=e.anchor=M("");x(H,r,n),x($,r,n);const X=e.target=WR(e.props,A),W=e.targetAnchor=M("");X&&(x(W,X),l==="svg"||bV(X)?l="svg":(l==="mathml"||wV(X))&&(l="mathml"));const Y=(J,re)=>{O&16&&g(z,J,re,i,a,l,c,o)};P?Y(r,$):X&&Y(X,W)}else{e.el=t.el;const H=e.anchor=t.anchor,$=e.target=t.target,X=e.targetAnchor=t.targetAnchor,W=Jx(t.props),Y=W?r:$,J=W?H:X;if(l==="svg"||bV($)?l="svg":(l==="mathml"||wV($))&&(l="mathml"),V?(y(t.dynamicChildren,V,Y,i,a,l,c),k3(t,e,!0)):o||m(t,e,Y,J,i,a,l,c,!1),P)W?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):sT(e,r,H,d,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const re=e.target=WR(e.props,A);re&&sT(e,re,null,d,0)}else W&&sT(e,$,X,d,1)}k7(e)},remove(t,e,r,n,{um:i,o:{remove:a}},l){const{shapeFlag:c,children:o,anchor:d,targetAnchor:g,target:m,props:y}=t;if(m&&a(g),l&&a(d),c&16){const x=l||!Jx(y);for(let A=0;A<o.length;A++){const M=o[A];i(M,e,r,x,!!M.dynamicChildren)}}},move:sT,hydrate:Boe};function sT(t,e,r,{o:{insert:n},m:i},a=2){a===0&&n(t.targetAnchor,e,r);const{el:l,anchor:c,shapeFlag:o,children:d,props:g}=t,m=a===2;if(m&&n(l,e,r),(!m||Jx(g))&&o&16)for(let y=0;y<d.length;y++)i(d[y],e,r,2);m&&n(c,e,r)}function Boe(t,e,r,n,i,a,{o:{nextSibling:l,parentNode:c,querySelector:o}},d){const g=e.target=WR(e.props,o);if(g){const m=g._lpa||g.firstChild;if(e.shapeFlag&16)if(Jx(e.props))e.anchor=d(l(t),e,c(t),r,n,i,a),e.targetAnchor=m;else{e.anchor=l(t);let y=m;for(;y;)if(y=l(y),y&&y.nodeType===8&&y.data==="teleport anchor"){e.targetAnchor=y,g._lpa=e.targetAnchor&&l(e.targetAnchor);break}d(m,e,g,r,n,i,a)}k7(e)}return e.anchor&&l(e.anchor)}const R7=zoe;function k7(t){const e=t.ctx;if(e&&e.ut){let r=t.children[0].el;for(;r&&r!==t.targetAnchor;)r.nodeType===1&&r.setAttribute("data-v-owner",e.uid),r=r.nextSibling;e.ut()}}const ha=Symbol.for("v-fgt"),ey=Symbol.for("v-txt"),Bo=Symbol.for("v-cmt"),$D=Symbol.for("v-stc"),e1=[];let hu=null;function Nt(t=!1){e1.push(hu=t?null:[])}function Foe(){e1.pop(),hu=e1[e1.length-1]||null}let I1=1;function SV(t){I1+=t}function O7(t){return t.dynamicChildren=I1>0?hu||x_:null,Foe(),I1>0&&hu&&hu.push(t),t}function Gr(t,e,r,n,i,a){return O7(wt(t,e,r,n,i,a,!0))}function kr(t,e,r,n,i){return O7(He(t,e,r,n,i,!0))}function Zg(t){return t?t.__v_isVNode===!0:!1}function gg(t,e){return t.type===e.type&&t.key===e.key}const z7=({key:t})=>t??null,SA=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?wi(t)||qi(t)||Rn(t)?{i:Qa,r:t,k:e,f:!!r}:t:null);function wt(t,e=null,r=null,n=0,i=null,a=t===ha?0:1,l=!1,c=!1){const o={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&z7(e),ref:e&&SA(e),scopeId:AM,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Qa};return c?(z3(o,r),a&128&&t.normalize(o)):r&&(o.shapeFlag|=wi(r)?8:16),I1>0&&!l&&hu&&(o.patchFlag>0||a&6)&&o.patchFlag!==32&&hu.push(o),o}const He=Noe;function Noe(t,e=null,r=null,n=0,i=null,a=!1){if((!t||t===f7)&&(t=Bo),Zg(t)){const c=hh(t,e,!0);return r&&z3(c,r),I1>0&&!a&&hu&&(c.shapeFlag&6?hu[hu.indexOf(t)]=c:hu.push(c)),c.patchFlag=-2,c}if(qoe(t)&&(t=t.__vccOpts),e){e=Voe(e);let{class:c,style:o}=e;c&&!wi(c)&&(e.class=Lr(c)),fi(o)&&(JW(o)&&!Wr(o)&&(o=Ba({},o)),e.style=va(o))}const l=wi(t)?1:eoe(t)?128:Ooe(t)?64:fi(t)?4:Rn(t)?2:0;return wt(t,e,r,n,i,l,a,!0)}function Voe(t){return t?JW(t)||y7(t)?Ba({},t):t:null}function hh(t,e,r=!1,n=!1){const{props:i,ref:a,patchFlag:l,children:c,transition:o}=t,d=e?wh(i||{},e):i,g={__v_isVNode:!0,__v_skip:!0,type:t.type,props:d,key:d&&z7(d),ref:e&&e.ref?r&&a?Wr(a)?a.concat(SA(e)):[a,SA(e)]:SA(e):a,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:c,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ha?l===-1?16:l|16:l,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:o,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&hh(t.ssContent),ssFallback:t.ssFallback&&hh(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return o&&n&&lC(g,o.clone(g)),g}function ji(t=" ",e=0){return He(ey,null,t,e)}function In(t="",e=!1){return e?(Nt(),kr(Bo,null,t)):He(Bo,null,t)}function Yu(t){return t==null||typeof t=="boolean"?He(Bo):Wr(t)?He(ha,null,t.slice()):typeof t=="object"?Nf(t):He(ey,null,String(t))}function Nf(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:hh(t)}function z3(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Wr(e))r=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),z3(t,i()),i._c&&(i._d=!0));return}else{r=32;const i=e._;!i&&!y7(e)?e._ctx=Qa:i===3&&Qa&&(Qa.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Rn(e)?(e={default:e,_ctx:Qa},r=32):(e=String(e),n&64?(r=16,e=[ji(e)]):r=8);t.children=e,t.shapeFlag|=r}function wh(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=Lr([e.class,n.class]));else if(i==="style")e.style=va([e.style,n.style]);else if(_M(i)){const a=e[i],l=n[i];l&&a!==l&&!(Wr(a)&&a.includes(l))&&(e[i]=a?[].concat(a,l):l)}else i!==""&&(e[i]=n[i])}return e}function Vu(t,e,r,n=null){Dl(t,e,7,[r,n])}const Goe=v7();let Uoe=0;function $oe(t,e,r){const n=t.type,i=(e?e.appContext:t.appContext)||Goe,a={uid:Uoe++,vnode:t,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new VW(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:b7(n,i),emitsOptions:u7(n,i),emit:null,emitted:null,propsDefaults:oa,inheritAttrs:n.inheritAttrs,ctx:oa,data:oa,props:oa,attrs:oa,slots:oa,refs:oa,setupState:oa,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=qae.bind(null,a),t.ce&&t.ce(a),a}let uo=null;const Mi=()=>uo||Qa;let uC,ZR;{const t=zW(),e=(r,n)=>{let i;return(i=t[r])||(i=t[r]=[]),i.push(n),a=>{i.length>1?i.forEach(l=>l(a)):i[0](a)}};uC=e("__VUE_INSTANCE_SETTERS__",r=>uo=r),ZR=e("__VUE_SSR_SETTERS__",r=>DM=r)}const vb=t=>{const e=uo;return uC(t),t.scope.on(),()=>{t.scope.off(),uC(e)}},TV=()=>{uo&&uo.scope.off(),uC(null)};function B7(t){return t.vnode.shapeFlag&4}let DM=!1;function Hoe(t,e=!1){e&&ZR(e);const{props:r,children:n}=t.vnode,i=B7(t);_oe(t,r,i,e),boe(t,n);const a=i?joe(t,e):void 0;return e&&ZR(!1),a}function joe(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,loe);const{setup:n}=r;if(n){const i=t.setupContext=n.length>1?N7(t):null,a=vb(t);wd();const l=od(n,t,0,[t.props,i]);if(Sd(),a(),LW(l)){if(l.then(TV,TV),e)return l.then(c=>{AV(t,c,e)}).catch(c=>{SM(c,t,0)});t.asyncDep=l}else AV(t,l,e)}else F7(t,e)}function AV(t,e,r){Rn(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:fi(e)&&(t.setupState=n7(e)),F7(t,r)}let CV;function F7(t,e,r){const n=t.type;if(!t.render){if(!e&&CV&&!n.render){const i=n.template||L3(t).template;if(i){const{isCustomElement:a,compilerOptions:l}=t.appContext.config,{delimiters:c,compilerOptions:o}=n,d=Ba(Ba({isCustomElement:a,delimiters:c},l),o);n.render=CV(i,d)}}t.render=n.render||Oa}{const i=vb(t);wd();try{coe(t)}finally{Sd(),i()}}}const Woe={get(t,e){return Ms(t,"get",""),t[e]}};function N7(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,Woe),slots:t.slots,emit:t.emit,expose:e}}function PM(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(n7(T3(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in Kx)return Kx[r](t)},has(e,r){return r in e||r in Kx}})):t.proxy}function Zoe(t,e=!0){return Rn(t)?t.displayName||t.name:t.name||e&&t.__name}function qoe(t){return Rn(t)&&"__vccOpts"in t}const gt=(t,e)=>Fae(t,e,DM);function ln(t,e,r){const n=arguments.length;return n===2?fi(e)&&!Wr(e)?Zg(e)?He(t,null,[e]):He(t,e):He(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Zg(r)&&(r=[r]),He(t,e,r))}const Yoe="3.4.29",Xoe=Oa;/**
* @vue/runtime-dom v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Qoe="http://www.w3.org/2000/svg",Koe="http://www.w3.org/1998/Math/MathML",Xc=typeof document<"u"?document:null,MV=Xc&&Xc.createElement("template"),Joe={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const i=e==="svg"?Xc.createElementNS(Qoe,t):e==="mathml"?Xc.createElementNS(Koe,t):r?Xc.createElement(t,{is:r}):Xc.createElement(t);return t==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:t=>Xc.createTextNode(t),createComment:t=>Xc.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Xc.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,i,a){const l=r?r.previousSibling:e.lastChild;if(i&&(i===a||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),r),!(i===a||!(i=i.nextSibling)););else{MV.innerHTML=n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t;const c=MV.content;if(n==="svg"||n==="mathml"){const o=c.firstChild;for(;o.firstChild;)c.appendChild(o.firstChild);c.removeChild(o)}e.insertBefore(c,r)}return[l?l.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},yf="transition",rx="animation",E1=Symbol("_vtc"),Ad=(t,{slots:e})=>ln(koe,ese(t),e);Ad.displayName="Transition";const V7={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Ad.props=Ba({},E7,V7);const Op=(t,e=[])=>{Wr(t)?t.forEach(r=>r(...e)):t&&t(...e)},IV=t=>t?Wr(t)?t.some(e=>e.length>1):t.length>1:!1;function ese(t){const e={};for(const ae in t)ae in V7||(e[ae]=t[ae]);if(t.css===!1)return e;const{name:r="v",type:n,duration:i,enterFromClass:a=`${r}-enter-from`,enterActiveClass:l=`${r}-enter-active`,enterToClass:c=`${r}-enter-to`,appearFromClass:o=a,appearActiveClass:d=l,appearToClass:g=c,leaveFromClass:m=`${r}-leave-from`,leaveActiveClass:y=`${r}-leave-active`,leaveToClass:x=`${r}-leave-to`}=t,A=tse(i),M=A&&A[0],D=A&&A[1],{onBeforeEnter:P,onEnter:O,onEnterCancelled:z,onLeave:V,onLeaveCancelled:H,onBeforeAppear:$=P,onAppear:X=O,onAppearCancelled:W=z}=e,Y=(ae,pe,de)=>{zp(ae,pe?g:c),zp(ae,pe?d:l),de&&de()},J=(ae,pe)=>{ae._isLeaving=!1,zp(ae,m),zp(ae,x),zp(ae,y),pe&&pe()},re=ae=>(pe,de)=>{const ve=ae?X:O,me=()=>Y(pe,ae,de);Op(ve,[pe,me]),EV(()=>{zp(pe,ae?o:a),xf(pe,ae?g:c),IV(ve)||DV(pe,n,M,me)})};return Ba(e,{onBeforeEnter(ae){Op(P,[ae]),xf(ae,a),xf(ae,l)},onBeforeAppear(ae){Op($,[ae]),xf(ae,o),xf(ae,d)},onEnter:re(!1),onAppear:re(!0),onLeave(ae,pe){ae._isLeaving=!0;const de=()=>J(ae,pe);xf(ae,m),xf(ae,y),ise(),EV(()=>{ae._isLeaving&&(zp(ae,m),xf(ae,x),IV(V)||DV(ae,n,D,de))}),Op(V,[ae,de])},onEnterCancelled(ae){Y(ae,!1),Op(z,[ae])},onAppearCancelled(ae){Y(ae,!0),Op(W,[ae])},onLeaveCancelled(ae){J(ae),Op(H,[ae])}})}function tse(t){if(t==null)return null;if(fi(t))return[HD(t.enter),HD(t.leave)];{const e=HD(t);return[e,e]}}function HD(t){return lae(t)}function xf(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t[E1]||(t[E1]=new Set)).add(e)}function zp(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const r=t[E1];r&&(r.delete(e),r.size||(t[E1]=void 0))}function EV(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let rse=0;function DV(t,e,r,n){const i=t._endId=++rse,a=()=>{i===t._endId&&n()};if(r)return setTimeout(a,r);const{type:l,timeout:c,propCount:o}=nse(t,e);if(!l)return n();const d=l+"end";let g=0;const m=()=>{t.removeEventListener(d,y),a()},y=x=>{x.target===t&&++g>=o&&m()};setTimeout(()=>{g<o&&m()},c+1),t.addEventListener(d,y)}function nse(t,e){const r=window.getComputedStyle(t),n=A=>(r[A]||"").split(", "),i=n(`${yf}Delay`),a=n(`${yf}Duration`),l=PV(i,a),c=n(`${rx}Delay`),o=n(`${rx}Duration`),d=PV(c,o);let g=null,m=0,y=0;e===yf?l>0&&(g=yf,m=l,y=a.length):e===rx?d>0&&(g=rx,m=d,y=o.length):(m=Math.max(l,d),g=m>0?l>d?yf:rx:null,y=g?g===yf?a.length:o.length:0);const x=g===yf&&/\b(transform|all)(,|$)/.test(n(`${yf}Property`).toString());return{type:g,timeout:m,propCount:y,hasTransform:x}}function PV(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>LV(r)+LV(t[n])))}function LV(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function ise(){return document.body.offsetHeight}function ase(t,e,r){const n=t[E1];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const cC=Symbol("_vod"),G7=Symbol("_vsh"),qg={beforeMount(t,{value:e},{transition:r}){t[cC]=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):nx(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:n}){!e!=!r&&(n?e?(n.beforeEnter(t),nx(t,!0),n.enter(t)):n.leave(t,()=>{nx(t,!1)}):nx(t,e))},beforeUnmount(t,{value:e}){nx(t,e)}};function nx(t,e){t.style.display=e?t[cC]:"none",t[G7]=!e}const ose=Symbol(""),sse=/(^|;)\s*display\s*:/;function lse(t,e,r){const n=t.style,i=wi(r);let a=!1;if(r&&!i){if(e)if(wi(e))for(const l of e.split(";")){const c=l.slice(0,l.indexOf(":")).trim();r[c]==null&&TA(n,c,"")}else for(const l in e)r[l]==null&&TA(n,l,"");for(const l in r)l==="display"&&(a=!0),TA(n,l,r[l])}else if(i){if(e!==r){const l=n[ose];l&&(r+=";"+l),n.cssText=r,a=sse.test(r)}}else e&&t.removeAttribute("style");cC in t&&(t[cC]=a?n.display:"",t[G7]&&(n.display="none"))}const RV=/\s*!important$/;function TA(t,e,r){if(Wr(r))r.forEach(n=>TA(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=use(t,e);RV.test(r)?t.setProperty(K_(n),r.replace(RV,""),"important"):t[n]=r}}const kV=["Webkit","Moz","ms"],jD={};function use(t,e){const r=jD[e];if(r)return r;let n=_u(e);if(n!=="filter"&&n in t)return jD[e]=n;n=pb(n);for(let i=0;i<kV.length;i++){const a=kV[i]+n;if(a in t)return jD[e]=a}return e}const OV="http://www.w3.org/1999/xlink";function zV(t,e,r,n,i,a=pae(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(OV,e.slice(6,e.length)):t.setAttributeNS(OV,e,r):r==null||a&&!BW(r)?t.removeAttribute(e):t.setAttribute(e,a?"":String(r))}function cse(t,e,r,n,i,a,l){if(e==="innerHTML"||e==="textContent"){n&&l(n,i,a),t[e]=r??"";return}const c=t.tagName;if(e==="value"&&c!=="PROGRESS"&&!c.includes("-")){const d=c==="OPTION"?t.getAttribute("value")||"":t.value,g=r==null?"":String(r);(d!==g||!("_value"in t))&&(t.value=g),r==null&&t.removeAttribute(e),t._value=r;return}let o=!1;if(r===""||r==null){const d=typeof t[e];d==="boolean"?r=BW(r):r==null&&d==="string"?(r="",o=!0):d==="number"&&(r=0,o=!0)}try{t[e]=r}catch{}o&&t.removeAttribute(e)}function U7(t,e,r,n){t.addEventListener(e,r,n)}function hse(t,e,r,n){t.removeEventListener(e,r,n)}const BV=Symbol("_vei");function fse(t,e,r,n,i=null){const a=t[BV]||(t[BV]={}),l=a[e];if(n&&l)l.value=n;else{const[c,o]=dse(e);if(n){const d=a[e]=vse(n,i);U7(t,c,d,o)}else l&&(hse(t,c,l,o),a[e]=void 0)}}const FV=/(?:Once|Passive|Capture)$/;function dse(t){let e;if(FV.test(t)){e={};let n;for(;n=t.match(FV);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):K_(t.slice(2)),e]}let WD=0;const pse=Promise.resolve(),gse=()=>WD||(pse.then(()=>WD=0),WD=Date.now());function vse(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Dl(mse(n,r.value),e,5,[n])};return r.value=t,r.attached=gse(),r}function mse(t,e){if(Wr(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const NV=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,_se=(t,e,r,n,i,a,l,c,o)=>{const d=i==="svg";e==="class"?ase(t,n,d):e==="style"?lse(t,r,n):_M(e)?d3(e)||fse(t,e,r,n,l):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):yse(t,e,n,d))?(cse(t,e,n,a,l,c,o),(e==="value"||e==="checked"||e==="selected")&&zV(t,e,n,d,l,e!=="value")):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),zV(t,e,n,d))};function yse(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&NV(e)&&Rn(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return NV(e)&&wi(r)?!1:e in t}const VV=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Wr(e)?r=>bA(e,r):e},ZD=Symbol("_assign"),hC={deep:!0,created(t,e,r){t[ZD]=VV(r),U7(t,"change",()=>{const n=t._modelValue,i=xse(t),a=t.checked,l=t[ZD];if(Wr(n)){const c=FW(n,i),o=c!==-1;if(a&&!o)l(n.concat(i));else if(!a&&o){const d=[...n];d.splice(c,1),l(d)}}else if(yM(n)){const c=new Set(n);a?c.add(i):c.delete(i),l(c)}else l($7(t,a))})},mounted:GV,beforeUpdate(t,e,r){t[ZD]=VV(r),GV(t,e,r)}};function GV(t,{value:e,oldValue:r},n){t._modelValue=e,Wr(e)?t.checked=FW(e,n.props.value)>-1:yM(e)?t.checked=e.has(n.props.value):e!==r&&(t.checked=bM(e,$7(t,!0)))}function xse(t){return"_value"in t?t._value:t.value}function $7(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const bse=["ctrl","shift","alt","meta"],wse={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>bse.some(r=>t[`${r}Key`]&&!e.includes(r))},Yg=(t,e)=>{const r=t._withMods||(t._withMods={}),n=e.join(".");return r[n]||(r[n]=(i,...a)=>{for(let l=0;l<e.length;l++){const c=wse[e[l]];if(c&&c(i,e))return}return t(i,...a)})},Sse=Ba({patchProp:_se},Joe);let UV;function H7(){return UV||(UV=Soe(Sse))}const $V=(...t)=>{H7().render(...t)},Tse=(...t)=>{const e=H7().createApp(...t),{mount:r}=e;return e.mount=n=>{const i=Cse(n);if(!i)return;const a=e._component;!Rn(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.innerHTML="";const l=r(i,!1,Ase(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),l},e};function Ase(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Cse(t){return wi(t)?document.querySelector(t):t}var Mse=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let j7;const LM=t=>j7=t,W7=Symbol();function qR(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var t1;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(t1||(t1={}));function Ise(){const t=GW(!0),e=t.run(()=>at({}));let r=[],n=[];const i=T3({install(a){LM(i),i._a=a,a.provide(W7,i),a.config.globalProperties.$pinia=i,n.forEach(l=>r.push(l)),n=[]},use(a){return!this._a&&!Mse?n.push(a):r.push(a),this},_p:r,_a:null,_e:t,_s:new Map,state:e});return i}const Z7=()=>{};function HV(t,e,r,n=Z7){t.push(e);const i=()=>{const a=t.indexOf(e);a>-1&&(t.splice(a,1),n())};return!r&&v3()&&m3(i),i}function Vm(t,...e){t.slice().forEach(r=>{r(...e)})}const Ese=t=>t();function YR(t,e){t instanceof Map&&e instanceof Map&&e.forEach((r,n)=>t.set(n,r)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const r in e){if(!e.hasOwnProperty(r))continue;const n=e[r],i=t[r];qR(i)&&qR(n)&&t.hasOwnProperty(r)&&!qi(n)&&!ad(n)?t[r]=YR(i,n):t[r]=n}return t}const Dse=Symbol();function Pse(t){return!qR(t)||!t.hasOwnProperty(Dse)}const{assign:Lf}=Object;function Lse(t){return!!(qi(t)&&t.effect)}function Rse(t,e,r,n){const{state:i,actions:a,getters:l}=e,c=r.state.value[t];let o;function d(){c||(r.state.value[t]=i?i():{});const g=M3(r.state.value[t]);return Lf(g,a,Object.keys(l||{}).reduce((m,y)=>(m[y]=T3(gt(()=>{LM(r);const x=r._s.get(t);return l[y].call(x,x)})),m),{}))}return o=q7(t,d,e,r,n,!0),o}function q7(t,e,r={},n,i,a){let l;const c=Lf({actions:{}},r),o={deep:!0};let d,g,m=[],y=[],x;const A=n.state.value[t];!a&&!A&&(n.state.value[t]={}),at({});let M;function D(W){let Y;d=g=!1,typeof W=="function"?(W(n.state.value[t]),Y={type:t1.patchFunction,storeId:t,events:x}):(YR(n.state.value[t],W),Y={type:t1.patchObject,payload:W,storeId:t,events:x});const J=M=Symbol();Fa().then(()=>{M===J&&(d=!0)}),g=!0,Vm(m,Y,n.state.value[t])}const P=a?function(){const{state:Y}=r,J=Y?Y():{};this.$patch(re=>{Lf(re,J)})}:Z7;function O(){l.stop(),m=[],y=[],n._s.delete(t)}function z(W,Y){return function(){LM(n);const J=Array.from(arguments),re=[],ae=[];function pe(me){re.push(me)}function de(me){ae.push(me)}Vm(y,{args:J,name:W,store:H,after:pe,onError:de});let ve;try{ve=Y.apply(this&&this.$id===t?this:H,J)}catch(me){throw Vm(ae,me),me}return ve instanceof Promise?ve.then(me=>(Vm(re,me),me)).catch(me=>(Vm(ae,me),Promise.reject(me))):(Vm(re,ve),ve)}}const V={_p:n,$id:t,$onAction:HV.bind(null,y),$patch:D,$reset:P,$subscribe(W,Y={}){const J=HV(m,W,Y.detached,()=>re()),re=l.run(()=>un(()=>n.state.value[t],ae=>{(Y.flush==="sync"?g:d)&&W({storeId:t,type:t1.direct,events:x},ae)},Lf({},o,Y)));return J},$dispose:O},H=gc(V);n._s.set(t,H);const X=(n._a&&n._a.runWithContext||Ese)(()=>n._e.run(()=>(l=GW()).run(e)));for(const W in X){const Y=X[W];if(qi(Y)&&!Lse(Y)||ad(Y))a||(A&&Pse(Y)&&(qi(Y)?Y.value=A[W]:YR(Y,A[W])),n.state.value[t][W]=Y);else if(typeof Y=="function"){const J=z(W,Y);X[W]=J,c.actions[W]=Y}}return Lf(H,X),Lf(mi(H),X),Object.defineProperty(H,"$state",{get:()=>n.state.value[t],set:W=>{D(Y=>{Lf(Y,W)})}}),n._p.forEach(W=>{Lf(H,l.run(()=>W({store:H,app:n._a,pinia:n,options:c})))}),A&&a&&r.hydrate&&r.hydrate(H.$state,A),d=!0,g=!0,H}function Y7(t,e,r){let n,i;const a=typeof e=="function";typeof t=="string"?(n=t,i=a?r:e):(i=t,n=t.id);function l(c,o){const d=moe();return c=c||(d?Mn(W7,null):null),c&&LM(c),c=j7,c._s.has(n)||(a?q7(n,e,i,c):Rse(n,i,c)),c._s.get(n)}return l.$id=n,l}function X7(t){{t=mi(t);const e={};for(const r in t){const n=t[r];(qi(n)||ad(n))&&(e[r]=Il(t,r))}return e}}const AA=function(t,e,...r){let n;e.includes("mouse")||e.includes("click")?n="MouseEvents":e.includes("key")?n="KeyboardEvent":n="HTMLEvents";const i=document.createEvent(n);return i.initEvent(e,...r),t.dispatchEvent(i),t},Qc=(t,e,{checkForDefaultPrevented:r=!0}={})=>i=>{const a=t==null?void 0:t(i);if(r===!1||!a)return e==null?void 0:e(i)};var kse=Object.defineProperty,Ose=Object.defineProperties,zse=Object.getOwnPropertyDescriptors,jV=Object.getOwnPropertySymbols,Bse=Object.prototype.hasOwnProperty,Fse=Object.prototype.propertyIsEnumerable,WV=(t,e,r)=>e in t?kse(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Nse=(t,e)=>{for(var r in e||(e={}))Bse.call(e,r)&&WV(t,r,e[r]);if(jV)for(var r of jV(e))Fse.call(e,r)&&WV(t,r,e[r]);return t},Vse=(t,e)=>Ose(t,zse(e));function ZV(t,e){var r;const n=C3();return kg(()=>{n.value=t()},Vse(Nse({},e),{flush:(r=void 0)!=null?r:"sync"})),gb(n)}var qV;const fa=typeof window<"u",Gse=t=>typeof t=="string",Q7=()=>{},Use=fa&&((qV=window==null?void 0:window.navigator)==null?void 0:qV.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function B3(t){return typeof t=="function"?t():Pe(t)}function $se(t){return t}function RM(t){return v3()?(m3(t),!0):!1}function Hse(t,e=!0){Mi()?Vn(t):e?t():Fa(t)}function fC(t,e,r={}){const{immediate:n=!0}=r,i=at(!1);let a=null;function l(){a&&(clearTimeout(a),a=null)}function c(){i.value=!1,l()}function o(...d){l(),i.value=!0,a=setTimeout(()=>{i.value=!1,a=null,t(...d)},B3(e))}return n&&(i.value=!0,fa&&o()),RM(c),{isPending:gb(i),start:o,stop:c}}function Wf(t){var e;const r=B3(t);return(e=r==null?void 0:r.$el)!=null?e:r}const kM=fa?window:void 0,jse=fa?window.document:void 0;function pu(...t){let e,r,n,i;if(Gse(t[0])||Array.isArray(t[0])?([r,n,i]=t,e=kM):[e,r,n,i]=t,!e)return Q7;Array.isArray(r)||(r=[r]),Array.isArray(n)||(n=[n]);const a=[],l=()=>{a.forEach(g=>g()),a.length=0},c=(g,m,y,x)=>(g.addEventListener(m,y,x),()=>g.removeEventListener(m,y,x)),o=un(()=>[Wf(e),B3(i)],([g,m])=>{l(),g&&a.push(...r.flatMap(y=>n.map(x=>c(g,y,x,m))))},{immediate:!0,flush:"post"}),d=()=>{o(),l()};return RM(d),d}let YV=!1;function Wse(t,e,r={}){const{window:n=kM,ignore:i=[],capture:a=!0,detectIframe:l=!1}=r;if(!n)return;Use&&!YV&&(YV=!0,Array.from(n.document.body.children).forEach(y=>y.addEventListener("click",Q7)));let c=!0;const o=y=>i.some(x=>{if(typeof x=="string")return Array.from(n.document.querySelectorAll(x)).some(A=>A===y.target||y.composedPath().includes(A));{const A=Wf(x);return A&&(y.target===A||y.composedPath().includes(A))}}),g=[pu(n,"click",y=>{const x=Wf(t);if(!(!x||x===y.target||y.composedPath().includes(x))){if(y.detail===0&&(c=!o(y)),!c){c=!0;return}e(y)}},{passive:!0,capture:a}),pu(n,"pointerdown",y=>{const x=Wf(t);x&&(c=!y.composedPath().includes(x)&&!o(y))},{passive:!0}),l&&pu(n,"blur",y=>{var x;const A=Wf(t);((x=n.document.activeElement)==null?void 0:x.tagName)==="IFRAME"&&!(A!=null&&A.contains(n.document.activeElement))&&e(y)})].filter(Boolean);return()=>g.forEach(y=>y())}function Zse(t,e=!1){const r=at(),n=()=>r.value=!!t();return n(),Hse(n,e),r}const XV=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},QV="__vueuse_ssr_handlers__";XV[QV]=XV[QV]||{};function qse({document:t=jse}={}){if(!t)return at("visible");const e=at(t.visibilityState);return pu(t,"visibilitychange",()=>{e.value=t.visibilityState}),e}var KV=Object.getOwnPropertySymbols,Yse=Object.prototype.hasOwnProperty,Xse=Object.prototype.propertyIsEnumerable,Qse=(t,e)=>{var r={};for(var n in t)Yse.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&KV)for(var n of KV(t))e.indexOf(n)<0&&Xse.call(t,n)&&(r[n]=t[n]);return r};function D_(t,e,r={}){const n=r,{window:i=kM}=n,a=Qse(n,["window"]);let l;const c=Zse(()=>i&&"ResizeObserver"in i),o=()=>{l&&(l.disconnect(),l=void 0)},d=un(()=>Wf(t),m=>{o(),c.value&&i&&m&&(l=new ResizeObserver(e),l.observe(m,a))},{immediate:!0,flush:"post"}),g=()=>{o(),d()};return RM(g),{isSupported:c,stop:g}}var JV;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(JV||(JV={}));var Kse=Object.defineProperty,e6=Object.getOwnPropertySymbols,Jse=Object.prototype.hasOwnProperty,ele=Object.prototype.propertyIsEnumerable,t6=(t,e,r)=>e in t?Kse(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,tle=(t,e)=>{for(var r in e||(e={}))Jse.call(e,r)&&t6(t,r,e[r]);if(e6)for(var r of e6(e))ele.call(e,r)&&t6(t,r,e[r]);return t};const rle={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};tle({linear:$se},rle);function nle({window:t=kM}={}){if(!t)return at(!1);const e=at(t.document.hasFocus());return pu(t,"blur",()=>{e.value=!1}),pu(t,"focus",()=>{e.value=!0}),e}var K7=typeof global=="object"&&global&&global.Object===Object&&global,ile=typeof self=="object"&&self&&self.Object===Object&&self,bu=K7||ile||Function("return this")(),sc=bu.Symbol,J7=Object.prototype,ale=J7.hasOwnProperty,ole=J7.toString,ix=sc?sc.toStringTag:void 0;function sle(t){var e=ale.call(t,ix),r=t[ix];try{t[ix]=void 0;var n=!0}catch{}var i=ole.call(t);return n&&(e?t[ix]=r:delete t[ix]),i}var lle=Object.prototype,ule=lle.toString;function cle(t){return ule.call(t)}var hle="[object Null]",fle="[object Undefined]",r6=sc?sc.toStringTag:void 0;function sv(t){return t==null?t===void 0?fle:hle:r6&&r6 in Object(t)?sle(t):cle(t)}function dd(t){return t!=null&&typeof t=="object"}var dle="[object Symbol]";function OM(t){return typeof t=="symbol"||dd(t)&&sv(t)==dle}function eZ(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var el=Array.isArray,ple=1/0,n6=sc?sc.prototype:void 0,i6=n6?n6.toString:void 0;function tZ(t){if(typeof t=="string")return t;if(el(t))return eZ(t,tZ)+"";if(OM(t))return i6?i6.call(t):"";var e=t+"";return e=="0"&&1/t==-ple?"-0":e}var gle=/\s/;function vle(t){for(var e=t.length;e--&&gle.test(t.charAt(e)););return e}var mle=/^\s+/;function _le(t){return t&&t.slice(0,vle(t)+1).replace(mle,"")}function tl(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var a6=NaN,yle=/^[-+]0x[0-9a-f]+$/i,xle=/^0b[01]+$/i,ble=/^0o[0-7]+$/i,wle=parseInt;function o6(t){if(typeof t=="number")return t;if(OM(t))return a6;if(tl(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=tl(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=_le(t);var r=xle.test(t);return r||ble.test(t)?wle(t.slice(2),r?2:8):yle.test(t)?a6:+t}function F3(t){return t}var Sle="[object AsyncFunction]",Tle="[object Function]",Ale="[object GeneratorFunction]",Cle="[object Proxy]";function N3(t){if(!tl(t))return!1;var e=sv(t);return e==Tle||e==Ale||e==Sle||e==Cle}var qD=bu["__core-js_shared__"],s6=function(){var t=/[^.]+$/.exec(qD&&qD.keys&&qD.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Mle(t){return!!s6&&s6 in t}var Ile=Function.prototype,Ele=Ile.toString;function lv(t){if(t!=null){try{return Ele.call(t)}catch{}try{return t+""}catch{}}return""}var Dle=/[\\^$.*+?()[\]{}|]/g,Ple=/^\[object .+?Constructor\]$/,Lle=Function.prototype,Rle=Object.prototype,kle=Lle.toString,Ole=Rle.hasOwnProperty,zle=RegExp("^"+kle.call(Ole).replace(Dle,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ble(t){if(!tl(t)||Mle(t))return!1;var e=N3(t)?zle:Ple;return e.test(lv(t))}function Fle(t,e){return t==null?void 0:t[e]}function uv(t,e){var r=Fle(t,e);return Ble(r)?r:void 0}var XR=uv(bu,"WeakMap"),l6=Object.create,Nle=function(){function t(){}return function(e){if(!tl(e))return{};if(l6)return l6(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function Vle(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Gle(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var Ule=800,$le=16,Hle=Date.now;function jle(t){var e=0,r=0;return function(){var n=Hle(),i=$le-(n-r);if(r=n,i>0){if(++e>=Ule)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Wle(t){return function(){return t}}var dC=function(){try{var t=uv(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Zle=dC?function(t,e){return dC(t,"toString",{configurable:!0,enumerable:!1,value:Wle(e),writable:!0})}:F3,rZ=jle(Zle),qle=9007199254740991,Yle=/^(?:0|[1-9]\d*)$/;function zM(t,e){var r=typeof t;return e=e??qle,!!e&&(r=="number"||r!="symbol"&&Yle.test(t))&&t>-1&&t%1==0&&t<e}function V3(t,e,r){e=="__proto__"&&dC?dC(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function mb(t,e){return t===e||t!==t&&e!==e}var Xle=Object.prototype,Qle=Xle.hasOwnProperty;function nZ(t,e,r){var n=t[e];(!(Qle.call(t,e)&&mb(n,r))||r===void 0&&!(e in t))&&V3(t,e,r)}function Kle(t,e,r,n){var i=!r;r||(r={});for(var a=-1,l=e.length;++a<l;){var c=e[a],o=void 0;o===void 0&&(o=t[c]),i?V3(r,c,o):nZ(r,c,o)}return r}var u6=Math.max;function iZ(t,e,r){return e=u6(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=u6(n.length-e,0),l=Array(a);++i<a;)l[i]=n[e+i];i=-1;for(var c=Array(e+1);++i<e;)c[i]=n[i];return c[e]=r(l),Vle(t,this,c)}}function Jle(t,e){return rZ(iZ(t,e,F3),t+"")}var eue=9007199254740991;function G3(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=eue}function ty(t){return t!=null&&G3(t.length)&&!N3(t)}function tue(t,e,r){if(!tl(r))return!1;var n=typeof e;return(n=="number"?ty(r)&&zM(e,r.length):n=="string"&&e in r)?mb(r[e],t):!1}function rue(t){return Jle(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,l=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,l&&tue(r[0],r[1],l)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var c=r[n];c&&t(e,c,n,a)}return e})}var nue=Object.prototype;function U3(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||nue;return t===r}function iue(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var aue="[object Arguments]";function c6(t){return dd(t)&&sv(t)==aue}var aZ=Object.prototype,oue=aZ.hasOwnProperty,sue=aZ.propertyIsEnumerable,D1=c6(function(){return arguments}())?c6:function(t){return dd(t)&&oue.call(t,"callee")&&!sue.call(t,"callee")};function lue(){return!1}var oZ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,h6=oZ&&typeof module=="object"&&module&&!module.nodeType&&module,uue=h6&&h6.exports===oZ,f6=uue?bu.Buffer:void 0,cue=f6?f6.isBuffer:void 0,pC=cue||lue,hue="[object Arguments]",fue="[object Array]",due="[object Boolean]",pue="[object Date]",gue="[object Error]",vue="[object Function]",mue="[object Map]",_ue="[object Number]",yue="[object Object]",xue="[object RegExp]",bue="[object Set]",wue="[object String]",Sue="[object WeakMap]",Tue="[object ArrayBuffer]",Aue="[object DataView]",Cue="[object Float32Array]",Mue="[object Float64Array]",Iue="[object Int8Array]",Eue="[object Int16Array]",Due="[object Int32Array]",Pue="[object Uint8Array]",Lue="[object Uint8ClampedArray]",Rue="[object Uint16Array]",kue="[object Uint32Array]",aa={};aa[Cue]=aa[Mue]=aa[Iue]=aa[Eue]=aa[Due]=aa[Pue]=aa[Lue]=aa[Rue]=aa[kue]=!0;aa[hue]=aa[fue]=aa[Tue]=aa[due]=aa[Aue]=aa[pue]=aa[gue]=aa[vue]=aa[mue]=aa[_ue]=aa[yue]=aa[xue]=aa[bue]=aa[wue]=aa[Sue]=!1;function Oue(t){return dd(t)&&G3(t.length)&&!!aa[sv(t)]}function zue(t){return function(e){return t(e)}}var sZ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,r1=sZ&&typeof module=="object"&&module&&!module.nodeType&&module,Bue=r1&&r1.exports===sZ,YD=Bue&&K7.process,d6=function(){try{var t=r1&&r1.require&&r1.require("util").types;return t||YD&&YD.binding&&YD.binding("util")}catch{}}(),p6=d6&&d6.isTypedArray,$3=p6?zue(p6):Oue,Fue=Object.prototype,Nue=Fue.hasOwnProperty;function lZ(t,e){var r=el(t),n=!r&&D1(t),i=!r&&!n&&pC(t),a=!r&&!n&&!i&&$3(t),l=r||n||i||a,c=l?iue(t.length,String):[],o=c.length;for(var d in t)(e||Nue.call(t,d))&&!(l&&(d=="length"||i&&(d=="offset"||d=="parent")||a&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||zM(d,o)))&&c.push(d);return c}function uZ(t,e){return function(r){return t(e(r))}}var Vue=uZ(Object.keys,Object),Gue=Object.prototype,Uue=Gue.hasOwnProperty;function $ue(t){if(!U3(t))return Vue(t);var e=[];for(var r in Object(t))Uue.call(t,r)&&r!="constructor"&&e.push(r);return e}function H3(t){return ty(t)?lZ(t):$ue(t)}function Hue(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var jue=Object.prototype,Wue=jue.hasOwnProperty;function Zue(t){if(!tl(t))return Hue(t);var e=U3(t),r=[];for(var n in t)n=="constructor"&&(e||!Wue.call(t,n))||r.push(n);return r}function cZ(t){return ty(t)?lZ(t,!0):Zue(t)}var que=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yue=/^\w*$/;function j3(t,e){if(el(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||OM(t)?!0:Yue.test(t)||!que.test(t)||e!=null&&t in Object(e)}var P1=uv(Object,"create");function Xue(){this.__data__=P1?P1(null):{},this.size=0}function Que(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Kue="__lodash_hash_undefined__",Jue=Object.prototype,ece=Jue.hasOwnProperty;function tce(t){var e=this.__data__;if(P1){var r=e[t];return r===Kue?void 0:r}return ece.call(e,t)?e[t]:void 0}var rce=Object.prototype,nce=rce.hasOwnProperty;function ice(t){var e=this.__data__;return P1?e[t]!==void 0:nce.call(e,t)}var ace="__lodash_hash_undefined__";function oce(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=P1&&e===void 0?ace:e,this}function Xg(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Xg.prototype.clear=Xue;Xg.prototype.delete=Que;Xg.prototype.get=tce;Xg.prototype.has=ice;Xg.prototype.set=oce;function sce(){this.__data__=[],this.size=0}function BM(t,e){for(var r=t.length;r--;)if(mb(t[r][0],e))return r;return-1}var lce=Array.prototype,uce=lce.splice;function cce(t){var e=this.__data__,r=BM(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():uce.call(e,r,1),--this.size,!0}function hce(t){var e=this.__data__,r=BM(e,t);return r<0?void 0:e[r][1]}function fce(t){return BM(this.__data__,t)>-1}function dce(t,e){var r=this.__data__,n=BM(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function Sh(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Sh.prototype.clear=sce;Sh.prototype.delete=cce;Sh.prototype.get=hce;Sh.prototype.has=fce;Sh.prototype.set=dce;var L1=uv(bu,"Map");function pce(){this.size=0,this.__data__={hash:new Xg,map:new(L1||Sh),string:new Xg}}function gce(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function FM(t,e){var r=t.__data__;return gce(e)?r[typeof e=="string"?"string":"hash"]:r.map}function vce(t){var e=FM(this,t).delete(t);return this.size-=e?1:0,e}function mce(t){return FM(this,t).get(t)}function _ce(t){return FM(this,t).has(t)}function yce(t,e){var r=FM(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Th(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Th.prototype.clear=pce;Th.prototype.delete=vce;Th.prototype.get=mce;Th.prototype.has=_ce;Th.prototype.set=yce;var xce="Expected a function";function W3(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(xce);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var l=t.apply(this,n);return r.cache=a.set(i,l)||a,l};return r.cache=new(W3.Cache||Th),r}W3.Cache=Th;var bce=500;function wce(t){var e=W3(t,function(n){return r.size===bce&&r.clear(),n}),r=e.cache;return e}var Sce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Tce=/\\(\\)?/g,Ace=wce(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Sce,function(r,n,i,a){e.push(i?a.replace(Tce,"$1"):n||r)}),e});function Cce(t){return t==null?"":tZ(t)}function NM(t,e){return el(t)?t:j3(t,e)?[t]:Ace(Cce(t))}var Mce=1/0;function _b(t){if(typeof t=="string"||OM(t))return t;var e=t+"";return e=="0"&&1/t==-Mce?"-0":e}function Z3(t,e){e=NM(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[_b(e[r++])];return r&&r==n?t:void 0}function R1(t,e,r){var n=t==null?void 0:Z3(t,e);return n===void 0?r:n}function hZ(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var g6=sc?sc.isConcatSpreadable:void 0;function Ice(t){return el(t)||D1(t)||!!(g6&&t&&t[g6])}function fZ(t,e,r,n,i){var a=-1,l=t.length;for(r||(r=Ice),i||(i=[]);++a<l;){var c=t[a];r(c)?hZ(i,c):i[i.length]=c}return i}function Ece(t){var e=t==null?0:t.length;return e?fZ(t):[]}function Dce(t){return rZ(iZ(t,void 0,Ece),t+"")}var dZ=uZ(Object.getPrototypeOf,Object),Pce="[object Object]",Lce=Function.prototype,Rce=Object.prototype,pZ=Lce.toString,kce=Rce.hasOwnProperty,Oce=pZ.call(Object);function zce(t){if(!dd(t)||sv(t)!=Pce)return!1;var e=dZ(t);if(e===null)return!0;var r=kce.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&pZ.call(r)==Oce}function Bce(){this.__data__=new Sh,this.size=0}function Fce(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function Nce(t){return this.__data__.get(t)}function Vce(t){return this.__data__.has(t)}var Gce=200;function Uce(t,e){var r=this.__data__;if(r instanceof Sh){var n=r.__data__;if(!L1||n.length<Gce-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Th(n)}return r.set(t,e),this.size=r.size,this}function nc(t){var e=this.__data__=new Sh(t);this.size=e.size}nc.prototype.clear=Bce;nc.prototype.delete=Fce;nc.prototype.get=Nce;nc.prototype.has=Vce;nc.prototype.set=Uce;var gZ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,v6=gZ&&typeof module=="object"&&module&&!module.nodeType&&module,$ce=v6&&v6.exports===gZ,m6=$ce?bu.Buffer:void 0;m6&&m6.allocUnsafe;function Hce(t,e){return t.slice()}function jce(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var l=t[r];e(l,r,t)&&(a[i++]=l)}return a}function Wce(){return[]}var Zce=Object.prototype,qce=Zce.propertyIsEnumerable,_6=Object.getOwnPropertySymbols,Yce=_6?function(t){return t==null?[]:(t=Object(t),jce(_6(t),function(e){return qce.call(t,e)}))}:Wce;function Xce(t,e,r){var n=e(t);return el(t)?n:hZ(n,r(t))}function y6(t){return Xce(t,H3,Yce)}var QR=uv(bu,"DataView"),KR=uv(bu,"Promise"),JR=uv(bu,"Set"),x6="[object Map]",Qce="[object Object]",b6="[object Promise]",w6="[object Set]",S6="[object WeakMap]",T6="[object DataView]",Kce=lv(QR),Jce=lv(L1),ehe=lv(KR),the=lv(JR),rhe=lv(XR),Vf=sv;(QR&&Vf(new QR(new ArrayBuffer(1)))!=T6||L1&&Vf(new L1)!=x6||KR&&Vf(KR.resolve())!=b6||JR&&Vf(new JR)!=w6||XR&&Vf(new XR)!=S6)&&(Vf=function(t){var e=sv(t),r=e==Qce?t.constructor:void 0,n=r?lv(r):"";if(n)switch(n){case Kce:return T6;case Jce:return x6;case ehe:return b6;case the:return w6;case rhe:return S6}return e});var gC=bu.Uint8Array;function nhe(t){var e=new t.constructor(t.byteLength);return new gC(e).set(new gC(t)),e}function ihe(t,e){var r=nhe(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function ahe(t){return typeof t.constructor=="function"&&!U3(t)?Nle(dZ(t)):{}}var ohe="__lodash_hash_undefined__";function she(t){return this.__data__.set(t,ohe),this}function lhe(t){return this.__data__.has(t)}function vC(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Th;++e<r;)this.add(t[e])}vC.prototype.add=vC.prototype.push=she;vC.prototype.has=lhe;function uhe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function che(t,e){return t.has(e)}var hhe=1,fhe=2;function vZ(t,e,r,n,i,a){var l=r&hhe,c=t.length,o=e.length;if(c!=o&&!(l&&o>c))return!1;var d=a.get(t),g=a.get(e);if(d&&g)return d==e&&g==t;var m=-1,y=!0,x=r&fhe?new vC:void 0;for(a.set(t,e),a.set(e,t);++m<c;){var A=t[m],M=e[m];if(n)var D=l?n(M,A,m,e,t,a):n(A,M,m,t,e,a);if(D!==void 0){if(D)continue;y=!1;break}if(x){if(!uhe(e,function(P,O){if(!che(x,O)&&(A===P||i(A,P,r,n,a)))return x.push(O)})){y=!1;break}}else if(!(A===M||i(A,M,r,n,a))){y=!1;break}}return a.delete(t),a.delete(e),y}function dhe(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function phe(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var ghe=1,vhe=2,mhe="[object Boolean]",_he="[object Date]",yhe="[object Error]",xhe="[object Map]",bhe="[object Number]",whe="[object RegExp]",She="[object Set]",The="[object String]",Ahe="[object Symbol]",Che="[object ArrayBuffer]",Mhe="[object DataView]",A6=sc?sc.prototype:void 0,XD=A6?A6.valueOf:void 0;function Ihe(t,e,r,n,i,a,l){switch(r){case Mhe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Che:return!(t.byteLength!=e.byteLength||!a(new gC(t),new gC(e)));case mhe:case _he:case bhe:return mb(+t,+e);case yhe:return t.name==e.name&&t.message==e.message;case whe:case The:return t==e+"";case xhe:var c=dhe;case She:var o=n&ghe;if(c||(c=phe),t.size!=e.size&&!o)return!1;var d=l.get(t);if(d)return d==e;n|=vhe,l.set(t,e);var g=vZ(c(t),c(e),n,i,a,l);return l.delete(t),g;case Ahe:if(XD)return XD.call(t)==XD.call(e)}return!1}var Ehe=1,Dhe=Object.prototype,Phe=Dhe.hasOwnProperty;function Lhe(t,e,r,n,i,a){var l=r&Ehe,c=y6(t),o=c.length,d=y6(e),g=d.length;if(o!=g&&!l)return!1;for(var m=o;m--;){var y=c[m];if(!(l?y in e:Phe.call(e,y)))return!1}var x=a.get(t),A=a.get(e);if(x&&A)return x==e&&A==t;var M=!0;a.set(t,e),a.set(e,t);for(var D=l;++m<o;){y=c[m];var P=t[y],O=e[y];if(n)var z=l?n(O,P,y,e,t,a):n(P,O,y,t,e,a);if(!(z===void 0?P===O||i(P,O,r,n,a):z)){M=!1;break}D||(D=y=="constructor")}if(M&&!D){var V=t.constructor,H=e.constructor;V!=H&&"constructor"in t&&"constructor"in e&&!(typeof V=="function"&&V instanceof V&&typeof H=="function"&&H instanceof H)&&(M=!1)}return a.delete(t),a.delete(e),M}var Rhe=1,C6="[object Arguments]",M6="[object Array]",lT="[object Object]",khe=Object.prototype,I6=khe.hasOwnProperty;function Ohe(t,e,r,n,i,a){var l=el(t),c=el(e),o=l?M6:Vf(t),d=c?M6:Vf(e);o=o==C6?lT:o,d=d==C6?lT:d;var g=o==lT,m=d==lT,y=o==d;if(y&&pC(t)){if(!pC(e))return!1;l=!0,g=!1}if(y&&!g)return a||(a=new nc),l||$3(t)?vZ(t,e,r,n,i,a):Ihe(t,e,o,r,n,i,a);if(!(r&Rhe)){var x=g&&I6.call(t,"__wrapped__"),A=m&&I6.call(e,"__wrapped__");if(x||A){var M=x?t.value():t,D=A?e.value():e;return a||(a=new nc),i(M,D,r,n,a)}}return y?(a||(a=new nc),Lhe(t,e,r,n,i,a)):!1}function VM(t,e,r,n,i){return t===e?!0:t==null||e==null||!dd(t)&&!dd(e)?t!==t&&e!==e:Ohe(t,e,r,n,VM,i)}var zhe=1,Bhe=2;function Fhe(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var l=r[i];if(l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++i<a;){l=r[i];var c=l[0],o=t[c],d=l[1];if(l[2]){if(o===void 0&&!(c in t))return!1}else{var g=new nc,m;if(!(m===void 0?VM(d,o,zhe|Bhe,n,g):m))return!1}}return!0}function mZ(t){return t===t&&!tl(t)}function Nhe(t){for(var e=H3(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,mZ(i)]}return e}function _Z(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function Vhe(t){var e=Nhe(t);return e.length==1&&e[0][2]?_Z(e[0][0],e[0][1]):function(r){return r===t||Fhe(r,t,e)}}function Ghe(t,e){return t!=null&&e in Object(t)}function Uhe(t,e,r){e=NM(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var l=_b(e[n]);if(!(a=t!=null&&r(t,l)))break;t=t[l]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&G3(i)&&zM(l,i)&&(el(t)||D1(t)))}function yZ(t,e){return t!=null&&Uhe(t,e,Ghe)}var $he=1,Hhe=2;function jhe(t,e){return j3(t)&&mZ(e)?_Z(_b(t),e):function(r){var n=R1(r,t);return n===void 0&&n===e?yZ(r,t):VM(e,n,$he|Hhe)}}function Whe(t){return function(e){return e==null?void 0:e[t]}}function Zhe(t){return function(e){return Z3(e,t)}}function qhe(t){return j3(t)?Whe(_b(t)):Zhe(t)}function Yhe(t){return typeof t=="function"?t:t==null?F3:typeof t=="object"?el(t)?jhe(t[0],t[1]):Vhe(t):qhe(t)}function Xhe(t){return function(e,r,n){for(var i=-1,a=Object(e),l=n(e),c=l.length;c--;){var o=l[++i];if(r(a[o],o,a)===!1)break}return e}}var xZ=Xhe();function Qhe(t,e){return t&&xZ(t,e,H3)}function Khe(t,e){return function(r,n){if(r==null)return r;if(!ty(r))return t(r,n);for(var i=r.length,a=-1,l=Object(r);++a<i&&n(l[a],a,l)!==!1;);return r}}var Jhe=Khe(Qhe),QD=function(){return bu.Date.now()},efe="Expected a function",tfe=Math.max,rfe=Math.min;function mC(t,e,r){var n,i,a,l,c,o,d=0,g=!1,m=!1,y=!0;if(typeof t!="function")throw new TypeError(efe);e=o6(e)||0,tl(r)&&(g=!!r.leading,m="maxWait"in r,a=m?tfe(o6(r.maxWait)||0,e):a,y="trailing"in r?!!r.trailing:y);function x($){var X=n,W=i;return n=i=void 0,d=$,l=t.apply(W,X),l}function A($){return d=$,c=setTimeout(P,e),g?x($):l}function M($){var X=$-o,W=$-d,Y=e-X;return m?rfe(Y,a-W):Y}function D($){var X=$-o,W=$-d;return o===void 0||X>=e||X<0||m&&W>=a}function P(){var $=QD();if(D($))return O($);c=setTimeout(P,M($))}function O($){return c=void 0,y&&n?x($):(n=i=void 0,l)}function z(){c!==void 0&&clearTimeout(c),d=0,n=o=i=c=void 0}function V(){return c===void 0?l:O(QD())}function H(){var $=QD(),X=D($);if(n=arguments,i=this,o=$,X){if(c===void 0)return A(o);if(m)return clearTimeout(c),c=setTimeout(P,e),x(o)}return c===void 0&&(c=setTimeout(P,e)),l}return H.cancel=z,H.flush=V,H}function ek(t,e,r){(r!==void 0&&!mb(t[e],r)||r===void 0&&!(e in t))&&V3(t,e,r)}function nfe(t){return dd(t)&&ty(t)}function tk(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function ife(t){return Kle(t,cZ(t))}function afe(t,e,r,n,i,a,l){var c=tk(t,r),o=tk(e,r),d=l.get(o);if(d){ek(t,r,d);return}var g=a?a(c,o,r+"",t,e,l):void 0,m=g===void 0;if(m){var y=el(o),x=!y&&pC(o),A=!y&&!x&&$3(o);g=o,y||x||A?el(c)?g=c:nfe(c)?g=Gle(c):x?(m=!1,g=Hce(o)):A?(m=!1,g=ihe(o)):g=[]:zce(o)||D1(o)?(g=c,D1(c)?g=ife(c):(!tl(c)||N3(c))&&(g=ahe(o))):m=!1}m&&(l.set(o,g),i(g,o,n,a,l),l.delete(o)),ek(t,r,g)}function bZ(t,e,r,n,i){t!==e&&xZ(e,function(a,l){if(i||(i=new nc),tl(a))afe(t,e,l,r,bZ,n,i);else{var c=n?n(tk(t,l),a,l+"",t,e,i):void 0;c===void 0&&(c=a),ek(t,l,c)}},cZ)}function ofe(t,e){var r=-1,n=ty(t)?Array(t.length):[];return Jhe(t,function(i,a,l){n[++r]=e(i,a,l)}),n}function sfe(t,e){var r=el(t)?eZ:ofe;return r(t,Yhe(e))}function lfe(t,e){return fZ(sfe(t,e))}function rk(t){for(var e=-1,r=t==null?0:t.length,n={};++e<r;){var i=t[e];n[i[0]]=i[1]}return n}function ufe(t,e){return VM(t,e)}function P_(t){return t==null}function wZ(t){return t===void 0}var cfe=rue(function(t,e,r){bZ(t,e,r)});function SZ(t,e,r,n){if(!tl(t))return t;e=NM(e,t);for(var i=-1,a=e.length,l=a-1,c=t;c!=null&&++i<a;){var o=_b(e[i]),d=r;if(o==="__proto__"||o==="constructor"||o==="prototype")return t;if(i!=l){var g=c[o];d=void 0,d===void 0&&(d=tl(g)?g:zM(e[i+1])?[]:{})}nZ(c,o,d),c=c[o]}return t}function hfe(t,e,r){for(var n=-1,i=e.length,a={};++n<i;){var l=e[n],c=Z3(t,l);r(c,l)&&SZ(a,NM(l,t),c)}return a}function ffe(t,e){return hfe(t,e,function(r,n){return yZ(t,n)})}var TZ=Dce(function(t,e){return t==null?{}:ffe(t,e)});function dfe(t,e,r){return t==null?t:SZ(t,e,r)}const Qg=t=>t===void 0,Kg=t=>typeof t=="boolean",Fo=t=>typeof t=="number",L_=t=>typeof Element>"u"?!1:t instanceof Element,nk=t=>P_(t),pfe=t=>wi(t)?!Number.isNaN(Number(t)):!1,gfe=t=>fa?window.requestAnimationFrame(t):setTimeout(t,16),Hf=t=>pb(t),vfe=(t,e,r)=>({get value(){return R1(t,e,r)},set value(n){dfe(t,e,n)}});class mfe extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function lc(t,e){throw new mfe(`[${t}] ${e}`)}const AZ=(t="")=>t.split(" ").filter(e=>!!e.trim()),Og=(t,e)=>{if(!t||!e)return!1;if(e.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(e)},eh=(t,e)=>{!t||!e.trim()||t.classList.add(...AZ(e))},ih=(t,e)=>{!t||!e.trim()||t.classList.remove(...AZ(e))},_fe=(t,e)=>{var r;if(!fa||!t||!e)return"";let n=_u(e);n==="float"&&(n="cssFloat");try{const i=t.style[n];if(i)return i;const a=(r=document.defaultView)==null?void 0:r.getComputedStyle(t,"");return a?a[n]:""}catch{return t.style[n]}};function R_(t,e="px"){if(!t)return"";if(Fo(t)||pfe(t))return`${t}${e}`;if(wi(t))return t}let uT;const yfe=t=>{var e;if(!fa)return 0;if(uT!==void 0)return uT;const r=document.createElement("div");r.className=`${t}-scrollbar__wrap`,r.style.visibility="hidden",r.style.width="100px",r.style.position="absolute",r.style.top="-9999px",document.body.appendChild(r);const n=r.offsetWidth;r.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",r.appendChild(i);const a=i.offsetWidth;return(e=r.parentNode)==null||e.removeChild(r),uT=n-a,uT};/*! Element Plus Icons Vue v2.3.1 */var xfe=Mr({name:"ArrowDown",__name:"arrow-down",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),CZ=xfe,bfe=Mr({name:"ArrowLeft",__name:"arrow-left",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),wfe=bfe,Sfe=Mr({name:"ArrowRight",__name:"arrow-right",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),GM=Sfe,Tfe=Mr({name:"ArrowUp",__name:"arrow-up",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),Afe=Tfe,Cfe=Mr({name:"Close",__name:"close",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),_C=Cfe,Mfe=Mr({name:"Loading",__name:"loading",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),MZ=Mfe,Ife=Mr({name:"More",__name:"more",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),Efe=Ife,Dfe=Mr({name:"Plus",__name:"plus",setup(t){return(e,r)=>(Nt(),Gr("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[wt("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),Pfe=Dfe;const IZ="__epPropKey",Qn=t=>t,Lfe=t=>fi(t)&&!!t[IZ],UM=(t,e)=>{if(!fi(t)||Lfe(t))return t;const{values:r,required:n,default:i,type:a,validator:l}=t,o={type:a,required:!!n,validator:r||l?d=>{let g=!1,m=[];if(r&&(m=Array.from(r),ni(t,"default")&&m.push(i),g||(g=m.includes(d))),l&&(g||(g=l(d))),!g&&m.length>0){const y=[...new Set(m)].map(x=>JSON.stringify(x)).join(", ");Xoe(`Invalid prop: validation failed${e?` for prop "${e}"`:""}. Expected one of [${y}], got value ${JSON.stringify(d)}.`)}return g}:void 0,[IZ]:!0};return ni(t,"default")&&(o.default=i),o},zi=t=>rk(Object.entries(t).map(([e,r])=>[e,UM(r,e)])),Zf=Qn([String,Object,Function]),ss=(t,e)=>{if(t.install=r=>{for(const n of[t,...Object.values(e??{})])r.component(n.name,n)},e)for(const[r,n]of Object.entries(e))t[r]=n;return t},Bl=t=>(t.install=Oa,t),co={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},Cd="update:modelValue",EZ=["","default","small","large"];var CA=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(CA||{});const n1=t=>{const e=Wr(t)?t:[t],r=[];return e.forEach(n=>{var i;Wr(n)?r.push(...n1(n)):Zg(n)&&Wr(n.children)?r.push(...n1(n.children)):(r.push(n),Zg(n)&&((i=n.component)!=null&&i.subTree)&&r.push(...n1(n.component.subTree)))}),r},jf=t=>t,bg=({from:t,replacement:e,scope:r,version:n,ref:i,type:a="API"},l)=>{un(()=>Pe(l),c=>{},{immediate:!0})};var Rfe={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const kfe=t=>(e,r)=>Ofe(e,r,Pe(t)),Ofe=(t,e,r)=>R1(r,t,t).replace(/\{(\w+)\}/g,(n,i)=>{var a;return`${(a=e==null?void 0:e[i])!=null?a:`{${i}}`}`}),zfe=t=>{const e=gt(()=>Pe(t).name),r=qi(t)?t:at(t);return{lang:e,locale:r,t:kfe(t)}},Bfe=Symbol("localeContextKey"),$M=t=>{const e=Mn(Bfe,at());return zfe(gt(()=>e.value||Rfe))},MA="el",Ffe="is-",Bp=(t,e,r,n,i)=>{let a=`${t}-${e}`;return r&&(a+=`-${r}`),n&&(a+=`__${n}`),i&&(a+=`--${i}`),a},Nfe=Symbol("namespaceContextKey"),q3=t=>{const e=Mi()?Mn(Nfe,at(MA)):at(MA);return gt(()=>Pe(e)||MA)},yn=(t,e)=>{const r=q3();return{namespace:r,b:(M="")=>Bp(r.value,t,M,"",""),e:M=>M?Bp(r.value,t,"",M,""):"",m:M=>M?Bp(r.value,t,"","",M):"",be:(M,D)=>M&&D?Bp(r.value,t,M,D,""):"",em:(M,D)=>M&&D?Bp(r.value,t,"",M,D):"",bm:(M,D)=>M&&D?Bp(r.value,t,M,"",D):"",bem:(M,D,P)=>M&&D&&P?Bp(r.value,t,M,D,P):"",is:(M,...D)=>{const P=D.length>=1?D[0]:!0;return M&&P?`${Ffe}${M}`:""},cssVar:M=>{const D={};for(const P in M)M[P]&&(D[`--${r.value}-${P}`]=M[P]);return D},cssVarName:M=>`--${r.value}-${M}`,cssVarBlock:M=>{const D={};for(const P in M)M[P]&&(D[`--${r.value}-${t}-${P}`]=M[P]);return D},cssVarBlockName:M=>`--${r.value}-${t}-${M}`}},Vfe=(t,e={})=>{qi(t)||lc("[useLockscreen]","You need to pass a ref param to this function");const r=e.ns||yn("popup"),n=gt(()=>r.bm("parent","hidden"));if(!fa||Og(document.body,n.value))return;let i=0,a=!1,l="0";const c=()=>{setTimeout(()=>{ih(document==null?void 0:document.body,n.value),a&&document&&(document.body.style.width=l)},200)};un(t,o=>{if(!o){c();return}a=!Og(document.body,n.value),a&&(l=document.body.style.width),i=yfe(r.namespace.value);const d=document.documentElement.clientHeight<document.body.scrollHeight,g=_fe(document.body,"overflowY");i>0&&(d||g==="scroll")&&a&&(document.body.style.width=`calc(100% - ${i}px)`),eh(document.body,n.value)}),m3(()=>c())},Gfe=UM({type:Qn(Boolean),default:null}),Ufe=UM({type:Qn(Function)}),DZ=t=>{const e=`update:${t}`,r=`onUpdate:${t}`,n=[e],i={[t]:Gfe,[r]:Ufe};return{useModelToggle:({indicator:l,toggleReason:c,shouldHideWhenRouteChanges:o,shouldProceed:d,onShow:g,onHide:m})=>{const y=Mi(),{emit:x}=y,A=y.props,M=gt(()=>Rn(A[r])),D=gt(()=>A[t]===null),P=X=>{l.value!==!0&&(l.value=!0,c&&(c.value=X),Rn(g)&&g(X))},O=X=>{l.value!==!1&&(l.value=!1,c&&(c.value=X),Rn(m)&&m(X))},z=X=>{if(A.disabled===!0||Rn(d)&&!d())return;const W=M.value&&fa;W&&x(e,!0),(D.value||!W)&&P(X)},V=X=>{if(A.disabled===!0||!fa)return;const W=M.value&&fa;W&&x(e,!1),(D.value||!W)&&O(X)},H=X=>{Kg(X)&&(A.disabled&&X?M.value&&x(e,!1):l.value!==X&&(X?P():O()))},$=()=>{l.value?V():z()};return un(()=>A[t],H),o&&y.appContext.config.globalProperties.$route!==void 0&&un(()=>({...y.proxy.$route}),()=>{o.value&&l.value&&V()}),Vn(()=>{H(A[t])}),{hide:V,show:z,toggle:$,hasUpdateHandler:M}},useModelToggleProps:i,useModelToggleEmits:n}};DZ("modelValue");const PZ=t=>{const e=Mi();return gt(()=>{var r,n;return(n=(r=e==null?void 0:e.proxy)==null?void 0:r.$props)==null?void 0:n[t]})};var Ss="top",kl="bottom",Ol="right",Ts="left",Y3="auto",yb=[Ss,kl,Ol,Ts],k_="start",k1="end",$fe="clippingParents",LZ="viewport",ax="popper",Hfe="reference",E6=yb.reduce(function(t,e){return t.concat([e+"-"+k_,e+"-"+k1])},[]),X3=[].concat(yb,[Y3]).reduce(function(t,e){return t.concat([e,e+"-"+k_,e+"-"+k1])},[]),jfe="beforeRead",Wfe="read",Zfe="afterRead",qfe="beforeMain",Yfe="main",Xfe="afterMain",Qfe="beforeWrite",Kfe="write",Jfe="afterWrite",ede=[jfe,Wfe,Zfe,qfe,Yfe,Xfe,Qfe,Kfe,Jfe];function uc(t){return t?(t.nodeName||"").toLowerCase():null}function wu(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function O_(t){var e=wu(t).Element;return t instanceof e||t instanceof Element}function Pl(t){var e=wu(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Q3(t){if(typeof ShadowRoot>"u")return!1;var e=wu(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function tde(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!Pl(a)||!uc(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(l){var c=i[l];c===!1?a.removeAttribute(l):a.setAttribute(l,c===!0?"":c)}))})}function rde(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},l=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),c=l.reduce(function(o,d){return o[d]="",o},{});!Pl(i)||!uc(i)||(Object.assign(i.style,c),Object.keys(a).forEach(function(o){i.removeAttribute(o)}))})}}var RZ={name:"applyStyles",enabled:!0,phase:"write",fn:tde,effect:rde,requires:["computeStyles"]};function ic(t){return t.split("-")[0]}var zg=Math.max,yC=Math.min,z_=Math.round;function B_(t,e){e===void 0&&(e=!1);var r=t.getBoundingClientRect(),n=1,i=1;if(Pl(t)&&e){var a=t.offsetHeight,l=t.offsetWidth;l>0&&(n=z_(r.width)/l||1),a>0&&(i=z_(r.height)/a||1)}return{width:r.width/n,height:r.height/i,top:r.top/i,right:r.right/n,bottom:r.bottom/i,left:r.left/n,x:r.left/n,y:r.top/i}}function K3(t){var e=B_(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function kZ(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&Q3(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function fh(t){return wu(t).getComputedStyle(t)}function nde(t){return["table","td","th"].indexOf(uc(t))>=0}function Md(t){return((O_(t)?t.ownerDocument:t.document)||window.document).documentElement}function HM(t){return uc(t)==="html"?t:t.assignedSlot||t.parentNode||(Q3(t)?t.host:null)||Md(t)}function D6(t){return!Pl(t)||fh(t).position==="fixed"?null:t.offsetParent}function ide(t){var e=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,r=navigator.userAgent.indexOf("Trident")!==-1;if(r&&Pl(t)){var n=fh(t);if(n.position==="fixed")return null}var i=HM(t);for(Q3(i)&&(i=i.host);Pl(i)&&["html","body"].indexOf(uc(i))<0;){var a=fh(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function xb(t){for(var e=wu(t),r=D6(t);r&&nde(r)&&fh(r).position==="static";)r=D6(r);return r&&(uc(r)==="html"||uc(r)==="body"&&fh(r).position==="static")?e:r||ide(t)||e}function J3(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function i1(t,e,r){return zg(t,yC(e,r))}function ade(t,e,r){var n=i1(t,e,r);return n>r?r:n}function OZ(){return{top:0,right:0,bottom:0,left:0}}function zZ(t){return Object.assign({},OZ(),t)}function BZ(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var ode=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,zZ(typeof t!="number"?t:BZ(t,yb))};function sde(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,l=r.modifiersData.popperOffsets,c=ic(r.placement),o=J3(c),d=[Ts,Ol].indexOf(c)>=0,g=d?"height":"width";if(!(!a||!l)){var m=ode(i.padding,r),y=K3(a),x=o==="y"?Ss:Ts,A=o==="y"?kl:Ol,M=r.rects.reference[g]+r.rects.reference[o]-l[o]-r.rects.popper[g],D=l[o]-r.rects.reference[o],P=xb(a),O=P?o==="y"?P.clientHeight||0:P.clientWidth||0:0,z=M/2-D/2,V=m[x],H=O-y[g]-m[A],$=O/2-y[g]/2+z,X=i1(V,$,H),W=o;r.modifiersData[n]=(e={},e[W]=X,e.centerOffset=X-$,e)}}function lde(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||!kZ(e.elements.popper,i)||(e.elements.arrow=i))}var ude={name:"arrow",enabled:!0,phase:"main",fn:sde,effect:lde,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function F_(t){return t.split("-")[1]}var cde={top:"auto",right:"auto",bottom:"auto",left:"auto"};function hde(t){var e=t.x,r=t.y,n=window,i=n.devicePixelRatio||1;return{x:z_(e*i)/i||0,y:z_(r*i)/i||0}}function P6(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,l=t.offsets,c=t.position,o=t.gpuAcceleration,d=t.adaptive,g=t.roundOffsets,m=t.isFixed,y=l.x,x=y===void 0?0:y,A=l.y,M=A===void 0?0:A,D=typeof g=="function"?g({x,y:M}):{x,y:M};x=D.x,M=D.y;var P=l.hasOwnProperty("x"),O=l.hasOwnProperty("y"),z=Ts,V=Ss,H=window;if(d){var $=xb(r),X="clientHeight",W="clientWidth";if($===wu(r)&&($=Md(r),fh($).position!=="static"&&c==="absolute"&&(X="scrollHeight",W="scrollWidth")),$=$,i===Ss||(i===Ts||i===Ol)&&a===k1){V=kl;var Y=m&&$===H&&H.visualViewport?H.visualViewport.height:$[X];M-=Y-n.height,M*=o?1:-1}if(i===Ts||(i===Ss||i===kl)&&a===k1){z=Ol;var J=m&&$===H&&H.visualViewport?H.visualViewport.width:$[W];x-=J-n.width,x*=o?1:-1}}var re=Object.assign({position:c},d&&cde),ae=g===!0?hde({x,y:M}):{x,y:M};if(x=ae.x,M=ae.y,o){var pe;return Object.assign({},re,(pe={},pe[V]=O?"0":"",pe[z]=P?"0":"",pe.transform=(H.devicePixelRatio||1)<=1?"translate("+x+"px, "+M+"px)":"translate3d("+x+"px, "+M+"px, 0)",pe))}return Object.assign({},re,(e={},e[V]=O?M+"px":"",e[z]=P?x+"px":"",e.transform="",e))}function fde(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,l=a===void 0?!0:a,c=r.roundOffsets,o=c===void 0?!0:c,d={placement:ic(e.placement),variation:F_(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,P6(Object.assign({},d,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:o})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,P6(Object.assign({},d,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var FZ={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:fde,data:{}},cT={passive:!0};function dde(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,l=n.resize,c=l===void 0?!0:l,o=wu(e.elements.popper),d=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&d.forEach(function(g){g.addEventListener("scroll",r.update,cT)}),c&&o.addEventListener("resize",r.update,cT),function(){a&&d.forEach(function(g){g.removeEventListener("scroll",r.update,cT)}),c&&o.removeEventListener("resize",r.update,cT)}}var NZ={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:dde,data:{}},pde={left:"right",right:"left",bottom:"top",top:"bottom"};function IA(t){return t.replace(/left|right|bottom|top/g,function(e){return pde[e]})}var gde={start:"end",end:"start"};function L6(t){return t.replace(/start|end/g,function(e){return gde[e]})}function ez(t){var e=wu(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function tz(t){return B_(Md(t)).left+ez(t).scrollLeft}function vde(t){var e=wu(t),r=Md(t),n=e.visualViewport,i=r.clientWidth,a=r.clientHeight,l=0,c=0;return n&&(i=n.width,a=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(l=n.offsetLeft,c=n.offsetTop)),{width:i,height:a,x:l+tz(t),y:c}}function mde(t){var e,r=Md(t),n=ez(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=zg(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=zg(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),c=-n.scrollLeft+tz(t),o=-n.scrollTop;return fh(i||r).direction==="rtl"&&(c+=zg(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:c,y:o}}function rz(t){var e=fh(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function VZ(t){return["html","body","#document"].indexOf(uc(t))>=0?t.ownerDocument.body:Pl(t)&&rz(t)?t:VZ(HM(t))}function a1(t,e){var r;e===void 0&&(e=[]);var n=VZ(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=wu(n),l=i?[a].concat(a.visualViewport||[],rz(n)?n:[]):n,c=e.concat(l);return i?c:c.concat(a1(HM(l)))}function ik(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function _de(t){var e=B_(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}function R6(t,e){return e===LZ?ik(vde(t)):O_(e)?_de(e):ik(mde(Md(t)))}function yde(t){var e=a1(HM(t)),r=["absolute","fixed"].indexOf(fh(t).position)>=0,n=r&&Pl(t)?xb(t):t;return O_(n)?e.filter(function(i){return O_(i)&&kZ(i,n)&&uc(i)!=="body"}):[]}function xde(t,e,r){var n=e==="clippingParents"?yde(t):[].concat(e),i=[].concat(n,[r]),a=i[0],l=i.reduce(function(c,o){var d=R6(t,o);return c.top=zg(d.top,c.top),c.right=yC(d.right,c.right),c.bottom=yC(d.bottom,c.bottom),c.left=zg(d.left,c.left),c},R6(t,a));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function GZ(t){var e=t.reference,r=t.element,n=t.placement,i=n?ic(n):null,a=n?F_(n):null,l=e.x+e.width/2-r.width/2,c=e.y+e.height/2-r.height/2,o;switch(i){case Ss:o={x:l,y:e.y-r.height};break;case kl:o={x:l,y:e.y+e.height};break;case Ol:o={x:e.x+e.width,y:c};break;case Ts:o={x:e.x-r.width,y:c};break;default:o={x:e.x,y:e.y}}var d=i?J3(i):null;if(d!=null){var g=d==="y"?"height":"width";switch(a){case k_:o[d]=o[d]-(e[g]/2-r[g]/2);break;case k1:o[d]=o[d]+(e[g]/2-r[g]/2);break}}return o}function O1(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.boundary,l=a===void 0?$fe:a,c=r.rootBoundary,o=c===void 0?LZ:c,d=r.elementContext,g=d===void 0?ax:d,m=r.altBoundary,y=m===void 0?!1:m,x=r.padding,A=x===void 0?0:x,M=zZ(typeof A!="number"?A:BZ(A,yb)),D=g===ax?Hfe:ax,P=t.rects.popper,O=t.elements[y?D:g],z=xde(O_(O)?O:O.contextElement||Md(t.elements.popper),l,o),V=B_(t.elements.reference),H=GZ({reference:V,element:P,strategy:"absolute",placement:i}),$=ik(Object.assign({},P,H)),X=g===ax?$:V,W={top:z.top-X.top+M.top,bottom:X.bottom-z.bottom+M.bottom,left:z.left-X.left+M.left,right:X.right-z.right+M.right},Y=t.modifiersData.offset;if(g===ax&&Y){var J=Y[i];Object.keys(W).forEach(function(re){var ae=[Ol,kl].indexOf(re)>=0?1:-1,pe=[Ss,kl].indexOf(re)>=0?"y":"x";W[re]+=J[pe]*ae})}return W}function bde(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,l=r.padding,c=r.flipVariations,o=r.allowedAutoPlacements,d=o===void 0?X3:o,g=F_(n),m=g?c?E6:E6.filter(function(A){return F_(A)===g}):yb,y=m.filter(function(A){return d.indexOf(A)>=0});y.length===0&&(y=m);var x=y.reduce(function(A,M){return A[M]=O1(t,{placement:M,boundary:i,rootBoundary:a,padding:l})[ic(M)],A},{});return Object.keys(x).sort(function(A,M){return x[A]-x[M]})}function wde(t){if(ic(t)===Y3)return[];var e=IA(t);return[L6(t),e,L6(e)]}function Sde(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,l=r.altAxis,c=l===void 0?!0:l,o=r.fallbackPlacements,d=r.padding,g=r.boundary,m=r.rootBoundary,y=r.altBoundary,x=r.flipVariations,A=x===void 0?!0:x,M=r.allowedAutoPlacements,D=e.options.placement,P=ic(D),O=P===D,z=o||(O||!A?[IA(D)]:wde(D)),V=[D].concat(z).reduce(function(Et,ar){return Et.concat(ic(ar)===Y3?bde(e,{placement:ar,boundary:g,rootBoundary:m,padding:d,flipVariations:A,allowedAutoPlacements:M}):ar)},[]),H=e.rects.reference,$=e.rects.popper,X=new Map,W=!0,Y=V[0],J=0;J<V.length;J++){var re=V[J],ae=ic(re),pe=F_(re)===k_,de=[Ss,kl].indexOf(ae)>=0,ve=de?"width":"height",me=O1(e,{placement:re,boundary:g,rootBoundary:m,altBoundary:y,padding:d}),Ie=de?pe?Ol:Ts:pe?kl:Ss;H[ve]>$[ve]&&(Ie=IA(Ie));var Le=IA(Ie),Ee=[];if(a&&Ee.push(me[ae]<=0),c&&Ee.push(me[Ie]<=0,me[Le]<=0),Ee.every(function(Et){return Et})){Y=re,W=!1;break}X.set(re,Ee)}if(W)for(var Ue=A?3:1,Ke=function(Et){var ar=V.find(function(ur){var cr=X.get(ur);if(cr)return cr.slice(0,Et).every(function(lt){return lt})});if(ar)return Y=ar,"break"},We=Ue;We>0;We--){var Rt=Ke(We);if(Rt==="break")break}e.placement!==Y&&(e.modifiersData[n]._skip=!0,e.placement=Y,e.reset=!0)}}var Tde={name:"flip",enabled:!0,phase:"main",fn:Sde,requiresIfExists:["offset"],data:{_skip:!1}};function k6(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function O6(t){return[Ss,Ol,kl,Ts].some(function(e){return t[e]>=0})}function Ade(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=O1(e,{elementContext:"reference"}),c=O1(e,{altBoundary:!0}),o=k6(l,n),d=k6(c,i,a),g=O6(o),m=O6(d);e.modifiersData[r]={referenceClippingOffsets:o,popperEscapeOffsets:d,isReferenceHidden:g,hasPopperEscaped:m},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":g,"data-popper-escaped":m})}var Cde={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Ade};function Mde(t,e,r){var n=ic(t),i=[Ts,Ss].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,l=a[0],c=a[1];return l=l||0,c=(c||0)*i,[Ts,Ol].indexOf(n)>=0?{x:c,y:l}:{x:l,y:c}}function Ide(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,l=X3.reduce(function(g,m){return g[m]=Mde(m,e.rects,a),g},{}),c=l[e.placement],o=c.x,d=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=o,e.modifiersData.popperOffsets.y+=d),e.modifiersData[n]=l}var Ede={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Ide};function Dde(t){var e=t.state,r=t.name;e.modifiersData[r]=GZ({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var UZ={name:"popperOffsets",enabled:!0,phase:"read",fn:Dde,data:{}};function Pde(t){return t==="x"?"y":"x"}function Lde(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,l=r.altAxis,c=l===void 0?!1:l,o=r.boundary,d=r.rootBoundary,g=r.altBoundary,m=r.padding,y=r.tether,x=y===void 0?!0:y,A=r.tetherOffset,M=A===void 0?0:A,D=O1(e,{boundary:o,rootBoundary:d,padding:m,altBoundary:g}),P=ic(e.placement),O=F_(e.placement),z=!O,V=J3(P),H=Pde(V),$=e.modifiersData.popperOffsets,X=e.rects.reference,W=e.rects.popper,Y=typeof M=="function"?M(Object.assign({},e.rects,{placement:e.placement})):M,J=typeof Y=="number"?{mainAxis:Y,altAxis:Y}:Object.assign({mainAxis:0,altAxis:0},Y),re=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,ae={x:0,y:0};if($){if(a){var pe,de=V==="y"?Ss:Ts,ve=V==="y"?kl:Ol,me=V==="y"?"height":"width",Ie=$[V],Le=Ie+D[de],Ee=Ie-D[ve],Ue=x?-W[me]/2:0,Ke=O===k_?X[me]:W[me],We=O===k_?-W[me]:-X[me],Rt=e.elements.arrow,Et=x&&Rt?K3(Rt):{width:0,height:0},ar=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:OZ(),ur=ar[de],cr=ar[ve],lt=i1(0,X[me],Et[me]),qt=z?X[me]/2-Ue-lt-ur-J.mainAxis:Ke-lt-ur-J.mainAxis,Ut=z?-X[me]/2+Ue+lt+cr+J.mainAxis:We+lt+cr+J.mainAxis,rr=e.elements.arrow&&xb(e.elements.arrow),br=rr?V==="y"?rr.clientTop||0:rr.clientLeft||0:0,Oe=(pe=re==null?void 0:re[V])!=null?pe:0,$e=Ie+qt-Oe-br,ct=Ie+Ut-Oe,bt=i1(x?yC(Le,$e):Le,Ie,x?zg(Ee,ct):Ee);$[V]=bt,ae[V]=bt-Ie}if(c){var At,Jt=V==="x"?Ss:Ts,mt=V==="x"?kl:Ol,ht=$[H],er=H==="y"?"height":"width",Bt=ht+D[Jt],qe=ht-D[mt],ge=[Ss,Ts].indexOf(P)!==-1,be=(At=re==null?void 0:re[H])!=null?At:0,ke=ge?Bt:ht-X[er]-W[er]-be+J.altAxis,tt=ge?ht+X[er]+W[er]-be-J.altAxis:qe,ut=x&&ge?ade(ke,ht,tt):i1(x?ke:Bt,ht,x?tt:qe);$[H]=ut,ae[H]=ut-ht}e.modifiersData[n]=ae}}var Rde={name:"preventOverflow",enabled:!0,phase:"main",fn:Lde,requiresIfExists:["offset"]};function kde(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Ode(t){return t===wu(t)||!Pl(t)?ez(t):kde(t)}function zde(t){var e=t.getBoundingClientRect(),r=z_(e.width)/t.offsetWidth||1,n=z_(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Bde(t,e,r){r===void 0&&(r=!1);var n=Pl(e),i=Pl(e)&&zde(e),a=Md(e),l=B_(t,i),c={scrollLeft:0,scrollTop:0},o={x:0,y:0};return(n||!n&&!r)&&((uc(e)!=="body"||rz(a))&&(c=Ode(e)),Pl(e)?(o=B_(e,!0),o.x+=e.clientLeft,o.y+=e.clientTop):a&&(o.x=tz(a))),{x:l.left+c.scrollLeft-o.x,y:l.top+c.scrollTop-o.y,width:l.width,height:l.height}}function Fde(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(c){if(!r.has(c)){var o=e.get(c);o&&i(o)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function Nde(t){var e=Fde(t);return ede.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Vde(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Gde(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var z6={placement:"bottom",modifiers:[],strategy:"absolute"};function B6(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function nz(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?z6:i;return function(l,c,o){o===void 0&&(o=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},z6,a),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},g=[],m=!1,y={state:d,setOptions:function(M){var D=typeof M=="function"?M(d.options):M;A(),d.options=Object.assign({},a,d.options,D),d.scrollParents={reference:O_(l)?a1(l):l.contextElement?a1(l.contextElement):[],popper:a1(c)};var P=Nde(Gde([].concat(n,d.options.modifiers)));return d.orderedModifiers=P.filter(function(O){return O.enabled}),x(),y.update()},forceUpdate:function(){if(!m){var M=d.elements,D=M.reference,P=M.popper;if(B6(D,P)){d.rects={reference:Bde(D,xb(P),d.options.strategy==="fixed"),popper:K3(P)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(W){return d.modifiersData[W.name]=Object.assign({},W.data)});for(var O=0;O<d.orderedModifiers.length;O++){if(d.reset===!0){d.reset=!1,O=-1;continue}var z=d.orderedModifiers[O],V=z.fn,H=z.options,$=H===void 0?{}:H,X=z.name;typeof V=="function"&&(d=V({state:d,options:$,name:X,instance:y})||d)}}}},update:Vde(function(){return new Promise(function(M){y.forceUpdate(),M(d)})}),destroy:function(){A(),m=!0}};if(!B6(l,c))return y;y.setOptions(o).then(function(M){!m&&o.onFirstUpdate&&o.onFirstUpdate(M)});function x(){d.orderedModifiers.forEach(function(M){var D=M.name,P=M.options,O=P===void 0?{}:P,z=M.effect;if(typeof z=="function"){var V=z({state:d,name:D,instance:y,options:O}),H=function(){};g.push(V||H)}})}function A(){g.forEach(function(M){return M()}),g=[]}return y}}nz();var Ude=[NZ,UZ,FZ,RZ];nz({defaultModifiers:Ude});var $de=[NZ,UZ,FZ,RZ,Ede,Tde,Rde,ude,Cde],Hde=nz({defaultModifiers:$de});const jde=(t,e,r={})=>{const n={name:"updateState",enabled:!0,phase:"write",fn:({state:o})=>{const d=Wde(o);Object.assign(l.value,d)},requires:["computeStyles"]},i=gt(()=>{const{onFirstUpdate:o,placement:d,strategy:g,modifiers:m}=Pe(r);return{onFirstUpdate:o,placement:d||"bottom",strategy:g||"absolute",modifiers:[...m||[],n,{name:"applyStyles",enabled:!1}]}}),a=C3(),l=at({styles:{popper:{position:Pe(i).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),c=()=>{a.value&&(a.value.destroy(),a.value=void 0)};return un(i,o=>{const d=Pe(a);d&&d.setOptions(o)},{deep:!0}),un([t,e],([o,d])=>{c(),!(!o||!d)&&(a.value=Hde(o,d,Pe(i)))}),Es(()=>{c()}),{state:gt(()=>{var o;return{...((o=Pe(a))==null?void 0:o.state)||{}}}),styles:gt(()=>Pe(l).styles),attributes:gt(()=>Pe(l).attributes),update:()=>{var o;return(o=Pe(a))==null?void 0:o.update()},forceUpdate:()=>{var o;return(o=Pe(a))==null?void 0:o.forceUpdate()},instanceRef:gt(()=>Pe(a))}};function Wde(t){const e=Object.keys(t.elements),r=rk(e.map(i=>[i,t.styles[i]||{}])),n=rk(e.map(i=>[i,t.attributes[i]]));return{styles:r,attributes:n}}const Zde=t=>{if(!t)return{onClick:Oa,onMousedown:Oa,onMouseup:Oa};let e=!1,r=!1;return{onClick:l=>{e&&r&&t(l),e=r=!1},onMousedown:l=>{e=l.target===l.currentTarget},onMouseup:l=>{r=l.target===l.currentTarget}}};function F6(){let t;const e=(n,i)=>{r(),t=window.setTimeout(n,i)},r=()=>window.clearTimeout(t);return RM(()=>r()),{registerTimeout:e,cancelTimeout:r}}const N6={prefix:Math.floor(Math.random()*1e4),current:0},qde=Symbol("elIdInjection"),$Z=()=>Mi()?Mn(qde,N6):N6,z1=t=>{const e=$Z(),r=q3();return gt(()=>Pe(t)||`${r.value}-id-${e.prefix}-${e.current++}`)};let c_=[];const V6=t=>{const e=t;e.key===co.esc&&c_.forEach(r=>r(e))},Yde=t=>{Vn(()=>{c_.length===0&&document.addEventListener("keydown",V6),fa&&c_.push(t)}),Es(()=>{c_=c_.filter(e=>e!==t),c_.length===0&&fa&&document.removeEventListener("keydown",V6)})};let G6;const HZ=()=>{const t=q3(),e=$Z(),r=gt(()=>`${t.value}-popper-container-${e.prefix}`),n=gt(()=>`#${r.value}`);return{id:r,selector:n}},Xde=t=>{const e=document.createElement("div");return e.id=t,document.body.appendChild(e),e},Qde=()=>{const{id:t,selector:e}=HZ();return MM(()=>{fa&&!G6&&!document.body.querySelector(e.value)&&(G6=Xde(t.value))}),{id:t,selector:e}},Kde=zi({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),Jde=({showAfter:t,hideAfter:e,autoClose:r,open:n,close:i})=>{const{registerTimeout:a}=F6(),{registerTimeout:l,cancelTimeout:c}=F6();return{onOpen:g=>{a(()=>{n(g);const m=Pe(r);Fo(m)&&m>0&&l(()=>{i(g)},m)},Pe(t))},onClose:g=>{c(),a(()=>{i(g)},Pe(e))}}},jZ=Symbol("elForwardRef"),epe=t=>{No(jZ,{setForwardRef:r=>{t.value=r}})},tpe=t=>({mounted(e){t(e)},updated(e){t(e)},unmounted(){t(null)}}),U6={current:0},$6=at(0),rpe=2e3,H6=Symbol("elZIndexContextKey"),npe=Symbol("zIndexContextKey"),WZ=t=>{const e=Mi()?Mn(H6,U6):U6,r=Mi()?Mn(npe,void 0):void 0,n=gt(()=>{const l=Pe(r);return Fo(l)?l:rpe}),i=gt(()=>n.value+$6.value),a=()=>(e.current++,$6.value=e.current,i.value);return!fa&&Mn(H6),{initialZIndex:n,currentZIndex:i,nextZIndex:a}},ipe=(t,e,r)=>n1(t.subTree).filter(a=>{var l;return Zg(a)&&((l=a.type)==null?void 0:l.name)===e&&!!a.component}).map(a=>a.component.uid).map(a=>r[a]).filter(a=>!!a),ape=(t,e)=>{const r={},n=C3([]);return{children:n,addChild:l=>{r[l.uid]=l,n.value=ipe(t,e,r)},removeChild:l=>{delete r[l],n.value=n.value.filter(c=>c.uid!==l)}}},jM=UM({type:String,values:EZ,required:!1}),ope=Symbol("size"),spe=()=>{const t=Mn(ope,{});return gt(()=>Pe(t.size)||"")},lpe=zi({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),bb=t=>TZ(lpe,t),upe=Symbol(),j6=at();function ZZ(t,e=void 0){const r=Mi()?Mn(upe,j6):j6;return t?gt(()=>{var n,i;return(i=(n=r.value)==null?void 0:n[t])!=null?i:e}):r}var _i=(t,e)=>{const r=t.__vccOpts||t;for(const[n,i]of e)r[n]=i;return r};const cpe=zi({size:{type:Qn([Number,String])},color:{type:String}}),hpe=Mr({name:"ElIcon",inheritAttrs:!1}),fpe=Mr({...hpe,props:cpe,setup(t){const e=t,r=yn("icon"),n=gt(()=>{const{size:i,color:a}=e;return!i&&!a?{}:{fontSize:Qg(i)?void 0:R_(i),"--color":a}});return(i,a)=>(Nt(),Gr("i",wh({class:Pe(r).b(),style:Pe(n)},i.$attrs),[Cn(i.$slots,"default")],16))}});var dpe=_i(fpe,[["__file","icon.vue"]]);const As=ss(dpe),iz=Symbol("formContextKey"),xC=Symbol("formItemContextKey"),B1=(t,e={})=>{const r=at(void 0),n=e.prop?r:PZ("size"),i=e.global?r:spe(),a=e.form?{size:void 0}:Mn(iz,void 0),l=e.formItem?{size:void 0}:Mn(xC,void 0);return gt(()=>n.value||Pe(t)||(l==null?void 0:l.size)||(a==null?void 0:a.size)||i.value||"")},az=t=>{const e=PZ("disabled"),r=Mn(iz,void 0);return gt(()=>e.value||Pe(t)||(r==null?void 0:r.disabled)||!1)},WM=()=>{const t=Mn(iz,void 0),e=Mn(xC,void 0);return{form:t,formItem:e}},qZ=(t,{formItemContext:e,disableIdGeneration:r,disableIdManagement:n})=>{r||(r=at(!1)),n||(n=at(!1));const i=at();let a;const l=gt(()=>{var c;return!!(!(t.label||t.ariaLabel)&&e&&e.inputIds&&((c=e.inputIds)==null?void 0:c.length)<=1)});return Vn(()=>{a=un([Il(t,"id"),r],([c,o])=>{const d=c??(o?void 0:z1().value);d!==i.value&&(e!=null&&e.removeInputId&&(i.value&&e.removeInputId(i.value),!(n!=null&&n.value)&&!o&&d&&e.addInputId(d)),i.value=d)},{immediate:!0})}),Td(()=>{a&&a(),e!=null&&e.removeInputId&&i.value&&e.removeInputId(i.value)}),{isLabeledByFormItem:l,inputId:i}},Gm=4,ppe={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},gpe=({move:t,size:e,bar:r})=>({[r.size]:e,transform:`translate${r.axis}(${t}%)`}),oz=Symbol("scrollbarContextKey"),vpe=zi({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),mpe="Thumb",_pe=Mr({__name:"thumb",props:vpe,setup(t){const e=t,r=Mn(oz),n=yn("scrollbar");r||lc(mpe,"can not inject scrollbar context");const i=at(),a=at(),l=at({}),c=at(!1);let o=!1,d=!1,g=fa?document.onselectstart:null;const m=gt(()=>ppe[e.vertical?"vertical":"horizontal"]),y=gt(()=>gpe({size:e.size,move:e.move,bar:m.value})),x=gt(()=>i.value[m.value.offset]**2/r.wrapElement[m.value.scrollSize]/e.ratio/a.value[m.value.offset]),A=$=>{var X;if($.stopPropagation(),$.ctrlKey||[1,2].includes($.button))return;(X=window.getSelection())==null||X.removeAllRanges(),D($);const W=$.currentTarget;W&&(l.value[m.value.axis]=W[m.value.offset]-($[m.value.client]-W.getBoundingClientRect()[m.value.direction]))},M=$=>{if(!a.value||!i.value||!r.wrapElement)return;const X=Math.abs($.target.getBoundingClientRect()[m.value.direction]-$[m.value.client]),W=a.value[m.value.offset]/2,Y=(X-W)*100*x.value/i.value[m.value.offset];r.wrapElement[m.value.scroll]=Y*r.wrapElement[m.value.scrollSize]/100},D=$=>{$.stopImmediatePropagation(),o=!0,document.addEventListener("mousemove",P),document.addEventListener("mouseup",O),g=document.onselectstart,document.onselectstart=()=>!1},P=$=>{if(!i.value||!a.value||o===!1)return;const X=l.value[m.value.axis];if(!X)return;const W=(i.value.getBoundingClientRect()[m.value.direction]-$[m.value.client])*-1,Y=a.value[m.value.offset]-X,J=(W-Y)*100*x.value/i.value[m.value.offset];r.wrapElement[m.value.scroll]=J*r.wrapElement[m.value.scrollSize]/100},O=()=>{o=!1,l.value[m.value.axis]=0,document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",O),H(),d&&(c.value=!1)},z=()=>{d=!1,c.value=!!e.size},V=()=>{d=!0,c.value=o};Es(()=>{H(),document.removeEventListener("mouseup",O)});const H=()=>{document.onselectstart!==g&&(document.onselectstart=g)};return pu(Il(r,"scrollbarElement"),"mousemove",z),pu(Il(r,"scrollbarElement"),"mouseleave",V),($,X)=>(Nt(),kr(Ad,{name:Pe(n).b("fade"),persisted:""},{default:pt(()=>[es(wt("div",{ref_key:"instance",ref:i,class:Lr([Pe(n).e("bar"),Pe(n).is(Pe(m).key)]),onMousedown:M},[wt("div",{ref_key:"thumb",ref:a,class:Lr(Pe(n).e("thumb")),style:va(Pe(y)),onMousedown:A},null,38)],34),[[qg,$.always||c.value]])]),_:1},8,["name"]))}});var W6=_i(_pe,[["__file","thumb.vue"]]);const ype=zi({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),xpe=Mr({__name:"bar",props:ype,setup(t,{expose:e}){const r=t,n=Mn(oz),i=at(0),a=at(0),l=at(""),c=at(""),o=at(1),d=at(1);return e({handleScroll:y=>{if(y){const x=y.offsetHeight-Gm,A=y.offsetWidth-Gm;a.value=y.scrollTop*100/x*o.value,i.value=y.scrollLeft*100/A*d.value}},update:()=>{const y=n==null?void 0:n.wrapElement;if(!y)return;const x=y.offsetHeight-Gm,A=y.offsetWidth-Gm,M=x**2/y.scrollHeight,D=A**2/y.scrollWidth,P=Math.max(M,r.minSize),O=Math.max(D,r.minSize);o.value=M/(x-M)/(P/(x-P)),d.value=D/(A-D)/(O/(A-O)),c.value=P+Gm<x?`${P}px`:"",l.value=O+Gm<A?`${O}px`:""}}),(y,x)=>(Nt(),Gr(ha,null,[He(W6,{move:i.value,ratio:d.value,size:l.value,always:y.always},null,8,["move","ratio","size","always"]),He(W6,{move:a.value,ratio:o.value,size:c.value,vertical:"",always:y.always},null,8,["move","ratio","size","always"])],64))}});var bpe=_i(xpe,[["__file","bar.vue"]]);const wpe=zi({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:Qn([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,...bb(["ariaLabel","ariaOrientation"])}),Spe={scroll:({scrollTop:t,scrollLeft:e})=>[t,e].every(Fo)},Tpe="ElScrollbar",Ape=Mr({name:Tpe}),Cpe=Mr({...Ape,props:wpe,emits:Spe,setup(t,{expose:e,emit:r}){const n=t,i=yn("scrollbar");let a,l;const c=at(),o=at(),d=at(),g=at(),m=gt(()=>{const z={};return n.height&&(z.height=R_(n.height)),n.maxHeight&&(z.maxHeight=R_(n.maxHeight)),[n.wrapStyle,z]}),y=gt(()=>[n.wrapClass,i.e("wrap"),{[i.em("wrap","hidden-default")]:!n.native}]),x=gt(()=>[i.e("view"),n.viewClass]),A=()=>{var z;o.value&&((z=g.value)==null||z.handleScroll(o.value),r("scroll",{scrollTop:o.value.scrollTop,scrollLeft:o.value.scrollLeft}))};function M(z,V){fi(z)?o.value.scrollTo(z):Fo(z)&&Fo(V)&&o.value.scrollTo(z,V)}const D=z=>{Fo(z)&&(o.value.scrollTop=z)},P=z=>{Fo(z)&&(o.value.scrollLeft=z)},O=()=>{var z;(z=g.value)==null||z.update()};return un(()=>n.noresize,z=>{z?(a==null||a(),l==null||l()):({stop:a}=D_(d,O),l=pu("resize",O))},{immediate:!0}),un(()=>[n.maxHeight,n.height],()=>{n.native||Fa(()=>{var z;O(),o.value&&((z=g.value)==null||z.handleScroll(o.value))})}),No(oz,gc({scrollbarElement:c,wrapElement:o})),Vn(()=>{n.native||Fa(()=>{O()})}),IM(()=>O()),e({wrapRef:o,update:O,scrollTo:M,setScrollTop:D,setScrollLeft:P,handleScroll:A}),(z,V)=>(Nt(),Gr("div",{ref_key:"scrollbarRef",ref:c,class:Lr(Pe(i).b())},[wt("div",{ref_key:"wrapRef",ref:o,class:Lr(Pe(y)),style:va(Pe(m)),onScroll:A},[(Nt(),kr(sd(z.tag),{id:z.id,ref_key:"resizeRef",ref:d,class:Lr(Pe(x)),style:va(z.viewStyle),role:z.role,"aria-label":z.ariaLabel,"aria-orientation":z.ariaOrientation},{default:pt(()=>[Cn(z.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),z.native?In("v-if",!0):(Nt(),kr(bpe,{key:0,ref_key:"barRef",ref:g,always:z.always,"min-size":z.minSize},null,8,["always","min-size"]))],2))}});var Mpe=_i(Cpe,[["__file","scrollbar.vue"]]);const ZM=ss(Mpe),sz=Symbol("popper"),YZ=Symbol("popperContent"),Ipe=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],XZ=zi({role:{type:String,values:Ipe,default:"tooltip"}}),Epe=Mr({name:"ElPopper",inheritAttrs:!1}),Dpe=Mr({...Epe,props:XZ,setup(t,{expose:e}){const r=t,n=at(),i=at(),a=at(),l=at(),c=gt(()=>r.role),o={triggerRef:n,popperInstanceRef:i,contentRef:a,referenceRef:l,role:c};return e(o),No(sz,o),(d,g)=>Cn(d.$slots,"default")}});var Ppe=_i(Dpe,[["__file","popper.vue"]]);const QZ=zi({arrowOffset:{type:Number,default:5}}),Lpe=Mr({name:"ElPopperArrow",inheritAttrs:!1}),Rpe=Mr({...Lpe,props:QZ,setup(t,{expose:e}){const r=t,n=yn("popper"),{arrowOffset:i,arrowRef:a,arrowStyle:l}=Mn(YZ,void 0);return un(()=>r.arrowOffset,c=>{i.value=c}),Es(()=>{a.value=void 0}),e({arrowRef:a}),(c,o)=>(Nt(),Gr("span",{ref_key:"arrowRef",ref:a,class:Lr(Pe(n).e("arrow")),style:va(Pe(l)),"data-popper-arrow":""},null,6))}});var kpe=_i(Rpe,[["__file","arrow.vue"]]);const Ope="ElOnlyChild",zpe=Mr({name:Ope,setup(t,{slots:e,attrs:r}){var n;const i=Mn(jZ),a=tpe((n=i==null?void 0:i.setForwardRef)!=null?n:Oa);return()=>{var l;const c=(l=e.default)==null?void 0:l.call(e,r);if(!c||c.length>1)return null;const o=KZ(c);return o?es(hh(o,r),[[a]]):null}}});function KZ(t){if(!t)return null;const e=t;for(const r of e){if(fi(r))switch(r.type){case Bo:continue;case ey:case"svg":return Z6(r);case ha:return KZ(r.children);default:return r}return Z6(r)}return null}function Z6(t){const e=yn("only-child");return He("span",{class:e.e("content")},[t])}const JZ=zi({virtualRef:{type:Qn(Object)},virtualTriggering:Boolean,onMouseenter:{type:Qn(Function)},onMouseleave:{type:Qn(Function)},onClick:{type:Qn(Function)},onKeydown:{type:Qn(Function)},onFocus:{type:Qn(Function)},onBlur:{type:Qn(Function)},onContextmenu:{type:Qn(Function)},id:String,open:Boolean}),Bpe=Mr({name:"ElPopperTrigger",inheritAttrs:!1}),Fpe=Mr({...Bpe,props:JZ,setup(t,{expose:e}){const r=t,{role:n,triggerRef:i}=Mn(sz,void 0);epe(i);const a=gt(()=>c.value?r.id:void 0),l=gt(()=>{if(n&&n.value==="tooltip")return r.open&&r.id?r.id:void 0}),c=gt(()=>{if(n&&n.value!=="tooltip")return n.value}),o=gt(()=>c.value?`${r.open}`:void 0);let d;return Vn(()=>{un(()=>r.virtualRef,g=>{g&&(i.value=Wf(g))},{immediate:!0}),un(i,(g,m)=>{d==null||d(),d=void 0,L_(g)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(y=>{var x;const A=r[y];A&&(g.addEventListener(y.slice(2).toLowerCase(),A),(x=m==null?void 0:m.removeEventListener)==null||x.call(m,y.slice(2).toLowerCase(),A))}),d=un([a,l,c,o],y=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((x,A)=>{P_(y[A])?g.removeAttribute(x):g.setAttribute(x,y[A])})},{immediate:!0})),L_(m)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(y=>m.removeAttribute(y))},{immediate:!0})}),Es(()=>{d==null||d(),d=void 0}),e({triggerRef:i}),(g,m)=>g.virtualTriggering?In("v-if",!0):(Nt(),kr(Pe(zpe),wh({key:0},g.$attrs,{"aria-controls":Pe(a),"aria-describedby":Pe(l),"aria-expanded":Pe(o),"aria-haspopup":Pe(c)}),{default:pt(()=>[Cn(g.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var Npe=_i(Fpe,[["__file","trigger.vue"]]);const KD="focus-trap.focus-after-trapped",JD="focus-trap.focus-after-released",Vpe="focus-trap.focusout-prevented",q6={cancelable:!0,bubbles:!1},Gpe={cancelable:!0,bubbles:!1},Y6="focusAfterTrapped",X6="focusAfterReleased",Upe=Symbol("elFocusTrap"),lz=at(),qM=at(0),uz=at(0);let hT=0;const eq=t=>{const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e},Q6=(t,e)=>{for(const r of t)if(!$pe(r,e))return r},$pe=(t,e)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},Hpe=t=>{const e=eq(t),r=Q6(e,t),n=Q6(e.reverse(),t);return[r,n]},jpe=t=>t instanceof HTMLInputElement&&"select"in t,Rf=(t,e)=>{if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),uz.value=window.performance.now(),t!==r&&jpe(t)&&e&&t.select()}};function K6(t,e){const r=[...t],n=t.indexOf(e);return n!==-1&&r.splice(n,1),r}const Wpe=()=>{let t=[];return{push:n=>{const i=t[0];i&&n!==i&&i.pause(),t=K6(t,n),t.unshift(n)},remove:n=>{var i,a;t=K6(t,n),(a=(i=t[0])==null?void 0:i.resume)==null||a.call(i)}}},Zpe=(t,e=!1)=>{const r=document.activeElement;for(const n of t)if(Rf(n,e),document.activeElement!==r)return},J6=Wpe(),qpe=()=>qM.value>uz.value,fT=()=>{lz.value="pointer",qM.value=window.performance.now()},eG=()=>{lz.value="keyboard",qM.value=window.performance.now()},Ype=()=>(Vn(()=>{hT===0&&(document.addEventListener("mousedown",fT),document.addEventListener("touchstart",fT),document.addEventListener("keydown",eG)),hT++}),Es(()=>{hT--,hT<=0&&(document.removeEventListener("mousedown",fT),document.removeEventListener("touchstart",fT),document.removeEventListener("keydown",eG))}),{focusReason:lz,lastUserFocusTimestamp:qM,lastAutomatedFocusTimestamp:uz}),dT=t=>new CustomEvent(Vpe,{...Gpe,detail:t}),Xpe=Mr({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Y6,X6,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:e}){const r=at();let n,i;const{focusReason:a}=Ype();Yde(A=>{t.trapped&&!l.paused&&e("release-requested",A)});const l={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},c=A=>{if(!t.loop&&!t.trapped||l.paused)return;const{key:M,altKey:D,ctrlKey:P,metaKey:O,currentTarget:z,shiftKey:V}=A,{loop:H}=t,$=M===co.tab&&!D&&!P&&!O,X=document.activeElement;if($&&X){const W=z,[Y,J]=Hpe(W);if(Y&&J){if(!V&&X===J){const ae=dT({focusReason:a.value});e("focusout-prevented",ae),ae.defaultPrevented||(A.preventDefault(),H&&Rf(Y,!0))}else if(V&&[Y,W].includes(X)){const ae=dT({focusReason:a.value});e("focusout-prevented",ae),ae.defaultPrevented||(A.preventDefault(),H&&Rf(J,!0))}}else if(X===W){const ae=dT({focusReason:a.value});e("focusout-prevented",ae),ae.defaultPrevented||A.preventDefault()}}};No(Upe,{focusTrapRef:r,onKeydown:c}),un(()=>t.focusTrapEl,A=>{A&&(r.value=A)},{immediate:!0}),un([r],([A],[M])=>{A&&(A.addEventListener("keydown",c),A.addEventListener("focusin",g),A.addEventListener("focusout",m)),M&&(M.removeEventListener("keydown",c),M.removeEventListener("focusin",g),M.removeEventListener("focusout",m))});const o=A=>{e(Y6,A)},d=A=>e(X6,A),g=A=>{const M=Pe(r);if(!M)return;const D=A.target,P=A.relatedTarget,O=D&&M.contains(D);t.trapped||P&&M.contains(P)||(n=P),O&&e("focusin",A),!l.paused&&t.trapped&&(O?i=D:Rf(i,!0))},m=A=>{const M=Pe(r);if(!(l.paused||!M))if(t.trapped){const D=A.relatedTarget;!P_(D)&&!M.contains(D)&&setTimeout(()=>{if(!l.paused&&t.trapped){const P=dT({focusReason:a.value});e("focusout-prevented",P),P.defaultPrevented||Rf(i,!0)}},0)}else{const D=A.target;D&&M.contains(D)||e("focusout",A)}};async function y(){await Fa();const A=Pe(r);if(A){J6.push(l);const M=A.contains(document.activeElement)?n:document.activeElement;if(n=M,!A.contains(M)){const P=new Event(KD,q6);A.addEventListener(KD,o),A.dispatchEvent(P),P.defaultPrevented||Fa(()=>{let O=t.focusStartEl;wi(O)||(Rf(O),document.activeElement!==O&&(O="first")),O==="first"&&Zpe(eq(A),!0),(document.activeElement===M||O==="container")&&Rf(A)})}}}function x(){const A=Pe(r);if(A){A.removeEventListener(KD,o);const M=new CustomEvent(JD,{...q6,detail:{focusReason:a.value}});A.addEventListener(JD,d),A.dispatchEvent(M),!M.defaultPrevented&&(a.value=="keyboard"||!qpe()||A.contains(document.activeElement))&&Rf(n??document.body),A.removeEventListener(JD,d),J6.remove(l)}}return Vn(()=>{t.trapped&&y(),un(()=>t.trapped,A=>{A?y():x()})}),Es(()=>{t.trapped&&x()}),{onKeydown:c}}});function Qpe(t,e,r,n,i,a){return Cn(t.$slots,"default",{handleKeydown:t.onKeydown})}var tq=_i(Xpe,[["render",Qpe],["__file","focus-trap.vue"]]);const Kpe=["fixed","absolute"],Jpe=zi({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:Qn(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:X3,default:"bottom"},popperOptions:{type:Qn(Object),default:()=>({})},strategy:{type:String,values:Kpe,default:"absolute"}}),rq=zi({...Jpe,id:String,style:{type:Qn([String,Array,Object])},className:{type:Qn([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:Qn([String,Array,Object])},popperStyle:{type:Qn([String,Array,Object])},referenceEl:{type:Qn(Object)},triggerTargetEl:{type:Qn(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...bb(["ariaLabel"])}),ege={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},tge=(t,e=[])=>{const{placement:r,strategy:n,popperOptions:i}=t,a={placement:r,strategy:n,...i,modifiers:[...nge(t),...e]};return ige(a,i==null?void 0:i.modifiers),a},rge=t=>{if(fa)return Wf(t)};function nge(t){const{offset:e,gpuAcceleration:r,fallbackPlacements:n}=t;return[{name:"offset",options:{offset:[0,e??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:n}},{name:"computeStyles",options:{gpuAcceleration:r}}]}function ige(t,e){e&&(t.modifiers=[...t.modifiers,...e??[]])}const age=0,oge=t=>{const{popperInstanceRef:e,contentRef:r,triggerRef:n,role:i}=Mn(sz,void 0),a=at(),l=at(),c=gt(()=>({name:"eventListeners",enabled:!!t.visible})),o=gt(()=>{var P;const O=Pe(a),z=(P=Pe(l))!=null?P:age;return{name:"arrow",enabled:!wZ(O),options:{element:O,padding:z}}}),d=gt(()=>({onFirstUpdate:()=>{A()},...tge(t,[Pe(o),Pe(c)])})),g=gt(()=>rge(t.referenceEl)||Pe(n)),{attributes:m,state:y,styles:x,update:A,forceUpdate:M,instanceRef:D}=jde(g,r,d);return un(D,P=>e.value=P),Vn(()=>{un(()=>{var P;return(P=Pe(g))==null?void 0:P.getBoundingClientRect()},()=>{A()})}),{attributes:m,arrowRef:a,contentRef:r,instanceRef:D,state:y,styles:x,role:i,forceUpdate:M,update:A}},sge=(t,{attributes:e,styles:r,role:n})=>{const{nextZIndex:i}=WZ(),a=yn("popper"),l=gt(()=>Pe(e).popper),c=at(Fo(t.zIndex)?t.zIndex:i()),o=gt(()=>[a.b(),a.is("pure",t.pure),a.is(t.effect),t.popperClass]),d=gt(()=>[{zIndex:Pe(c)},Pe(r).popper,t.popperStyle||{}]),g=gt(()=>n.value==="dialog"?"false":void 0),m=gt(()=>Pe(r).arrow||{});return{ariaModal:g,arrowStyle:m,contentAttrs:l,contentClass:o,contentStyle:d,contentZIndex:c,updateZIndex:()=>{c.value=Fo(t.zIndex)?t.zIndex:i()}}},lge=(t,e)=>{const r=at(!1),n=at();return{focusStartRef:n,trapped:r,onFocusAfterReleased:d=>{var g;((g=d.detail)==null?void 0:g.focusReason)!=="pointer"&&(n.value="first",e("blur"))},onFocusAfterTrapped:()=>{e("focus")},onFocusInTrap:d=>{t.visible&&!r.value&&(d.target&&(n.value=d.target),r.value=!0)},onFocusoutPrevented:d=>{t.trapping||(d.detail.focusReason==="pointer"&&d.preventDefault(),r.value=!1)},onReleaseRequested:()=>{r.value=!1,e("close")}}},uge=Mr({name:"ElPopperContent"}),cge=Mr({...uge,props:rq,emits:ege,setup(t,{expose:e,emit:r}){const n=t,{focusStartRef:i,trapped:a,onFocusAfterReleased:l,onFocusAfterTrapped:c,onFocusInTrap:o,onFocusoutPrevented:d,onReleaseRequested:g}=lge(n,r),{attributes:m,arrowRef:y,contentRef:x,styles:A,instanceRef:M,role:D,update:P}=oge(n),{ariaModal:O,arrowStyle:z,contentAttrs:V,contentClass:H,contentStyle:$,updateZIndex:X}=sge(n,{styles:A,attributes:m,role:D}),W=Mn(xC,void 0),Y=at();No(YZ,{arrowStyle:z,arrowRef:y,arrowOffset:Y}),W&&No(xC,{...W,addInputId:Oa,removeInputId:Oa});let J;const re=(pe=!0)=>{P(),pe&&X()},ae=()=>{re(!1),n.visible&&n.focusOnShow?a.value=!0:n.visible===!1&&(a.value=!1)};return Vn(()=>{un(()=>n.triggerTargetEl,(pe,de)=>{J==null||J(),J=void 0;const ve=Pe(pe||x.value),me=Pe(de||x.value);L_(ve)&&(J=un([D,()=>n.ariaLabel,O,()=>n.id],Ie=>{["role","aria-label","aria-modal","id"].forEach((Le,Ee)=>{P_(Ie[Ee])?ve.removeAttribute(Le):ve.setAttribute(Le,Ie[Ee])})},{immediate:!0})),me!==ve&&L_(me)&&["role","aria-label","aria-modal","id"].forEach(Ie=>{me.removeAttribute(Ie)})},{immediate:!0}),un(()=>n.visible,ae,{immediate:!0})}),Es(()=>{J==null||J(),J=void 0}),e({popperContentRef:x,popperInstanceRef:M,updatePopper:re,contentStyle:$}),(pe,de)=>(Nt(),Gr("div",wh({ref_key:"contentRef",ref:x},Pe(V),{style:Pe($),class:Pe(H),tabindex:"-1",onMouseenter:de[0]||(de[0]=ve=>pe.$emit("mouseenter",ve)),onMouseleave:de[1]||(de[1]=ve=>pe.$emit("mouseleave",ve))}),[He(Pe(tq),{trapped:Pe(a),"trap-on-focus-in":!0,"focus-trap-el":Pe(x),"focus-start-el":Pe(i),onFocusAfterTrapped:Pe(c),onFocusAfterReleased:Pe(l),onFocusin:Pe(o),onFocusoutPrevented:Pe(d),onReleaseRequested:Pe(g)},{default:pt(()=>[Cn(pe.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var hge=_i(cge,[["__file","content.vue"]]);const fge=ss(Ppe),cz=Symbol("elTooltip"),nq=zi({...Kde,...rq,appendTo:{type:Qn([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,visible:{type:Qn(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...bb(["ariaLabel"])}),iq=zi({...JZ,disabled:Boolean,trigger:{type:Qn([String,Array]),default:"hover"},triggerKeys:{type:Qn(Array),default:()=>[co.enter,co.space]}}),{useModelToggleProps:dge,useModelToggleEmits:pge,useModelToggle:gge}=DZ("visible"),vge=zi({...XZ,...dge,...nq,...iq,...QZ,showArrow:{type:Boolean,default:!0}}),mge=[...pge,"before-show","before-hide","show","hide","open","close"],_ge=(t,e)=>Wr(t)?t.includes(e):t===e,Um=(t,e,r)=>n=>{_ge(Pe(t),e)&&r(n)},yge=Mr({name:"ElTooltipTrigger"}),xge=Mr({...yge,props:iq,setup(t,{expose:e}){const r=t,n=yn("tooltip"),{controlled:i,id:a,open:l,onOpen:c,onClose:o,onToggle:d}=Mn(cz,void 0),g=at(null),m=()=>{if(Pe(i)||r.disabled)return!0},y=Il(r,"trigger"),x=Qc(m,Um(y,"hover",c)),A=Qc(m,Um(y,"hover",o)),M=Qc(m,Um(y,"click",V=>{V.button===0&&d(V)})),D=Qc(m,Um(y,"focus",c)),P=Qc(m,Um(y,"focus",o)),O=Qc(m,Um(y,"contextmenu",V=>{V.preventDefault(),d(V)})),z=Qc(m,V=>{const{code:H}=V;r.triggerKeys.includes(H)&&(V.preventDefault(),d(V))});return e({triggerRef:g}),(V,H)=>(Nt(),kr(Pe(Npe),{id:Pe(a),"virtual-ref":V.virtualRef,open:Pe(l),"virtual-triggering":V.virtualTriggering,class:Lr(Pe(n).e("trigger")),onBlur:Pe(P),onClick:Pe(M),onContextmenu:Pe(O),onFocus:Pe(D),onMouseenter:Pe(x),onMouseleave:Pe(A),onKeydown:Pe(z)},{default:pt(()=>[Cn(V.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var bge=_i(xge,[["__file","trigger.vue"]]);const wge=Mr({name:"ElTooltipContent",inheritAttrs:!1}),Sge=Mr({...wge,props:nq,setup(t,{expose:e}){const r=t,{selector:n}=HZ(),i=yn("tooltip"),a=at(null),l=at(!1),{controlled:c,id:o,open:d,trigger:g,onClose:m,onOpen:y,onShow:x,onHide:A,onBeforeShow:M,onBeforeHide:D}=Mn(cz,void 0),P=gt(()=>r.transition||`${i.namespace.value}-fade-in-linear`),O=gt(()=>r.persistent);Es(()=>{l.value=!0});const z=gt(()=>Pe(O)?!0:Pe(d)),V=gt(()=>r.disabled?!1:Pe(d)),H=gt(()=>r.appendTo||n.value),$=gt(()=>{var Ie;return(Ie=r.style)!=null?Ie:{}}),X=gt(()=>!Pe(d)),W=()=>{A()},Y=()=>{if(Pe(c))return!0},J=Qc(Y,()=>{r.enterable&&Pe(g)==="hover"&&y()}),re=Qc(Y,()=>{Pe(g)==="hover"&&m()}),ae=()=>{var Ie,Le;(Le=(Ie=a.value)==null?void 0:Ie.updatePopper)==null||Le.call(Ie),M==null||M()},pe=()=>{D==null||D()},de=()=>{x(),me=Wse(gt(()=>{var Ie;return(Ie=a.value)==null?void 0:Ie.popperContentRef}),()=>{if(Pe(c))return;Pe(g)!=="hover"&&m()})},ve=()=>{r.virtualTriggering||m()};let me;return un(()=>Pe(d),Ie=>{Ie||me==null||me()},{flush:"post"}),un(()=>r.content,()=>{var Ie,Le;(Le=(Ie=a.value)==null?void 0:Ie.updatePopper)==null||Le.call(Ie)}),e({contentRef:a}),(Ie,Le)=>(Nt(),kr(R7,{disabled:!Ie.teleported,to:Pe(H)},[He(Ad,{name:Pe(P),onAfterLeave:W,onBeforeEnter:ae,onAfterEnter:de,onBeforeLeave:pe},{default:pt(()=>[Pe(z)?es((Nt(),kr(Pe(hge),wh({key:0,id:Pe(o),ref_key:"contentRef",ref:a},Ie.$attrs,{"aria-label":Ie.ariaLabel,"aria-hidden":Pe(X),"boundaries-padding":Ie.boundariesPadding,"fallback-placements":Ie.fallbackPlacements,"gpu-acceleration":Ie.gpuAcceleration,offset:Ie.offset,placement:Ie.placement,"popper-options":Ie.popperOptions,strategy:Ie.strategy,effect:Ie.effect,enterable:Ie.enterable,pure:Ie.pure,"popper-class":Ie.popperClass,"popper-style":[Ie.popperStyle,Pe($)],"reference-el":Ie.referenceEl,"trigger-target-el":Ie.triggerTargetEl,visible:Pe(V),"z-index":Ie.zIndex,onMouseenter:Pe(J),onMouseleave:Pe(re),onBlur:ve,onClose:Pe(m)}),{default:pt(()=>[l.value?In("v-if",!0):Cn(Ie.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[qg,Pe(V)]]):In("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var Tge=_i(Sge,[["__file","content.vue"]]);const Age=["innerHTML"],Cge={key:1},Mge=Mr({name:"ElTooltip"}),Ige=Mr({...Mge,props:vge,emits:mge,setup(t,{expose:e,emit:r}){const n=t;Qde();const i=z1(),a=at(),l=at(),c=()=>{var P;const O=Pe(a);O&&((P=O.popperInstanceRef)==null||P.update())},o=at(!1),d=at(),{show:g,hide:m,hasUpdateHandler:y}=gge({indicator:o,toggleReason:d}),{onOpen:x,onClose:A}=Jde({showAfter:Il(n,"showAfter"),hideAfter:Il(n,"hideAfter"),autoClose:Il(n,"autoClose"),open:g,close:m}),M=gt(()=>Kg(n.visible)&&!y.value);No(cz,{controlled:M,id:i,open:gb(o),trigger:Il(n,"trigger"),onOpen:P=>{x(P)},onClose:P=>{A(P)},onToggle:P=>{Pe(o)?A(P):x(P)},onShow:()=>{r("show",d.value)},onHide:()=>{r("hide",d.value)},onBeforeShow:()=>{r("before-show",d.value)},onBeforeHide:()=>{r("before-hide",d.value)},updatePopper:c}),un(()=>n.disabled,P=>{P&&o.value&&(o.value=!1)});const D=P=>{var O,z;const V=(z=(O=l.value)==null?void 0:O.contentRef)==null?void 0:z.popperContentRef,H=(P==null?void 0:P.relatedTarget)||document.activeElement;return V&&V.contains(H)};return M7(()=>o.value&&m()),e({popperRef:a,contentRef:l,isFocusInsideContent:D,updatePopper:c,onOpen:x,onClose:A,hide:m}),(P,O)=>(Nt(),kr(Pe(fge),{ref_key:"popperRef",ref:a,role:P.role},{default:pt(()=>[He(bge,{disabled:P.disabled,trigger:P.trigger,"trigger-keys":P.triggerKeys,"virtual-ref":P.virtualRef,"virtual-triggering":P.virtualTriggering},{default:pt(()=>[P.$slots.default?Cn(P.$slots,"default",{key:0}):In("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),He(Tge,{ref_key:"contentRef",ref:l,"aria-label":P.ariaLabel,"boundaries-padding":P.boundariesPadding,content:P.content,disabled:P.disabled,effect:P.effect,enterable:P.enterable,"fallback-placements":P.fallbackPlacements,"hide-after":P.hideAfter,"gpu-acceleration":P.gpuAcceleration,offset:P.offset,persistent:P.persistent,"popper-class":P.popperClass,"popper-style":P.popperStyle,placement:P.placement,"popper-options":P.popperOptions,pure:P.pure,"raw-content":P.rawContent,"reference-el":P.referenceEl,"trigger-target-el":P.triggerTargetEl,"show-after":P.showAfter,strategy:P.strategy,teleported:P.teleported,transition:P.transition,"virtual-triggering":P.virtualTriggering,"z-index":P.zIndex,"append-to":P.appendTo},{default:pt(()=>[Cn(P.$slots,"content",{},()=>[P.rawContent?(Nt(),Gr("span",{key:0,innerHTML:P.content},null,8,Age)):(Nt(),Gr("span",Cge,_n(P.content),1))]),P.showArrow?(Nt(),kr(Pe(kpe),{key:0,"arrow-offset":P.arrowOffset},null,8,["arrow-offset"])):In("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var Ege=_i(Ige,[["__file","tooltip.vue"]]);const YM=ss(Ege),aq=Symbol("buttonGroupContextKey"),Dge=(t,e)=>{bg({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},gt(()=>t.type==="text"));const r=Mn(aq,void 0),n=ZZ("button"),{form:i}=WM(),a=B1(gt(()=>r==null?void 0:r.size)),l=az(),c=at(),o=J_(),d=gt(()=>t.type||(r==null?void 0:r.type)||""),g=gt(()=>{var A,M,D;return(D=(M=t.autoInsertSpace)!=null?M:(A=n.value)==null?void 0:A.autoInsertSpace)!=null?D:!1}),m=gt(()=>t.tag==="button"?{ariaDisabled:l.value||t.loading,disabled:l.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),y=gt(()=>{var A;const M=(A=o.default)==null?void 0:A.call(o);if(g.value&&(M==null?void 0:M.length)===1){const D=M[0];if((D==null?void 0:D.type)===ey){const P=D.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(P.trim())}}return!1});return{_disabled:l,_size:a,_type:d,_ref:c,_props:m,shouldAddSpace:y,handleClick:A=>{t.nativeType==="reset"&&(i==null||i.resetFields()),e("click",A)}}},Pge=["default","primary","success","warning","info","danger","text",""],Lge=["button","submit","reset"],ak=zi({size:jM,disabled:Boolean,type:{type:String,values:Pge,default:""},icon:{type:Zf},nativeType:{type:String,values:Lge,default:"button"},loading:Boolean,loadingIcon:{type:Zf,default:()=>MZ},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:Qn([String,Object]),default:"button"}}),Rge={click:t=>t instanceof MouseEvent};function wo(t,e){kge(t)&&(t="100%");var r=Oge(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function pT(t){return Math.min(1,Math.max(0,t))}function kge(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function Oge(t){return typeof t=="string"&&t.indexOf("%")!==-1}function oq(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function gT(t){return t<=1?"".concat(Number(t)*100,"%"):t}function wg(t){return t.length===1?"0"+t:String(t)}function zge(t,e,r){return{r:wo(t,255)*255,g:wo(e,255)*255,b:wo(r,255)*255}}function tG(t,e,r){t=wo(t,255),e=wo(e,255),r=wo(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a=0,l=0,c=(n+i)/2;if(n===i)l=0,a=0;else{var o=n-i;switch(l=c>.5?o/(2-n-i):o/(n+i),n){case t:a=(e-r)/o+(e<r?6:0);break;case e:a=(r-t)/o+2;break;case r:a=(t-e)/o+4;break}a/=6}return{h:a,s:l,l:c}}function eP(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*(6*r):r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Bge(t,e,r){var n,i,a;if(t=wo(t,360),e=wo(e,100),r=wo(r,100),e===0)i=r,a=r,n=r;else{var l=r<.5?r*(1+e):r+e-r*e,c=2*r-l;n=eP(c,l,t+1/3),i=eP(c,l,t),a=eP(c,l,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function rG(t,e,r){t=wo(t,255),e=wo(e,255),r=wo(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a=0,l=n,c=n-i,o=n===0?0:c/n;if(n===i)a=0;else{switch(n){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:a,s:o,v:l}}function Fge(t,e,r){t=wo(t,360)*6,e=wo(e,100),r=wo(r,100);var n=Math.floor(t),i=t-n,a=r*(1-e),l=r*(1-i*e),c=r*(1-(1-i)*e),o=n%6,d=[r,l,a,a,c,r][o],g=[c,r,r,l,a,a][o],m=[a,a,c,r,r,l][o];return{r:d*255,g:g*255,b:m*255}}function nG(t,e,r,n){var i=[wg(Math.round(t).toString(16)),wg(Math.round(e).toString(16)),wg(Math.round(r).toString(16))];return n&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function Nge(t,e,r,n,i){var a=[wg(Math.round(t).toString(16)),wg(Math.round(e).toString(16)),wg(Math.round(r).toString(16)),wg(Vge(n))];return i&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function Vge(t){return Math.round(parseFloat(t)*255).toString(16)}function iG(t){return js(t)/255}function js(t){return parseInt(t,16)}function Gge(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var ok={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Uge(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,a=null,l=!1,c=!1;return typeof t=="string"&&(t=jge(t)),typeof t=="object"&&(Wc(t.r)&&Wc(t.g)&&Wc(t.b)?(e=zge(t.r,t.g,t.b),l=!0,c=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Wc(t.h)&&Wc(t.s)&&Wc(t.v)?(n=gT(t.s),i=gT(t.v),e=Fge(t.h,n,i),l=!0,c="hsv"):Wc(t.h)&&Wc(t.s)&&Wc(t.l)&&(n=gT(t.s),a=gT(t.l),e=Bge(t.h,n,a),l=!0,c="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(r=t.a)),r=oq(r),{ok:l,format:t.format||c,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}var $ge="[-\\+]?\\d+%?",Hge="[-\\+]?\\d*\\.\\d+%?",qf="(?:".concat(Hge,")|(?:").concat($ge,")"),tP="[\\s|\\(]+(".concat(qf,")[,|\\s]+(").concat(qf,")[,|\\s]+(").concat(qf,")\\s*\\)?"),rP="[\\s|\\(]+(".concat(qf,")[,|\\s]+(").concat(qf,")[,|\\s]+(").concat(qf,")[,|\\s]+(").concat(qf,")\\s*\\)?"),ou={CSS_UNIT:new RegExp(qf),rgb:new RegExp("rgb"+tP),rgba:new RegExp("rgba"+rP),hsl:new RegExp("hsl"+tP),hsla:new RegExp("hsla"+rP),hsv:new RegExp("hsv"+tP),hsva:new RegExp("hsva"+rP),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function jge(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(ok[t])t=ok[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r=ou.rgb.exec(t);return r?{r:r[1],g:r[2],b:r[3]}:(r=ou.rgba.exec(t),r?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=ou.hsl.exec(t),r?{h:r[1],s:r[2],l:r[3]}:(r=ou.hsla.exec(t),r?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=ou.hsv.exec(t),r?{h:r[1],s:r[2],v:r[3]}:(r=ou.hsva.exec(t),r?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=ou.hex8.exec(t),r?{r:js(r[1]),g:js(r[2]),b:js(r[3]),a:iG(r[4]),format:e?"name":"hex8"}:(r=ou.hex6.exec(t),r?{r:js(r[1]),g:js(r[2]),b:js(r[3]),format:e?"name":"hex"}:(r=ou.hex4.exec(t),r?{r:js(r[1]+r[1]),g:js(r[2]+r[2]),b:js(r[3]+r[3]),a:iG(r[4]+r[4]),format:e?"name":"hex8"}:(r=ou.hex3.exec(t),r?{r:js(r[1]+r[1]),g:js(r[2]+r[2]),b:js(r[3]+r[3]),format:e?"name":"hex"}:!1)))))))))}function Wc(t){return!!ou.CSS_UNIT.exec(String(t))}var sq=function(){function t(e,r){e===void 0&&(e=""),r===void 0&&(r={});var n;if(e instanceof t)return e;typeof e=="number"&&(e=Gge(e)),this.originalInput=e;var i=Uge(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=(n=r.format)!==null&&n!==void 0?n:i.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),r,n,i,a=e.r/255,l=e.g/255,c=e.b/255;return a<=.03928?r=a/12.92:r=Math.pow((a+.055)/1.055,2.4),l<=.03928?n=l/12.92:n=Math.pow((l+.055)/1.055,2.4),c<=.03928?i=c/12.92:i=Math.pow((c+.055)/1.055,2.4),.2126*r+.7152*n+.0722*i},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=oq(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=rG(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=rG(this.r,this.g,this.b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?"hsv(".concat(r,", ").concat(n,"%, ").concat(i,"%)"):"hsva(".concat(r,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=tG(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=tG(this.r,this.g,this.b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?"hsl(".concat(r,", ").concat(n,"%, ").concat(i,"%)"):"hsla(".concat(r,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),nG(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),Nge(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),r=Math.round(this.g),n=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(r,", ").concat(n,")"):"rgba(".concat(e,", ").concat(r,", ").concat(n,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(r){return"".concat(Math.round(wo(r,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(r){return Math.round(wo(r,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+nG(this.r,this.g,this.b,!1),r=0,n=Object.entries(ok);r<n.length;r++){var i=n[r],a=i[0],l=i[1];if(e===l)return a}return!1},t.prototype.toString=function(e){var r=!!e;e=e??this.format;var n=!1,i=this.a<1&&this.a>=0,a=!r&&i&&(e.startsWith("hex")||e==="name");return a?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var r=this.toHsl();return r.l+=e/100,r.l=pT(r.l),new t(r)},t.prototype.brighten=function(e){e===void 0&&(e=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),new t(r)},t.prototype.darken=function(e){e===void 0&&(e=10);var r=this.toHsl();return r.l-=e/100,r.l=pT(r.l),new t(r)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var r=this.toHsl();return r.s-=e/100,r.s=pT(r.s),new t(r)},t.prototype.saturate=function(e){e===void 0&&(e=10);var r=this.toHsl();return r.s+=e/100,r.s=pT(r.s),new t(r)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var r=this.toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,new t(r)},t.prototype.mix=function(e,r){r===void 0&&(r=50);var n=this.toRgb(),i=new t(e).toRgb(),a=r/100,l={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return new t(l)},t.prototype.analogous=function(e,r){e===void 0&&(e=6),r===void 0&&(r=30);var n=this.toHsl(),i=360/r,a=[this];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,a.push(new t(n));return a},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var r=this.toHsv(),n=r.h,i=r.s,a=r.v,l=[],c=1/e;e--;)l.push(new t({h:n,s:i,v:a})),a=(a+c)%1;return l},t.prototype.splitcomplement=function(){var e=this.toHsl(),r=e.h;return[this,new t({h:(r+72)%360,s:e.s,l:e.l}),new t({h:(r+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var r=this.toRgb(),n=new t(e).toRgb(),i=r.a+n.a*(1-r.a);return new t({r:(r.r*r.a+n.r*n.a*(1-r.a))/i,g:(r.g*r.a+n.g*n.a*(1-r.a))/i,b:(r.b*r.a+n.b*n.a*(1-r.a))/i,a:i})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var r=this.toHsl(),n=r.h,i=[this],a=360/e,l=1;l<e;l++)i.push(new t({h:(n+l*a)%360,s:r.s,l:r.l}));return i},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}();function bf(t,e=20){return t.mix("#141414",e).toString()}function Wge(t){const e=az(),r=yn("button");return gt(()=>{let n={};const i=t.color;if(i){const a=new sq(i),l=t.dark?a.tint(20).toString():bf(a,20);if(t.plain)n=r.cssVarBlock({"bg-color":t.dark?bf(a,90):a.tint(90).toString(),"text-color":i,"border-color":t.dark?bf(a,50):a.tint(50).toString(),"hover-text-color":`var(${r.cssVarName("color-white")})`,"hover-bg-color":i,"hover-border-color":i,"active-bg-color":l,"active-text-color":`var(${r.cssVarName("color-white")})`,"active-border-color":l}),e.value&&(n[r.cssVarBlockName("disabled-bg-color")]=t.dark?bf(a,90):a.tint(90).toString(),n[r.cssVarBlockName("disabled-text-color")]=t.dark?bf(a,50):a.tint(50).toString(),n[r.cssVarBlockName("disabled-border-color")]=t.dark?bf(a,80):a.tint(80).toString());else{const c=t.dark?bf(a,30):a.tint(30).toString(),o=a.isDark()?`var(${r.cssVarName("color-white")})`:`var(${r.cssVarName("color-black")})`;if(n=r.cssVarBlock({"bg-color":i,"text-color":o,"border-color":i,"hover-bg-color":c,"hover-text-color":o,"hover-border-color":c,"active-bg-color":l,"active-border-color":l}),e.value){const d=t.dark?bf(a,50):a.tint(50).toString();n[r.cssVarBlockName("disabled-bg-color")]=d,n[r.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${r.cssVarName("color-white")})`,n[r.cssVarBlockName("disabled-border-color")]=d}}}return n})}const Zge=Mr({name:"ElButton"}),qge=Mr({...Zge,props:ak,emits:Rge,setup(t,{expose:e,emit:r}){const n=t,i=Wge(n),a=yn("button"),{_ref:l,_size:c,_type:o,_disabled:d,_props:g,shouldAddSpace:m,handleClick:y}=Dge(n,r),x=gt(()=>[a.b(),a.m(o.value),a.m(c.value),a.is("disabled",d.value),a.is("loading",n.loading),a.is("plain",n.plain),a.is("round",n.round),a.is("circle",n.circle),a.is("text",n.text),a.is("link",n.link),a.is("has-bg",n.bg)]);return e({ref:l,size:c,type:o,disabled:d,shouldAddSpace:m}),(A,M)=>(Nt(),kr(sd(A.tag),wh({ref_key:"_ref",ref:l},Pe(g),{class:Pe(x),style:Pe(i),onClick:Pe(y)}),{default:pt(()=>[A.loading?(Nt(),Gr(ha,{key:0},[A.$slots.loading?Cn(A.$slots,"loading",{key:0}):(Nt(),kr(Pe(As),{key:1,class:Lr(Pe(a).is("loading"))},{default:pt(()=>[(Nt(),kr(sd(A.loadingIcon)))]),_:1},8,["class"]))],64)):A.icon||A.$slots.icon?(Nt(),kr(Pe(As),{key:1},{default:pt(()=>[A.icon?(Nt(),kr(sd(A.icon),{key:0})):Cn(A.$slots,"icon",{key:1})]),_:3})):In("v-if",!0),A.$slots.default?(Nt(),Gr("span",{key:2,class:Lr({[Pe(a).em("text","expand")]:Pe(m)})},[Cn(A.$slots,"default")],2)):In("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Yge=_i(qge,[["__file","button.vue"]]);const Xge={size:ak.size,type:ak.type},Qge=Mr({name:"ElButtonGroup"}),Kge=Mr({...Qge,props:Xge,setup(t){const e=t;No(aq,gc({size:Il(e,"size"),type:Il(e,"type")}));const r=yn("button");return(n,i)=>(Nt(),Gr("div",{class:Lr(`${Pe(r).b("group")}`)},[Cn(n.$slots,"default")],2))}});var lq=_i(Kge,[["__file","button-group.vue"]]);const Jge=ss(Yge,{ButtonGroup:lq});Bl(lq);var uq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eve(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const kf=new Map;let aG;fa&&(document.addEventListener("mousedown",t=>aG=t),document.addEventListener("mouseup",t=>{for(const e of kf.values())for(const{documentHandler:r}of e)r(t,aG)}));function oG(t,e){let r=[];return Array.isArray(e.arg)?r=e.arg:L_(e.arg)&&r.push(e.arg),function(n,i){const a=e.instance.popperRef,l=n.target,c=i==null?void 0:i.target,o=!e||!e.instance,d=!l||!c,g=t.contains(l)||t.contains(c),m=t===l,y=r.length&&r.some(A=>A==null?void 0:A.contains(l))||r.length&&r.includes(c),x=a&&(a.contains(l)||a.contains(c));o||d||g||m||y||x||e.value(n,i)}}const cq={beforeMount(t,e){kf.has(t)||kf.set(t,[]),kf.get(t).push({documentHandler:oG(t,e),bindingFn:e.value})},updated(t,e){kf.has(t)||kf.set(t,[]);const r=kf.get(t),n=r.findIndex(a=>a.bindingFn===e.oldValue),i={documentHandler:oG(t,e),bindingFn:e.value};n>=0?r.splice(n,1,i):r.push(i)},unmounted(t){kf.delete(t)}};var sG=!1,vg,sk,lk,EA,DA,hq,PA,uk,ck,hk,fq,fk,dk,dq,pq;function vs(){if(!sG){sG=!0;var t=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),r=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(fk=/\b(iPhone|iP[ao]d)/.exec(t),dk=/\b(iP[ao]d)/.exec(t),hk=/Android/i.exec(t),dq=/FBAN\/\w+;/i.exec(t),pq=/Mobile/i.exec(t),fq=!!/Win64/.exec(t),e){vg=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN,vg&&document&&document.documentMode&&(vg=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(t);hq=n?parseFloat(n[1])+4:vg,sk=e[2]?parseFloat(e[2]):NaN,lk=e[3]?parseFloat(e[3]):NaN,EA=e[4]?parseFloat(e[4]):NaN,EA?(e=/(?:Chrome\/(\d+\.\d+))/.exec(t),DA=e&&e[1]?parseFloat(e[1]):NaN):DA=NaN}else vg=sk=lk=DA=EA=NaN;if(r){if(r[1]){var i=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);PA=i?parseFloat(i[1].replace("_",".")):!0}else PA=!1;uk=!!r[2],ck=!!r[3]}else PA=uk=ck=!1}}var pk={ie:function(){return vs()||vg},ieCompatibilityMode:function(){return vs()||hq>vg},ie64:function(){return pk.ie()&&fq},firefox:function(){return vs()||sk},opera:function(){return vs()||lk},webkit:function(){return vs()||EA},safari:function(){return pk.webkit()},chrome:function(){return vs()||DA},windows:function(){return vs()||uk},osx:function(){return vs()||PA},linux:function(){return vs()||ck},iphone:function(){return vs()||fk},mobile:function(){return vs()||fk||dk||hk||pq},nativeApp:function(){return vs()||dq},android:function(){return vs()||hk},ipad:function(){return vs()||dk}},tve=pk,vT=!!(typeof window<"u"&&window.document&&window.document.createElement),rve={canUseDOM:vT,canUseWorkers:typeof Worker<"u",canUseEventListeners:vT&&!!(window.addEventListener||window.attachEvent),canUseViewport:vT&&!!window.screen,isInWorker:!vT},gq=rve,vq;gq.canUseDOM&&(vq=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function nve(t,e){if(!gq.canUseDOM||e&&!("addEventListener"in document))return!1;var r="on"+t,n=r in document;if(!n){var i=document.createElement("div");i.setAttribute(r,"return;"),n=typeof i[r]=="function"}return!n&&vq&&t==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var ive=nve,lG=10,uG=40,cG=800;function mq(t){var e=0,r=0,n=0,i=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*lG,i=r*lG,"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||i)&&t.deltaMode&&(t.deltaMode==1?(n*=uG,i*=uG):(n*=cG,i*=cG)),n&&!e&&(e=n<1?-1:1),i&&!r&&(r=i<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:i}}mq.getEventType=function(){return tve.firefox()?"DOMMouseScroll":ive("wheel")?"wheel":"mousewheel"};var ave=mq;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const ove=function(t,e){if(t&&t.addEventListener){const r=function(n){const i=ave(n);e&&Reflect.apply(e,this,[n,i])};t.addEventListener("wheel",r,{passive:!0})}},sve={beforeMount(t,e){ove(t,e.value)}},_q={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:jM,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...bb(["ariaControls"])},yq={[Cd]:t=>wi(t)||Fo(t)||Kg(t),change:t=>wi(t)||Fo(t)||Kg(t)},ry=Symbol("checkboxGroupContextKey"),lve=({model:t,isChecked:e})=>{const r=Mn(ry,void 0),n=gt(()=>{var a,l;const c=(a=r==null?void 0:r.max)==null?void 0:a.value,o=(l=r==null?void 0:r.min)==null?void 0:l.value;return!Qg(c)&&t.value.length>=c&&!e.value||!Qg(o)&&t.value.length<=o&&e.value});return{isDisabled:az(gt(()=>(r==null?void 0:r.disabled.value)||n.value)),isLimitDisabled:n}},uve=(t,{model:e,isLimitExceeded:r,hasOwnLabel:n,isDisabled:i,isLabeledByFormItem:a})=>{const l=Mn(ry,void 0),{formItem:c}=WM(),{emit:o}=Mi();function d(A){var M,D,P,O;return[!0,t.trueValue,t.trueLabel].includes(A)?(D=(M=t.trueValue)!=null?M:t.trueLabel)!=null?D:!0:(O=(P=t.falseValue)!=null?P:t.falseLabel)!=null?O:!1}function g(A,M){o("change",d(A),M)}function m(A){if(r.value)return;const M=A.target;o("change",d(M.checked),A)}async function y(A){r.value||!n.value&&!i.value&&a.value&&(A.composedPath().some(P=>P.tagName==="LABEL")||(e.value=d([!1,t.falseValue,t.falseLabel].includes(e.value)),await Fa(),g(e.value,A)))}const x=gt(()=>(l==null?void 0:l.validateEvent)||t.validateEvent);return un(()=>t.modelValue,()=>{x.value&&(c==null||c.validate("change").catch(A=>void 0))}),{handleChange:m,onClickRoot:y}},cve=t=>{const e=at(!1),{emit:r}=Mi(),n=Mn(ry,void 0),i=gt(()=>Qg(n)===!1),a=at(!1),l=gt({get(){var c,o;return i.value?(c=n==null?void 0:n.modelValue)==null?void 0:c.value:(o=t.modelValue)!=null?o:e.value},set(c){var o,d;i.value&&Wr(c)?(a.value=((o=n==null?void 0:n.max)==null?void 0:o.value)!==void 0&&c.length>(n==null?void 0:n.max.value)&&c.length>l.value.length,a.value===!1&&((d=n==null?void 0:n.changeEvent)==null||d.call(n,c))):(r(Cd,c),e.value=c)}});return{model:l,isGroup:i,isLimitExceeded:a}},hve=(t,e,{model:r})=>{const n=Mn(ry,void 0),i=at(!1),a=gt(()=>nk(t.value)?t.label:t.value),l=gt(()=>{const g=r.value;return Kg(g)?g:Wr(g)?fi(a.value)?g.map(mi).some(m=>ufe(m,a.value)):g.map(mi).includes(a.value):g!=null?g===t.trueValue||g===t.trueLabel:!!g}),c=B1(gt(()=>{var g;return(g=n==null?void 0:n.size)==null?void 0:g.value}),{prop:!0}),o=B1(gt(()=>{var g;return(g=n==null?void 0:n.size)==null?void 0:g.value})),d=gt(()=>!!e.default||!nk(a.value));return{checkboxButtonSize:c,isChecked:l,isFocused:i,checkboxSize:o,hasOwnLabel:d,actualValue:a}},xq=(t,e)=>{const{formItem:r}=WM(),{model:n,isGroup:i,isLimitExceeded:a}=cve(t),{isFocused:l,isChecked:c,checkboxButtonSize:o,checkboxSize:d,hasOwnLabel:g,actualValue:m}=hve(t,e,{model:n}),{isDisabled:y}=lve({model:n,isChecked:c}),{inputId:x,isLabeledByFormItem:A}=qZ(t,{formItemContext:r,disableIdGeneration:g,disableIdManagement:i}),{handleChange:M,onClickRoot:D}=uve(t,{model:n,isLimitExceeded:a,hasOwnLabel:g,isDisabled:y,isLabeledByFormItem:A});return(()=>{function O(){var z,V;Wr(n.value)&&!n.value.includes(m.value)?n.value.push(m.value):n.value=(V=(z=t.trueValue)!=null?z:t.trueLabel)!=null?V:!0}t.checked&&O()})(),bg({from:"controls",replacement:"aria-controls",version:"2.8.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},gt(()=>!!t.controls)),bg({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},gt(()=>i.value&&nk(t.value))),bg({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},gt(()=>!!t.trueLabel)),bg({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},gt(()=>!!t.falseLabel)),{inputId:x,isLabeledByFormItem:A,isChecked:c,isDisabled:y,isFocused:l,checkboxButtonSize:o,checkboxSize:d,hasOwnLabel:g,model:n,actualValue:m,handleChange:M,onClickRoot:D}},fve=["id","indeterminate","name","tabindex","disabled","true-value","false-value"],dve=["id","indeterminate","disabled","value","name","tabindex"],pve=Mr({name:"ElCheckbox"}),gve=Mr({...pve,props:_q,emits:yq,setup(t){const e=t,r=J_(),{inputId:n,isLabeledByFormItem:i,isChecked:a,isDisabled:l,isFocused:c,checkboxSize:o,hasOwnLabel:d,model:g,actualValue:m,handleChange:y,onClickRoot:x}=xq(e,r),A=yn("checkbox"),M=gt(()=>[A.b(),A.m(o.value),A.is("disabled",l.value),A.is("bordered",e.border),A.is("checked",a.value)]),D=gt(()=>[A.e("input"),A.is("disabled",l.value),A.is("checked",a.value),A.is("indeterminate",e.indeterminate),A.is("focus",c.value)]);return(P,O)=>(Nt(),kr(sd(!Pe(d)&&Pe(i)?"span":"label"),{class:Lr(Pe(M)),"aria-controls":P.indeterminate?P.controls||P.ariaControls:null,onClick:Pe(x)},{default:pt(()=>{var z,V;return[wt("span",{class:Lr(Pe(D))},[P.trueValue||P.falseValue||P.trueLabel||P.falseLabel?es((Nt(),Gr("input",{key:0,id:Pe(n),"onUpdate:modelValue":O[0]||(O[0]=H=>qi(g)?g.value=H:null),class:Lr(Pe(A).e("original")),type:"checkbox",indeterminate:P.indeterminate,name:P.name,tabindex:P.tabindex,disabled:Pe(l),"true-value":(z=P.trueValue)!=null?z:P.trueLabel,"false-value":(V=P.falseValue)!=null?V:P.falseLabel,onChange:O[1]||(O[1]=(...H)=>Pe(y)&&Pe(y)(...H)),onFocus:O[2]||(O[2]=H=>c.value=!0),onBlur:O[3]||(O[3]=H=>c.value=!1),onClick:O[4]||(O[4]=Yg(()=>{},["stop"]))},null,42,fve)),[[hC,Pe(g)]]):es((Nt(),Gr("input",{key:1,id:Pe(n),"onUpdate:modelValue":O[5]||(O[5]=H=>qi(g)?g.value=H:null),class:Lr(Pe(A).e("original")),type:"checkbox",indeterminate:P.indeterminate,disabled:Pe(l),value:Pe(m),name:P.name,tabindex:P.tabindex,onChange:O[6]||(O[6]=(...H)=>Pe(y)&&Pe(y)(...H)),onFocus:O[7]||(O[7]=H=>c.value=!0),onBlur:O[8]||(O[8]=H=>c.value=!1),onClick:O[9]||(O[9]=Yg(()=>{},["stop"]))},null,42,dve)),[[hC,Pe(g)]]),wt("span",{class:Lr(Pe(A).e("inner"))},null,2)],2),Pe(d)?(Nt(),Gr("span",{key:0,class:Lr(Pe(A).e("label"))},[Cn(P.$slots,"default"),P.$slots.default?In("v-if",!0):(Nt(),Gr(ha,{key:0},[ji(_n(P.label),1)],64))],2)):In("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var vve=_i(gve,[["__file","checkbox.vue"]]);const mve=["name","tabindex","disabled","true-value","false-value"],_ve=["name","tabindex","disabled","value"],yve=Mr({name:"ElCheckboxButton"}),xve=Mr({...yve,props:_q,emits:yq,setup(t){const e=t,r=J_(),{isFocused:n,isChecked:i,isDisabled:a,checkboxButtonSize:l,model:c,actualValue:o,handleChange:d}=xq(e,r),g=Mn(ry,void 0),m=yn("checkbox"),y=gt(()=>{var A,M,D,P;const O=(M=(A=g==null?void 0:g.fill)==null?void 0:A.value)!=null?M:"";return{backgroundColor:O,borderColor:O,color:(P=(D=g==null?void 0:g.textColor)==null?void 0:D.value)!=null?P:"",boxShadow:O?`-1px 0 0 0 ${O}`:void 0}}),x=gt(()=>[m.b("button"),m.bm("button",l.value),m.is("disabled",a.value),m.is("checked",i.value),m.is("focus",n.value)]);return(A,M)=>{var D,P;return Nt(),Gr("label",{class:Lr(Pe(x))},[A.trueValue||A.falseValue||A.trueLabel||A.falseLabel?es((Nt(),Gr("input",{key:0,"onUpdate:modelValue":M[0]||(M[0]=O=>qi(c)?c.value=O:null),class:Lr(Pe(m).be("button","original")),type:"checkbox",name:A.name,tabindex:A.tabindex,disabled:Pe(a),"true-value":(D=A.trueValue)!=null?D:A.trueLabel,"false-value":(P=A.falseValue)!=null?P:A.falseLabel,onChange:M[1]||(M[1]=(...O)=>Pe(d)&&Pe(d)(...O)),onFocus:M[2]||(M[2]=O=>n.value=!0),onBlur:M[3]||(M[3]=O=>n.value=!1),onClick:M[4]||(M[4]=Yg(()=>{},["stop"]))},null,42,mve)),[[hC,Pe(c)]]):es((Nt(),Gr("input",{key:1,"onUpdate:modelValue":M[5]||(M[5]=O=>qi(c)?c.value=O:null),class:Lr(Pe(m).be("button","original")),type:"checkbox",name:A.name,tabindex:A.tabindex,disabled:Pe(a),value:Pe(o),onChange:M[6]||(M[6]=(...O)=>Pe(d)&&Pe(d)(...O)),onFocus:M[7]||(M[7]=O=>n.value=!0),onBlur:M[8]||(M[8]=O=>n.value=!1),onClick:M[9]||(M[9]=Yg(()=>{},["stop"]))},null,42,_ve)),[[hC,Pe(c)]]),A.$slots.default||A.label?(Nt(),Gr("span",{key:2,class:Lr(Pe(m).be("button","inner")),style:va(Pe(i)?Pe(y):void 0)},[Cn(A.$slots,"default",{},()=>[ji(_n(A.label),1)])],6)):In("v-if",!0)],2)}}});var bq=_i(xve,[["__file","checkbox-button.vue"]]);const bve=zi({modelValue:{type:Qn(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:jM,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...bb(["ariaLabel"])}),wve={[Cd]:t=>Wr(t),change:t=>Wr(t)},Sve=Mr({name:"ElCheckboxGroup"}),Tve=Mr({...Sve,props:bve,emits:wve,setup(t,{emit:e}){const r=t,n=yn("checkbox"),{formItem:i}=WM(),{inputId:a,isLabeledByFormItem:l}=qZ(r,{formItemContext:i}),c=async d=>{e(Cd,d),await Fa(),e("change",d)},o=gt({get(){return r.modelValue},set(d){c(d)}});return No(ry,{...TZ(M3(r),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:o,changeEvent:c}),bg({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-checkbox-group",ref:"https://element-plus.org/en-US/component/checkbox.html"},gt(()=>!!r.label)),un(()=>r.modelValue,()=>{r.validateEvent&&(i==null||i.validate("change").catch(d=>void 0))}),(d,g)=>{var m;return Nt(),kr(sd(d.tag),{id:Pe(a),class:Lr(Pe(n).b("group")),role:"group","aria-label":Pe(l)?void 0:d.label||d.ariaLabel||"checkbox-group","aria-labelledby":Pe(l)?(m=Pe(i))==null?void 0:m.labelId:void 0},{default:pt(()=>[Cn(d.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var wq=_i(Tve,[["__file","checkbox-group.vue"]]);const N_=ss(vve,{CheckboxButton:bq,CheckboxGroup:wq});Bl(bq);Bl(wq);const Ave=zi({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:EZ},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),Cve={close:t=>t instanceof MouseEvent,click:t=>t instanceof MouseEvent},Mve=Mr({name:"ElTag"}),Ive=Mr({...Mve,props:Ave,emits:Cve,setup(t,{emit:e}){const r=t,n=B1(),i=yn("tag"),a=gt(()=>{const{type:o,hit:d,effect:g,closable:m,round:y}=r;return[i.b(),i.is("closable",m),i.m(o||"primary"),i.m(n.value),i.m(g),i.is("hit",d),i.is("round",y)]}),l=o=>{e("close",o)},c=o=>{e("click",o)};return(o,d)=>o.disableTransitions?(Nt(),Gr("span",{key:0,class:Lr(Pe(a)),style:va({backgroundColor:o.color}),onClick:c},[wt("span",{class:Lr(Pe(i).e("content"))},[Cn(o.$slots,"default")],2),o.closable?(Nt(),kr(Pe(As),{key:0,class:Lr(Pe(i).e("close")),onClick:Yg(l,["stop"])},{default:pt(()=>[He(Pe(_C))]),_:1},8,["class","onClick"])):In("v-if",!0)],6)):(Nt(),kr(Ad,{key:1,name:`${Pe(i).namespace.value}-zoom-in-center`,appear:""},{default:pt(()=>[wt("span",{class:Lr(Pe(a)),style:va({backgroundColor:o.color}),onClick:c},[wt("span",{class:Lr(Pe(i).e("content"))},[Cn(o.$slots,"default")],2),o.closable?(Nt(),kr(Pe(As),{key:0,class:Lr(Pe(i).e("close")),onClick:Yg(l,["stop"])},{default:pt(()=>[He(Pe(_C))]),_:1},8,["class","onClick"])):In("v-if",!0)],6)]),_:3},8,["name"]))}});var Eve=_i(Ive,[["__file","tag.vue"]]);const Va=ss(Eve),Sq=Symbol("rowContextKey"),Dve=["start","center","end","space-around","space-between","space-evenly"],Pve=["top","middle","bottom"],Lve=zi({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:Dve,default:"start"},align:{type:String,values:Pve}}),Rve=Mr({name:"ElRow"}),kve=Mr({...Rve,props:Lve,setup(t){const e=t,r=yn("row"),n=gt(()=>e.gutter);No(Sq,{gutter:n});const i=gt(()=>{const l={};return e.gutter&&(l.marginRight=l.marginLeft=`-${e.gutter/2}px`),l}),a=gt(()=>[r.b(),r.is(`justify-${e.justify}`,e.justify!=="start"),r.is(`align-${e.align}`,!!e.align)]);return(l,c)=>(Nt(),kr(sd(l.tag),{class:Lr(Pe(a)),style:va(Pe(i))},{default:pt(()=>[Cn(l.$slots,"default")]),_:3},8,["class","style"]))}});var Ove=_i(kve,[["__file","row.vue"]]);const zve=ss(Ove),Bve=zi({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:Qn([Number,Object]),default:()=>jf({})},sm:{type:Qn([Number,Object]),default:()=>jf({})},md:{type:Qn([Number,Object]),default:()=>jf({})},lg:{type:Qn([Number,Object]),default:()=>jf({})},xl:{type:Qn([Number,Object]),default:()=>jf({})}}),Fve=Mr({name:"ElCol"}),Nve=Mr({...Fve,props:Bve,setup(t){const e=t,{gutter:r}=Mn(Sq,{gutter:gt(()=>0)}),n=yn("col"),i=gt(()=>{const l={};return r.value&&(l.paddingLeft=l.paddingRight=`${r.value/2}px`),l}),a=gt(()=>{const l=[];return["span","offset","pull","push"].forEach(d=>{const g=e[d];Fo(g)&&(d==="span"?l.push(n.b(`${e[d]}`)):g>0&&l.push(n.b(`${d}-${e[d]}`)))}),["xs","sm","md","lg","xl"].forEach(d=>{Fo(e[d])?l.push(n.b(`${d}-${e[d]}`)):fi(e[d])&&Object.entries(e[d]).forEach(([g,m])=>{l.push(g!=="span"?n.b(`${d}-${g}-${m}`):n.b(`${d}-${m}`))})}),r.value&&l.push(n.is("guttered")),[n.b(),l]});return(l,c)=>(Nt(),kr(sd(l.tag),{class:Lr(Pe(a)),style:va(Pe(i))},{default:pt(()=>[Cn(l.$slots,"default")]),_:3},8,["class","style"]))}});var Vve=_i(Nve,[["__file","col.vue"]]);const Gve=ss(Vve),Uve=Mr({name:"ElCollapseTransition"}),$ve=Mr({...Uve,setup(t){const e=yn("collapse-transition"),r=i=>{i.style.maxHeight="",i.style.overflow=i.dataset.oldOverflow,i.style.paddingTop=i.dataset.oldPaddingTop,i.style.paddingBottom=i.dataset.oldPaddingBottom},n={beforeEnter(i){i.dataset||(i.dataset={}),i.dataset.oldPaddingTop=i.style.paddingTop,i.dataset.oldPaddingBottom=i.style.paddingBottom,i.style.height&&(i.dataset.elExistsHeight=i.style.height),i.style.maxHeight=0,i.style.paddingTop=0,i.style.paddingBottom=0},enter(i){requestAnimationFrame(()=>{i.dataset.oldOverflow=i.style.overflow,i.dataset.elExistsHeight?i.style.maxHeight=i.dataset.elExistsHeight:i.scrollHeight!==0?i.style.maxHeight=`${i.scrollHeight}px`:i.style.maxHeight=0,i.style.paddingTop=i.dataset.oldPaddingTop,i.style.paddingBottom=i.dataset.oldPaddingBottom,i.style.overflow="hidden"})},afterEnter(i){i.style.maxHeight="",i.style.overflow=i.dataset.oldOverflow},enterCancelled(i){r(i)},beforeLeave(i){i.dataset||(i.dataset={}),i.dataset.oldPaddingTop=i.style.paddingTop,i.dataset.oldPaddingBottom=i.style.paddingBottom,i.dataset.oldOverflow=i.style.overflow,i.style.maxHeight=`${i.scrollHeight}px`,i.style.overflow="hidden"},leave(i){i.scrollHeight!==0&&(i.style.maxHeight=0,i.style.paddingTop=0,i.style.paddingBottom=0)},afterLeave(i){r(i)},leaveCancelled(i){r(i)}};return(i,a)=>(Nt(),kr(Ad,wh({name:Pe(e).b()},soe(n)),{default:pt(()=>[Cn(i.$slots,"default")]),_:3},16,["name"]))}});var LA=_i($ve,[["__file","collapse-transition.vue"]]);LA.install=t=>{t.component(LA.name,LA)};const Hve=LA,jve=Mr({name:"ElContainer"}),Wve=Mr({...jve,props:{direction:{type:String}},setup(t){const e=t,r=J_(),n=yn("container"),i=gt(()=>e.direction==="vertical"?!0:e.direction==="horizontal"?!1:r&&r.default?r.default().some(l=>{const c=l.type.name;return c==="ElHeader"||c==="ElFooter"}):!1);return(a,l)=>(Nt(),Gr("section",{class:Lr([Pe(n).b(),Pe(n).is("vertical",Pe(i))])},[Cn(a.$slots,"default")],2))}});var Zve=_i(Wve,[["__file","container.vue"]]);const qve=Mr({name:"ElAside"}),Yve=Mr({...qve,props:{width:{type:String,default:null}},setup(t){const e=t,r=yn("aside"),n=gt(()=>e.width?r.cssVarBlock({width:e.width}):{});return(i,a)=>(Nt(),Gr("aside",{class:Lr(Pe(r).b()),style:va(Pe(n))},[Cn(i.$slots,"default")],6))}});var Tq=_i(Yve,[["__file","aside.vue"]]);const Xve=Mr({name:"ElFooter"}),Qve=Mr({...Xve,props:{height:{type:String,default:null}},setup(t){const e=t,r=yn("footer"),n=gt(()=>e.height?r.cssVarBlock({height:e.height}):{});return(i,a)=>(Nt(),Gr("footer",{class:Lr(Pe(r).b()),style:va(Pe(n))},[Cn(i.$slots,"default")],6))}});var Aq=_i(Qve,[["__file","footer.vue"]]);const Kve=Mr({name:"ElHeader"}),Jve=Mr({...Kve,props:{height:{type:String,default:null}},setup(t){const e=t,r=yn("header"),n=gt(()=>e.height?r.cssVarBlock({height:e.height}):{});return(i,a)=>(Nt(),Gr("header",{class:Lr(Pe(r).b()),style:va(Pe(n))},[Cn(i.$slots,"default")],6))}});var Cq=_i(Jve,[["__file","header.vue"]]);const eme=Mr({name:"ElMain"}),tme=Mr({...eme,setup(t){const e=yn("main");return(r,n)=>(Nt(),Gr("main",{class:Lr(Pe(e).b())},[Cn(r.$slots,"default")],2))}});var Mq=_i(tme,[["__file","main.vue"]]);const rme=ss(Zve,{Aside:Tq,Footer:Aq,Header:Cq,Main:Mq}),nme=Bl(Tq);Bl(Aq);const ime=Bl(Cq),ame=Bl(Mq),ome=zi({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:Qn([String,Array,Object])},zIndex:{type:Qn([String,Number])}}),sme={click:t=>t instanceof MouseEvent},lme="overlay";var ume=Mr({name:"ElOverlay",props:ome,emits:sme,setup(t,{slots:e,emit:r}){const n=yn(lme),i=o=>{r("click",o)},{onClick:a,onMousedown:l,onMouseup:c}=Zde(t.customMaskEvent?void 0:i);return()=>t.mask?He("div",{class:[n.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:a,onMousedown:l,onMouseup:c},[Cn(e,"default")],CA.STYLE|CA.CLASS|CA.PROPS,["onClick","onMouseup","onMousedown"]):ln("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Cn(e,"default")])}});const cme=ume,hme=zi({center:Boolean,alignCenter:Boolean,closeIcon:{type:Zf},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),fme=zi({...hme,appendToBody:Boolean,appendTo:{type:Qn(String),default:"body"},beforeClose:{type:Qn(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),dme={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[Cd]:t=>Kg(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},pme=(t,e)=>{var r;const i=Mi().emit,{nextZIndex:a}=WZ();let l="";const c=z1(),o=z1(),d=at(!1),g=at(!1),m=at(!1),y=at((r=t.zIndex)!=null?r:a());let x,A;const M=ZZ("namespace",MA),D=gt(()=>{const ve={},me=`--${M.value}-dialog`;return t.fullscreen||(t.top&&(ve[`${me}-margin-top`]=t.top),t.width&&(ve[`${me}-width`]=R_(t.width))),ve}),P=gt(()=>t.alignCenter?{display:"flex"}:{});function O(){i("opened")}function z(){i("closed"),i(Cd,!1),t.destroyOnClose&&(m.value=!1)}function V(){i("close")}function H(){A==null||A(),x==null||x(),t.openDelay&&t.openDelay>0?{stop:x}=fC(()=>Y(),t.openDelay):Y()}function $(){x==null||x(),A==null||A(),t.closeDelay&&t.closeDelay>0?{stop:A}=fC(()=>J(),t.closeDelay):J()}function X(){function ve(me){me||(g.value=!0,d.value=!1)}t.beforeClose?t.beforeClose(ve):$()}function W(){t.closeOnClickModal&&X()}function Y(){fa&&(d.value=!0)}function J(){d.value=!1}function re(){i("openAutoFocus")}function ae(){i("closeAutoFocus")}function pe(ve){var me;((me=ve.detail)==null?void 0:me.focusReason)==="pointer"&&ve.preventDefault()}t.lockScroll&&Vfe(d);function de(){t.closeOnPressEscape&&X()}return un(()=>t.modelValue,ve=>{ve?(g.value=!1,H(),m.value=!0,y.value=wZ(t.zIndex)?a():y.value++,Fa(()=>{i("open"),e.value&&(e.value.scrollTop=0)})):d.value&&$()}),un(()=>t.fullscreen,ve=>{e.value&&(ve?(l=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=l)}),Vn(()=>{t.modelValue&&(d.value=!0,m.value=!0,H())}),{afterEnter:O,afterLeave:z,beforeLeave:V,handleClose:X,onModalClick:W,close:$,doClose:J,onOpenAutoFocus:re,onCloseAutoFocus:ae,onCloseRequested:de,onFocusoutPrevented:pe,titleId:c,bodyId:o,closed:g,style:D,overlayDialogStyle:P,rendered:m,visible:d,zIndex:y}},gme=zi({...fme,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),vme=dme,mme=["aria-label","aria-labelledby","aria-describedby"],_me=["id","aria-level"],yme=["aria-label"],xme=["id"],bme=Mr({name:"ElDrawer",inheritAttrs:!1}),wme=Mr({...bme,props:gme,emits:vme,setup(t,{expose:e}){const r=t,n=J_();bg({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},gt(()=>!!n.title));const i=at(),a=at(),l=yn("drawer"),{t:c}=$M(),{afterEnter:o,afterLeave:d,beforeLeave:g,visible:m,rendered:y,titleId:x,bodyId:A,zIndex:M,onModalClick:D,onOpenAutoFocus:P,onCloseAutoFocus:O,onFocusoutPrevented:z,onCloseRequested:V,handleClose:H}=pme(r,i),$=gt(()=>r.direction==="rtl"||r.direction==="ltr"),X=gt(()=>R_(r.size));return e({handleClose:H,afterEnter:o,afterLeave:d}),(W,Y)=>(Nt(),kr(R7,{to:"body",disabled:!W.appendToBody},[He(Ad,{name:Pe(l).b("fade"),onAfterEnter:Pe(o),onAfterLeave:Pe(d),onBeforeLeave:Pe(g),persisted:""},{default:pt(()=>[es(He(Pe(cme),{mask:W.modal,"overlay-class":W.modalClass,"z-index":Pe(M),onClick:Pe(D)},{default:pt(()=>[He(Pe(tq),{loop:"",trapped:Pe(m),"focus-trap-el":i.value,"focus-start-el":a.value,onFocusAfterTrapped:Pe(P),onFocusAfterReleased:Pe(O),onFocusoutPrevented:Pe(z),onReleaseRequested:Pe(V)},{default:pt(()=>[wt("div",wh({ref_key:"drawerRef",ref:i,"aria-modal":"true","aria-label":W.title||void 0,"aria-labelledby":W.title?void 0:Pe(x),"aria-describedby":Pe(A)},W.$attrs,{class:[Pe(l).b(),W.direction,Pe(m)&&"open"],style:Pe($)?"width: "+Pe(X):"height: "+Pe(X),role:"dialog",onClick:Y[1]||(Y[1]=Yg(()=>{},["stop"]))}),[wt("span",{ref_key:"focusStartRef",ref:a,class:Lr(Pe(l).e("sr-focus")),tabindex:"-1"},null,2),W.withHeader?(Nt(),Gr("header",{key:0,class:Lr(Pe(l).e("header"))},[W.$slots.title?Cn(W.$slots,"title",{key:1},()=>[In(" DEPRECATED SLOT ")]):Cn(W.$slots,"header",{key:0,close:Pe(H),titleId:Pe(x),titleClass:Pe(l).e("title")},()=>[W.$slots.title?In("v-if",!0):(Nt(),Gr("span",{key:0,id:Pe(x),role:"heading","aria-level":W.headerAriaLevel,class:Lr(Pe(l).e("title"))},_n(W.title),11,_me))]),W.showClose?(Nt(),Gr("button",{key:2,"aria-label":Pe(c)("el.drawer.close"),class:Lr(Pe(l).e("close-btn")),type:"button",onClick:Y[0]||(Y[0]=(...J)=>Pe(H)&&Pe(H)(...J))},[He(Pe(As),{class:Lr(Pe(l).e("close"))},{default:pt(()=>[He(Pe(_C))]),_:1},8,["class"])],10,yme)):In("v-if",!0)],2)):In("v-if",!0),Pe(y)?(Nt(),Gr("div",{key:1,id:Pe(A),class:Lr(Pe(l).e("body"))},[Cn(W.$slots,"default")],10,xme)):In("v-if",!0),W.$slots.footer?(Nt(),Gr("div",{key:2,class:Lr(Pe(l).e("footer"))},[Cn(W.$slots,"footer")],2)):In("v-if",!0)],16,mme)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[qg,Pe(m)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var Sme=_i(wme,[["__file","drawer.vue"]]);const Tme=ss(Sme),Ame={viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},Cme=["id"],Mme=["stop-color"],Ime=["stop-color"],Eme=["id"],Dme=["stop-color"],Pme=["stop-color"],Lme=["id"],Rme={id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},kme={id:"B-type",transform:"translate(-1268.000000, -535.000000)"},Ome={id:"Group-2",transform:"translate(1268.000000, 535.000000)"},zme=["fill"],Bme=["fill"],Fme={id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},Nme=["fill"],Vme=["fill"],Gme=["fill"],Ume=["fill"],$me=["fill"],Hme={id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},jme=["fill","xlink:href"],Wme=["fill","mask"],Zme=["fill"],qme=Mr({name:"ImgEmpty"}),Yme=Mr({...qme,setup(t){const e=yn("empty"),r=z1();return(n,i)=>(Nt(),Gr("svg",Ame,[wt("defs",null,[wt("linearGradient",{id:`linearGradient-1-${Pe(r)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[wt("stop",{"stop-color":`var(${Pe(e).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,Mme),wt("stop",{"stop-color":`var(${Pe(e).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,Ime)],8,Cme),wt("linearGradient",{id:`linearGradient-2-${Pe(r)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[wt("stop",{"stop-color":`var(${Pe(e).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,Dme),wt("stop",{"stop-color":`var(${Pe(e).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,Pme)],8,Eme),wt("rect",{id:`path-3-${Pe(r)}`,x:"0",y:"0",width:"17",height:"36"},null,8,Lme)]),wt("g",Rme,[wt("g",kme,[wt("g",Ome,[wt("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${Pe(e).cssVarBlockName("fill-color-3")})`},null,8,zme),wt("polygon",{id:"Rectangle-Copy-14",fill:`var(${Pe(e).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,Bme),wt("g",Fme,[wt("polygon",{id:"Rectangle-Copy-10",fill:`var(${Pe(e).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,Nme),wt("polygon",{id:"Rectangle-Copy-11",fill:`var(${Pe(e).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,Vme),wt("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${Pe(r)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,Gme),wt("polygon",{id:"Rectangle-Copy-13",fill:`var(${Pe(e).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,Ume)]),wt("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${Pe(r)})`,x:"13",y:"45",width:"40",height:"36"},null,8,$me),wt("g",Hme,[wt("use",{id:"Mask",fill:`var(${Pe(e).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${Pe(r)}`},null,8,jme),wt("polygon",{id:"Rectangle-Copy",fill:`var(${Pe(e).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${Pe(r)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,Wme)]),wt("polygon",{id:"Rectangle-Copy-18",fill:`var(${Pe(e).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,Zme)])])])]))}});var Xme=_i(Yme,[["__file","img-empty.vue"]]);const Qme=zi({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),Kme=["src"],Jme={key:1},e_e=Mr({name:"ElEmpty"}),t_e=Mr({...e_e,props:Qme,setup(t){const e=t,{t:r}=$M(),n=yn("empty"),i=gt(()=>e.description||r("el.table.emptyText")),a=gt(()=>({width:R_(e.imageSize)}));return(l,c)=>(Nt(),Gr("div",{class:Lr(Pe(n).b())},[wt("div",{class:Lr(Pe(n).e("image")),style:va(Pe(a))},[l.image?(Nt(),Gr("img",{key:0,src:l.image,ondragstart:"return false"},null,8,Kme)):Cn(l.$slots,"image",{key:1},()=>[He(Xme)])],6),wt("div",{class:Lr(Pe(n).e("description"))},[l.$slots.description?Cn(l.$slots,"description",{key:0}):(Nt(),Gr("p",Jme,_n(Pe(i)),1))],2),l.$slots.default?(Nt(),Gr("div",{key:0,class:Lr(Pe(n).e("bottom"))},[Cn(l.$slots,"default")],2)):In("v-if",!0)],2))}});var r_e=_i(t_e,[["__file","empty.vue"]]);const n_e=ss(r_e);let i_e=class{constructor(e,r){this.parent=e,this.domNode=r,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(e){e===this.subMenuItems.length?e=0:e<0&&(e=this.subMenuItems.length-1),this.subMenuItems[e].focus(),this.subIndex=e}addListeners(){const e=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,r=>{r.addEventListener("keydown",n=>{let i=!1;switch(n.code){case co.down:{this.gotoSubIndex(this.subIndex+1),i=!0;break}case co.up:{this.gotoSubIndex(this.subIndex-1),i=!0;break}case co.tab:{AA(e,"mouseleave");break}case co.enter:case co.space:{i=!0,n.currentTarget.click();break}}return i&&(n.preventDefault(),n.stopPropagation()),!1})})}},a_e=class{constructor(e,r){this.domNode=e,this.submenu=null,this.submenu=null,this.init(r)}init(e){this.domNode.setAttribute("tabindex","0");const r=this.domNode.querySelector(`.${e}-menu`);r&&(this.submenu=new i_e(this,r)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",e=>{let r=!1;switch(e.code){case co.down:{AA(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),r=!0;break}case co.up:{AA(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),r=!0;break}case co.tab:{AA(e.currentTarget,"mouseleave");break}case co.enter:case co.space:{r=!0,e.currentTarget.click();break}}r&&e.preventDefault()})}},o_e=class{constructor(e,r){this.domNode=e,this.init(r)}init(e){const r=this.domNode.childNodes;Array.from(r).forEach(n=>{n.nodeType===1&&new a_e(n,e)})}};const s_e=Mr({name:"ElMenuCollapseTransition",setup(){const t=yn("menu");return{listeners:{onBeforeEnter:r=>r.style.opacity="0.2",onEnter(r,n){eh(r,`${t.namespace.value}-opacity-transition`),r.style.opacity="1",n()},onAfterEnter(r){ih(r,`${t.namespace.value}-opacity-transition`),r.style.opacity=""},onBeforeLeave(r){r.dataset||(r.dataset={}),Og(r,t.m("collapse"))?(ih(r,t.m("collapse")),r.dataset.oldOverflow=r.style.overflow,r.dataset.scrollWidth=r.clientWidth.toString(),eh(r,t.m("collapse"))):(eh(r,t.m("collapse")),r.dataset.oldOverflow=r.style.overflow,r.dataset.scrollWidth=r.clientWidth.toString(),ih(r,t.m("collapse"))),r.style.width=`${r.scrollWidth}px`,r.style.overflow="hidden"},onLeave(r){eh(r,"horizontal-collapse-transition"),r.style.width=`${r.dataset.scrollWidth}px`}}}}});function l_e(t,e,r,n,i,a){return Nt(),kr(Ad,wh({mode:"out-in"},t.listeners),{default:pt(()=>[Cn(t.$slots,"default")]),_:3},16)}var u_e=_i(s_e,[["render",l_e],["__file","menu-collapse-transition.vue"]]);function Iq(t,e){const r=gt(()=>{let i=t.parent;const a=[e.value];for(;i.type.name!=="ElMenu";)i.props.index&&a.unshift(i.props.index),i=i.parent;return a});return{parentMenu:gt(()=>{let i=t.parent;for(;i&&!["ElMenu","ElSubMenu"].includes(i.type.name);)i=i.parent;return i}),indexPath:r}}function c_e(t){return gt(()=>{const r=t.backgroundColor;return r?new sq(r).shade(20).toString():""})}const Eq=(t,e)=>{const r=yn("menu");return gt(()=>r.cssVarBlock({"text-color":t.textColor||"","hover-text-color":t.textColor||"","bg-color":t.backgroundColor||"","hover-bg-color":c_e(t).value||"","active-color":t.activeTextColor||"",level:`${e}`}))},h_e=zi({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:Zf},expandOpenIcon:{type:Zf},collapseCloseIcon:{type:Zf},collapseOpenIcon:{type:Zf}}),nP="ElSubMenu";var hz=Mr({name:nP,props:h_e,setup(t,{slots:e,expose:r}){const n=Mi(),{indexPath:i,parentMenu:a}=Iq(n,gt(()=>t.index)),l=yn("menu"),c=yn("sub-menu"),o=Mn("rootMenu");o||lc(nP,"can not inject root menu");const d=Mn(`subMenu:${a.value.uid}`);d||lc(nP,"can not inject sub menu");const g=at({}),m=at({});let y;const x=at(!1),A=at(),M=at(null),D=gt(()=>W.value==="horizontal"&&O.value?"bottom-start":"right-start"),P=gt(()=>W.value==="horizontal"&&O.value||W.value==="vertical"&&!o.props.collapse?t.expandCloseIcon&&t.expandOpenIcon?$.value?t.expandOpenIcon:t.expandCloseIcon:CZ:t.collapseCloseIcon&&t.collapseOpenIcon?$.value?t.collapseOpenIcon:t.collapseCloseIcon:GM),O=gt(()=>d.level===0),z=gt(()=>{const Ue=t.teleported;return Ue===void 0?O.value:Ue}),V=gt(()=>o.props.collapse?`${l.namespace.value}-zoom-in-left`:`${l.namespace.value}-zoom-in-top`),H=gt(()=>W.value==="horizontal"&&O.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),$=gt(()=>o.openedMenus.includes(t.index)),X=gt(()=>{let Ue=!1;return Object.values(g.value).forEach(Ke=>{Ke.active&&(Ue=!0)}),Object.values(m.value).forEach(Ke=>{Ke.active&&(Ue=!0)}),Ue}),W=gt(()=>o.props.mode),Y=gc({index:t.index,indexPath:i,active:X}),J=Eq(o.props,d.level+1),re=gt(()=>{var Ue;return(Ue=t.popperOffset)!=null?Ue:o.props.popperOffset}),ae=gt(()=>{var Ue;return(Ue=t.popperClass)!=null?Ue:o.props.popperClass}),pe=gt(()=>{var Ue;return(Ue=t.showTimeout)!=null?Ue:o.props.showTimeout}),de=gt(()=>{var Ue;return(Ue=t.hideTimeout)!=null?Ue:o.props.hideTimeout}),ve=()=>{var Ue,Ke,We;return(We=(Ke=(Ue=M.value)==null?void 0:Ue.popperRef)==null?void 0:Ke.popperInstanceRef)==null?void 0:We.destroy()},me=Ue=>{Ue||ve()},Ie=()=>{o.props.menuTrigger==="hover"&&o.props.mode==="horizontal"||o.props.collapse&&o.props.mode==="vertical"||t.disabled||o.handleSubMenuClick({index:t.index,indexPath:i.value,active:X.value})},Le=(Ue,Ke=pe.value)=>{var We;if(Ue.type!=="focus"){if(o.props.menuTrigger==="click"&&o.props.mode==="horizontal"||!o.props.collapse&&o.props.mode==="vertical"||t.disabled){d.mouseInChild.value=!0;return}d.mouseInChild.value=!0,y==null||y(),{stop:y}=fC(()=>{o.openMenu(t.index,i.value)},Ke),z.value&&((We=a.value.vnode.el)==null||We.dispatchEvent(new MouseEvent("mouseenter")))}},Ee=(Ue=!1)=>{var Ke;if(o.props.menuTrigger==="click"&&o.props.mode==="horizontal"||!o.props.collapse&&o.props.mode==="vertical"){d.mouseInChild.value=!1;return}y==null||y(),d.mouseInChild.value=!1,{stop:y}=fC(()=>!x.value&&o.closeMenu(t.index,i.value),de.value),z.value&&Ue&&((Ke=d.handleMouseleave)==null||Ke.call(d,!0))};un(()=>o.props.collapse,Ue=>me(!!Ue));{const Ue=We=>{m.value[We.index]=We},Ke=We=>{delete m.value[We.index]};No(`subMenu:${n.uid}`,{addSubMenu:Ue,removeSubMenu:Ke,handleMouseleave:Ee,mouseInChild:x,level:d.level+1})}return r({opened:$}),Vn(()=>{o.addSubMenu(Y),d.addSubMenu(Y)}),Es(()=>{d.removeSubMenu(Y),o.removeSubMenu(Y)}),()=>{var Ue;const Ke=[(Ue=e.title)==null?void 0:Ue.call(e),ln(As,{class:c.e("icon-arrow"),style:{transform:$.value?t.expandCloseIcon&&t.expandOpenIcon||t.collapseCloseIcon&&t.collapseOpenIcon&&o.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>wi(P.value)?ln(n.appContext.components[P.value]):ln(P.value)})],We=o.isMenuPopup?ln(YM,{ref:M,visible:$.value,effect:"light",pure:!0,offset:re.value,showArrow:!1,persistent:!0,popperClass:ae.value,placement:D.value,teleported:z.value,fallbackPlacements:H.value,transition:V.value,gpuAcceleration:!1},{content:()=>{var Rt;return ln("div",{class:[l.m(W.value),l.m("popup-container"),ae.value],onMouseenter:Et=>Le(Et,100),onMouseleave:()=>Ee(!0),onFocus:Et=>Le(Et,100)},[ln("ul",{class:[l.b(),l.m("popup"),l.m(`popup-${D.value}`)],style:J.value},[(Rt=e.default)==null?void 0:Rt.call(e)])])},default:()=>ln("div",{class:c.e("title"),onClick:Ie},Ke)}):ln(ha,{},[ln("div",{class:c.e("title"),ref:A,onClick:Ie},Ke),ln(Hve,{},{default:()=>{var Rt;return es(ln("ul",{role:"menu",class:[l.b(),l.m("inline")],style:J.value},[(Rt=e.default)==null?void 0:Rt.call(e)]),[[qg,$.value]])}})]);return ln("li",{class:[c.b(),c.is("active",X.value),c.is("opened",$.value),c.is("disabled",t.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:$.value,onMouseenter:Le,onMouseleave:()=>Ee(),onFocus:Le},[We])}}});const f_e=zi({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:Qn(Array),default:()=>jf([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:Zf,default:()=>Efe},popperEffect:{type:String,values:["dark","light"],default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),iP=t=>Array.isArray(t)&&t.every(e=>wi(e)),d_e={close:(t,e)=>wi(t)&&iP(e),open:(t,e)=>wi(t)&&iP(e),select:(t,e,r,n)=>wi(t)&&iP(e)&&fi(r)&&(n===void 0||n instanceof Promise)};var p_e=Mr({name:"ElMenu",props:f_e,emits:d_e,setup(t,{emit:e,slots:r,expose:n}){const i=Mi(),a=i.appContext.config.globalProperties.$router,l=at(),c=yn("menu"),o=yn("sub-menu"),d=at(-1),g=at(t.defaultOpeneds&&!t.collapse?t.defaultOpeneds.slice(0):[]),m=at(t.defaultActive),y=at({}),x=at({}),A=gt(()=>t.mode==="horizontal"||t.mode==="vertical"&&t.collapse),M=()=>{const de=m.value&&y.value[m.value];if(!de||t.mode==="horizontal"||t.collapse)return;de.indexPath.forEach(me=>{const Ie=x.value[me];Ie&&D(me,Ie.indexPath)})},D=(de,ve)=>{g.value.includes(de)||(t.uniqueOpened&&(g.value=g.value.filter(me=>ve.includes(me))),g.value.push(de),e("open",de,ve))},P=de=>{const ve=g.value.indexOf(de);ve!==-1&&g.value.splice(ve,1)},O=(de,ve)=>{P(de),e("close",de,ve)},z=({index:de,indexPath:ve})=>{g.value.includes(de)?O(de,ve):D(de,ve)},V=de=>{(t.mode==="horizontal"||t.collapse)&&(g.value=[]);const{index:ve,indexPath:me}=de;if(!(P_(ve)||P_(me)))if(t.router&&a){const Ie=de.route||ve,Le=a.push(Ie).then(Ee=>(Ee||(m.value=ve),Ee));e("select",ve,me,{index:ve,indexPath:me,route:Ie},Le)}else m.value=ve,e("select",ve,me,{index:ve,indexPath:me})},H=de=>{const ve=y.value,me=ve[de]||m.value&&ve[m.value]||ve[t.defaultActive];me?m.value=me.index:m.value=de},$=de=>{const ve=getComputedStyle(de),me=Number.parseInt(ve.marginLeft,10),Ie=Number.parseInt(ve.marginRight,10);return de.offsetWidth+me+Ie||0},X=()=>{var de,ve;if(!l.value)return-1;const me=Array.from((ve=(de=l.value)==null?void 0:de.childNodes)!=null?ve:[]).filter(Et=>Et.nodeName!=="#comment"&&(Et.nodeName!=="#text"||Et.nodeValue)),Ie=64,Le=getComputedStyle(l.value),Ee=Number.parseInt(Le.paddingLeft,10),Ue=Number.parseInt(Le.paddingRight,10),Ke=l.value.clientWidth-Ee-Ue;let We=0,Rt=0;return me.forEach((Et,ar)=>{We+=$(Et),We<=Ke-Ie&&(Rt=ar+1)}),Rt===me.length?-1:Rt},W=de=>x.value[de].indexPath,Y=(de,ve=33.34)=>{let me;return()=>{me&&clearTimeout(me),me=setTimeout(()=>{de()},ve)}};let J=!0;const re=()=>{if(d.value===X())return;const de=()=>{d.value=-1,Fa(()=>{d.value=X()})};J?de():Y(de)(),J=!1};un(()=>t.defaultActive,de=>{y.value[de]||(m.value=""),H(de)}),un(()=>t.collapse,de=>{de&&(g.value=[])}),un(y.value,M);let ae;kg(()=>{t.mode==="horizontal"&&t.ellipsis?ae=D_(l,re).stop:ae==null||ae()});const pe=at(!1);{const de=Le=>{x.value[Le.index]=Le},ve=Le=>{delete x.value[Le.index]};No("rootMenu",gc({props:t,openedMenus:g,items:y,subMenus:x,activeIndex:m,isMenuPopup:A,addMenuItem:Le=>{y.value[Le.index]=Le},removeMenuItem:Le=>{delete y.value[Le.index]},addSubMenu:de,removeSubMenu:ve,openMenu:D,closeMenu:O,handleMenuItemClick:V,handleSubMenuClick:z})),No(`subMenu:${i.uid}`,{addSubMenu:de,removeSubMenu:ve,mouseInChild:pe,level:0})}return Vn(()=>{t.mode==="horizontal"&&new o_e(i.vnode.el,c.namespace.value)}),n({open:ve=>{const{indexPath:me}=x.value[ve];me.forEach(Ie=>D(Ie,me))},close:P,handleResize:re}),()=>{var de,ve;let me=(ve=(de=r.default)==null?void 0:de.call(r))!=null?ve:[];const Ie=[];if(t.mode==="horizontal"&&l.value){const Ke=n1(me),We=d.value===-1?Ke:Ke.slice(0,d.value),Rt=d.value===-1?[]:Ke.slice(d.value);Rt!=null&&Rt.length&&t.ellipsis&&(me=We,Ie.push(ln(hz,{index:"sub-menu-more",class:o.e("hide-arrow"),popperOffset:t.popperOffset},{title:()=>ln(As,{class:o.e("icon-more")},{default:()=>ln(t.ellipsisIcon)}),default:()=>Rt})))}const Le=Eq(t,0),Ee=t.closeOnClickOutside?[[cq,()=>{g.value.length&&(pe.value||(g.value.forEach(Ke=>e("close",Ke,W(Ke))),g.value=[]))}]]:[],Ue=es(ln("ul",{key:String(t.collapse),role:"menubar",ref:l,style:Le.value,class:{[c.b()]:!0,[c.m(t.mode)]:!0,[c.m("collapse")]:t.collapse}},[...me,...Ie]),Ee);return t.collapseTransition&&t.mode==="vertical"?ln(u_e,()=>Ue):Ue}}});const g_e=zi({index:{type:Qn([String,null]),default:null},route:{type:Qn([String,Object])},disabled:Boolean}),v_e={click:t=>wi(t.index)&&Array.isArray(t.indexPath)},aP="ElMenuItem",m_e=Mr({name:aP,components:{ElTooltip:YM},props:g_e,emits:v_e,setup(t,{emit:e}){const r=Mi(),n=Mn("rootMenu"),i=yn("menu"),a=yn("menu-item");n||lc(aP,"can not inject root menu");const{parentMenu:l,indexPath:c}=Iq(r,Il(t,"index")),o=Mn(`subMenu:${l.value.uid}`);o||lc(aP,"can not inject sub menu");const d=gt(()=>t.index===n.activeIndex),g=gc({index:t.index,indexPath:c,active:d}),m=()=>{t.disabled||(n.handleMenuItemClick({index:t.index,indexPath:c.value,route:t.route}),e("click",g))};return Vn(()=>{o.addSubMenu(g),n.addMenuItem(g)}),Es(()=>{o.removeSubMenu(g),n.removeMenuItem(g)}),{parentMenu:l,rootMenu:n,active:d,nsMenu:i,nsMenuItem:a,handleClick:m}}});function __e(t,e,r,n,i,a){const l=Zs("el-tooltip");return Nt(),Gr("li",{class:Lr([t.nsMenuItem.b(),t.nsMenuItem.is("active",t.active),t.nsMenuItem.is("disabled",t.disabled)]),role:"menuitem",tabindex:"-1",onClick:e[0]||(e[0]=(...c)=>t.handleClick&&t.handleClick(...c))},[t.parentMenu.type.name==="ElMenu"&&t.rootMenu.props.collapse&&t.$slots.title?(Nt(),kr(l,{key:0,effect:t.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:pt(()=>[Cn(t.$slots,"title")]),default:pt(()=>[wt("div",{class:Lr(t.nsMenu.be("tooltip","trigger"))},[Cn(t.$slots,"default")],2)]),_:3},8,["effect"])):(Nt(),Gr(ha,{key:1},[Cn(t.$slots,"default"),Cn(t.$slots,"title")],64))],2)}var Dq=_i(m_e,[["render",__e],["__file","menu-item.vue"]]);const y_e={title:String},x_e="ElMenuItemGroup",b_e=Mr({name:x_e,props:y_e,setup(){return{ns:yn("menu-item-group")}}});function w_e(t,e,r,n,i,a){return Nt(),Gr("li",{class:Lr(t.ns.b())},[wt("div",{class:Lr(t.ns.e("title"))},[t.$slots.title?Cn(t.$slots,"title",{key:1}):(Nt(),Gr(ha,{key:0},[ji(_n(t.title),1)],64))],2),wt("ul",null,[Cn(t.$slots,"default")])],2)}var Pq=_i(b_e,[["render",w_e],["__file","menu-item-group.vue"]]);const S_e=ss(p_e,{MenuItem:Dq,MenuItemGroup:Pq,SubMenu:hz}),T_e=Bl(Dq);Bl(Pq);Bl(hz);const oP=function(t){var e;return(e=t.target)==null?void 0:e.closest("td")},A_e=function(t,e,r,n,i){if(!e&&!n&&(!i||Array.isArray(i)&&!i.length))return t;typeof r=="string"?r=r==="descending"?-1:1:r=r&&r<0?-1:1;const a=n?null:function(c,o){return i?(Array.isArray(i)||(i=[i]),i.map(d=>typeof d=="string"?R1(c,d):d(c,o,t))):(e!=="$key"&&fi(c)&&"$value"in c&&(c=c.$value),[fi(c)?R1(c,e):c])},l=function(c,o){if(n)return n(c.value,o.value);for(let d=0,g=c.key.length;d<g;d++){if(c.key[d]<o.key[d])return-1;if(c.key[d]>o.key[d])return 1}return 0};return t.map((c,o)=>({value:c,index:o,key:a?a(c,o):null})).sort((c,o)=>{let d=l(c,o);return d||(d=c.index-o.index),d*+r}).map(c=>c.value)},Lq=function(t,e){let r=null;return t.columns.forEach(n=>{n.id===e&&(r=n)}),r},C_e=function(t,e){let r=null;for(let n=0;n<t.columns.length;n++){const i=t.columns[n];if(i.columnKey===e){r=i;break}}return r||lc("ElTable",`No column matching with column-key: ${e}`),r},hG=function(t,e,r){const n=(e.className||"").match(new RegExp(`${r}-table_[^\\s]+`,"gm"));return n?Lq(t,n[0]):null},bo=(t,e)=>{if(!t)throw new Error("Row is required when get row identity");if(typeof e=="string"){if(!e.includes("."))return`${t[e]}`;const r=e.split(".");let n=t;for(const i of r)n=n[i];return`${n}`}else if(typeof e=="function")return e.call(null,t)},Sg=function(t,e){const r={};return(t||[]).forEach((n,i)=>{r[bo(n,e)]={row:n,index:i}}),r};function M_e(t,e){const r={};let n;for(n in t)r[n]=t[n];for(n in e)if(ni(e,n)){const i=e[n];typeof i<"u"&&(r[n]=i)}return r}function fz(t){return t===""||t!==void 0&&(t=Number.parseInt(t,10),Number.isNaN(t)&&(t="")),t}function Rq(t){return t===""||t!==void 0&&(t=fz(t),Number.isNaN(t)&&(t=80)),t}function I_e(t){return typeof t=="number"?t:typeof t=="string"?/^\d+(?:px)?$/.test(t)?Number.parseInt(t,10):t:null}function E_e(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function o1(t,e,r){let n=!1;const i=t.indexOf(e),a=i!==-1,l=c=>{c==="add"?t.push(e):t.splice(i,1),n=!0,Wr(e.children)&&e.children.forEach(o=>{o1(t,o,r??!a)})};return Kg(r)?r&&!a?l("add"):!r&&a&&l("remove"):l(a?"remove":"add"),n}function D_e(t,e,r="children",n="hasChildren"){const i=l=>!(Array.isArray(l)&&l.length);function a(l,c,o){e(l,c,o),c.forEach(d=>{if(d[n]){e(d,null,o+1);return}const g=d[r];i(g)||a(d,g,o+1)})}t.forEach(l=>{if(l[n]){e(l,null,0);return}const c=l[r];i(c)||a(l,c,0)})}let _l=null;function P_e(t,e,r,n){if((_l==null?void 0:_l.trigger)===r)return;_l==null||_l();const i=n==null?void 0:n.refs.tableWrapper,a=i==null?void 0:i.dataset.prefix,l={strategy:"fixed",...t.popperOptions},c=He(YM,{content:e,virtualTriggering:!0,virtualRef:r,appendTo:i,placement:"top",transition:"none",offset:0,hideAfter:0,...t,popperOptions:l,onHide:()=>{_l==null||_l()}});c.appContext={...n.appContext,...n};const o=document.createElement("div");$V(c,o),c.component.exposed.onOpen();const d=i==null?void 0:i.querySelector(`.${a}-scrollbar__wrap`);_l=()=>{$V(null,o),d==null||d.removeEventListener("scroll",_l),_l=null},_l.trigger=r,d==null||d.addEventListener("scroll",_l)}function kq(t){return t.children?lfe(t.children,kq):[t]}function fG(t,e){return t+e.colSpan}const Oq=(t,e,r,n)=>{let i=0,a=t;const l=r.states.columns.value;if(n){const o=kq(n[t]);i=l.slice(0,l.indexOf(o[0])).reduce(fG,0),a=i+o.reduce(fG,0)-1}else i=t;let c;switch(e){case"left":a<r.states.fixedLeafColumnsLength.value&&(c="left");break;case"right":i>=l.length-r.states.rightFixedLeafColumnsLength.value&&(c="right");break;default:a<r.states.fixedLeafColumnsLength.value?c="left":i>=l.length-r.states.rightFixedLeafColumnsLength.value&&(c="right")}return c?{direction:c,start:i,after:a}:{}},dz=(t,e,r,n,i,a=0)=>{const l=[],{direction:c,start:o,after:d}=Oq(e,r,n,i);if(c){const g=c==="left";l.push(`${t}-fixed-column--${c}`),g&&d+a===n.states.fixedLeafColumnsLength.value-1?l.push("is-last-column"):!g&&o-a===n.states.columns.value.length-n.states.rightFixedLeafColumnsLength.value&&l.push("is-first-column")}return l};function dG(t,e){return t+(e.realWidth===null||Number.isNaN(e.realWidth)?Number(e.width):e.realWidth)}const pz=(t,e,r,n)=>{const{direction:i,start:a=0,after:l=0}=Oq(t,e,r,n);if(!i)return;const c={},o=i==="left",d=r.states.columns.value;return o?c.left=d.slice(0,a).reduce(dG,0):c.right=d.slice(l+1).reverse().reduce(dG,0),c},V_=(t,e)=>{t&&(Number.isNaN(t[e])||(t[e]=`${t[e]}px`))};function L_e(t){const e=Mi(),r=at(!1),n=at([]);return{updateExpandRows:()=>{const o=t.data.value||[],d=t.rowKey.value;if(r.value)n.value=o.slice();else if(d){const g=Sg(n.value,d);n.value=o.reduce((m,y)=>{const x=bo(y,d);return g[x]&&m.push(y),m},[])}else n.value=[]},toggleRowExpansion:(o,d)=>{o1(n.value,o,d)&&e.emit("expand-change",o,n.value.slice())},setExpandRowKeys:o=>{e.store.assertRowKey();const d=t.data.value||[],g=t.rowKey.value,m=Sg(d,g);n.value=o.reduce((y,x)=>{const A=m[x];return A&&y.push(A.row),y},[])},isRowExpanded:o=>{const d=t.rowKey.value;return d?!!Sg(n.value,d)[bo(o,d)]:n.value.includes(o)},states:{expandRows:n,defaultExpandAll:r}}}function R_e(t){const e=Mi(),r=at(null),n=at(null),i=d=>{e.store.assertRowKey(),r.value=d,l(d)},a=()=>{r.value=null},l=d=>{const{data:g,rowKey:m}=t;let y=null;m.value&&(y=(Pe(g)||[]).find(x=>bo(x,m.value)===d)),n.value=y,e.emit("current-change",n.value,null)};return{setCurrentRowKey:i,restoreCurrentRowKey:a,setCurrentRowByKey:l,updateCurrentRow:d=>{const g=n.value;if(d&&d!==g){n.value=d,e.emit("current-change",n.value,g);return}!d&&g&&(n.value=null,e.emit("current-change",null,g))},updateCurrentRowData:()=>{const d=t.rowKey.value,g=t.data.value||[],m=n.value;if(!g.includes(m)&&m){if(d){const y=bo(m,d);l(y)}else n.value=null;n.value===null&&e.emit("current-change",null,m)}else r.value&&(l(r.value),a())},states:{_currentRowKey:r,currentRow:n}}}function k_e(t){const e=at([]),r=at({}),n=at(16),i=at(!1),a=at({}),l=at("hasChildren"),c=at("children"),o=Mi(),d=gt(()=>{if(!t.rowKey.value)return{};const P=t.data.value||[];return m(P)}),g=gt(()=>{const P=t.rowKey.value,O=Object.keys(a.value),z={};return O.length&&O.forEach(V=>{if(a.value[V].length){const H={children:[]};a.value[V].forEach($=>{const X=bo($,P);H.children.push(X),$[l.value]&&!z[X]&&(z[X]={children:[]})}),z[V]=H}}),z}),m=P=>{const O=t.rowKey.value,z={};return D_e(P,(V,H,$)=>{const X=bo(V,O);Array.isArray(H)?z[X]={children:H.map(W=>bo(W,O)),level:$}:i.value&&(z[X]={children:[],lazy:!0,level:$})},c.value,l.value),z},y=(P=!1,O=(z=>(z=o.store)==null?void 0:z.states.defaultExpandAll.value)())=>{var z;const V=d.value,H=g.value,$=Object.keys(V),X={};if($.length){const W=Pe(r),Y=[],J=(ae,pe)=>{if(P)return e.value?O||e.value.includes(pe):!!(O||ae!=null&&ae.expanded);{const de=O||e.value&&e.value.includes(pe);return!!(ae!=null&&ae.expanded||de)}};$.forEach(ae=>{const pe=W[ae],de={...V[ae]};if(de.expanded=J(pe,ae),de.lazy){const{loaded:ve=!1,loading:me=!1}=pe||{};de.loaded=!!ve,de.loading=!!me,Y.push(ae)}X[ae]=de});const re=Object.keys(H);i.value&&re.length&&Y.length&&re.forEach(ae=>{const pe=W[ae],de=H[ae].children;if(Y.includes(ae)){if(X[ae].children.length!==0)throw new Error("[ElTable]children must be an empty array.");X[ae].children=de}else{const{loaded:ve=!1,loading:me=!1}=pe||{};X[ae]={lazy:!0,loaded:!!ve,loading:!!me,expanded:J(pe,ae),children:de,level:""}}})}r.value=X,(z=o.store)==null||z.updateTableScrollY()};un(()=>e.value,()=>{y(!0)}),un(()=>d.value,()=>{y()}),un(()=>g.value,()=>{y()});const x=P=>{e.value=P,y()},A=(P,O)=>{o.store.assertRowKey();const z=t.rowKey.value,V=bo(P,z),H=V&&r.value[V];if(V&&H&&"expanded"in H){const $=H.expanded;O=typeof O>"u"?!H.expanded:O,r.value[V].expanded=O,$!==O&&o.emit("expand-change",P,O),o.store.updateTableScrollY()}},M=P=>{o.store.assertRowKey();const O=t.rowKey.value,z=bo(P,O),V=r.value[z];i.value&&V&&"loaded"in V&&!V.loaded?D(P,z,V):A(P,void 0)},D=(P,O,z)=>{const{load:V}=o.props;V&&!r.value[O].loaded&&(r.value[O].loading=!0,V(P,z,H=>{if(!Array.isArray(H))throw new TypeError("[ElTable] data must be an array");r.value[O].loading=!1,r.value[O].loaded=!0,r.value[O].expanded=!0,H.length&&(a.value[O]=H),o.emit("expand-change",P,!0)}))};return{loadData:D,loadOrToggle:M,toggleTreeExpansion:A,updateTreeExpandKeys:x,updateTreeData:y,normalize:m,states:{expandRowKeys:e,treeData:r,indent:n,lazy:i,lazyTreeNodeMap:a,lazyColumnIdentifier:l,childrenColumnName:c}}}const O_e=(t,e)=>{const r=e.sortingColumn;return!r||typeof r.sortable=="string"?t:A_e(t,e.sortProp,e.sortOrder,r.sortMethod,r.sortBy)},RA=t=>{const e=[];return t.forEach(r=>{r.children&&r.children.length>0?e.push.apply(e,RA(r.children)):e.push(r)}),e};function z_e(){var t;const e=Mi(),{size:r}=M3((t=e.proxy)==null?void 0:t.$props),n=at(null),i=at([]),a=at([]),l=at(!1),c=at([]),o=at([]),d=at([]),g=at([]),m=at([]),y=at([]),x=at([]),A=at([]),M=[],D=at(0),P=at(0),O=at(0),z=at(!1),V=at([]),H=at(!1),$=at(!1),X=at(null),W=at({}),Y=at(null),J=at(null),re=at(null),ae=at(null),pe=at(null);un(i,()=>e.state&&Ie(!1),{deep:!0});const de=()=>{if(!n.value)throw new Error("[ElTable] prop row-key is required")},ve=vt=>{var Ye;(Ye=vt.children)==null||Ye.forEach(Dt=>{Dt.fixed=vt.fixed,ve(Dt)})},me=()=>{c.value.forEach(jt=>{ve(jt)}),g.value=c.value.filter(jt=>jt.fixed===!0||jt.fixed==="left"),m.value=c.value.filter(jt=>jt.fixed==="right"),g.value.length>0&&c.value[0]&&c.value[0].type==="selection"&&!c.value[0].fixed&&(c.value[0].fixed=!0,g.value.unshift(c.value[0]));const vt=c.value.filter(jt=>!jt.fixed);o.value=[].concat(g.value).concat(vt).concat(m.value);const Ye=RA(vt),Dt=RA(g.value),Vt=RA(m.value);D.value=Ye.length,P.value=Dt.length,O.value=Vt.length,d.value=[].concat(Dt).concat(Ye).concat(Vt),l.value=g.value.length>0||m.value.length>0},Ie=(vt,Ye=!1)=>{vt&&me(),Ye?e.state.doLayout():e.state.debouncedUpdateLayout()},Le=vt=>V.value.includes(vt),Ee=()=>{z.value=!1;const vt=V.value;V.value=[],vt.length&&e.emit("selection-change",[])},Ue=()=>{let vt;if(n.value){vt=[];const Ye=Sg(V.value,n.value),Dt=Sg(i.value,n.value);for(const Vt in Ye)ni(Ye,Vt)&&!Dt[Vt]&&vt.push(Ye[Vt].row)}else vt=V.value.filter(Ye=>!i.value.includes(Ye));if(vt.length){const Ye=V.value.filter(Dt=>!vt.includes(Dt));V.value=Ye,e.emit("selection-change",Ye.slice())}},Ke=()=>(V.value||[]).slice(),We=(vt,Ye=void 0,Dt=!0)=>{if(o1(V.value,vt,Ye)){const jt=(V.value||[]).slice();Dt&&e.emit("select",jt,vt),e.emit("selection-change",jt)}},Rt=()=>{var vt,Ye;const Dt=$.value?!z.value:!(z.value||V.value.length);z.value=Dt;let Vt=!1,jt=0;const Yt=(Ye=(vt=e==null?void 0:e.store)==null?void 0:vt.states)==null?void 0:Ye.rowKey.value;i.value.forEach((Nr,Qr)=>{const xn=Qr+jt;X.value?X.value.call(null,Nr,xn)&&o1(V.value,Nr,Dt)&&(Vt=!0):o1(V.value,Nr,Dt)&&(Vt=!0),jt+=ur(bo(Nr,Yt))}),Vt&&e.emit("selection-change",V.value?V.value.slice():[]),e.emit("select-all",(V.value||[]).slice())},Et=()=>{const vt=Sg(V.value,n.value);i.value.forEach(Ye=>{const Dt=bo(Ye,n.value),Vt=vt[Dt];Vt&&(V.value[Vt.index]=Ye)})},ar=()=>{var vt,Ye,Dt;if(((vt=i.value)==null?void 0:vt.length)===0){z.value=!1;return}let Vt;n.value&&(Vt=Sg(V.value,n.value));const jt=function(xn){return Vt?!!Vt[bo(xn,n.value)]:V.value.includes(xn)};let Yt=!0,Nr=0,Qr=0;for(let xn=0,jn=(i.value||[]).length;xn<jn;xn++){const Wn=(Dt=(Ye=e==null?void 0:e.store)==null?void 0:Ye.states)==null?void 0:Dt.rowKey.value,ai=xn+Qr,Si=i.value[xn],pa=X.value&&X.value.call(null,Si,ai);if(jt(Si))Nr++;else if(!X.value||pa){Yt=!1;break}Qr+=ur(bo(Si,Wn))}Nr===0&&(Yt=!1),z.value=Yt},ur=vt=>{var Ye;if(!e||!e.store)return 0;const{treeData:Dt}=e.store.states;let Vt=0;const jt=(Ye=Dt.value[vt])==null?void 0:Ye.children;return jt&&(Vt+=jt.length,jt.forEach(Yt=>{Vt+=ur(Yt)})),Vt},cr=(vt,Ye)=>{Array.isArray(vt)||(vt=[vt]);const Dt={};return vt.forEach(Vt=>{W.value[Vt.id]=Ye,Dt[Vt.columnKey||Vt.id]=Ye}),Dt},lt=(vt,Ye,Dt)=>{J.value&&J.value!==vt&&(J.value.order=null),J.value=vt,re.value=Ye,ae.value=Dt},qt=()=>{let vt=Pe(a);Object.keys(W.value).forEach(Ye=>{const Dt=W.value[Ye];if(!Dt||Dt.length===0)return;const Vt=Lq({columns:d.value},Ye);Vt&&Vt.filterMethod&&(vt=vt.filter(jt=>Dt.some(Yt=>Vt.filterMethod.call(null,Yt,jt,Vt))))}),Y.value=vt},Ut=()=>{i.value=O_e(Y.value,{sortingColumn:J.value,sortProp:re.value,sortOrder:ae.value})},rr=(vt=void 0)=>{vt&&vt.filter||qt(),Ut()},br=vt=>{const{tableHeaderRef:Ye}=e.refs;if(!Ye)return;const Dt=Object.assign({},Ye.filterPanels),Vt=Object.keys(Dt);if(Vt.length)if(typeof vt=="string"&&(vt=[vt]),Array.isArray(vt)){const jt=vt.map(Yt=>C_e({columns:d.value},Yt));Vt.forEach(Yt=>{const Nr=jt.find(Qr=>Qr.id===Yt);Nr&&(Nr.filteredValue=[])}),e.store.commit("filterChange",{column:jt,values:[],silent:!0,multi:!0})}else Vt.forEach(jt=>{const Yt=d.value.find(Nr=>Nr.id===jt);Yt&&(Yt.filteredValue=[])}),W.value={},e.store.commit("filterChange",{column:{},values:[],silent:!0})},Oe=()=>{J.value&&(lt(null,null,null),e.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:$e,toggleRowExpansion:ct,updateExpandRows:bt,states:At,isRowExpanded:Jt}=L_e({data:i,rowKey:n}),{updateTreeExpandKeys:mt,toggleTreeExpansion:ht,updateTreeData:er,loadOrToggle:Bt,states:qe}=k_e({data:i,rowKey:n}),{updateCurrentRowData:ge,updateCurrentRow:be,setCurrentRowKey:ke,states:tt}=R_e({data:i,rowKey:n});return{assertRowKey:de,updateColumns:me,scheduleLayout:Ie,isSelected:Le,clearSelection:Ee,cleanSelection:Ue,getSelectionRows:Ke,toggleRowSelection:We,_toggleAllSelection:Rt,toggleAllSelection:null,updateSelectionByRowKey:Et,updateAllSelected:ar,updateFilters:cr,updateCurrentRow:be,updateSort:lt,execFilter:qt,execSort:Ut,execQuery:rr,clearFilter:br,clearSort:Oe,toggleRowExpansion:ct,setExpandRowKeysAdapter:vt=>{$e(vt),mt(vt)},setCurrentRowKey:ke,toggleRowExpansionAdapter:(vt,Ye)=>{d.value.some(({type:Vt})=>Vt==="expand")?ct(vt,Ye):ht(vt,Ye)},isRowExpanded:Jt,updateExpandRows:bt,updateCurrentRowData:ge,loadOrToggle:Bt,updateTreeData:er,states:{tableSize:r,rowKey:n,data:i,_data:a,isComplex:l,_columns:c,originColumns:o,columns:d,fixedColumns:g,rightFixedColumns:m,leafColumns:y,fixedLeafColumns:x,rightFixedLeafColumns:A,updateOrderFns:M,leafColumnsLength:D,fixedLeafColumnsLength:P,rightFixedLeafColumnsLength:O,isAllSelected:z,selection:V,reserveSelection:H,selectOnIndeterminate:$,selectable:X,filters:W,filteredData:Y,sortingColumn:J,sortProp:re,sortOrder:ae,hoverRow:pe,...At,...qe,...tt}}}function gk(t,e){return t.map(r=>{var n;return r.id===e.id?e:((n=r.children)!=null&&n.length&&(r.children=gk(r.children,e)),r)})}function vk(t){t.forEach(e=>{var r,n;e.no=(r=e.getColumnIndex)==null?void 0:r.call(e),(n=e.children)!=null&&n.length&&vk(e.children)}),t.sort((e,r)=>e.no-r.no)}function B_e(){const t=Mi(),e=z_e();return{ns:yn("table"),...e,mutations:{setData(l,c){const o=Pe(l._data)!==c;l.data.value=c,l._data.value=c,t.store.execQuery(),t.store.updateCurrentRowData(),t.store.updateExpandRows(),t.store.updateTreeData(t.store.states.defaultExpandAll.value),Pe(l.reserveSelection)?(t.store.assertRowKey(),t.store.updateSelectionByRowKey()):o?t.store.clearSelection():t.store.cleanSelection(),t.store.updateAllSelected(),t.$ready&&t.store.scheduleLayout()},insertColumn(l,c,o,d){const g=Pe(l._columns);let m=[];o?(o&&!o.children&&(o.children=[]),o.children.push(c),m=gk(g,o)):(g.push(c),m=g),vk(m),l._columns.value=m,l.updateOrderFns.push(d),c.type==="selection"&&(l.selectable.value=c.selectable,l.reserveSelection.value=c.reserveSelection),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},updateColumnOrder(l,c){var o;((o=c.getColumnIndex)==null?void 0:o.call(c))!==c.no&&(vk(l._columns.value),t.$ready&&t.store.updateColumns())},removeColumn(l,c,o,d){const g=Pe(l._columns)||[];if(o)o.children.splice(o.children.findIndex(y=>y.id===c.id),1),Fa(()=>{var y;((y=o.children)==null?void 0:y.length)===0&&delete o.children}),l._columns.value=gk(g,o);else{const y=g.indexOf(c);y>-1&&(g.splice(y,1),l._columns.value=g)}const m=l.updateOrderFns.indexOf(d);m>-1&&l.updateOrderFns.splice(m,1),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},sort(l,c){const{prop:o,order:d,init:g}=c;if(o){const m=Pe(l.columns).find(y=>y.property===o);m&&(m.order=d,t.store.updateSort(m,o,d),t.store.commit("changeSortCondition",{init:g}))}},changeSortCondition(l,c){const{sortingColumn:o,sortProp:d,sortOrder:g}=l,m=Pe(o),y=Pe(d),x=Pe(g);x===null&&(l.sortingColumn.value=null,l.sortProp.value=null);const A={filter:!0};t.store.execQuery(A),(!c||!(c.silent||c.init))&&t.emit("sort-change",{column:m,prop:y,order:x}),t.store.updateTableScrollY()},filterChange(l,c){const{column:o,values:d,silent:g}=c,m=t.store.updateFilters(o,d);t.store.execQuery(),g||t.emit("filter-change",m),t.store.updateTableScrollY()},toggleAllSelection(){t.store.toggleAllSelection()},rowSelectedChanged(l,c){t.store.toggleRowSelection(c),t.store.updateAllSelected()},setHoverRow(l,c){l.hoverRow.value=c},setCurrentRow(l,c){t.store.updateCurrentRow(c)}},commit:function(l,...c){const o=t.store.mutations;if(o[l])o[l].apply(t,[t.store.states].concat(c));else throw new Error(`Action not found: ${l}`)},updateTableScrollY:function(){Fa(()=>t.layout.updateScrollY.apply(t.layout))}}}const s1={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"}};function F_e(t,e){if(!t)throw new Error("Table is required.");const r=B_e();return r.toggleAllSelection=mC(r._toggleAllSelection,10),Object.keys(s1).forEach(n=>{zq(Bq(e,n),n,r)}),N_e(r,e),r}function N_e(t,e){Object.keys(s1).forEach(r=>{un(()=>Bq(e,r),n=>{zq(n,r,t)})})}function zq(t,e,r){let n=t,i=s1[e];typeof s1[e]=="object"&&(i=i.key,n=n||s1[e].default),r.states[i].value=n}function Bq(t,e){if(e.includes(".")){const r=e.split(".");let n=t;return r.forEach(i=>{n=n[i]}),n}else return t[e]}class V_e{constructor(e){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=at(null),this.scrollX=at(!1),this.scrollY=at(!1),this.bodyWidth=at(null),this.fixedWidth=at(null),this.rightFixedWidth=at(null),this.gutterWidth=0;for(const r in e)ni(e,r)&&(qi(this[r])?this[r].value=e[r]:this[r]=e[r]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const r=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(r!=null&&r.wrapRef)){let n=!0;const i=this.scrollY.value;return n=r.wrapRef.scrollHeight>r.wrapRef.clientHeight,this.scrollY.value=n,i!==n}return!1}setHeight(e,r="height"){if(!fa)return;const n=this.table.vnode.el;if(e=I_e(e),this.height.value=Number(e),!n&&(e||e===0))return Fa(()=>this.setHeight(e,r));typeof e=="number"?(n.style[r]=`${e}px`,this.updateElsHeight()):typeof e=="string"&&(n.style[r]=e,this.updateElsHeight())}setMaxHeight(e){this.setHeight(e,"max-height")}getFlattenColumns(){const e=[];return this.table.store.states.columns.value.forEach(n=>{n.isColumnGroup?e.push.apply(e,n.columns):e.push(n)}),e}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(e){if(!e)return!0;let r=e;for(;r.tagName!=="DIV";){if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}updateColumnsWidth(){if(!fa)return;const e=this.fit,r=this.table.vnode.el.clientWidth;let n=0;const i=this.getFlattenColumns(),a=i.filter(o=>typeof o.width!="number");if(i.forEach(o=>{typeof o.width=="number"&&o.realWidth&&(o.realWidth=null)}),a.length>0&&e){if(i.forEach(o=>{n+=Number(o.width||o.minWidth||80)}),n<=r){this.scrollX.value=!1;const o=r-n;if(a.length===1)a[0].realWidth=Number(a[0].minWidth||80)+o;else{const d=a.reduce((y,x)=>y+Number(x.minWidth||80),0),g=o/d;let m=0;a.forEach((y,x)=>{if(x===0)return;const A=Math.floor(Number(y.minWidth||80)*g);m+=A,y.realWidth=Number(y.minWidth||80)+A}),a[0].realWidth=Number(a[0].minWidth||80)+o-m}}else this.scrollX.value=!0,a.forEach(o=>{o.realWidth=Number(o.minWidth)});this.bodyWidth.value=Math.max(n,r),this.table.state.resizeState.value.width=this.bodyWidth.value}else i.forEach(o=>{!o.width&&!o.minWidth?o.realWidth=80:o.realWidth=Number(o.width||o.minWidth),n+=o.realWidth}),this.scrollX.value=n>r,this.bodyWidth.value=n;const l=this.store.states.fixedColumns.value;if(l.length>0){let o=0;l.forEach(d=>{o+=Number(d.realWidth||d.width)}),this.fixedWidth.value=o}const c=this.store.states.rightFixedColumns.value;if(c.length>0){let o=0;c.forEach(d=>{o+=Number(d.realWidth||d.width)}),this.rightFixedWidth.value=o}this.notifyObservers("columns")}addObserver(e){this.observers.push(e)}removeObserver(e){const r=this.observers.indexOf(e);r!==-1&&this.observers.splice(r,1)}notifyObservers(e){this.observers.forEach(n=>{var i,a;switch(e){case"columns":(i=n.state)==null||i.onColumnsChange(this);break;case"scrollable":(a=n.state)==null||a.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${e}.`)}})}}const{CheckboxGroup:G_e}=N_,U_e=Mr({name:"ElTableFilterPanel",components:{ElCheckbox:N_,ElCheckboxGroup:G_e,ElScrollbar:ZM,ElTooltip:YM,ElIcon:As,ArrowDown:CZ,ArrowUp:Afe},directives:{ClickOutside:cq},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function}},setup(t){const e=Mi(),{t:r}=$M(),n=yn("table-filter"),i=e==null?void 0:e.parent;i.filterPanels.value[t.column.id]||(i.filterPanels.value[t.column.id]=e);const a=at(!1),l=at(null),c=gt(()=>t.column&&t.column.filters),o=gt(()=>t.column.filterClassName?`${n.b()} ${t.column.filterClassName}`:n.b()),d=gt({get:()=>{var H;return(((H=t.column)==null?void 0:H.filteredValue)||[])[0]},set:H=>{g.value&&(typeof H<"u"&&H!==null?g.value.splice(0,1,H):g.value.splice(0,1))}}),g=gt({get(){return t.column?t.column.filteredValue||[]:[]},set(H){t.column&&t.upDataColumn("filteredValue",H)}}),m=gt(()=>t.column?t.column.filterMultiple:!0),y=H=>H.value===d.value,x=()=>{a.value=!1},A=H=>{H.stopPropagation(),a.value=!a.value},M=()=>{a.value=!1},D=()=>{z(g.value),x()},P=()=>{g.value=[],z(g.value),x()},O=H=>{d.value=H,z(typeof H<"u"&&H!==null?g.value:[]),x()},z=H=>{t.store.commit("filterChange",{column:t.column,values:H}),t.store.updateAllSelected()};un(a,H=>{t.column&&t.upDataColumn("filterOpened",H)},{immediate:!0});const V=gt(()=>{var H,$;return($=(H=l.value)==null?void 0:H.popperRef)==null?void 0:$.contentRef});return{tooltipVisible:a,multiple:m,filterClassName:o,filteredValue:g,filterValue:d,filters:c,handleConfirm:D,handleReset:P,handleSelect:O,isActive:y,t:r,ns:n,showFilterPanel:A,hideFilterPanel:M,popperPaneRef:V,tooltip:l}}}),$_e={key:0},H_e=["disabled"],j_e=["label","onClick"];function W_e(t,e,r,n,i,a){const l=Zs("el-checkbox"),c=Zs("el-checkbox-group"),o=Zs("el-scrollbar"),d=Zs("arrow-up"),g=Zs("arrow-down"),m=Zs("el-icon"),y=Zs("el-tooltip"),x=d7("click-outside");return Nt(),kr(y,{ref:"tooltip",visible:t.tooltipVisible,offset:0,placement:t.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":t.filterClassName,persistent:""},{content:pt(()=>[t.multiple?(Nt(),Gr("div",$_e,[wt("div",{class:Lr(t.ns.e("content"))},[He(o,{"wrap-class":t.ns.e("wrap")},{default:pt(()=>[He(c,{modelValue:t.filteredValue,"onUpdate:modelValue":e[0]||(e[0]=A=>t.filteredValue=A),class:Lr(t.ns.e("checkbox-group"))},{default:pt(()=>[(Nt(!0),Gr(ha,null,cV(t.filters,A=>(Nt(),kr(l,{key:A.value,value:A.value},{default:pt(()=>[ji(_n(A.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["wrap-class"])],2),wt("div",{class:Lr(t.ns.e("bottom"))},[wt("button",{class:Lr({[t.ns.is("disabled")]:t.filteredValue.length===0}),disabled:t.filteredValue.length===0,type:"button",onClick:e[1]||(e[1]=(...A)=>t.handleConfirm&&t.handleConfirm(...A))},_n(t.t("el.table.confirmFilter")),11,H_e),wt("button",{type:"button",onClick:e[2]||(e[2]=(...A)=>t.handleReset&&t.handleReset(...A))},_n(t.t("el.table.resetFilter")),1)],2)])):(Nt(),Gr("ul",{key:1,class:Lr(t.ns.e("list"))},[wt("li",{class:Lr([t.ns.e("list-item"),{[t.ns.is("active")]:t.filterValue===void 0||t.filterValue===null}]),onClick:e[3]||(e[3]=A=>t.handleSelect(null))},_n(t.t("el.table.clearFilter")),3),(Nt(!0),Gr(ha,null,cV(t.filters,A=>(Nt(),Gr("li",{key:A.value,class:Lr([t.ns.e("list-item"),t.ns.is("active",t.isActive(A))]),label:A.value,onClick:M=>t.handleSelect(A.value)},_n(A.text),11,j_e))),128))],2))]),default:pt(()=>[es((Nt(),Gr("span",{class:Lr([`${t.ns.namespace.value}-table__column-filter-trigger`,`${t.ns.namespace.value}-none-outline`]),onClick:e[4]||(e[4]=(...A)=>t.showFilterPanel&&t.showFilterPanel(...A))},[He(m,null,{default:pt(()=>[t.column.filterOpened?(Nt(),kr(d,{key:0})):(Nt(),kr(g,{key:1}))]),_:1})],2)),[[x,t.hideFilterPanel,t.popperPaneRef]])]),_:1},8,["visible","placement","popper-class"])}var Z_e=_i(U_e,[["render",W_e],["__file","filter-panel.vue"]]);function Fq(t){const e=Mi();MM(()=>{r.value.addObserver(e)}),Vn(()=>{n(r.value),i(r.value)}),IM(()=>{n(r.value),i(r.value)}),Td(()=>{r.value.removeObserver(e)});const r=gt(()=>{const a=t.layout;if(!a)throw new Error("Can not find table layout.");return a}),n=a=>{var l;const c=((l=t.vnode.el)==null?void 0:l.querySelectorAll("colgroup > col"))||[];if(!c.length)return;const o=a.getFlattenColumns(),d={};o.forEach(g=>{d[g.id]=g});for(let g=0,m=c.length;g<m;g++){const y=c[g],x=y.getAttribute("name"),A=d[x];A&&y.setAttribute("width",A.realWidth||A.width)}},i=a=>{var l,c;const o=((l=t.vnode.el)==null?void 0:l.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let g=0,m=o.length;g<m;g++)o[g].setAttribute("width",a.scrollY.value?a.gutterWidth:"0");const d=((c=t.vnode.el)==null?void 0:c.querySelectorAll("th.gutter"))||[];for(let g=0,m=d.length;g<m;g++){const y=d[g];y.style.width=a.scrollY.value?`${a.gutterWidth}px`:"0",y.style.display=a.scrollY.value?"":"none"}};return{tableLayout:r.value,onColumnsChange:n,onScrollableChange:i}}const vc=Symbol("ElTable");function q_e(t,e){const r=Mi(),n=Mn(vc),i=M=>{M.stopPropagation()},a=(M,D)=>{!D.filters&&D.sortable?A(M,D,!1):D.filterable&&!D.sortable&&i(M),n==null||n.emit("header-click",D,M)},l=(M,D)=>{n==null||n.emit("header-contextmenu",D,M)},c=at(null),o=at(!1),d=at({}),g=(M,D)=>{if(fa&&!(D.children&&D.children.length>0)&&c.value&&t.border){o.value=!0;const P=n;e("set-drag-visible",!0);const z=(P==null?void 0:P.vnode.el).getBoundingClientRect().left,V=r.vnode.el.querySelector(`th.${D.id}`),H=V.getBoundingClientRect(),$=H.left-z+30;eh(V,"noclick"),d.value={startMouseLeft:M.clientX,startLeft:H.right-z,startColumnLeft:H.left-z,tableLeft:z};const X=P==null?void 0:P.refs.resizeProxy;X.style.left=`${d.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const W=J=>{const re=J.clientX-d.value.startMouseLeft,ae=d.value.startLeft+re;X.style.left=`${Math.max($,ae)}px`},Y=()=>{if(o.value){const{startColumnLeft:J,startLeft:re}=d.value,pe=Number.parseInt(X.style.left,10)-J;D.width=D.realWidth=pe,P==null||P.emit("header-dragend",D.width,re-J,D,M),requestAnimationFrame(()=>{t.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",o.value=!1,c.value=null,d.value={},e("set-drag-visible",!1)}document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",Y),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{ih(V,"noclick")},0)};document.addEventListener("mousemove",W),document.addEventListener("mouseup",Y)}},m=(M,D)=>{if(D.children&&D.children.length>0)return;const P=M.target;if(!L_(P))return;const O=P==null?void 0:P.closest("th");if(!(!D||!D.resizable)&&!o.value&&t.border){const z=O.getBoundingClientRect(),V=document.body.style;z.width>12&&z.right-M.pageX<8?(V.cursor="col-resize",Og(O,"is-sortable")&&(O.style.cursor="col-resize"),c.value=D):o.value||(V.cursor="",Og(O,"is-sortable")&&(O.style.cursor="pointer"),c.value=null)}},y=()=>{fa&&(document.body.style.cursor="")},x=({order:M,sortOrders:D})=>{if(M==="")return D[0];const P=D.indexOf(M||null);return D[P>D.length-2?0:P+1]},A=(M,D,P)=>{var O;M.stopPropagation();const z=D.order===P?null:P||x(D),V=(O=M.target)==null?void 0:O.closest("th");if(V&&Og(V,"noclick")){ih(V,"noclick");return}if(!D.sortable)return;const H=t.store.states;let $=H.sortProp.value,X;const W=H.sortingColumn.value;(W!==D||W===D&&W.order===null)&&(W&&(W.order=null),H.sortingColumn.value=D,$=D.property),z?X=D.order=z:X=D.order=null,H.sortProp.value=$,H.sortOrder.value=X,n==null||n.store.commit("changeSortCondition")};return{handleHeaderClick:a,handleHeaderContextMenu:l,handleMouseDown:g,handleMouseMove:m,handleMouseOut:y,handleSortClick:A,handleFilterClick:i}}function Y_e(t){const e=Mn(vc),r=yn("table");return{getHeaderRowStyle:c=>{const o=e==null?void 0:e.props.headerRowStyle;return typeof o=="function"?o.call(null,{rowIndex:c}):o},getHeaderRowClass:c=>{const o=[],d=e==null?void 0:e.props.headerRowClassName;return typeof d=="string"?o.push(d):typeof d=="function"&&o.push(d.call(null,{rowIndex:c})),o.join(" ")},getHeaderCellStyle:(c,o,d,g)=>{var m;let y=(m=e==null?void 0:e.props.headerCellStyle)!=null?m:{};typeof y=="function"&&(y=y.call(null,{rowIndex:c,columnIndex:o,row:d,column:g}));const x=pz(o,g.fixed,t.store,d);return V_(x,"left"),V_(x,"right"),Object.assign({},y,x)},getHeaderCellClass:(c,o,d,g)=>{const m=dz(r.b(),o,g.fixed,t.store,d),y=[g.id,g.order,g.headerAlign,g.className,g.labelClassName,...m];g.children||y.push("is-leaf"),g.sortable&&y.push("is-sortable");const x=e==null?void 0:e.props.headerCellClassName;return typeof x=="string"?y.push(x):typeof x=="function"&&y.push(x.call(null,{rowIndex:c,columnIndex:o,row:d,column:g})),y.push(r.e("cell")),y.filter(A=>!!A).join(" ")}}}const Nq=t=>{const e=[];return t.forEach(r=>{r.children?(e.push(r),e.push.apply(e,Nq(r.children))):e.push(r)}),e},Vq=t=>{let e=1;const r=(a,l)=>{if(l&&(a.level=l.level+1,e<a.level&&(e=a.level)),a.children){let c=0;a.children.forEach(o=>{r(o,a),c+=o.colSpan}),a.colSpan=c}else a.colSpan=1};t.forEach(a=>{a.level=1,r(a,void 0)});const n=[];for(let a=0;a<e;a++)n.push([]);return Nq(t).forEach(a=>{a.children?(a.rowSpan=1,a.children.forEach(l=>l.isSubColumn=!0)):a.rowSpan=e-a.level+1,n[a.level-1].push(a)}),n};function X_e(t){const e=Mn(vc),r=gt(()=>Vq(t.store.states.originColumns.value));return{isGroup:gt(()=>{const a=r.value.length>1;return a&&e&&(e.state.isGroup.value=!0),a}),toggleAllSelection:a=>{a.stopPropagation(),e==null||e.store.commit("toggleAllSelection")},columnRows:r}}var Q_e=Mr({name:"ElTableHeader",components:{ElCheckbox:N_},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t,{emit:e}){const r=Mi(),n=Mn(vc),i=yn("table"),a=at({}),{onColumnsChange:l,onScrollableChange:c}=Fq(n);Vn(async()=>{await Fa(),await Fa();const{prop:$,order:X}=t.defaultSort;n==null||n.store.commit("sort",{prop:$,order:X,init:!0})});const{handleHeaderClick:o,handleHeaderContextMenu:d,handleMouseDown:g,handleMouseMove:m,handleMouseOut:y,handleSortClick:x,handleFilterClick:A}=q_e(t,e),{getHeaderRowStyle:M,getHeaderRowClass:D,getHeaderCellStyle:P,getHeaderCellClass:O}=Y_e(t),{isGroup:z,toggleAllSelection:V,columnRows:H}=X_e(t);return r.state={onColumnsChange:l,onScrollableChange:c},r.filterPanels=a,{ns:i,filterPanels:a,onColumnsChange:l,onScrollableChange:c,columnRows:H,getHeaderRowClass:D,getHeaderRowStyle:M,getHeaderCellClass:O,getHeaderCellStyle:P,handleHeaderClick:o,handleHeaderContextMenu:d,handleMouseDown:g,handleMouseMove:m,handleMouseOut:y,handleSortClick:x,handleFilterClick:A,isGroup:z,toggleAllSelection:V}},render(){const{ns:t,isGroup:e,columnRows:r,getHeaderCellStyle:n,getHeaderCellClass:i,getHeaderRowClass:a,getHeaderRowStyle:l,handleHeaderClick:c,handleHeaderContextMenu:o,handleMouseDown:d,handleMouseMove:g,handleSortClick:m,handleMouseOut:y,store:x,$parent:A}=this;let M=1;return ln("thead",{class:{[t.is("group")]:e}},r.map((D,P)=>ln("tr",{class:a(P),key:P,style:l(P)},D.map((O,z)=>(O.rowSpan>M&&(M=O.rowSpan),ln("th",{class:i(P,z,D,O),colspan:O.colSpan,key:`${O.id}-thead`,rowspan:O.rowSpan,style:n(P,z,D,O),onClick:V=>{V.currentTarget.classList.contains("noclick")||c(V,O)},onContextmenu:V=>o(V,O),onMousedown:V=>d(V,O),onMousemove:V=>g(V,O),onMouseout:y},[ln("div",{class:["cell",O.filteredValue&&O.filteredValue.length>0?"highlight":""]},[O.renderHeader?O.renderHeader({column:O,$index:z,store:x,_self:A}):O.label,O.sortable&&ln("span",{onClick:V=>m(V,O),class:"caret-wrapper"},[ln("i",{onClick:V=>m(V,O,"ascending"),class:"sort-caret ascending"}),ln("i",{onClick:V=>m(V,O,"descending"),class:"sort-caret descending"})]),O.filterable&&ln(Z_e,{store:x,placement:O.filterPlacement||"bottom-start",column:O,upDataColumn:(V,H)=>{O[V]=H}})])]))))))}});function sP(t,e,r=.01){return t-e>r}function K_e(t){const e=Mn(vc),r=at(""),n=at(ln("div")),i=(A,M,D)=>{var P;const O=e,z=oP(A);let V;const H=(P=O==null?void 0:O.vnode.el)==null?void 0:P.dataset.prefix;z&&(V=hG({columns:t.store.states.columns.value},z,H),V&&(O==null||O.emit(`cell-${D}`,M,V,z,A))),O==null||O.emit(`row-${D}`,M,V,A)},a=(A,M)=>{i(A,M,"dblclick")},l=(A,M)=>{t.store.commit("setCurrentRow",M),i(A,M,"click")},c=(A,M)=>{i(A,M,"contextmenu")},o=mC(A=>{t.store.commit("setHoverRow",A)},30),d=mC(()=>{t.store.commit("setHoverRow",null)},30),g=A=>{const M=window.getComputedStyle(A,null),D=Number.parseInt(M.paddingLeft,10)||0,P=Number.parseInt(M.paddingRight,10)||0,O=Number.parseInt(M.paddingTop,10)||0,z=Number.parseInt(M.paddingBottom,10)||0;return{left:D,right:P,top:O,bottom:z}},m=(A,M,D)=>{let P=M.target.parentNode;for(;A>1&&(P=P==null?void 0:P.nextSibling,!(!P||P.nodeName!=="TR"));)D(P,"hover-row hover-fixed-row"),A--};return{handleDoubleClick:a,handleClick:l,handleContextMenu:c,handleMouseEnter:o,handleMouseLeave:d,handleCellMouseEnter:(A,M,D)=>{var P;const O=e,z=oP(A),V=(P=O==null?void 0:O.vnode.el)==null?void 0:P.dataset.prefix;if(z){const Ee=hG({columns:t.store.states.columns.value},z,V);z.rowSpan>1&&m(z.rowSpan,A,eh);const Ue=O.hoverState={cell:z,column:Ee,row:M};O==null||O.emit("cell-mouse-enter",Ue.row,Ue.column,Ue.cell,A)}if(!D)return;const H=A.target.querySelector(".cell");if(!(Og(H,`${V}-tooltip`)&&H.childNodes.length))return;const $=document.createRange();$.setStart(H,0),$.setEnd(H,H.childNodes.length);let{width:X,height:W}=$.getBoundingClientRect();const Y=X-Math.floor(X),{width:J,height:re}=H.getBoundingClientRect();Y<.001&&(X=Math.floor(X)),W-Math.floor(W)<.001&&(W=Math.floor(W));const{top:pe,left:de,right:ve,bottom:me}=g(H),Ie=de+ve,Le=pe+me;(sP(X+Ie,J)||sP(W+Le,re)||sP(H.scrollWidth,J))&&P_e(D,z.innerText||z.textContent,z,O)},handleCellMouseLeave:A=>{const M=oP(A);if(!M)return;M.rowSpan>1&&m(M.rowSpan,A,ih);const D=e==null?void 0:e.hoverState;e==null||e.emit("cell-mouse-leave",D==null?void 0:D.row,D==null?void 0:D.column,D==null?void 0:D.cell,A)},tooltipContent:r,tooltipTrigger:n}}function J_e(t){const e=Mn(vc),r=yn("table");return{getRowStyle:(d,g)=>{const m=e==null?void 0:e.props.rowStyle;return typeof m=="function"?m.call(null,{row:d,rowIndex:g}):m||null},getRowClass:(d,g)=>{const m=[r.e("row")];e!=null&&e.props.highlightCurrentRow&&d===t.store.states.currentRow.value&&m.push("current-row"),t.stripe&&g%2===1&&m.push(r.em("row","striped"));const y=e==null?void 0:e.props.rowClassName;return typeof y=="string"?m.push(y):typeof y=="function"&&m.push(y.call(null,{row:d,rowIndex:g})),m},getCellStyle:(d,g,m,y)=>{const x=e==null?void 0:e.props.cellStyle;let A=x??{};typeof x=="function"&&(A=x.call(null,{rowIndex:d,columnIndex:g,row:m,column:y}));const M=pz(g,t==null?void 0:t.fixed,t.store);return V_(M,"left"),V_(M,"right"),Object.assign({},A,M)},getCellClass:(d,g,m,y,x)=>{const A=dz(r.b(),g,t==null?void 0:t.fixed,t.store,void 0,x),M=[y.id,y.align,y.className,...A],D=e==null?void 0:e.props.cellClassName;return typeof D=="string"?M.push(D):typeof D=="function"&&M.push(D.call(null,{rowIndex:d,columnIndex:g,row:m,column:y})),M.push(r.e("cell")),M.filter(P=>!!P).join(" ")},getSpan:(d,g,m,y)=>{let x=1,A=1;const M=e==null?void 0:e.props.spanMethod;if(typeof M=="function"){const D=M({row:d,column:g,rowIndex:m,columnIndex:y});Array.isArray(D)?(x=D[0],A=D[1]):typeof D=="object"&&(x=D.rowspan,A=D.colspan)}return{rowspan:x,colspan:A}},getColspanRealWidth:(d,g,m)=>{if(g<1)return d[m].realWidth;const y=d.map(({realWidth:x,width:A})=>x||A).slice(m,m+g);return Number(y.reduce((x,A)=>Number(x)+Number(A),-1))}}}function eye(t){const e=Mn(vc),r=yn("table"),{handleDoubleClick:n,handleClick:i,handleContextMenu:a,handleMouseEnter:l,handleMouseLeave:c,handleCellMouseEnter:o,handleCellMouseLeave:d,tooltipContent:g,tooltipTrigger:m}=K_e(t),{getRowStyle:y,getRowClass:x,getCellStyle:A,getCellClass:M,getSpan:D,getColspanRealWidth:P}=J_e(t),O=gt(()=>t.store.states.columns.value.findIndex(({type:X})=>X==="default")),z=(X,W)=>{const Y=e.props.rowKey;return Y?bo(X,Y):W},V=(X,W,Y,J=!1)=>{const{tooltipEffect:re,tooltipOptions:ae,store:pe}=t,{indent:de,columns:ve}=pe.states,me=x(X,W);let Ie=!0;return Y&&(me.push(r.em("row",`level-${Y.level}`)),Ie=Y.display),ln("tr",{style:[Ie?null:{display:"none"},y(X,W)],class:me,key:z(X,W),onDblclick:Ee=>n(Ee,X),onClick:Ee=>i(Ee,X),onContextmenu:Ee=>a(Ee,X),onMouseenter:()=>l(W),onMouseleave:c},ve.value.map((Ee,Ue)=>{const{rowspan:Ke,colspan:We}=D(X,Ee,W,Ue);if(!Ke||!We)return null;const Rt=Object.assign({},Ee);Rt.realWidth=P(ve.value,We,Ue);const Et={store:t.store,_self:t.context||e,column:Rt,row:X,$index:W,cellIndex:Ue,expanded:J};Ue===O.value&&Y&&(Et.treeNode={indent:Y.level*de.value,level:Y.level},typeof Y.expanded=="boolean"&&(Et.treeNode.expanded=Y.expanded,"loading"in Y&&(Et.treeNode.loading=Y.loading),"noLazyChildren"in Y&&(Et.treeNode.noLazyChildren=Y.noLazyChildren)));const ar=`${z(X,W)},${Ue}`,ur=Rt.columnKey||Rt.rawColumnKey||"",cr=H(Ue,Ee,Et),lt=Ee.showOverflowTooltip&&cfe({effect:re},ae,Ee.showOverflowTooltip);return ln("td",{style:A(W,Ue,X,Ee),class:M(W,Ue,X,Ee,We-1),key:`${ur}${ar}`,rowspan:Ke,colspan:We,onMouseenter:qt=>o(qt,X,lt),onMouseleave:d},[cr])}))},H=(X,W,Y)=>W.renderCell(Y);return{wrappedRowRender:(X,W)=>{const Y=t.store,{isRowExpanded:J,assertRowKey:re}=Y,{treeData:ae,lazyTreeNodeMap:pe,childrenColumnName:de,rowKey:ve}=Y.states,me=Y.states.columns.value;if(me.some(({type:Le})=>Le==="expand")){const Le=J(X),Ee=V(X,W,void 0,Le),Ue=e.renderExpanded;return Le?Ue?[[Ee,ln("tr",{key:`expanded-row__${Ee.key}`},[ln("td",{colspan:me.length,class:`${r.e("cell")} ${r.e("expanded-cell")}`},[Ue({row:X,$index:W,store:Y,expanded:Le})])])]]:(console.error("[Element Error]renderExpanded is required."),Ee):[[Ee]]}else if(Object.keys(ae.value).length){re();const Le=bo(X,ve.value);let Ee=ae.value[Le],Ue=null;Ee&&(Ue={expanded:Ee.expanded,level:Ee.level,display:!0},typeof Ee.lazy=="boolean"&&(typeof Ee.loaded=="boolean"&&Ee.loaded&&(Ue.noLazyChildren=!(Ee.children&&Ee.children.length)),Ue.loading=Ee.loading));const Ke=[V(X,W,Ue)];if(Ee){let We=0;const Rt=(ar,ur)=>{ar&&ar.length&&ur&&ar.forEach(cr=>{const lt={display:ur.display&&ur.expanded,level:ur.level+1,expanded:!1,noLazyChildren:!1,loading:!1},qt=bo(cr,ve.value);if(qt==null)throw new Error("For nested data item, row-key is required.");if(Ee={...ae.value[qt]},Ee&&(lt.expanded=Ee.expanded,Ee.level=Ee.level||lt.level,Ee.display=!!(Ee.expanded&&lt.display),typeof Ee.lazy=="boolean"&&(typeof Ee.loaded=="boolean"&&Ee.loaded&&(lt.noLazyChildren=!(Ee.children&&Ee.children.length)),lt.loading=Ee.loading)),We++,Ke.push(V(cr,W+We,lt)),Ee){const Ut=pe.value[qt]||cr[de.value];Rt(Ut,Ee)}})};Ee.display=!0;const Et=pe.value[Le]||X[de.value];Rt(Et,Ee)}return Ke}else return V(X,W,void 0)},tooltipContent:g,tooltipTrigger:m}}const tye={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var rye=Mr({name:"ElTableBody",props:tye,setup(t){const e=Mi(),r=Mn(vc),n=yn("table"),{wrappedRowRender:i,tooltipContent:a,tooltipTrigger:l}=eye(t),{onColumnsChange:c,onScrollableChange:o}=Fq(r),d=[];return un(t.store.states.hoverRow,(g,m)=>{var y;const x=e==null?void 0:e.vnode.el,A=Array.from((x==null?void 0:x.children)||[]).filter(P=>P==null?void 0:P.classList.contains(`${n.e("row")}`));let M=g;const D=(y=A[M])==null?void 0:y.childNodes;if(D!=null&&D.length){let P=0;Array.from(D).reduce((z,V,H)=>{var $,X;return(($=D[H])==null?void 0:$.colSpan)>1&&(P=(X=D[H])==null?void 0:X.colSpan),V.nodeName!=="TD"&&P===0&&z.push(H),P>0&&P--,z},[]).forEach(z=>{var V;for(M=g;M>0;){const H=(V=A[M-1])==null?void 0:V.childNodes;if(H[z]&&H[z].nodeName==="TD"&&H[z].rowSpan>1){eh(H[z],"hover-cell"),d.push(H[z]);break}M--}})}else d.forEach(P=>ih(P,"hover-cell")),d.length=0;!t.store.states.isComplex.value||!fa||gfe(()=>{const P=A[m],O=A[g];P&&!P.classList.contains("hover-fixed-row")&&ih(P,"hover-row"),O&&eh(O,"hover-row")})}),Td(()=>{var g;(g=_l)==null||g()}),{ns:n,onColumnsChange:c,onScrollableChange:o,wrappedRowRender:i,tooltipContent:a,tooltipTrigger:l}},render(){const{wrappedRowRender:t,store:e}=this,r=e.states.data.value||[];return ln("tbody",{tabIndex:-1},[r.reduce((n,i)=>n.concat(t(i,n.length)),[])])}});function nye(){const t=Mn(vc),e=t==null?void 0:t.store,r=gt(()=>e.states.fixedLeafColumnsLength.value),n=gt(()=>e.states.rightFixedColumns.value.length),i=gt(()=>e.states.columns.value.length),a=gt(()=>e.states.fixedColumns.value.length),l=gt(()=>e.states.rightFixedColumns.value.length);return{leftFixedLeafCount:r,rightFixedLeafCount:n,columnsCount:i,leftFixedCount:a,rightFixedCount:l,columns:e.states.columns}}function iye(t){const{columns:e}=nye(),r=yn("table");return{getCellClasses:(a,l)=>{const c=a[l],o=[r.e("cell"),c.id,c.align,c.labelClassName,...dz(r.b(),l,c.fixed,t.store)];return c.className&&o.push(c.className),c.children||o.push(r.is("leaf")),o},getCellStyles:(a,l)=>{const c=pz(l,a.fixed,t.store);return V_(c,"left"),V_(c,"right"),c},columns:e}}var aye=Mr({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t){const{getCellClasses:e,getCellStyles:r,columns:n}=iye(t);return{ns:yn("table"),getCellClasses:e,getCellStyles:r,columns:n}},render(){const{columns:t,getCellStyles:e,getCellClasses:r,summaryMethod:n,sumText:i}=this,a=this.store.states.data.value;let l=[];return n?l=n({columns:t,data:a}):t.forEach((c,o)=>{if(o===0){l[o]=i;return}const d=a.map(x=>Number(x[c.property])),g=[];let m=!0;d.forEach(x=>{if(!Number.isNaN(+x)){m=!1;const A=`${x}`.split(".")[1];g.push(A?A.length:0)}});const y=Math.max.apply(null,g);m?l[o]="":l[o]=d.reduce((x,A)=>{const M=Number(A);return Number.isNaN(+M)?x:Number.parseFloat((x+A).toFixed(Math.min(y,20)))},0)}),ln(ln("tfoot",[ln("tr",{},[...t.map((c,o)=>ln("td",{key:o,colspan:c.colSpan,rowspan:c.rowSpan,class:r(t,o),style:e(c,o)},[ln("div",{class:["cell",c.labelClassName]},[l[o]])]))])]))}});function oye(t){return{setCurrentRow:g=>{t.commit("setCurrentRow",g)},getSelectionRows:()=>t.getSelectionRows(),toggleRowSelection:(g,m)=>{t.toggleRowSelection(g,m,!1),t.updateAllSelected()},clearSelection:()=>{t.clearSelection()},clearFilter:g=>{t.clearFilter(g)},toggleAllSelection:()=>{t.commit("toggleAllSelection")},toggleRowExpansion:(g,m)=>{t.toggleRowExpansionAdapter(g,m)},clearSort:()=>{t.clearSort()},sort:(g,m)=>{t.commit("sort",{prop:g,order:m})}}}function sye(t,e,r,n){const i=at(!1),a=at(null),l=at(!1),c=Ee=>{l.value=Ee},o=at({width:null,height:null,headerHeight:null}),d=at(!1),g={display:"inline-block",verticalAlign:"middle"},m=at(),y=at(0),x=at(0),A=at(0),M=at(0),D=at(0);kg(()=>{e.setHeight(t.height)}),kg(()=>{e.setMaxHeight(t.maxHeight)}),un(()=>[t.currentRowKey,r.states.rowKey],([Ee,Ue])=>{!Pe(Ue)||!Pe(Ee)||r.setCurrentRowKey(`${Ee}`)},{immediate:!0}),un(()=>t.data,Ee=>{n.store.commit("setData",Ee)},{immediate:!0,deep:!0}),kg(()=>{t.expandRowKeys&&r.setExpandRowKeysAdapter(t.expandRowKeys)});const P=()=>{n.store.commit("setHoverRow",null),n.hoverState&&(n.hoverState=null)},O=(Ee,Ue)=>{const{pixelX:Ke,pixelY:We}=Ue;Math.abs(Ke)>=Math.abs(We)&&(n.refs.bodyWrapper.scrollLeft+=Ue.pixelX/5)},z=gt(()=>t.height||t.maxHeight||r.states.fixedColumns.value.length>0||r.states.rightFixedColumns.value.length>0),V=gt(()=>({width:e.bodyWidth.value?`${e.bodyWidth.value}px`:""})),H=()=>{z.value&&e.updateElsHeight(),e.updateColumnsWidth(),requestAnimationFrame(Y)};Vn(async()=>{await Fa(),r.updateColumns(),J(),requestAnimationFrame(H);const Ee=n.vnode.el,Ue=n.refs.headerWrapper;t.flexible&&Ee&&Ee.parentElement&&(Ee.parentElement.style.minWidth="0"),o.value={width:m.value=Ee.offsetWidth,height:Ee.offsetHeight,headerHeight:t.showHeader&&Ue?Ue.offsetHeight:null},r.states.columns.value.forEach(Ke=>{Ke.filteredValue&&Ke.filteredValue.length&&n.store.commit("filterChange",{column:Ke,values:Ke.filteredValue,silent:!0})}),n.$ready=!0});const $=(Ee,Ue)=>{if(!Ee)return;const Ke=Array.from(Ee.classList).filter(We=>!We.startsWith("is-scrolling-"));Ke.push(e.scrollX.value?Ue:"is-scrolling-none"),Ee.className=Ke.join(" ")},X=Ee=>{const{tableWrapper:Ue}=n.refs;$(Ue,Ee)},W=Ee=>{const{tableWrapper:Ue}=n.refs;return!!(Ue&&Ue.classList.contains(Ee))},Y=function(){if(!n.refs.scrollBarRef)return;if(!e.scrollX.value){const ur="is-scrolling-none";W(ur)||X(ur);return}const Ee=n.refs.scrollBarRef.wrapRef;if(!Ee)return;const{scrollLeft:Ue,offsetWidth:Ke,scrollWidth:We}=Ee,{headerWrapper:Rt,footerWrapper:Et}=n.refs;Rt&&(Rt.scrollLeft=Ue),Et&&(Et.scrollLeft=Ue);const ar=We-Ke-1;Ue>=ar?X("is-scrolling-right"):X(Ue===0?"is-scrolling-left":"is-scrolling-middle")},J=()=>{n.refs.scrollBarRef&&(n.refs.scrollBarRef.wrapRef&&pu(n.refs.scrollBarRef.wrapRef,"scroll",Y,{passive:!0}),t.fit?D_(n.vnode.el,re):pu(window,"resize",re),D_(n.refs.bodyWrapper,()=>{var Ee,Ue;re(),(Ue=(Ee=n.refs)==null?void 0:Ee.scrollBarRef)==null||Ue.update()}))},re=()=>{var Ee,Ue,Ke,We;const Rt=n.vnode.el;if(!n.$ready||!Rt)return;let Et=!1;const{width:ar,height:ur,headerHeight:cr}=o.value,lt=m.value=Rt.offsetWidth;ar!==lt&&(Et=!0);const qt=Rt.offsetHeight;(t.height||z.value)&&ur!==qt&&(Et=!0);const Ut=t.tableLayout==="fixed"?n.refs.headerWrapper:(Ee=n.refs.tableHeaderRef)==null?void 0:Ee.$el;t.showHeader&&(Ut==null?void 0:Ut.offsetHeight)!==cr&&(Et=!0),y.value=((Ue=n.refs.tableWrapper)==null?void 0:Ue.scrollHeight)||0,A.value=(Ut==null?void 0:Ut.scrollHeight)||0,M.value=((Ke=n.refs.footerWrapper)==null?void 0:Ke.offsetHeight)||0,D.value=((We=n.refs.appendWrapper)==null?void 0:We.offsetHeight)||0,x.value=y.value-A.value-M.value-D.value,Et&&(o.value={width:lt,height:qt,headerHeight:t.showHeader&&(Ut==null?void 0:Ut.offsetHeight)||0},H())},ae=B1(),pe=gt(()=>{const{bodyWidth:Ee,scrollY:Ue,gutterWidth:Ke}=e;return Ee.value?`${Ee.value-(Ue.value?Ke:0)}px`:""}),de=gt(()=>t.maxHeight?"fixed":t.tableLayout),ve=gt(()=>{if(t.data&&t.data.length)return null;let Ee="100%";t.height&&x.value&&(Ee=`${x.value}px`);const Ue=m.value;return{width:Ue?`${Ue}px`:"",height:Ee}}),me=gt(()=>t.height?{height:Number.isNaN(Number(t.height))?t.height:`${t.height}px`}:t.maxHeight?{maxHeight:Number.isNaN(Number(t.maxHeight))?t.maxHeight:`${t.maxHeight}px`}:{}),Ie=gt(()=>t.height?{height:"100%"}:t.maxHeight?Number.isNaN(Number(t.maxHeight))?{maxHeight:`calc(${t.maxHeight} - ${A.value+M.value}px)`}:{maxHeight:`${t.maxHeight-A.value-M.value}px`}:{});return{isHidden:i,renderExpanded:a,setDragVisible:c,isGroup:d,handleMouseLeave:P,handleHeaderFooterMousewheel:O,tableSize:ae,emptyBlockStyle:ve,handleFixedMousewheel:(Ee,Ue)=>{const Ke=n.refs.bodyWrapper;if(Math.abs(Ue.spinY)>0){const We=Ke.scrollTop;Ue.pixelY<0&&We!==0&&Ee.preventDefault(),Ue.pixelY>0&&Ke.scrollHeight-Ke.clientHeight>We&&Ee.preventDefault(),Ke.scrollTop+=Math.ceil(Ue.pixelY/5)}else Ke.scrollLeft+=Math.ceil(Ue.pixelX/5)},resizeProxyVisible:l,bodyWidth:pe,resizeState:o,doLayout:H,tableBodyStyles:V,tableLayout:de,scrollbarViewStyle:g,tableInnerStyle:me,scrollbarStyle:Ie}}function lye(t){const e=at(),r=()=>{const i=t.vnode.el.querySelector(".hidden-columns"),a={childList:!0,subtree:!0},l=t.store.states.updateOrderFns;e.value=new MutationObserver(()=>{l.forEach(c=>c())}),e.value.observe(i,a)};Vn(()=>{r()}),Td(()=>{var n;(n=e.value)==null||n.disconnect()})}var uye={data:{type:Array,default:()=>[]},size:jM,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object]};function Gq(t){const e=t.tableLayout==="auto";let r=t.columns||[];e&&r.every(i=>i.width===void 0)&&(r=[]);const n=i=>{const a={key:`${t.tableLayout}_${i.id}`,style:{},name:void 0};return e?a.style={width:`${i.width}px`}:a.name=i.id,a};return ln("colgroup",{},r.map(i=>ln("col",n(i))))}Gq.props=["columns","tableLayout"];const cye=()=>{const t=at(),e=(a,l)=>{const c=t.value;c&&c.scrollTo(a,l)},r=(a,l)=>{const c=t.value;c&&Fo(l)&&["Top","Left"].includes(a)&&c[`setScroll${a}`](l)};return{scrollBarRef:t,scrollTo:e,setScrollTop:a=>r("Top",a),setScrollLeft:a=>r("Left",a)}};let hye=1;const fye=Mr({name:"ElTable",directives:{Mousewheel:sve},components:{TableHeader:Q_e,TableBody:rye,TableFooter:aye,ElScrollbar:ZM,hColgroup:Gq},props:uye,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(t){const{t:e}=$M(),r=yn("table"),n=Mi();No(vc,n);const i=F_e(n,t);n.store=i;const a=new V_e({store:n.store,table:n,fit:t.fit,showHeader:t.showHeader});n.layout=a;const l=gt(()=>(i.states.data.value||[]).length===0),{setCurrentRow:c,getSelectionRows:o,toggleRowSelection:d,clearSelection:g,clearFilter:m,toggleAllSelection:y,toggleRowExpansion:x,clearSort:A,sort:M}=oye(i),{isHidden:D,renderExpanded:P,setDragVisible:O,isGroup:z,handleMouseLeave:V,handleHeaderFooterMousewheel:H,tableSize:$,emptyBlockStyle:X,handleFixedMousewheel:W,resizeProxyVisible:Y,bodyWidth:J,resizeState:re,doLayout:ae,tableBodyStyles:pe,tableLayout:de,scrollbarViewStyle:ve,tableInnerStyle:me,scrollbarStyle:Ie}=sye(t,a,i,n),{scrollBarRef:Le,scrollTo:Ee,setScrollLeft:Ue,setScrollTop:Ke}=cye(),We=mC(ae,50),Rt=`${r.namespace.value}-table_${hye++}`;n.tableId=Rt,n.state={isGroup:z,resizeState:re,doLayout:ae,debouncedUpdateLayout:We};const Et=gt(()=>t.sumText||e("el.table.sumText")),ar=gt(()=>t.emptyText||e("el.table.emptyText")),ur=gt(()=>Vq(i.states.originColumns.value)[0]);return lye(n),{ns:r,layout:a,store:i,columns:ur,handleHeaderFooterMousewheel:H,handleMouseLeave:V,tableId:Rt,tableSize:$,isHidden:D,isEmpty:l,renderExpanded:P,resizeProxyVisible:Y,resizeState:re,isGroup:z,bodyWidth:J,tableBodyStyles:pe,emptyBlockStyle:X,debouncedUpdateLayout:We,handleFixedMousewheel:W,setCurrentRow:c,getSelectionRows:o,toggleRowSelection:d,clearSelection:g,clearFilter:m,toggleAllSelection:y,toggleRowExpansion:x,clearSort:A,doLayout:ae,sort:M,t:e,setDragVisible:O,context:n,computedSumText:Et,computedEmptyText:ar,tableLayout:de,scrollbarViewStyle:ve,tableInnerStyle:me,scrollbarStyle:Ie,scrollBarRef:Le,scrollTo:Ee,setScrollLeft:Ue,setScrollTop:Ke}}}),dye=["data-prefix"],pye={ref:"hiddenColumns",class:"hidden-columns"};function gye(t,e,r,n,i,a){const l=Zs("hColgroup"),c=Zs("table-header"),o=Zs("table-body"),d=Zs("table-footer"),g=Zs("el-scrollbar"),m=d7("mousewheel");return Nt(),Gr("div",{ref:"tableWrapper",class:Lr([{[t.ns.m("fit")]:t.fit,[t.ns.m("striped")]:t.stripe,[t.ns.m("border")]:t.border||t.isGroup,[t.ns.m("hidden")]:t.isHidden,[t.ns.m("group")]:t.isGroup,[t.ns.m("fluid-height")]:t.maxHeight,[t.ns.m("scrollable-x")]:t.layout.scrollX.value,[t.ns.m("scrollable-y")]:t.layout.scrollY.value,[t.ns.m("enable-row-hover")]:!t.store.states.isComplex.value,[t.ns.m("enable-row-transition")]:(t.store.states.data.value||[]).length!==0&&(t.store.states.data.value||[]).length<100,"has-footer":t.showSummary},t.ns.m(t.tableSize),t.className,t.ns.b(),t.ns.m(`layout-${t.tableLayout}`)]),style:va(t.style),"data-prefix":t.ns.namespace.value,onMouseleave:e[0]||(e[0]=(...y)=>t.handleMouseLeave&&t.handleMouseLeave(...y))},[wt("div",{class:Lr(t.ns.e("inner-wrapper")),style:va(t.tableInnerStyle)},[wt("div",pye,[Cn(t.$slots,"default")],512),t.showHeader&&t.tableLayout==="fixed"?es((Nt(),Gr("div",{key:0,ref:"headerWrapper",class:Lr(t.ns.e("header-wrapper"))},[wt("table",{ref:"tableHeader",class:Lr(t.ns.e("header")),style:va(t.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[He(l,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),He(c,{ref:"tableHeaderRef",border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])],6)],2)),[[m,t.handleHeaderFooterMousewheel]]):In("v-if",!0),wt("div",{ref:"bodyWrapper",class:Lr(t.ns.e("body-wrapper"))},[He(g,{ref:"scrollBarRef","view-style":t.scrollbarViewStyle,"wrap-style":t.scrollbarStyle,always:t.scrollbarAlwaysOn},{default:pt(()=>[wt("table",{ref:"tableBody",class:Lr(t.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:va({width:t.bodyWidth,tableLayout:t.tableLayout})},[He(l,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),t.showHeader&&t.tableLayout==="auto"?(Nt(),kr(c,{key:0,ref:"tableHeaderRef",class:Lr(t.ns.e("body-header")),border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["class","border","default-sort","store","onSetDragVisible"])):In("v-if",!0),He(o,{context:t.context,highlight:t.highlightCurrentRow,"row-class-name":t.rowClassName,"tooltip-effect":t.tooltipEffect,"tooltip-options":t.tooltipOptions,"row-style":t.rowStyle,store:t.store,stripe:t.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),t.showSummary&&t.tableLayout==="auto"?(Nt(),kr(d,{key:1,class:Lr(t.ns.e("body-footer")),border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):In("v-if",!0)],6),t.isEmpty?(Nt(),Gr("div",{key:0,ref:"emptyBlock",style:va(t.emptyBlockStyle),class:Lr(t.ns.e("empty-block"))},[wt("span",{class:Lr(t.ns.e("empty-text"))},[Cn(t.$slots,"empty",{},()=>[ji(_n(t.computedEmptyText),1)])],2)],6)):In("v-if",!0),t.$slots.append?(Nt(),Gr("div",{key:1,ref:"appendWrapper",class:Lr(t.ns.e("append-wrapper"))},[Cn(t.$slots,"append")],2)):In("v-if",!0)]),_:3},8,["view-style","wrap-style","always"])],2),t.showSummary&&t.tableLayout==="fixed"?es((Nt(),Gr("div",{key:1,ref:"footerWrapper",class:Lr(t.ns.e("footer-wrapper"))},[wt("table",{class:Lr(t.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:va(t.tableBodyStyles)},[He(l,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),He(d,{border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[qg,!t.isEmpty],[m,t.handleHeaderFooterMousewheel]]):In("v-if",!0),t.border||t.isGroup?(Nt(),Gr("div",{key:2,class:Lr(t.ns.e("border-left-patch"))},null,2)):In("v-if",!0)],6),es(wt("div",{ref:"resizeProxy",class:Lr(t.ns.e("column-resize-proxy"))},null,2),[[qg,t.resizeProxyVisible]])],46,dye)}var vye=_i(fye,[["render",gye],["__file","table.vue"]]);const mye={selection:"table-column--selection",expand:"table__expand-column"},_ye={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},yye=t=>mye[t]||"",xye={selection:{renderHeader({store:t,column:e}){function r(){return t.states.data.value&&t.states.data.value.length===0}return ln(N_,{disabled:r(),size:t.states.tableSize.value,indeterminate:t.states.selection.value.length>0&&!t.states.isAllSelected.value,"onUpdate:modelValue":t.toggleAllSelection,modelValue:t.states.isAllSelected.value,ariaLabel:e.label})},renderCell({row:t,column:e,store:r,$index:n}){return ln(N_,{disabled:e.selectable?!e.selectable.call(null,t,n):!1,size:r.states.tableSize.value,onChange:()=>{r.commit("rowSelectedChanged",t)},onClick:i=>i.stopPropagation(),modelValue:r.isSelected(t),ariaLabel:e.label})},sortable:!1,resizable:!1},index:{renderHeader({column:t}){return t.label||"#"},renderCell({column:t,$index:e}){let r=e+1;const n=t.index;return typeof n=="number"?r=e+n:typeof n=="function"&&(r=n(e)),ln("div",{},[r])},sortable:!1},expand:{renderHeader({column:t}){return t.label||""},renderCell({row:t,store:e,expanded:r}){const{ns:n}=e,i=[n.e("expand-icon")];return r&&i.push(n.em("expand-icon","expanded")),ln("div",{class:i,onClick:function(l){l.stopPropagation(),e.toggleRowExpansion(t)}},{default:()=>[ln(As,null,{default:()=>[ln(GM)]})]})},sortable:!1,resizable:!1}};function bye({row:t,column:e,$index:r}){var n;const i=e.property,a=i&&vfe(t,i).value;return e&&e.formatter?e.formatter(t,e,a,r):((n=a==null?void 0:a.toString)==null?void 0:n.call(a))||""}function wye({row:t,treeNode:e,store:r},n=!1){const{ns:i}=r;if(!e)return n?[ln("span",{class:i.e("placeholder")})]:null;const a=[],l=function(c){c.stopPropagation(),!e.loading&&r.loadOrToggle(t)};if(e.indent&&a.push(ln("span",{class:i.e("indent"),style:{"padding-left":`${e.indent}px`}})),typeof e.expanded=="boolean"&&!e.noLazyChildren){const c=[i.e("expand-icon"),e.expanded?i.em("expand-icon","expanded"):""];let o=GM;e.loading&&(o=MZ),a.push(ln("div",{class:c,onClick:l},{default:()=>[ln(As,{class:{[i.is("loading")]:e.loading}},{default:()=>[ln(o)]})]}))}else a.push(ln("span",{class:i.e("placeholder")}));return a}function pG(t,e){return t.reduce((r,n)=>(r[n]=n,r),e)}function Sye(t,e){const r=Mi();return{registerComplexWatchers:()=>{const a=["fixed"],l={realWidth:"width",realMinWidth:"minWidth"},c=pG(a,l);Object.keys(c).forEach(o=>{const d=l[o];ni(e,d)&&un(()=>e[d],g=>{let m=g;d==="width"&&o==="realWidth"&&(m=fz(g)),d==="minWidth"&&o==="realMinWidth"&&(m=Rq(g)),r.columnConfig.value[d]=m,r.columnConfig.value[o]=m;const y=d==="fixed";t.value.store.scheduleLayout(y)})})},registerNormalWatchers:()=>{const a=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],l={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},c=pG(a,l);Object.keys(c).forEach(o=>{const d=l[o];ni(e,d)&&un(()=>e[d],g=>{r.columnConfig.value[o]=g})})}}}function Tye(t,e,r){const n=Mi(),i=at(""),a=at(!1),l=at(),c=at(),o=yn("table");kg(()=>{l.value=t.align?`is-${t.align}`:null,l.value}),kg(()=>{c.value=t.headerAlign?`is-${t.headerAlign}`:l.value,c.value});const d=gt(()=>{let V=n.vnode.vParent||n.parent;for(;V&&!V.tableId&&!V.columnId;)V=V.vnode.vParent||V.parent;return V}),g=gt(()=>{const{store:V}=n.parent;if(!V)return!1;const{treeData:H}=V.states,$=H.value;return $&&Object.keys($).length>0}),m=at(fz(t.width)),y=at(Rq(t.minWidth)),x=V=>(m.value&&(V.width=m.value),y.value&&(V.minWidth=y.value),!m.value&&y.value&&(V.width=void 0),V.minWidth||(V.minWidth=80),V.realWidth=Number(V.width===void 0?V.minWidth:V.width),V),A=V=>{const H=V.type,$=xye[H]||{};Object.keys($).forEach(W=>{const Y=$[W];W!=="className"&&Y!==void 0&&(V[W]=Y)});const X=yye(H);if(X){const W=`${Pe(o.namespace)}-${X}`;V.className=V.className?`${V.className} ${W}`:W}return V},M=V=>{Array.isArray(V)?V.forEach($=>H($)):H(V);function H($){var X;((X=$==null?void 0:$.type)==null?void 0:X.name)==="ElTableColumn"&&($.vParent=n)}};return{columnId:i,realAlign:l,isSubColumn:a,realHeaderAlign:c,columnOrTableParent:d,setColumnWidth:x,setColumnForcedProps:A,setColumnRenders:V=>{t.renderHeader||V.type!=="selection"&&(V.renderHeader=$=>(n.columnConfig.value.label,Cn(e,"header",$,()=>[V.label])));let H=V.renderCell;return V.type==="expand"?(V.renderCell=$=>ln("div",{class:"cell"},[H($)]),r.value.renderExpanded=$=>e.default?e.default($):e.default):(H=H||bye,V.renderCell=$=>{let X=null;if(e.default){const pe=e.default($);X=pe.some(de=>de.type!==Bo)?pe:H($)}else X=H($);const{columns:W}=r.value.store.states,Y=W.value.findIndex(pe=>pe.type==="default"),J=g.value&&$.cellIndex===Y,re=wye($,J),ae={class:"cell",style:{}};return V.showOverflowTooltip&&(ae.class=`${ae.class} ${Pe(o.namespace)}-tooltip`,ae.style={width:`${($.column.realWidth||Number($.column.width))-1}px`}),M(X),ln("div",ae,[re,X])}),V},getPropsData:(...V)=>V.reduce((H,$)=>(Array.isArray($)&&$.forEach(X=>{H[X]=t[X]}),H),{}),getColumnElIndex:(V,H)=>Array.prototype.indexOf.call(V,H),updateColumnOrder:()=>{r.value.store.commit("updateColumnOrder",n.columnConfig.value)}}}var Aye={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:t=>t.every(e=>["ascending","descending",null].includes(e))}};let Cye=1;var Uq=Mr({name:"ElTableColumn",components:{ElCheckbox:N_},props:Aye,setup(t,{slots:e}){const r=Mi(),n=at({}),i=gt(()=>{let z=r.parent;for(;z&&!z.tableId;)z=z.parent;return z}),{registerNormalWatchers:a,registerComplexWatchers:l}=Sye(i,t),{columnId:c,isSubColumn:o,realHeaderAlign:d,columnOrTableParent:g,setColumnWidth:m,setColumnForcedProps:y,setColumnRenders:x,getPropsData:A,getColumnElIndex:M,realAlign:D,updateColumnOrder:P}=Tye(t,e,i),O=g.value;c.value=`${O.tableId||O.columnId}_column_${Cye++}`,MM(()=>{o.value=i.value!==O;const z=t.type||"default",V=t.sortable===""?!0:t.sortable,H=Qg(t.showOverflowTooltip)?O.props.showOverflowTooltip:t.showOverflowTooltip,$={..._ye[z],id:c.value,type:z,property:t.prop||t.property,align:D,headerAlign:d,showOverflowTooltip:H,filterable:t.filters||t.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:V,index:t.index,rawColumnKey:r.vnode.key};let re=A(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);re=M_e($,re),re=E_e(x,m,y)(re),n.value=re,a(),l()}),Vn(()=>{var z;const V=g.value,H=o.value?V.vnode.el.children:(z=V.refs.hiddenColumns)==null?void 0:z.children,$=()=>M(H||[],r.vnode.el);n.value.getColumnIndex=$,$()>-1&&i.value.store.commit("insertColumn",n.value,o.value?V.columnConfig.value:null,P)}),Es(()=>{n.value.getColumnIndex()>-1&&i.value.store.commit("removeColumn",n.value,o.value?O.columnConfig.value:null,P)}),r.columnId=c.value,r.columnConfig=n},render(){var t,e,r;try{const n=(e=(t=this.$slots).default)==null?void 0:e.call(t,{row:{},column:{},$index:-1}),i=[];if(Array.isArray(n))for(const l of n)((r=l.type)==null?void 0:r.name)==="ElTableColumn"||l.shapeFlag&2?i.push(l):l.type===ha&&Array.isArray(l.children)&&l.children.forEach(c=>{(c==null?void 0:c.patchFlag)!==1024&&!wi(c==null?void 0:c.children)&&i.push(c)});return ln("div",i)}catch{return ln("div",[])}}});const Ga=ss(vye,{TableColumn:Uq}),Ua=Bl(Uq),XM=Symbol("tabsRootContextKey"),Mye=zi({tabs:{type:Qn(Array),default:()=>jf([])}}),$q="ElTabBar",Iye=Mr({name:$q}),Eye=Mr({...Iye,props:Mye,setup(t,{expose:e}){const r=t,n=Mi(),i=Mn(XM);i||lc($q,"<el-tabs><el-tab-bar /></el-tabs>");const a=yn("tabs"),l=at(),c=at(),o=()=>{let g=0,m=0;const y=["top","bottom"].includes(i.props.tabPosition)?"width":"height",x=y==="width"?"x":"y",A=x==="x"?"left":"top";return r.tabs.every(M=>{var D,P;const O=(P=(D=n.parent)==null?void 0:D.refs)==null?void 0:P[`tab-${M.uid}`];if(!O)return!1;if(!M.active)return!0;g=O[`offset${Hf(A)}`],m=O[`client${Hf(y)}`];const z=window.getComputedStyle(O);return y==="width"&&(r.tabs.length>1&&(m-=Number.parseFloat(z.paddingLeft)+Number.parseFloat(z.paddingRight)),g+=Number.parseFloat(z.paddingLeft)),!1}),{[y]:`${m}px`,transform:`translate${Hf(x)}(${g}px)`}},d=()=>c.value=o();return un(()=>r.tabs,async()=>{await Fa(),d()},{immediate:!0}),D_(l,()=>d()),e({ref:l,update:d}),(g,m)=>(Nt(),Gr("div",{ref_key:"barRef",ref:l,class:Lr([Pe(a).e("active-bar"),Pe(a).is(Pe(i).props.tabPosition)]),style:va(c.value)},null,6))}});var Dye=_i(Eye,[["__file","tab-bar.vue"]]);const Pye=zi({panes:{type:Qn(Array),default:()=>jf([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),Lye={tabClick:(t,e,r)=>r instanceof Event,tabRemove:(t,e)=>e instanceof Event},gG="ElTabNav",Rye=Mr({name:gG,props:Pye,emits:Lye,setup(t,{expose:e,emit:r}){const n=Mi(),i=Mn(XM);i||lc(gG,"<el-tabs><tab-nav /></el-tabs>");const a=yn("tabs"),l=qse(),c=nle(),o=at(),d=at(),g=at(),m=at(),y=at(!1),x=at(0),A=at(!1),M=at(!0),D=gt(()=>["top","bottom"].includes(i.props.tabPosition)?"width":"height"),P=gt(()=>({transform:`translate${D.value==="width"?"X":"Y"}(-${x.value}px)`})),O=()=>{if(!o.value)return;const Y=o.value[`offset${Hf(D.value)}`],J=x.value;if(!J)return;const re=J>Y?J-Y:0;x.value=re},z=()=>{if(!o.value||!d.value)return;const Y=d.value[`offset${Hf(D.value)}`],J=o.value[`offset${Hf(D.value)}`],re=x.value;if(Y-re<=J)return;const ae=Y-re>J*2?re+J:Y-J;x.value=ae},V=async()=>{const Y=d.value;if(!y.value||!g.value||!o.value||!Y)return;await Fa();const J=g.value.querySelector(".is-active");if(!J)return;const re=o.value,ae=["top","bottom"].includes(i.props.tabPosition),pe=J.getBoundingClientRect(),de=re.getBoundingClientRect(),ve=ae?Y.offsetWidth-de.width:Y.offsetHeight-de.height,me=x.value;let Ie=me;ae?(pe.left<de.left&&(Ie=me-(de.left-pe.left)),pe.right>de.right&&(Ie=me+pe.right-de.right)):(pe.top<de.top&&(Ie=me-(de.top-pe.top)),pe.bottom>de.bottom&&(Ie=me+(pe.bottom-de.bottom))),Ie=Math.max(Ie,0),x.value=Math.min(Ie,ve)},H=()=>{var Y;if(!d.value||!o.value)return;t.stretch&&((Y=m.value)==null||Y.update());const J=d.value[`offset${Hf(D.value)}`],re=o.value[`offset${Hf(D.value)}`],ae=x.value;re<J?(y.value=y.value||{},y.value.prev=ae,y.value.next=ae+re<J,J-ae<re&&(x.value=J-re)):(y.value=!1,ae>0&&(x.value=0))},$=Y=>{const J=Y.code,{up:re,down:ae,left:pe,right:de}=co;if(![re,ae,pe,de].includes(J))return;const ve=Array.from(Y.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),me=ve.indexOf(Y.target);let Ie;J===pe||J===re?me===0?Ie=ve.length-1:Ie=me-1:me<ve.length-1?Ie=me+1:Ie=0,ve[Ie].focus({preventScroll:!0}),ve[Ie].click(),X()},X=()=>{M.value&&(A.value=!0)},W=()=>A.value=!1;return un(l,Y=>{Y==="hidden"?M.value=!1:Y==="visible"&&setTimeout(()=>M.value=!0,50)}),un(c,Y=>{Y?setTimeout(()=>M.value=!0,50):M.value=!1}),D_(g,H),Vn(()=>setTimeout(()=>V(),0)),IM(()=>H()),e({scrollToActiveTab:V,removeFocus:W}),un(()=>t.panes,()=>n.update(),{flush:"post",deep:!0}),()=>{const Y=y.value?[He("span",{class:[a.e("nav-prev"),a.is("disabled",!y.value.prev)],onClick:O},[He(As,null,{default:()=>[He(wfe,null,null)]})]),He("span",{class:[a.e("nav-next"),a.is("disabled",!y.value.next)],onClick:z},[He(As,null,{default:()=>[He(GM,null,null)]})])]:null,J=t.panes.map((re,ae)=>{var pe,de,ve,me;const Ie=re.uid,Le=re.props.disabled,Ee=(de=(pe=re.props.name)!=null?pe:re.index)!=null?de:`${ae}`,Ue=!Le&&(re.isClosable||t.editable);re.index=`${ae}`;const Ke=Ue?He(As,{class:"is-icon-close",onClick:Et=>r("tabRemove",re,Et)},{default:()=>[He(_C,null,null)]}):null,We=((me=(ve=re.slots).label)==null?void 0:me.call(ve))||re.props.label,Rt=!Le&&re.active?0:-1;return He("div",{ref:`tab-${Ie}`,class:[a.e("item"),a.is(i.props.tabPosition),a.is("active",re.active),a.is("disabled",Le),a.is("closable",Ue),a.is("focus",A.value)],id:`tab-${Ee}`,key:`tab-${Ie}`,"aria-controls":`pane-${Ee}`,role:"tab","aria-selected":re.active,tabindex:Rt,onFocus:()=>X(),onBlur:()=>W(),onClick:Et=>{W(),r("tabClick",re,Ee,Et)},onKeydown:Et=>{Ue&&(Et.code===co.delete||Et.code===co.backspace)&&r("tabRemove",re,Et)}},[We,Ke])});return He("div",{ref:g,class:[a.e("nav-wrap"),a.is("scrollable",!!y.value),a.is(i.props.tabPosition)]},[Y,He("div",{class:a.e("nav-scroll"),ref:o},[He("div",{class:[a.e("nav"),a.is(i.props.tabPosition),a.is("stretch",t.stretch&&["top","bottom"].includes(i.props.tabPosition))],ref:d,style:P.value,role:"tablist",onKeydown:$},[t.type?null:He(Dye,{ref:m,tabs:[...t.panes]},null),J])])])}}}),kye=zi({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Qn(Function),default:()=>!0},stretch:Boolean}),lP=t=>wi(t)||Fo(t),Oye={[Cd]:t=>lP(t),tabClick:(t,e)=>e instanceof Event,tabChange:t=>lP(t),edit:(t,e)=>["remove","add"].includes(e),tabRemove:t=>lP(t),tabAdd:()=>!0},zye=Mr({name:"ElTabs",props:kye,emits:Oye,setup(t,{emit:e,slots:r,expose:n}){var i;const a=yn("tabs"),{children:l,addChild:c,removeChild:o}=ape(Mi(),"ElTabPane"),d=at(),g=at((i=t.modelValue)!=null?i:"0"),m=async(M,D=!1)=>{var P,O,z;if(!(g.value===M||Qg(M)))try{await((P=t.beforeLeave)==null?void 0:P.call(t,M,g.value))!==!1&&(g.value=M,D&&(e(Cd,M),e("tabChange",M)),(z=(O=d.value)==null?void 0:O.removeFocus)==null||z.call(O))}catch{}},y=(M,D,P)=>{M.props.disabled||(m(D,!0),e("tabClick",M,P))},x=(M,D)=>{M.props.disabled||Qg(M.props.name)||(D.stopPropagation(),e("edit",M.props.name,"remove"),e("tabRemove",M.props.name))},A=()=>{e("edit",void 0,"add"),e("tabAdd")};return un(()=>t.modelValue,M=>m(M)),un(g,async()=>{var M;await Fa(),(M=d.value)==null||M.scrollToActiveTab()}),No(XM,{props:t,currentName:g,registerPane:c,unregisterPane:o}),n({currentName:g}),()=>{const M=r["add-icon"],D=t.editable||t.addable?He("span",{class:a.e("new-tab"),tabindex:"0",onClick:A,onKeydown:z=>{z.code===co.enter&&A()}},[M?Cn(r,"add-icon"):He(As,{class:a.is("icon-plus")},{default:()=>[He(Pfe,null,null)]})]):null,P=He("div",{class:[a.e("header"),a.is(t.tabPosition)]},[D,He(Rye,{ref:d,currentName:g.value,editable:t.editable,type:t.type,panes:l.value,stretch:t.stretch,onTabClick:y,onTabRemove:x},null)]),O=He("div",{class:a.e("content")},[Cn(r,"default")]);return He("div",{class:[a.b(),a.m(t.tabPosition),{[a.m("card")]:t.type==="card",[a.m("border-card")]:t.type==="border-card"}]},[...t.tabPosition!=="bottom"?[P,O]:[O,P]])}}}),Bye=zi({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),Fye=["id","aria-hidden","aria-labelledby"],Hq="ElTabPane",Nye=Mr({name:Hq}),Vye=Mr({...Nye,props:Bye,setup(t){const e=t,r=Mi(),n=J_(),i=Mn(XM);i||lc(Hq,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const a=yn("tab-pane"),l=at(),c=gt(()=>e.closable||i.props.closable),o=ZV(()=>{var x;return i.currentName.value===((x=e.name)!=null?x:l.value)}),d=at(o.value),g=gt(()=>{var x;return(x=e.name)!=null?x:l.value}),m=ZV(()=>!e.lazy||d.value||o.value);un(o,x=>{x&&(d.value=!0)});const y=gc({uid:r.uid,slots:n,props:e,paneName:g,active:o,index:l,isClosable:c});return Vn(()=>{i.registerPane(y)}),Td(()=>{i.unregisterPane(y.uid)}),(x,A)=>Pe(m)?es((Nt(),Gr("div",{key:0,id:`pane-${Pe(g)}`,class:Lr(Pe(a).b()),role:"tabpanel","aria-hidden":!Pe(o),"aria-labelledby":`tab-${Pe(g)}`},[Cn(x.$slots,"default")],10,Fye)),[[qg,Pe(o)]]):In("v-if",!0)}});var jq=_i(Vye,[["__file","tab-pane.vue"]]);const Gye=ss(zye,{TabPane:jq}),Uye=Bl(jq);var Wq={exports:{}};(function(t,e){var r={};(function(n,i){t.exports=i()})(uq,function(){var n,i,a;function l(o,d){if(!n)n=d;else if(!i)i=d;else{var g="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",m={};n(m),a=d(m),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([g],{type:"text/javascript"})))}}l(["exports"],function(o){var d="3.4.0";let g;const m={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(g==null){const u=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{g=r.API_URL_REGEX!=null?new RegExp(r.API_URL_REGEX):u}catch{g=u}}return g},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!m.API_URL)return null;try{const u=new URL(m.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"};function y(u){return m.API_URL_REGEX.test(u)}function x(u){return u.indexOf("mapbox:")===0}function A(u){return m.API_CDN_URL_REGEX.test(u)}function M(u){return m.API_SPRITE_REGEX.test(u)}function D(u){return m.API_STYLE_REGEX.test(u)&&!M(u)}const P={create:"create",load:"load",fullLoad:"fullLoad"};function O(u){const s=u.name.split("?")[0];return A(s)&&s.includes("mapbox-gl.js")?"javascript":A(s)&&s.includes("mapbox-gl.css")?"css":function(h){return m.API_FONTS_REGEX.test(h)}(s)?"fontRange":M(s)?"sprite":D(s)?"style":function(h){return m.API_TILEJSON_REGEX.test(h)}(s)?"tilejson":"other"}function z(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var V={},H={};Object.defineProperty(H,"__esModule",{value:!0}),H.setMatrixArrayType=function(u){H.ARRAY_TYPE=X=u},H.toRadian=function(u){return u*Y},H.equals=function(u,s){return Math.abs(u-s)<=$*Math.max(1,Math.abs(u),Math.abs(s))},H.RANDOM=H.ARRAY_TYPE=H.EPSILON=void 0;var $=1e-6;H.EPSILON=$;var X=typeof Float32Array<"u"?Float32Array:Array;H.ARRAY_TYPE=X;var W=Math.random;H.RANDOM=W;var Y=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var u=0,s=arguments.length;s--;)u+=arguments[s]*arguments[s];return Math.sqrt(u)});var J={};function re(u){return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},re(u)}Object.defineProperty(J,"__esModule",{value:!0}),J.create=function(){var u=new ae.ARRAY_TYPE(4);return ae.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u},J.clone=function(u){var s=new ae.ARRAY_TYPE(4);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s},J.copy=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u},J.identity=function(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=1,u},J.fromValues=function(u,s,h,p){var _=new ae.ARRAY_TYPE(4);return _[0]=u,_[1]=s,_[2]=h,_[3]=p,_},J.set=function(u,s,h,p,_){return u[0]=s,u[1]=h,u[2]=p,u[3]=_,u},J.transpose=function(u,s){if(u===s){var h=s[1];u[1]=s[2],u[2]=h}else u[0]=s[0],u[1]=s[2],u[2]=s[1],u[3]=s[3];return u},J.invert=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=h*b-_*p;return T?(u[0]=b*(T=1/T),u[1]=-p*T,u[2]=-_*T,u[3]=h*T,u):null},J.adjoint=function(u,s){var h=s[0];return u[0]=s[3],u[1]=-s[1],u[2]=-s[2],u[3]=h,u},J.determinant=function(u){return u[0]*u[3]-u[2]*u[1]},J.multiply=de,J.rotate=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=Math.sin(h),L=Math.cos(h);return u[0]=p*L+b*I,u[1]=_*L+T*I,u[2]=p*-I+b*L,u[3]=_*-I+T*L,u},J.scale=function(u,s,h){var p=s[1],_=s[2],b=s[3],T=h[0],I=h[1];return u[0]=s[0]*T,u[1]=p*T,u[2]=_*I,u[3]=b*I,u},J.fromRotation=function(u,s){var h=Math.sin(s),p=Math.cos(s);return u[0]=p,u[1]=h,u[2]=-h,u[3]=p,u},J.fromScaling=function(u,s){return u[0]=s[0],u[1]=0,u[2]=0,u[3]=s[1],u},J.str=function(u){return"mat2("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")"},J.frob=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},J.LDU=function(u,s,h,p){return u[2]=p[2]/p[0],h[0]=p[0],h[1]=p[1],h[3]=p[3]-u[2]*h[1],[u,s,h]},J.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u[2]=s[2]+h[2],u[3]=s[3]+h[3],u},J.subtract=ve,J.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]},J.equals=function(u,s){var h=u[0],p=u[1],_=u[2],b=u[3],T=s[0],I=s[1],L=s[2],k=s[3];return Math.abs(h-T)<=ae.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(p-I)<=ae.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(_-L)<=ae.EPSILON*Math.max(1,Math.abs(_),Math.abs(L))&&Math.abs(b-k)<=ae.EPSILON*Math.max(1,Math.abs(b),Math.abs(k))},J.multiplyScalar=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u[2]=s[2]*h,u[3]=s[3]*h,u},J.multiplyScalarAndAdd=function(u,s,h,p){return u[0]=s[0]+h[0]*p,u[1]=s[1]+h[1]*p,u[2]=s[2]+h[2]*p,u[3]=s[3]+h[3]*p,u},J.sub=J.mul=void 0;var ae=function(u,s){if(u&&u.__esModule)return u;if(u===null||re(u)!=="object"&&typeof u!="function")return{default:u};var h=pe(void 0);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}(H);function pe(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(pe=function(p){return p?h:s})(u)}function de(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=h[0],L=h[1],k=h[2],F=h[3];return u[0]=p*I+b*L,u[1]=_*I+T*L,u[2]=p*k+b*F,u[3]=_*k+T*F,u}function ve(u,s,h){return u[0]=s[0]-h[0],u[1]=s[1]-h[1],u[2]=s[2]-h[2],u[3]=s[3]-h[3],u}J.mul=de,J.sub=ve;var me={};function Ie(u){return Ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Ie(u)}Object.defineProperty(me,"__esModule",{value:!0}),me.create=function(){var u=new Le.ARRAY_TYPE(6);return Le.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0,u[4]=0,u[5]=0),u[0]=1,u[3]=1,u},me.clone=function(u){var s=new Le.ARRAY_TYPE(6);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s},me.copy=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[4]=s[4],u[5]=s[5],u},me.identity=function(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=1,u[4]=0,u[5]=0,u},me.fromValues=function(u,s,h,p,_,b){var T=new Le.ARRAY_TYPE(6);return T[0]=u,T[1]=s,T[2]=h,T[3]=p,T[4]=_,T[5]=b,T},me.set=function(u,s,h,p,_,b,T){return u[0]=s,u[1]=h,u[2]=p,u[3]=_,u[4]=b,u[5]=T,u},me.invert=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],L=h*b-p*_;return L?(u[0]=b*(L=1/L),u[1]=-p*L,u[2]=-_*L,u[3]=h*L,u[4]=(_*I-b*T)*L,u[5]=(p*T-h*I)*L,u):null},me.determinant=function(u){return u[0]*u[3]-u[1]*u[2]},me.multiply=Ue,me.rotate=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=Math.sin(h),F=Math.cos(h);return u[0]=p*F+b*k,u[1]=_*F+T*k,u[2]=p*-k+b*F,u[3]=_*-k+T*F,u[4]=I,u[5]=L,u},me.scale=function(u,s,h){var p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],L=h[0],k=h[1];return u[0]=s[0]*L,u[1]=p*L,u[2]=_*k,u[3]=b*k,u[4]=T,u[5]=I,u},me.translate=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=h[0],F=h[1];return u[0]=p,u[1]=_,u[2]=b,u[3]=T,u[4]=p*k+b*F+I,u[5]=_*k+T*F+L,u},me.fromRotation=function(u,s){var h=Math.sin(s),p=Math.cos(s);return u[0]=p,u[1]=h,u[2]=-h,u[3]=p,u[4]=0,u[5]=0,u},me.fromScaling=function(u,s){return u[0]=s[0],u[1]=0,u[2]=0,u[3]=s[1],u[4]=0,u[5]=0,u},me.fromTranslation=function(u,s){return u[0]=1,u[1]=0,u[2]=0,u[3]=1,u[4]=s[0],u[5]=s[1],u},me.str=function(u){return"mat2d("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+", "+u[4]+", "+u[5]+")"},me.frob=function(u){return Math.hypot(u[0],u[1],u[2],u[3],u[4],u[5],1)},me.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u[2]=s[2]+h[2],u[3]=s[3]+h[3],u[4]=s[4]+h[4],u[5]=s[5]+h[5],u},me.subtract=Ke,me.multiplyScalar=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u[2]=s[2]*h,u[3]=s[3]*h,u[4]=s[4]*h,u[5]=s[5]*h,u},me.multiplyScalarAndAdd=function(u,s,h,p){return u[0]=s[0]+h[0]*p,u[1]=s[1]+h[1]*p,u[2]=s[2]+h[2]*p,u[3]=s[3]+h[3]*p,u[4]=s[4]+h[4]*p,u[5]=s[5]+h[5]*p,u},me.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]&&u[4]===s[4]&&u[5]===s[5]},me.equals=function(u,s){var h=u[0],p=u[1],_=u[2],b=u[3],T=u[4],I=u[5],L=s[0],k=s[1],F=s[2],N=s[3],U=s[4],Z=s[5];return Math.abs(h-L)<=Le.EPSILON*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(p-k)<=Le.EPSILON*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(_-F)<=Le.EPSILON*Math.max(1,Math.abs(_),Math.abs(F))&&Math.abs(b-N)<=Le.EPSILON*Math.max(1,Math.abs(b),Math.abs(N))&&Math.abs(T-U)<=Le.EPSILON*Math.max(1,Math.abs(T),Math.abs(U))&&Math.abs(I-Z)<=Le.EPSILON*Math.max(1,Math.abs(I),Math.abs(Z))},me.sub=me.mul=void 0;var Le=function(u,s){if(u&&u.__esModule)return u;if(u===null||Ie(u)!=="object"&&typeof u!="function")return{default:u};var h=Ee(void 0);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}(H);function Ee(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(Ee=function(p){return p?h:s})(u)}function Ue(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=h[0],F=h[1],N=h[2],U=h[3],Z=h[4],Q=h[5];return u[0]=p*k+b*F,u[1]=_*k+T*F,u[2]=p*N+b*U,u[3]=_*N+T*U,u[4]=p*Z+b*Q+I,u[5]=_*Z+T*Q+L,u}function Ke(u,s,h){return u[0]=s[0]-h[0],u[1]=s[1]-h[1],u[2]=s[2]-h[2],u[3]=s[3]-h[3],u[4]=s[4]-h[4],u[5]=s[5]-h[5],u}me.mul=Ue,me.sub=Ke;var We={};function Rt(u){return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Rt(u)}Object.defineProperty(We,"__esModule",{value:!0}),We.create=function(){var u=new Et.ARRAY_TYPE(9);return Et.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u},We.fromMat4=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[4],u[4]=s[5],u[5]=s[6],u[6]=s[8],u[7]=s[9],u[8]=s[10],u},We.clone=function(u){var s=new Et.ARRAY_TYPE(9);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s[6]=u[6],s[7]=u[7],s[8]=u[8],s},We.copy=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[4]=s[4],u[5]=s[5],u[6]=s[6],u[7]=s[7],u[8]=s[8],u},We.fromValues=function(u,s,h,p,_,b,T,I,L){var k=new Et.ARRAY_TYPE(9);return k[0]=u,k[1]=s,k[2]=h,k[3]=p,k[4]=_,k[5]=b,k[6]=T,k[7]=I,k[8]=L,k},We.set=function(u,s,h,p,_,b,T,I,L,k){return u[0]=s,u[1]=h,u[2]=p,u[3]=_,u[4]=b,u[5]=T,u[6]=I,u[7]=L,u[8]=k,u},We.identity=function(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=1,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},We.transpose=function(u,s){if(u===s){var h=s[1],p=s[2],_=s[5];u[1]=s[3],u[2]=s[6],u[3]=h,u[5]=s[7],u[6]=p,u[7]=_}else u[0]=s[0],u[1]=s[3],u[2]=s[6],u[3]=s[1],u[4]=s[4],u[5]=s[7],u[6]=s[2],u[7]=s[5],u[8]=s[8];return u},We.invert=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],L=s[6],k=s[7],F=s[8],N=F*T-I*k,U=-F*b+I*L,Z=k*b-T*L,Q=h*N+p*U+_*Z;return Q?(u[0]=N*(Q=1/Q),u[1]=(-F*p+_*k)*Q,u[2]=(I*p-_*T)*Q,u[3]=U*Q,u[4]=(F*h-_*L)*Q,u[5]=(-I*h+_*b)*Q,u[6]=Z*Q,u[7]=(-k*h+p*L)*Q,u[8]=(T*h-p*b)*Q,u):null},We.adjoint=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],L=s[6],k=s[7],F=s[8];return u[0]=T*F-I*k,u[1]=_*k-p*F,u[2]=p*I-_*T,u[3]=I*L-b*F,u[4]=h*F-_*L,u[5]=_*b-h*I,u[6]=b*k-T*L,u[7]=p*L-h*k,u[8]=h*T-p*b,u},We.determinant=function(u){var s=u[3],h=u[4],p=u[5],_=u[6],b=u[7],T=u[8];return u[0]*(T*h-p*b)+u[1]*(-T*s+p*_)+u[2]*(b*s-h*_)},We.multiply=ur,We.translate=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=s[8],U=h[0],Z=h[1];return u[0]=p,u[1]=_,u[2]=b,u[3]=T,u[4]=I,u[5]=L,u[6]=U*p+Z*T+k,u[7]=U*_+Z*I+F,u[8]=U*b+Z*L+N,u},We.rotate=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=s[8],U=Math.sin(h),Z=Math.cos(h);return u[0]=Z*p+U*T,u[1]=Z*_+U*I,u[2]=Z*b+U*L,u[3]=Z*T-U*p,u[4]=Z*I-U*_,u[5]=Z*L-U*b,u[6]=k,u[7]=F,u[8]=N,u},We.scale=function(u,s,h){var p=h[0],_=h[1];return u[0]=p*s[0],u[1]=p*s[1],u[2]=p*s[2],u[3]=_*s[3],u[4]=_*s[4],u[5]=_*s[5],u[6]=s[6],u[7]=s[7],u[8]=s[8],u},We.fromTranslation=function(u,s){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=1,u[5]=0,u[6]=s[0],u[7]=s[1],u[8]=1,u},We.fromRotation=function(u,s){var h=Math.sin(s),p=Math.cos(s);return u[0]=p,u[1]=h,u[2]=0,u[3]=-h,u[4]=p,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},We.fromScaling=function(u,s){return u[0]=s[0],u[1]=0,u[2]=0,u[3]=0,u[4]=s[1],u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},We.fromMat2d=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=0,u[3]=s[2],u[4]=s[3],u[5]=0,u[6]=s[4],u[7]=s[5],u[8]=1,u},We.fromQuat=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=h+h,I=p+p,L=_+_,k=h*T,F=p*T,N=p*I,U=_*T,Z=_*I,Q=_*L,ee=b*T,ie=b*I,oe=b*L;return u[0]=1-N-Q,u[3]=F-oe,u[6]=U+ie,u[1]=F+oe,u[4]=1-k-Q,u[7]=Z-ee,u[2]=U-ie,u[5]=Z+ee,u[8]=1-k-N,u},We.normalFromMat4=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],L=s[6],k=s[7],F=s[8],N=s[9],U=s[10],Z=s[11],Q=s[12],ee=s[13],ie=s[14],oe=s[15],_e=h*I-p*T,Se=h*L-_*T,xe=h*k-b*T,Re=p*L-_*I,Te=p*k-b*I,Be=_*k-b*L,Ne=F*ee-N*Q,Xe=F*ie-U*Q,ft=F*oe-Z*Q,Je=N*ie-U*ee,yt=N*oe-Z*ee,_t=U*oe-Z*ie,dt=_e*_t-Se*yt+xe*Je+Re*ft-Te*Xe+Be*Ne;return dt?(u[0]=(I*_t-L*yt+k*Je)*(dt=1/dt),u[1]=(L*ft-T*_t-k*Xe)*dt,u[2]=(T*yt-I*ft+k*Ne)*dt,u[3]=(_*yt-p*_t-b*Je)*dt,u[4]=(h*_t-_*ft+b*Xe)*dt,u[5]=(p*ft-h*yt-b*Ne)*dt,u[6]=(ee*Be-ie*Te+oe*Re)*dt,u[7]=(ie*xe-Q*Be-oe*Se)*dt,u[8]=(Q*Te-ee*xe+oe*_e)*dt,u):null},We.projection=function(u,s,h){return u[0]=2/s,u[1]=0,u[2]=0,u[3]=0,u[4]=-2/h,u[5]=0,u[6]=-1,u[7]=1,u[8]=1,u},We.str=function(u){return"mat3("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+", "+u[4]+", "+u[5]+", "+u[6]+", "+u[7]+", "+u[8]+")"},We.frob=function(u){return Math.hypot(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8])},We.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u[2]=s[2]+h[2],u[3]=s[3]+h[3],u[4]=s[4]+h[4],u[5]=s[5]+h[5],u[6]=s[6]+h[6],u[7]=s[7]+h[7],u[8]=s[8]+h[8],u},We.subtract=cr,We.multiplyScalar=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u[2]=s[2]*h,u[3]=s[3]*h,u[4]=s[4]*h,u[5]=s[5]*h,u[6]=s[6]*h,u[7]=s[7]*h,u[8]=s[8]*h,u},We.multiplyScalarAndAdd=function(u,s,h,p){return u[0]=s[0]+h[0]*p,u[1]=s[1]+h[1]*p,u[2]=s[2]+h[2]*p,u[3]=s[3]+h[3]*p,u[4]=s[4]+h[4]*p,u[5]=s[5]+h[5]*p,u[6]=s[6]+h[6]*p,u[7]=s[7]+h[7]*p,u[8]=s[8]+h[8]*p,u},We.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]&&u[4]===s[4]&&u[5]===s[5]&&u[6]===s[6]&&u[7]===s[7]&&u[8]===s[8]},We.equals=function(u,s){var h=u[0],p=u[1],_=u[2],b=u[3],T=u[4],I=u[5],L=u[6],k=u[7],F=u[8],N=s[0],U=s[1],Z=s[2],Q=s[3],ee=s[4],ie=s[5],oe=s[6],_e=s[7],Se=s[8];return Math.abs(h-N)<=Et.EPSILON*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(p-U)<=Et.EPSILON*Math.max(1,Math.abs(p),Math.abs(U))&&Math.abs(_-Z)<=Et.EPSILON*Math.max(1,Math.abs(_),Math.abs(Z))&&Math.abs(b-Q)<=Et.EPSILON*Math.max(1,Math.abs(b),Math.abs(Q))&&Math.abs(T-ee)<=Et.EPSILON*Math.max(1,Math.abs(T),Math.abs(ee))&&Math.abs(I-ie)<=Et.EPSILON*Math.max(1,Math.abs(I),Math.abs(ie))&&Math.abs(L-oe)<=Et.EPSILON*Math.max(1,Math.abs(L),Math.abs(oe))&&Math.abs(k-_e)<=Et.EPSILON*Math.max(1,Math.abs(k),Math.abs(_e))&&Math.abs(F-Se)<=Et.EPSILON*Math.max(1,Math.abs(F),Math.abs(Se))},We.sub=We.mul=void 0;var Et=function(u,s){if(u&&u.__esModule)return u;if(u===null||Rt(u)!=="object"&&typeof u!="function")return{default:u};var h=ar(void 0);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}(H);function ar(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(ar=function(p){return p?h:s})(u)}function ur(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=s[8],U=h[0],Z=h[1],Q=h[2],ee=h[3],ie=h[4],oe=h[5],_e=h[6],Se=h[7],xe=h[8];return u[0]=U*p+Z*T+Q*k,u[1]=U*_+Z*I+Q*F,u[2]=U*b+Z*L+Q*N,u[3]=ee*p+ie*T+oe*k,u[4]=ee*_+ie*I+oe*F,u[5]=ee*b+ie*L+oe*N,u[6]=_e*p+Se*T+xe*k,u[7]=_e*_+Se*I+xe*F,u[8]=_e*b+Se*L+xe*N,u}function cr(u,s,h){return u[0]=s[0]-h[0],u[1]=s[1]-h[1],u[2]=s[2]-h[2],u[3]=s[3]-h[3],u[4]=s[4]-h[4],u[5]=s[5]-h[5],u[6]=s[6]-h[6],u[7]=s[7]-h[7],u[8]=s[8]-h[8],u}We.mul=ur,We.sub=cr;var lt={};function qt(u){return qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},qt(u)}Object.defineProperty(lt,"__esModule",{value:!0}),lt.create=function(){var u=new Ut.ARRAY_TYPE(16);return Ut.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},lt.clone=function(u){var s=new Ut.ARRAY_TYPE(16);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s[6]=u[6],s[7]=u[7],s[8]=u[8],s[9]=u[9],s[10]=u[10],s[11]=u[11],s[12]=u[12],s[13]=u[13],s[14]=u[14],s[15]=u[15],s},lt.copy=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[4]=s[4],u[5]=s[5],u[6]=s[6],u[7]=s[7],u[8]=s[8],u[9]=s[9],u[10]=s[10],u[11]=s[11],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15],u},lt.fromValues=function(u,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee){var ie=new Ut.ARRAY_TYPE(16);return ie[0]=u,ie[1]=s,ie[2]=h,ie[3]=p,ie[4]=_,ie[5]=b,ie[6]=T,ie[7]=I,ie[8]=L,ie[9]=k,ie[10]=F,ie[11]=N,ie[12]=U,ie[13]=Z,ie[14]=Q,ie[15]=ee,ie},lt.set=function(u,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie){return u[0]=s,u[1]=h,u[2]=p,u[3]=_,u[4]=b,u[5]=T,u[6]=I,u[7]=L,u[8]=k,u[9]=F,u[10]=N,u[11]=U,u[12]=Z,u[13]=Q,u[14]=ee,u[15]=ie,u},lt.identity=br,lt.transpose=function(u,s){if(u===s){var h=s[1],p=s[2],_=s[3],b=s[6],T=s[7],I=s[11];u[1]=s[4],u[2]=s[8],u[3]=s[12],u[4]=h,u[6]=s[9],u[7]=s[13],u[8]=p,u[9]=b,u[11]=s[14],u[12]=_,u[13]=T,u[14]=I}else u[0]=s[0],u[1]=s[4],u[2]=s[8],u[3]=s[12],u[4]=s[1],u[5]=s[5],u[6]=s[9],u[7]=s[13],u[8]=s[2],u[9]=s[6],u[10]=s[10],u[11]=s[14],u[12]=s[3],u[13]=s[7],u[14]=s[11],u[15]=s[15];return u},lt.invert=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],L=s[6],k=s[7],F=s[8],N=s[9],U=s[10],Z=s[11],Q=s[12],ee=s[13],ie=s[14],oe=s[15],_e=h*I-p*T,Se=h*L-_*T,xe=h*k-b*T,Re=p*L-_*I,Te=p*k-b*I,Be=_*k-b*L,Ne=F*ee-N*Q,Xe=F*ie-U*Q,ft=F*oe-Z*Q,Je=N*ie-U*ee,yt=N*oe-Z*ee,_t=U*oe-Z*ie,dt=_e*_t-Se*yt+xe*Je+Re*ft-Te*Xe+Be*Ne;return dt?(u[0]=(I*_t-L*yt+k*Je)*(dt=1/dt),u[1]=(_*yt-p*_t-b*Je)*dt,u[2]=(ee*Be-ie*Te+oe*Re)*dt,u[3]=(U*Te-N*Be-Z*Re)*dt,u[4]=(L*ft-T*_t-k*Xe)*dt,u[5]=(h*_t-_*ft+b*Xe)*dt,u[6]=(ie*xe-Q*Be-oe*Se)*dt,u[7]=(F*Be-U*xe+Z*Se)*dt,u[8]=(T*yt-I*ft+k*Ne)*dt,u[9]=(p*ft-h*yt-b*Ne)*dt,u[10]=(Q*Te-ee*xe+oe*_e)*dt,u[11]=(N*xe-F*Te-Z*_e)*dt,u[12]=(I*Xe-T*Je-L*Ne)*dt,u[13]=(h*Je-p*Xe+_*Ne)*dt,u[14]=(ee*Se-Q*Re-ie*_e)*dt,u[15]=(F*Re-N*Se+U*_e)*dt,u):null},lt.adjoint=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],L=s[6],k=s[7],F=s[8],N=s[9],U=s[10],Z=s[11],Q=s[12],ee=s[13],ie=s[14],oe=s[15];return u[0]=I*(U*oe-Z*ie)-N*(L*oe-k*ie)+ee*(L*Z-k*U),u[1]=-(p*(U*oe-Z*ie)-N*(_*oe-b*ie)+ee*(_*Z-b*U)),u[2]=p*(L*oe-k*ie)-I*(_*oe-b*ie)+ee*(_*k-b*L),u[3]=-(p*(L*Z-k*U)-I*(_*Z-b*U)+N*(_*k-b*L)),u[4]=-(T*(U*oe-Z*ie)-F*(L*oe-k*ie)+Q*(L*Z-k*U)),u[5]=h*(U*oe-Z*ie)-F*(_*oe-b*ie)+Q*(_*Z-b*U),u[6]=-(h*(L*oe-k*ie)-T*(_*oe-b*ie)+Q*(_*k-b*L)),u[7]=h*(L*Z-k*U)-T*(_*Z-b*U)+F*(_*k-b*L),u[8]=T*(N*oe-Z*ee)-F*(I*oe-k*ee)+Q*(I*Z-k*N),u[9]=-(h*(N*oe-Z*ee)-F*(p*oe-b*ee)+Q*(p*Z-b*N)),u[10]=h*(I*oe-k*ee)-T*(p*oe-b*ee)+Q*(p*k-b*I),u[11]=-(h*(I*Z-k*N)-T*(p*Z-b*N)+F*(p*k-b*I)),u[12]=-(T*(N*ie-U*ee)-F*(I*ie-L*ee)+Q*(I*U-L*N)),u[13]=h*(N*ie-U*ee)-F*(p*ie-_*ee)+Q*(p*U-_*N),u[14]=-(h*(I*ie-L*ee)-T*(p*ie-_*ee)+Q*(p*L-_*I)),u[15]=h*(I*U-L*N)-T*(p*U-_*N)+F*(p*L-_*I),u},lt.determinant=function(u){var s=u[0],h=u[1],p=u[2],_=u[3],b=u[4],T=u[5],I=u[6],L=u[7],k=u[8],F=u[9],N=u[10],U=u[11],Z=u[12],Q=u[13],ee=u[14],ie=u[15];return(s*T-h*b)*(N*ie-U*ee)-(s*I-p*b)*(F*ie-U*Q)+(s*L-_*b)*(F*ee-N*Q)+(h*I-p*T)*(k*ie-U*Z)-(h*L-_*T)*(k*ee-N*Z)+(p*L-_*I)*(k*Q-F*Z)},lt.multiply=Oe,lt.translate=function(u,s,h){var p,_,b,T,I,L,k,F,N,U,Z,Q,ee=h[0],ie=h[1],oe=h[2];return s===u?(u[12]=s[0]*ee+s[4]*ie+s[8]*oe+s[12],u[13]=s[1]*ee+s[5]*ie+s[9]*oe+s[13],u[14]=s[2]*ee+s[6]*ie+s[10]*oe+s[14],u[15]=s[3]*ee+s[7]*ie+s[11]*oe+s[15]):(_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=s[8],U=s[9],Z=s[10],Q=s[11],u[0]=p=s[0],u[1]=_,u[2]=b,u[3]=T,u[4]=I,u[5]=L,u[6]=k,u[7]=F,u[8]=N,u[9]=U,u[10]=Z,u[11]=Q,u[12]=p*ee+I*ie+N*oe+s[12],u[13]=_*ee+L*ie+U*oe+s[13],u[14]=b*ee+k*ie+Z*oe+s[14],u[15]=T*ee+F*ie+Q*oe+s[15]),u},lt.scale=function(u,s,h){var p=h[0],_=h[1],b=h[2];return u[0]=s[0]*p,u[1]=s[1]*p,u[2]=s[2]*p,u[3]=s[3]*p,u[4]=s[4]*_,u[5]=s[5]*_,u[6]=s[6]*_,u[7]=s[7]*_,u[8]=s[8]*b,u[9]=s[9]*b,u[10]=s[10]*b,u[11]=s[11]*b,u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15],u},lt.rotate=function(u,s,h,p){var _,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe,_e,Se,xe,Re,Te,Be,Ne,Xe,ft,Je,yt=p[0],_t=p[1],dt=p[2],Pt=Math.hypot(yt,_t,dt);return Pt<Ut.EPSILON?null:(yt*=Pt=1/Pt,_t*=Pt,dt*=Pt,_=Math.sin(h),b=Math.cos(h),L=s[1],k=s[2],F=s[3],U=s[5],Z=s[6],Q=s[7],ie=s[9],oe=s[10],_e=s[11],Se=yt*yt*(T=1-b)+b,Te=yt*_t*T-dt*_,Be=_t*_t*T+b,Ne=dt*_t*T+yt*_,Xe=yt*dt*T+_t*_,ft=_t*dt*T-yt*_,Je=dt*dt*T+b,u[0]=(I=s[0])*Se+(N=s[4])*(xe=_t*yt*T+dt*_)+(ee=s[8])*(Re=dt*yt*T-_t*_),u[1]=L*Se+U*xe+ie*Re,u[2]=k*Se+Z*xe+oe*Re,u[3]=F*Se+Q*xe+_e*Re,u[4]=I*Te+N*Be+ee*Ne,u[5]=L*Te+U*Be+ie*Ne,u[6]=k*Te+Z*Be+oe*Ne,u[7]=F*Te+Q*Be+_e*Ne,u[8]=I*Xe+N*ft+ee*Je,u[9]=L*Xe+U*ft+ie*Je,u[10]=k*Xe+Z*ft+oe*Je,u[11]=F*Xe+Q*ft+_e*Je,s!==u&&(u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u)},lt.rotateX=function(u,s,h){var p=Math.sin(h),_=Math.cos(h),b=s[4],T=s[5],I=s[6],L=s[7],k=s[8],F=s[9],N=s[10],U=s[11];return s!==u&&(u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[4]=b*_+k*p,u[5]=T*_+F*p,u[6]=I*_+N*p,u[7]=L*_+U*p,u[8]=k*_-b*p,u[9]=F*_-T*p,u[10]=N*_-I*p,u[11]=U*_-L*p,u},lt.rotateY=function(u,s,h){var p=Math.sin(h),_=Math.cos(h),b=s[0],T=s[1],I=s[2],L=s[3],k=s[8],F=s[9],N=s[10],U=s[11];return s!==u&&(u[4]=s[4],u[5]=s[5],u[6]=s[6],u[7]=s[7],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[0]=b*_-k*p,u[1]=T*_-F*p,u[2]=I*_-N*p,u[3]=L*_-U*p,u[8]=b*p+k*_,u[9]=T*p+F*_,u[10]=I*p+N*_,u[11]=L*p+U*_,u},lt.rotateZ=function(u,s,h){var p=Math.sin(h),_=Math.cos(h),b=s[0],T=s[1],I=s[2],L=s[3],k=s[4],F=s[5],N=s[6],U=s[7];return s!==u&&(u[8]=s[8],u[9]=s[9],u[10]=s[10],u[11]=s[11],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[0]=b*_+k*p,u[1]=T*_+F*p,u[2]=I*_+N*p,u[3]=L*_+U*p,u[4]=k*_-b*p,u[5]=F*_-T*p,u[6]=N*_-I*p,u[7]=U*_-L*p,u},lt.fromTranslation=function(u,s){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=s[0],u[13]=s[1],u[14]=s[2],u[15]=1,u},lt.fromScaling=function(u,s){return u[0]=s[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=s[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=s[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},lt.fromRotation=function(u,s,h){var p,_,b,T=h[0],I=h[1],L=h[2],k=Math.hypot(T,I,L);return k<Ut.EPSILON?null:(T*=k=1/k,I*=k,L*=k,p=Math.sin(s),_=Math.cos(s),u[0]=T*T*(b=1-_)+_,u[1]=I*T*b+L*p,u[2]=L*T*b-I*p,u[3]=0,u[4]=T*I*b-L*p,u[5]=I*I*b+_,u[6]=L*I*b+T*p,u[7]=0,u[8]=T*L*b+I*p,u[9]=I*L*b-T*p,u[10]=L*L*b+_,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)},lt.fromXRotation=function(u,s){var h=Math.sin(s),p=Math.cos(s);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=p,u[6]=h,u[7]=0,u[8]=0,u[9]=-h,u[10]=p,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},lt.fromYRotation=function(u,s){var h=Math.sin(s),p=Math.cos(s);return u[0]=p,u[1]=0,u[2]=-h,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=h,u[9]=0,u[10]=p,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},lt.fromZRotation=function(u,s){var h=Math.sin(s),p=Math.cos(s);return u[0]=p,u[1]=h,u[2]=0,u[3]=0,u[4]=-h,u[5]=p,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},lt.fromRotationTranslation=$e,lt.fromQuat2=function(u,s){var h=new Ut.ARRAY_TYPE(3),p=-s[0],_=-s[1],b=-s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=p*p+_*_+b*b+T*T;return N>0?(h[0]=2*(I*T+F*p+L*b-k*_)/N,h[1]=2*(L*T+F*_+k*p-I*b)/N,h[2]=2*(k*T+F*b+I*_-L*p)/N):(h[0]=2*(I*T+F*p+L*b-k*_),h[1]=2*(L*T+F*_+k*p-I*b),h[2]=2*(k*T+F*b+I*_-L*p)),$e(u,s,h),u},lt.getTranslation=function(u,s){return u[0]=s[12],u[1]=s[13],u[2]=s[14],u},lt.getScaling=ct,lt.getRotation=function(u,s){var h=new Ut.ARRAY_TYPE(3);ct(h,s);var p=1/h[0],_=1/h[1],b=1/h[2],T=s[0]*p,I=s[1]*_,L=s[2]*b,k=s[4]*p,F=s[5]*_,N=s[6]*b,U=s[8]*p,Z=s[9]*_,Q=s[10]*b,ee=T+F+Q,ie=0;return ee>0?(ie=2*Math.sqrt(ee+1),u[3]=.25*ie,u[0]=(N-Z)/ie,u[1]=(U-L)/ie,u[2]=(I-k)/ie):T>F&&T>Q?(ie=2*Math.sqrt(1+T-F-Q),u[3]=(N-Z)/ie,u[0]=.25*ie,u[1]=(I+k)/ie,u[2]=(U+L)/ie):F>Q?(ie=2*Math.sqrt(1+F-T-Q),u[3]=(U-L)/ie,u[0]=(I+k)/ie,u[1]=.25*ie,u[2]=(N+Z)/ie):(ie=2*Math.sqrt(1+Q-T-F),u[3]=(I-k)/ie,u[0]=(U+L)/ie,u[1]=(N+Z)/ie,u[2]=.25*ie),u},lt.fromRotationTranslationScale=function(u,s,h,p){var _=s[0],b=s[1],T=s[2],I=s[3],L=_+_,k=b+b,F=T+T,N=_*L,U=_*k,Z=_*F,Q=b*k,ee=b*F,ie=T*F,oe=I*L,_e=I*k,Se=I*F,xe=p[0],Re=p[1],Te=p[2];return u[0]=(1-(Q+ie))*xe,u[1]=(U+Se)*xe,u[2]=(Z-_e)*xe,u[3]=0,u[4]=(U-Se)*Re,u[5]=(1-(N+ie))*Re,u[6]=(ee+oe)*Re,u[7]=0,u[8]=(Z+_e)*Te,u[9]=(ee-oe)*Te,u[10]=(1-(N+Q))*Te,u[11]=0,u[12]=h[0],u[13]=h[1],u[14]=h[2],u[15]=1,u},lt.fromRotationTranslationScaleOrigin=function(u,s,h,p,_){var b=s[0],T=s[1],I=s[2],L=s[3],k=b+b,F=T+T,N=I+I,U=b*k,Z=b*F,Q=b*N,ee=T*F,ie=T*N,oe=I*N,_e=L*k,Se=L*F,xe=L*N,Re=p[0],Te=p[1],Be=p[2],Ne=_[0],Xe=_[1],ft=_[2],Je=(1-(ee+oe))*Re,yt=(Z+xe)*Re,_t=(Q-Se)*Re,dt=(Z-xe)*Te,Pt=(1-(U+oe))*Te,It=(ie+_e)*Te,zt=(Q+Se)*Be,Ot=(ie-_e)*Be,xt=(1-(U+ee))*Be;return u[0]=Je,u[1]=yt,u[2]=_t,u[3]=0,u[4]=dt,u[5]=Pt,u[6]=It,u[7]=0,u[8]=zt,u[9]=Ot,u[10]=xt,u[11]=0,u[12]=h[0]+Ne-(Je*Ne+dt*Xe+zt*ft),u[13]=h[1]+Xe-(yt*Ne+Pt*Xe+Ot*ft),u[14]=h[2]+ft-(_t*Ne+It*Xe+xt*ft),u[15]=1,u},lt.fromQuat=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=h+h,I=p+p,L=_+_,k=h*T,F=p*T,N=p*I,U=_*T,Z=_*I,Q=_*L,ee=b*T,ie=b*I,oe=b*L;return u[0]=1-N-Q,u[1]=F+oe,u[2]=U-ie,u[3]=0,u[4]=F-oe,u[5]=1-k-Q,u[6]=Z+ee,u[7]=0,u[8]=U+ie,u[9]=Z-ee,u[10]=1-k-N,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},lt.frustum=function(u,s,h,p,_,b,T){var I=1/(h-s),L=1/(_-p),k=1/(b-T);return u[0]=2*b*I,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2*b*L,u[6]=0,u[7]=0,u[8]=(h+s)*I,u[9]=(_+p)*L,u[10]=(T+b)*k,u[11]=-1,u[12]=0,u[13]=0,u[14]=T*b*2*k,u[15]=0,u},lt.perspectiveNO=bt,lt.perspectiveZO=function(u,s,h,p,_){var b,T=1/Math.tan(s/2);return u[0]=T/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=T,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,_!=null&&_!==1/0?(u[10]=_*(b=1/(p-_)),u[14]=_*p*b):(u[10]=-1,u[14]=-p),u},lt.perspectiveFromFieldOfView=function(u,s,h,p){var _=Math.tan(s.upDegrees*Math.PI/180),b=Math.tan(s.downDegrees*Math.PI/180),T=Math.tan(s.leftDegrees*Math.PI/180),I=Math.tan(s.rightDegrees*Math.PI/180),L=2/(T+I),k=2/(_+b);return u[0]=L,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=k,u[6]=0,u[7]=0,u[8]=-(T-I)*L*.5,u[9]=(_-b)*k*.5,u[10]=p/(h-p),u[11]=-1,u[12]=0,u[13]=0,u[14]=p*h/(h-p),u[15]=0,u},lt.orthoNO=At,lt.orthoZO=function(u,s,h,p,_,b,T){var I=1/(s-h),L=1/(p-_),k=1/(b-T);return u[0]=-2*I,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*L,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=k,u[11]=0,u[12]=(s+h)*I,u[13]=(_+p)*L,u[14]=b*k,u[15]=1,u},lt.lookAt=function(u,s,h,p){var _,b,T,I,L,k,F,N,U,Z,Q=s[0],ee=s[1],ie=s[2],oe=p[0],_e=p[1],Se=p[2],xe=h[0],Re=h[1],Te=h[2];return Math.abs(Q-xe)<Ut.EPSILON&&Math.abs(ee-Re)<Ut.EPSILON&&Math.abs(ie-Te)<Ut.EPSILON?br(u):(F=Q-xe,N=ee-Re,U=ie-Te,_=_e*(U*=Z=1/Math.hypot(F,N,U))-Se*(N*=Z),b=Se*(F*=Z)-oe*U,T=oe*N-_e*F,(Z=Math.hypot(_,b,T))?(_*=Z=1/Z,b*=Z,T*=Z):(_=0,b=0,T=0),I=N*T-U*b,L=U*_-F*T,k=F*b-N*_,(Z=Math.hypot(I,L,k))?(I*=Z=1/Z,L*=Z,k*=Z):(I=0,L=0,k=0),u[0]=_,u[1]=I,u[2]=F,u[3]=0,u[4]=b,u[5]=L,u[6]=N,u[7]=0,u[8]=T,u[9]=k,u[10]=U,u[11]=0,u[12]=-(_*Q+b*ee+T*ie),u[13]=-(I*Q+L*ee+k*ie),u[14]=-(F*Q+N*ee+U*ie),u[15]=1,u)},lt.targetTo=function(u,s,h,p){var _=s[0],b=s[1],T=s[2],I=p[0],L=p[1],k=p[2],F=_-h[0],N=b-h[1],U=T-h[2],Z=F*F+N*N+U*U;Z>0&&(F*=Z=1/Math.sqrt(Z),N*=Z,U*=Z);var Q=L*U-k*N,ee=k*F-I*U,ie=I*N-L*F;return(Z=Q*Q+ee*ee+ie*ie)>0&&(Q*=Z=1/Math.sqrt(Z),ee*=Z,ie*=Z),u[0]=Q,u[1]=ee,u[2]=ie,u[3]=0,u[4]=N*ie-U*ee,u[5]=U*Q-F*ie,u[6]=F*ee-N*Q,u[7]=0,u[8]=F,u[9]=N,u[10]=U,u[11]=0,u[12]=_,u[13]=b,u[14]=T,u[15]=1,u},lt.str=function(u){return"mat4("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+", "+u[4]+", "+u[5]+", "+u[6]+", "+u[7]+", "+u[8]+", "+u[9]+", "+u[10]+", "+u[11]+", "+u[12]+", "+u[13]+", "+u[14]+", "+u[15]+")"},lt.frob=function(u){return Math.hypot(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8],u[9],u[10],u[11],u[12],u[13],u[14],u[15])},lt.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u[2]=s[2]+h[2],u[3]=s[3]+h[3],u[4]=s[4]+h[4],u[5]=s[5]+h[5],u[6]=s[6]+h[6],u[7]=s[7]+h[7],u[8]=s[8]+h[8],u[9]=s[9]+h[9],u[10]=s[10]+h[10],u[11]=s[11]+h[11],u[12]=s[12]+h[12],u[13]=s[13]+h[13],u[14]=s[14]+h[14],u[15]=s[15]+h[15],u},lt.subtract=Jt,lt.multiplyScalar=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u[2]=s[2]*h,u[3]=s[3]*h,u[4]=s[4]*h,u[5]=s[5]*h,u[6]=s[6]*h,u[7]=s[7]*h,u[8]=s[8]*h,u[9]=s[9]*h,u[10]=s[10]*h,u[11]=s[11]*h,u[12]=s[12]*h,u[13]=s[13]*h,u[14]=s[14]*h,u[15]=s[15]*h,u},lt.multiplyScalarAndAdd=function(u,s,h,p){return u[0]=s[0]+h[0]*p,u[1]=s[1]+h[1]*p,u[2]=s[2]+h[2]*p,u[3]=s[3]+h[3]*p,u[4]=s[4]+h[4]*p,u[5]=s[5]+h[5]*p,u[6]=s[6]+h[6]*p,u[7]=s[7]+h[7]*p,u[8]=s[8]+h[8]*p,u[9]=s[9]+h[9]*p,u[10]=s[10]+h[10]*p,u[11]=s[11]+h[11]*p,u[12]=s[12]+h[12]*p,u[13]=s[13]+h[13]*p,u[14]=s[14]+h[14]*p,u[15]=s[15]+h[15]*p,u},lt.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]&&u[4]===s[4]&&u[5]===s[5]&&u[6]===s[6]&&u[7]===s[7]&&u[8]===s[8]&&u[9]===s[9]&&u[10]===s[10]&&u[11]===s[11]&&u[12]===s[12]&&u[13]===s[13]&&u[14]===s[14]&&u[15]===s[15]},lt.equals=function(u,s){var h=u[0],p=u[1],_=u[2],b=u[3],T=u[4],I=u[5],L=u[6],k=u[7],F=u[8],N=u[9],U=u[10],Z=u[11],Q=u[12],ee=u[13],ie=u[14],oe=u[15],_e=s[0],Se=s[1],xe=s[2],Re=s[3],Te=s[4],Be=s[5],Ne=s[6],Xe=s[7],ft=s[8],Je=s[9],yt=s[10],_t=s[11],dt=s[12],Pt=s[13],It=s[14],zt=s[15];return Math.abs(h-_e)<=Ut.EPSILON*Math.max(1,Math.abs(h),Math.abs(_e))&&Math.abs(p-Se)<=Ut.EPSILON*Math.max(1,Math.abs(p),Math.abs(Se))&&Math.abs(_-xe)<=Ut.EPSILON*Math.max(1,Math.abs(_),Math.abs(xe))&&Math.abs(b-Re)<=Ut.EPSILON*Math.max(1,Math.abs(b),Math.abs(Re))&&Math.abs(T-Te)<=Ut.EPSILON*Math.max(1,Math.abs(T),Math.abs(Te))&&Math.abs(I-Be)<=Ut.EPSILON*Math.max(1,Math.abs(I),Math.abs(Be))&&Math.abs(L-Ne)<=Ut.EPSILON*Math.max(1,Math.abs(L),Math.abs(Ne))&&Math.abs(k-Xe)<=Ut.EPSILON*Math.max(1,Math.abs(k),Math.abs(Xe))&&Math.abs(F-ft)<=Ut.EPSILON*Math.max(1,Math.abs(F),Math.abs(ft))&&Math.abs(N-Je)<=Ut.EPSILON*Math.max(1,Math.abs(N),Math.abs(Je))&&Math.abs(U-yt)<=Ut.EPSILON*Math.max(1,Math.abs(U),Math.abs(yt))&&Math.abs(Z-_t)<=Ut.EPSILON*Math.max(1,Math.abs(Z),Math.abs(_t))&&Math.abs(Q-dt)<=Ut.EPSILON*Math.max(1,Math.abs(Q),Math.abs(dt))&&Math.abs(ee-Pt)<=Ut.EPSILON*Math.max(1,Math.abs(ee),Math.abs(Pt))&&Math.abs(ie-It)<=Ut.EPSILON*Math.max(1,Math.abs(ie),Math.abs(It))&&Math.abs(oe-zt)<=Ut.EPSILON*Math.max(1,Math.abs(oe),Math.abs(zt))},lt.sub=lt.mul=lt.ortho=lt.perspective=void 0;var Ut=function(u,s){if(u&&u.__esModule)return u;if(u===null||qt(u)!=="object"&&typeof u!="function")return{default:u};var h=rr(void 0);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}(H);function rr(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(rr=function(p){return p?h:s})(u)}function br(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Oe(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=s[8],U=s[9],Z=s[10],Q=s[11],ee=s[12],ie=s[13],oe=s[14],_e=s[15],Se=h[0],xe=h[1],Re=h[2],Te=h[3];return u[0]=Se*p+xe*I+Re*N+Te*ee,u[1]=Se*_+xe*L+Re*U+Te*ie,u[2]=Se*b+xe*k+Re*Z+Te*oe,u[3]=Se*T+xe*F+Re*Q+Te*_e,u[4]=(Se=h[4])*p+(xe=h[5])*I+(Re=h[6])*N+(Te=h[7])*ee,u[5]=Se*_+xe*L+Re*U+Te*ie,u[6]=Se*b+xe*k+Re*Z+Te*oe,u[7]=Se*T+xe*F+Re*Q+Te*_e,u[8]=(Se=h[8])*p+(xe=h[9])*I+(Re=h[10])*N+(Te=h[11])*ee,u[9]=Se*_+xe*L+Re*U+Te*ie,u[10]=Se*b+xe*k+Re*Z+Te*oe,u[11]=Se*T+xe*F+Re*Q+Te*_e,u[12]=(Se=h[12])*p+(xe=h[13])*I+(Re=h[14])*N+(Te=h[15])*ee,u[13]=Se*_+xe*L+Re*U+Te*ie,u[14]=Se*b+xe*k+Re*Z+Te*oe,u[15]=Se*T+xe*F+Re*Q+Te*_e,u}function $e(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=p+p,L=_+_,k=b+b,F=p*I,N=p*L,U=p*k,Z=_*L,Q=_*k,ee=b*k,ie=T*I,oe=T*L,_e=T*k;return u[0]=1-(Z+ee),u[1]=N+_e,u[2]=U-oe,u[3]=0,u[4]=N-_e,u[5]=1-(F+ee),u[6]=Q+ie,u[7]=0,u[8]=U+oe,u[9]=Q-ie,u[10]=1-(F+Z),u[11]=0,u[12]=h[0],u[13]=h[1],u[14]=h[2],u[15]=1,u}function ct(u,s){var h=s[4],p=s[5],_=s[6],b=s[8],T=s[9],I=s[10];return u[0]=Math.hypot(s[0],s[1],s[2]),u[1]=Math.hypot(h,p,_),u[2]=Math.hypot(b,T,I),u}function bt(u,s,h,p,_){var b,T=1/Math.tan(s/2);return u[0]=T/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=T,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,_!=null&&_!==1/0?(u[10]=(_+p)*(b=1/(p-_)),u[14]=2*_*p*b):(u[10]=-1,u[14]=-2*p),u}function At(u,s,h,p,_,b,T){var I=1/(s-h),L=1/(p-_),k=1/(b-T);return u[0]=-2*I,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*L,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*k,u[11]=0,u[12]=(s+h)*I,u[13]=(_+p)*L,u[14]=(T+b)*k,u[15]=1,u}function Jt(u,s,h){return u[0]=s[0]-h[0],u[1]=s[1]-h[1],u[2]=s[2]-h[2],u[3]=s[3]-h[3],u[4]=s[4]-h[4],u[5]=s[5]-h[5],u[6]=s[6]-h[6],u[7]=s[7]-h[7],u[8]=s[8]-h[8],u[9]=s[9]-h[9],u[10]=s[10]-h[10],u[11]=s[11]-h[11],u[12]=s[12]-h[12],u[13]=s[13]-h[13],u[14]=s[14]-h[14],u[15]=s[15]-h[15],u}lt.perspective=bt,lt.ortho=At,lt.mul=Oe,lt.sub=Jt;var mt={},ht={};function er(u){return er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},er(u)}Object.defineProperty(ht,"__esModule",{value:!0}),ht.create=ge,ht.clone=function(u){var s=new Bt.ARRAY_TYPE(3);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s},ht.length=be,ht.fromValues=function(u,s,h){var p=new Bt.ARRAY_TYPE(3);return p[0]=u,p[1]=s,p[2]=h,p},ht.copy=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u},ht.set=function(u,s,h,p){return u[0]=s,u[1]=h,u[2]=p,u},ht.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u[2]=s[2]+h[2],u},ht.subtract=ke,ht.multiply=tt,ht.divide=ut,ht.ceil=function(u,s){return u[0]=Math.ceil(s[0]),u[1]=Math.ceil(s[1]),u[2]=Math.ceil(s[2]),u},ht.floor=function(u,s){return u[0]=Math.floor(s[0]),u[1]=Math.floor(s[1]),u[2]=Math.floor(s[2]),u},ht.min=function(u,s,h){return u[0]=Math.min(s[0],h[0]),u[1]=Math.min(s[1],h[1]),u[2]=Math.min(s[2],h[2]),u},ht.max=function(u,s,h){return u[0]=Math.max(s[0],h[0]),u[1]=Math.max(s[1],h[1]),u[2]=Math.max(s[2],h[2]),u},ht.round=function(u,s){return u[0]=Math.round(s[0]),u[1]=Math.round(s[1]),u[2]=Math.round(s[2]),u},ht.scale=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u[2]=s[2]*h,u},ht.scaleAndAdd=function(u,s,h,p){return u[0]=s[0]+h[0]*p,u[1]=s[1]+h[1]*p,u[2]=s[2]+h[2]*p,u},ht.distance=St,ht.squaredDistance=vt,ht.squaredLength=Ye,ht.negate=function(u,s){return u[0]=-s[0],u[1]=-s[1],u[2]=-s[2],u},ht.inverse=function(u,s){return u[0]=1/s[0],u[1]=1/s[1],u[2]=1/s[2],u},ht.normalize=function(u,s){var h=s[0],p=s[1],_=s[2],b=h*h+p*p+_*_;return b>0&&(b=1/Math.sqrt(b)),u[0]=s[0]*b,u[1]=s[1]*b,u[2]=s[2]*b,u},ht.dot=Dt,ht.cross=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=h[0],I=h[1],L=h[2];return u[0]=_*L-b*I,u[1]=b*T-p*L,u[2]=p*I-_*T,u},ht.lerp=function(u,s,h,p){var _=s[0],b=s[1],T=s[2];return u[0]=_+p*(h[0]-_),u[1]=b+p*(h[1]-b),u[2]=T+p*(h[2]-T),u},ht.hermite=function(u,s,h,p,_,b){var T=b*b,I=T*(2*b-3)+1,L=T*(b-2)+b,k=T*(b-1),F=T*(3-2*b);return u[0]=s[0]*I+h[0]*L+p[0]*k+_[0]*F,u[1]=s[1]*I+h[1]*L+p[1]*k+_[1]*F,u[2]=s[2]*I+h[2]*L+p[2]*k+_[2]*F,u},ht.bezier=function(u,s,h,p,_,b){var T=1-b,I=T*T,L=b*b,k=I*T,F=3*b*I,N=3*L*T,U=L*b;return u[0]=s[0]*k+h[0]*F+p[0]*N+_[0]*U,u[1]=s[1]*k+h[1]*F+p[1]*N+_[1]*U,u[2]=s[2]*k+h[2]*F+p[2]*N+_[2]*U,u},ht.random=function(u,s){s=s||1;var h=2*Bt.RANDOM()*Math.PI,p=2*Bt.RANDOM()-1,_=Math.sqrt(1-p*p)*s;return u[0]=Math.cos(h)*_,u[1]=Math.sin(h)*_,u[2]=p*s,u},ht.transformMat4=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=h[3]*p+h[7]*_+h[11]*b+h[15];return u[0]=(h[0]*p+h[4]*_+h[8]*b+h[12])/(T=T||1),u[1]=(h[1]*p+h[5]*_+h[9]*b+h[13])/T,u[2]=(h[2]*p+h[6]*_+h[10]*b+h[14])/T,u},ht.transformMat3=function(u,s,h){var p=s[0],_=s[1],b=s[2];return u[0]=p*h[0]+_*h[3]+b*h[6],u[1]=p*h[1]+_*h[4]+b*h[7],u[2]=p*h[2]+_*h[5]+b*h[8],u},ht.transformQuat=function(u,s,h){var p=h[0],_=h[1],b=h[2],T=s[0],I=s[1],L=s[2],k=_*L-b*I,F=b*T-p*L,N=p*I-_*T,U=_*N-b*F,Z=b*k-p*N,Q=p*F-_*k,ee=2*h[3];return F*=ee,N*=ee,Z*=2,Q*=2,u[0]=T+(k*=ee)+(U*=2),u[1]=I+F+Z,u[2]=L+N+Q,u},ht.rotateX=function(u,s,h,p){var _=[],b=[];return _[0]=s[0]-h[0],_[1]=s[1]-h[1],_[2]=s[2]-h[2],b[0]=_[0],b[1]=_[1]*Math.cos(p)-_[2]*Math.sin(p),b[2]=_[1]*Math.sin(p)+_[2]*Math.cos(p),u[0]=b[0]+h[0],u[1]=b[1]+h[1],u[2]=b[2]+h[2],u},ht.rotateY=function(u,s,h,p){var _=[],b=[];return _[0]=s[0]-h[0],_[1]=s[1]-h[1],_[2]=s[2]-h[2],b[0]=_[2]*Math.sin(p)+_[0]*Math.cos(p),b[1]=_[1],b[2]=_[2]*Math.cos(p)-_[0]*Math.sin(p),u[0]=b[0]+h[0],u[1]=b[1]+h[1],u[2]=b[2]+h[2],u},ht.rotateZ=function(u,s,h,p){var _=[],b=[];return _[0]=s[0]-h[0],_[1]=s[1]-h[1],_[2]=s[2]-h[2],b[0]=_[0]*Math.cos(p)-_[1]*Math.sin(p),b[1]=_[0]*Math.sin(p)+_[1]*Math.cos(p),b[2]=_[2],u[0]=b[0]+h[0],u[1]=b[1]+h[1],u[2]=b[2]+h[2],u},ht.angle=function(u,s){var h=u[0],p=u[1],_=u[2],b=s[0],T=s[1],I=s[2],L=Math.sqrt(h*h+p*p+_*_)*Math.sqrt(b*b+T*T+I*I),k=L&&Dt(u,s)/L;return Math.acos(Math.min(Math.max(k,-1),1))},ht.zero=function(u){return u[0]=0,u[1]=0,u[2]=0,u},ht.str=function(u){return"vec3("+u[0]+", "+u[1]+", "+u[2]+")"},ht.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]},ht.equals=function(u,s){var h=u[0],p=u[1],_=u[2],b=s[0],T=s[1],I=s[2];return Math.abs(h-b)<=Bt.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(p-T)<=Bt.EPSILON*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(_-I)<=Bt.EPSILON*Math.max(1,Math.abs(_),Math.abs(I))},ht.forEach=ht.sqrLen=ht.len=ht.sqrDist=ht.dist=ht.div=ht.mul=ht.sub=void 0;var Bt=function(u,s){if(u&&u.__esModule)return u;if(u===null||er(u)!=="object"&&typeof u!="function")return{default:u};var h=qe(void 0);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}(H);function qe(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(qe=function(p){return p?h:s})(u)}function ge(){var u=new Bt.ARRAY_TYPE(3);return Bt.ARRAY_TYPE!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function be(u){return Math.hypot(u[0],u[1],u[2])}function ke(u,s,h){return u[0]=s[0]-h[0],u[1]=s[1]-h[1],u[2]=s[2]-h[2],u}function tt(u,s,h){return u[0]=s[0]*h[0],u[1]=s[1]*h[1],u[2]=s[2]*h[2],u}function ut(u,s,h){return u[0]=s[0]/h[0],u[1]=s[1]/h[1],u[2]=s[2]/h[2],u}function St(u,s){return Math.hypot(s[0]-u[0],s[1]-u[1],s[2]-u[2])}function vt(u,s){var h=s[0]-u[0],p=s[1]-u[1],_=s[2]-u[2];return h*h+p*p+_*_}function Ye(u){var s=u[0],h=u[1],p=u[2];return s*s+h*h+p*p}function Dt(u,s){return u[0]*s[0]+u[1]*s[1]+u[2]*s[2]}ht.sub=ke,ht.mul=tt,ht.div=ut,ht.dist=St,ht.sqrDist=vt,ht.len=be,ht.sqrLen=Ye;var Vt,jt=(Vt=ge(),function(u,s,h,p,_,b){var T,I;for(s||(s=3),h||(h=0),I=p?Math.min(p*s+h,u.length):u.length,T=h;T<I;T+=s)Vt[0]=u[T],Vt[1]=u[T+1],Vt[2]=u[T+2],_(Vt,Vt,b),u[T]=Vt[0],u[T+1]=Vt[1],u[T+2]=Vt[2];return u});ht.forEach=jt;var Yt={};function Nr(u){return Nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Nr(u)}Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.create=jn,Yt.clone=function(u){var s=new Qr.ARRAY_TYPE(4);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s},Yt.fromValues=function(u,s,h,p){var _=new Qr.ARRAY_TYPE(4);return _[0]=u,_[1]=s,_[2]=h,_[3]=p,_},Yt.copy=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u},Yt.set=function(u,s,h,p,_){return u[0]=s,u[1]=h,u[2]=p,u[3]=_,u},Yt.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u[2]=s[2]+h[2],u[3]=s[3]+h[3],u},Yt.subtract=Wn,Yt.multiply=ai,Yt.divide=Si,Yt.ceil=function(u,s){return u[0]=Math.ceil(s[0]),u[1]=Math.ceil(s[1]),u[2]=Math.ceil(s[2]),u[3]=Math.ceil(s[3]),u},Yt.floor=function(u,s){return u[0]=Math.floor(s[0]),u[1]=Math.floor(s[1]),u[2]=Math.floor(s[2]),u[3]=Math.floor(s[3]),u},Yt.min=function(u,s,h){return u[0]=Math.min(s[0],h[0]),u[1]=Math.min(s[1],h[1]),u[2]=Math.min(s[2],h[2]),u[3]=Math.min(s[3],h[3]),u},Yt.max=function(u,s,h){return u[0]=Math.max(s[0],h[0]),u[1]=Math.max(s[1],h[1]),u[2]=Math.max(s[2],h[2]),u[3]=Math.max(s[3],h[3]),u},Yt.round=function(u,s){return u[0]=Math.round(s[0]),u[1]=Math.round(s[1]),u[2]=Math.round(s[2]),u[3]=Math.round(s[3]),u},Yt.scale=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u[2]=s[2]*h,u[3]=s[3]*h,u},Yt.scaleAndAdd=function(u,s,h,p){return u[0]=s[0]+h[0]*p,u[1]=s[1]+h[1]*p,u[2]=s[2]+h[2]*p,u[3]=s[3]+h[3]*p,u},Yt.distance=pa,Yt.squaredDistance=Ii,Yt.length=po,Yt.squaredLength=no,Yt.negate=function(u,s){return u[0]=-s[0],u[1]=-s[1],u[2]=-s[2],u[3]=-s[3],u},Yt.inverse=function(u,s){return u[0]=1/s[0],u[1]=1/s[1],u[2]=1/s[2],u[3]=1/s[3],u},Yt.normalize=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=h*h+p*p+_*_+b*b;return T>0&&(T=1/Math.sqrt(T)),u[0]=h*T,u[1]=p*T,u[2]=_*T,u[3]=b*T,u},Yt.dot=function(u,s){return u[0]*s[0]+u[1]*s[1]+u[2]*s[2]+u[3]*s[3]},Yt.cross=function(u,s,h,p){var _=h[0]*p[1]-h[1]*p[0],b=h[0]*p[2]-h[2]*p[0],T=h[0]*p[3]-h[3]*p[0],I=h[1]*p[2]-h[2]*p[1],L=h[1]*p[3]-h[3]*p[1],k=h[2]*p[3]-h[3]*p[2],F=s[0],N=s[1],U=s[2],Z=s[3];return u[0]=N*k-U*L+Z*I,u[1]=-F*k+U*T-Z*b,u[2]=F*L-N*T+Z*_,u[3]=-F*I+N*b-U*_,u},Yt.lerp=function(u,s,h,p){var _=s[0],b=s[1],T=s[2],I=s[3];return u[0]=_+p*(h[0]-_),u[1]=b+p*(h[1]-b),u[2]=T+p*(h[2]-T),u[3]=I+p*(h[3]-I),u},Yt.random=function(u,s){var h,p,_,b,T,I;s=s||1;do T=(h=2*Qr.RANDOM()-1)*h+(p=2*Qr.RANDOM()-1)*p;while(T>=1);do I=(_=2*Qr.RANDOM()-1)*_+(b=2*Qr.RANDOM()-1)*b;while(I>=1);var L=Math.sqrt((1-T)/I);return u[0]=s*h,u[1]=s*p,u[2]=s*_*L,u[3]=s*b*L,u},Yt.transformMat4=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3];return u[0]=h[0]*p+h[4]*_+h[8]*b+h[12]*T,u[1]=h[1]*p+h[5]*_+h[9]*b+h[13]*T,u[2]=h[2]*p+h[6]*_+h[10]*b+h[14]*T,u[3]=h[3]*p+h[7]*_+h[11]*b+h[15]*T,u},Yt.transformQuat=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=h[0],I=h[1],L=h[2],k=h[3],F=k*p+I*b-L*_,N=k*_+L*p-T*b,U=k*b+T*_-I*p,Z=-T*p-I*_-L*b;return u[0]=F*k+Z*-T+N*-L-U*-I,u[1]=N*k+Z*-I+U*-T-F*-L,u[2]=U*k+Z*-L+F*-I-N*-T,u[3]=s[3],u},Yt.zero=function(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=0,u},Yt.str=function(u){return"vec4("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")"},Yt.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]},Yt.equals=function(u,s){var h=u[0],p=u[1],_=u[2],b=u[3],T=s[0],I=s[1],L=s[2],k=s[3];return Math.abs(h-T)<=Qr.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(p-I)<=Qr.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(_-L)<=Qr.EPSILON*Math.max(1,Math.abs(_),Math.abs(L))&&Math.abs(b-k)<=Qr.EPSILON*Math.max(1,Math.abs(b),Math.abs(k))},Yt.forEach=Yt.sqrLen=Yt.len=Yt.sqrDist=Yt.dist=Yt.div=Yt.mul=Yt.sub=void 0;var Qr=function(u,s){if(u&&u.__esModule)return u;if(u===null||Nr(u)!=="object"&&typeof u!="function")return{default:u};var h=xn(void 0);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}(H);function xn(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(xn=function(p){return p?h:s})(u)}function jn(){var u=new Qr.ARRAY_TYPE(4);return Qr.ARRAY_TYPE!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[3]=0),u}function Wn(u,s,h){return u[0]=s[0]-h[0],u[1]=s[1]-h[1],u[2]=s[2]-h[2],u[3]=s[3]-h[3],u}function ai(u,s,h){return u[0]=s[0]*h[0],u[1]=s[1]*h[1],u[2]=s[2]*h[2],u[3]=s[3]*h[3],u}function Si(u,s,h){return u[0]=s[0]/h[0],u[1]=s[1]/h[1],u[2]=s[2]/h[2],u[3]=s[3]/h[3],u}function pa(u,s){return Math.hypot(s[0]-u[0],s[1]-u[1],s[2]-u[2],s[3]-u[3])}function Ii(u,s){var h=s[0]-u[0],p=s[1]-u[1],_=s[2]-u[2],b=s[3]-u[3];return h*h+p*p+_*_+b*b}function po(u){return Math.hypot(u[0],u[1],u[2],u[3])}function no(u){var s=u[0],h=u[1],p=u[2],_=u[3];return s*s+h*h+p*p+_*_}Yt.sub=Wn,Yt.mul=ai,Yt.div=Si,Yt.dist=pa,Yt.sqrDist=Ii,Yt.len=po,Yt.sqrLen=no;var Ds=function(){var u=jn();return function(s,h,p,_,b,T){var I,L;for(h||(h=4),p||(p=0),L=_?Math.min(_*h+p,s.length):s.length,I=p;I<L;I+=h)u[0]=s[I],u[1]=s[I+1],u[2]=s[I+2],u[3]=s[I+3],b(u,u,T),s[I]=u[0],s[I+1]=u[1],s[I+2]=u[2],s[I+3]=u[3];return s}}();function sa(u){return sa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},sa(u)}Yt.forEach=Ds,Object.defineProperty(mt,"__esModule",{value:!0}),mt.create=or,mt.identity=function(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u},mt.setAxisAngle=sr,mt.getAxisAngle=function(u,s){var h=2*Math.acos(s[3]),p=Math.sin(h/2);return p>Ni.EPSILON?(u[0]=s[0]/p,u[1]=s[1]/p,u[2]=s[2]/p):(u[0]=1,u[1]=0,u[2]=0),h},mt.getAngle=function(u,s){var h=hi(u,s);return Math.acos(2*h*h-1)},mt.multiply=Kt,mt.rotateX=function(u,s,h){h*=.5;var p=s[0],_=s[1],b=s[2],T=s[3],I=Math.sin(h),L=Math.cos(h);return u[0]=p*L+T*I,u[1]=_*L+b*I,u[2]=b*L-_*I,u[3]=T*L-p*I,u},mt.rotateY=function(u,s,h){h*=.5;var p=s[0],_=s[1],b=s[2],T=s[3],I=Math.sin(h),L=Math.cos(h);return u[0]=p*L-b*I,u[1]=_*L+T*I,u[2]=b*L+p*I,u[3]=T*L-_*I,u},mt.rotateZ=function(u,s,h){h*=.5;var p=s[0],_=s[1],b=s[2],T=s[3],I=Math.sin(h),L=Math.cos(h);return u[0]=p*L+_*I,u[1]=_*L-p*I,u[2]=b*L+T*I,u[3]=T*L-b*I,u},mt.calculateW=function(u,s){var h=s[0],p=s[1],_=s[2];return u[0]=h,u[1]=p,u[2]=_,u[3]=Math.sqrt(Math.abs(1-h*h-p*p-_*_)),u},mt.exp=hr,mt.ln=tr,mt.pow=function(u,s,h){return tr(u,s),Tr(u,u,h),hr(u,u),u},mt.slerp=Hr,mt.random=function(u){var s=Ni.RANDOM(),h=Ni.RANDOM(),p=Ni.RANDOM(),_=Math.sqrt(1-s),b=Math.sqrt(s);return u[0]=_*Math.sin(2*Math.PI*h),u[1]=_*Math.cos(2*Math.PI*h),u[2]=b*Math.sin(2*Math.PI*p),u[3]=b*Math.cos(2*Math.PI*p),u},mt.invert=function(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=h*h+p*p+_*_+b*b,I=T?1/T:0;return u[0]=-h*I,u[1]=-p*I,u[2]=-_*I,u[3]=b*I,u},mt.conjugate=function(u,s){return u[0]=-s[0],u[1]=-s[1],u[2]=-s[2],u[3]=s[3],u},mt.fromMat3=Dn,mt.fromEuler=function(u,s,h,p){var _=.5*Math.PI/180;s*=_,h*=_,p*=_;var b=Math.sin(s),T=Math.cos(s),I=Math.sin(h),L=Math.cos(h),k=Math.sin(p),F=Math.cos(p);return u[0]=b*L*F-T*I*k,u[1]=T*I*F+b*L*k,u[2]=T*L*k-b*I*F,u[3]=T*L*F+b*I*k,u},mt.str=function(u){return"quat("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")"},mt.setAxes=mt.sqlerp=mt.rotationTo=mt.equals=mt.exactEquals=mt.normalize=mt.sqrLen=mt.squaredLength=mt.len=mt.length=mt.lerp=mt.dot=mt.scale=mt.mul=mt.add=mt.set=mt.copy=mt.fromValues=mt.clone=void 0;var Ni=Xt(H),Ct=Xt(We),Mt=Xt(ht),Ft=Xt(Yt);function Qt(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(Qt=function(p){return p?h:s})(u)}function Xt(u,s){if(u&&u.__esModule)return u;if(u===null||sa(u)!=="object"&&typeof u!="function")return{default:u};var h=Qt(s);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}function or(){var u=new Ni.ARRAY_TYPE(4);return Ni.ARRAY_TYPE!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function sr(u,s,h){h*=.5;var p=Math.sin(h);return u[0]=p*s[0],u[1]=p*s[1],u[2]=p*s[2],u[3]=Math.cos(h),u}function Kt(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=h[0],L=h[1],k=h[2],F=h[3];return u[0]=p*F+T*I+_*k-b*L,u[1]=_*F+T*L+b*I-p*k,u[2]=b*F+T*k+p*L-_*I,u[3]=T*F-p*I-_*L-b*k,u}function hr(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=Math.sqrt(h*h+p*p+_*_),I=Math.exp(b),L=T>0?I*Math.sin(T)/T:0;return u[0]=h*L,u[1]=p*L,u[2]=_*L,u[3]=I*Math.cos(T),u}function tr(u,s){var h=s[0],p=s[1],_=s[2],b=s[3],T=Math.sqrt(h*h+p*p+_*_),I=T>0?Math.atan2(T,b)/T:0;return u[0]=h*I,u[1]=p*I,u[2]=_*I,u[3]=.5*Math.log(h*h+p*p+_*_+b*b),u}function Hr(u,s,h,p){var _,b,T,I,L,k=s[0],F=s[1],N=s[2],U=s[3],Z=h[0],Q=h[1],ee=h[2],ie=h[3];return(b=k*Z+F*Q+N*ee+U*ie)<0&&(b=-b,Z=-Z,Q=-Q,ee=-ee,ie=-ie),1-b>Ni.EPSILON?(_=Math.acos(b),T=Math.sin(_),I=Math.sin((1-p)*_)/T,L=Math.sin(p*_)/T):(I=1-p,L=p),u[0]=I*k+L*Z,u[1]=I*F+L*Q,u[2]=I*N+L*ee,u[3]=I*U+L*ie,u}function Dn(u,s){var h,p=s[0]+s[4]+s[8];if(p>0)h=Math.sqrt(p+1),u[3]=.5*h,u[0]=(s[5]-s[7])*(h=.5/h),u[1]=(s[6]-s[2])*h,u[2]=(s[1]-s[3])*h;else{var _=0;s[4]>s[0]&&(_=1),s[8]>s[3*_+_]&&(_=2);var b=(_+1)%3,T=(_+2)%3;h=Math.sqrt(s[3*_+_]-s[3*b+b]-s[3*T+T]+1),u[_]=.5*h,u[3]=(s[3*b+T]-s[3*T+b])*(h=.5/h),u[b]=(s[3*b+_]+s[3*_+b])*h,u[T]=(s[3*T+_]+s[3*_+T])*h}return u}mt.clone=Ft.clone,mt.fromValues=Ft.fromValues,mt.copy=Ft.copy,mt.set=Ft.set,mt.add=Ft.add,mt.mul=Kt;var Tr=Ft.scale;mt.scale=Tr;var hi=Ft.dot;mt.dot=hi,mt.lerp=Ft.lerp;var Vi=Ft.length;mt.length=Vi,mt.len=Vi;var yi=Ft.squaredLength;mt.squaredLength=yi,mt.sqrLen=yi;var Ki=Ft.normalize;mt.normalize=Ki,mt.exactEquals=Ft.exactEquals,mt.equals=Ft.equals;var Zi,Bn,Uo,Ps=(Zi=Mt.create(),Bn=Mt.fromValues(1,0,0),Uo=Mt.fromValues(0,1,0),function(u,s,h){var p=Mt.dot(s,h);return p<-.999999?(Mt.cross(Zi,Bn,s),Mt.len(Zi)<1e-6&&Mt.cross(Zi,Uo,s),Mt.normalize(Zi,Zi),sr(u,Zi,Math.PI),u):p>.999999?(u[0]=0,u[1]=0,u[2]=0,u[3]=1,u):(Mt.cross(Zi,s,h),u[0]=Zi[0],u[1]=Zi[1],u[2]=Zi[2],u[3]=1+p,Ki(u,u))});mt.rotationTo=Ps;var Da,xc,Dd=(Da=or(),xc=or(),function(u,s,h,p,_,b){return Hr(Da,s,_,b),Hr(xc,h,p,b),Hr(u,Da,xc,2*b*(1-b)),u});mt.sqlerp=Dd;var go,UI=(go=Ct.create(),function(u,s,h,p){return go[0]=h[0],go[3]=h[1],go[6]=h[2],go[1]=p[0],go[4]=p[1],go[7]=p[2],go[2]=-s[0],go[5]=-s[1],go[8]=-s[2],Ki(u,Dn(u,go))});mt.setAxes=UI;var bn={};function by(u){return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},by(u)}Object.defineProperty(bn,"__esModule",{value:!0}),bn.create=function(){var u=new vo.ARRAY_TYPE(8);return vo.ARRAY_TYPE!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[4]=0,u[5]=0,u[6]=0,u[7]=0),u[3]=1,u},bn.clone=function(u){var s=new vo.ARRAY_TYPE(8);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s[6]=u[6],s[7]=u[7],s},bn.fromValues=function(u,s,h,p,_,b,T,I){var L=new vo.ARRAY_TYPE(8);return L[0]=u,L[1]=s,L[2]=h,L[3]=p,L[4]=_,L[5]=b,L[6]=T,L[7]=I,L},bn.fromRotationTranslationValues=function(u,s,h,p,_,b,T){var I=new vo.ARRAY_TYPE(8);I[0]=u,I[1]=s,I[2]=h,I[3]=p;var L=.5*_,k=.5*b,F=.5*T;return I[4]=L*p+k*h-F*s,I[5]=k*p+F*u-L*h,I[6]=F*p+L*s-k*u,I[7]=-L*u-k*s-F*h,I},bn.fromRotationTranslation=qb,bn.fromTranslation=function(u,s){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u[4]=.5*s[0],u[5]=.5*s[1],u[6]=.5*s[2],u[7]=0,u},bn.fromRotation=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[4]=0,u[5]=0,u[6]=0,u[7]=0,u},bn.fromMat4=function(u,s){var h=Gl.create();Wb.getRotation(h,s);var p=new vo.ARRAY_TYPE(3);return Wb.getTranslation(p,s),qb(u,h,p),u},bn.copy=Yb,bn.identity=function(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u[4]=0,u[5]=0,u[6]=0,u[7]=0,u},bn.set=function(u,s,h,p,_,b,T,I,L){return u[0]=s,u[1]=h,u[2]=p,u[3]=_,u[4]=b,u[5]=T,u[6]=I,u[7]=L,u},bn.getDual=function(u,s){return u[0]=s[4],u[1]=s[5],u[2]=s[6],u[3]=s[7],u},bn.setDual=function(u,s){return u[4]=s[0],u[5]=s[1],u[6]=s[2],u[7]=s[3],u},bn.getTranslation=function(u,s){var h=s[4],p=s[5],_=s[6],b=s[7],T=-s[0],I=-s[1],L=-s[2],k=s[3];return u[0]=2*(h*k+b*T+p*L-_*I),u[1]=2*(p*k+b*I+_*T-h*L),u[2]=2*(_*k+b*L+h*I-p*T),u},bn.translate=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=.5*h[0],L=.5*h[1],k=.5*h[2],F=s[4],N=s[5],U=s[6],Z=s[7];return u[0]=p,u[1]=_,u[2]=b,u[3]=T,u[4]=T*I+_*k-b*L+F,u[5]=T*L+b*I-p*k+N,u[6]=T*k+p*L-_*I+U,u[7]=-p*I-_*L-b*k+Z,u},bn.rotateX=function(u,s,h){var p=-s[0],_=-s[1],b=-s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=I*T+F*p+L*b-k*_,U=L*T+F*_+k*p-I*b,Z=k*T+F*b+I*_-L*p,Q=F*T-I*p-L*_-k*b;return Gl.rotateX(u,s,h),u[4]=N*(T=u[3])+Q*(p=u[0])+U*(b=u[2])-Z*(_=u[1]),u[5]=U*T+Q*_+Z*p-N*b,u[6]=Z*T+Q*b+N*_-U*p,u[7]=Q*T-N*p-U*_-Z*b,u},bn.rotateY=function(u,s,h){var p=-s[0],_=-s[1],b=-s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=I*T+F*p+L*b-k*_,U=L*T+F*_+k*p-I*b,Z=k*T+F*b+I*_-L*p,Q=F*T-I*p-L*_-k*b;return Gl.rotateY(u,s,h),u[4]=N*(T=u[3])+Q*(p=u[0])+U*(b=u[2])-Z*(_=u[1]),u[5]=U*T+Q*_+Z*p-N*b,u[6]=Z*T+Q*b+N*_-U*p,u[7]=Q*T-N*p-U*_-Z*b,u},bn.rotateZ=function(u,s,h){var p=-s[0],_=-s[1],b=-s[2],T=s[3],I=s[4],L=s[5],k=s[6],F=s[7],N=I*T+F*p+L*b-k*_,U=L*T+F*_+k*p-I*b,Z=k*T+F*b+I*_-L*p,Q=F*T-I*p-L*_-k*b;return Gl.rotateZ(u,s,h),u[4]=N*(T=u[3])+Q*(p=u[0])+U*(b=u[2])-Z*(_=u[1]),u[5]=U*T+Q*_+Z*p-N*b,u[6]=Z*T+Q*b+N*_-U*p,u[7]=Q*T-N*p-U*_-Z*b,u},bn.rotateByQuatAppend=function(u,s,h){var p=h[0],_=h[1],b=h[2],T=h[3],I=s[0],L=s[1],k=s[2],F=s[3];return u[0]=I*T+F*p+L*b-k*_,u[1]=L*T+F*_+k*p-I*b,u[2]=k*T+F*b+I*_-L*p,u[3]=F*T-I*p-L*_-k*b,u[4]=(I=s[4])*T+(F=s[7])*p+(L=s[5])*b-(k=s[6])*_,u[5]=L*T+F*_+k*p-I*b,u[6]=k*T+F*b+I*_-L*p,u[7]=F*T-I*p-L*_-k*b,u},bn.rotateByQuatPrepend=function(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=h[0],L=h[1],k=h[2],F=h[3];return u[0]=p*F+T*I+_*k-b*L,u[1]=_*F+T*L+b*I-p*k,u[2]=b*F+T*k+p*L-_*I,u[3]=T*F-p*I-_*L-b*k,u[4]=p*(F=h[7])+T*(I=h[4])+_*(k=h[6])-b*(L=h[5]),u[5]=_*F+T*L+b*I-p*k,u[6]=b*F+T*k+p*L-_*I,u[7]=T*F-p*I-_*L-b*k,u},bn.rotateAroundAxis=function(u,s,h,p){if(Math.abs(p)<vo.EPSILON)return Yb(u,s);var _=Math.hypot(h[0],h[1],h[2]);p*=.5;var b=Math.sin(p),T=b*h[0]/_,I=b*h[1]/_,L=b*h[2]/_,k=Math.cos(p),F=s[0],N=s[1],U=s[2],Z=s[3];u[0]=F*k+Z*T+N*L-U*I,u[1]=N*k+Z*I+U*T-F*L,u[2]=U*k+Z*L+F*I-N*T,u[3]=Z*k-F*T-N*I-U*L;var Q=s[4],ee=s[5],ie=s[6],oe=s[7];return u[4]=Q*k+oe*T+ee*L-ie*I,u[5]=ee*k+oe*I+ie*T-Q*L,u[6]=ie*k+oe*L+Q*I-ee*T,u[7]=oe*k-Q*T-ee*I-ie*L,u},bn.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u[2]=s[2]+h[2],u[3]=s[3]+h[3],u[4]=s[4]+h[4],u[5]=s[5]+h[5],u[6]=s[6]+h[6],u[7]=s[7]+h[7],u},bn.multiply=Xb,bn.scale=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u[2]=s[2]*h,u[3]=s[3]*h,u[4]=s[4]*h,u[5]=s[5]*h,u[6]=s[6]*h,u[7]=s[7]*h,u},bn.lerp=function(u,s,h,p){var _=1-p;return Qb(s,h)<0&&(p=-p),u[0]=s[0]*_+h[0]*p,u[1]=s[1]*_+h[1]*p,u[2]=s[2]*_+h[2]*p,u[3]=s[3]*_+h[3]*p,u[4]=s[4]*_+h[4]*p,u[5]=s[5]*_+h[5]*p,u[6]=s[6]*_+h[6]*p,u[7]=s[7]*_+h[7]*p,u},bn.invert=function(u,s){var h=_v(s);return u[0]=-s[0]/h,u[1]=-s[1]/h,u[2]=-s[2]/h,u[3]=s[3]/h,u[4]=-s[4]/h,u[5]=-s[5]/h,u[6]=-s[6]/h,u[7]=s[7]/h,u},bn.conjugate=function(u,s){return u[0]=-s[0],u[1]=-s[1],u[2]=-s[2],u[3]=s[3],u[4]=-s[4],u[5]=-s[5],u[6]=-s[6],u[7]=s[7],u},bn.normalize=function(u,s){var h=_v(s);if(h>0){h=Math.sqrt(h);var p=s[0]/h,_=s[1]/h,b=s[2]/h,T=s[3]/h,I=s[4],L=s[5],k=s[6],F=s[7],N=p*I+_*L+b*k+T*F;u[0]=p,u[1]=_,u[2]=b,u[3]=T,u[4]=(I-p*N)/h,u[5]=(L-_*N)/h,u[6]=(k-b*N)/h,u[7]=(F-T*N)/h}return u},bn.str=function(u){return"quat2("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+", "+u[4]+", "+u[5]+", "+u[6]+", "+u[7]+")"},bn.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]&&u[4]===s[4]&&u[5]===s[5]&&u[6]===s[6]&&u[7]===s[7]},bn.equals=function(u,s){var h=u[0],p=u[1],_=u[2],b=u[3],T=u[4],I=u[5],L=u[6],k=u[7],F=s[0],N=s[1],U=s[2],Z=s[3],Q=s[4],ee=s[5],ie=s[6],oe=s[7];return Math.abs(h-F)<=vo.EPSILON*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(p-N)<=vo.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(_-U)<=vo.EPSILON*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(b-Z)<=vo.EPSILON*Math.max(1,Math.abs(b),Math.abs(Z))&&Math.abs(T-Q)<=vo.EPSILON*Math.max(1,Math.abs(T),Math.abs(Q))&&Math.abs(I-ee)<=vo.EPSILON*Math.max(1,Math.abs(I),Math.abs(ee))&&Math.abs(L-ie)<=vo.EPSILON*Math.max(1,Math.abs(L),Math.abs(ie))&&Math.abs(k-oe)<=vo.EPSILON*Math.max(1,Math.abs(k),Math.abs(oe))},bn.sqrLen=bn.squaredLength=bn.len=bn.length=bn.dot=bn.mul=bn.setReal=bn.getReal=void 0;var vo=wy(H),Gl=wy(mt),Wb=wy(lt);function Zb(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(Zb=function(p){return p?h:s})(u)}function wy(u,s){if(u&&u.__esModule)return u;if(u===null||by(u)!=="object"&&typeof u!="function")return{default:u};var h=Zb(s);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}function qb(u,s,h){var p=.5*h[0],_=.5*h[1],b=.5*h[2],T=s[0],I=s[1],L=s[2],k=s[3];return u[0]=T,u[1]=I,u[2]=L,u[3]=k,u[4]=p*k+_*L-b*I,u[5]=_*k+b*T-p*L,u[6]=b*k+p*I-_*T,u[7]=-p*T-_*I-b*L,u}function Yb(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[4]=s[4],u[5]=s[5],u[6]=s[6],u[7]=s[7],u}function Xb(u,s,h){var p=s[0],_=s[1],b=s[2],T=s[3],I=h[4],L=h[5],k=h[6],F=h[7],N=s[4],U=s[5],Z=s[6],Q=s[7],ee=h[0],ie=h[1],oe=h[2],_e=h[3];return u[0]=p*_e+T*ee+_*oe-b*ie,u[1]=_*_e+T*ie+b*ee-p*oe,u[2]=b*_e+T*oe+p*ie-_*ee,u[3]=T*_e-p*ee-_*ie-b*oe,u[4]=p*F+T*I+_*k-b*L+N*_e+Q*ee+U*oe-Z*ie,u[5]=_*F+T*L+b*I-p*k+U*_e+Q*ie+Z*ee-N*oe,u[6]=b*F+T*k+p*L-_*I+Z*_e+Q*oe+N*ie-U*ee,u[7]=T*F-p*I-_*L-b*k+Q*_e-N*ee-U*ie-Z*oe,u}bn.getReal=Gl.copy,bn.setReal=Gl.copy,bn.mul=Xb;var Qb=Gl.dot;bn.dot=Qb;var Kb=Gl.length;bn.length=Kb,bn.len=Kb;var _v=Gl.squaredLength;bn.squaredLength=_v,bn.sqrLen=_v;var rn={};function Sy(u){return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Sy(u)}Object.defineProperty(rn,"__esModule",{value:!0}),rn.create=ew,rn.clone=function(u){var s=new bc.ARRAY_TYPE(2);return s[0]=u[0],s[1]=u[1],s},rn.fromValues=function(u,s){var h=new bc.ARRAY_TYPE(2);return h[0]=u,h[1]=s,h},rn.copy=function(u,s){return u[0]=s[0],u[1]=s[1],u},rn.set=function(u,s,h){return u[0]=s,u[1]=h,u},rn.add=function(u,s,h){return u[0]=s[0]+h[0],u[1]=s[1]+h[1],u},rn.subtract=tw,rn.multiply=rw,rn.divide=nw,rn.ceil=function(u,s){return u[0]=Math.ceil(s[0]),u[1]=Math.ceil(s[1]),u},rn.floor=function(u,s){return u[0]=Math.floor(s[0]),u[1]=Math.floor(s[1]),u},rn.min=function(u,s,h){return u[0]=Math.min(s[0],h[0]),u[1]=Math.min(s[1],h[1]),u},rn.max=function(u,s,h){return u[0]=Math.max(s[0],h[0]),u[1]=Math.max(s[1],h[1]),u},rn.round=function(u,s){return u[0]=Math.round(s[0]),u[1]=Math.round(s[1]),u},rn.scale=function(u,s,h){return u[0]=s[0]*h,u[1]=s[1]*h,u},rn.scaleAndAdd=function(u,s,h,p){return u[0]=s[0]+h[0]*p,u[1]=s[1]+h[1]*p,u},rn.distance=iw,rn.squaredDistance=aw,rn.length=ow,rn.squaredLength=yv,rn.negate=function(u,s){return u[0]=-s[0],u[1]=-s[1],u},rn.inverse=function(u,s){return u[0]=1/s[0],u[1]=1/s[1],u},rn.normalize=function(u,s){var h=s[0],p=s[1],_=h*h+p*p;return _>0&&(_=1/Math.sqrt(_)),u[0]=s[0]*_,u[1]=s[1]*_,u},rn.dot=function(u,s){return u[0]*s[0]+u[1]*s[1]},rn.cross=function(u,s,h){var p=s[0]*h[1]-s[1]*h[0];return u[0]=u[1]=0,u[2]=p,u},rn.lerp=function(u,s,h,p){var _=s[0],b=s[1];return u[0]=_+p*(h[0]-_),u[1]=b+p*(h[1]-b),u},rn.random=function(u,s){s=s||1;var h=2*bc.RANDOM()*Math.PI;return u[0]=Math.cos(h)*s,u[1]=Math.sin(h)*s,u},rn.transformMat2=function(u,s,h){var p=s[0],_=s[1];return u[0]=h[0]*p+h[2]*_,u[1]=h[1]*p+h[3]*_,u},rn.transformMat2d=function(u,s,h){var p=s[0],_=s[1];return u[0]=h[0]*p+h[2]*_+h[4],u[1]=h[1]*p+h[3]*_+h[5],u},rn.transformMat3=function(u,s,h){var p=s[0],_=s[1];return u[0]=h[0]*p+h[3]*_+h[6],u[1]=h[1]*p+h[4]*_+h[7],u},rn.transformMat4=function(u,s,h){var p=s[0],_=s[1];return u[0]=h[0]*p+h[4]*_+h[12],u[1]=h[1]*p+h[5]*_+h[13],u},rn.rotate=function(u,s,h,p){var _=s[0]-h[0],b=s[1]-h[1],T=Math.sin(p),I=Math.cos(p);return u[0]=_*I-b*T+h[0],u[1]=_*T+b*I+h[1],u},rn.angle=function(u,s){var h=u[0],p=u[1],_=s[0],b=s[1],T=Math.sqrt(h*h+p*p)*Math.sqrt(_*_+b*b);return Math.acos(Math.min(Math.max(T&&(h*_+p*b)/T,-1),1))},rn.zero=function(u){return u[0]=0,u[1]=0,u},rn.str=function(u){return"vec2("+u[0]+", "+u[1]+")"},rn.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]},rn.equals=function(u,s){var h=u[0],p=u[1],_=s[0],b=s[1];return Math.abs(h-_)<=bc.EPSILON*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(p-b)<=bc.EPSILON*Math.max(1,Math.abs(p),Math.abs(b))},rn.forEach=rn.sqrLen=rn.sqrDist=rn.dist=rn.div=rn.mul=rn.sub=rn.len=void 0;var bc=function(u,s){if(u&&u.__esModule)return u;if(u===null||Sy(u)!=="object"&&typeof u!="function")return{default:u};var h=Jb(void 0);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}(H);function Jb(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(Jb=function(p){return p?h:s})(u)}function ew(){var u=new bc.ARRAY_TYPE(2);return bc.ARRAY_TYPE!=Float32Array&&(u[0]=0,u[1]=0),u}function tw(u,s,h){return u[0]=s[0]-h[0],u[1]=s[1]-h[1],u}function rw(u,s,h){return u[0]=s[0]*h[0],u[1]=s[1]*h[1],u}function nw(u,s,h){return u[0]=s[0]/h[0],u[1]=s[1]/h[1],u}function iw(u,s){return Math.hypot(s[0]-u[0],s[1]-u[1])}function aw(u,s){var h=s[0]-u[0],p=s[1]-u[1];return h*h+p*p}function ow(u){return Math.hypot(u[0],u[1])}function yv(u){var s=u[0],h=u[1];return s*s+h*h}rn.len=ow,rn.sub=tw,rn.mul=rw,rn.div=nw,rn.dist=iw,rn.sqrDist=aw,rn.sqrLen=yv;var $I=function(){var u=ew();return function(s,h,p,_,b,T){var I,L;for(h||(h=2),p||(p=0),L=_?Math.min(_*h+p,s.length):s.length,I=p;I<L;I+=h)u[0]=s[I],u[1]=s[I+1],b(u,u,T),s[I]=u[0],s[I+1]=u[1];return s}}();function xv(u){return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},xv(u)}rn.forEach=$I,Object.defineProperty(V,"__esModule",{value:!0}),o.aa=V.vec4=o.Q=V.vec3=V.vec2=V.quat2=o.bl=V.quat=o.a9=V.mat4=o.ct=V.mat3=V.mat2d=o.b7=V.mat2=V.glMatrix=void 0;var HI=rl(H);V.glMatrix=HI;var jI=rl(J);o.b7=V.mat2=jI;var WI=rl(me);V.mat2d=WI;var Pr=rl(We);o.ct=V.mat3=Pr;var Ty=rl(lt);o.a9=V.mat4=Ty;var qr=rl(mt);o.bl=V.quat=qr;var bv=rl(bn);V.quat2=bv;var fn=rl(rn);V.vec2=fn;var Ay=rl(ht);o.Q=V.vec3=Ay;var Cy=rl(Yt);function Vr(u){if(typeof WeakMap!="function")return null;var s=new WeakMap,h=new WeakMap;return(Vr=function(p){return p?h:s})(u)}function rl(u,s){if(u&&u.__esModule)return u;if(u===null||xv(u)!=="object"&&typeof u!="function")return{default:u};var h=Vr(s);if(h&&h.has(u))return h.get(u);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in u)if(b!=="default"&&Object.prototype.hasOwnProperty.call(u,b)){var T=_?Object.getOwnPropertyDescriptor(u,b):null;T&&(T.get||T.set)?Object.defineProperty(p,b,T):p[b]=u[b]}return p.default=u,h&&h.set(u,p),p}o.aa=V.vec4=Cy;var ZI=wc;function wc(u,s,h,p){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(p-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=s,this.p2x=h,this.p2y=p}wc.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,s){if(s===void 0&&(s=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,p=0;p<8;p++){var _=this.sampleCurveX(h)-u;if(Math.abs(_)<s)return h;var b=this.sampleCurveDerivativeX(h);if(Math.abs(b)<1e-6)break;h-=_/b}var T=0,I=1;for(h=u,p=0;p<20&&(_=this.sampleCurveX(h),!(Math.abs(_-u)<s));p++)u>_?T=h:I=h,h=.5*(I-T)+T;return h},solve:function(u,s){return this.sampleCurveY(this.solveCurveX(u,s))}};var sw=z(ZI),wv=Ls;function Ls(u,s){this.x=u,this.y=s}Ls.prototype={clone:function(){return new Ls(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,s){return this.clone()._rotateAround(u,s)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var s=u.x-this.x,h=u.y-this.y;return s*s+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,s){return Math.atan2(this.x*s-this.y*u,this.x*u+this.y*s)},_matMult:function(u){var s=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=s,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var s=Math.cos(u),h=Math.sin(u),p=h*this.x+s*this.y;return this.x=s*this.x-h*this.y,this.y=p,this},_rotateAround:function(u,s){var h=Math.cos(u),p=Math.sin(u),_=s.y+p*(this.x-s.x)+h*(this.y-s.y);return this.x=s.x+h*(this.x-s.x)-p*(this.y-s.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ls.convert=function(u){return u instanceof Ls?u:Array.isArray(u)?new Ls(u[0],u[1]):u};var nr=z(wv);const My=Math.PI/180,Iy=180/Math.PI;function On(u){return u*My}function mo(u){return u*Iy}const lw=[[0,0],[1,0],[1,1],[0,1]];function Sv(u){if(u<=0)return 0;if(u>=1)return 1;const s=u*u,h=s*u;return 4*(u<.5?h:3*(u-s)+h-.75)}function uw(u,s,h,p){const _=new sw(u,s,h,p);return function(b){return _.solve(b)}}const Rs=uw(.25,.1,.25,1);function wn(u,s,h){return Math.min(h,Math.max(s,u))}function Pd(u,s,h){return(h=wn((h-u)/(s-u),0,1))*h*(3-2*h)}function Ul(u,s,h){const p=h-s,_=((u-s)%p+p)%p+s;return _===s?h:_}function Ey(u,s,h){if(!u.length)return h(null,[]);let p=u.length;const _=new Array(u.length);let b=null;u.forEach((T,I)=>{s(T,(L,k)=>{L&&(b=L),_[I]=k,--p==0&&h(b,_)})})}function us(u,...s){for(const h of s)for(const p in h)u[p]=h[p];return u}let cw=1;function Zn(){return cw++}function Tv(){return function u(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()}function Dy(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function hw(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)}function Py(u,s){u.forEach(h=>{s[h]&&(s[h]=s[h].bind(s))})}function Sc(u,s){return u.indexOf(s,u.length-s.length)!==-1}function Ih(u,s,h){const p={};for(const _ in u)p[_]=s.call(this,u[_],_,u);return p}function Ld(u,s,h){const p={};for(const _ in u)s.call(this,u[_],_,u)&&(p[_]=u[_]);return p}function $l(u){return Array.isArray(u)?u.map($l):typeof u=="object"&&u?Ih(u,$l):u}const Ly={};function Gi(u){Ly[u]||(typeof console<"u"&&console.warn(u),Ly[u]=!0)}function Cu(u,s,h){return(h.y-u.y)*(s.x-u.x)>(s.y-u.y)*(h.x-u.x)}function Rd(u){let s=0;for(let h,p,_=0,b=u.length,T=b-1;_<b;T=_++)h=u[_],p=u[T],s+=(p.x-h.x)*(h.y+p.y);return s}function kd([u,s,h]){const p=On(s+90),_=On(h);return{x:u*Math.cos(p)*Math.sin(_),y:u*Math.sin(p)*Math.sin(_),z:u*Math.cos(_),azimuthal:s,polar:h}}function Hl(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function $o(u){const s={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,_,b)=>{const T=_||b;return s[p]=!T||T.toLowerCase(),""}),s["max-age"]){const h=parseInt(s["max-age"],10);isNaN(h)?delete s["max-age"]:s["max-age"]=h}return s}let Av,Cv,Mv,Od,Mu,Eh,Iv=null;function Ry(u){try{const s=self[u];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function Tc(u,s){return[u[4*s],u[4*s+1],u[4*s+2],u[4*s+3]]}function Ac(u,s,h,p){for(;s<h;){const _=s+h>>1;u[_]<p?s=_+1:h=_}return s}function ky(u,s,h,p){for(;s<h;){const _=s+h>>1;u[_]<=p?s=_+1:h=_}return s}function ks(u){return u>0?1/(1.001-u):1+u}function fw(u){return u>0?1-1/(1.001-u):-u}function Ev(){return Av==null&&(Av=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Av}const nl={now:()=>Od!==void 0?Od:performance.now(),setNow(u){Od=u},restoreNow(){Od=void 0},frame(u){const s=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(u,s=0){const{width:h,height:p}=u;Mu||(Mu=document.createElement("canvas"));const _=Mu.getContext("2d",{willReadFrequently:!0});if(!_)throw new Error("failed to create canvas 2d context");return(h>Mu.width||p>Mu.height)&&(Mu.width=h,Mu.height=p),_.clearRect(-s,-s,h+2*s,p+2*s),_.drawImage(u,0,0,h,p),_.getImageData(-s,-s,h+2*s,p+2*s)},resolveURL:u=>(Cv||(Cv=document.createElement("a")),Cv.href=u,Cv.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Mv==null&&(Mv=window.matchMedia("(prefers-reduced-motion: reduce)")),Mv.matches)},hasCanvasFingerprintNoise(){if(Eh!==void 0)return Eh;if(!Ev())return Eh=!1,!1;const u=new OffscreenCanvas(85,1),s=u.getContext("2d",{willReadFrequently:!0});let h=0;for(let _=0;_<u.width;++_)s.fillStyle=`rgba(${h++},${h++},${h++}, 255)`,s.fillRect(_,0,1,1);const p=s.getImageData(0,0,u.width,u.height);h=0;for(let _=0;_<p.data.length;++_)if(_%4!=3&&h++!==p.data[_])return Eh=!0,!0;return Eh=!1,!1}};function Dv(u,s){const h=u.indexOf("?");if(h<0)return`${u}?${new URLSearchParams(s).toString()}`;const p=new URLSearchParams(u.slice(h));for(const _ in s)p.set(_,s[_]);return`${u.slice(0,h)}?${p.toString()}`}function Pv(u,s={persistentParams:[]}){const h=u.indexOf("?");if(h<0)return u;const p=new URLSearchParams,_=new URLSearchParams(u.slice(h));for(const T of s.persistentParams){const I=_.get(T);I&&p.set(T,I)}const b=p.toString();return`${u.slice(0,h)}${b.length>0?`?${b}`:""}`}const Dh="mapbox-tiles";let Lv=500,dw=50,jl,Rv;function Oy(){try{return caches}catch{}}function Ph(){const u=Oy();u&&!jl&&(jl=u.open(Dh))}let zy=1/0;const Cc={supported:!1,testSupport:function(u){!By&&Lh&&(pw?vw(u):zd=u)}};let zd,Lh,By=!1,pw=!1;const gw=typeof self<"u"?self:{};function vw(u){const s=u.createTexture();u.bindTexture(u.TEXTURE_2D,s);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,Lh),u.isContextLost())return;Cc.supported=!0}catch{}u.deleteTexture(s),By=!0}gw.document&&(Lh=gw.document.createElement("img"),Lh.onload=function(){zd&&vw(zd),zd=null,pw=!0},Lh.onerror=function(){By=!0,zd=null},Lh.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const kv={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(kv);class Ov extends Error{constructor(s,h,p){h===401&&y(p)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=h,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Rh=Hl()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Bd=function(u,s){if(!(/^file:/.test(h=u.url)||/^file:/.test(Rh())&&!/^\w+:/.test(h))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(p,_){const b=new AbortController,T=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:Rh(),referrerPolicy:p.referrerPolicy,signal:b.signal});let I=!1,L=!1;const k=(F=T.url).indexOf("sku=")>0&&y(F);var F;p.type==="json"&&T.headers.set("Accept","application/json");const N=(Z,Q,ee)=>{if(L)return;if(Z&&Z.message!=="SecurityError"&&Gi(Z.toString()),Q&&ee)return U(Q);const ie=Date.now();fetch(T).then(oe=>{if(oe.ok){const _e=k?oe.clone():null;return U(oe,_e,ie)}return _(new Ov(oe.statusText,oe.status,p.url))}).catch(oe=>{oe.name!=="AbortError"&&_(new Error(`${oe.message} ${p.url}`))})},U=(Z,Q,ee)=>{(p.type==="arrayBuffer"?Z.arrayBuffer():p.type==="json"?Z.json():Z.text()).then(ie=>{L||(Q&&ee&&function(oe,_e,Se){if(Ph(),!jl)return;const xe=$o(_e.headers.get("Cache-Control")||"");if(xe["no-store"])return;const Re={status:_e.status,statusText:_e.statusText,headers:new Headers};_e.headers.forEach((Ne,Xe)=>Re.headers.set(Xe,Ne)),xe["max-age"]&&Re.headers.set("Expires",new Date(Se+1e3*xe["max-age"]).toUTCString());const Te=Re.headers.get("Expires");if(!Te||new Date(Te).getTime()-Se<42e4)return;let Be=Pv(oe.url,{persistentParams:["language","worldview"]});if(_e.status===206){const Ne=oe.headers.get("Range");if(!Ne)return;Re.status=200,Be=Dv(Be,{range:Ne})}(function(Ne,Xe){if(Rv===void 0)try{new Response(new ReadableStream),Rv=!0}catch{Rv=!1}Rv?Xe(Ne.body):Ne.blob().then(Xe)})(_e,Ne=>{const Xe=new Response(Ne,Re);Ph(),jl&&jl.then(ft=>ft.put(Be,Xe)).catch(ft=>Gi(ft.message))})}(T,Q,ee),I=!0,_(null,ie,Z.headers.get("Cache-Control"),Z.headers.get("Expires")))}).catch(ie=>{L||_(new Error(ie.message))})};return k?function(Z,Q){if(Ph(),!jl)return Q(null);jl.then(ee=>{let ie=Pv(Z.url,{persistentParams:["language","worldview"]});const oe=Z.headers.get("Range");oe&&(ie=Dv(ie,{range:oe})),ee.match(ie).then(_e=>{const Se=function(xe){if(!xe)return!1;const Re=new Date(xe.headers.get("Expires")||0),Te=$o(xe.headers.get("Cache-Control")||"");return Re>Date.now()&&!Te["no-cache"]}(_e);ee.delete(ie),Se&&ee.put(ie,_e.clone()),Q(null,_e,Se)}).catch(Q)}).catch(Q)}(T,N):N(null,null),{cancel:()=>{L=!0,I||b.abort()}}}(u,s);if(Hl()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,s,void 0,!0)}var h;return function(p,_){const b=new XMLHttpRequest;b.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const T in p.headers)b.setRequestHeader(T,p.headers[T]);return p.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=p.credentials==="include",b.onerror=()=>{_(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let T=b.response;if(p.type==="json")try{T=JSON.parse(b.response)}catch(I){return _(I)}_(null,T,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else _(new Ov(b.statusText,b.status,p.url))},b.send(p.body),{cancel:()=>b.abort()}}(u,s)},Fd=function(u,s){return Bd(us(u,{type:"arrayBuffer"}),s)};function Fy(u){const s=document.createElement("a");return s.href=u,s.protocol===location.protocol&&s.host===location.host}const mw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let zv,Nd;zv=[],Nd=0;const Ny=function(u,s){if(Cc.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),Nd>=m.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:u,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return zv.push(b),b}Nd++;let h=!1;const p=()=>{if(!h)for(h=!0,Nd--;zv.length&&Nd<m.MAX_PARALLEL_IMAGE_REQUESTS;){const b=zv.shift(),{requestParameters:T,callback:I,cancelled:L}=b;L||(b.cancel=Ny(T,I).cancel)}},_=Fd(u,(b,T,I,L)=>{p(),b?s(b):T&&(self.createImageBitmap?function(k,F){const N=new Blob([new Uint8Array(k)],{type:"image/png"});createImageBitmap(N).then(U=>{F(null,U)}).catch(U=>{F(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(T,(k,F)=>s(k,F,I,L)):function(k,F){const N=new Image;N.onload=()=>{F(null,N),URL.revokeObjectURL(N.src),N.onload=null,requestAnimationFrame(()=>{N.src=mw})},N.onerror=()=>F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const U=new Blob([new Uint8Array(k)],{type:"image/png"});N.src=k.byteLength?URL.createObjectURL(U):mw}(T,(k,F)=>s(k,F,I,L)))});return{cancel:()=>{_.cancel(),p()}}},Vd="01",Bv="NO_ACCESS_TOKEN",Vy=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Os(u){const s=u.match(Vy);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function kh(u){const s=u.params.length?`?${u.params.join("&")}`:"";return`${u.protocol}://${u.authority}${u.path}${s}`}const Gd="mapbox.eventData";function Gy(u){if(!u)return null;const s=u.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(s[1]).split("").map(h=>"%"+("00"+h.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Oh{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const h=Gy(m.ACCESS_TOKEN);let p="";return p=h&&h.u?btoa(encodeURIComponent(h.u).replace(/%([0-9A-F]{2})/g,(_,b)=>String.fromCharCode(+("0x"+b)))):m.ACCESS_TOKEN||"",s?`${Gd}.${s}:${p}`:`${Gd}:${p}`}fetchEventData(){const s=Ry("localStorage"),h=this.getStorageKey(),p=this.getStorageKey("uuid");if(s)try{const _=localStorage.getItem(h);_&&(this.eventData=JSON.parse(_));const b=localStorage.getItem(p);b&&(this.anonId=b)}catch{Gi("Unable to read from LocalStorage")}}saveEventData(){const s=Ry("localStorage"),h=this.getStorageKey(),p=this.getStorageKey("uuid"),_=this.anonId;if(s&&_)try{localStorage.setItem(p,_),Object.keys(this.eventData).length>=1&&localStorage.setItem(h,JSON.stringify(this.eventData))}catch{Gi("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,h,p,_){if(!m.EVENTS_URL)return;const b=Os(m.EVENTS_URL);b.params.push(`access_token=${_||m.ACCESS_TOKEN||""}`);const T={event:this.type,created:new Date(s).toISOString()},I=h?us(T,h):T,L={url:kh(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=function(k,F){return Bd(us(k,{method:"POST"}),F)}(L,k=>{this.pendingRequest=null,p(k),this.saveEventData(),this.processRequests(_)})}queueRequest(s,h){this.queue.push(s),this.processRequests(h)}}const Fv=new class extends Oh{constructor(u){super("appUserTurnstile"),this._customAccessToken=u}postTurnstileEvent(u,s){m.EVENTS_URL&&m.ACCESS_TOKEN&&Array.isArray(u)&&u.some(h=>x(h)||y(h))&&this.queueRequest(Date.now(),s)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Gy(m.ACCESS_TOKEN),h=s?s.u:m.ACCESS_TOKEN;let p=h!==this.eventData.tokenU;hw(this.anonId)||(this.anonId=Tv(),p=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),T=new Date(_),I=(_-this.eventData.lastSuccess)/864e5;p=p||I>=1||I<-1||b.getDate()!==T.getDate()}else p=!0;p?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:d,skuId:Vd,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=_,this.eventData.tokenU=h)},u):this.processRequests()}},Co=Fv.postTurnstileEvent.bind(Fv),Iu=new class extends Oh{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(u,s,h,p){this.skuToken=s,this.errorCb=p,m.EVENTS_URL&&(h||m.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},h):this.errorCb(new Error(Bv)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),hw(this.anonId)||(this.anonId=Tv()),this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:d,skuId:Vd,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):s&&(this.success[s]=!0)},u))}remove(){this.errorCb=null}},Mo=Iu.postMapLoadEvent.bind(Iu),_w=new class extends Oh{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(u){let s=this.mapInstanceIdMap.get(u);return s||(s=Tv(),this.mapInstanceIdMap.set(u,s)),s}getEventId(u){const s=this.eventIdPerMapInstanceMap.get(u)||0;return this.eventIdPerMapInstanceMap.set(u,s+1),s}postStyleLoadEvent(u,s){const{map:h,style:p,importedStyles:_}=s;if(!m.EVENTS_URL||!u&&!m.ACCESS_TOKEN)return;const b=this.getMapInstanceId(h),T={mapInstanceId:b,eventId:this.getEventId(b),style:p};_.length&&(T.importedStyles=_),this.queueRequest({timestamp:Date.now(),payload:T},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:h}=this.queue.shift();this.postEvent(s,h,()=>{},u)}},qI=_w.postStyleLoadEvent.bind(_w),yw=new class extends Oh{constructor(){super("gljs.performance")}postPerformanceEvent(u,s){m.EVENTS_URL&&(u||m.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:h}=this.queue.shift(),p=function(_){const b=performance.getEntriesByType("resource"),T=performance.getEntriesByType("mark"),I=function(Z){const Q={};if(Z){for(const ee in Z)if(ee!=="other")for(const ie of Z[ee]){const oe=`${ee}ResolveRangeMin`,_e=`${ee}ResolveRangeMax`,Se=`${ee}RequestCount`,xe=`${ee}RequestCachedCount`;Q[oe]=Math.min(Q[oe]||1/0,ie.startTime),Q[_e]=Math.max(Q[_e]||-1/0,ie.responseEnd);const Re=Te=>{Q[Te]===void 0&&(Q[Te]=0),++Q[Te]};ie.transferSize!==void 0&&ie.transferSize===0&&Re(xe),Re(Se)}}return Q}(function(Z,Q){const ee={};if(Z)for(const ie of Z){const oe=Q(ie);ee[oe]===void 0&&(ee[oe]=[]),ee[oe].push(ie)}return ee}(b,O)),L=window.devicePixelRatio,k=navigator.connection||navigator.mozConnection||navigator.webkitConnection,F=k?k.effectiveType:void 0,N={counters:[],metadata:[],attributes:[]},U=(Z,Q,ee)=>{ee!=null&&Z.push({name:Q,value:ee.toString()})};for(const Z in I)U(N.counters,Z,I[Z]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(U(N.counters,"interactionRangeMin",_.interactionRange[0]),U(N.counters,"interactionRangeMax",_.interactionRange[1])),T)for(const Z of Object.keys(P)){const Q=P[Z],ee=T.find(ie=>ie.name===Q);ee&&U(N.counters,Q,ee.startTime)}return U(N.counters,"visibilityHidden",_.visibilityHidden),U(N.attributes,"style",function(Z){if(Z)for(const Q of Z){const ee=Q.name.split("?")[0];if(D(ee)){const ie=ee.split("/").slice(-2);if(ie.length===2)return`mapbox://styles/${ie[0]}/${ie[1]}`}}}(b)),U(N.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),U(N.attributes,"fogEnabled",_.fogEnabled?"true":"false"),U(N.attributes,"projection",_.projection),U(N.attributes,"zoom",_.zoom),U(N.metadata,"devicePixelRatio",L),U(N.metadata,"connectionEffectiveType",F),U(N.metadata,"navigatorUserAgent",navigator.userAgent),U(N.metadata,"screenWidth",window.screen.width),U(N.metadata,"screenHeight",window.screen.height),U(N.metadata,"windowWidth",window.innerWidth),U(N.metadata,"windowHeight",window.innerHeight),U(N.metadata,"mapWidth",_.width/L),U(N.metadata,"mapHeight",_.height/L),U(N.metadata,"webglRenderer",_.renderer),U(N.metadata,"webglVendor",_.vendor),U(N.metadata,"sdkVersion",d),U(N.metadata,"sdkIdentifier","mapbox-gl-js"),N}(h);for(const _ of p.metadata);for(const _ of p.counters);for(const _ of p.attributes);this.postEvent(s,p,()=>{},u)}},Nv=yw.postPerformanceEvent.bind(yw),Vv=new class extends Oh{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(u,s,h,p){if(!m.API_URL||!m.SESSION_PATH)return;const _=Os(m.API_URL+m.SESSION_PATH);_.params.push(`sku=${s||""}`),_.params.push(`access_token=${p||m.ACCESS_TOKEN||""}`);const b={url:kh(_),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(T,I){return Bd(us(T,{method:"GET"}),I)}(b,T=>{this.pendingRequest=null,h(T),this.saveEventData(),this.processRequests(p)})}getSessionAPI(u,s,h,p){this.skuToken=s,this.errorCb=p,m.SESSION_PATH&&m.API_URL&&(h||m.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},h):this.errorCb(new Error(Bv)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:h}=this.queue.shift();s&&this.success[s]||this.getSession(h,this.skuToken,p=>{p?this.errorCb(p):s&&(this.success[s]=!0)},u)}remove(){this.errorCb=null}},Uy=Vv.getSessionAPI.bind(Vv),Gv=new Set;var il={exports:{}},xw={exports:{}};xw.exports=function(u,s){var h,p,_,b,T,I,L,k;for(p=u.length-(h=3&u.length),_=s,T=3432918353,I=461845907,k=0;k<p;)L=255&u.charCodeAt(k)|(255&u.charCodeAt(++k))<<8|(255&u.charCodeAt(++k))<<16|(255&u.charCodeAt(++k))<<24,++k,_=27492+(65535&(b=5*(65535&(_=(_^=L=(65535&(L=(L=(65535&L)*T+(((L>>>16)*T&65535)<<16)&4294967295)<<15|L>>>17))*I+(((L>>>16)*I&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(L=0,h){case 3:L^=(255&u.charCodeAt(k+2))<<16;case 2:L^=(255&u.charCodeAt(k+1))<<8;case 1:_^=L=(65535&(L=(L=(65535&(L^=255&u.charCodeAt(k)))*T+(((L>>>16)*T&65535)<<16)&4294967295)<<15|L>>>17))*I+(((L>>>16)*I&65535)<<16)&4294967295}return _^=u.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var YI=xw.exports,$y={exports:{}};$y.exports=function(u,s){for(var h,p=u.length,_=s^p,b=0;p>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(b)|(255&u.charCodeAt(++b))<<8|(255&u.charCodeAt(++b))<<16|(255&u.charCodeAt(++b))<<24))+((1540483477*(h>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),p-=4,++b;switch(p){case 3:_^=(255&u.charCodeAt(b+2))<<16;case 2:_^=(255&u.charCodeAt(b+1))<<8;case 1:_=1540483477*(65535&(_^=255&u.charCodeAt(b)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var Hy=YI,zs=$y.exports;il.exports=Hy,il.exports.murmur3=Hy,il.exports.murmur2=zs;var Ud=z(il.exports);function jy(u,s,h){h[u]&&h[u].indexOf(s)!==-1||(h[u]=h[u]||[],h[u].push(s))}function Uv(u,s,h){if(h&&h[u]){const p=h[u].indexOf(s);p!==-1&&h[u].splice(p,1)}}class Eu{constructor(s,h={}){us(this,h),this.type=s}}class $v extends Eu{constructor(s,h={}){super("error",us({error:s},h))}}class Mc{on(s,h){return this._listeners=this._listeners||{},jy(s,h,this._listeners),this}off(s,h){return Uv(s,h,this._listeners),Uv(s,h,this._oneTimeListeners),this}once(s,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},jy(s,h,this._oneTimeListeners),this):new Promise(p=>this.once(s,p))}fire(s,h){typeof s=="string"&&(s=new Eu(s,h||{}));const p=s.type;if(this.listens(p)){s.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const I of _)I.call(this,s);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const I of b)Uv(p,I,this._oneTimeListeners),I.call(this,s);const T=this._eventedParent;T&&(us(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(s))}else s instanceof $v&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,h){return this._eventedParent=s,this._eventedParentData=h,this}}o.z=void 0;var Wy={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function $d(u){return(u=Math.round(u))<0?0:u>255?255:u}function Hv(u){return $d(u[u.length-1]==="%"?parseFloat(u)/100*255:parseInt(u))}function Hd(u){return(s=u[u.length-1]==="%"?parseFloat(u)/100:parseFloat(u))<0?0:s>1?1:s;var s}function jv(u,s,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?u+(s-u)*h*6:2*h<1?s:3*h<2?u+(s-u)*(2/3-h)*6:u}try{o.z={}.parseCSSColor=function(u){var s,h=u.replace(/ /g,"").toLowerCase();if(h in Wy)return Wy[h].slice();if(h[0]==="#")return h.length===4?(s=parseInt(h.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:h.length===7&&(s=parseInt(h.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var p=h.indexOf("("),_=h.indexOf(")");if(p!==-1&&_+1===h.length){var b=h.substr(0,p),T=h.substr(p+1,_-(p+1)).split(","),I=1;switch(b){case"rgba":if(T.length!==4)return null;I=Hd(T.pop());case"rgb":return T.length!==3?null:[Hv(T[0]),Hv(T[1]),Hv(T[2]),I];case"hsla":if(T.length!==4)return null;I=Hd(T.pop());case"hsl":if(T.length!==3)return null;var L=(parseFloat(T[0])%360+360)%360/360,k=Hd(T[1]),F=Hd(T[2]),N=F<=.5?F*(k+1):F+k-F*k,U=2*F-N;return[$d(255*jv(U,N,L+1/3)),$d(255*jv(U,N,L)),$d(255*jv(U,N,L-1/3)),I];default:return null}}return null}}catch{}class Jn{constructor(s,h,p,_=1){this.r=s,this.g=h,this.b=p,this.a=_}static parse(s){if(!s)return;if(s instanceof Jn)return s;if(typeof s!="string")return;const h=o.z(s);return h?new Jn(h[0]/255*h[3],h[1]/255*h[3],h[2]/255*h[3],h[3]):void 0}toString(){const[s,h,p,_]=this.toArray();return`rgba(${Math.round(s)},${Math.round(h)},${Math.round(p)},${_})`}toArray(){const{r:s,g:h,b:p,a:_}=this;return _===0?[0,0,0,0]:[255*s/_,255*h/_,255*p/_,_]}toArray01(){const{r:s,g:h,b:p,a:_}=this;return _===0?[0,0,0,0]:[s/_,h/_,p/_,_]}toArray01Scaled(s){const{r:h,g:p,b:_,a:b}=this;return b===0?[0,0,0]:[h/b*s,p/b*s,_/b*s]}toArray01PremultipliedAlpha(){const{r:s,g:h,b:p,a:_}=this;return[s,h,p,_]}toArray01Linear(){const{r:s,g:h,b:p,a:_}=this;return _===0?[0,0,0,0]:[Math.pow(s/_,2.2),Math.pow(h/_,2.2),Math.pow(p/_,2.2),_]}}function cn(u,s,h){return u*(1-h)+s*h}function jd(u,s,h){return u.map((p,_)=>cn(p,s[_],h))}Jn.black=new Jn(0,0,0,1),Jn.white=new Jn(1,1,1,1),Jn.transparent=new Jn(0,0,0,0),Jn.red=new Jn(1,0,0,1),Jn.blue=new Jn(0,0,1,1);var Wd=Object.freeze({__proto__:null,array:jd,color:function(u,s,h){return new Jn(cn(u.r,s.r,h),cn(u.g,s.g,h),cn(u.b,s.b,h),cn(u.a,s.a,h))},number:cn});function Wv(u,...s){for(const h of s)for(const p in h)u[p]=h[p];return u}class Bs extends Error{constructor(s,h){super(h),this.message=h,this.key=s}}class Du{constructor(s,h=[]){this.parent=s,this.bindings={};for(const[p,_]of h)this.bindings[p]=_}concat(s){return new Du(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const dn={kind:"null"},pr={kind:"number"},qn={kind:"string"},Yn={kind:"boolean"},Ho={kind:"color"},zh={kind:"object"},zn={kind:"value"},Zd={kind:"collator"},Bh={kind:"formatted"},Fh={kind:"resolvedImage"};function Aa(u,s){return{kind:"array",itemType:u,N:s}}function Yi(u){if(u.kind==="array"){const s=Yi(u.itemType);return typeof u.N=="number"?`array<${s}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${s}>`}return u.kind}const bw=[dn,pr,qn,Yn,Ho,Bh,zh,Aa(zn),Fh];function qd(u,s){if(s.kind==="error")return null;if(u.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!qd(u.itemType,s.itemType))&&(typeof u.N!="number"||u.N===s.N))return null}else{if(u.kind===s.kind)return null;if(u.kind==="value"){for(const h of bw)if(!qd(h,s))return null}}return`Expected ${Yi(u)} but found ${Yi(s)} instead.`}function Yd(u,s){return s.some(h=>h.kind===u.kind)}function Ic(u,s){return s.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}class Zy{constructor(s,h,p){this.sensitivity=s?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,h){return this.collator.compare(s,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zv{constructor(s,h,p,_,b){this.text=s.normalize?s.normalize():s,this.image=h,this.scale=p,this.fontStack=_,this.textColor=b}}class Ha{constructor(s){this.sections=s}static fromString(s){return new Ha([new Zv(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.namePrimary.length!==0)}static factory(s){return s instanceof Ha?s:Ha.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const h of this.sections){if(h.image){s.push(["image",h.image.namePrimary]);continue}s.push(h.text);const p={};h.fontStack&&(p["text-font"]=["literal",h.fontStack.split(",")]),h.scale&&(p["font-scale"]=h.scale),h.textColor&&(p["text-color"]=["rgba"].concat(h.textColor.toArray())),s.push(p)}return s}}class jo{constructor(s){this.namePrimary=s.namePrimary,s.nameSecondary&&(this.nameSecondary=s.nameSecondary),this.available=s.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(s,h){return s?new jo({namePrimary:s,nameSecondary:h,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function ww(u,s,h,p){return typeof u=="number"&&u>=0&&u<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[u,s,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[u,s,h,p]:[u,s,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Nh(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Jn||u instanceof Zy||u instanceof Ha||u instanceof jo)return!0;if(Array.isArray(u)){for(const s of u)if(!Nh(s))return!1;return!0}if(typeof u=="object"){for(const s in u)if(!Nh(u[s]))return!1;return!0}return!1}function la(u){if(u===null)return dn;if(typeof u=="string")return qn;if(typeof u=="boolean")return Yn;if(typeof u=="number")return pr;if(u instanceof Jn)return Ho;if(u instanceof Zy)return Zd;if(u instanceof Ha)return Bh;if(u instanceof jo)return Fh;if(Array.isArray(u)){const s=u.length;let h;for(const p of u){const _=la(p);if(h){if(h===_)continue;h=zn;break}h=_}return Aa(h||zn,s)}return zh}function cs(u){const s=typeof u;return u===null?"":s==="string"||s==="number"||s==="boolean"?String(u):u instanceof Jn||u instanceof Ha||u instanceof jo?u.toString():JSON.stringify(u)}class al{constructor(s,h){this.type=s,this.value=h}static parse(s,h){if(s.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Nh(s[1]))return h.error("invalid value");const p=s[1];let _=la(p);const b=h.expectedType;return _.kind!=="array"||_.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(_=b),new al(_,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Jn?["rgba"].concat(this.value.toArray()):this.value instanceof Ha?this.value.serialize():this.value}}class _a{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const qv={string:qn,number:pr,boolean:Yn,object:zh};class Fs{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");let p,_=1;const b=s[0];if(b==="array"){let I,L;if(s.length>2){const k=s[1];if(typeof k!="string"||!(k in qv)||k==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);I=qv[k],_++}else I=zn;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return h.error('The length argument to "array" must be a positive integer literal',2);L=s[2],_++}p=Aa(I,L)}else p=qv[b];const T=[];for(;_<s.length;_++){const I=h.parse(s[_],_,zn);if(!I)return null;T.push(I)}return new Fs(p,T)}evaluate(s){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(s);if(!qd(this.type,la(p)))return p;if(h===this.args.length-1)throw new _a(`Expected value to be of type ${Yi(this.type)}, but found ${Yi(la(p))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,h=[s.kind];if(s.kind==="array"){const p=s.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){h.push(p.kind);const _=s.N;(typeof _=="number"||this.args.length>1)&&h.push(_)}}return h.concat(this.args.map(p=>p.serialize()))}}class Xd{constructor(s){this.type=Bh,this.sections=s}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const _=[];let b=!1;for(let T=1;T<=s.length-1;++T){const I=s[T];if(b&&typeof I=="object"&&!Array.isArray(I)){b=!1;let L=null;if(I["font-scale"]&&(L=h.parse(I["font-scale"],1,pr),!L))return null;let k=null;if(I["text-font"]&&(k=h.parse(I["text-font"],1,Aa(qn)),!k))return null;let F=null;if(I["text-color"]&&(F=h.parse(I["text-color"],1,Ho),!F))return null;const N=_[_.length-1];N.scale=L,N.font=k,N.textColor=F}else{const L=h.parse(s[T],1,zn);if(!L)return null;const k=L.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,_.push({content:L,scale:null,font:null,textColor:null})}}return new Xd(_)}evaluate(s){return new Ha(this.sections.map(h=>{const p=h.content.evaluate(s);return la(p)===Fh?new Zv("",p,null,null,null):new Zv(cs(p),null,h.scale?h.scale.evaluate(s):null,h.font?h.font.evaluate(s).join(","):null,h.textColor?h.textColor.evaluate(s):null)}))}eachChild(s){for(const h of this.sections)s(h.content),h.scale&&s(h.scale),h.font&&s(h.font),h.textColor&&s(h.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const h of this.sections){s.push(h.content.serialize());const p={};h.scale&&(p["font-scale"]=h.scale.serialize()),h.font&&(p["text-font"]=h.font.serialize()),h.textColor&&(p["text-color"]=h.textColor.serialize()),s.push(p)}return s}}class Vh{constructor(s,h){this.type=Fh,this.inputPrimary=s,this.inputSecondary=h}static parse(s,h){if(s.length<2)return h.error("Expected two or more arguments.");const p=h.parse(s[1],1,qn);if(!p)return h.error("No image name provided.");if(s.length===2)return new Vh(p);const _=h.parse(s[2],1,qn);return _?new Vh(p,_):h.error("Secondary image variant is not a string.")}evaluate(s){const h=jo.fromString(this.inputPrimary.evaluate(s),this.inputSecondary?this.inputSecondary.evaluate(s):void 0);return h&&s.availableImages&&(h.available=s.availableImages.indexOf(h.namePrimary)>-1,h.nameSecondary&&h.available&&s.availableImages&&(h.available=s.availableImages.indexOf(h.nameSecondary)>-1)),h}eachChild(s){s(this.inputPrimary),this.inputSecondary&&s(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Pu(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const XI={"to-boolean":Yn,"to-color":Ho,"to-number":pr,"to-string":qn};class Wl{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");const p=s[0],_=[];let b=dn;if(p==="to-array"){if(!Array.isArray(s[1]))return null;const T=s[1].length;if(h.expectedType){if(h.expectedType.kind!=="array")return h.error(`Expected ${h.expectedType.kind} but found array.`);b=Aa(h.expectedType.itemType,T)}else{if(!(T>0&&Nh(s[1][0])))return null;b=Aa(la(s[1][0]),T)}for(let I=0;I<T;I++){const L=s[1][I];let k;if(Pu(L)==="array")k=h.parse(L,void 0,b.itemType);else{const F=Pu(L);if(F!==b.itemType.kind)return h.error(`Expected ${b.itemType.kind} but found ${F}.`);k=h.registry.literal.parse(["literal",L===void 0?null:L],h)}if(!k)return null;_.push(k)}}else{if((p==="to-boolean"||p==="to-string")&&s.length!==2)return h.error("Expected one argument.");b=XI[p];for(let T=1;T<s.length;T++){const I=h.parse(s[T],T,zn);if(!I)return null;_.push(I)}}return new Wl(b,_)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let h,p;for(const _ of this.args){if(h=_.evaluate(s),p=null,h instanceof Jn)return h;if(typeof h=="string"){const b=s.parseColor(h);if(b)return b}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:ww(h[0],h[1],h[2],h[3]),!p))return new Jn(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new _a(p||`Could not parse color from value '${typeof h=="string"?h:String(JSON.stringify(h))}'`)}if(this.type.kind==="number"){let h=null;for(const p of this.args){if(h=p.evaluate(s),h===null)return 0;const _=Number(h);if(!isNaN(_))return _}throw new _a(`Could not convert ${JSON.stringify(h)} to number.`)}return this.type.kind==="formatted"?Ha.fromString(cs(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?jo.fromString(cs(this.args[0].evaluate(s))):this.type.kind==="array"?this.args.map(h=>h.evaluate(s)):cs(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Xd([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Vh(this.args[0]).serialize();const s=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(h=>{s.push(h.serialize())}),s}}const QI=["Unknown","Point","LineString","Polygon"];class qy{constructor(s,h){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=s,this.options=h}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?QI[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(s){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,h=this.featureDistanceData.scale,{x:p,y:_}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(p*h-s[0])+this.featureDistanceData.bearing[1]*(_*h-s[1])}return 0}parseColor(s){let h=this._parseColorCache[s];return h||(h=this._parseColorCache[s]=Jn.parse(s)),h}getConfig(s){return this.options?this.options.get(s):null}}class Io{constructor(s,h,p,_,b){this.name=s,this.type=h,this._evaluate=p,this.args=_,this._overloadIndex=b}evaluate(s){if(!this._evaluate){const h=Io.definitions[this.name];this._evaluate=Array.isArray(h)?h[2]:h.overloads[this._overloadIndex][1]}return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,h){const p=s[0],_=Io.definitions[p];if(!_)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(_)?_[0]:_.type,T=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,I=[];let L=null,k=-1;for(const[F,N]of T){if(Array.isArray(F)&&F.length!==s.length-1)continue;I.push(F),k++,L=new nm(h.registry,h.path,null,h.scope,void 0,h._scope,h.options);const U=[];let Z=!1;for(let Q=1;Q<s.length;Q++){const ee=s[Q],ie=Array.isArray(F)?F[Q-1]:F.type,oe=L.parse(ee,1+U.length,ie);if(!oe){Z=!0;break}U.push(oe)}if(!Z)if(Array.isArray(F)&&F.length!==U.length)L.error(`Expected ${F.length} arguments, but found ${U.length} instead.`);else{for(let Q=0;Q<U.length;Q++){const ee=Array.isArray(F)?F[Q]:F.type,ie=U[Q];L.concat(Q+1).checkSubtype(ee,ie.type)}if(L.errors.length===0)return new Io(p,b,N,U,k)}}if(I.length===1)h.errors.push(...L.errors);else{const F=(I.length?I:T.map(([U])=>U)).map(KI).join(" | "),N=[];for(let U=1;U<s.length;U++){const Z=h.parse(s[U],1+N.length);if(!Z)return null;N.push(Yi(Z.type))}h.error(`Expected arguments of type ${F}, but found (${N.join(", ")}) instead.`)}return null}static register(s,h){Io.definitions=h;for(const p in h)s[p]=Io}}function KI(u){return Array.isArray(u)?`(${u.map(Yi).join(", ")})`:`(${Yi(u.type)}...)`}class Qd{constructor(s,h,p){this.type=Zd,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=h}static parse(s,h){if(s.length!==2)return h.error("Expected one argument.");const p=s[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const _=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Yn);if(!_)return null;const b=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Yn);if(!b)return null;let T=null;return p.locale&&(T=h.parse(p.locale,1,qn),!T)?null:new Qd(_,b,T)}evaluate(s){return new Zy(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}var Yy={exports:{}};Yy.exports=function(){function u(p,_,b,T,I){for(;T>b;){if(T-b>600){var L=T-b+1,k=_-b+1,F=Math.log(L),N=.5*Math.exp(2*F/3),U=.5*Math.sqrt(F*N*(L-N)/L)*(k-L/2<0?-1:1);u(p,_,Math.max(b,Math.floor(_-k*N/L+U)),Math.min(T,Math.floor(_+(L-k)*N/L+U)),I)}var Z=p[_],Q=b,ee=T;for(s(p,b,_),I(p[T],Z)>0&&s(p,b,T);Q<ee;){for(s(p,Q,ee),Q++,ee--;I(p[Q],Z)<0;)Q++;for(;I(p[ee],Z)>0;)ee--}I(p[b],Z)===0?s(p,b,ee):s(p,++ee,T),ee<=_&&(b=ee+1),_<=ee&&(T=ee-1)}}function s(p,_,b){var T=p[_];p[_]=p[b],p[b]=T}function h(p,_){return p<_?-1:p>_?1:0}return function(p,_,b,T,I){u(p,_,b||0,T||p.length-1,I||h)}}();var Sw=z(Yy.exports);function JI(u){let s=0;for(let h,p,_=0,b=u.length,T=b-1;_<b;T=_++)h=u[_],p=u[T],s+=(p.x-h.x)*(h.y+p.y);return s}function Kd(u,s){u[0]=Math.min(u[0],s[0]),u[1]=Math.min(u[1],s[1]),u[2]=Math.max(u[2],s[0]),u[3]=Math.max(u[3],s[1])}function Jd(u,s){return!(u[0]<=s[0]||u[2]>=s[2]||u[1]<=s[1]||u[3]>=s[3])}function eE(u,s,h){const p=u[0]-s[0],_=u[1]-s[1],b=u[0]-h[0],T=u[1]-h[1];return p*T-b*_==0&&p*b<=0&&_*T<=0}function Ec(u,s,h=!1){let p=!1;for(let I=0,L=s.length;I<L;I++){const k=s[I];for(let F=0,N=k.length,U=N-1;F<N;U=F++){const Z=k[U],Q=k[F];if(eE(u,Z,Q))return h;(b=Z)[1]>(_=u)[1]!=(T=Q)[1]>_[1]&&_[0]<(T[0]-b[0])*(_[1]-b[1])/(T[1]-b[1])+b[0]&&(p=!p)}}var _,b,T;return p}function Xy(u,s,h,p){const _=p[0]-h[0],b=p[1]-h[1],T=(u[0]-h[0])*b-_*(u[1]-h[1]),I=(s[0]-h[0])*b-_*(s[1]-h[1]);return T>0&&I<0||T<0&&I>0}function Gh(u,s,h,p){return(_=[p[0]-h[0],p[1]-h[1]])[0]*(b=[s[0]-u[0],s[1]-u[1]])[1]-_[1]*b[0]!=0&&!(!Xy(u,s,h,p)||!Xy(h,p,u,s));var _,b}const Lu=8192;function tE(u,s){const h=(180+u[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,_=Math.pow(2,s.z);return[Math.round(h*_*Lu),Math.round(p*_*Lu)]}function rE(u,s){for(let h=0;h<s.length;h++)if(Ec(u,s[h]))return!0;return!1}function Qy(u,s,h){for(const p of h)for(let _=0,b=p.length,T=b-1;_<b;T=_++)if(Gh(u,s,p[T],p[_]))return!0;return!1}function Yv(u,s){for(let h=0;h<u.length;++h)if(!Ec(u[h],s))return!1;for(let h=0;h<u.length-1;++h)if(Qy(u[h],u[h+1],s))return!1;return!0}function Tw(u,s){for(let h=0;h<s.length;h++)if(Yv(u,s[h]))return!0;return!1}function Ky(u,s,h){const p=[];for(let _=0;_<u.length;_++){const b=[];for(let T=0;T<u[_].length;T++){const I=tE(u[_][T],h);Kd(s,I),b.push(I)}p.push(b)}return p}function ep(u,s,h){const p=[];for(let _=0;_<u.length;_++){const b=Ky(u[_],s,h);p.push(b)}return p}function Jy(u,s,h,p){if(u[0]<h[0]||u[0]>h[2]){const _=.5*p;let b=u[0]-h[0]>_?-p:h[0]-u[0]>_?p:0;b===0&&(b=u[0]-h[2]>_?-p:h[2]-u[0]>_?p:0),u[0]+=b}Kd(s,u)}function tp(u,s,h,p){const _=Math.pow(2,p.z)*Lu,b=[p.x*Lu,p.y*Lu],T=[];if(!u)return T;for(const I of u)for(const L of I){const k=[L.x+b[0],L.y+b[1]];Jy(k,s,h,_),T.push(k)}return T}function e0(u,s,h,p){const _=Math.pow(2,p.z)*Lu,b=[p.x*Lu,p.y*Lu],T=[];if(!u)return T;for(const L of u){const k=[];for(const F of L){const N=[F.x+b[0],F.y+b[1]];Kd(s,N),k.push(N)}T.push(k)}if(s[2]-s[0]<=_/2){(I=s)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const L of T)for(const k of L)Jy(k,s,h,_)}var I;return T}class Dc{constructor(s,h){this.type=Yn,this.geojson=s,this.geometries=h}static parse(s,h){if(s.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Nh(s[1])){const p=s[1];if(p.type==="FeatureCollection")for(let _=0;_<p.features.length;++_){const b=p.features[_].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Dc(p,p.features[_].geometry)}else if(p.type==="Feature"){const _=p.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Dc(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Dc(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(h,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(!T)return!1;if(p.type==="Polygon"){const I=Ky(p.coordinates,b,T),L=tp(h.geometry(),_,b,T);if(!Jd(_,b))return!1;for(const k of L)if(!Ec(k,I))return!1}if(p.type==="MultiPolygon"){const I=ep(p.coordinates,b,T),L=tp(h.geometry(),_,b,T);if(!Jd(_,b))return!1;for(const k of L)if(!rE(k,I))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(h,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(!T)return!1;if(p.type==="Polygon"){const I=Ky(p.coordinates,b,T),L=e0(h.geometry(),_,b,T);if(!Jd(_,b))return!1;for(const k of L)if(!Yv(k,I))return!1}if(p.type==="MultiPolygon"){const I=ep(p.coordinates,b,T),L=e0(h.geometry(),_,b,T);if(!Jd(_,b))return!1;for(const k of L)if(!Tw(k,I))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Aw={exports:{}};(function(u,s){u.exports=function(){var h={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},p=1/298.257223563,_=p*(2-p),b=Math.PI/180,T=function(N,U){if(N===void 0)throw new Error("No latitude given.");if(U&&!h[U])throw new Error("Unknown unit "+U+". Use one of: "+Object.keys(h).join(", "));var Z=6378.137*b*(U?h[U]:1),Q=Math.cos(N*b),ee=1/(1-_*(1-Q*Q)),ie=Math.sqrt(ee);this.kx=Z*ie*Q,this.ky=Z*ie*ee*(1-_)},I={units:{configurable:!0}};function L(N,U){return N[0]===U[0]&&N[1]===U[1]}function k(N,U,Z){var Q=F(U[0]-N[0]);return[N[0]+Q*Z,N[1]+(U[1]-N[1])*Z]}function F(N){for(;N<-180;)N+=360;for(;N>180;)N-=360;return N}return T.fromTile=function(N,U,Z){var Q=Math.PI*(1-2*(N+.5)/Math.pow(2,U)),ee=Math.atan(.5*(Math.exp(Q)-Math.exp(-Q)))/b;return new T(ee,Z)},I.units.get=function(){return h},T.prototype.distance=function(N,U){var Z=F(N[0]-U[0])*this.kx,Q=(N[1]-U[1])*this.ky;return Math.sqrt(Z*Z+Q*Q)},T.prototype.bearing=function(N,U){var Z=F(U[0]-N[0])*this.kx;return Math.atan2(Z,(U[1]-N[1])*this.ky)/b},T.prototype.destination=function(N,U,Z){var Q=Z*b;return this.offset(N,Math.sin(Q)*U,Math.cos(Q)*U)},T.prototype.offset=function(N,U,Z){return[N[0]+U/this.kx,N[1]+Z/this.ky]},T.prototype.lineDistance=function(N){for(var U=0,Z=0;Z<N.length-1;Z++)U+=this.distance(N[Z],N[Z+1]);return U},T.prototype.area=function(N){for(var U=0,Z=0;Z<N.length;Z++)for(var Q=N[Z],ee=0,ie=Q.length,oe=ie-1;ee<ie;oe=ee++)U+=F(Q[ee][0]-Q[oe][0])*(Q[ee][1]+Q[oe][1])*(Z?-1:1);return Math.abs(U)/2*this.kx*this.ky},T.prototype.along=function(N,U){var Z=0;if(U<=0)return N[0];for(var Q=0;Q<N.length-1;Q++){var ee=N[Q],ie=N[Q+1],oe=this.distance(ee,ie);if((Z+=oe)>U)return k(ee,ie,(U-(Z-oe))/oe)}return N[N.length-1]},T.prototype.pointToSegmentDistance=function(N,U,Z){var Q=U[0],ee=U[1],ie=F(Z[0]-Q)*this.kx,oe=(Z[1]-ee)*this.ky,_e=0;return ie===0&&oe===0||((_e=(F(N[0]-Q)*this.kx*ie+(N[1]-ee)*this.ky*oe)/(ie*ie+oe*oe))>1?(Q=Z[0],ee=Z[1]):_e>0&&(Q+=ie/this.kx*_e,ee+=oe/this.ky*_e)),ie=F(N[0]-Q)*this.kx,oe=(N[1]-ee)*this.ky,Math.sqrt(ie*ie+oe*oe)},T.prototype.pointOnLine=function(N,U){for(var Z,Q,ee,ie,oe=1/0,_e=0;_e<N.length-1;_e++){var Se=N[_e][0],xe=N[_e][1],Re=F(N[_e+1][0]-Se)*this.kx,Te=(N[_e+1][1]-xe)*this.ky,Be=0;Re===0&&Te===0||((Be=(F(U[0]-Se)*this.kx*Re+(U[1]-xe)*this.ky*Te)/(Re*Re+Te*Te))>1?(Se=N[_e+1][0],xe=N[_e+1][1]):Be>0&&(Se+=Re/this.kx*Be,xe+=Te/this.ky*Be));var Ne=(Re=F(U[0]-Se)*this.kx)*Re+(Te=(U[1]-xe)*this.ky)*Te;Ne<oe&&(oe=Ne,Z=Se,Q=xe,ee=_e,ie=Be)}return{point:[Z,Q],index:ee,t:Math.max(0,Math.min(1,ie))}},T.prototype.lineSlice=function(N,U,Z){var Q=this.pointOnLine(Z,N),ee=this.pointOnLine(Z,U);if(Q.index>ee.index||Q.index===ee.index&&Q.t>ee.t){var ie=Q;Q=ee,ee=ie}var oe=[Q.point],_e=Q.index+1,Se=ee.index;!L(Z[_e],oe[0])&&_e<=Se&&oe.push(Z[_e]);for(var xe=_e+1;xe<=Se;xe++)oe.push(Z[xe]);return L(Z[Se],ee.point)||oe.push(ee.point),oe},T.prototype.lineSliceAlong=function(N,U,Z){for(var Q=0,ee=[],ie=0;ie<Z.length-1;ie++){var oe=Z[ie],_e=Z[ie+1],Se=this.distance(oe,_e);if((Q+=Se)>N&&ee.length===0&&ee.push(k(oe,_e,(N-(Q-Se))/Se)),Q>=U)return ee.push(k(oe,_e,(U-(Q-Se))/Se)),ee;Q>N&&ee.push(_e)}return ee},T.prototype.bufferPoint=function(N,U){var Z=U/this.ky,Q=U/this.kx;return[N[0]-Q,N[1]-Z,N[0]+Q,N[1]+Z]},T.prototype.bufferBBox=function(N,U){var Z=U/this.ky,Q=U/this.kx;return[N[0]-Q,N[1]-Z,N[2]+Q,N[3]+Z]},T.prototype.insideBBox=function(N,U){return F(N[0]-U[0])>=0&&F(N[0]-U[2])<=0&&N[1]>=U[1]&&N[1]<=U[3]},Object.defineProperties(T,I),T}()})(Aw);var rp=z(Aw.exports),Xv={exports:{}};(function(u,s){u.exports=function(){var h=function(_,b){if(_===void 0&&(_=[]),b===void 0&&(b=p),this.data=_,this.length=this.data.length,this.compare=b,this.length>0)for(var T=(this.length>>1)-1;T>=0;T--)this._down(T)};function p(_,b){return _<b?-1:_>b?1:0}return h.prototype.push=function(_){this.data.push(_),this.length++,this._up(this.length-1)},h.prototype.pop=function(){if(this.length!==0){var _=this.data[0],b=this.data.pop();return this.length--,this.length>0&&(this.data[0]=b,this._down(0)),_}},h.prototype.peek=function(){return this.data[0]},h.prototype._up=function(_){for(var b=this.data,T=this.compare,I=b[_];_>0;){var L=_-1>>1,k=b[L];if(T(I,k)>=0)break;b[_]=k,_=L}b[_]=I},h.prototype._down=function(_){for(var b=this.data,T=this.compare,I=this.length>>1,L=b[_];_<I;){var k=1+(_<<1),F=b[k],N=k+1;if(N<this.length&&T(b[N],F)<0&&(k=N,F=b[N]),T(F,L)>=0)break;b[_]=F,_=k}b[_]=L},h}()})(Xv);var Qv=z(Xv.exports),ir=8192;function Pc(u,s){return s.dist-u.dist}const t0=100,r0=50;function Cw(u){const s=[1/0,1/0,-1/0,-1/0];if(s.length!==u.length)return!1;for(let h=0;h<s.length;h++)if(s[h]!==u[h])return!1;return!0}function Kv(u){return u[1]-u[0]+1}function Zl(u,s){const h=u[1]>=u[0]&&u[1]<s;return h||console.warn("Distance Expression: Index is out of range"),h}function Jv(u,s){if(u[0]>u[1])return[null,null];const h=Kv(u);if(s){if(h===2)return[u,null];const p=Math.floor(h/2);return[[u[0],u[0]+p],[u[0]+p,u[1]]]}{if(h===1)return[u,null];const p=Math.floor(h/2)-1;return[[u[0],u[0]+p],[u[0]+p+1,u[1]]]}}function ql(u,s){const h=[1/0,1/0,-1/0,-1/0];if(!Zl(s,u.length))return h;for(let p=s[0];p<=s[1];++p)Kd(h,u[p]);return h}function em(u){const s=[1/0,1/0,-1/0,-1/0];for(let h=0;h<u.length;++h)for(let p=0;p<u[h].length;++p)Kd(s,u[h][p]);return s}function Uh(u,s,h){if(Cw(u)||Cw(s))return NaN;let p=0,_=0;return u[2]<s[0]&&(p=s[0]-u[2]),u[0]>s[2]&&(p=u[0]-s[2]),u[1]>s[3]&&(_=u[1]-s[3]),u[3]<s[1]&&(_=s[1]-u[3]),h.distance([0,0],[p,_])}function nE(u){return 360*u-180}function iE(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function n0(u,s){const h=Math.pow(2,s.z),p=(u.y/ir+s.y)/h;return[nE((u.x/ir+s.x)/h),iE(p)]}function aE(u,s){const h=[];for(let p=0;p<u.length;++p)h.push(n0(u[p],s));return h}function Mw(u,s,h){const p=h.pointOnLine(s,u).point;return h.distance(u,p)}function Iw(u,s,h,p,_){const b=h.slice(p[0],p[1]+1);let T=1/0;for(let I=s[0];I<=s[1];++I)if((T=Math.min(T,Mw(u[I],b,_)))===0)return 0;return T}function i0(u,s,h,p,_){const b=Math.min(_.pointToSegmentDistance(u,h,p),_.pointToSegmentDistance(s,h,p)),T=Math.min(_.pointToSegmentDistance(h,u,s),_.pointToSegmentDistance(p,u,s));return Math.min(b,T)}function $h(u,s,h,p,_){if(!Zl(s,u.length)||!Zl(p,h.length))return NaN;let b=1/0;for(let T=s[0];T<s[1];++T)for(let I=p[0];I<p[1];++I){if(Gh(u[T],u[T+1],h[I],h[I+1]))return 0;b=Math.min(b,i0(u[T],u[T+1],h[I],h[I+1],_))}return b}function Ew(u,s,h,p,_){if(!Zl(s,u.length)||!Zl(p,h.length))return NaN;let b=1/0;for(let T=s[0];T<=s[1];++T)for(let I=p[0];I<=p[1];++I)if((b=Math.min(b,_.distance(u[T],h[I])))===0)return b;return b}function Dw(u,s,h){if(Ec(u,s,!0))return 0;let p=1/0;for(const _ of s){const b=_.length;if(b<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(_[0]!==_[b-1]&&(p=Math.min(p,h.pointToSegmentDistance(u,_[b-1],_[0])))===0||(p=Math.min(p,Mw(u,_,h)))===0)return p}return p}function tm(u,s,h,p){if(!Zl(s,u.length))return NaN;for(let b=s[0];b<=s[1];++b)if(Ec(u[b],h,!0))return 0;let _=1/0;for(let b=s[0];b<s[1];++b)for(const T of h)for(let I=0,L=T.length,k=L-1;I<L;k=I++){if(Gh(u[b],u[b+1],T[k],T[I]))return 0;_=Math.min(_,i0(u[b],u[b+1],T[k],T[I],p))}return _}function Pw(u,s){for(const h of u)for(let p=0;p<=h.length-1;++p)if(Ec(h[p],s,!0))return!0;return!1}function oE(u,s,h,p=1/0){const _=em(u),b=em(s);if(p!==1/0&&Uh(_,b,h)>=p)return p;if(Jd(_,b)){if(Pw(u,s))return 0}else if(Pw(s,u))return 0;let T=p;for(const I of u)for(let L=0,k=I.length,F=k-1;L<k;F=L++)for(const N of s)for(let U=0,Z=N.length,Q=Z-1;U<Z;Q=U++){if(Gh(I[F],I[L],N[Q],N[U]))return 0;T=Math.min(T,i0(I[F],I[L],N[Q],N[U],h))}return T}function Ns(u,s,h,p,_,b,T){if(b===null||T===null)return;const I=Uh(ql(p,b),ql(_,T),h);I<s&&u.push({dist:I,range1:b,range2:T})}function Lw(u,s,h,p,_=1/0){let b=Math.min(p.distance(u[0],h[0][0]),_);if(b===0)return b;const T=new Qv([{dist:0,range1:[0,u.length-1],range2:[0,0]}],Pc),I=s?r0:t0,L=em(h);for(;T.length;){const k=T.pop();if(k.dist>=b)continue;const F=k.range1;if(Kv(F)<=I){if(!Zl(F,u.length))return NaN;if(s){const N=tm(u,F,h,p);if((b=Math.min(b,N))===0)return b}else for(let N=F[0];N<=F[1];++N){const U=Dw(u[N],h,p);if((b=Math.min(b,U))===0)return b}}else{const N=Jv(F,s);if(N[0]!==null){const U=Uh(ql(u,N[0]),L,p);U<b&&T.push({dist:U,range1:N[0],range2:[0,0]})}if(N[1]!==null){const U=Uh(ql(u,N[1]),L,p);U<b&&T.push({dist:U,range1:N[1],range2:[0,0]})}}}return b}function Lc(u,s,h,p,_,b=1/0){let T=Math.min(b,_.distance(u[0],h[0]));if(T===0)return T;const I=new Qv([{dist:0,range1:[0,u.length-1],range2:[0,h.length-1]}],Pc),L=s?r0:t0,k=p?r0:t0;for(;I.length;){const F=I.pop();if(F.dist>=T)continue;const N=F.range1,U=F.range2;if(Kv(N)<=L&&Kv(U)<=k){if(!Zl(N,u.length)||!Zl(U,h.length))return NaN;if(s&&p?T=Math.min(T,$h(u,N,h,U,_)):s||p?s&&!p?T=Math.min(T,Iw(h,U,u,N,_)):!s&&p&&(T=Math.min(T,Iw(u,N,h,U,_))):T=Math.min(T,Ew(u,N,h,U,_)),T===0)return T}else{const Z=Jv(N,s),Q=Jv(U,p);Ns(I,T,_,u,h,Z[0],Q[0]),Ns(I,T,_,u,h,Z[0],Q[1]),Ns(I,T,_,u,h,Z[1],Q[0]),Ns(I,T,_,u,h,Z[1],Q[1])}}return T}function a0(u,s,h,p,_=1/0){let b=_;const T=ql(u,[0,u.length-1]);for(const I of h)if(!(b!==1/0&&Uh(T,ql(I,[0,I.length-1]),p)>=b)&&(b=Math.min(b,Lc(u,s,I,!0,p,b)),b===0))return b;return b}function rm(u,s,h,p,_=1/0){let b=_;const T=ql(u,[0,u.length-1]);for(const I of h){if(b!==1/0&&Uh(T,em(I),p)>=b)continue;const L=Lw(u,s,I,p,b);if(isNaN(L))return L;if((b=Math.min(b,L))===0)return b}return b}function o0(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class Rc{constructor(s,h){this.type=pr,this.geojson=s,this.geometries=h}static parse(s,h){if(s.length!==2)return h.error(`'distance' expression requires either one argument, but found ' ${s.length-1} instead.`);if(Nh(s[1])){const p=s[1];if(p.type==="FeatureCollection"){for(let _=0;_<p.features.length;++_)if(o0(p.features[_].geometry.type))return new Rc(p,p.features[_].geometry)}else if(p.type==="Feature"){if(o0(p.geometry.type))return new Rc(p,p.geometry)}else if(o0(p.type))return new Rc(p,p)}return h.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(s){const h=s.geometry(),p=s.canonicalID();if(h!=null&&p!=null){if(s.geometryType()==="Point")return function(_,b,T){const I=[];for(const k of _)for(const F of k)I.push(n0(F,b));const L=new rp(I[0][1],"meters");return T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString"?Lc(I,!1,T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",L):T.type==="MultiLineString"?a0(I,!1,T.coordinates,L):T.type==="Polygon"||T.type==="MultiPolygon"?rm(I,!1,T.type==="Polygon"?[T.coordinates]:T.coordinates,L):null}(h,p,this.geometries);if(s.geometryType()==="LineString")return function(_,b,T){const I=[];for(const k of _){const F=[];for(const N of k)F.push(n0(N,b));I.push(F)}const L=new rp(I[0][0][1],"meters");if(T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString")return a0(T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",I,L);if(T.type==="MultiLineString"){let k=1/0;for(let F=0;F<T.coordinates.length;F++){const N=a0(T.coordinates[F],!0,I,L,k);if(isNaN(N))return N;if((k=Math.min(k,N))===0)return k}return k}if(T.type==="Polygon"||T.type==="MultiPolygon"){let k=1/0;for(let F=0;F<I.length;F++){const N=rm(I[F],!0,T.type==="Polygon"?[T.coordinates]:T.coordinates,L,k);if(isNaN(N))return N;if((k=Math.min(k,N))===0)return k}return k}return null}(h,p,this.geometries);if(s.geometryType()==="Polygon")return function(_,b,T){const I=[];for(const k of function(F,N){const U=F.length;if(U<=1)return[F];const Z=[];let Q,ee;for(let ie=0;ie<U;ie++){const oe=JI(F[ie]);oe!==0&&(F[ie].area=Math.abs(oe),ee===void 0&&(ee=oe<0),ee===oe<0?(Q&&Z.push(Q),Q=[F[ie]]):Q.push(F[ie]))}return Q&&Z.push(Q),Z}(_)){const F=[];for(let N=0;N<k.length;++N)F.push(aE(k[N],b));I.push(F)}const L=new rp(I[0][0][0][1],"meters");if(T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString")return rm(T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",I,L);if(T.type==="MultiLineString"){let k=1/0;for(let F=0;F<T.coordinates.length;F++){const N=rm(T.coordinates[F],!0,I,L,k);if(isNaN(N))return N;if((k=Math.min(k,N))===0)return k}return k}return T.type==="Polygon"||T.type==="MultiPolygon"?function(k,F,N){let U=1/0;for(const Z of k)for(const Q of F){const ee=oE(Z,Q,N,U);if(isNaN(ee))return ee;if((U=Math.min(U,ee))===0)return U}return U}(T.type==="Polygon"?[T.coordinates]:T.coordinates,I,L):null}(h,p,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function s0(u,s){switch(u){case"string":return cs(s);case"number":return+s;case"boolean":return!!s;case"color":return Jn.parse(s);case"formatted":return Ha.fromString(cs(s));case"resolvedImage":return jo.fromString(cs(s))}return s}function l0(u,s,h,p){return p!==void 0&&(u=p*Math.round(u/p)),s!==void 0&&u<s&&(u=s),h!==void 0&&u>h&&(u=h),u}class Ru{constructor(s,h,p){this.type=s,this.key=h,this.scope=p}static parse(s,h){let p=h.expectedType;if(p==null&&(p=zn),s.length<2||s.length>3)return h.error("Invalid number of arguments for 'config' expression.");const _=h.parse(s[1],1);if(!(_ instanceof al))return h.error("Key name of 'config' expression must be a string literal.");if(s.length>=3){const b=h.parse(s[2],2);return b instanceof al?new Ru(p,cs(_.value),cs(b.value)):h.error("Scope of 'config' expression must be a string literal.")}return new Ru(p,cs(_.value))}evaluate(s){const h=[this.key,this.scope,s.scope].filter(Boolean).join(""),p=s.getConfig(h);if(!p)return null;const{type:_,value:b,values:T,minValue:I,maxValue:L,stepValue:k}=p,F=p.default.evaluate(s);let N=F;if(b){const U=s.scope;s.scope=(U||"").split("").slice(1).join(""),N=b.evaluate(s),s.scope=U}return _&&(N=s0(_,N)),N===void 0||I===void 0&&L===void 0&&k===void 0||(typeof N=="number"?N=l0(N,I,L,k):Array.isArray(N)&&(N=N.map(U=>typeof U=="number"?l0(U,I,L,k):U))),b!==void 0&&N!==void 0&&T&&!T.includes(N)&&(N=F,_&&(N=s0(_,N))),(_&&_!==this.type||N!==void 0&&la(N)!==this.type)&&(N=s0(this.type.kind,N)),N}eachChild(){}outputDefined(){return!1}serialize(){const s=["config",this.key];return this.scope&&s.concat(this.key),s}}function ku(u){if(u instanceof Io&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Dc||u instanceof Rc)return!1;let s=!0;return u.eachChild(h=>{s&&!ku(h)&&(s=!1)}),s}function np(u){if(u instanceof Io&&u.name==="feature-state")return!1;let s=!0;return u.eachChild(h=>{s&&!np(h)&&(s=!1)}),s}function ip(u){if(u instanceof Ru)return!1;let s=!0;return u.eachChild(h=>{s&&!ip(h)&&(s=!1)}),s}function ap(u,s){if(u instanceof Io&&s.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(p=>{h&&!ap(p,s)&&(h=!1)}),h}class Wo{constructor(s,h){this.type=h.type,this.name=s,this.boundExpression=h}static parse(s,h){if(s.length!==2||typeof s[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=s[1];return h.scope.has(p)?new Wo(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class nm{constructor(s,h=[],p,_=new Du,b=[],T,I){this.registry=s,this.path=h,this.key=h.map(L=>`[${L}]`).join(""),this.scope=_,this.errors=b,this.expectedType=p,this._scope=T,this.options=I}parse(s,h,p,_,b={}){return h||p?this.concat(h,p,_)._parse(s,b):this._parse(s,b)}_parse(s,h){function p(_,b,T){return T==="assert"?new Fs(b,[_]):T==="coerce"?new Wl(b,[_]):_}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=typeof s[0]=="string"?this.registry[s[0]]:void 0;if(_){let b=_.parse(s,this);if(!b)return null;if(this.expectedType){const T=this.expectedType,I=b.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||I.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string"){if(this.checkSubtype(T,I))return null}else b=p(b,T,h.typeAnnotation||"coerce");else b=p(b,T,h.typeAnnotation||"assert")}if(!(b instanceof al)&&b.type.kind!=="resolvedImage"&&im(b)){const T=new qy(this._scope,this.options);try{b=new al(b.type,b.evaluate(T))}catch(I){return this.error(I.message),null}}return b}return Wl.parse(["to-array",s],this)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,h,p){const _=typeof s=="number"?this.path.concat(s):this.path,b=p?this.scope.concat(p):this.scope;return new nm(this.registry,_,h||null,b,this.errors,this._scope,this.options)}error(s,...h){const p=`${this.key}${h.map(_=>`[${_}]`).join("")}`;this.errors.push(new Bs(p,s))}checkSubtype(s,h){const p=qd(s,h);return p&&this.error(p),p}}function im(u){if(u instanceof Wo)return im(u.boundExpression);if(u instanceof Io&&u.name==="error"||u instanceof Qd||u instanceof Dc||u instanceof Rc||u instanceof Ru)return!1;const s=u instanceof Wl||u instanceof Fs;let h=!0;return u.eachChild(p=>{h=s?h&&im(p):h&&p instanceof al}),!!h&&ku(u)&&ap(u,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function am(u,s){const h=u.length-1;let p,_,b=0,T=h,I=0;for(;b<=T;)if(I=Math.floor((b+T)/2),p=u[I],_=u[I+1],p<=s){if(I===h||s<_)return I;b=I+1}else{if(!(p>s))throw new _a("Input is not a number.");T=I-1}return 0}class op{constructor(s,h,p){this.type=s,this.input=h,this.labels=[],this.outputs=[];for(const[_,b]of p)this.labels.push(_),this.outputs.push(b)}static parse(s,h){if(s.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(s[1],1,pr);if(!p)return null;const _=[];let b=null;h.expectedType&&h.expectedType.kind!=="value"&&(b=h.expectedType);for(let T=1;T<s.length;T+=2){const I=T===1?-1/0:s[T],L=s[T+1],k=T,F=T+1;if(typeof I!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(_.length&&_[_.length-1][0]>=I)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const N=h.parse(L,F,b);if(!N)return null;b=b||N.type,_.push([I,N])}return new op(b,p,_)}evaluate(s){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(s);const _=this.input.evaluate(s);if(_<=h[0])return p[0].evaluate(s);const b=h.length;return _>=h[b-1]?p[b-1].evaluate(s):p[am(h,_)].evaluate(s)}eachChild(s){s(this.input);for(const h of this.outputs)s(h)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let h=0;h<this.labels.length;h++)h>0&&s.push(this.labels[h]),s.push(this.outputs[h].serialize());return s}}const Rw=.95047,kw=1.08883,om=4/29,kc=6/29,Ow=3*kc*kc,zw=kc*kc*kc,sE=Math.PI/180,Bw=180/Math.PI;function Hh(u){return u>zw?Math.pow(u,1/3):u/Ow+om}function u0(u){return u>kc?u*u*u:Ow*(u-om)}function c0(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function h0(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Fw(u){const s=h0(u.r),h=h0(u.g),p=h0(u.b),_=Hh((.4124564*s+.3575761*h+.1804375*p)/Rw),b=Hh((.2126729*s+.7151522*h+.072175*p)/1);return{l:116*b-16,a:500*(_-b),b:200*(b-Hh((.0193339*s+.119192*h+.9503041*p)/kw)),alpha:u.a}}function Nw(u){let s=(u.l+16)/116,h=isNaN(u.a)?s:s+u.a/500,p=isNaN(u.b)?s:s-u.b/200;return s=1*u0(s),h=Rw*u0(h),p=kw*u0(p),new Jn(c0(3.2404542*h-1.5371385*s-.4985314*p),c0(-.969266*h+1.8760108*s+.041556*p),c0(.0556434*h-.2040259*s+1.0572252*p),u.alpha)}function sm(u,s,h){const p=s-u;return u+h*(p>180||p<-180?p-360*Math.round(p/360):p)}const Ou={forward:Fw,reverse:Nw,interpolate:function(u,s,h){return{l:cn(u.l,s.l,h),a:cn(u.a,s.a,h),b:cn(u.b,s.b,h),alpha:cn(u.alpha,s.alpha,h)}}},ja={forward:function(u){const{l:s,a:h,b:p}=Fw(u),_=Math.atan2(p,h)*Bw;return{h:_<0?_+360:_,c:Math.sqrt(h*h+p*p),l:s,alpha:u.a}},reverse:function(u){const s=u.h*sE,h=u.c;return Nw({l:u.l,a:Math.cos(s)*h,b:Math.sin(s)*h,alpha:u.alpha})},interpolate:function(u,s,h){return{h:sm(u.h,s.h,h),c:cn(u.c,s.c,h),l:cn(u.l,s.l,h),alpha:cn(u.alpha,s.alpha,h)}}};var sp=Object.freeze({__proto__:null,hcl:ja,lab:Ou});class Zo{constructor(s,h,p,_,b){this.type=s,this.operator=h,this.interpolation=p,this.input=_,this.labels=[],this.outputs=[];for(const[T,I]of b)this.labels.push(T),this.outputs.push(I)}static interpolationFactor(s,h,p,_){let b=0;if(s.name==="exponential")b=f0(h,s.base,p,_);else if(s.name==="linear")b=f0(h,1,p,_);else if(s.name==="cubic-bezier"){const T=s.controlPoints;b=new sw(T[0],T[1],T[2],T[3]).solve(f0(h,1,p,_))}return b}static parse(s,h){let[p,_,b,...T]=s;if(!Array.isArray(_)||_.length===0)return h.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const k=_[1];if(typeof k!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:k}}else{if(_[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const k=_.slice(1);if(k.length!==4||k.some(F=>typeof F!="number"||F<0||F>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:k}}}if(s.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(b=h.parse(b,2,pr),!b)return null;const I=[];let L=null;p==="interpolate-hcl"||p==="interpolate-lab"?L=Ho:h.expectedType&&h.expectedType.kind!=="value"&&(L=h.expectedType);for(let k=0;k<T.length;k+=2){const F=T[k],N=T[k+1],U=k+3,Z=k+4;if(typeof F!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(I.length&&I[I.length-1][0]>=F)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const Q=h.parse(N,Z,L);if(!Q)return null;L=L||Q.type,I.push([F,Q])}return L.kind==="number"||L.kind==="color"||L.kind==="array"&&L.itemType.kind==="number"&&typeof L.N=="number"?new Zo(L,p,_,b,I):h.error(`Type ${Yi(L)} is not interpolatable.`)}evaluate(s){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(s);const _=this.input.evaluate(s);if(_<=h[0])return p[0].evaluate(s);const b=h.length;if(_>=h[b-1])return p[b-1].evaluate(s);const T=am(h,_),I=Zo.interpolationFactor(this.interpolation,_,h[T],h[T+1]),L=p[T].evaluate(s),k=p[T+1].evaluate(s);return this.operator==="interpolate"?Wd[this.type.kind.toLowerCase()](L,k,I):this.operator==="interpolate-hcl"?ja.reverse(ja.interpolate(ja.forward(L),ja.forward(k),I)):Ou.reverse(Ou.interpolate(Ou.forward(L),Ou.forward(k),I))}eachChild(s){s(this.input);for(const h of this.outputs)s(h)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const h=[this.operator,s,this.input.serialize()];for(let p=0;p<this.labels.length;p++)h.push(this.labels[p],this.outputs[p].serialize());return h}}function f0(u,s,h,p){const _=p-h,b=u-h;return _===0?0:s===1?b/_:(Math.pow(s,b)-1)/(Math.pow(s,_)-1)}class lm{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expectected at least one argument.");let p=null;const _=h.expectedType;_&&_.kind!=="value"&&(p=_);const b=[];for(const I of s.slice(1)){const L=h.parse(I,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!L)return null;p=p||L.type,b.push(L)}const T=_&&b.some(I=>qd(_,I.type));return new lm(T?zn:p,b)}evaluate(s){let h,p=null,_=0;for(const b of this.args){if(_++,p=b.evaluate(s),p&&p instanceof jo&&!p.available&&(h||(h=p),p=null,_===this.args.length))return h;if(p!==null)break}return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(h=>{s.push(h.serialize())}),s}}class um{constructor(s,h){this.type=h.type,this.bindings=[].concat(s),this.result=h}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const h of this.bindings)s(h[1]);s(this.result)}static parse(s,h){if(s.length<4)return h.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let b=1;b<s.length-1;b+=2){const T=s[b];if(typeof T!="string")return h.error(`Expected string, but found ${typeof T} instead.`,b);if(/[^a-zA-Z0-9_]/.test(T))return h.error("Variable names must contain only alphanumeric characters or '_'.",b);const I=h.parse(s[b+1],b+1);if(!I)return null;p.push([T,I])}const _=h.parse(s[s.length-1],s.length-1,h.expectedType,p);return _?new um(p,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[h,p]of this.bindings)s.push(h,p.serialize());return s.push(this.result.serialize()),s}}class lp{constructor(s,h,p){this.type=s,this.index=h,this.input=p}static parse(s,h){if(s.length!==3)return h.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,pr),_=h.parse(s[2],2,Aa(h.expectedType||zn));return p&&_?new lp(_.type.itemType,p,_):null}evaluate(s){const h=this.index.evaluate(s),p=this.input.evaluate(s);if(h<0)throw new _a(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new _a(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new _a(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class d0{constructor(s,h){this.type=Yn,this.needle=s,this.haystack=h}static parse(s,h){if(s.length!==3)return h.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,zn),_=h.parse(s[2],2,zn);return p&&_?Yd(p.type,[Yn,qn,pr,dn,zn])?new d0(p,_):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Yi(p.type)} instead`):null}evaluate(s){const h=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(p==null)return!1;if(!Ic(h,["boolean","string","number","null"]))throw new _a(`Expected first argument to be of type boolean, string, number or null, but found ${Yi(la(h))} instead.`);if(!Ic(p,["string","array"]))throw new _a(`Expected second argument to be of type array or string, but found ${Yi(la(p))} instead.`);return p.indexOf(h)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class jh{constructor(s,h,p){this.type=pr,this.needle=s,this.haystack=h,this.fromIndex=p}static parse(s,h){if(s.length<=2||s.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,zn),_=h.parse(s[2],2,zn);if(!p||!_)return null;if(!Yd(p.type,[Yn,qn,pr,dn,zn]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Yi(p.type)} instead`);if(s.length===4){const b=h.parse(s[3],3,pr);return b?new jh(p,_,b):null}return new jh(p,_)}evaluate(s){const h=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!Ic(h,["boolean","string","number","null"]))throw new _a(`Expected first argument to be of type boolean, string, number or null, but found ${Yi(la(h))} instead.`);if(!Ic(p,["string","array"]))throw new _a(`Expected second argument to be of type array or string, but found ${Yi(la(p))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(s);return p.indexOf(h,_)}return p.indexOf(h)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class p0{constructor(s,h,p,_,b,T){this.inputType=s,this.type=h,this.input=p,this.cases=_,this.outputs=b,this.otherwise=T}static parse(s,h){if(s.length<5)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return h.error("Expected an even number of arguments.");let p,_;h.expectedType&&h.expectedType.kind!=="value"&&(_=h.expectedType);const b={},T=[];for(let k=2;k<s.length-1;k+=2){let F=s[k];const N=s[k+1];Array.isArray(F)||(F=[F]);const U=h.concat(k);if(F.length===0)return U.error("Expected at least one branch label.");for(const Q of F){if(typeof Q!="number"&&typeof Q!="string")return U.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return U.error("Numeric branch labels must be integer values.");if(p){if(U.checkSubtype(p,la(Q)))return null}else p=la(Q);if(b[String(Q)]!==void 0)return U.error("Branch labels must be unique.");b[String(Q)]=T.length}const Z=h.parse(N,k,_);if(!Z)return null;_=_||Z.type,T.push(Z)}const I=h.parse(s[1],1,zn);if(!I)return null;const L=h.parse(s[s.length-1],s.length-1,_);return L?I.type.kind!=="value"&&h.concat(1).checkSubtype(p,I.type)?null:new p0(p,_,I,b,T,L):null}evaluate(s){const h=this.input.evaluate(s);return(la(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],h=Object.keys(this.cases).sort(),p=[],_={};for(const T of h){const I=_[this.cases[T]];I===void 0?(_[this.cases[T]]=p.length,p.push([this.cases[T],[T]])):p[I][1].push(T)}const b=T=>this.inputType.kind==="number"?Number(T):T;for(const[T,I]of p)s.push(I.length===1?b(I[0]):I.map(b)),s.push(this.outputs[T].serialize());return s.push(this.otherwise.serialize()),s}}class g0{constructor(s,h,p){this.type=s,this.branches=h,this.otherwise=p}static parse(s,h){if(s.length<4)return h.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const _=[];for(let T=1;T<s.length-1;T+=2){const I=h.parse(s[T],T,Yn);if(!I)return null;const L=h.parse(s[T+1],T+1,p);if(!L)return null;_.push([I,L]),p=p||L.type}const b=h.parse(s[s.length-1],s.length-1,p);return b?new g0(p,_,b):null}evaluate(s){for(const[h,p]of this.branches)if(h.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[h,p]of this.branches)s(h),s(p);s(this.otherwise)}outputDefined(){return this.branches.every(([s,h])=>h.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(h=>{s.push(h.serialize())}),s}}class Wh{constructor(s,h,p,_){this.type=s,this.input=h,this.beginIndex=p,this.endIndex=_}static parse(s,h){if(s.length<=2||s.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,zn),_=h.parse(s[2],2,pr);if(!p||!_)return null;if(!Yd(p.type,[Aa(zn),qn,zn]))return h.error(`Expected first argument to be of type array or string, but found ${Yi(p.type)} instead`);if(s.length===4){const b=h.parse(s[3],3,pr);return b?new Wh(p.type,p,_,b):null}return new Wh(p.type,p,_)}evaluate(s){const h=this.input.evaluate(s),p=this.beginIndex.evaluate(s);if(!Ic(h,["string","array"]))throw new _a(`Expected first argument to be of type array or string, but found ${Yi(la(h))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(s);return h.slice(p,_)}return h.slice(p)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Vw(u,s){return u==="=="||u==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function v0(u,s,h,p){return p.compare(s,h)===0}function Oc(u,s,h){const p=u!=="=="&&u!=="!=";return class Zq{constructor(b,T,I){this.type=Yn,this.lhs=b,this.rhs=T,this.collator=I,this.hasUntypedArgument=b.type.kind==="value"||T.type.kind==="value"}static parse(b,T){if(b.length!==3&&b.length!==4)return T.error("Expected two or three arguments.");const I=b[0];let L=T.parse(b[1],1,zn);if(!L)return null;if(!Vw(I,L.type))return T.concat(1).error(`"${I}" comparisons are not supported for type '${Yi(L.type)}'.`);let k=T.parse(b[2],2,zn);if(!k)return null;if(!Vw(I,k.type))return T.concat(2).error(`"${I}" comparisons are not supported for type '${Yi(k.type)}'.`);if(L.type.kind!==k.type.kind&&L.type.kind!=="value"&&k.type.kind!=="value")return T.error(`Cannot compare types '${Yi(L.type)}' and '${Yi(k.type)}'.`);p&&(L.type.kind==="value"&&k.type.kind!=="value"?L=new Fs(k.type,[L]):L.type.kind!=="value"&&k.type.kind==="value"&&(k=new Fs(L.type,[k])));let F=null;if(b.length===4){if(L.type.kind!=="string"&&k.type.kind!=="string"&&L.type.kind!=="value"&&k.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(F=T.parse(b[3],3,Zd),!F)return null}return new Zq(L,k,F)}evaluate(b){const T=this.lhs.evaluate(b),I=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const L=la(T),k=la(I);if(L.kind!==k.kind||L.kind!=="string"&&L.kind!=="number")throw new _a(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${L.kind}, ${k.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const L=la(T),k=la(I);if(L.kind!=="string"||k.kind!=="string")return s(b,T,I)}return this.collator?h(b,T,I,this.collator.evaluate(b)):s(b,T,I)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[u];return this.eachChild(T=>{b.push(T.serialize())}),b}}}const lE=Oc("==",function(u,s,h){return s===h},v0),m0=Oc("!=",function(u,s,h){return s!==h},function(u,s,h,p){return!v0(0,s,h,p)}),cm=Oc("<",function(u,s,h){return s<h},function(u,s,h,p){return p.compare(s,h)<0}),Gw=Oc(">",function(u,s,h){return s>h},function(u,s,h,p){return p.compare(s,h)>0}),uE=Oc("<=",function(u,s,h){return s<=h},function(u,s,h,p){return p.compare(s,h)<=0}),Uw=Oc(">=",function(u,s,h){return s>=h},function(u,s,h,p){return p.compare(s,h)>=0});class _0{constructor(s,h,p,_,b,T){this.type=qn,this.number=s,this.locale=h,this.currency=p,this.unit=_,this.minFractionDigits=b,this.maxFractionDigits=T}static parse(s,h){if(s.length!==3)return h.error("Expected two arguments.");const p=h.parse(s[1],1,pr);if(!p)return null;const _=s[2];if(typeof _!="object"||Array.isArray(_))return h.error("NumberFormat options argument must be an object.");let b=null;if(_.locale&&(b=h.parse(_.locale,1,qn),!b))return null;let T=null;if(_.currency&&(T=h.parse(_.currency,1,qn),!T))return null;let I=null;if(_.unit&&(I=h.parse(_.unit,1,qn),!I))return null;let L=null;if(_["min-fraction-digits"]&&(L=h.parse(_["min-fraction-digits"],1,pr),!L))return null;let k=null;return _["max-fraction-digits"]&&(k=h.parse(_["max-fraction-digits"],1,pr),!k)?null:new _0(p,b,T,I,L,k)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class up{constructor(s){this.type=pr,this.input=s}static parse(s,h){if(s.length!==2)return h.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=h.parse(s[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Yi(p.type)} instead.`):new up(p):null}evaluate(s){const h=this.input.evaluate(s);if(typeof h=="string"||Array.isArray(h))return h.length;throw new _a(`Expected value to be of type string or array, but found ${Yi(la(h))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(h=>{s.push(h.serialize())}),s}}function $w(u){return function(){u=1831565813+(u|=0)|0;let s=Math.imul(u^u>>>15,1|u);return s=s+Math.imul(s^s>>>7,61|s)^s,((s^s>>>14)>>>0)/4294967296}}const Zh={"==":lE,"!=":m0,">":Gw,"<":cm,">=":Uw,"<=":uE,array:Fs,at:lp,boolean:Fs,case:g0,coalesce:lm,collator:Qd,format:Xd,image:Vh,in:d0,"index-of":jh,interpolate:Zo,"interpolate-hcl":Zo,"interpolate-lab":Zo,length:up,let:um,literal:al,match:p0,number:Fs,"number-format":_0,object:Fs,slice:Wh,step:op,string:Fs,"to-boolean":Wl,"to-color":Wl,"to-number":Wl,"to-string":Wl,var:Wo,within:Dc,distance:Rc,config:Ru};function Hw(u,[s,h,p,_]){s=s.evaluate(u),h=h.evaluate(u),p=p.evaluate(u);const b=_?_.evaluate(u):1,T=ww(s,h,p,b);if(T)throw new _a(T);return new Jn(s/255*b,h/255*b,p/255*b,b)}function jw(u,[s,h,p,_]){s=s.evaluate(u),h=h.evaluate(u),p=p.evaluate(u);const b=_?_.evaluate(u):1,T=function(k,F,N,U){return typeof k=="number"&&k>=0&&k<=360?typeof F=="number"&&F>=0&&F<=100&&typeof N=="number"&&N>=0&&N<=100?U===void 0||typeof U=="number"&&U>=0&&U<=1?null:`Invalid hsla value [${[k,F,N,U].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof U=="number"?[k,F,N,U]:[k,F,N]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof U=="number"?[k,F,N,U]:[k,F,N]).join(", ")}]: 'h' must be between 0 and 360.`}(s,h,p,b);if(T)throw new _a(T);const I=`hsla(${s}, ${h}%, ${p}%, ${b})`,L=Jn.parse(I);if(!L)throw new _a(`Failed to parse HSLA color: ${I}`);return L}function y0(u,s){return u in s}function x0(u,s){const h=s[u];return h===void 0?null:h}function zc(u){return{type:u}}function Ww(u){return{result:"success",value:u}}function Bc(u){return{result:"error",value:u}}function Zw(u,s){return!!u&&!!u.parameters&&u.parameters.indexOf(s)>-1}function hm(u){return u["property-type"]==="data-driven"}function qw(u){return Zw(u.expression,"measure-light")}function Yw(u){return Zw(u.expression,"zoom")}function qh(u){return!!u.expression&&u.expression.interpolated}function b0(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function cE(u){return u}function cp(u,s){const h=s.type==="color",p=u.stops&&typeof u.stops[0][0]=="object",_=p||!(p||u.property!==void 0),b=u.type||(qh(s)?"exponential":"interval");if(h&&((u=Wv({},u)).stops&&(u.stops=u.stops.map(k=>[k[0],Jn.parse(k[1])])),u.default=Jn.parse(u.default?u.default:s.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!sp[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let T,I,L;if(b==="exponential")T=w0;else if(b==="interval")T=hE;else if(b==="categorical"){T=Xw,I=Object.create(null);for(const k of u.stops)I[k[0]]=k[1];L=typeof u.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);T=Qw}if(p){const k={},F=[];for(let Z=0;Z<u.stops.length;Z++){const Q=u.stops[Z],ee=Q[0].zoom;k[ee]===void 0&&(k[ee]={zoom:ee,type:u.type,property:u.property,default:u.default,stops:[]},F.push(ee)),k[ee].stops.push([Q[0].value,Q[1]])}const N=[];for(const Z of F)N.push([k[Z].zoom,cp(k[Z],s)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Zo.interpolationFactor.bind(void 0,U),zoomStops:N.map(Z=>Z[0]),evaluate:({zoom:Z},Q)=>w0({stops:N,base:u.base},s,Z).evaluate(Z,Q)}}if(_){const k=b==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Zo.interpolationFactor.bind(void 0,k),zoomStops:u.stops.map(F=>F[0]),evaluate:({zoom:F})=>T(u,s,F,I,L)}}return{kind:"source",evaluate(k,F){const N=F&&F.properties?F.properties[u.property]:void 0;return N===void 0?hp(u.default,s.default):T(u,s,N,I,L)}}}function hp(u,s,h){return u!==void 0?u:s!==void 0?s:h!==void 0?h:void 0}function Xw(u,s,h,p,_){return hp(typeof h===_?p[h]:void 0,u.default,s.default)}function hE(u,s,h){if(Pu(h)!=="number")return hp(u.default,s.default);const p=u.stops.length;if(p===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[p-1][0])return u.stops[p-1][1];const _=am(u.stops.map(b=>b[0]),h);return u.stops[_][1]}function w0(u,s,h){const p=u.base!==void 0?u.base:1;if(Pu(h)!=="number")return hp(u.default,s.default);const _=u.stops.length;if(_===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[_-1][0])return u.stops[_-1][1];const b=am(u.stops.map(F=>F[0]),h),T=function(F,N,U,Z){const Q=Z-U,ee=F-U;return Q===0?0:N===1?ee/Q:(Math.pow(N,ee)-1)/(Math.pow(N,Q)-1)}(h,p,u.stops[b][0],u.stops[b+1][0]),I=u.stops[b][1],L=u.stops[b+1][1];let k=Wd[s.type]||cE;if(u.colorSpace&&u.colorSpace!=="rgb"){const F=sp[u.colorSpace];k=(N,U)=>F.reverse(F.interpolate(F.forward(N),F.forward(U),T))}return typeof I.evaluate=="function"?{evaluate(...F){const N=I.evaluate.apply(void 0,F),U=L.evaluate.apply(void 0,F);if(N!==void 0&&U!==void 0)return k(N,U,T)}}:k(I,L,T)}function Qw(u,s,h){return s.type==="color"?h=Jn.parse(h):s.type==="formatted"?h=Ha.fromString(h.toString()):s.type==="resolvedImage"?h=jo.fromString(h.toString()):Pu(h)===s.type||s.type==="enum"&&s.values[h]||(h=void 0),hp(h,u.default,s.default)}Io.register(Zh,{error:[{kind:"error"},[qn],(u,[s])=>{throw new _a(s.evaluate(u))}],typeof:[qn,[zn],(u,[s])=>Yi(la(s.evaluate(u)))],"to-rgba":[Aa(pr,4),[Ho],(u,[s])=>s.evaluate(u).toArray()],rgb:[Ho,[pr,pr,pr],Hw],rgba:[Ho,[pr,pr,pr,pr],Hw],hsl:[Ho,[pr,pr,pr],jw],hsla:[Ho,[pr,pr,pr,pr],jw],has:{type:Yn,overloads:[[[qn],(u,[s])=>y0(s.evaluate(u),u.properties())],[[qn,zh],(u,[s,h])=>y0(s.evaluate(u),h.evaluate(u))]]},get:{type:zn,overloads:[[[qn],(u,[s])=>x0(s.evaluate(u),u.properties())],[[qn,zh],(u,[s,h])=>x0(s.evaluate(u),h.evaluate(u))]]},"feature-state":[zn,[qn],(u,[s])=>x0(s.evaluate(u),u.featureState||{})],properties:[zh,[],u=>u.properties()],"geometry-type":[qn,[],u=>u.geometryType()],id:[zn,[],u=>u.id()],zoom:[pr,[],u=>u.globals.zoom],pitch:[pr,[],u=>u.globals.pitch||0],"distance-from-center":[pr,[],u=>u.distanceFromCenter()],"measure-light":[pr,[qn],(u,[s])=>u.measureLight(s.evaluate(u))],"heatmap-density":[pr,[],u=>u.globals.heatmapDensity||0],"line-progress":[pr,[],u=>u.globals.lineProgress||0],"raster-value":[pr,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[pr,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[pr,[],u=>u.globals.skyRadialProgress||0],accumulated:[zn,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[pr,zc(pr),(u,s)=>{let h=0;for(const p of s)h+=p.evaluate(u);return h}],"*":[pr,zc(pr),(u,s)=>{let h=1;for(const p of s)h*=p.evaluate(u);return h}],"-":{type:pr,overloads:[[[pr,pr],(u,[s,h])=>s.evaluate(u)-h.evaluate(u)],[[pr],(u,[s])=>-s.evaluate(u)]]},"/":[pr,[pr,pr],(u,[s,h])=>s.evaluate(u)/h.evaluate(u)],"%":[pr,[pr,pr],(u,[s,h])=>s.evaluate(u)%h.evaluate(u)],ln2:[pr,[],()=>Math.LN2],pi:[pr,[],()=>Math.PI],e:[pr,[],()=>Math.E],"^":[pr,[pr,pr],(u,[s,h])=>Math.pow(s.evaluate(u),h.evaluate(u))],sqrt:[pr,[pr],(u,[s])=>Math.sqrt(s.evaluate(u))],log10:[pr,[pr],(u,[s])=>Math.log(s.evaluate(u))/Math.LN10],ln:[pr,[pr],(u,[s])=>Math.log(s.evaluate(u))],log2:[pr,[pr],(u,[s])=>Math.log(s.evaluate(u))/Math.LN2],sin:[pr,[pr],(u,[s])=>Math.sin(s.evaluate(u))],cos:[pr,[pr],(u,[s])=>Math.cos(s.evaluate(u))],tan:[pr,[pr],(u,[s])=>Math.tan(s.evaluate(u))],asin:[pr,[pr],(u,[s])=>Math.asin(s.evaluate(u))],acos:[pr,[pr],(u,[s])=>Math.acos(s.evaluate(u))],atan:[pr,[pr],(u,[s])=>Math.atan(s.evaluate(u))],min:[pr,zc(pr),(u,s)=>Math.min(...s.map(h=>h.evaluate(u)))],max:[pr,zc(pr),(u,s)=>Math.max(...s.map(h=>h.evaluate(u)))],abs:[pr,[pr],(u,[s])=>Math.abs(s.evaluate(u))],round:[pr,[pr],(u,[s])=>{const h=s.evaluate(u);return h<0?-Math.round(-h):Math.round(h)}],floor:[pr,[pr],(u,[s])=>Math.floor(s.evaluate(u))],ceil:[pr,[pr],(u,[s])=>Math.ceil(s.evaluate(u))],"filter-==":[Yn,[qn,zn],(u,[s,h])=>u.properties()[s.value]===h.value],"filter-id-==":[Yn,[zn],(u,[s])=>u.id()===s.value],"filter-type-==":[Yn,[qn],(u,[s])=>u.geometryType()===s.value],"filter-<":[Yn,[qn,zn],(u,[s,h])=>{const p=u.properties()[s.value],_=h.value;return typeof p==typeof _&&p<_}],"filter-id-<":[Yn,[zn],(u,[s])=>{const h=u.id(),p=s.value;return typeof h==typeof p&&h<p}],"filter->":[Yn,[qn,zn],(u,[s,h])=>{const p=u.properties()[s.value],_=h.value;return typeof p==typeof _&&p>_}],"filter-id->":[Yn,[zn],(u,[s])=>{const h=u.id(),p=s.value;return typeof h==typeof p&&h>p}],"filter-<=":[Yn,[qn,zn],(u,[s,h])=>{const p=u.properties()[s.value],_=h.value;return typeof p==typeof _&&p<=_}],"filter-id-<=":[Yn,[zn],(u,[s])=>{const h=u.id(),p=s.value;return typeof h==typeof p&&h<=p}],"filter->=":[Yn,[qn,zn],(u,[s,h])=>{const p=u.properties()[s.value],_=h.value;return typeof p==typeof _&&p>=_}],"filter-id->=":[Yn,[zn],(u,[s])=>{const h=u.id(),p=s.value;return typeof h==typeof p&&h>=p}],"filter-has":[Yn,[zn],(u,[s])=>s.value in u.properties()],"filter-has-id":[Yn,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Yn,[Aa(qn)],(u,[s])=>s.value.indexOf(u.geometryType())>=0],"filter-id-in":[Yn,[Aa(zn)],(u,[s])=>s.value.indexOf(u.id())>=0],"filter-in-small":[Yn,[qn,Aa(zn)],(u,[s,h])=>h.value.indexOf(u.properties()[s.value])>=0],"filter-in-large":[Yn,[qn,Aa(zn)],(u,[s,h])=>function(p,_,b,T){for(;b<=T;){const I=b+T>>1;if(_[I]===p)return!0;_[I]>p?T=I-1:b=I+1}return!1}(u.properties()[s.value],h.value,0,h.value.length-1)],all:{type:Yn,overloads:[[[Yn,Yn],(u,[s,h])=>s.evaluate(u)&&h.evaluate(u)],[zc(Yn),(u,s)=>{for(const h of s)if(!h.evaluate(u))return!1;return!0}]]},any:{type:Yn,overloads:[[[Yn,Yn],(u,[s,h])=>s.evaluate(u)||h.evaluate(u)],[zc(Yn),(u,s)=>{for(const h of s)if(h.evaluate(u))return!0;return!1}]]},"!":[Yn,[Yn],(u,[s])=>!s.evaluate(u)],"is-supported-script":[Yn,[qn],(u,[s])=>{const h=u.globals&&u.globals.isSupportedScript;return!h||h(s.evaluate(u))}],upcase:[qn,[qn],(u,[s])=>s.evaluate(u).toUpperCase()],downcase:[qn,[qn],(u,[s])=>s.evaluate(u).toLowerCase()],concat:[qn,zc(zn),(u,s)=>s.map(h=>cs(h.evaluate(u))).join("")],"resolved-locale":[qn,[Zd],(u,[s])=>s.evaluate(u).resolvedLocale()],random:[pr,[pr,pr,zn],(u,s)=>{const[h,p,_]=s.map(T=>T.evaluate(u));if(h>p||h===p)return h;let b;if(typeof _=="string")b=function(T){let I=0;if(T.length===0)return I;for(let L=0;L<T.length;L++)I=(I<<5)-I+T.charCodeAt(L),I|=0;return I}(_);else{if(typeof _!="number")throw new _a(`Invalid seed input: ${_}`);b=_}return h+$w(b)()*(p-h)}]});class fm{constructor(s,h,p,_){this.expression=s,this._warningHistory={},this._evaluator=new qy(p,_),this._defaultValue=h?function(b){return b.type==="color"&&(b0(b.default)||Array.isArray(b.default))?new Jn(0,0,0,0):b.type==="color"?Jn.parse(b.default)||null:b.default===void 0?null:b.default}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(s,h,p,_,b,T,I,L){return this._evaluator.globals=s,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=_||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T,this._evaluator.featureTileCoord=I||null,this._evaluator.featureDistanceData=L||null,this.expression.evaluate(this._evaluator)}evaluate(s,h,p,_,b,T,I,L){this._evaluator.globals=s,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=_||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T||null,this._evaluator.featureTileCoord=I||null,this._evaluator.featureDistanceData=L||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new _a(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function dm(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Zh}function Yh(u,s,h,p){const _=new nm(Zh,[],s?function(T){const I={color:Ho,string:qn,number:pr,enum:qn,boolean:Yn,formatted:Bh,resolvedImage:Fh};return T.type==="array"?Aa(I[T.value]||zn,T.length):I[T.type]}(s):void 0,void 0,void 0,h,p),b=_.parse(u,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return b?Ww(new fm(b,s,h,p)):Bc(_.errors)}class fp{constructor(s,h,p){this.kind=s,this._styleExpression=h,this.isLightConstant=p,this.isStateDependent=s!=="constant"&&!np(h.expression),this.isConfigDependent=!ip(h.expression)}evaluateWithoutErrorHandling(s,h,p,_,b,T){return this._styleExpression.evaluateWithoutErrorHandling(s,h,p,_,b,T)}evaluate(s,h,p,_,b,T){return this._styleExpression.evaluate(s,h,p,_,b,T)}}class dp{constructor(s,h,p,_,b){this.kind=s,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=s!=="camera"&&!np(h.expression),this.isLightConstant=b,this.isConfigDependent=!ip(h.expression),this.interpolationType=_}evaluateWithoutErrorHandling(s,h,p,_,b,T){return this._styleExpression.evaluateWithoutErrorHandling(s,h,p,_,b,T)}evaluate(s,h,p,_,b,T){return this._styleExpression.evaluate(s,h,p,_,b,T)}interpolationFactor(s,h,p){return this.interpolationType?Zo.interpolationFactor(this.interpolationType,s,h,p):0}}function Kw(u,s,h,p){if((u=Yh(u,s,h,p)).result==="error")return u;const _=u.value.expression,b=ku(_);if(!b&&!hm(s))return Bc([new Bs("","data expressions not supported")]);const T=ap(_,["zoom","pitch","distance-from-center"]);if(!T&&!Yw(s))return Bc([new Bs("","zoom expressions not supported")]);const I=ap(_,["measure-light"]);if(!I&&!qw(s))return Bc([new Bs("","measure-light expression not supported")]);const L=s.expression&&s.expression.relaxZoomRestriction,k=pm(_);return k||T||L?k instanceof Bs?Bc([k]):k instanceof Zo&&!qh(s)?Bc([new Bs("",'"interpolate" expressions cannot be used with this property')]):Ww(k?new dp(b?"camera":"composite",u.value,k.labels,k instanceof Zo?k.interpolation:void 0,I):new fp(b?"constant":"source",u.value,I)):Bc([new Bs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class pp{constructor(s,h){this._parameters=s,this._specification=h,Wv(this,cp(this._parameters,this._specification))}static deserialize(s){return new pp(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function pm(u){let s=null;if(u instanceof um)s=pm(u.result);else if(u instanceof lm){for(const h of u.args)if(s=pm(h),s)break}else(u instanceof op||u instanceof Zo)&&u.input instanceof Io&&u.input.name==="zoom"&&(s=u);return s instanceof Bs||u.eachChild(h=>{const p=pm(h);p instanceof Bs?s=p:s&&p&&s!==p&&(s=new Bs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}var Jw=ol,zu=3;function ol(u,s,h){var p=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var _=new Int32Array(this.arrayBuffer);u=_[0],this.d=(s=_[1])+2*(h=_[2]);for(var b=0;b<this.d*this.d;b++){var T=_[zu+b],I=_[zu+b+1];p.push(T===I?null:_.subarray(T,I))}var L=_[zu+p.length+1];this.keys=_.subarray(_[zu+p.length],L),this.bboxes=_.subarray(L),this.insert=this._insertReadonly}else{this.d=s+2*h;for(var k=0;k<this.d*this.d;k++)p.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=u,this.padding=h,this.scale=s/u,this.uid=0;var F=h/s*u;this.min=-F,this.max=u+F}ol.prototype.insert=function(u,s,h,p,_){this._forEachCell(s,h,p,_,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(_)},ol.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ol.prototype._insertCell=function(u,s,h,p,_,b){this.cells[_].push(b)},ol.prototype.query=function(u,s,h,p,_){var b=this.min,T=this.max;if(u<=b&&s<=b&&T<=h&&T<=p&&!_)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(u,s,h,p,this._queryCell,I,{},_),I},ol.prototype._queryCell=function(u,s,h,p,_,b,T,I){var L=this.cells[_];if(L!==null)for(var k=this.keys,F=this.bboxes,N=0;N<L.length;N++){var U=L[N];if(T[U]===void 0){var Z=4*U;(I?I(F[Z+0],F[Z+1],F[Z+2],F[Z+3]):u<=F[Z+2]&&s<=F[Z+3]&&h>=F[Z+0]&&p>=F[Z+1])?(T[U]=!0,b.push(k[U])):T[U]=!1}}},ol.prototype._forEachCell=function(u,s,h,p,_,b,T,I){for(var L=this._convertToCellCoord(u),k=this._convertToCellCoord(s),F=this._convertToCellCoord(h),N=this._convertToCellCoord(p),U=L;U<=F;U++)for(var Z=k;Z<=N;Z++){var Q=this.d*Z+U;if((!I||I(this._convertFromCellCoord(U),this._convertFromCellCoord(Z),this._convertFromCellCoord(U+1),this._convertFromCellCoord(Z+1)))&&_.call(this,u,s,h,p,Q,b,T,I))return}},ol.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},ol.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},ol.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,s=zu+this.cells.length+1+1,h=0,p=0;p<this.cells.length;p++)h+=this.cells[p].length;var _=new Int32Array(s+h+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var b=s,T=0;T<u.length;T++){var I=u[T];_[zu+T]=b,_.set(I,b),b+=I.length}return _[zu+u.length]=b,_.set(this.keys,b),_[zu+u.length+1]=b+=this.keys.length,_.set(this.bboxes,b),b+=this.bboxes.length,_.buffer};var Xh=z(Jw);const gm={};function gr(u,s,h={}){Object.defineProperty(u,"_classRegistryKey",{value:s,writeable:!1}),gm[s]={klass:u,omit:h.omit||[]}}gr(Object,"Object"),Xh.serialize=function(u,s){const h=u.toArrayBuffer();return s&&s.add(h),{buffer:h}},Xh.deserialize=function(u){return new Xh(u.buffer)},Object.defineProperty(Xh,"name",{value:"Grid"}),gr(Xh,"Grid"),gr(Jn,"Color"),gr(Error,"Error"),gr(Ha,"Formatted"),gr(Zv,"FormattedSection"),gr(Ov,"AJAXError"),gr(jo,"ResolvedImage"),gr(pp,"StylePropertyFunction"),gr(fm,"StyleExpression",{omit:["_evaluator"]}),gr(dp,"ZoomDependentExpression"),gr(fp,"ZoomConstantExpression"),gr(Io,"CompoundExpression",{omit:["_evaluate"]});for(const u in Zh)gm[Zh[u]._classRegistryKey]||gr(Zh[u],`Expression${u}`);function eS(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function tS(u){return self.ImageBitmap&&u instanceof ImageBitmap}function gp(u,s){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(eS(u)||tS(u))return s&&s.add(u),u;if(ArrayBuffer.isView(u)){const h=u;return s&&s.add(h.buffer),h}if(u instanceof ImageData)return s&&s.add(u.data.buffer),u;if(Array.isArray(u)){const h=[];for(const p of u)h.push(gp(p,s));return h}if(u instanceof Map){const h={$name:"Map"};for(const[p,_]of u.entries())h[p]=gp(_);return h}if(typeof u=="object"){const h=u.constructor,p=h._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${p}`);const _=h.serialize?h.serialize(u,s):{};if(!h.serialize){for(const b in u)u.hasOwnProperty(b)&&(gm[p].omit.indexOf(b)>=0||(_[b]=gp(u[b],s)));u instanceof Error&&(_.message=u.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(_.$name=p),_}throw new Error("can't serialize object of type "+typeof u)}function w(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||eS(u)||tS(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(w);if(typeof u=="object"){const s=u.$name||"Object";if(s==="Map"){const _=new Map;for(const b of Object.keys(u))b!=="$name"&&_.set(b,w(u[b]));return _}const{klass:h}=gm[s];if(!h)throw new Error(`can't deserialize unregistered class ${s}`);if(h.deserialize)return h.deserialize(u);const p=Object.create(h.prototype);for(const _ of Object.keys(u))_!=="$name"&&(p[_]=w(u[_]));return p}throw new Error("can't deserialize object of type "+typeof u)}const f={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function v(u){for(const s of u)if(E(s.charCodeAt(0)))return!0;return!1}function S(u){for(const s of u)if(!C(s.charCodeAt(0)))return!1;return!0}function C(u){return!(f.Arabic(u)||f["Arabic Supplement"](u)||f["Arabic Extended-A"](u)||f["Arabic Presentation Forms-A"](u)||f["Arabic Presentation Forms-B"](u))}function E(u){return!(u!==746&&u!==747&&(u<4352||!(f["Bopomofo Extended"](u)||f.Bopomofo(u)||f["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||f["CJK Compatibility Ideographs"](u)||f["CJK Compatibility"](u)||f["CJK Radicals Supplement"](u)||f["CJK Strokes"](u)||!(!f["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||f["CJK Unified Ideographs Extension A"](u)||f["CJK Unified Ideographs"](u)||f["Enclosed CJK Letters and Months"](u)||f["Hangul Compatibility Jamo"](u)||f["Hangul Jamo Extended-A"](u)||f["Hangul Jamo Extended-B"](u)||f["Hangul Jamo"](u)||f["Hangul Syllables"](u)||f.Hiragana(u)||f["Ideographic Description Characters"](u)||f.Kanbun(u)||f["Kangxi Radicals"](u)||f["Katakana Phonetic Extensions"](u)||f.Katakana(u)&&u!==12540||!(!f["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!f["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||f["Unified Canadian Aboriginal Syllabics"](u)||f["Unified Canadian Aboriginal Syllabics Extended"](u)||f["Vertical Forms"](u)||f["Yijing Hexagram Symbols"](u)||f["Yi Syllables"](u)||f["Yi Radicals"](u))))}function R(u){return!(E(u)||function(s){return!!(f["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||f["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||f["Letterlike Symbols"](s)||f["Number Forms"](s)||f["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||f["Control Pictures"](s)&&s!==9251||f["Optical Character Recognition"](s)||f["Enclosed Alphanumerics"](s)||f["Geometric Shapes"](s)||f["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||f["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||f["CJK Symbols and Punctuation"](s)||f.Katakana(s)||f["Private Use Area"](s)||f["CJK Compatibility Forms"](s)||f["Small Form Variants"](s)||f["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(u))}function B(u){return u>=1424&&u<=2303||f["Arabic Presentation Forms-A"](u)||f["Arabic Presentation Forms-B"](u)}function G(u,s){return!(!s&&B(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||f.Khmer(u))}function j(u){for(const s of u)if(B(s.charCodeAt(0)))return!0;return!1}const q="deferred",K="loading",te="loaded";let ne=null,le="unavailable",se=null;const ue=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(le="error"),ne&&ne(u)};function ce(){ye.fire(new Eu("pluginStateChange",{pluginStatus:le,pluginURL:se}))}const ye=new Mc,Ce=function(){return le},Ae=function(){if(le!==q||!se)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");le=K,ce(),se&&Fd({url:se},u=>{u?ue(u):(le=te,ce())})},De={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>le===te||De.applyArabicShaping!=null,isLoading:()=>le===K,setState(u){le=u.pluginStatus,se=u.pluginURL},isParsed:()=>De.applyArabicShaping!=null&&De.processBidirectionalText!=null&&De.processStyledBidirectionalText!=null,getPluginURL:()=>se};class he{constructor(s,h){this.zoom=s,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.transition=h.transition,this.pitch=h.pitch,this.brightness=h.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(s){return function(h,p){for(const _ of h)if(!G(_.charCodeAt(0),p))return!1;return!0}(s,De.isLoaded())}}class we{constructor(s,h,p,_){this.property=s,this.value=h,this.expression=function(b,T,I,L){if(b0(b))return new pp(b,T);if(dm(b)||Array.isArray(b)&&b.length>0){const k=Kw(b,T,I,L);if(k.result==="error")throw new Error(k.value.map(F=>`${F.key}: ${F.message}`).join(", "));return k.value}{let k=b;return typeof b=="string"&&T.type==="color"&&(k=Jn.parse(b)),{kind:"constant",isConfigDependent:!1,evaluate:()=>k}}}(h===void 0?s.specification.default:h,s.specification,p,_)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,h,p){return this.property.possiblyEvaluate(this,s,h,p)}}class Fe{constructor(s,h,p){this.property=s,this.value=new we(s,void 0,h,p)}transitioned(s,h){return new je(this.property,this.value,h,us({},s.transition,this.transition),s.now)}untransitioned(){return new je(this.property,this.value,null,{},0)}}class ze{constructor(s,h,p){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues),this._scope=h,this._options=p,this.isConfigDependent=!1}getValue(s){return $l(this._values[s].value.value)}setValue(s,h){this._values.hasOwnProperty(s)||(this._values[s]=new Fe(this._values[s].property,this._scope,this._options)),this._values[s].value=new we(this._values[s].property,h===null?void 0:$l(h),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[s].value.expression.isConfigDependent}setTransitionOrValue(s,h){h&&(this._options=h);const p=this._properties.properties;if(s)for(const _ in s){const b=s[_];if(Sc(_,"-transition")){const T=_.slice(0,-11);p[T]&&this.setTransition(T,b)}else p[_]&&this.setValue(_,b)}}getTransition(s){return $l(this._values[s].transition)}setTransition(s,h){this._values.hasOwnProperty(s)||(this._values[s]=new Fe(this._values[s].property)),this._values[s].transition=$l(h)||void 0}serialize(){const s={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(s[h]=p);const _=this.getTransition(h);_!==void 0&&(s[`${h}-transition`]=_)}return s}transitioned(s,h){const p=new it(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].transitioned(s,h._values[_]);return p}untransitioned(){const s=new it(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].untransitioned();return s}}class je{constructor(s,h,p,_,b){const T=_.delay||0,I=_.duration||0;b=b||0,this.property=s,this.value=h,this.begin=b+T,this.end=this.begin+I,s.specification.transition&&(_.delay||_.duration)&&(this.prior=p)}possiblyEvaluate(s,h,p){const _=s.now||0,b=this.value.possiblyEvaluate(s,h,p),T=this.prior;if(T){if(_>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(_<this.begin)return T.possiblyEvaluate(s,h,p);{const I=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(s,h,p),b,Sv(I))}}return b}}class it{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,h,p){const _=new st(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(s,h,p);return _}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Ge{constructor(s,h,p){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._scope=h,this._options=p,this.isConfigDependent=!1}getValue(s){return $l(this._values[s].value)}setValue(s,h){this._values[s]=new we(this._values[s].property,h===null?void 0:$l(h),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[s].expression.isConfigDependent}serialize(){const s={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(s[h]=p)}return s}possiblyEvaluate(s,h,p){const _=new st(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(s,h,p);return _}}class rt{constructor(s,h,p){this.property=s,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,h,p,_){return this.property.evaluate(this.value,this.parameters,s,h,p,_)}}class st{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Ve{constructor(s){this.specification=s}possiblyEvaluate(s,h){return s.expression.evaluate(h)}interpolate(s,h,p){const _=Wd[this.specification.type];return _?_(s,h,p):s}}class Qe{constructor(s,h){this.specification=s,this.overrides=h}possiblyEvaluate(s,h,p,_){return new rt(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(h,null,{},p,_)}:s.expression,h)}interpolate(s,h,p){if(s.value.kind!=="constant"||h.value.kind!=="constant")return s;if(s.value.value===void 0||h.value.value===void 0)return new rt(this,{kind:"constant",value:void 0},s.parameters);const _=Wd[this.specification.type];return _?new rt(this,{kind:"constant",value:_(s.value.value,h.value.value,p)},s.parameters):s}evaluate(s,h,p,_,b,T){return s.kind==="constant"?s.value:s.evaluate(h,p,_,b,T)}}class kt{constructor(s){this.specification=s}possiblyEvaluate(s,h,p,_){return!!s.expression.evaluate(h,null,{},p,_)}interpolate(){return!1}}class Ze{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const h=new he(0,{});for(const p in s){const _=s[p];_.specification.overridable&&this.overridableProperties.push(p);const b=this.defaultPropertyValues[p]=new we(_,void 0),T=this.defaultTransitionablePropertyValues[p]=new Fe(_);this.defaultTransitioningPropertyValues[p]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=b.possiblyEvaluate(h)}}}function nt(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function ot(u){if(Array.isArray(u))return u.map(ot);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const s={};for(const h in u)s[h]=ot(u[h]);return s}return nt(u)}gr(Qe,"DataDrivenProperty"),gr(Ve,"DataConstantProperty"),gr(kt,"ColorRampProperty");var Me=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Tt(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const s of u.slice(1))if(!Tt(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function lr(u,s="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Tt(u)||(u=Pn(u));const h=u;let p=!0;try{p=function(k){if(!xr(k))return k;let F=ot(k);return Ar(F),F=vr(F),F}(h)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(h,null,2)}
        `)}const _=Me[`filter_${s}`],b=Yh(p,_);let T=null;if(b.result==="error")throw new Error(b.value.map(k=>`${k.key}: ${k.message}`).join(", "));T=(k,F,N)=>b.value.evaluate(k,F,{},N);let I=null,L=null;if(p!==h){const k=Yh(h,_);if(k.result==="error")throw new Error(k.value.map(F=>`${F.key}: ${F.message}`).join(", "));I=(F,N,U,Z,Q)=>k.value.evaluate(F,N,{},U,void 0,void 0,Z,Q),L=!ku(k.value.expression)}return{filter:T,dynamicFilter:I||void 0,needGeometry:Zr(p),needFeature:!!L}}function vr(u){if(!Array.isArray(u))return u;const s=function(h){if(Dr.has(h[0])){for(let p=1;p<h.length;p++)if(xr(h[p]))return!0}return h}(u);return s===!0?s:s.map(h=>vr(h))}function Ar(u){let s=!1;const h=[];if(u[0]==="case"){for(let p=1;p<u.length-1;p+=2)s=s||xr(u[p]),h.push(u[p+1]);h.push(u[u.length-1])}else if(u[0]==="match"){s=s||xr(u[1]);for(let p=2;p<u.length-1;p+=2)h.push(u[p+1]);h.push(u[u.length-1])}else if(u[0]==="step"){s=s||xr(u[1]);for(let p=1;p<u.length-1;p+=2)h.push(u[p+1])}s&&(u.length=0,u.push("any",...h));for(let p=1;p<u.length;p++)Ar(u[p])}function xr(u){if(!Array.isArray(u))return!1;if((s=u[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let h=1;h<u.length;h++)if(xr(u[h]))return!0;return!1}const Dr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Sn(u,s){return u<s?-1:u>s?1:0}function Zr(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let s=1;s<u.length;s++)if(Zr(u[s]))return!0;return!1}function Pn(u){if(!u)return!0;const s=u[0];return u.length<=1?s!=="any":s==="=="?Tn(u[1],u[2],"=="):s==="!="?ua(Tn(u[1],u[2],"==")):s==="<"||s===">"||s==="<="||s===">="?Tn(u[1],u[2],s):s==="any"?(h=u.slice(1),["any"].concat(h.map(Pn))):s==="all"?["all"].concat(u.slice(1).map(Pn)):s==="none"?["all"].concat(u.slice(1).map(Pn).map(ua)):s==="in"?Di(u[1],u.slice(2)):s==="!in"?ua(Di(u[1],u.slice(2))):s==="has"?ei(u[1]):s!=="!has"||ua(ei(u[1]));var h}function Tn(u,s,h){switch(u){case"$type":return[`filter-type-${h}`,s];case"$id":return[`filter-id-${h}`,s];default:return[`filter-${h}`,u,s]}}function Di(u,s){if(s.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(h=>typeof h!=typeof s[0])?["filter-in-large",u,["literal",s.sort(Sn)]]:["filter-in-small",u,["literal",s]]}}function ei(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function ua(u){return["!",u]}const Ji="";function di(u,s){return s?`${u}${Ji}${s}`:u}const oi="-transition",nn=new Set(["fill","line","background","hillshade","raster"]);class sn extends Mc{constructor(s,h,p,_){if(super(),this.id=s.id,this.fqid=di(this.id,p),this.type=s.type,this.scope=p,this.options=_,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&s.type!=="sky"&&s.type!=="slot"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),s.slot&&(this.slot=s.slot),h.layout&&(this._unevaluatedLayout=new Ge(h.layout,this.scope,_),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),h.paint)){this._transitionablePaint=new ze(h.paint,this.scope,_);for(const b in s.paint)this.setPaintProperty(b,s.paint[b]);for(const b in s.layout)this.setLayoutProperty(b,s.layout[b]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new st(h.paint)}}onAdd(s){}onRemove(s){}isDraped(s){return nn.has(this.type)}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,h){if(this.type==="custom"&&s==="visibility")return void(this.visibility=h);const p=this._unevaluatedLayout;p._properties.properties[s]&&(p.setValue(s,h),this.isConfigDependent=this.isConfigDependent||p.isConfigDependent,s==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(s){return Sc(s,oi)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,h){const p=this._transitionablePaint,_=p._properties.properties;if(Sc(s,oi)){const N=s.slice(0,-11);return _[N]&&p.setTransition(N,h||void 0),!1}if(!_[s])return!1;const b=p._values[s],T=b.value.isDataDriven(),I=b.value;p.setValue(s,h),this.isConfigDependent=this.isConfigDependent||p.isConfigDependent,this._handleSpecialPaintPropertyUpdate(s);const L=p._values[s].value,k=L.isDataDriven(),F=Sc(s,"pattern")||s==="line-dasharray";return k||T||F||this._handleOverridablePaintPropertyUpdate(s,I,L)}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getDefaultProgramParams(s,h){return null}_handleOverridablePaintPropertyUpdate(s,h,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,h){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,h)}serialize(){return Ld({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(s,h)=>!(s===void 0||h==="layout"&&!Object.keys(s).length||h==="paint"&&!Object.keys(s).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const s in this.paint._values){const h=this.paint.get(s);if(h instanceof rt&&hm(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=lr(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(s){this._stats&&(s.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(s){}queryIntersectsFeature(s,h,p,_,b,T,I,L,k){}queryIntersectsMatchingFeature(s,h,p,_){}}const Ti={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class pi{constructor(s,h){this._structArray=s,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class vn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,h){return s._trim(),h&&(s.isTransferred=!0,h.add(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const h=Object.create(this.prototype);return h.arrayBuffer=s.arrayBuffer,h.length=s.length,h.capacity=s.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...s){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...s){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Kr(u,s=1){let h=0,p=0;return{members:u.map(_=>{const b=Ti[_.type].BYTES_PER_ELEMENT,T=h=_o(h,Math.max(s,b)),I=_.components||1;return p=Math.max(p,b),h+=b*I,{name:_.name,type:_.type,components:I,offset:T}}),size:_o(h,Math.max(p,s)),alignment:s}}function _o(u,s){return Math.ceil(u/s)*s}class Wa extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h){const p=this.length;return this.resize(p+1),this.emplace(p,s,h)}emplace(s,h,p){const _=2*s;return this.int16[_+0]=h,this.int16[_+1]=p,s}}Wa.prototype.bytesPerElement=4,gr(Wa,"StructArrayLayout2i4");class ya extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,s,h,p)}emplace(s,h,p,_){const b=3*s;return this.int16[b+0]=h,this.int16[b+1]=p,this.int16[b+2]=_,s}}ya.prototype.bytesPerElement=6,gr(ya,"StructArrayLayout3i6");class Za extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,h,p,_)}emplace(s,h,p,_,b){const T=4*s;return this.int16[T+0]=h,this.int16[T+1]=p,this.int16[T+2]=_,this.int16[T+3]=b,s}}Za.prototype.bytesPerElement=8,gr(Za,"StructArrayLayout4i8");class yo extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,h,p,_,b)}emplace(s,h,p,_,b,T){const I=5*s;return this.int16[I+0]=h,this.int16[I+1]=p,this.int16[I+2]=_,this.int16[I+3]=b,this.int16[I+4]=T,s}}yo.prototype.bytesPerElement=10,gr(yo,"StructArrayLayout5i10");class io extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I){const L=this.length;return this.resize(L+1),this.emplace(L,s,h,p,_,b,T,I)}emplace(s,h,p,_,b,T,I,L){const k=6*s,F=12*s,N=3*s;return this.int16[k+0]=h,this.int16[k+1]=p,this.uint8[F+4]=_,this.uint8[F+5]=b,this.uint8[F+6]=T,this.uint8[F+7]=I,this.float32[N+2]=L,s}}io.prototype.bytesPerElement=12,gr(io,"StructArrayLayout2i4ub1f12");class xa extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,h,p,_)}emplace(s,h,p,_,b){const T=4*s;return this.float32[T+0]=h,this.float32[T+1]=p,this.float32[T+2]=_,this.float32[T+3]=b,s}}xa.prototype.bytesPerElement=16,gr(xa,"StructArrayLayout4f16");class Pa extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h){const p=this.length;return this.resize(p+1),this.emplace(p,s,h)}emplace(s,h,p){const _=2*s;return this.float32[_+0]=h,this.float32[_+1]=p,s}}Pa.prototype.bytesPerElement=8,gr(Pa,"StructArrayLayout2f8");class La extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,h,p,_,b)}emplace(s,h,p,_,b,T){const I=6*s,L=3*s;return this.uint16[I+0]=h,this.uint16[I+1]=p,this.uint16[I+2]=_,this.uint16[I+3]=b,this.float32[L+2]=T,s}}La.prototype.bytesPerElement=12,gr(La,"StructArrayLayout4ui1f12");class sl extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,h,p,_)}emplace(s,h,p,_,b){const T=4*s;return this.uint16[T+0]=h,this.uint16[T+1]=p,this.uint16[T+2]=_,this.uint16[T+3]=b,s}}sl.prototype.bytesPerElement=8,gr(sl,"StructArrayLayout4ui8");class Vs extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T){const I=this.length;return this.resize(I+1),this.emplace(I,s,h,p,_,b,T)}emplace(s,h,p,_,b,T,I){const L=6*s;return this.int16[L+0]=h,this.int16[L+1]=p,this.int16[L+2]=_,this.int16[L+3]=b,this.int16[L+4]=T,this.int16[L+5]=I,s}}Vs.prototype.bytesPerElement=12,gr(Vs,"StructArrayLayout6i12");class ll extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I,L,k,F,N,U){const Z=this.length;return this.resize(Z+1),this.emplace(Z,s,h,p,_,b,T,I,L,k,F,N,U)}emplace(s,h,p,_,b,T,I,L,k,F,N,U,Z){const Q=12*s;return this.int16[Q+0]=h,this.int16[Q+1]=p,this.int16[Q+2]=_,this.int16[Q+3]=b,this.uint16[Q+4]=T,this.uint16[Q+5]=I,this.uint16[Q+6]=L,this.uint16[Q+7]=k,this.int16[Q+8]=F,this.int16[Q+9]=N,this.int16[Q+10]=U,this.int16[Q+11]=Z,s}}ll.prototype.bytesPerElement=24,gr(ll,"StructArrayLayout4i4ui4i24");class ul extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T){const I=this.length;return this.resize(I+1),this.emplace(I,s,h,p,_,b,T)}emplace(s,h,p,_,b,T,I){const L=10*s,k=5*s;return this.int16[L+0]=h,this.int16[L+1]=p,this.int16[L+2]=_,this.float32[k+2]=b,this.float32[k+3]=T,this.float32[k+4]=I,s}}ul.prototype.bytesPerElement=20,gr(ul,"StructArrayLayout3i3f20");class Bu extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.uint32[1*s+0]=h,s}}Bu.prototype.bytesPerElement=4,gr(Bu,"StructArrayLayout1ul4");class hs extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h){const p=this.length;return this.resize(p+1),this.emplace(p,s,h)}emplace(s,h,p){const _=2*s;return this.uint16[_+0]=h,this.uint16[_+1]=p,s}}hs.prototype.bytesPerElement=4,gr(hs,"StructArrayLayout2ui4");class vp extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I,L,k,F,N,U,Z){const Q=this.length;return this.resize(Q+1),this.emplace(Q,s,h,p,_,b,T,I,L,k,F,N,U,Z)}emplace(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q){const ee=20*s,ie=10*s;return this.int16[ee+0]=h,this.int16[ee+1]=p,this.int16[ee+2]=_,this.int16[ee+3]=b,this.int16[ee+4]=T,this.float32[ie+3]=I,this.float32[ie+4]=L,this.float32[ie+5]=k,this.float32[ie+6]=F,this.int16[ee+14]=N,this.uint32[ie+8]=U,this.uint16[ee+18]=Z,this.uint16[ee+19]=Q,s}}vp.prototype.bytesPerElement=40,gr(vp,"StructArrayLayout5i4f1i1ul2ui40");class Qh extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I){const L=this.length;return this.resize(L+1),this.emplace(L,s,h,p,_,b,T,I)}emplace(s,h,p,_,b,T,I,L){const k=8*s;return this.int16[k+0]=h,this.int16[k+1]=p,this.int16[k+2]=_,this.int16[k+4]=b,this.int16[k+5]=T,this.int16[k+6]=I,this.int16[k+7]=L,s}}Qh.prototype.bytesPerElement=16,gr(Qh,"StructArrayLayout3i2i2i16");class mp extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,h,p,_,b)}emplace(s,h,p,_,b,T){const I=4*s,L=8*s;return this.float32[I+0]=h,this.float32[I+1]=p,this.float32[I+2]=_,this.int16[L+6]=b,this.int16[L+7]=T,s}}mp.prototype.bytesPerElement=16,gr(mp,"StructArrayLayout2f1f2i16");class Yl extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,h,p,_)}emplace(s,h,p,_,b){const T=12*s,I=3*s;return this.uint8[T+0]=h,this.uint8[T+1]=p,this.float32[I+1]=_,this.float32[I+2]=b,s}}Yl.prototype.bytesPerElement=12,gr(Yl,"StructArrayLayout2ub2f12");class ba extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,s,h,p)}emplace(s,h,p,_){const b=3*s;return this.uint16[b+0]=h,this.uint16[b+1]=p,this.uint16[b+2]=_,s}}ba.prototype.bytesPerElement=6,gr(ba,"StructArrayLayout3ui6");class _p extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe,_e,Se,xe,Re){const Te=this.length;return this.resize(Te+1),this.emplace(Te,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe,_e,Se,xe,Re)}emplace(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe,_e,Se,xe,Re,Te){const Be=30*s,Ne=15*s,Xe=60*s;return this.int16[Be+0]=h,this.int16[Be+1]=p,this.int16[Be+2]=_,this.float32[Ne+2]=b,this.float32[Ne+3]=T,this.uint16[Be+8]=I,this.uint16[Be+9]=L,this.uint32[Ne+5]=k,this.uint32[Ne+6]=F,this.uint32[Ne+7]=N,this.uint16[Be+16]=U,this.uint16[Be+17]=Z,this.uint16[Be+18]=Q,this.float32[Ne+10]=ee,this.float32[Ne+11]=ie,this.uint8[Xe+48]=oe,this.uint8[Xe+49]=_e,this.uint8[Xe+50]=Se,this.uint32[Ne+13]=xe,this.int16[Be+28]=Re,this.uint8[Xe+58]=Te,s}}_p.prototype.bytesPerElement=60,gr(_p,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class fE extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe,_e,Se,xe,Re,Te,Be,Ne,Xe,ft,Je,yt,_t,dt,Pt,It){const zt=this.length;return this.resize(zt+1),this.emplace(zt,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe,_e,Se,xe,Re,Te,Be,Ne,Xe,ft,Je,yt,_t,dt,Pt,It)}emplace(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe,_e,Se,xe,Re,Te,Be,Ne,Xe,ft,Je,yt,_t,dt,Pt,It,zt){const Ot=20*s,xt=40*s,mr=80*s;return this.float32[Ot+0]=h,this.float32[Ot+1]=p,this.int16[xt+4]=_,this.int16[xt+5]=b,this.int16[xt+6]=T,this.int16[xt+7]=I,this.int16[xt+8]=L,this.int16[xt+9]=k,this.int16[xt+10]=F,this.int16[xt+11]=N,this.int16[xt+12]=U,this.uint16[xt+13]=Z,this.uint16[xt+14]=Q,this.uint16[xt+15]=ee,this.uint16[xt+16]=ie,this.uint16[xt+17]=oe,this.uint16[xt+18]=_e,this.uint16[xt+19]=Se,this.uint16[xt+20]=xe,this.uint16[xt+21]=Re,this.uint16[xt+22]=Te,this.uint16[xt+23]=Be,this.uint16[xt+24]=Ne,this.uint16[xt+25]=Xe,this.uint16[xt+26]=ft,this.uint16[xt+27]=Je,this.uint32[Ot+14]=yt,this.float32[Ot+15]=_t,this.float32[Ot+16]=dt,this.float32[Ot+17]=Pt,this.float32[Ot+18]=It,this.uint8[mr+76]=zt,s}}fE.prototype.bytesPerElement=80,gr(fE,"StructArrayLayout2f9i15ui1ul4f1ub80");class S0 extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.float32[1*s+0]=h,s}}S0.prototype.bytesPerElement=4,gr(S0,"StructArrayLayout1f4");class yp extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,h,p,_,b)}emplace(s,h,p,_,b,T){const I=5*s;return this.float32[I+0]=h,this.float32[I+1]=p,this.float32[I+2]=_,this.float32[I+3]=b,this.float32[I+4]=T,s}}yp.prototype.bytesPerElement=20,gr(yp,"StructArrayLayout5f20");class dE extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I){const L=this.length;return this.resize(L+1),this.emplace(L,s,h,p,_,b,T,I)}emplace(s,h,p,_,b,T,I,L){const k=7*s;return this.float32[k+0]=h,this.float32[k+1]=p,this.float32[k+2]=_,this.float32[k+3]=b,this.float32[k+4]=T,this.float32[k+5]=I,this.float32[k+6]=L,s}}dE.prototype.bytesPerElement=28,gr(dE,"StructArrayLayout7f28");class pE extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,h,p,_)}emplace(s,h,p,_,b){const T=6*s;return this.uint32[3*s+0]=h,this.uint16[T+2]=p,this.uint16[T+3]=_,this.uint16[T+4]=b,s}}pE.prototype.bytesPerElement=12,gr(pE,"StructArrayLayout1ul3ui12");class gE extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.uint16[1*s+0]=h,s}}gE.prototype.bytesPerElement=2,gr(gE,"StructArrayLayout1ui2");class xp extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,s,h,p)}emplace(s,h,p,_){const b=3*s;return this.float32[b+0]=h,this.float32[b+1]=p,this.float32[b+2]=_,s}}xp.prototype.bytesPerElement=12,gr(xp,"StructArrayLayout3f12");class vE extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie){const oe=this.length;return this.resize(oe+1),this.emplace(oe,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie)}emplace(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe){const _e=16*s;return this.float32[_e+0]=h,this.float32[_e+1]=p,this.float32[_e+2]=_,this.float32[_e+3]=b,this.float32[_e+4]=T,this.float32[_e+5]=I,this.float32[_e+6]=L,this.float32[_e+7]=k,this.float32[_e+8]=F,this.float32[_e+9]=N,this.float32[_e+10]=U,this.float32[_e+11]=Z,this.float32[_e+12]=Q,this.float32[_e+13]=ee,this.float32[_e+14]=ie,this.float32[_e+15]=oe,s}}vE.prototype.bytesPerElement=64,gr(vE,"StructArrayLayout16f64");class rS extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,_,b,T,I){const L=this.length;return this.resize(L+1),this.emplace(L,s,h,p,_,b,T,I)}emplace(s,h,p,_,b,T,I,L){const k=10*s,F=5*s;return this.uint16[k+0]=h,this.uint16[k+1]=p,this.uint16[k+2]=_,this.uint16[k+3]=b,this.float32[F+2]=T,this.float32[F+3]=I,this.float32[F+4]=L,s}}rS.prototype.bytesPerElement=20,gr(rS,"StructArrayLayout4ui3f20");class mE extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.int16[1*s+0]=h,s}}mE.prototype.bytesPerElement=2,gr(mE,"StructArrayLayout1i2");class _E extends vn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.uint8[1*s+0]=h,s}}_E.prototype.bytesPerElement=1,gr(_E,"StructArrayLayout1ub1");class D5 extends pi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}D5.prototype.size=40;class P5 extends vp{get(s){return new D5(this,s)}}gr(P5,"CollisionBoxArray");class L5 extends pi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}L5.prototype.size=60;class R5 extends _p{get(s){return new L5(this,s)}}gr(R5,"PlacedSymbolArray");class k5 extends pi{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(s){this._structArray.uint32[this._pos4+14]=s}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(s){this._structArray.float32[this._pos4+18]=s}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}k5.prototype.size=80;class O5 extends fE{get(s){return new k5(this,s)}}gr(O5,"SymbolInstanceArray");class z5 extends S0{getoffsetX(s){return this.float32[1*s+0]}}gr(z5,"GlyphOffsetArray");class B5 extends Wa{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}gr(B5,"SymbolLineVertexArray");class F5 extends pi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}F5.prototype.size=12;class N5 extends pE{get(s){return new F5(this,s)}}gr(N5,"FeatureIndexArray");class V5 extends hs{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}gr(V5,"FillExtrusionCentroidArray");const bte=Kr([{name:"a_pos",components:2,type:"Int16"}],4),wte=Kr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ea{constructor(s=[]){this.segments=s}_prepareSegment(s,h,p,_){let b=this.segments[this.segments.length-1];return s>ea.MAX_VERTEX_ARRAY_LENGTH&&Gi(`Max vertices per segment is ${ea.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!b||b.vertexLength+s>ea.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==_)&&(b={vertexOffset:h,primitiveOffset:p,vertexLength:0,primitiveLength:0},_!==void 0&&(b.sortKey=_),this.segments.push(b)),b}prepareSegment(s,h,p,_){return this._prepareSegment(s,h.length,p.length,_)}get(){return this.segments}destroy(){for(const s of this.segments)for(const h in s.vaos)s.vaos[h].destroy()}static simpleSegment(s,h,p,_){return new ea([{vertexOffset:s,primitiveOffset:h,vertexLength:p,primitiveLength:_,vaos:{},sortKey:0}])}}function G5(u,s){return 256*(u=wn(Math.floor(u),0,255))+wn(Math.floor(s),0,255)}ea.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gr(ea,"SegmentVector");const Ste=Kr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Tte=Kr([{name:"a_dash",components:4,type:"Uint16"}]);class T0{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(s,h,p,_){this.ids.push(U5(s)),this.positions.push(h,p,_)}eachPosition(s,h){const p=U5(s);let _=0,b=this.ids.length-1;for(;_<b;){const T=_+b>>1;this.ids[T]>=p?b=T:_=T+1}for(;this.ids[_]===p;)h(this.positions[3*_],this.positions[3*_+1],this.positions[3*_+2]),_++}static serialize(s,h){const p=new Float64Array(s.ids),_=new Uint32Array(s.positions);return yE(p,_,0,p.length-1),h&&(h.add(p.buffer),h.add(_.buffer)),{ids:p,positions:_}}static deserialize(s){const h=new T0;let p;h.ids=s.ids,h.positions=s.positions;for(const _ of h.ids)_!==p&&h.uniqueIds.push(_),p=_;return h.indexed=!0,h}}function U5(u){const s=+u;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:Ud(String(u))}function yE(u,s,h,p){for(;h<p;){const _=u[h+p>>1];let b=h-1,T=p+1;for(;;){do b++;while(u[b]<_);do T--;while(u[T]>_);if(b>=T)break;nS(u,b,T),nS(s,3*b,3*T),nS(s,3*b+1,3*T+1),nS(s,3*b+2,3*T+2)}T-h<p-T?(yE(u,s,h,T),h=T+1):(yE(u,s,T+1,p),p=T)}}function nS(u,s,h){const p=u[s];u[s]=u[h],u[h]=p}gr(T0,"FeaturePositionMap");class Fc{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,h){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,h),this.initialized=!0),!!this.location}set(s,h,p){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class iS extends Fc{constructor(s){super(s),this.current=0}set(s,h,p){this.fetchUniformLocation(s,h)&&this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}}class Eo extends Fc{constructor(s){super(s),this.current=0}set(s,h,p){this.fetchUniformLocation(s,h)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class Kh extends Fc{constructor(s){super(s),this.current=[0,0]}set(s,h,p){this.fetchUniformLocation(s,h)&&(p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1])))}}class xE extends Fc{constructor(s){super(s),this.current=[0,0,0]}set(s,h,p){this.fetchUniformLocation(s,h)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2])))}}class $5 extends Fc{constructor(s){super(s),this.current=[0,0,0,0]}set(s,h,p){this.fetchUniformLocation(s,h)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class H5 extends Fc{constructor(s){super(s),this.current=Jn.transparent}set(s,h,p){this.fetchUniformLocation(s,h)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const Ate=new Float32Array(16);class A0 extends Fc{constructor(s){super(s),this.current=Ate}set(s,h,p){if(this.fetchUniformLocation(s,h)){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let _=1;_<16;_++)if(p[_]!==this.current[_]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}}}const Cte=new Float32Array(9),Mte=new Float32Array(4);class bE extends Fc{constructor(s){super(s),this.current=Mte}set(s,h,p){if(this.fetchUniformLocation(s,h)){for(let _=0;_<4;_++)if(p[_]!==this.current[_]){this.current=p,this.gl.uniformMatrix2fv(this.location,!1,p);break}}}}function wE(u){return[G5(255*u.r,255*u.g),G5(255*u.b,255*u.a)]}class C0{constructor(s,h,p){this.value=s,this.uniformNames=h.map(_=>`u_${_}`),this.type=p}setUniform(s,h,p,_,b){h.set(s,b,_.constantOr(this.value))}getBinding(s,h){return this.type==="color"?new H5(s):new Eo(s)}}class vm{constructor(s,h){this.uniformNames=h.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,h,p,_,b){const T=b==="u_pattern"||b==="u_dash"?this.pattern:b==="u_pixel_ratio"?this.pixelRatio:null;T&&h.set(s,b,T)}getBinding(s,h){return h==="u_pattern"||h==="u_dash"?new $5(s):new Eo(s)}}class Nc{constructor(s,h,p,_){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(b=>({name:`a_${b}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(s,h,p,_,b,T,I){const L=this.paintVertexArray.length,k=this.expression.evaluate(new he(0,{brightness:T}),h,{},b,_,I);this.paintVertexArray.resize(s),this._setPaintValue(L,s,k)}updatePaintArray(s,h,p,_,b,T,I){const L=this.expression.evaluate({zoom:0,brightness:I},p,_,void 0,b);this._setPaintValue(s,h,L)}_setPaintValue(s,h,p){if(this.type==="color"){const _=wE(p);for(let b=s;b<h;b++)this.paintVertexArray.emplace(b,_[0],_[1])}else{for(let _=s;_<h;_++)this.paintVertexArray.emplace(_,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xl{constructor(s,h,p,_,b,T){this.expression=s,this.uniformNames=h.map(I=>`u_${I}_t`),this.type=p,this.useIntegerZoom=_,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=h.map(I=>({name:`a_${I}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(s,h,p,_,b,T,I){const L=this.expression.evaluate(new he(this.zoom,{brightness:T}),h,{},b,_,I),k=this.expression.evaluate(new he(this.zoom+1,{brightness:T}),h,{},b,_,I),F=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(F,s,L,k)}updatePaintArray(s,h,p,_,b,T,I){const L=this.expression.evaluate({zoom:this.zoom,brightness:I},p,_,void 0,b),k=this.expression.evaluate({zoom:this.zoom+1,brightness:I},p,_,void 0,b);this._setPaintValue(s,h,L,k)}_setPaintValue(s,h,p,_){if(this.type==="color"){const b=wE(p),T=wE(_);for(let I=s;I<h;I++)this.paintVertexArray.emplace(I,b[0],b[1],T[0],T[1])}else{for(let b=s;b<h;b++)this.paintVertexArray.emplace(b,p,_);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(_))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,h,p,_,b){const T=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,I=wn(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);h.set(s,b,I)}getBinding(s,h){return new Eo(s)}}class Jh{constructor(s,h,p,_,b){this.expression=s,this.layerId=b,this.paintVertexAttributes=(p==="array"?Tte:Ste).members;for(let T=0;T<h.length;++T);this.paintVertexArray=new _}populatePaintArray(s,h,p){const _=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(_,s,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(s,h,p,_,b,T,I){this._setPaintValues(s,h,p.patterns&&p.patterns[this.layerId],T)}_setPaintValues(s,h,p,_){if(!_||!p)return;const b=_[p];if(!b)return;const{tl:T,br:I,pixelRatio:L}=b;for(let k=s;k<h;k++)this.paintVertexArray.emplace(k,T[0],T[1],I[0],I[1],L)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bp{constructor(s,h,p=()=>!0){this.binders={},this._buffers=[];const _=[];for(const b in s.paint._values){const T=s.paint.get(b);if(!p(b)||!(T instanceof rt&&hm(T.property.specification)))continue;const I=Ete(b,s.type),L=T.value,k=T.property.specification.type,F=!!T.property.useIntegerZoom,N=b==="line-dasharray"||b.endsWith("pattern"),U=b==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant";if(L.kind!=="constant"||U)if(L.kind==="source"||U||N){const Z=j5(b,k,"source");this.binders[b]=N?new Jh(L,I,k,Z,s.id):new Nc(L,I,k,Z),_.push(`/a_${b}`)}else{const Z=j5(b,k,"composite");this.binders[b]=new Xl(L,I,k,F,h,Z),_.push(`/z_${b}`)}else this.binders[b]=N?new vm(L.value,I):new C0(L.value,I,k),_.push(`/u_${b}`)}this.cacheKey=_.sort().join("")}getMaxValue(s){const h=this.binders[s];return h instanceof Nc||h instanceof Xl?h.maxValue:0}populatePaintArrays(s,h,p,_,b,T,I){for(const L in this.binders){const k=this.binders[L];(k instanceof Nc||k instanceof Xl||k instanceof Jh)&&k.populatePaintArray(s,h,p,_,b,T,I)}}setConstantPatternPositions(s){for(const h in this.binders){const p=this.binders[h];p instanceof vm&&p.setConstantPatternPositions(s)}}updatePaintArrays(s,h,p,_,b,T,I,L){let k=!1;const F=Object.keys(s),N=F.length!==0,U=N?F:h.uniqueIds;for(const Z in this.binders){const Q=this.binders[Z];if((Q instanceof Nc||Q instanceof Xl||Q instanceof Jh)&&(Q.expression.isStateDependent===!0||Q.expression.isLightConstant===!1)){const ee=b.paint.get(Z);Q.expression=ee.value;for(const ie of U){const oe=s[ie.toString()];h.eachPosition(ie,(_e,Se,xe)=>{const Re=_.feature(_e);Q.updatePaintArray(Se,xe,Re,oe,T,I,L)})}if(!N)for(const ie of p.uniqueIds){const oe=s[ie.toString()];p.eachPosition(ie,(_e,Se,xe)=>{const Re=_.feature(_e);Q.updatePaintArray(Se,xe,Re,oe,T,I,L)})}k=!0}}return k}defines(){const s=[];for(const h in this.binders){const p=this.binders[h];(p instanceof C0||p instanceof vm)&&s.push(...p.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return s}getBinderAttributes(){const s=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof Nc||p instanceof Xl||p instanceof Jh)for(let _=0;_<p.paintVertexAttributes.length;_++)s.push(p.paintVertexAttributes[_].name)}return s}getBinderUniforms(){const s=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof C0||p instanceof vm||p instanceof Xl)for(const _ of p.uniformNames)s.push(_)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const h=[];for(const p in this.binders){const _=this.binders[p];if(_ instanceof C0||_ instanceof vm||_ instanceof Xl)for(const b of _.uniformNames)h.push({name:b,property:p,binding:_.getBinding(s,b)})}return h}setUniforms(s,h,p,_,b){for(const{name:T,property:I,binding:L}of p)this.binders[I].setUniform(s,L,b,_.get(I),T)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const h=this.binders[s];(h instanceof Nc||h instanceof Xl||h instanceof Jh)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(s){for(const h in this.binders){const p=this.binders[h];(p instanceof Nc||p instanceof Xl||p instanceof Jh)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const h=this.binders[s];(h instanceof Nc||h instanceof Xl||h instanceof Jh)&&h.destroy()}}}class ef{constructor(s,h,p=()=>!0){this.programConfigurations={};for(const _ of s)this.programConfigurations[_.id]=new bp(_,h,p);this.needsUpload=!1,this._featureMap=new T0,this._featureMapWithoutIds=new T0,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(s,h,p,_,b,T,I,L){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(s,h,_,b,T,I,L);h.id!==void 0?this._featureMap.add(h.id,p,this._bufferOffset,s):(this._featureMapWithoutIds.add(this._idlessCounter,p,this._bufferOffset,s),this._idlessCounter+=1),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,h,p,_,b,T){for(const I of p)this.needsUpload=this.programConfigurations[I.id].updatePaintArrays(s,this._featureMap,this._featureMapWithoutIds,h,I,_,b,T||0)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const Ite={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ete(u,s){return Ite[u]||[u.replace(`${s}-`,"").replace(/-/g,"_")]}const Dte={"line-pattern":{source:La,composite:La},"fill-pattern":{source:La,composite:La},"fill-extrusion-pattern":{source:La,composite:La},"line-dasharray":{source:sl,composite:sl}},Pte={color:{source:Pa,composite:xa},number:{source:S0,composite:Pa}};function j5(u,s,h){const p=Dte[u];return p&&p[h]||Pte[s][h]}gr(C0,"ConstantBinder"),gr(vm,"PatternConstantBinder"),gr(Nc,"SourceExpressionBinder"),gr(Jh,"PatternCompositeBinder"),gr(Xl,"CompositeExpressionBinder"),gr(bp,"ProgramConfiguration",{omit:["_buffers"]}),gr(ef,"ProgramConfigurationSet");const Do=ir/Math.PI/2,SE=5,W5=6,Lte=16383,mm=64,TE=[mm,32,16],cl=-Do,hl=Do;function _m(u,s,h,p=Do){return h=On(h),[u*Math.sin(h)*p,-s*p,u*Math.cos(h)*p]}function wp(u,s,h){return _m(Math.cos(On(u)),Math.sin(On(u)),s,h)}const ym=63710088e-1,AE=2*Math.PI*ym;class Fn{constructor(s,h){if(isNaN(s)||isNaN(h))throw new Error(`Invalid LngLat object: (${s}, ${h})`);if(this.lng=+s,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fn(Ul(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const h=Math.PI/180,p=this.lat*h,_=s.lat*h,b=Math.sin(p)*Math.sin(_)+Math.cos(p)*Math.cos(_)*Math.cos((s.lng-this.lng)*h);return ym*Math.acos(Math.min(b,1))}toBounds(s=0){const h=360*s/40075017,p=h/Math.cos(Math.PI/180*this.lat);return new tf({lng:this.lng-p,lat:this.lat-h},{lng:this.lng+p,lat:this.lat+h})}toEcef(s){return wp(this.lat,this.lng,Do+s*Do/ym)}static convert(s){if(s instanceof Fn)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Fn(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Fn(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class tf{constructor(s,h){if(s)if(h)this.setSouthWest(s).setNorthEast(h);else if(s.length===4){const p=s;this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]])}else{const p=s;this.setSouthWest(p[0]).setNorthEast(p[1])}}setNorthEast(s){return this._ne=s instanceof Fn?new Fn(s.lng,s.lat):Fn.convert(s),this}setSouthWest(s){return this._sw=s instanceof Fn?new Fn(s.lng,s.lat):Fn.convert(s),this}extend(s){const h=this._sw,p=this._ne;let _,b;if(s instanceof Fn)_=s,b=s;else{if(!(s instanceof tf))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(tf.convert(s)):this.extend(Fn.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(Fn.convert(s)):this;if(_=s._sw,b=s._ne,!_||!b)return this}return h||p?(h.lng=Math.min(_.lng,h.lng),h.lat=Math.min(_.lat,h.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new Fn(_.lng,_.lat),this._ne=new Fn(b.lng,b.lat)),this}getCenter(){return new Fn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Fn(this.getWest(),this.getNorth())}getSouthEast(){return new Fn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:h,lat:p}=Fn.convert(s);let _=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(s){return!s||s instanceof tf?s:new tf(s)}}var Z5={};(function(u,s){(function(h){function p(b,T,I){var L=_(256*b,256*(T=Math.pow(2,I)-T-1),I),k=_(256*(b+1),256*(T+1),I);return L[0]+","+L[1]+","+k[0]+","+k[1]}function _(b,T,I){var L=2*Math.PI*6378137/256/Math.pow(2,I);return[b*L-2*Math.PI*6378137/2,T*L-2*Math.PI*6378137/2]}h.getURL=function(b,T,I,L,k,F){return F=F||{},b+"?"+["bbox="+p(I,L,k),"format="+(F.format||"image/png"),"service="+(F.service||"WMS"),"version="+(F.version||"1.1.1"),"request="+(F.request||"GetMap"),"srs="+(F.srs||"EPSG:3857"),"width="+(F.width||256),"height="+(F.height||256),"layers="+T].join("&")},h.getTileBBox=p,h.getMercCoords=_,Object.defineProperty(h,"__esModule",{value:!0})})(s)})(0,Z5);var Rte=Z5;class Sp{constructor(s,h,p){this.z=s,this.x=h,this.y=p,this.key=M0(0,s,s,h,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,h){const p=Rte.getTileBBox(this.x,this.y,this.z),_=function(b,T,I){let L,k="";for(let F=b;F>0;F--)L=1<<F-1,k+=(T&L?1:0)+(I&L?2:0);return k}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",_).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class q5{constructor(s,h){this.wrap=s,this.canonical=h,this.key=M0(s,h.z,h.z,h.x,h.y)}}class ao{constructor(s,h,p,_,b){this.overscaledZ=s,this.wrap=h,this.canonical=new Sp(p,+_,+b),this.key=h===0&&s===p?this.canonical.key:M0(h,s,p,_,b)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const h=this.canonical.z-s;return s>this.canonical.z?new ao(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ao(s,this.wrap,s,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(s,h=!0){if(this.overscaledZ===s&&h)return this.key;if(s>this.canonical.z)return M0(this.wrap*+h,s,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-s;return M0(this.wrap*+h,s,s,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const h=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.z<this.canonical.z&&s.canonical.x===this.canonical.x>>h&&s.canonical.y===this.canonical.y>>h}children(s){if(this.overscaledZ>=s)return[new ao(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,_=2*this.canonical.y;return[new ao(h,this.wrap,h,p,_),new ao(h,this.wrap,h,p+1,_),new ao(h,this.wrap,h,p,_+1),new ao(h,this.wrap,h,p+1,_+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new ao(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new ao(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new q5(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function M0(u,s,h,p,_){const b=1<<Math.min(h,22);let T=b*(_%b)+p%b;return u&&h<22&&(T+=b*b*((u<0?-2*u-1:2*u)%(1<<2*(22-h)))),16*(32*T+h)+(s-h)}const kte=[u=>{let s=u.canonical.x-1,h=u.wrap;return s<0&&(s=(1<<u.canonical.z)-1,h--),new ao(u.overscaledZ,h,u.canonical.z,s,u.canonical.y)},u=>{let s=u.canonical.x+1,h=u.wrap;return s===1<<u.canonical.z&&(s=0,h++),new ao(u.overscaledZ,h,u.canonical.z,s,u.canonical.y)},u=>new ao(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new ao(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];gr(Sp,"CanonicalTileID"),gr(ao,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Ote=0,zte=25.5;function CE(u){return AE*Math.cos(u*Math.PI/180)}function rf(u){return(180+u)/360}function Vc(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Po(u,s){return u/CE(s)}function fs(u){return 360*u-180}function qa(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function Y5(u,s){return u*CE(qa(s))}const ta=85.051129;function X5(u){return Math.cos(On(wn(u,-ta,ta)))}function Tp(u,s){const h=wn(s,Ote,zte),p=Math.pow(2,h);return X5(u)*AE/(512*p)}function Q5(u){return 1/Math.cos(u*Math.PI/180)}function aS(u,s=0){const h=Math.exp(Math.PI*(1-(u.y+s/ir)/(1<<u.z)*2));return 80150034*h/(h*h+1)/ir/(1<<u.z)}class oo{constructor(s,h,p=0){this.x=+s,this.y=+h,this.z=+p}static fromLngLat(s,h=0){const p=Fn.convert(s);return new oo(rf(p.lng),Vc(p.lat),Po(h,p.lat))}toLngLat(){return new Fn(fs(this.x),qa(this.y))}toAltitude(){return Y5(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/AE*Q5(qa(this.y))}}function ME(u,s,h,p,_,b,T,I,L){const k=(s+p)/2,F=(h+_)/2,N=new nr(k,F);I(N),function(U,Z,Q,ee,ie,oe){const _e=Q-ie,Se=ee-oe;return Math.abs((ee-Z)*_e-(Q-U)*Se)/Math.hypot(_e,Se)}(N.x,N.y,b.x,b.y,T.x,T.y)>=L?(ME(u,s,h,k,F,b,N,I,L),ME(u,k,F,p,_,N,T,I,L)):u.push(T)}function K5(u,s,h){let p=u[0],_=p.x,b=p.y;s(p);const T=[p];for(let I=1;I<u.length;I++){const L=u[I],{x:k,y:F}=L;s(L),ME(T,_,b,k,F,p,L,s,h),_=k,b=F,p=L}return T}function IE(u,s,h,p){if(p(s,h)){const _=s.add(h)._mult(.5);IE(u,s,_,p),IE(u,_,h,p)}else u.push(h)}function Bte(u,s){let h=u[0];const p=[h];for(let _=1;_<u.length;_++){const b=u[_];IE(p,h,b,s),h=b}return p}const EE=Math.pow(2,14)-1,J5=-EE-1;function Fte(u,s){const h=Math.round(u.x*s),p=Math.round(u.y*s);return u.x=wn(h,J5,EE),u.y=wn(p,J5,EE),(h<u.x||h>u.x+1||p<u.y||p>u.y+1)&&Gi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Gc(u,s,h){const p=u.loadGeometry(),_=u.extent,b=ir/_;if(s&&h&&h.projection.isReprojectedInTileSpace){const T=1<<s.z,{scale:I,x:L,y:k,projection:F}=h,N=U=>{const Z=fs((s.x+U.x/_)/T),Q=qa((s.y+U.y/_)/T),ee=F.project(Z,Q);U.x=(ee.x*I-L)*_,U.y=(ee.y*I-k)*_};for(let U=0;U<p.length;U++)if(u.type!==1)p[U]=K5(p[U],N,1);else{const Z=[];for(const Q of p[U])Q.x<0||Q.x>=_||Q.y<0||Q.y>=_||(N(Q),Z.push(Q));p[U]=Z}}for(const T of p)for(const I of T)Fte(I,b);return p}function nf(u,s){return{type:u.type,id:u.id,properties:u.properties,geometry:s?Gc(u):[]}}function oS(u,s,h,p,_){u.emplaceBack(2*s+(p+1)/2,2*h+(_+1)/2)}function sS(u,s,h){u.emplaceBack(s.x,s.y,s.z,h[0]*16384,h[1]*16384,h[2]*16384)}class DE{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.fqid),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new Wa,this.indexArray=new ba,this.segments=new ea,this.programConfigurations=new ef(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,p,_){const b=this.layers[0],T=[];let I=null;b.type==="circle"&&(I=b.layout.get("circle-sort-key"));for(const{feature:k,id:F,index:N,sourceLayerIndex:U}of s){const Z=this.layers[0]._featureFilter.needGeometry,Q=nf(k,Z);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),Q,p))continue;const ee=I?I.evaluate(Q,{},p):void 0,ie={id:F,properties:k.properties,type:k.type,sourceLayerIndex:U,index:N,geometry:Z?Q.geometry:Gc(k,p,_),patterns:{},sortKey:ee};T.push(ie)}I&&T.sort((k,F)=>k.sortKey-F.sortKey);let L=null;_.projection.name==="globe"&&(this.globeExtVertexArray=new Vs,L=_.projection);for(const k of T){const{geometry:F,index:N,sourceLayerIndex:U}=k,Z=s[N].feature;this.addFeature(k,F,N,h.availableImages,p,L,h.brightness),h.featureIndex.insert(Z,F,N,U,this.index)}}update(s,h,p,_,b){const T=Object.keys(s).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(s,h,T?this.stateDependentLayers:this.layers,p,_,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,bte.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,wte.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,h,p,_,b,T,I){for(const L of h)for(const k of L){const F=k.x,N=k.y;if(F<0||F>=ir||N<0||N>=ir)continue;if(T){const Q=T.projectTilePoint(F,N,b),ee=T.upVector(b,F,N),ie=this.globeExtVertexArray;sS(ie,Q,ee),sS(ie,Q,ee),sS(ie,Q,ee),sS(ie,Q,ee)}const U=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),Z=U.vertexLength;oS(this.layoutVertexArray,F,N,-1,-1),oS(this.layoutVertexArray,F,N,1,-1),oS(this.layoutVertexArray,F,N,1,1),oS(this.layoutVertexArray,F,N,-1,1),this.indexArray.emplaceBack(Z,Z+1,Z+2),this.indexArray.emplaceBack(Z,Z+2,Z+3),U.vertexLength+=4,U.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{},_,b,I)}}function PE(u,s){for(let h=0;h<u.length;h++)if(Ap(s,u[h]))return!0;for(let h=0;h<s.length;h++)if(Ap(u,s[h]))return!0;return!!LE(u,s)}function Nte(u,s,h){return!!Ap(u,s)||!!RE(s,u,h)}function eF(u,s){if(u.length===1)return rF(s,u[0]);for(let h=0;h<s.length;h++){const p=s[h];for(let _=0;_<p.length;_++)if(Ap(u,p[_]))return!0}for(let h=0;h<u.length;h++)if(rF(s,u[h]))return!0;for(let h=0;h<s.length;h++)if(LE(u,s[h]))return!0;return!1}function Vte(u,s,h){if(u.length>1){if(LE(u,s))return!0;for(let p=0;p<s.length;p++)if(RE(s[p],u,h))return!0}for(let p=0;p<u.length;p++)if(RE(u[p],s,h))return!0;return!1}function LE(u,s){if(u.length===0||s.length===0)return!1;for(let h=0;h<u.length-1;h++){const p=u[h],_=u[h+1];for(let b=0;b<s.length-1;b++)if(Gte(p,_,s[b],s[b+1]))return!0}return!1}function Gte(u,s,h,p){return Cu(u,h,p)!==Cu(s,h,p)&&Cu(u,s,h)!==Cu(u,s,p)}function RE(u,s,h){const p=h*h;if(s.length===1)return u.distSqr(s[0])<p;for(let _=1;_<s.length;_++)if(tF(u,s[_-1],s[_])<p)return!0;return!1}function tF(u,s,h){const p=s.distSqr(h);if(p===0)return u.distSqr(s);const _=((u.x-s.x)*(h.x-s.x)+(u.y-s.y)*(h.y-s.y))/p;return u.distSqr(_<0?s:_>1?h:h.sub(s)._mult(_)._add(s))}function rF(u,s){let h,p,_,b=!1;for(let T=0;T<u.length;T++){h=u[T];for(let I=0,L=h.length-1;I<h.length;L=I++)p=h[I],_=h[L],p.y>s.y!=_.y>s.y&&s.x<(_.x-p.x)*(s.y-p.y)/(_.y-p.y)+p.x&&(b=!b)}return b}function Ap(u,s){let h=!1;for(let p=0,_=u.length-1;p<u.length;_=p++){const b=u[p],T=u[_];b.y>s.y!=T.y>s.y&&s.x<(T.x-b.x)*(s.y-b.y)/(T.y-b.y)+b.x&&(h=!h)}return h}function nF(u,s,h,p,_){for(const T of u)if(s<=T.x&&h<=T.y&&p>=T.x&&_>=T.y)return!0;const b=[new nr(s,h),new nr(s,_),new nr(p,_),new nr(p,h)];if(u.length>2){for(const T of b)if(Ap(u,T))return!0}for(let T=0;T<u.length-1;T++)if(Ute(u[T],u[T+1],b))return!0;return!1}function Ute(u,s,h){const p=h[0],_=h[2];if(u.x<p.x&&s.x<p.x||u.x>_.x&&s.x>_.x||u.y<p.y&&s.y<p.y||u.y>_.y&&s.y>_.y)return!1;const b=Cu(u,s,h[0]);return b!==Cu(u,s,h[1])||b!==Cu(u,s,h[2])||b!==Cu(u,s,h[3])}function xm(u,s,h,p,_,b){let T=s.y-u.y,I=u.x-s.x;if(b=b||0){const L=T*T+I*I;if(L===0)return!0;const k=Math.sqrt(L);T/=k,I/=k}return!((h.x-u.x)*T+(h.y-u.y)*I-b<0||(p.x-u.x)*T+(p.y-u.y)*I-b<0||(_.x-u.x)*T+(_.y-u.y)*I-b<0)}function kE(u,s,h,p,_,b,T){return!(xm(u,s,p,_,b,T)||xm(s,h,p,_,b,T)||xm(h,u,p,_,b,T)||xm(p,_,u,s,h,T)||xm(_,b,u,s,h,T)||xm(b,p,u,s,h,T))}function bm(u,s,h){const p=s.paint.get(u).value;return p.kind==="constant"?p.value:h.programConfigurations.get(s.id).getMaxValue(u)}function lS(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function iF(u,s,h,p,_){if(!s[0]&&!s[1])return u;const b=nr.convert(s)._mult(_);h==="viewport"&&b._rotate(-p);const T=[];for(let I=0;I<u.length;I++)T.push(u[I].sub(b));return T}function aF(u,s,h,p){const _=nr.convert(u)._mult(p);return s==="viewport"&&_._rotate(-h),_}gr(DE,"CircleBucket",{omit:["layers"]});const $te=new Ze({"circle-sort-key":new Qe(Me.layout_circle["circle-sort-key"]),visibility:new Ve(Me.layout_circle.visibility)});var Hte={paint:new Ze({"circle-radius":new Qe(Me.paint_circle["circle-radius"]),"circle-color":new Qe(Me.paint_circle["circle-color"]),"circle-blur":new Qe(Me.paint_circle["circle-blur"]),"circle-opacity":new Qe(Me.paint_circle["circle-opacity"]),"circle-translate":new Ve(Me.paint_circle["circle-translate"]),"circle-translate-anchor":new Ve(Me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ve(Me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ve(Me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qe(Me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qe(Me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qe(Me.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ve(Me.paint_circle["circle-emissive-strength"])}),layout:$te};class OE{constructor(s,h){this.pos=s,this.dir=h}intersectsPlane(s,h,p){const _=o.Q.dot(h,this.dir);if(Math.abs(_)<1e-6)return!1;const b=((s[0]-this.pos[0])*h[0]+(s[1]-this.pos[1])*h[1]+(s[2]-this.pos[2])*h[2])/_;return p[0]=this.pos[0]+this.dir[0]*b,p[1]=this.pos[1]+this.dir[1]*b,p[2]=this.pos[2]+this.dir[2]*b,!0}closestPointOnSphere(s,h,p){if(o.Q.equals(this.pos,s)||h===0)return p[0]=p[1]=p[2]=0,!1;const[_,b,T]=this.dir,I=this.pos[0]-s[0],L=this.pos[1]-s[1],k=this.pos[2]-s[2],F=_*_+b*b+T*T,N=2*(I*_+L*b+k*T),U=N*N-4*F*(I*I+L*L+k*k-h*h);if(U<0){const Z=Math.max(-N/2,0),Q=I+_*Z,ee=L+b*Z,ie=k+T*Z,oe=Math.hypot(Q,ee,ie);return p[0]=Q*h/oe,p[1]=ee*h/oe,p[2]=ie*h/oe,!1}{const Z=(-N-Math.sqrt(U))/(2*F);if(Z<0){const Q=Math.hypot(I,L,k);return p[0]=I*h/Q,p[1]=L*h/Q,p[2]=k*h/Q,!1}return p[0]=I+_*Z,p[1]=L+b*Z,p[2]=k+T*Z,!0}}}class zE{constructor(s,h,p,_,b){this.TL=s,this.TR=h,this.BR=p,this.BL=_,this.horizon=b}static fromInvProjectionMatrix(s,h,p){const _=[-1,1,1],b=[1,1,1],T=[1,-1,1],I=[-1,-1,1],L=o.Q.transformMat4(_,_,s),k=o.Q.transformMat4(b,b,s),F=o.Q.transformMat4(T,T,s),N=o.Q.transformMat4(I,I,s);return new zE(L,k,F,N,h/p)}}function I0(u,s,h){let p=1/0,_=-1/0;const b=[];for(const T of u){o.Q.sub(b,T,s);const I=o.Q.dot(b,h);p=Math.min(p,I),_=Math.max(_,I)}return[p,_]}function oF(u,s){let h=!0;for(let p=0;p<u.planes.length;p++){const _=u.planes[p];let b=0;for(let T=0;T<s.length;T++)b+=o.Q.dot(_,s[T])+_[3]>=0;if(b===0)return 0;b!==s.length&&(h=!1)}return h?2:1}function sF(u,s){for(const h of u.projections){const p=I0(s,u.points[0],h.axis);if(h.projection[1]<p[0]||h.projection[0]>p[1])return 0}return 1}function lF(u,s){let h=0;const p=[0,0,0,0];for(let _=0;_<u.length;_++)p[0]=u[_][0],p[1]=u[_][1],p[2]=u[_][2],p[3]=1,o.aa.dot(p,s)>=0&&h++;return h}class BE{constructor(s,h){this.points=s||new Array(8).fill([0,0,0]),this.planes=h||new Array(6).fill([0,0,0,0]),this.bounds=Li.fromPoints(this.points),this.projections=[],this.frustumEdges=[o.Q.sub([],this.points[2],this.points[3]),o.Q.sub([],this.points[0],this.points[3]),o.Q.sub([],this.points[4],this.points[0]),o.Q.sub([],this.points[5],this.points[1]),o.Q.sub([],this.points[6],this.points[2]),o.Q.sub([],this.points[7],this.points[3])];for(const p of this.frustumEdges){const _=[0,-p[2],p[1]],b=[p[2],0,-p[0]];this.projections.push({axis:_,projection:I0(this.points,this.points[0],_)}),this.projections.push({axis:b,projection:I0(this.points,this.points[0],b)})}}static fromInvProjectionMatrix(s,h,p,_){const b=Math.pow(2,p),T=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const F=o.aa.transformMat4([],k,s),N=1/F[3]/h*b;return o.aa.mul(F,F,[N,N,_?1/F[3]:N,N])}),I=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const F=o.Q.sub([],T[k[0]],T[k[1]]),N=o.Q.sub([],T[k[2]],T[k[1]]),U=o.Q.normalize([],o.Q.cross([],F,N)),Z=-o.Q.dot(U,T[k[1]]);return U.concat(Z)}),L=[];for(let k=0;k<T.length;k++)L.push([T[k][0],T[k][1],T[k][2]]);return new BE(L,I)}intersectsPrecise(s,h,p){for(let _=0;_<h.length;_++)if(!lF(s,h[_]))return 0;for(let _=0;_<this.planes.length;_++)if(!lF(s,this.planes[_]))return 0;for(const _ of p)for(const b of this.frustumEdges){const T=o.Q.cross([],_,b),I=o.Q.length(T);if(I===0)continue;o.Q.scale(T,T,1/I);const L=I0(this.points,this.points[0],T),k=I0(s,this.points[0],T);if(L[0]>k[1]||k[0]>L[1])return 0}return 1}}class Li{static fromPoints(s){const h=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const _ of s)o.Q.min(h,h,_),o.Q.max(p,p,_);return new Li(h,p)}static fromTileIdAndHeight(s,h,p){const _=1<<s.canonical.z,b=s.canonical.x,T=s.canonical.y;return new Li([b/_,T/_,h],[(b+1)/_,(T+1)/_,p])}static applyTransform(s,h){const p=s.getCorners();for(let _=0;_<p.length;++_)o.Q.transformMat4(p[_],p[_],h);return Li.fromPoints(p)}static projectAabbCorners(s,h){const p=s.getCorners();for(let _=0;_<p.length;++_)o.Q.transformMat4(p[_],p[_],h);return p}constructor(s,h){this.min=s,this.max=h,this.center=o.Q.scale([],o.Q.add([],this.min,this.max),.5)}quadrant(s){const h=[s%2==0,s<2],p=o.Q.clone(this.min),_=o.Q.clone(this.max);for(let b=0;b<h.length;b++)p[b]=h[b]?this.min[b]:this.center[b],_[b]=h[b]?this.center[b]:this.max[b];return _[2]=this.max[2],new Li(p,_)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,h=this.max;return[[s[0],s[1],s[2]],[h[0],s[1],s[2]],[h[0],h[1],s[2]],[s[0],h[1],s[2]],[s[0],s[1],h[2]],[h[0],s[1],h[2]],[h[0],h[1],h[2]],[s[0],h[1],h[2]]]}intersects(s){return this.intersectsAabb(s.bounds)?oF(s,this.getCorners()):0}intersectsFlat(s){return this.intersectsAabb(s.bounds)?oF(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(s,h){return h||this.intersects(s)?sF(s,this.getCorners()):0}intersectsPreciseFlat(s,h){return h||this.intersectsFlat(s)?sF(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(s){for(let h=0;h<3;++h)if(this.min[h]>s.max[h]||s.min[h]>this.max[h])return!1;return!0}intersectsAabbXY(s){return!(this.min[0]>s.max[0]||s.min[0]>this.max[0]||this.min[1]>s.max[1]||s.min[1]>this.max[1])}encapsulate(s){for(let h=0;h<3;h++)this.min[h]=Math.min(this.min[h],s.min[h]),this.max[h]=Math.max(this.max[h],s.max[h])}encapsulatePoint(s){for(let h=0;h<3;h++)this.min[h]=Math.min(this.min[h],s[h]),this.max[h]=Math.max(this.max[h],s[h])}closestPoint(s){return[Math.max(Math.min(this.max[0],s[0]),this.min[0]),Math.max(Math.min(this.max[1],s[1]),this.min[1]),Math.max(Math.min(this.max[2],s[2]),this.min[2])]}}gr(Li,"Aabb");const jte=Kr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:uS}=jte,Wte=Kr([{name:"a_pos_3",components:3,type:"Int16"}]);var uF=Kr([{name:"a_pos",type:"Int16",components:2}]);function cS(u){return u*Do/ym}const Zte=[new Li([cl,cl,cl],[hl,hl,hl]),new Li([cl,cl,cl],[0,0,hl]),new Li([0,cl,cl],[hl,0,hl]),new Li([cl,0,cl],[0,hl,hl]),new Li([0,0,cl],[hl,hl,hl])];function cF(u,s,h,p=!0){const _=o.Q.scale([],u._camera.position,u.worldSize),b=[s,h,1,1];o.aa.transformMat4(b,b,u.pixelMatrixInverse),o.aa.scale(b,b,1/b[3]);const T=o.Q.sub([],b,_),I=o.Q.normalize([],T),L=u.globeMatrix,k=[L[12],L[13],L[14]],F=o.Q.sub([],k,_),N=o.Q.length(F),U=o.Q.normalize([],F),Z=u.worldSize/(2*Math.PI),Q=o.Q.dot(U,I),ee=Math.asin(Z/N);if(ee<Math.acos(Q)){if(!p)return null;const Je=[],yt=[];o.Q.scale(Je,I,N/Q),o.Q.normalize(yt,o.Q.sub(yt,Je,F)),o.Q.normalize(I,o.Q.add(I,F,o.Q.scale(I,yt,Math.tan(ee)*N)))}const ie=[];new OE(_,I).closestPointOnSphere(k,Z,ie);const oe=o.Q.normalize([],Tc(L,0)),_e=o.Q.normalize([],Tc(L,1)),Se=o.Q.normalize([],Tc(L,2)),xe=o.Q.dot(oe,ie),Re=o.Q.dot(_e,ie),Te=o.Q.dot(Se,ie),Be=mo(Math.asin(-Re/Z));let Ne=mo(Math.atan2(xe,Te));Ne=u.center.lng+function(Je,yt){const _t=(yt-Je+180)%360-180;return _t<-180?_t+360:_t}(u.center.lng,Ne);const Xe=rf(Ne),ft=wn(Vc(Be),0,1);return new oo(Xe,ft)}class qte{constructor(s,h,p){this.a=o.Q.sub([],s,p),this.b=o.Q.sub([],h,p),this.center=p;const _=o.Q.normalize([],this.a),b=o.Q.normalize([],this.b);this.angle=Math.acos(o.Q.dot(_,b))}}function FE(u,s){if(u.angle===0)return null;let h;return h=u.a[s]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[s]/u.a[s]/Math.sin(u.angle)-1/Math.tan(u.angle)),h<0||h>1?null:function(p,_,b,T){const I=Math.sin(b);return p*(Math.sin((1-T)*b)/I)+_*(Math.sin(T*b)/I)}(u.a[s],u.b[s],u.angle,wn(h,0,1))+u.center[s]}function Fu(u){if(u.z<=1)return Zte[u.z+2*u.y+u.x];const s=NE(hS(u));return Li.fromPoints(s)}function Uc(u,s,h){return o.Q.scale(u,u,1-h),o.Q.scaleAndAdd(u,u,s,h)}function hF(u,s,h){for(const p of u)o.Q.transformMat4(p,p,s),o.Q.scale(p,p,h)}function fF(u,s,h,p){const _=s/u.worldSize,b=u.globeMatrix;if(h.z<=1){const Xe=Fu(h).getCorners();return hF(Xe,b,_),Li.fromPoints(Xe)}const T=hS(h,p),I=NE(T,Do+cS(u._tileCoverLift));hF(I,b,_);const L=Number.MAX_VALUE,k=[-L,-L,-L],F=[L,L,L];if(T.contains(u.center)){for(const Je of I)o.Q.min(F,F,Je),o.Q.max(k,k,Je);k[2]=0;const Xe=u.point,ft=[Xe.x*_,Xe.y*_,0];return o.Q.min(F,F,ft),o.Q.max(k,k,ft),new Li(F,k)}if(u._tileCoverLift>0){for(const Xe of I)o.Q.min(F,F,Xe),o.Q.max(k,k,Xe);return new Li(F,k)}const N=[b[12]*_,b[13]*_,b[14]*_],U=T.getCenter(),Z=wn(u.center.lat,-ta,ta),Q=wn(U.lat,-ta,ta),ee=rf(u.center.lng),ie=Vc(Z);let oe=ee-rf(U.lng);const _e=ie-Vc(Q);oe>.5?oe-=1:oe<-.5&&(oe+=1);let Se=0;if(Math.abs(oe)>Math.abs(_e))Se=oe>=0?1:3;else{Se=_e>=0?0:2;const Xe=[b[4]*_,b[5]*_,b[6]*_],ft=-Math.sin(On(_e>=0?T.getSouth():T.getNorth()))*Do;o.Q.scaleAndAdd(N,N,Xe,ft)}const xe=I[Se],Re=I[(Se+1)%4],Te=new qte(xe,Re,N),Be=[FE(Te,0)||xe[0],FE(Te,1)||xe[1],FE(Te,2)||xe[2]],Ne=af(u.zoom);if(Ne>0){const Xe=function({x:Je,y:yt,z:_t},dt,Pt,It,zt){const Ot=1/(1<<_t);let xt=Je*Ot,mr=xt+Ot,fr=yt*Ot,Gt=fr+Ot,Rr=0;const Sr=(xt+mr)/2-It;return Sr>.5?Rr=-1:Sr<-.5&&(Rr=1),xt=((xt+Rr)*dt-(It*=dt))*Pt+It,mr=((mr+Rr)*dt-It)*Pt+It,fr=(fr*dt-(zt*=dt))*Pt+zt,Gt=(Gt*dt-zt)*Pt+zt,[[xt,Gt,0],[mr,Gt,0],[mr,fr,0],[xt,fr,0]]}(h,s,u._pixelsPerMercatorPixel,ee,ie);for(let Je=0;Je<I.length;Je++)Uc(I[Je],Xe[Je],Ne);const ft=o.Q.add([],Xe[Se],Xe[(Se+1)%4]);o.Q.scale(ft,ft,.5),Uc(Be,ft,Ne)}for(const Xe of I)o.Q.min(F,F,Xe),o.Q.max(k,k,Xe);return F[2]=Math.min(xe[2],Re[2]),o.Q.min(F,F,Be),o.Q.max(k,k,Be),new Li(F,k)}function hS({x:u,y:s,z:h},p=!1){const _=1/(1<<h),b=new Fn(fs(u*_),s===(1<<h)-1&&p?-90:qa((s+1)*_)),T=new Fn(fs((u+1)*_),s===0&&p?90:qa(s*_));return new tf(b,T)}function NE(u,s=Do){const h=On(u.getNorth()),p=On(u.getSouth()),_=Math.cos(h),b=Math.cos(p),T=Math.sin(h),I=Math.sin(p),L=u.getWest(),k=u.getEast();return[_m(b,I,L,s),_m(b,I,k,s),_m(_,T,k,s),_m(_,T,L,s)]}function E0(u,s,h,p){const _=1<<h.z,b=(u/ir+h.x)/_;return wp(qa((s/ir+h.y)/_),fs(b),p)}function fS({min:u,max:s}){return Lte/Math.max(s[0]-u[0],s[1]-u[1],s[2]-u[2])}const dF=new Float64Array(16);function dS(u){const s=fS(u),h=o.a9.fromScaling(dF,[s,s,s]);return o.a9.translate(h,h,o.Q.negate([],u.min))}function VE(u){const s=o.a9.fromTranslation(dF,u.min),h=1/fS(u);return o.a9.scale(s,s,[h,h,h])}function GE(u){const s=ir/(2*Math.PI);return u/(2*Math.PI)/s}function pF(u,s){return ir/(512*Math.pow(2,u))*fS(Fu(s))}function gF(u,s,h,p,_){const b=GE(h),T=[u,s,-h/(2*Math.PI)],I=o.a9.identity(new Float64Array(16));return o.a9.translate(I,I,T),o.a9.scale(I,I,[b,b,b]),o.a9.rotateX(I,I,On(-_)),o.a9.rotateY(I,I,On(-p)),I}function af(u){return Pd(SE,W5,u)}function vF(u,s){const h=wp(s.lat,s.lng),p=function(b){const T=wp(b._center.lat,b._center.lng),I=o.Q.fromValues(0,1,0);let L=o.Q.cross([],I,T);const k=o.a9.fromRotation([],-b.angle,T);L=o.Q.transformMat4(L,L,k),o.a9.fromRotation(k,-b._pitch,L);const F=o.Q.normalize([],T);return o.Q.scale(F,F,cS(b.cameraToCenterDistance/b.pixelsPerMeter)),o.Q.transformMat4(F,F,k),o.Q.add([],T,F)}(u),_=o.Q.subtract([],p,h);return o.Q.angle(_,h)}function UE(u,s){return vF(u,s)>Math.PI/2*1.01}const mF=On(85),Yte=Math.cos(mF),Xte=Math.sin(mF),Qte=o.a9.create(),_F=u=>{const s=[];return u.paint.get("circle-pitch-alignment")==="map"&&s.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&s.push("SCALE_WITH_MAP"),s};function yF(u,s,h,p,_,b,T,I,L){if(b&&u.queryGeometry.isAboveHorizon)return!1;b&&(L*=u.pixelToTileUnitsFactor);const k=u.tileID.canonical,F=h.projection.upVectorScale(k,h.center.lat,h.worldSize).metersToTile;for(const N of s)for(const U of N){const Z=U.add(I),Q=_&&h.elevation?h.elevation.exaggeration()*_.getElevationAt(Z.x,Z.y,!0):0,ee=h.projection.projectTilePoint(Z.x,Z.y,k);if(Q>0){const Se=h.projection.upVector(k,Z.x,Z.y);ee.x+=Se[0]*F*Q,ee.y+=Se[1]*F*Q,ee.z+=Se[2]*F*Q}const ie=b?Z:Kte(ee.x,ee.y,ee.z,p),oe=b?u.tilespaceRays.map(Se=>ere(Se,Q)):u.queryGeometry.screenGeometry,_e=o.aa.transformMat4([],[ee.x,ee.y,ee.z,1],p);if(!T&&b?L*=_e[3]/h.cameraToCenterDistance:T&&!b&&(L*=h.cameraToCenterDistance/_e[3]),b){const Se=qa((U.y/ir+k.y)/(1<<k.z));L/=h.projection.pixelsPerMeter(Se,1)/Po(1,Se)}if(Nte(oe,ie,L))return!0}return!1}function Kte(u,s,h,p){const _=o.aa.transformMat4([],[u,s,h,1],p);return new nr(_[0]/_[3],_[1]/_[3])}const xF=o.Q.fromValues(0,0,0),Jte=o.Q.fromValues(0,0,1);function ere(u,s){const h=o.Q.create();return xF[2]=s,u.intersectsPlane(xF,Jte,h),new nr(h[0],h[1])}class bF extends DE{}function wF(u,{width:s,height:h},p,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==s*h*p)throw new RangeError("mismatched image size")}else _=new Uint8Array(s*h*p);return u.width=s,u.height=h,u.data=_,u}function SF(u,s,h){const{width:p,height:_}=s;p===u.width&&_===u.height||($E(u,s,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,p),height:Math.min(u.height,_)},h),u.width=p,u.height=_,u.data=s.data)}function $E(u,s,h,p,_,b,T){if(_.width===0||_.height===0)return s;if(_.width>u.width||_.height>u.height||h.x>u.width-_.width||h.y>u.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>s.width||_.height>s.height||p.x>s.width-_.width||p.y>s.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const I=u.data,L=s.data,k=b===4&&T;for(let F=0;F<_.height;F++){const N=((h.y+F)*u.width+h.x)*b,U=((p.y+F)*s.width+p.x)*b;if(k)for(let Z=0;Z<_.width;Z++){const Q=N+Z*b+3,ee=U+Z*b;L[ee+0]=255,L[ee+1]=255,L[ee+2]=255,L[ee+3]=I[Q]}else for(let Z=0;Z<_.width*b;Z++)L[U+Z]=I[N+Z]}return s}gr(bF,"HeatmapBucket",{omit:["layers"]});class of{constructor(s,h){wF(this,s,1,h)}resize(s){SF(this,new of(s),1)}clone(){return new of({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,h,p,_,b){$E(s,h,p,_,b,1)}}class Gs{constructor(s,h){wF(this,s,4,h)}resize(s){SF(this,new Gs(s),4)}replace(s,h){h?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Gs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,h,p,_,b,T){$E(s,h,p,_,b,4,T)}}class TF{constructor(s,h){this.width=s.width,this.height=s.height,this.data=h instanceof Uint8Array?new Float32Array(h.buffer):h}}gr(of,"AlphaImage"),gr(Gs,"RGBAImage");const tre=new Ze({visibility:new Ve(Me.layout_heatmap.visibility)});var rre={paint:new Ze({"heatmap-radius":new Qe(Me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qe(Me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ve(Me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new kt(Me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ve(Me.paint_heatmap["heatmap-opacity"])}),layout:tre};function D0(u){const s={},h=u.resolution||256,p=u.clips?u.clips.length:1,_=u.image||new Gs({width:h,height:p}),b=(T,I,L)=>{s[u.evaluationKey]=L;const k=u.expression.evaluate(s);k&&(_.data[T+I+0]=Math.floor(255*k.r/k.a),_.data[T+I+1]=Math.floor(255*k.g/k.a),_.data[T+I+2]=Math.floor(255*k.b/k.a),_.data[T+I+3]=Math.floor(255*k.a))};if(u.clips)for(let T=0,I=0;T<p;++T,I+=4*h)for(let L=0,k=0;L<h;L++,k+=4){const F=L/(h-1),{start:N,end:U}=u.clips[T];b(I,k,N*(1-F)+U*F)}else for(let T=0,I=0;T<h;T++,I+=4)b(0,I,T/(h-1));return _}const nre=new Ze({visibility:new Ve(Me.layout_hillshade.visibility)});var ire={paint:new Ze({"hillshade-illumination-direction":new Ve(Me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ve(Me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ve(Me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ve(Me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ve(Me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ve(Me.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ve(Me.paint_hillshade["hillshade-emissive-strength"])}),layout:nre};const are=Kr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ore}=are;var HE={exports:{}};function pS(u,s,h){h=h||2;var p,_,b,T,I,L,k,F=s&&s.length,N=F?s[0]*h:u.length,U=AF(u,0,N,h,!0),Z=[];if(!U||U.next===U.prev)return Z;if(F&&(U=function(ee,ie,oe,_e){var Se,xe,Re,Te=[];for(Se=0,xe=ie.length;Se<xe;Se++)(Re=AF(ee,ie[Se]*_e,Se<xe-1?ie[Se+1]*_e:ee.length,_e,!1))===Re.next&&(Re.steiner=!0),Te.push(pre(Re));for(Te.sort(hre),Se=0;Se<Te.length;Se++)oe=fre(Te[Se],oe);return oe}(u,s,U,h)),u.length>80*h){p=b=u[0],_=T=u[1];for(var Q=h;Q<N;Q+=h)(I=u[Q])<p&&(p=I),(L=u[Q+1])<_&&(_=L),I>b&&(b=I),L>T&&(T=L);k=(k=Math.max(b-p,T-_))!==0?32767/k:0}return P0(U,Z,h,p,_,k,0),Z}function AF(u,s,h,p,_){var b,T;if(_===ZE(u,s,h,p)>0)for(b=s;b<h;b+=p)T=IF(b,u[b],u[b+1],T);else for(b=h-p;b>=s;b-=p)T=IF(b,u[b],u[b+1],T);return T&&gS(T,T.next)&&(R0(T),T=T.next),T}function Cp(u,s){if(!u)return u;s||(s=u);var h,p=u;do if(h=!1,p.steiner||!gS(p,p.next)&&ga(p.prev,p,p.next)!==0)p=p.next;else{if(R0(p),(p=s=p.prev)===p.next)break;h=!0}while(h||p!==s);return s}function P0(u,s,h,p,_,b,T){if(u){!T&&b&&function(F,N,U,Z){var Q=F;do Q.z===0&&(Q.z=jE(Q.x,Q.y,N,U,Z)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==F);Q.prevZ.nextZ=null,Q.prevZ=null,function(ee){var ie,oe,_e,Se,xe,Re,Te,Be,Ne=1;do{for(oe=ee,ee=null,xe=null,Re=0;oe;){for(Re++,_e=oe,Te=0,ie=0;ie<Ne&&(Te++,_e=_e.nextZ);ie++);for(Be=Ne;Te>0||Be>0&&_e;)Te!==0&&(Be===0||!_e||oe.z<=_e.z)?(Se=oe,oe=oe.nextZ,Te--):(Se=_e,_e=_e.nextZ,Be--),xe?xe.nextZ=Se:ee=Se,Se.prevZ=xe,xe=Se;oe=_e}xe.nextZ=null,Ne*=2}while(Re>1)}(Q)}(u,p,_,b);for(var I,L,k=u;u.prev!==u.next;)if(I=u.prev,L=u.next,b?lre(u,p,_,b):sre(u))s.push(I.i/h|0),s.push(u.i/h|0),s.push(L.i/h|0),R0(u),u=L.next,k=L.next;else if((u=L)===k){T?T===1?P0(u=ure(Cp(u),s,h),s,h,p,_,b,2):T===2&&cre(u,s,h,p,_,b):P0(Cp(u),s,h,p,_,b,1);break}}}function sre(u){var s=u.prev,h=u,p=u.next;if(ga(s,h,p)>=0)return!1;for(var _=s.x,b=h.x,T=p.x,I=s.y,L=h.y,k=p.y,F=_<b?_<T?_:T:b<T?b:T,N=I<L?I<k?I:k:L<k?L:k,U=_>b?_>T?_:T:b>T?b:T,Z=I>L?I>k?I:k:L>k?L:k,Q=p.next;Q!==s;){if(Q.x>=F&&Q.x<=U&&Q.y>=N&&Q.y<=Z&&wm(_,I,b,L,T,k,Q.x,Q.y)&&ga(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function lre(u,s,h,p){var _=u.prev,b=u,T=u.next;if(ga(_,b,T)>=0)return!1;for(var I=_.x,L=b.x,k=T.x,F=_.y,N=b.y,U=T.y,Z=I<L?I<k?I:k:L<k?L:k,Q=F<N?F<U?F:U:N<U?N:U,ee=I>L?I>k?I:k:L>k?L:k,ie=F>N?F>U?F:U:N>U?N:U,oe=jE(Z,Q,s,h,p),_e=jE(ee,ie,s,h,p),Se=u.prevZ,xe=u.nextZ;Se&&Se.z>=oe&&xe&&xe.z<=_e;){if(Se.x>=Z&&Se.x<=ee&&Se.y>=Q&&Se.y<=ie&&Se!==_&&Se!==T&&wm(I,F,L,N,k,U,Se.x,Se.y)&&ga(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,xe.x>=Z&&xe.x<=ee&&xe.y>=Q&&xe.y<=ie&&xe!==_&&xe!==T&&wm(I,F,L,N,k,U,xe.x,xe.y)&&ga(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;Se&&Se.z>=oe;){if(Se.x>=Z&&Se.x<=ee&&Se.y>=Q&&Se.y<=ie&&Se!==_&&Se!==T&&wm(I,F,L,N,k,U,Se.x,Se.y)&&ga(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;xe&&xe.z<=_e;){if(xe.x>=Z&&xe.x<=ee&&xe.y>=Q&&xe.y<=ie&&xe!==_&&xe!==T&&wm(I,F,L,N,k,U,xe.x,xe.y)&&ga(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function ure(u,s,h){var p=u;do{var _=p.prev,b=p.next.next;!gS(_,b)&&CF(_,p,p.next,b)&&L0(_,b)&&L0(b,_)&&(s.push(_.i/h|0),s.push(p.i/h|0),s.push(b.i/h|0),R0(p),R0(p.next),p=u=b),p=p.next}while(p!==u);return Cp(p)}function cre(u,s,h,p,_,b){var T=u;do{for(var I=T.next.next;I!==T.prev;){if(T.i!==I.i&&gre(T,I)){var L=MF(T,I);return T=Cp(T,T.next),L=Cp(L,L.next),P0(T,s,h,p,_,b,0),void P0(L,s,h,p,_,b,0)}I=I.next}T=T.next}while(T!==u)}function hre(u,s){return u.x-s.x}function fre(u,s){var h=function(_,b){var T,I=b,L=_.x,k=_.y,F=-1/0;do{if(k<=I.y&&k>=I.next.y&&I.next.y!==I.y){var N=I.x+(k-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(N<=L&&N>F&&(F=N,T=I.x<I.next.x?I:I.next,N===L))return T}I=I.next}while(I!==b);if(!T)return null;var U,Z=T,Q=T.x,ee=T.y,ie=1/0;I=T;do L>=I.x&&I.x>=Q&&L!==I.x&&wm(k<ee?L:F,k,Q,ee,k<ee?F:L,k,I.x,I.y)&&(U=Math.abs(k-I.y)/(L-I.x),L0(I,_)&&(U<ie||U===ie&&(I.x>T.x||I.x===T.x&&dre(T,I)))&&(T=I,ie=U)),I=I.next;while(I!==Z);return T}(u,s);if(!h)return s;var p=MF(h,u);return Cp(p,p.next),Cp(h,h.next)}function dre(u,s){return ga(u.prev,u,s.prev)<0&&ga(s.next,u,u.next)<0}function jE(u,s,h,p,_){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*_|0)|u<<8))|u<<4))|u<<2))|u<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*_|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function pre(u){var s=u,h=u;do(s.x<h.x||s.x===h.x&&s.y<h.y)&&(h=s),s=s.next;while(s!==u);return h}function wm(u,s,h,p,_,b,T,I){return(_-T)*(s-I)>=(u-T)*(b-I)&&(u-T)*(p-I)>=(h-T)*(s-I)&&(h-T)*(b-I)>=(_-T)*(p-I)}function gre(u,s){return u.next.i!==s.i&&u.prev.i!==s.i&&!function(h,p){var _=h;do{if(_.i!==h.i&&_.next.i!==h.i&&_.i!==p.i&&_.next.i!==p.i&&CF(_,_.next,h,p))return!0;_=_.next}while(_!==h);return!1}(u,s)&&(L0(u,s)&&L0(s,u)&&function(h,p){var _=h,b=!1,T=(h.x+p.x)/2,I=(h.y+p.y)/2;do _.y>I!=_.next.y>I&&_.next.y!==_.y&&T<(_.next.x-_.x)*(I-_.y)/(_.next.y-_.y)+_.x&&(b=!b),_=_.next;while(_!==h);return b}(u,s)&&(ga(u.prev,u,s.prev)||ga(u,s.prev,s))||gS(u,s)&&ga(u.prev,u,u.next)>0&&ga(s.prev,s,s.next)>0)}function ga(u,s,h){return(s.y-u.y)*(h.x-s.x)-(s.x-u.x)*(h.y-s.y)}function gS(u,s){return u.x===s.x&&u.y===s.y}function CF(u,s,h,p){var _=mS(ga(u,s,h)),b=mS(ga(u,s,p)),T=mS(ga(h,p,u)),I=mS(ga(h,p,s));return _!==b&&T!==I||!(_!==0||!vS(u,h,s))||!(b!==0||!vS(u,p,s))||!(T!==0||!vS(h,u,p))||!(I!==0||!vS(h,s,p))}function vS(u,s,h){return s.x<=Math.max(u.x,h.x)&&s.x>=Math.min(u.x,h.x)&&s.y<=Math.max(u.y,h.y)&&s.y>=Math.min(u.y,h.y)}function mS(u){return u>0?1:u<0?-1:0}function L0(u,s){return ga(u.prev,u,u.next)<0?ga(u,s,u.next)>=0&&ga(u,u.prev,s)>=0:ga(u,s,u.prev)<0||ga(u,u.next,s)<0}function MF(u,s){var h=new WE(u.i,u.x,u.y),p=new WE(s.i,s.x,s.y),_=u.next,b=s.prev;return u.next=s,s.prev=u,h.next=_,_.prev=h,p.next=h,h.prev=p,b.next=p,p.prev=b,p}function IF(u,s,h,p){var _=new WE(u,s,h);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function R0(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function WE(u,s,h){this.i=u,this.x=s,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ZE(u,s,h,p){for(var _=0,b=s,T=h-p;b<h;b+=p)_+=(u[T]-u[b])*(u[b+1]+u[T+1]),T=b;return _}HE.exports=pS,HE.exports.default=pS,pS.deviation=function(u,s,h,p){var _=s&&s.length,b=Math.abs(ZE(u,0,_?s[0]*h:u.length,h));if(_)for(var T=0,I=s.length;T<I;T++)b-=Math.abs(ZE(u,s[T]*h,T<I-1?s[T+1]*h:u.length,h));var L=0;for(T=0;T<p.length;T+=3){var k=p[T]*h,F=p[T+1]*h,N=p[T+2]*h;L+=Math.abs((u[k]-u[N])*(u[F+1]-u[k+1])-(u[k]-u[F])*(u[N+1]-u[k+1]))}return b===0&&L===0?0:Math.abs((L-b)/b)},pS.flatten=function(u){for(var s=u[0][0].length,h={vertices:[],holes:[],dimensions:s},p=0,_=0;_<u.length;_++){for(var b=0;b<u[_].length;b++)for(var T=0;T<s;T++)h.vertices.push(u[_][b][T]);_>0&&h.holes.push(p+=u[_-1].length)}return h};var _S=z(HE.exports);function qE(u,s){const h=u.length;if(h<=1)return[u];const p=[];let _,b;for(let T=0;T<h;T++){const I=Rd(u[T]);I!==0&&(u[T].area=Math.abs(I),b===void 0&&(b=I<0),b===I<0?(_&&p.push(_),_=[u[T]]):_.push(u[T]))}if(_&&p.push(_),s>1)for(let T=0;T<p.length;T++)p[T].length<=s||(Sw(p[T],s,1,p[T].length-1,vre),p[T]=p[T].slice(0,s));return p}function vre(u,s){return s.area-u.area}function YE(u,s,h){const p=h.patternDependencies;let _=!1;for(const b of s){const T=b.paint.get(`${u}-pattern`);T.isConstant()||(_=!0);const I=T.constantOr(null);I&&(_=!0,p[I]=!0)}return _}function XE(u,s,h,p,_){const b=_.patternDependencies;for(const T of s){const I=T.paint.get(`${u}-pattern`).value;if(I.kind!=="constant"){let L=I.evaluate({zoom:p},h,{},_.availableImages);L=L&&L.name?L.name:L,b[L]=!0,h.patterns[T.id]=L}}return h}class QE{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.fqid),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wa,this.indexArray=new ba,this.indexArray2=new hs,this.programConfigurations=new ef(s.layers,s.zoom),this.segments=new ea,this.segments2=new ea,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.projection=s.projection}populate(s,h,p,_){this.hasPattern=YE("fill",this.layers,h);const b=this.layers[0].layout.get("fill-sort-key"),T=[];for(const{feature:I,id:L,index:k,sourceLayerIndex:F}of s){const N=this.layers[0]._featureFilter.needGeometry,U=nf(I,N);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),U,p))continue;const Z=b?b.evaluate(U,{},p,h.availableImages):void 0,Q={id:L,properties:I.properties,type:I.type,sourceLayerIndex:F,index:k,geometry:N?U.geometry:Gc(I,p,_),patterns:{},sortKey:Z};T.push(Q)}b&&T.sort((I,L)=>I.sortKey-L.sortKey);for(const I of T){const{geometry:L,index:k,sourceLayerIndex:F}=I;if(this.hasPattern){const N=XE("fill",this.layers,I,this.zoom,h);this.patternFeatures.push(N)}else this.addFeature(I,L,k,p,{},h.availableImages,h.brightness);h.featureIndex.insert(s[k].feature,L,k,F,this.index)}}update(s,h,p,_,b){const T=Object.keys(s).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(s,h,T?this.stateDependentLayers:this.layers,p,_,b)}addFeatures(s,h,p,_,b,T){for(const I of this.patternFeatures)this.addFeature(I,I.geometry,I.index,h,p,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ore),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,h,p,_,b,T=[],I){for(const L of qE(h,500)){let k=0;for(const ee of L)k+=ee.length;const F=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),N=F.vertexLength,U=[],Z=[];for(const ee of L){if(ee.length===0)continue;ee!==L[0]&&Z.push(U.length/2);const ie=this.segments2.prepareSegment(ee.length,this.layoutVertexArray,this.indexArray2),oe=ie.vertexLength;this.layoutVertexArray.emplaceBack(ee[0].x,ee[0].y),this.indexArray2.emplaceBack(oe+ee.length-1,oe),U.push(ee[0].x),U.push(ee[0].y);for(let _e=1;_e<ee.length;_e++)this.layoutVertexArray.emplaceBack(ee[_e].x,ee[_e].y),this.indexArray2.emplaceBack(oe+_e-1,oe+_e),U.push(ee[_e].x),U.push(ee[_e].y);ie.vertexLength+=ee.length,ie.primitiveLength+=ee.length}const Q=_S(U,Z);for(let ee=0;ee<Q.length;ee+=3)this.indexArray.emplaceBack(N+Q[ee],N+Q[ee+1],N+Q[ee+2]);F.vertexLength+=k,F.primitiveLength+=Q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,b,T,_,I)}}gr(QE,"FillBucket",{omit:["layers","patternFeatures"]});const mre=new Ze({"fill-sort-key":new Qe(Me.layout_fill["fill-sort-key"]),visibility:new Ve(Me.layout_fill.visibility)});var _re={paint:new Ze({"fill-antialias":new Ve(Me.paint_fill["fill-antialias"]),"fill-opacity":new Qe(Me.paint_fill["fill-opacity"]),"fill-color":new Qe(Me.paint_fill["fill-color"]),"fill-outline-color":new Qe(Me.paint_fill["fill-outline-color"]),"fill-translate":new Ve(Me.paint_fill["fill-translate"]),"fill-translate-anchor":new Ve(Me.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qe(Me.paint_fill["fill-pattern"]),"fill-emissive-strength":new Ve(Me.paint_fill["fill-emissive-strength"])}),layout:mre};const yre=Kr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),xre=Kr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),bre=Kr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),wre=Kr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Sre=Kr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Tre}=yre;var yS={},Are=wv,EF=Sm;function Sm(u,s,h,p,_){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=p,this._values=_,u.readFields(Cre,this,s)}function Cre(u,s,h){u==1?s.id=h.readVarint():u==2?function(p,_){for(var b=p.readVarint()+p.pos;p.pos<b;){var T=_._keys[p.readVarint()],I=_._values[p.readVarint()];_.properties[T]=I}}(h,s):u==3?s.type=h.readVarint():u==4&&(s._geometry=h.pos)}function Mre(u){for(var s,h,p=0,_=0,b=u.length,T=b-1;_<b;T=_++)p+=((h=u[T]).x-(s=u[_]).x)*(s.y+h.y);return p}Sm.types=["Unknown","Point","LineString","Polygon"],Sm.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var s,h=u.readVarint()+u.pos,p=1,_=0,b=0,T=0,I=[];u.pos<h;){if(_<=0){var L=u.readVarint();p=7&L,_=L>>3}if(_--,p===1||p===2)b+=u.readSVarint(),T+=u.readSVarint(),p===1&&(s&&I.push(s),s=[]),s.push(new Are(b,T));else{if(p!==7)throw new Error("unknown command "+p);s&&s.push(s[0].clone())}}return s&&I.push(s),I},Sm.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var s=u.readVarint()+u.pos,h=1,p=0,_=0,b=0,T=1/0,I=-1/0,L=1/0,k=-1/0;u.pos<s;){if(p<=0){var F=u.readVarint();h=7&F,p=F>>3}if(p--,h===1||h===2)(_+=u.readSVarint())<T&&(T=_),_>I&&(I=_),(b+=u.readSVarint())<L&&(L=b),b>k&&(k=b);else if(h!==7)throw new Error("unknown command "+h)}return[T,L,I,k]},Sm.prototype.toGeoJSON=function(u,s,h){var p,_,b=this.extent*Math.pow(2,h),T=this.extent*u,I=this.extent*s,L=this.loadGeometry(),k=Sm.types[this.type];function F(Z){for(var Q=0;Q<Z.length;Q++){var ee=Z[Q];Z[Q]=[360*(ee.x+T)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+I)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(p=0;p<L.length;p++)N[p]=L[p][0];F(L=N);break;case 2:for(p=0;p<L.length;p++)F(L[p]);break;case 3:for(L=function(Z){var Q=Z.length;if(Q<=1)return[Z];for(var ee,ie,oe=[],_e=0;_e<Q;_e++){var Se=Mre(Z[_e]);Se!==0&&(ie===void 0&&(ie=Se<0),ie===Se<0?(ee&&oe.push(ee),ee=[Z[_e]]):ee.push(Z[_e]))}return ee&&oe.push(ee),oe}(L),p=0;p<L.length;p++)for(_=0;_<L[p].length;_++)F(L[p][_])}L.length===1?L=L[0]:k="Multi"+k;var U={type:"Feature",geometry:{type:k,coordinates:L},properties:this.properties};return"id"in this&&(U.id=this.id),U};var Ire=EF,DF=PF;function PF(u,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(Ere,this,s),this.length=this._features.length}function Ere(u,s,h){u===15?s.version=h.readVarint():u===1?s.name=h.readString():u===5?s.extent=h.readVarint():u===2?s._features.push(h.pos):u===3?s._keys.push(h.readString()):u===4&&s._values.push(function(p){for(var _=null,b=p.readVarint()+p.pos;p.pos<b;){var T=p.readVarint()>>3;_=T===1?p.readString():T===2?p.readFloat():T===3?p.readDouble():T===4?p.readVarint64():T===5?p.readVarint():T===6?p.readSVarint():T===7?p.readBoolean():null}return _}(h))}PF.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var s=this._pbf.readVarint()+this._pbf.pos;return new Ire(this._pbf,s,this.extent,this._keys,this._values)};var Dre=DF;function Pre(u,s,h){if(u===3){var p=new Dre(h,h.readVarint()+h.pos);p.length&&(s[p.name]=p)}}var KE=yS.VectorTile=function(u,s){this.layers=u.readFields(Pre,{},s)},xS=yS.VectorTileFeature=EF;function bS(u,s,h,p){const _=[],b=p===0?(T,I,L,k,F,N)=>{T.push(new nr(N,L+(N-I)/(k-I)*(F-L)))}:(T,I,L,k,F,N)=>{T.push(new nr(I+(N-L)/(F-L)*(k-I),N))};for(const T of u){const I=[];for(const L of T){if(L.length<=2)continue;const k=[];for(let U=0;U<L.length-1;U++){const Z=L[U].x,Q=L[U].y,ee=L[U+1].x,ie=L[U+1].y,oe=p===0?Z:Q,_e=p===0?ee:ie;oe<s?_e>s&&b(k,Z,Q,ee,ie,s):oe>h?_e<h&&b(k,Z,Q,ee,ie,h):k.push(L[U]),_e<s&&oe>=s&&b(k,Z,Q,ee,ie,s),_e>h&&oe<=h&&b(k,Z,Q,ee,ie,h)}let F=L[L.length-1];const N=p===0?F.x:F.y;N>=s&&N<=h&&k.push(F),k.length&&(F=k[k.length-1],k[0].x===F.x&&k[0].y===F.y||k.push(k[0]),I.push(k))}I.length&&_.push(I)}return _}function wS(u,s){return u.x-s.x||u.y-s.y}function LF(u,s){return wS(u.min,s.min)===0&&wS(u.max,s.max)===0}function RF(u,s){return!(u.min.x>s.max.x||u.max.x<s.min.x||u.min.y>s.max.y||u.max.y<s.min.y)}function kF(u,s,h){const p=1/ir,_=1/(1<<h.canonical.z),b=(s.x*p+h.canonical.x)*_+h.wrap,T=(s.y*p+h.canonical.y)*_;return{min:new nr((u.x*p+h.canonical.x)*_+h.wrap,(u.y*p+h.canonical.y)*_),max:new nr(b,T)}}function Lre(u,s,h){const p=1<<h.canonical.z,_=((s.x-h.wrap)*p-h.canonical.x)*ir,b=(s.y*p-h.canonical.y)*ir;return{min:new nr(((u.x-h.wrap)*p-h.canonical.x)*ir,(u.y*p-h.canonical.y)*ir),max:new nr(_,b)}}function OF(u,s,h,p,_,b,T){const I=u.indices,L=u.vertices,k=[];for(let F=p;F<p+_;F+=3){const N=s[h[F+0]+b],U=s[h[F+1]+b],Z=s[h[F+2]+b],Q=Math.min(N.x,U.x,Z.x),ee=Math.max(N.x,U.x,Z.x),ie=Math.min(N.y,U.y,Z.y),oe=Math.max(N.y,U.y,Z.y);k.length=0,u.grid.query(new nr(Q,ie),new nr(ee,oe),k);for(let _e=0;_e<k.length;_e++){const Se=k[_e];if(kE(L[I[3*Se+0]],L[I[3*Se+1]],L[I[3*Se+2]],N,U,Z,T))return!0}}return!1}function zF(u,s,h,p){if(!u||!h)return!1;let _=u.vertices;if(!s.canonical.equals(p.canonical)||s.wrap!==p.wrap){if(h.vertices.length<u.vertices.length)return zF(h,p,u,s);const b=s.canonical,T=p.canonical,I=Math.pow(2,T.z-b.z);_=u.vertices.map(L=>new nr((L.x+b.x*ir)*I-T.x*ir,(L.y+b.y*ir)*I-T.y*ir))}return OF(h,_,u.indices,0,u.indices.length,0,0)}yS.VectorTileLayer=DF;class BF{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,h){const p=this.toIdx(s,h);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(s,h){return this.leaves[this.toIdx(s,h)]}toIdx(s,h){return h*this.size+s}}function FF(u,s,h,p){let _=0,b=Number.MAX_VALUE;for(let T=0;T<3;T++)if(Math.abs(p[T])<1e-15){if(h[T]<u[T]||h[T]>s[T])return null}else{const I=1/p[T];let L=(u[T]-h[T])*I,k=(s[T]-h[T])*I;if(L>k){const F=L;L=k,k=F}if(L>_&&(_=L),k<b&&(b=k),_>b)return null}return _}function NF(u,s,h,p,_,b,T,I,L,k,F){const N=p-u,U=_-s,Z=b-h,Q=T-u,ee=I-s,ie=L-h,oe=F[1]*ie-F[2]*ee,_e=F[2]*Q-F[0]*ie,Se=F[0]*ee-F[1]*Q,xe=N*oe+U*_e+Z*Se;if(Math.abs(xe)<1e-15)return null;const Re=1/xe,Te=k[0]-u,Be=k[1]-s,Ne=k[2]-h,Xe=(Te*oe+Be*_e+Ne*Se)*Re;if(Xe<0||Xe>1)return null;const ft=Be*Z-Ne*U,Je=Ne*N-Te*Z,yt=Te*U-Be*N,_t=(F[0]*ft+F[1]*Je+F[2]*yt)*Re;return _t<0||Xe+_t>1?null:(Q*ft+ee*Je+ie*yt)*Re}function VF(u,s,h){return(u-s)/(h-s)}function GF(u,s,h,p,_,b,T,I,L){const k=1<<h,F=b-p,N=T-_,U=(u+1)/k*F+p,Z=(s+0)/k*N+_,Q=(s+1)/k*N+_;I[0]=(u+0)/k*F+p,I[1]=Z,L[0]=U,L[1]=Q}class UF{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const h=function(b){const T=Math.ceil(Math.log2(b.dim/8)),I=[];let L=Math.ceil(Math.pow(2,T));const k=1/L,F=(Z,Q,ee,ie,oe)=>{const _e=ie?1:0,Se=(Z+1)*ee-_e,xe=Q*ee,Re=(Q+1)*ee-_e;oe[0]=Z*ee,oe[1]=xe,oe[2]=Se,oe[3]=Re};let N=new BF(L);const U=[];for(let Z=0;Z<L*L;Z++){F(Z%L,Math.floor(Z/L),k,!1,U);const Q=sf(U[0],U[1],b),ee=sf(U[2],U[1],b),ie=sf(U[2],U[3],b),oe=sf(U[0],U[3],b);N.minimums.push(Math.min(Q,ee,ie,oe)),N.maximums.push(Math.max(Q,ee,ie,oe)),N.leaves.push(1)}for(I.push(N),L/=2;L>=1;L/=2){const Z=I[I.length-1];N=new BF(L);for(let Q=0;Q<L*L;Q++){F(Q%L,Math.floor(Q/L),2,!0,U);const ee=Z.getElevation(U[0],U[1]),ie=Z.getElevation(U[2],U[1]),oe=Z.getElevation(U[2],U[3]),_e=Z.getElevation(U[0],U[3]),Se=Z.isLeaf(U[0],U[1]),xe=Z.isLeaf(U[2],U[1]),Re=Z.isLeaf(U[2],U[3]),Te=Z.isLeaf(U[0],U[3]),Be=Math.min(ee.min,ie.min,oe.min,_e.min),Ne=Math.max(ee.max,ie.max,oe.max,_e.max),Xe=Se&&xe&&Re&&Te;N.maximums.push(Ne),N.minimums.push(Be),N.leaves.push(Ne-Be<=5&&Xe?1:0)}I.push(N)}return I}(this.dem),p=h.length-1,_=h[p];this._addNode(_.minimums[0],_.maximums[0],_.leaves[0]),this._construct(h,0,0,p,0)}raycastRoot(s,h,p,_,b,T,I=1){return FF([s,h,-100],[p,_,this.maximums[0]*I],b,T)}raycast(s,h,p,_,b,T,I=1){if(!this.nodeCount)return null;const L=this.raycastRoot(s,h,p,_,b,T,I);if(L==null)return null;const k=[],F=[],N=[],U=[],Z=[{idx:0,t:L,nodex:0,nodey:0,depth:0}];for(;Z.length>0;){const{idx:Q,t:ee,nodex:ie,nodey:oe,depth:_e}=Z.pop();if(this.leaves[Q]){GF(ie,oe,_e,s,h,p,_,N,U);const xe=1<<_e,Re=(ie+0)/xe,Te=(ie+1)/xe,Be=(oe+0)/xe,Ne=(oe+1)/xe,Xe=sf(Re,Be,this.dem)*I,ft=sf(Te,Be,this.dem)*I,Je=sf(Te,Ne,this.dem)*I,yt=sf(Re,Ne,this.dem)*I,_t=NF(N[0],N[1],Xe,U[0],N[1],ft,U[0],U[1],Je,b,T),dt=NF(U[0],U[1],Je,N[0],U[1],yt,N[0],N[1],Xe,b,T),Pt=Math.min(_t!==null?_t:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(Pt!==Number.MAX_VALUE)return Pt;{const It=o.Q.scaleAndAdd([],b,T,ee);if($F(Xe,ft,yt,Je,VF(It[0],N[0],U[0]),VF(It[1],N[1],U[1]))>=It[2])return ee}continue}let Se=0;for(let xe=0;xe<this._siblingOffset.length;xe++){GF((ie<<1)+this._siblingOffset[xe][0],(oe<<1)+this._siblingOffset[xe][1],_e+1,s,h,p,_,N,U),N[2]=-100,U[2]=this.maximums[this.childOffsets[Q]+xe]*I;const Re=FF(N,U,b,T);if(Re!=null){const Te=Re;k[xe]=Te;let Be=!1;for(let Ne=0;Ne<Se&&!Be;Ne++)Te>=k[F[Ne]]&&(F.splice(Ne,0,xe),Be=!0);Be||(F[Se]=xe),Se++}}for(let xe=0;xe<Se;xe++){const Re=F[xe];Z.push({idx:this.childOffsets[Q]+Re,t:k[Re],nodex:(ie<<1)+this._siblingOffset[Re][0],nodey:(oe<<1)+this._siblingOffset[Re][1],depth:_e+1})}}return null}_addNode(s,h,p){return this.minimums.push(s),this.maximums.push(h),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(s,h,p,_,b){if(s[_].isLeaf(h,p)===1)return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const T=_-1,I=s[T];let L=0,k=0;for(let F=0;F<this._siblingOffset.length;F++){const N=2*h+this._siblingOffset[F][0],U=2*p+this._siblingOffset[F][1],Z=I.getElevation(N,U),Q=I.isLeaf(N,U),ee=this._addNode(Z.min,Z.max,Q);Q&&(L|=1<<F),k||(k=ee)}for(let F=0;F<this._siblingOffset.length;F++)L&1<<F||this._construct(s,2*h+this._siblingOffset[F][0],2*p+this._siblingOffset[F][1],T,k+F)}}function $F(u,s,h,p,_,b){return cn(cn(u,h,b),cn(s,p,b),_)}function sf(u,s,h){const p=h.dim,_=wn(u*p-.5,0,p-1),b=wn(s*p-.5,0,p-1),T=Math.floor(_),I=Math.floor(b),L=Math.min(T+1,p-1),k=Math.min(I+1,p-1);return $F(h.get(T,I),h.get(L,I),h.get(T,k),h.get(L,k),_-T,b-I)}const Rre={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function kre(u,s,h){return(256*u*256+256*s+h)/10-1e4}function Ore(u,s,h){return 256*u+s+h/256-32768}class SS{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,h,p,_=!1){if(this.uid=s,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return Gi(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=h.height;const b=this.dim=h.height-2,T=new Uint32Array(h.data.buffer);if(this.pixels=new Uint8Array(h.data.buffer),this.floatView=new Float32Array(h.data.buffer),this.borderReady=_,this._modifiedForSources={},!_){for(let L=0;L<b;L++)T[this._idx(-1,L)]=T[this._idx(0,L)],T[this._idx(b,L)]=T[this._idx(b-1,L)],T[this._idx(L,-1)]=T[this._idx(L,0)],T[this._idx(L,b)]=T[this._idx(L,b-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(b,-1)]=T[this._idx(b-1,0)],T[this._idx(-1,b)]=T[this._idx(0,b-1)],T[this._idx(b,b)]=T[this._idx(b-1,b-1)]}const I=p==="terrarium"?Ore:kre;for(let L=0;L<T.length;++L){const k=4*L;this.floatView[L]=I(this.pixels[k],this.pixels[k+1],this.pixels[k+2])}this._timestamp=nl.now()}_buildQuadTree(){this._tree=new UF(this)}get(s,h,p=!1){p&&(s=wn(s,-1,this.dim),h=wn(h,-1,this.dim));const _=this._idx(s,h);return this.floatView[_]}set(s,h,p){const _=this._idx(s,h),b=this.floatView[_];return this.floatView[_]=p,p-b}static getUnpackVector(s){return Rre[s]}_idx(s,h){if(s<-1||s>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(s+1)}static pack(s,h){const p=[0,0,0,0],_=SS.getUnpackVector(h);let b=Math.floor((s+_[3])/_[2]);return p[2]=b%256,b=Math.floor(b/256),p[1]=b%256,b=Math.floor(b/256),p[0]=b,p}getPixels(){return new TF({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,h,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let _=h*this.dim,b=h*this.dim+this.dim,T=p*this.dim,I=p*this.dim+this.dim;switch(h){case-1:_=b-1;break;case 1:b=_+1}switch(p){case-1:T=I-1;break;case 1:I=T+1}const L=-h*this.dim,k=-p*this.dim;for(let F=T;F<I;F++)for(let N=_;N<b;N++){const U=4*this._idx(N,F),Z=4*this._idx(N+L,F+k);this.pixels[U+0]=s.pixels[Z+0],this.pixels[U+1]=s.pixels[Z+1],this.pixels[U+2]=s.pixels[Z+2],this.pixels[U+3]=s.pixels[Z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}gr(SS,"DEMData"),gr(UF,"DemMinMaxQuadTree",{omit:["dem"]});class Tm{constructor(s,h,p){this._demTile=s,this._dem=this._demTile.dem,this._scale=h,this._offset=p}static create(s,h,p){const _=p||s.findDEMTileFor(h);if(!_||!_.dem)return;const b=_.dem,T=_.tileID,I=1<<h.canonical.z-T.canonical.z;return new Tm(_,b.dim/ir/I,[(h.canonical.x/I-T.canonical.x)*b.dim,(h.canonical.y/I-T.canonical.y)*b.dim])}tileCoordToPixel(s,h){const p=h*this._scale+this._offset[1],_=Math.floor(s*this._scale+this._offset[0]),b=Math.floor(p);return new nr(_,b)}getElevationAt(s,h,p,_){const b=s*this._scale+this._offset[0],T=h*this._scale+this._offset[1],I=Math.floor(b),L=Math.floor(T),k=this._dem;return _=!!_,p?cn(cn(k.get(I,L,_),k.get(I,L+1,_),T-L),cn(k.get(I+1,L,_),k.get(I+1,L+1,_),T-L),b-I):k.get(I,L,_)}getElevationAtPixel(s,h,p){return this._dem.get(s,h,!!p)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Po(1,s)*this._dem.stride}}const zre=xS.types,Bre=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],Fre=["fill-extrusion-flood-light-ground-radius"],Nre=Math.pow(2,13),Vre=Math.pow(2,15)-1,HF=new nr(0,1),lf=2147483648;function k0(u,s,h,p,_,b,T,I){u.emplaceBack((s<<1)+T,(h<<1)+b,(Math.floor(p*Nre)<<1)+_,Math.round(I))}function TS(u,s,h,p,_,b){u.emplaceBack(s.x,s.y,(h.x<<1)+p,(h.y<<1)+_,b)}function O0(u,s,h){u.emplaceBack(s.x,s.y,s.z,h[0]*16384,h[1]*16384,h[2]*16384)}class jF{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class WF{constructor(){this.centroidXY=new nr(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new nr(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new nr(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new nr(this.max.x-this.min.x,this.max.y-this.min.y)}}class ZF{constructor(){this.acc=new nr(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(s,h){s.min.x===Number.MAX_VALUE&&(s.min.x=s.max.x=h.x,s.min.y=s.max.y=h.y)}appendEdge(s,h,p){this.accCount++,this.acc._add(h);let _=!!this.borders;h.x<s.min.x?(s.min.x=h.x,_=!0):h.x>s.max.x&&(s.max.x=h.x,_=!0),h.y<s.min.y?(s.min.y=h.y,_=!0):h.y>s.max.y&&(s.max.y=h.y,_=!0),((h.x===0||h.x===ir)&&h.x===p.x)!=((h.y===0||h.y===ir)&&h.y===p.y)&&this.processBorderOverlap(h,p),_&&this.checkBorderIntersection(h,p)}checkBorderIntersection(s,h){h.x<0!=s.x<0&&this.addBorderIntersection(0,cn(h.y,s.y,(0-h.x)/(s.x-h.x))),h.x>ir!=s.x>ir&&this.addBorderIntersection(1,cn(h.y,s.y,(ir-h.x)/(s.x-h.x))),h.y<0!=s.y<0&&this.addBorderIntersection(2,cn(h.x,s.x,(0-h.y)/(s.y-h.y))),h.y>ir!=s.y>ir&&this.addBorderIntersection(3,cn(h.x,s.x,(ir-h.y)/(s.y-h.y)))}addBorderIntersection(s,h){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[s];h<p[0]&&(p[0]=h),h>p[1]&&(p[1]=h)}processBorderOverlap(s,h){if(s.x===h.x){if(s.y===h.y)return;const p=s.x===0?0:1;this.addBorderIntersection(p,h.y),this.addBorderIntersection(p,s.y)}else{const p=s.y===0?2:3;this.addBorderIntersection(p,h.x),this.addBorderIntersection(p,s.x)}}centroid(){return this.accCount===0?new nr(0,0):new nr(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((s,h)=>s+ +(h[0]!==Number.MAX_VALUE),0):0}}function qF(u,s){const h=u.add(s)._unit(),p=wn(u.x*h.x+u.y*h.y,-1,1);var _,b,T;return _=Math.acos(p),Math.min(4,Math.max(-4,Math.tan(_)))/4*Vre*((b=u).x*(T=s).y-b.y*T.x<0?-1:1)}const Gre=[u=>u.x<0,u=>u.x>ir,u=>u.y<0,u=>u.y>ir];function Ure(u,s,h,p){const _=[4];if(p===0)return _;h._mult(p);const b=u.sub(h),T=s.sub(h),I=[u,s,b,T];for(let L=0;L<4;L++)for(const k of I)if(Gre[L](k)){_.push(L);break}return _}class YF{constructor(s){this.vertexArray=new yo,this.indexArray=new ba,this.programConfigurations=new ef(s.layers,s.zoom,h=>Fre.includes(h)),this._segments=new ea,this.hiddenByLandmarkVertexArray=new _E,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ea}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(s,h,p,_=!1){const b=s.length;if(b>2){let T=Math.max(0,this._segments.get().length-1);const I=this._segments._prepareSegment(4*b,this.vertexArray.length,2*this._segmentToGroundQuads[T].length);let L;T!==this._segments.get().length-1&&(T++,this._segmentToGroundQuads[T]=[],this._segmentToRegionTriCounts[T]=[0,0,0,0,0]);{const k=s[0],F=s[1];L=qF(k.sub(s[b-1])._perp()._unit(),F.sub(k)._perp()._unit())}for(let k=0;k<b;k++){const F=k===b-1?0:k+1,N=s[k],U=s[F],Z=s[F===b-1?0:F+1],Q=U.sub(N)._perp()._unit(),ee=qF(Q,Z.sub(U)._perp()._unit()),ie=L,oe=ee;if(JE(N,U,h)||_&&KF(N,h)&&KF(U,h)){L=ee;continue}const _e=I.vertexLength;TS(this.vertexArray,N,U,1,1,ie),TS(this.vertexArray,N,U,1,0,ie),TS(this.vertexArray,N,U,0,1,oe),TS(this.vertexArray,N,U,0,0,oe),I.vertexLength+=4;const Se=Ure(N,U,Q,p);for(const xe of Se)this._segmentToGroundQuads[T].push({id:_e,region:xe}),this._segmentToRegionTriCounts[T][xe]+=2,I.primitiveLength+=2;L=ee}}}prepareBorderSegments(){if(!this.hasData())return;const s=this._segments.get(),h=s.length;for(let p=0;p<h;p++)this._segmentToGroundQuads[p].sort((_,b)=>_.region-b.region);for(let p=0;p<h;p++){const _=this._segmentToGroundQuads[p],b=s[p],T=this._segmentToRegionTriCounts[p];T.reduce((L,k)=>L+k,0);let I=0;for(let L=0;L<=4;L++){const k=T[L];if(k!==0){let F=this.regionSegments[L];F||(F=this.regionSegments[L]=new ea);const N={vertexOffset:b.vertexOffset,primitiveOffset:b.primitiveOffset+I,vertexLength:b.vertexLength,primitiveLength:k};F.get().push(N)}I+=k}for(let L=0;L<_.length;L++){const k=_[L].id;this.indexArray.emplaceBack(k,k+1,k+3),this.indexArray.emplaceBack(k,k+3,k+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(s,h,p,_,b,T){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,s,h,p,_,b,T)}upload(s){this.hasData()&&(this.vertexBuffer=s.createVertexBuffer(this.vertexArray,xre.members),this.indexBuffer=s.createIndexBuffer(this.indexArray))}uploadPaintProperties(s){this.hasData()&&this.programConfigurations.upload(s)}update(s,h,p,_,b,T){this.hasData()&&this.programConfigurations.updatePaintArrays(s,h,p,_,b,T)}updateHiddenByLandmark(s){if(!this.hasData())return;const h=s.groundVertexCount+s.groundVertexArrayOffset;if(s.groundVertexCount===0)return;const p=s.flags&lf?1:0;for(let _=s.groundVertexArrayOffset;_<h;++_)this.hiddenByLandmarkVertexArray.emplace(_,p);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(s){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=s.createVertexBuffer(this.hiddenByLandmarkVertexArray,wre.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let s=0;s<=4;s++){const h=this.regionSegments[s];h&&h.destroy()}}}}class AS{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.fqid),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ba,this.footprintVertices=new Wa,this.footprintSegments=[],this.layoutVertexArray=new Za,this.centroidVertexArray=new V5,this.indexArray=new ba,this.programConfigurations=new ef(s.layers,s.zoom,h=>Bre.includes(h)),this.segments=new ea,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.groundEffect=new YF(s),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(s,h,p,_){this.features=[],this.hasPattern=YE("fill-extrusion",this.layers,h),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=aS(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:b,id:T,index:I,sourceLayerIndex:L}of s){const k=this.layers[0]._featureFilter.needGeometry,F=nf(b,k);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),F,p))continue;const N={id:T,sourceLayerIndex:L,index:I,geometry:k?F.geometry:Gc(b,p,_),properties:b.properties,type:b.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(XE("fill-extrusion",this.layers,N,this.zoom,h)):this.addFeature(N,N.geometry,I,p,{},h.availableImages,_,h.brightness),h.featureIndex.insert(b,N.geometry,I,L,this.index,U)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(s,h,p,_,b,T){for(const I of this.features){const{geometry:L}=I;this.addFeature(I,L,I.index,h,p,_,b,T)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(s,h,p,_,b){const T=Object.keys(s).length!==0;if(T&&!this.stateDependentLayers.length)return;const I=T?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(s,h,I,p,_,b),this.groundEffect.update(s,h,I,p,_,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Tre),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,Sre.members,!0)),this.groundEffect.upload(s)),this.groundEffect.uploadPaintProperties(s),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.groundEffect.uploadHiddenByLandmark(s),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,bre.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,h,p,_,b,T,I,L){const k=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(s,{})/this.tileToMeter,F=[new nr(0,0),new nr(ir,ir)],N=I.projection,U=N.name==="globe",Z=zre[s.type]==="Polygon",Q=new ZF;Q.centroidDataIndex=this.centroidData.length;const ee=new WF,ie=this.layers[0].paint.get("fill-extrusion-base").evaluate(s,{},_)<=0,oe=this.layers[0].paint.get("fill-extrusion-height").evaluate(s,{},_);ee.height=oe,ee.vertexArrayOffset=this.layoutVertexArray.length,ee.groundVertexArrayOffset=this.groundEffect.vertexArray.length,U&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Vs);const _e=qE(h,500);for(let Ne=_e.length-1;Ne>=0;Ne--){const Xe=_e[Ne];(Xe.length===0||(Se=Xe[0]).every(ft=>ft.x<=0)||Se.every(ft=>ft.x>=ir)||Se.every(ft=>ft.y<=0)||Se.every(ft=>ft.y>=ir))&&_e.splice(Ne,1)}var Se;let xe;if(U)xe=rN(_e,F,_);else{xe=[];for(const Ne of _e)xe.push({polygon:Ne,bounds:F})}const Re=Z?this.edgeRadius:0,Te=Re>0&&this.zoom<17,Be=(Ne,Xe)=>{if(Ne.length===0)return!1;const ft=Ne[Ne.length-1];return Xe.x===ft.x&&Xe.y===ft.y};for(const{polygon:Ne,bounds:Xe}of xe){let ft=0,Je=0;for(const Pt of Ne)Z&&!Pt[0].equals(Pt[Pt.length-1])&&Pt.push(Pt[0]),Je+=Z?Pt.length-1:Pt.length;const yt=this.segments.prepareSegment((Z?5:4)*Je,this.layoutVertexArray,this.indexArray);ee.footprintSegIdx<0&&(ee.footprintSegIdx=this.footprintSegments.length),ee.polygonSegIdx<0&&(ee.polygonSegIdx=this.polygonSegments.length);const _t={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},dt=new jF;if(dt.vertexOffset=this.footprintVertices.length,dt.indexOffset=3*this.footprintIndices.length,dt.ringIndices=[],Z){const Pt=[],It=[];ft=yt.vertexLength;for(let Ot=0;Ot<Ne.length;Ot++){const xt=Ne[Ot];xt.length&&Ot!==0&&It.push(Pt.length/2);const mr=[];let fr,Gt;fr=xt[1].sub(xt[0])._perp()._unit(),dt.ringIndices.push(xt.length-1);for(let Rr=1;Rr<xt.length;Rr++){const Sr=xt[Rr],_r=xt[Rr===xt.length-1?1:Rr+1],$t=Sr.clone();if(Re){Gt=_r.sub(Sr)._perp()._unit();const Er=fr.add(Gt)._unit(),Jr=Re*Math.min(4,1/(fr.x*Er.x+fr.y*Er.y));$t.x+=Jr*Er.x,$t.y+=Jr*Er.y,$t.x=Math.round($t.x),$t.y=Math.round($t.y),fr=Gt}!ie||Re!==0&&!Te||Be(mr,$t)||mr.push($t),k0(this.layoutVertexArray,$t.x,$t.y,0,0,1,1,0),yt.vertexLength++,this.footprintVertices.emplaceBack(Sr.x,Sr.y),Pt.push(Sr.x,Sr.y),U&&O0(this.layoutVertexExtArray,N.projectTilePoint($t.x,$t.y,_),N.upVector(_,$t.x,$t.y))}ie&&(Re===0||Te)&&(mr.length!==0&&Be(mr,mr[0])&&mr.pop(),this.groundEffect.addData(mr,Xe,k))}const zt=_S(Pt,It);for(let Ot=0;Ot<zt.length;Ot+=3)this.footprintIndices.emplaceBack(dt.vertexOffset+zt[Ot+0],dt.vertexOffset+zt[Ot+1],dt.vertexOffset+zt[Ot+2]),this.indexArray.emplaceBack(ft+zt[Ot],ft+zt[Ot+2],ft+zt[Ot+1]),yt.primitiveLength++;dt.indexCount+=zt.length,dt.vertexCount+=this.footprintVertices.length-dt.vertexOffset}for(let Pt=0;Pt<Ne.length;Pt++){const It=Ne[Pt];Q.startRing(ee,It[0]);let zt=It.length>4&&JF(It[It.length-2],It[0],It[1]),Ot=Re?$re(It[It.length-2],It[0],It[1],Re):0;const xt=[];let mr,fr,Gt;fr=It[1].sub(It[0])._perp()._unit();let Rr=!0;for(let Sr=1,_r=0;Sr<It.length;Sr++){let $t=It[Sr-1],Er=It[Sr];const Jr=It[Sr===It.length-1?1:Sr+1];if(Q.appendEdge(ee,Er,$t),JE(Er,$t,Xe)){Re&&(fr=Jr.sub(Er)._perp()._unit(),Rr=!Rr);continue}const Br=Er.sub($t)._perp(),an=Br.x/(Math.abs(Br.x)+Math.abs(Br.y)),en=Br.y>0?1:0,mn=$t.dist(Er);if(_r+mn>32768&&(_r=0),Re){Gt=Jr.sub(Er)._perp()._unit();let Gn=QF($t,Er,Jr,XF(fr,Gt),Re);isNaN(Gn)&&(Gn=0);const Ln=Er.sub($t)._unit();$t=$t.add(Ln.mult(Ot))._round(),Er=Er.add(Ln.mult(-Gn))._round(),Ot=Gn,fr=Gt,ie&&this.zoom>=17&&(Be(xt,$t)||xt.push($t),Be(xt,Er)||xt.push(Er))}const Or=yt.vertexLength,ci=It.length>4&&JF($t,Er,Jr);let si=eN(_r,zt,Rr);if(k0(this.layoutVertexArray,$t.x,$t.y,an,en,0,0,si),k0(this.layoutVertexArray,$t.x,$t.y,an,en,0,1,si),_r+=mn,si=eN(_r,ci,!Rr),zt=ci,k0(this.layoutVertexArray,Er.x,Er.y,an,en,0,0,si),k0(this.layoutVertexArray,Er.x,Er.y,an,en,0,1,si),yt.vertexLength+=4,this.indexArray.emplaceBack(Or+0,Or+1,Or+2),this.indexArray.emplaceBack(Or+1,Or+3,Or+2),yt.primitiveLength+=2,Re){const Gn=ft+(Sr===1?It.length-2:Sr-2),Ln=Sr===1?ft:Gn+1;if(this.indexArray.emplaceBack(Or+1,Gn,Or+3),this.indexArray.emplaceBack(Gn,Ln,Or+3),yt.primitiveLength+=2,mr===void 0&&(mr=Or),!JE(Jr,It[Sr],Xe)){const Un=Sr===It.length-1?mr:yt.vertexLength;this.indexArray.emplaceBack(Or+2,Or+3,Un),this.indexArray.emplaceBack(Or+3,Un+1,Un),this.indexArray.emplaceBack(Or+3,Ln,Un+1),yt.primitiveLength+=3}Rr=!Rr}if(U){const Gn=this.layoutVertexExtArray,Ln=N.projectTilePoint($t.x,$t.y,_),Un=N.projectTilePoint(Er.x,Er.y,_),Ai=N.upVector(_,$t.x,$t.y),gi=N.upVector(_,Er.x,Er.y);O0(Gn,Ln,Ai),O0(Gn,Ln,Ai),O0(Gn,Un,gi),O0(Gn,Un,gi)}}Z&&(ft+=It.length-1),ie&&Re&&this.zoom>=17&&(xt.length!==0&&Be(xt,xt[0])&&xt.pop(),this.groundEffect.addData(xt,Xe,k,Re>0))}this.footprintSegments.push(dt),_t.triangleCount=this.indexArray.length-_t.triangleArrayOffset,this.polygonSegments.push(_t),++ee.footprintSegLen,++ee.polygonSegLen}if(ee.vertexCount=this.layoutVertexArray.length-ee.vertexArrayOffset,ee.groundVertexCount=this.groundEffect.vertexArray.length-ee.groundVertexArrayOffset,ee.vertexCount!==0){if(ee.centroidXY=Q.borders?HF:this.encodeCentroid(Q,ee),this.centroidData.push(ee),Q.borders){this.featuresOnBorder.push(Q);const Ne=this.featuresOnBorder.length-1;for(let Xe=0;Xe<Q.borders.length;Xe++)Q.borders[Xe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Xe].push(Ne)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,b,T,_,L),this.groundEffect.addPaintPropertiesData(s,p,b,T,_,L),this.maxHeight=Math.max(this.maxHeight,oe)}}sortBorders(){for(let s=0;s<this.borderFeatureIndices.length;s++)this.borderFeatureIndices[s].sort((h,p)=>this.featuresOnBorder[h].borders[s][0]-this.featuresOnBorder[p].borders[s][0])}splitToSubtiles(){const s=[];for(let I=0;I<this.centroidData.length;I++){const L=this.centroidData[I],k=+(L.min.y+L.max.y>ir),F=2*k+(+(L.min.x+L.max.x>ir)^k);for(let N=0;N<L.polygonSegLen;N++){const U=L.polygonSegIdx+N;s.push({centroidIdx:I,subtile:F,polygonSegmentIdx:U,triangleSegmentIdx:this.polygonSegments[U].triangleSegIdx})}}const h=new ba;s.sort((I,L)=>I.triangleSegmentIdx===L.triangleSegmentIdx?I.subtile-L.subtile:I.triangleSegmentIdx-L.triangleSegmentIdx);let p=0,_=0,b=0;for(const I of s){if(I.triangleSegmentIdx!==p)break;b++}const T=s.length;for(;_!==s.length;){p=s[_].triangleSegmentIdx;let I=0,L=_,k=_;for(let F=L;F<b&&s[F].subtile===I;F++)k++;for(;L!==b;){const F=s[L];I=F.subtile;const N=this.centroidData[F.centroidIdx].min.clone(),U=this.centroidData[F.centroidIdx].max.clone(),Z={vertexOffset:this.segments.segments[p].vertexOffset,primitiveOffset:h.length,vertexLength:this.segments.segments[p].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Q=L;Q<k;Q++){const ee=s[Q],ie=this.polygonSegments[ee.polygonSegmentIdx],oe=this.centroidData[ee.centroidIdx].min,_e=this.centroidData[ee.centroidIdx].max,Se=this.indexArray.uint16;for(let xe=ie.triangleArrayOffset;xe<ie.triangleArrayOffset+ie.triangleCount;xe++)h.emplaceBack(Se[3*xe],Se[3*xe+1],Se[3*xe+2]);Z.primitiveLength+=ie.triangleCount,N.x=Math.min(N.x,oe.x),N.y=Math.min(N.y,oe.y),U.x=Math.max(U.x,_e.x),U.y=Math.max(U.y,_e.y)}Z.primitiveLength>0&&this.triangleSubSegments.push({segment:Z,min:N,max:U}),L=k;for(let Q=L;Q<b&&s[Q].subtile===s[L].subtile;Q++)k++}_=b;for(let F=_;F<T&&s[F].triangleSegmentIdx===s[_].triangleSegmentIdx;F++)b++}h._trim(),this.indexArray=h}getVisibleSegments(s,h,p){let _=0,b=0;const T=1<<s.canonical.z;if(h){const ee=h.getMinMaxForTile(s);ee&&(_=ee.min,b=ee.max)}b+=this.maxHeight;const I=s.toUnwrapped();let L;const k=[I.canonical.x/T+I.wrap,I.canonical.y/T],F=[(I.canonical.x+1)/T+I.wrap,(I.canonical.y+1)/T],N=new ea,U=(ee,ie,oe)=>[ee[0]*(1-oe[0])+ie[0]*oe[0],ee[1]*(1-oe[1])+ie[1]*oe[1]],Z=[],Q=[];for(const ee of this.triangleSubSegments){Z[0]=ee.min.x/ir,Z[1]=ee.min.y/ir,Q[0]=ee.max.x/ir,Q[1]=ee.max.y/ir;const ie=U(k,F,Z),oe=U(k,F,Q);if(new Li([ie[0],ie[1],_],[oe[0],oe[1],b]).intersectsPrecise(p)===0){L&&(N.segments.push(L),L=void 0);continue}const _e=ee.segment;L&&L.vertexOffset!==_e.vertexOffset&&(N.segments.push(L),L=void 0),L?(L.vertexLength+=_e.vertexLength,L.primitiveLength+=_e.primitiveLength):L={vertexOffset:_e.vertexOffset,primitiveLength:_e.primitiveLength,vertexLength:_e.vertexLength,primitiveOffset:_e.primitiveOffset,sortKey:void 0,vaos:{}}}return L&&N.segments.push(L),N}encodeCentroid(s,h){const p=s.centroid(),_=h.span(),b=Math.min(7,Math.round(_.x*this.tileToMeter/10)),T=Math.min(7,Math.round(_.y*this.tileToMeter/10));return new nr(wn(p.x,1,ir-1)<<3|b,wn(p.y,1,ir-1)<<3|T)}encodeBorderCentroid(s){if(!s.borders)return new nr(0,0);const h=s.borders,p=Number.MAX_VALUE;if(h[0][0]!==p||h[1][0]!==p){const _=h[0][0]!==p?0:1;return new nr(6|(h[0][0]!==p?0:65528),(h[_][0]+h[_][1])/2<<3|6)}{const _=h[2][0]!==p?2:3;return new nr((h[_][0]+h[_][1])/2<<3|6,6|(h[2][0]!==p?0:65528))}}showCentroid(s){const h=this.centroidData[s.centroidDataIndex];h.flags&=lf,h.centroidXY.x=0,h.centroidXY.y=0,this.writeCentroidToBuffer(h)}writeCentroidToBuffer(s){this.groundEffect.updateHiddenByLandmark(s);const h=s.vertexArrayOffset,p=s.vertexCount+s.vertexArrayOffset,_=s.flags&lf?HF:s.centroidXY,b=this.centroidVertexArray.geta_centroid_pos0(h);if(this.centroidVertexArray.geta_centroid_pos1(h)!==_.y||b!==_.x){for(let T=h;T<p;++T)this.centroidVertexArray.emplace(T,_.x,_.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const s of this.centroidData)this.writeCentroidToBuffer(s)}updateReplacement(s,h){if(h.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=h.updateTime;const p=h.getReplacementRegionsForTile(s.toUnwrapped());if(function(b,T){if(b.length!==T.length)return!1;for(let I=0;I<b.length;I++)if(b[I].sourceId!==T[I].sourceId||!LF(b[I],T[I]))return!1;return!0}(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const b of this.centroidData)b.flags&=2147483647;const _=[];for(const b of this.activeReplacements){const T=Math.pow(2,b.footprintTileId.canonical.z-s.canonical.z);for(const I of this.centroidData)if(!(I.flags&lf||b.min.x>I.max.x||I.min.x>b.max.x||b.min.y>I.max.y||I.min.y>b.max.y))for(let L=0;L<I.footprintSegLen;L++){const k=this.footprintSegments[I.footprintSegIdx+L];if(_.length=0,Hre(this.footprintVertices,k.vertexOffset,k.vertexCount,b.footprintTileId.canonical,s.canonical,_),OF(b.footprint,_,this.footprintIndices.uint16,k.indexOffset,k.indexCount,-k.vertexOffset,-T)){I.flags|=lf;break}}}for(const b of this.centroidData)this.writeCentroidToBuffer(b);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(s,h,p){let _=!1;for(let b=0;b<p.footprintSegLen;b++){const T=this.footprintSegments[p.footprintSegIdx+b];let I=0;for(const L of T.ringIndices){for(let k=I,F=L+I-1;k<L+I;F=k++){const N=this.footprintVertices.int16[2*(k+T.vertexOffset)+0],U=this.footprintVertices.int16[2*(k+T.vertexOffset)+1],Z=this.footprintVertices.int16[2*(F+T.vertexOffset)+1];U>h!=Z>h&&s<(this.footprintVertices.int16[2*(F+T.vertexOffset)+0]-N)*(h-U)/(Z-U)+N&&(_=!_)}I=L}}return _}getHeightAtTileCoord(s,h){let p=Number.NEGATIVE_INFINITY,_=!0;const b=4*(s+ir)*ir+(h+ir);if(this.partLookup.hasOwnProperty(b)){const T=this.partLookup[b];return T?{height:T.height,hidden:!!(T.flags&lf)}:void 0}for(const T of this.centroidData)s>T.max.x||T.min.x>s||h>T.max.y||T.min.y>h||this.footprintContainsPoint(s,h,T)&&T&&T.height>p&&(p=T.height,this.partLookup[b]=T,_=!!(T.flags&lf));if(p!==Number.NEGATIVE_INFINITY)return{height:p,hidden:_};this.partLookup[b]=void 0}}function XF(u,s){const h=u.add(s)._unit();return u.x*h.x+u.y*h.y}function $re(u,s,h,p){const _=s.sub(u)._perp()._unit(),b=h.sub(s)._perp()._unit();return QF(u,s,h,XF(_,b),p)}function QF(u,s,h,p,_){const b=Math.sqrt(1-p*p);return Math.min(u.dist(s)/3,s.dist(h)/3,_*b/p)}function JE(u,s,h){return u.x<h[0].x&&s.x<h[0].x||u.x>h[1].x&&s.x>h[1].x||u.y<h[0].y&&s.y<h[0].y||u.y>h[1].y&&s.y>h[1].y}function KF(u,s){return u.x<s[0].x||u.x>s[1].x||u.y<s[0].y||u.y>s[1].y}function JF(u,s,h){if(u.x<0||u.x>=ir||s.x<0||s.x>=ir||h.x<0||h.x>=ir)return!1;const p=h.sub(s),_=p.perp(),b=u.sub(s);return(p.x*b.x+p.y*b.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(b.x*b.x+b.y*b.y))>-.866&&_.x*b.x+_.y*b.y<0}function eN(u,s,h){const p=s?2|u:-3&u;return h?1|p:-2&p}function tN(){const u=Math.PI/32,s=Math.tan(u),h=ym;return h*Math.sqrt(1+2*s*s)-h}function rN(u,s,h){const p=1<<h.z,_=fs(h.x/p),b=fs((h.x+1)/p),T=qa(h.y/p),I=qa((h.y+1)/p);return function(L,k,F,N,U=0,Z){const Q=[];if(!L.length||!F||!N)return Q;const ee=(Te,Be)=>{for(const Ne of Te)Q.push({polygon:Ne,bounds:Be})},ie=Math.ceil(Math.log2(F)),oe=Math.ceil(Math.log2(N)),_e=ie-oe,Se=[];for(let Te=0;Te<Math.abs(_e);Te++)Se.push(_e>0?0:1);for(let Te=0;Te<Math.min(ie,oe);Te++)Se.push(0),Se.push(1);let xe=L;if(xe=bS(xe,k[0].y-U,k[1].y+U,1),xe=bS(xe,k[0].x-U,k[1].x+U,0),!xe.length)return Q;const Re=[];for(Se.length?Re.push({polygons:xe,bounds:k,depth:0}):ee(xe,k);Re.length;){const Te=Re.pop(),Be=Te.depth,Ne=Se[Be],Xe=Te.bounds[0],ft=Te.bounds[1],Je=Ne===0?Xe.x:Xe.y,yt=Ne===0?ft.x:ft.y,_t=Z?Z(Ne,Je,yt):.5*(Je+yt),dt=bS(Te.polygons,Je-U,_t+U,Ne),Pt=bS(Te.polygons,_t-U,yt+U,Ne);if(dt.length){const It=[Xe,new nr(Ne===0?_t:ft.x,Ne===1?_t:ft.y)];Se.length>Be+1?Re.push({polygons:dt,bounds:It,depth:Be+1}):ee(dt,It)}if(Pt.length){const It=[new nr(Ne===0?_t:Xe.x,Ne===1?_t:Xe.y),ft];Se.length>Be+1?Re.push({polygons:Pt,bounds:It,depth:Be+1}):ee(Pt,It)}}return Q}(u,s,Math.ceil((b-_)/11.25),Math.ceil((T-I)/11.25),1,(L,k,F)=>{if(L===0)return .5*(k+F);{const N=qa((h.y+k/ir)/p);return(Vc(.5*(qa((h.y+F/ir)/p)+N))*p-h.y)*ir}})}function Hre(u,s,h,p,_,b){const T=Math.pow(2,p.z-_.z);for(let I=0;I<h;I++){let L=u.int16[2*(I+s)+0],k=u.int16[2*(I+s)+1];L=(L+_.x*ir)*T-p.x*ir,k=(k+_.y*ir)*T-p.y*ir,b.push(new nr(L,k))}}gr(AS,"FillExtrusionBucket",{omit:["layers","features"]}),gr(WF,"PartData"),gr(jF,"FootprintSegment"),gr(ZF,"BorderCentroidData"),gr(YF,"GroundEffect");const jre=new Ze({visibility:new Ve(Me["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ve(Me["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Wre={paint:new Ze({"fill-extrusion-opacity":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qe(Me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qe(Me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qe(Me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qe(Me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Qe(Me["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Qe(Me["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ve(Me["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:jre};class Am extends nr{constructor(s,h,p){super(s,h),this.z=p}}function z0(u,s){return u.x*s.x+u.y*s.y}function nN(u,s){if(u.length===1){let h=0;const p=s[h++];let _;for(;!_||p.equals(_);)if(_=s[h++],!_)return 1/0;for(;h<s.length;h++){const b=s[h],T=u[0],I=_.sub(p),L=b.sub(p),k=T.sub(p),F=z0(I,I),N=z0(I,L),U=z0(L,L),Z=z0(k,I),Q=z0(k,L),ee=F*U-N*N,ie=(U*Z-N*Q)/ee,oe=(F*Q-N*Z)/ee,_e=p.z*(1-ie-oe)+_.z*ie+b.z*oe;if(isFinite(_e))return _e}return 1/0}{let h=1/0;for(const p of s)h=Math.min(h,p.z);return h}}function iN(u,s,h,p,_,b,T,I){const L=T*_.getElevationAt(u,s,!0,!0),k=b[0]!==0,F=k?b[1]===0?T*(b[0]/7-450):T*function(N,U,Z){const Q=Math.floor(U[0]/8),ee=Math.floor(U[1]/8),ie=10*(U[0]-8*Q),oe=10*(U[1]-8*ee),_e=N.getElevationAt(Q,ee,!0,!0),Se=N.getMeterToDEM(Z),xe=Math.floor(.5*(ie*Se-1)),Re=Math.floor(.5*(oe*Se-1)),Te=N.tileCoordToPixel(Q,ee),Be=2*xe+1,Ne=2*Re+1,Xe=function(Pt,It,zt,Ot,xt){return[Pt.getElevationAtPixel(It,zt,!0),Pt.getElevationAtPixel(It+xt,zt,!0),Pt.getElevationAtPixel(It,zt+xt,!0),Pt.getElevationAtPixel(It+Ot,zt+xt,!0)]}(N,Te.x-xe,Te.y-Re,Be,Ne),ft=Math.abs(Xe[0]-Xe[1]),Je=Math.abs(Xe[2]-Xe[3]),yt=Math.abs(Xe[0]-Xe[2])+Math.abs(Xe[1]-Xe[3]),_t=Math.min(.25,.5*Se*(ft+Je)/Be),dt=Math.min(.25,.5*Se*yt/Ne);return _e+Math.max(_t*ie,dt*oe)}(_,b,I):L;return{base:L+(h===0)?-1:h,top:k?Math.max(F+p,L+h+2):L+p}}const Zre=Kr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:qre}=Zre,Yre=Kr([{name:"a_packed",components:4,type:"Float32"}]),{members:Xre}=Yre,Qre=Kr([{name:"a_pattern_data",components:2,type:"Float32"}]),{members:Kre}=Qre;class aN{constructor(s,h){this.width=s,this.height=h,this.nextRow=0,this.image=new of({width:s,height:h}),this.positions={},this.uploaded=!1}getDash(s,h){const p=this.getKey(s,h);return this.positions[p]}trim(){const s=this.width,h=this.height=Dy(this.nextRow);this.image.resize({width:s,height:h})}getKey(s,h){return s.join(",")+h}getDashRanges(s,h,p){const _=[];let b=s.length%2==1?-s[s.length-1]*p:0,T=s[0]*p,I=!0;_.push({left:b,right:T,isDash:I,zeroLength:s[0]===0});let L=s[0];for(let k=1;k<s.length;k++){I=!I;const F=s[k];b=L*p,L+=F,T=L*p,_.push({left:b,right:T,isDash:I,zeroLength:F===0})}return _}addRoundDash(s,h,p){const _=h/2;for(let b=-p;b<=p;b++){const T=this.width*(this.nextRow+p+b);let I=0,L=s[I];for(let k=0;k<this.width;k++){k/L.right>1&&(L=s[++I]);const F=Math.abs(k-L.left),N=Math.abs(k-L.right),U=Math.min(F,N);let Z;const Q=b/p*(_+1);if(L.isDash){const ee=_-Math.abs(Q);Z=Math.sqrt(U*U+ee*ee)}else Z=_-Math.sqrt(U*U+Q*Q);this.image.data[T+k]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(s,h){for(let L=s.length-1;L>=0;--L){const k=s[L],F=s[L+1];k.zeroLength?s.splice(L,1):F&&F.isDash===k.isDash&&(F.left=k.left,s.splice(L,1))}const p=s[0],_=s[s.length-1];p.isDash===_.isDash&&(p.left=_.left-this.width,_.right=p.right+this.width);const b=this.width*this.nextRow;let T=0,I=s[T];for(let L=0;L<this.width;L++){L/I.right>1&&(I=s[++T]);const k=Math.abs(L-I.left),F=Math.abs(L-I.right),N=Math.min(k,F);this.image.data[b+L]=Math.max(0,Math.min(255,(I.isDash?N:-N)+h+128))}}addDash(s,h){const p=this.getKey(s,h);if(this.positions[p])return this.positions[p];const _=h==="round",b=_?7:0,T=2*b+1;if(this.nextRow+T>this.height)return Gi("LineAtlas out of space"),null;s.length===0&&s.push(1);let I=0;for(let F=0;F<s.length;F++)s[F]<0&&(Gi("Negative value is found in line dasharray, replacing values with 0"),s[F]=0),I+=s[F];if(I!==0){const F=this.width/I,N=this.getDashRanges(s,this.width,F);_?this.addRoundDash(N,F,b):this.addRegularDash(N,h==="square"?.5*F:0)}const L=this.nextRow+b;this.nextRow+=T;const k={tl:[L,b],br:[I,0]};return this.positions[p]=k,k}}gr(aN,"LineAtlas");const Jre=xS.types,ene=Math.cos(Math.PI/180*37.5),tne=Math.cos(Math.PI/180*5);class eD{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.fqid),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new io,this.layoutVertexArray2=new xa,this.patternVertexArray=new Pa,this.indexArray=new ba,this.programConfigurations=new ef(s.layers,s.zoom),this.segments=new ea,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,p,_){this.hasPattern=YE("line",this.layers,h);const b=this.layers[0].layout.get("line-sort-key"),T=[];for(const{feature:F,id:N,index:U,sourceLayerIndex:Z}of s){const Q=this.layers[0]._featureFilter.needGeometry,ee=nf(F,Q);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),ee,p))continue;const ie=b?b.evaluate(ee,{},p):void 0,oe={id:N,properties:F.properties,type:F.type,sourceLayerIndex:Z,index:U,geometry:Q?ee.geometry:Gc(F,p,_),patterns:{},sortKey:ie};T.push(oe)}b&&T.sort((F,N)=>F.sortKey-N.sortKey);const{lineAtlas:I,featureIndex:L}=h,k=this.addConstantDashes(I);for(const F of T){const{geometry:N,index:U,sourceLayerIndex:Z}=F;if(k&&this.addFeatureDashes(F,I),this.hasPattern){const Q=XE("line",this.layers,F,this.zoom,h);this.patternFeatures.push(Q)}else this.addFeature(F,N,U,p,I.positions,h.availableImages,h.brightness);L.insert(s[U].feature,N,U,Z,this.index)}}addConstantDashes(s){let h=!1;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if(_.kind!=="constant"||b.kind!=="constant")h=!0;else{const T=b.value,I=_.value;if(!I)continue;s.addDash(I,T)}}return h}addFeatureDashes(s,h){const p=this.zoom;for(const _ of this.layers){const b=_.paint.get("line-dasharray").value,T=_.layout.get("line-cap").value;if(b.kind==="constant"&&T.kind==="constant")continue;let I,L;if(b.kind==="constant"){if(I=b.value,!I)continue}else I=b.evaluate({zoom:p},s);L=T.kind==="constant"?T.value:T.evaluate({zoom:p},s),h.addDash(I,L),s.patterns[_.id]=h.getKey(I,L)}}update(s,h,p,_,b){const T=Object.keys(s).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(s,h,T?this.stateDependentLayers:this.layers,p,_,b)}addFeatures(s,h,p,_,b,T){for(const I of this.patternFeatures)this.addFeature(I,I.geometry,I.index,h,p,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Xre)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=s.createVertexBuffer(this.patternVertexArray,Kre)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,qre),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,h,p,_,b,T,I){const L=this.layers[0].layout,k=L.get("line-join").evaluate(s,{}),F=L.get("line-cap").evaluate(s,{}),N=L.get("line-miter-limit"),U=L.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const Z of h)this.addLine(Z,s,k,F,N,U);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,b,T,_,I)}addLine(s,h,p,_,b,T){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0;const I=p==="none";if(this.patternJoinNone=this.hasPattern&&I,this.segmentStart=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<s.length-1;_e++)this.totalDistance+=s[_e].dist(s[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=Jre[h.type]==="Polygon";let k=s.length;for(;k>=2&&s[k-1].equals(s[k-2]);)k--;let F=0;for(;F<k-1&&s[F].equals(s[F+1]);)F++;if(k<(L?3:2))return;p==="bevel"&&(b=1.05);const N=this.overscaling<=16?15*ir/(512*this.overscaling):0,U=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let Z,Q,ee,ie,oe;this.e1=this.e2=-1,L&&(Z=s[k-2],oe=s[F].sub(Z)._unit()._perp());for(let _e=F;_e<k;_e++){if(ee=_e===k-1?L?s[F+1]:void 0:s[_e+1],ee&&s[_e].equals(ee))continue;oe&&(ie=oe),Z&&(Q=Z),Z=s[_e],oe=ee?ee.sub(Z)._unit()._perp():ie,ie=ie||oe;const Se=Q&&ee;let xe=Se?p:L||I?"butt":_;const Re=ie.x*oe.x+ie.y*oe.y;if(I){const yt=function(_t){if(_t.patternJoinNone){const dt=_t.segmentPoints.length/2,Pt=_t.lineSoFar-_t.segmentStart;for(let It=0;It<dt;++It){const zt=_t.segmentPoints[2*It+1],Ot=Math.round(_t.segmentPoints[2*It])+.5+.25*zt;_t.patternVertexArray.emplaceBack(Ot,Pt),_t.patternVertexArray.emplaceBack(Ot,Pt)}_t.segmentPoints=[],_t.segmentStart=_t.lineSoFar}_t.e1=_t.e2=-1};if(Se&&Re<tne){this.updateDistance(Q,Z),this.addCurrentVertex(Z,ie,1,1,U),yt(this),this.addCurrentVertex(Z,oe,-1,-1,U);continue}if(Q){if(!ee){this.updateDistance(Q,Z),this.addCurrentVertex(Z,ie,1,1,U),yt(this);continue}xe="miter"}}let Te=ie.add(oe);Te.x===0&&Te.y===0||Te._unit();const Be=Te.x*oe.x+Te.y*oe.y,Ne=Be!==0?1/Be:1/0,Xe=2*Math.sqrt(2-2*Be),ft=Be<ene&&Q&&ee,Je=ie.x*oe.y-ie.y*oe.x>0;if(ft&&_e>F){const yt=Z.dist(Q);if(yt>2*N){const _t=Z.sub(Z.sub(Q)._mult(N/yt)._round());this.updateDistance(Q,_t),this.addCurrentVertex(_t,ie,0,0,U),Q=_t}}if(Se&&xe==="round"&&(Ne<T?xe="miter":Ne<=2&&(xe="fakeround")),xe==="miter"&&Ne>b&&(xe="bevel"),xe==="bevel"&&(Ne>2&&(xe="flipbevel"),Ne<b&&(xe="miter")),Q&&this.updateDistance(Q,Z),xe==="miter")Te._mult(Ne),this.addCurrentVertex(Z,Te,0,0,U);else if(xe==="flipbevel"){if(Ne>100)Te=oe.mult(-1);else{const yt=Ne*ie.add(oe).mag()/ie.sub(oe).mag();Te._perp()._mult(yt*(Je?-1:1))}this.addCurrentVertex(Z,Te,0,0,U),this.addCurrentVertex(Z,Te.mult(-1),0,0,U)}else if(xe==="bevel"||xe==="fakeround"){const yt=-Math.sqrt(Ne*Ne-1),_t=Je?yt:0,dt=Je?0:yt;if(Q&&this.addCurrentVertex(Z,ie,_t,dt,U),xe==="fakeround"){const Pt=Math.round(180*Xe/Math.PI/20);for(let It=1;It<Pt;It++){let zt=It/Pt;if(zt!==.5){const xt=zt-.5;zt+=zt*xt*(zt-1)*((1.0904+Re*(Re*(3.55645-1.43519*Re)-3.2452))*xt*xt+(.848013+Re*(.215638*Re-1.06021)))}const Ot=oe.sub(ie)._mult(zt)._add(ie)._unit()._mult(Je?-1:1);this.addHalfVertex(Z,Ot.x,Ot.y,!1,Je,0,U)}}ee&&this.addCurrentVertex(Z,oe,-_t,-dt,U)}else xe==="butt"?this.addCurrentVertex(Z,Te,0,0,U):xe==="square"?(Q||this.addCurrentVertex(Z,Te,-1,-1,U),this.addCurrentVertex(Z,Te,0,0,U),Q&&this.addCurrentVertex(Z,Te,1,1,U)):xe==="round"&&(Q&&(this.addCurrentVertex(Z,ie,0,0,U),this.addCurrentVertex(Z,ie,1,1,U,!0)),ee&&(this.addCurrentVertex(Z,oe,-1,-1,U,!0),this.addCurrentVertex(Z,oe,0,0,U)));if(ft&&_e<k-1){const yt=Z.dist(ee);if(yt>2*N){const _t=Z.add(ee.sub(Z)._mult(N/yt)._round());this.updateDistance(Z,_t),this.addCurrentVertex(_t,oe,0,0,U),Z=_t}}}}addCurrentVertex(s,h,p,_,b,T=!1){const I=h.y*_-h.x,L=-h.y-h.x*_;this.addHalfVertex(s,h.x+h.y*p,h.y-h.x*p,T,!1,p,b),this.addHalfVertex(s,I,L,T,!0,-_,b),this.patternJoinNone&&this.segmentPoints.push(this.lineSoFar-this.segmentStart,p)}addHalfVertex({x:s,y:h},p,_,b,T,I,L){this.layoutVertexArray.emplaceBack((s<<1)+(b?1:0),(h<<1)+(T?1:0),Math.round(63*p)+128,Math.round(63*_)+128,1+(I===0?0:I<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=L.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),L.primitiveLength++),T?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,h){this.distance+=s.dist(h),this.updateScaledDistance()}}gr(eD,"LineBucket",{omit:["layers","patternFeatures"]});const rne=new Ze({"line-cap":new Qe(Me.layout_line["line-cap"]),"line-join":new Qe(Me.layout_line["line-join"]),"line-miter-limit":new Ve(Me.layout_line["line-miter-limit"]),"line-round-limit":new Ve(Me.layout_line["line-round-limit"]),"line-sort-key":new Qe(Me.layout_line["line-sort-key"]),visibility:new Ve(Me.layout_line.visibility)});var oN={paint:new Ze({"line-opacity":new Qe(Me.paint_line["line-opacity"]),"line-color":new Qe(Me.paint_line["line-color"]),"line-translate":new Ve(Me.paint_line["line-translate"]),"line-translate-anchor":new Ve(Me.paint_line["line-translate-anchor"]),"line-width":new Qe(Me.paint_line["line-width"]),"line-gap-width":new Qe(Me.paint_line["line-gap-width"]),"line-offset":new Qe(Me.paint_line["line-offset"]),"line-blur":new Qe(Me.paint_line["line-blur"]),"line-dasharray":new Qe(Me.paint_line["line-dasharray"]),"line-pattern":new Qe(Me.paint_line["line-pattern"]),"line-gradient":new kt(Me.paint_line["line-gradient"]),"line-trim-offset":new Ve(Me.paint_line["line-trim-offset"]),"line-emissive-strength":new Ve(Me.paint_line["line-emissive-strength"]),"line-border-width":new Qe(Me.paint_line["line-border-width"]),"line-border-color":new Qe(Me.paint_line["line-border-color"])}),layout:rne};function sN(u,s,h){return s*(ir/(u.tileSize*Math.pow(2,h-u.tileID.overscaledZ)))}function lN(u,s){return 1/sN(u,1,s.tileZoom)}function uN(u,s,h,p){return u.translatePosMatrix(p||s.tileID.projMatrix,s,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const cN=u=>{const s=[];hN(u)&&s.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&s.push("RENDER_LINE_GRADIENT");const h=u.paint.get("line-trim-offset");h[0]===0&&h[1]===0||s.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&s.push("RENDER_LINE_BORDER");const p=u.layout.get("line-join").constantOr("miter")==="none",_=!!u.paint.get("line-pattern").constantOr(1);return p&&_&&s.push("LINE_JOIN_NONE"),s};function hN(u){const s=u.paint.get("line-dasharray").value;return s.value||s.kind!=="constant"}const fN=new class extends Qe{possiblyEvaluate(u,s){return s=new he(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(u,s)}evaluate(u,s,h,p){return s=us({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(u,s,h,p)}}(oN.paint.properties["line-width"].specification);function dN(u,s){return s>0?s+2*u:u}fN.useIntegerZoom=!0;const nne=Kr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ine=Kr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),ane=Kr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Kr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const one=Kr([{name:"a_z_offset",components:1,type:"Float32"}],4),sne=Kr([{name:"a_texb",components:2,type:"Uint16"}]),lne=Kr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),une=Kr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Kr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const pN=Kr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cne=Kr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Kr([{name:"triangle",components:3,type:"Uint16"}]),Kr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Kr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Kr([{type:"Float32",name:"offsetX"}]),Kr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ya=24;const Ql=128;function tD(u,s){const{expression:h}=s;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new he(u+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:_}=h;let b=0;for(;b<p.length&&p[b]<=u;)b++;b=Math.max(0,b-1);let T=b;for(;T<p.length&&p[T]<u+1;)T++;T=Math.min(p.length-1,T);const I=p[b],L=p[T];return h.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:L,interpolationType:_}:{kind:"camera",minZoom:I,maxZoom:L,minSize:h.evaluate(new he(I)),maxSize:h.evaluate(new he(L)),interpolationType:_}}}function CS(u,{uSize:s,uSizeT:h},{lowerSize:p,upperSize:_}){return u.kind==="source"?p/Ql:u.kind==="composite"?cn(p/Ql,_/Ql,h):s}function Cm(u,s){let h=0,p=0;if(u.kind==="constant")p=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:_,minZoom:b,maxZoom:T}=u,I=_?wn(Zo.interpolationFactor(_,s,b,T),0,1):0;u.kind==="camera"?p=cn(u.minSize,u.maxSize,I):h=I}return{uSizeT:h,uSize:p}}var hne=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ql,evaluateSizeForFeature:CS,evaluateSizeForZoom:Cm,getSizeData:tD});function fne(u,s,h){return u.sections.forEach(p=>{p.text=function(_,b,T){const I=b.layout.get("text-transform").evaluate(T,{});return I==="uppercase"?_=_.toLocaleUpperCase():I==="lowercase"&&(_=_.toLocaleLowerCase()),De.applyArabicShaping&&(_=De.applyArabicShaping(_)),_}(p.text,s,h)}),u}const B0={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function dne(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function pne(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}var gne={read:function(u,s,h,p,_){var b,T,I=8*_-p-1,L=(1<<I)-1,k=L>>1,F=-7,N=h?_-1:0,U=h?-1:1,Z=u[s+N];for(N+=U,b=Z&(1<<-F)-1,Z>>=-F,F+=I;F>0;b=256*b+u[s+N],N+=U,F-=8);for(T=b&(1<<-F)-1,b>>=-F,F+=p;F>0;T=256*T+u[s+N],N+=U,F-=8);if(b===0)b=1-k;else{if(b===L)return T?NaN:1/0*(Z?-1:1);T+=Math.pow(2,p),b-=k}return(Z?-1:1)*T*Math.pow(2,b-p)},write:function(u,s,h,p,_,b){var T,I,L,k=8*b-_-1,F=(1<<k)-1,N=F>>1,U=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=p?0:b-1,Q=p?1:-1,ee=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(I=isNaN(s)?1:0,T=F):(T=Math.floor(Math.log(s)/Math.LN2),s*(L=Math.pow(2,-T))<1&&(T--,L*=2),(s+=T+N>=1?U/L:U*Math.pow(2,1-N))*L>=2&&(T++,L/=2),T+N>=F?(I=0,T=F):T+N>=1?(I=(s*L-1)*Math.pow(2,_),T+=N):(I=s*Math.pow(2,N-1)*Math.pow(2,_),T=0));_>=8;u[h+Z]=255&I,Z+=Q,I/=256,_-=8);for(T=T<<_|I,k+=_;k>0;u[h+Z]=255&T,Z+=Q,T/=256,k-=8);u[h+Z-Q]|=128*ee}},gN=Ri,MS=gne;function Ri(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Ri.Varint=0,Ri.Fixed64=1,Ri.Bytes=2,Ri.Fixed32=5;var rD=4294967296,vN=1/rD,mN=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $c(u){return u.type===Ri.Bytes?u.readVarint()+u.pos:u.pos+1}function Mm(u,s,h){return h?4294967296*s+(u>>>0):4294967296*(s>>>0)+(u>>>0)}function _N(u,s,h){var p=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));h.realloc(p);for(var _=h.pos-1;_>=u;_--)h.buf[_+p]=h.buf[_]}function vne(u,s){for(var h=0;h<u.length;h++)s.writeVarint(u[h])}function mne(u,s){for(var h=0;h<u.length;h++)s.writeSVarint(u[h])}function _ne(u,s){for(var h=0;h<u.length;h++)s.writeFloat(u[h])}function yne(u,s){for(var h=0;h<u.length;h++)s.writeDouble(u[h])}function xne(u,s){for(var h=0;h<u.length;h++)s.writeBoolean(u[h])}function bne(u,s){for(var h=0;h<u.length;h++)s.writeFixed32(u[h])}function wne(u,s){for(var h=0;h<u.length;h++)s.writeSFixed32(u[h])}function Sne(u,s){for(var h=0;h<u.length;h++)s.writeFixed64(u[h])}function Tne(u,s){for(var h=0;h<u.length;h++)s.writeSFixed64(u[h])}function IS(u,s){return(u[s]|u[s+1]<<8|u[s+2]<<16)+16777216*u[s+3]}function Im(u,s,h){u[h]=s,u[h+1]=s>>>8,u[h+2]=s>>>16,u[h+3]=s>>>24}function yN(u,s){return(u[s]|u[s+1]<<8|u[s+2]<<16)+(u[s+3]<<24)}Ri.prototype={destroy:function(){this.buf=null},readFields:function(u,s,h){for(h=h||this.length;this.pos<h;){var p=this.readVarint(),_=p>>3,b=this.pos;this.type=7&p,u(_,s,this),this.pos===b&&this.skip(p)}return s},readMessage:function(u,s){return this.readFields(u,s,this.readVarint()+this.pos)},readFixed32:function(){var u=IS(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=yN(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=IS(this.buf,this.pos)+IS(this.buf,this.pos+4)*rD;return this.pos+=8,u},readSFixed64:function(){var u=IS(this.buf,this.pos)+yN(this.buf,this.pos+4)*rD;return this.pos+=8,u},readFloat:function(){var u=MS.read(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=MS.read(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var s,h,p=this.buf;return s=127&(h=p[this.pos++]),h<128?s:(s|=(127&(h=p[this.pos++]))<<7,h<128?s:(s|=(127&(h=p[this.pos++]))<<14,h<128?s:(s|=(127&(h=p[this.pos++]))<<21,h<128?s:function(_,b,T){var I,L,k=T.buf;if(I=(112&(L=k[T.pos++]))>>4,L<128||(I|=(127&(L=k[T.pos++]))<<3,L<128)||(I|=(127&(L=k[T.pos++]))<<10,L<128)||(I|=(127&(L=k[T.pos++]))<<17,L<128)||(I|=(127&(L=k[T.pos++]))<<24,L<128)||(I|=(1&(L=k[T.pos++]))<<31,L<128))return Mm(_,I,b);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(h=p[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,s=this.pos;return this.pos=u,u-s>=12&&mN?function(h,p,_){return mN.decode(h.subarray(p,_))}(this.buf,s,u):function(h,p,_){for(var b="",T=p;T<_;){var I,L,k,F=h[T],N=null,U=F>239?4:F>223?3:F>191?2:1;if(T+U>_)break;U===1?F<128&&(N=F):U===2?(192&(I=h[T+1]))==128&&(N=(31&F)<<6|63&I)<=127&&(N=null):U===3?(L=h[T+2],(192&(I=h[T+1]))==128&&(192&L)==128&&((N=(15&F)<<12|(63&I)<<6|63&L)<=2047||N>=55296&&N<=57343)&&(N=null)):U===4&&(L=h[T+2],k=h[T+3],(192&(I=h[T+1]))==128&&(192&L)==128&&(192&k)==128&&((N=(15&F)<<18|(63&I)<<12|(63&L)<<6|63&k)<=65535||N>=1114112)&&(N=null)),N===null?(N=65533,U=1):N>65535&&(N-=65536,b+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),b+=String.fromCharCode(N),T+=U}return b}(this.buf,s,u)},readBytes:function(){var u=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,u);return this.pos=u,s},readPackedVarint:function(u,s){if(this.type!==Ri.Bytes)return u.push(this.readVarint(s));var h=$c(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(s));return u},readPackedSVarint:function(u){if(this.type!==Ri.Bytes)return u.push(this.readSVarint());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Ri.Bytes)return u.push(this.readBoolean());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Ri.Bytes)return u.push(this.readFloat());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Ri.Bytes)return u.push(this.readDouble());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Ri.Bytes)return u.push(this.readFixed32());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Ri.Bytes)return u.push(this.readSFixed32());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Ri.Bytes)return u.push(this.readFixed64());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Ri.Bytes)return u.push(this.readSFixed64());var s=$c(this);for(u=u||[];this.pos<s;)u.push(this.readSFixed64());return u},skip:function(u){var s=7&u;if(s===Ri.Varint)for(;this.buf[this.pos++]>127;);else if(s===Ri.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Ri.Fixed32)this.pos+=4;else{if(s!==Ri.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(u,s){this.writeVarint(u<<3|s)},realloc:function(u){for(var s=this.length||16;s<this.pos+u;)s*=2;if(s!==this.length){var h=new Uint8Array(s);h.set(this.buf),this.buf=h,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Im(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Im(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Im(this.buf,-1&u,this.pos),Im(this.buf,Math.floor(u*vN),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Im(this.buf,-1&u,this.pos),Im(this.buf,Math.floor(u*vN),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(s,h){var p,_;if(s>=0?(p=s%4294967296|0,_=s/4294967296|0):(_=~(-s/4294967296),4294967295^(p=~(-s%4294967296))?p=p+1|0:(p=0,_=_+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(b,T,I){I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,b>>>=7,I.buf[I.pos++]=127&b|128,I.buf[I.pos]=127&(b>>>=7)}(p,0,h),function(b,T){var I=(7&b)<<4;T.buf[T.pos++]|=I|((b>>>=3)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b)))))}(_,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var s=this.pos;this.pos=function(p,_,b){for(var T,I,L=0;L<_.length;L++){if((T=_.charCodeAt(L))>55295&&T<57344){if(!I){T>56319||L+1===_.length?(p[b++]=239,p[b++]=191,p[b++]=189):I=T;continue}if(T<56320){p[b++]=239,p[b++]=191,p[b++]=189,I=T;continue}T=I-55296<<10|T-56320|65536,I=null}else I&&(p[b++]=239,p[b++]=191,p[b++]=189,I=null);T<128?p[b++]=T:(T<2048?p[b++]=T>>6|192:(T<65536?p[b++]=T>>12|224:(p[b++]=T>>18|240,p[b++]=T>>12&63|128),p[b++]=T>>6&63|128),p[b++]=63&T|128)}return b}(this.buf,u,this.pos);var h=this.pos-s;h>=128&&_N(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),MS.write(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),MS.write(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var s=u.length;this.writeVarint(s),this.realloc(s);for(var h=0;h<s;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,s){this.pos++;var h=this.pos;u(s,this);var p=this.pos-h;p>=128&&_N(h,p,this),this.pos=h-1,this.writeVarint(p),this.pos+=p},writeMessage:function(u,s,h){this.writeTag(u,Ri.Bytes),this.writeRawMessage(s,h)},writePackedVarint:function(u,s){s.length&&this.writeMessage(u,vne,s)},writePackedSVarint:function(u,s){s.length&&this.writeMessage(u,mne,s)},writePackedBoolean:function(u,s){s.length&&this.writeMessage(u,xne,s)},writePackedFloat:function(u,s){s.length&&this.writeMessage(u,_ne,s)},writePackedDouble:function(u,s){s.length&&this.writeMessage(u,yne,s)},writePackedFixed32:function(u,s){s.length&&this.writeMessage(u,bne,s)},writePackedSFixed32:function(u,s){s.length&&this.writeMessage(u,wne,s)},writePackedFixed64:function(u,s){s.length&&this.writeMessage(u,Sne,s)},writePackedSFixed64:function(u,s){s.length&&this.writeMessage(u,Tne,s)},writeBytesField:function(u,s){this.writeTag(u,Ri.Bytes),this.writeBytes(s)},writeFixed32Field:function(u,s){this.writeTag(u,Ri.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(u,s){this.writeTag(u,Ri.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(u,s){this.writeTag(u,Ri.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(u,s){this.writeTag(u,Ri.Fixed64),this.writeSFixed64(s)},writeVarintField:function(u,s){this.writeTag(u,Ri.Varint),this.writeVarint(s)},writeSVarintField:function(u,s){this.writeTag(u,Ri.Varint),this.writeSVarint(s)},writeStringField:function(u,s){this.writeTag(u,Ri.Bytes),this.writeString(s)},writeFloatField:function(u,s){this.writeTag(u,Ri.Fixed32),this.writeFloat(s)},writeDoubleField:function(u,s){this.writeTag(u,Ri.Fixed64),this.writeDouble(s)},writeBooleanField:function(u,s){this.writeVarintField(u,!!s)}};var Em=z(gN);const nD=3;function Ane(u,s,h){s.glyphs=[],u===1&&h.readMessage(Cne,s)}function Cne(u,s,h){if(u===3){const{id:p,bitmap:_,width:b,height:T,left:I,top:L,advance:k}=h.readMessage(Mne,{});s.glyphs.push({id:p,bitmap:new of({width:b+2*nD,height:T+2*nD},_),metrics:{width:b,height:T,left:I,top:L,advance:k}})}else u===4?s.ascender=h.readSVarint():u===5&&(s.descender=h.readSVarint())}function Mne(u,s,h){u===1?s.id=h.readVarint():u===2?s.bitmap=h.readBytes():u===3?s.width=h.readVarint():u===4?s.height=h.readVarint():u===5?s.left=h.readSVarint():u===6?s.top=h.readSVarint():u===7&&(s.advance=h.readVarint())}const xN=nD,Us={horizontal:1,vertical:2,horizontalOnly:3};class F0{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,h){const p=new F0;return p.scale=s||1,p.fontStack=h,p}static forImage(s){const h=new F0;return h.imageName=s,h}}class Dm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,h){const p=new Dm;for(let _=0;_<s.sections.length;_++){const b=s.sections[_];b.image?p.addImageSection(b):p.addTextSection(b,h)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCodePoint(s){return this.text.codePointAt(s)}verticalizePunctuation(s){this.text=function(h,p){let _="";for(let b=0;b<h.length;b++){const T=h.charCodeAt(b+1)||null,I=h.charCodeAt(b-1)||null;_+=!p&&(T&&R(T)&&!B0[h[b+1]]||I&&R(I)&&!B0[h[b-1]])||!B0[h[b]]?h[b]:B0[h[b]]}return _}(this.text,s)}trim(){let s=0;for(let p=0;p<this.text.length&&ES[this.text.charCodeAt(p)];p++)s++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&ES[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(s,h),this.sectionIndex=this.sectionIndex.slice(s,h)}substring(s,h){const p=new Dm;return p.text=this.text.substring(s,h),p.sectionIndex=this.sectionIndex.slice(s,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,h)=>Math.max(s,this.sections[h].scale),0)}addTextSection(s,h){this.text+=s.text,this.sections.push(F0.forText(s.scale,s.fontStack||h));const p=this.sections.length-1;for(let _=0;_<s.text.length;++_)this.sectionIndex.push(p)}addImageSection(s){const h=s.image?s.image.namePrimary:"";if(h.length===0)return void Gi("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(F0.forImage(h)),this.sectionIndex.push(this.sections.length-1)):Gi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function iD(u,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q){const ee=Dm.fromFeature(u,_);N===Us.vertical&&ee.verticalizePunctuation(U);let ie=[];const oe=function(Te,Be,Ne,Xe,ft,Je){if(!Te)return[];const yt=[],_t=function(zt,Ot,xt,mr,fr,Gt){let Rr=0;for(let Sr=0;Sr<zt.length();Sr++){const _r=zt.getSection(Sr);Rr+=bN(zt.getCodePoint(Sr),_r,mr,fr,Ot,Gt)}return Rr/Math.max(1,Math.ceil(Rr/xt))}(Te,Be,Ne,Xe,ft,Je),dt=Te.text.indexOf("")>=0;let Pt=0;for(let zt=0;zt<Te.length();zt++){const Ot=Te.getSection(zt),xt=Te.getCodePoint(zt);if(ES[xt]||(Pt+=bN(xt,Ot,Xe,ft,Be,Je)),zt<Te.length()-1){const mr=!((It=xt)<11904||!(f["Bopomofo Extended"](It)||f.Bopomofo(It)||f["CJK Compatibility Forms"](It)||f["CJK Compatibility Ideographs"](It)||f["CJK Compatibility"](It)||f["CJK Radicals Supplement"](It)||f["CJK Strokes"](It)||f["CJK Symbols and Punctuation"](It)||f["CJK Unified Ideographs Extension A"](It)||f["CJK Unified Ideographs"](It)||f["Enclosed CJK Letters and Months"](It)||f["Halfwidth and Fullwidth Forms"](It)||f.Hiragana(It)||f["Ideographic Description Characters"](It)||f["Kangxi Radicals"](It)||f["Katakana Phonetic Extensions"](It)||f.Katakana(It)||f["Vertical Forms"](It)||f["Yi Radicals"](It)||f["Yi Syllables"](It)));(Ine[xt]||mr||Ot.imageName)&&yt.push(SN(zt+1,Pt,_t,yt,Ene(xt,Te.getCodePoint(zt+1),mr&&dt),!1))}}var It;return TN(SN(Te.length(),Pt,_t,yt,0,!0))}(ee,k,b,s,p,Z),{processBidirectionalText:_e,processStyledBidirectionalText:Se}=De;if(_e&&ee.sections.length===1){const Te=_e(ee.toString(),oe);for(const Be of Te){const Ne=new Dm;Ne.text=Be,Ne.sections=ee.sections;for(let Xe=0;Xe<Be.length;Xe++)Ne.sectionIndex.push(0);ie.push(Ne)}}else if(Se){const Te=Se(ee.text,ee.sectionIndex,oe);for(const Be of Te){const Ne=new Dm;Ne.text=Be[0],Ne.sectionIndex=Be[1],Ne.sections=ee.sections,ie.push(Ne)}}else ie=function(Te,Be){const Ne=[],Xe=Te.text;let ft=0;for(const Je of Be)Ne.push(Te.substring(ft,Je)),ft=Je;return ft<Xe.length&&Ne.push(Te.substring(ft,Xe.length)),Ne}(ee,oe);const xe=[],Re={positionedLines:xe,text:ee.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Te,Be,Ne,Xe,ft,Je,yt,_t,dt,Pt,It,zt){let Ot=0,xt=0,mr=0;const fr=_t==="right"?1:_t==="left"?0:.5;let Gt=!1;for(const Jr of ft){const Br=Jr.getSections();for(const an of Br){if(an.imageName)continue;const en=Be[an.fontStack];if(en&&(Gt=en.ascender!==void 0&&en.descender!==void 0,!Gt))break}if(!Gt)break}let Rr=0;for(const Jr of ft){Jr.trim();const Br=Jr.getMaxScale(),an=(Br-1)*Ya,en={positionedGlyphs:[],lineOffset:0};Te.positionedLines[Rr]=en;const mn=en.positionedGlyphs;let Or=0;if(!Jr.length()){xt+=Je,++Rr;continue}let ci=0,si=0;for(let Ln=0;Ln<Jr.length();Ln++){const Un=Jr.getSection(Ln),Ai=Jr.getSectionIndex(Ln),gi=Jr.getCodePoint(Ln);let Ui=Un.scale,Bi=null,so=null,Xi=null,ki=Ya,ca=0;const Ra=!(dt===Us.horizontal||!It&&!E(gi)||It&&(ES[gi]||(Sr=gi,f.Arabic(Sr)||f["Arabic Supplement"](Sr)||f["Arabic Extended-A"](Sr)||f["Arabic Presentation Forms-A"](Sr)||f["Arabic Presentation Forms-B"](Sr))));if(Un.imageName){const ka=Xe[Un.imageName];if(!ka)continue;Xi=Un.imageName,Te.iconsInText=Te.iconsInText||!0,so=ka.paddedRect;const xi=ka.displaySize;Ui=Ui*Ya/zt,Bi={width:xi[0],height:xi[1],left:0,top:-xN,advance:Ra?xi[1]:xi[0],localGlyph:!1},ca=Gt?-Bi.height*Ui:Br*Ya-17-xi[1]*Ui,ki=Bi.advance;const Lo=(Ra?xi[0]:xi[1])*Ui-Ya*Br;Lo>0&&Lo>Or&&(Or=Lo)}else{const ka=Ne[Un.fontStack];if(!ka)continue;ka[gi]&&(so=ka[gi]);const xi=Be[Un.fontStack];if(!xi)continue;const Lo=xi.glyphs[gi];if(!Lo)continue;if(Bi=Lo.metrics,ki=gi!==8203?Ya:0,Gt){const jc=xi.ascender!==void 0?Math.abs(xi.ascender):0,fl=xi.descender!==void 0?Math.abs(xi.descender):0,nu=(jc+fl)*Ui;ci<nu&&(ci=nu,si=(jc-fl)/2*Ui),ca=-jc*Ui}else ca=(Br-Ui)*Ya-17}Ra?(Te.verticalizable=!0,mn.push({glyph:gi,imageName:Xi,x:Ot,y:xt+ca,vertical:Ra,scale:Ui,localGlyph:Bi.localGlyph,fontStack:Un.fontStack,sectionIndex:Ai,metrics:Bi,rect:so}),Ot+=ki*Ui+Pt):(mn.push({glyph:gi,imageName:Xi,x:Ot,y:xt+ca,vertical:Ra,scale:Ui,localGlyph:Bi.localGlyph,fontStack:Un.fontStack,sectionIndex:Ai,metrics:Bi,rect:so}),Ot+=Bi.advance*Ui+Pt)}mn.length!==0&&(mr=Math.max(Ot-Pt,mr),Gt?AN(mn,fr,Or,si,Je*Br/2):AN(mn,fr,Or,0,Je/2)),Ot=0;const Gn=Je*Br+Or;en.lineOffset=Math.max(Or,an),xt+=Gn,++Rr}var Sr;const _r=xt,{horizontalAlign:$t,verticalAlign:Er}=aD(yt);(function(Jr,Br,an,en,mn,Or){const ci=(Br-an)*mn,si=-Or*en;for(const Gn of Jr)for(const Ln of Gn.positionedGlyphs)Ln.x+=ci,Ln.y+=si})(Te.positionedLines,fr,$t,Er,mr,_r),Te.top+=-Er*_r,Te.bottom=Te.top+_r,Te.left+=-$t*mr,Te.right=Te.left+mr,Te.hasBaseline=Gt}(Re,s,h,p,ie,T,I,L,N,k,U,Q),!function(Te){for(const Be of Te)if(Be.positionedGlyphs.length!==0)return!1;return!0}(xe)&&Re}const ES={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ine={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bN(u,s,h,p,_,b){if(s.imageName){const T=p[s.imageName];return T?T.displaySize[0]*s.scale*Ya/b+_:0}{const T=h[s.fontStack],I=T&&T.glyphs[u];return I?I.metrics.advance*s.scale+_:0}}function wN(u,s,h,p){const _=Math.pow(u-s,2);return p?u<s?_/2:2*_:_+Math.abs(h)*h}function Ene(u,s,h){let p=0;return u===10&&(p-=1e4),h&&(p+=150),u!==40&&u!==65288||(p+=50),s!==41&&s!==65289||(p+=50),p}function SN(u,s,h,p,_,b){let T=null,I=wN(s,h,_,b);for(const L of p){const k=wN(s-L.x,h,_,b)+L.badness;k<=I&&(T=L,I=k)}return{index:u,x:s,priorBreak:T,badness:I}}function TN(u){return u?TN(u.priorBreak).concat(u.index):[]}function aD(u){let s=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:s,verticalAlign:h}}function AN(u,s,h,p,_){if(!(s||h||p||_))return;const b=u.length-1,T=u[b],I=(T.x+T.metrics.advance*T.scale)*s;for(let L=0;L<=b;L++)u[L].x-=I,u[L].y+=h+p+_}function Dne(u,s,h,p){const{horizontalAlign:_,verticalAlign:b}=aD(p),T=h[0]-u.displaySize[0]*_,I=h[1]-u.displaySize[1]*b;return{imagePrimary:u,imageSecondary:s,top:I,bottom:I+u.displaySize[1],left:T,right:T+u.displaySize[0]}}function CN(u,s,h,p,_,b){const T=u.imagePrimary;let I;if(T.content){const ie=T.content,oe=T.pixelRatio||1;I=[ie[0]/oe,ie[1]/oe,T.displaySize[0]-ie[2]/oe,T.displaySize[1]-ie[3]/oe]}const L=s.left*b,k=s.right*b;let F,N,U,Z;h==="width"||h==="both"?(Z=_[0]+L-p[3],N=_[0]+k+p[1]):(Z=_[0]+(L+k-T.displaySize[0])/2,N=Z+T.displaySize[0]);const Q=s.top*b,ee=s.bottom*b;return h==="height"||h==="both"?(F=_[1]+Q-p[0],U=_[1]+ee+p[2]):(F=_[1]+(Q+ee-T.displaySize[1])/2,U=F+T.displaySize[1]),{imagePrimary:T,imageSecondary:void 0,top:F,right:N,bottom:U,left:Z,collisionPadding:I}}class Hc extends nr{constructor(s,h,p,_,b){super(s,h),this.angle=_,this.z=p,b!==void 0&&(this.segment=b)}clone(){return new Hc(this.x,this.y,this.z,this.angle,this.segment)}}function MN(u,s,h,p,_){if(s.segment===void 0)return!0;let b=s,T=s.segment+1,I=0;for(;I>-h/2;){if(T--,T<0)return!1;I-=u[T].dist(b),b=u[T]}I+=u[T].dist(u[T+1]),T++;const L=[];let k=0;for(;I<h/2;){const F=u[T],N=u[T+1];if(!N)return!1;let U=u[T-1].angleTo(F)-F.angleTo(N);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),L.push({distance:I,angleDelta:U}),k+=U;I-L[0].distance>p;)k-=L.shift().angleDelta;if(k>_)return!1;T++,I+=F.dist(N)}return!0}function IN(u){let s=0;for(let h=0;h<u.length-1;h++)s+=u[h].dist(u[h+1]);return s}function EN(u,s,h){return u?.6*s*h:0}function DN(u,s){return Math.max(u?u.right-u.left:0,s?s.right-s.left:0)}function Pne(u,s,h,p,_,b){const T=EN(h,_,b),I=DN(h,p)*b;let L=0;const k=IN(u)/2;for(let F=0;F<u.length-1;F++){const N=u[F],U=u[F+1],Z=N.dist(U);if(L+Z>k){const Q=(k-L)/Z,ee=cn(N.x,U.x,Q),ie=cn(N.y,U.y,Q),oe=new Hc(ee,ie,0,U.angleTo(N),F);return!T||MN(u,oe,I,T,s)?oe:void 0}L+=Z}}function Lne(u,s,h,p,_,b,T,I,L){const k=EN(p,b,T),F=DN(p,_),N=F*T,U=u[0].x===0||u[0].x===L||u[0].y===0||u[0].y===L;return s-N<s/4&&(s=N+s/4),PN(u,U?s/2*I%s:(F/2+2*b)*T*I%s,s,k,h,N,U,!1,L)}function PN(u,s,h,p,_,b,T,I,L){const k=b/2,F=IN(u);let N=0,U=s-h,Z=[];for(let Q=0;Q<u.length-1;Q++){const ee=u[Q],ie=u[Q+1],oe=ee.dist(ie),_e=ie.angleTo(ee);for(;U+h<N+oe;){U+=h;const Se=(U-N)/oe,xe=cn(ee.x,ie.x,Se),Re=cn(ee.y,ie.y,Se);if(xe>=0&&xe<L&&Re>=0&&Re<L&&U-k>=0&&U+k<=F){const Te=new Hc(xe,Re,0,_e,Q);p&&!MN(u,Te,b,p,_)||Z.push(Te)}}N+=oe}return I||Z.length||T||(Z=PN(u,N/2,h,p,_,b,T,!0,L)),Z}function LN(u,s,h,p,_){const b=[];for(let T=0;T<u.length;T++){const I=u[T];let L;for(let k=0;k<I.length-1;k++){let F=I[k],N=I[k+1];F.x<s&&N.x<s||(F.x<s?F=new nr(s,F.y+(s-F.x)/(N.x-F.x)*(N.y-F.y))._round():N.x<s&&(N=new nr(s,F.y+(s-F.x)/(N.x-F.x)*(N.y-F.y))._round()),F.y<h&&N.y<h||(F.y<h?F=new nr(F.x+(h-F.y)/(N.y-F.y)*(N.x-F.x),h)._round():N.y<h&&(N=new nr(F.x+(h-F.y)/(N.y-F.y)*(N.x-F.x),h)._round()),F.x>=p&&N.x>=p||(F.x>=p?F=new nr(p,F.y+(p-F.x)/(N.x-F.x)*(N.y-F.y))._round():N.x>=p&&(N=new nr(p,F.y+(p-F.x)/(N.x-F.x)*(N.y-F.y))._round()),F.y>=_&&N.y>=_||(F.y>=_?F=new nr(F.x+(_-F.y)/(N.y-F.y)*(N.x-F.x),_)._round():N.y>=_&&(N=new nr(F.x+(_-F.y)/(N.y-F.y)*(N.x-F.x),_)._round()),L&&F.equals(L[L.length-1])||(L=[F],b.push(L)),L.push(N)))))}}return b}function RN(u){let s=0,h=0;for(const T of u)s+=T.w*T.h,h=Math.max(h,T.w);u.sort((T,I)=>I.h-T.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),h),h:1/0}];let _=0,b=0;for(const T of u)for(let I=p.length-1;I>=0;I--){const L=p[I];if(!(T.w>L.w||T.h>L.h)){if(T.x=L.x,T.y=L.y,b=Math.max(b,T.y+T.h),_=Math.max(_,T.x+T.w),T.w===L.w&&T.h===L.h){const k=p.pop();I<p.length&&(p[I]=k)}else T.h===L.h?(L.x+=T.w,L.w-=T.w):T.w===L.w?(L.y+=T.h,L.h-=T.h):(p.push({x:L.x+T.w,y:L.y,w:L.w-T.w,h:T.h}),L.y+=T.h,L.h-=T.h);break}}return{w:_,h:b,fill:s/(_*b)||0}}gr(Hc,"Anchor");const ds=1;class oD{constructor(s,{pixelRatio:h,version:p,stretchX:_,stretchY:b,content:T}){this.paddedRect=s,this.pixelRatio=h,this.stretchX=_,this.stretchY=b,this.content=T,this.version=p}get tl(){return[this.paddedRect.x+ds,this.paddedRect.y+ds]}get br(){return[this.paddedRect.x+this.paddedRect.w-ds,this.paddedRect.y+this.paddedRect.h-ds]}get displaySize(){return[(this.paddedRect.w-2*ds)/this.pixelRatio,(this.paddedRect.h-2*ds)/this.pixelRatio]}}class kN{constructor(s,h){const p={},_={};this.haveRenderCallbacks=[];const b=[];this.addImages(s,p,b),this.addImages(h,_,b);const{w:T,h:I}=RN(b),L=new Gs({width:T||1,height:I||1});for(const k in s){const F=s[k],N=p[k].paddedRect;Gs.copy(F.data,L,{x:0,y:0},{x:N.x+ds,y:N.y+ds},F.data,F.sdf)}for(const k in h){const F=h[k],N=_[k].paddedRect,U=N.x+ds,Z=N.y+ds,Q=F.data.width,ee=F.data.height;Gs.copy(F.data,L,{x:0,y:0},{x:U,y:Z},F.data),Gs.copy(F.data,L,{x:0,y:ee-1},{x:U,y:Z-1},{width:Q,height:1}),Gs.copy(F.data,L,{x:0,y:0},{x:U,y:Z+ee},{width:Q,height:1}),Gs.copy(F.data,L,{x:Q-1,y:0},{x:U-1,y:Z},{width:1,height:ee}),Gs.copy(F.data,L,{x:0,y:0},{x:U+Q,y:Z},{width:1,height:ee})}this.image=L,this.iconPositions=p,this.patternPositions=_}addImages(s,h,p){for(const _ in s){const b=s[_],T={x:0,y:0,w:b.data.width+2*ds,h:b.data.height+2*ds};p.push(T),h[_]=new oD(T,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(s,h,p){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(_=>s.hasImage(_,p)),s.dispatchRenderCallbacks(this.haveRenderCallbacks,p);for(const _ in s.getUpdatedImages(p))this.patchUpdatedImage(this.iconPositions[_],s.getImage(_,p),h),this.patchUpdatedImage(this.patternPositions[_],s.getImage(_,p),h)}patchUpdatedImage(s,h,p){if(!s||!h||s.version===h.version)return;s.version=h.version;const[_,b]=s.tl,T=!!Object.keys(this.patternPositions).length;p.update(h.data,{useMipmap:T},{x:_,y:b})}}gr(oD,"ImagePosition"),gr(kN,"ImageAtlas");const N0=1e20;function ON(u,s,h,p,_,b,T,I,L){for(let k=s;k<s+p;k++)zN(u,h*b+k,b,_,T,I,L);for(let k=h;k<h+_;k++)zN(u,k*b+s,1,p,T,I,L)}function zN(u,s,h,p,_,b,T){b[0]=0,T[0]=-N0,T[1]=N0,_[0]=u[s];for(let I=1,L=0,k=0;I<p;I++){_[I]=u[s+I*h];const F=I*I;do{const N=b[L];k=(_[I]-_[N]+F-N*N)/(I-N)/2}while(k<=T[L]&&--L>-1);L++,b[L]=I,T[L]=k,T[L+1]=N0}for(let I=0,L=0;I<p;I++){for(;T[L+1]<I;)L++;const k=b[L],F=I-k;u[s+I*h]=_[k]+F*F}}const Kl=2,sD={none:0,ideographs:1,all:2};class Pm{constructor(s,h,p){this.requestManager=s,this.localGlyphMode=h,this.localFontFamily=p,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s,h){this.urls[h]=s}getGlyphs(s,h,p){const _=[],b=this.urls[h]||m.GLYPHS_URL;for(const T in s)for(const I of s[T])_.push({stack:T,id:I});Ey(_,({stack:T,id:I},L)=>{let k=this.entries[T];k||(k=this.entries[T]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let F=k.glyphs[I];if(F!==void 0)return void L(null,{stack:T,id:I,glyph:F});if(F=this._tinySDF(k,T,I),F)return k.glyphs[I]=F,void L(null,{stack:T,id:I,glyph:F});const N=Math.floor(I/256);if(256*N>65535)return void L(new Error("glyphs > 65535 not supported"));if(k.ranges[N])return void L(null,{stack:T,id:I,glyph:F});let U=k.requests[N];U||(U=k.requests[N]=[],Pm.loadGlyphRange(T,N,b,this.requestManager,(Z,Q)=>{if(Q){k.ascender=Q.ascender,k.descender=Q.descender;for(const ee in Q.glyphs)this._doesCharSupportLocalGlyph(+ee)||(k.glyphs[+ee]=Q.glyphs[+ee]);k.ranges[N]=!0}for(const ee of U)ee(Z,Q);delete k.requests[N]})),U.push((Z,Q)=>{Z?L(Z):Q&&L(null,{stack:T,id:I,glyph:Q.glyphs[I]||null})})},(T,I)=>{if(T)p(T);else if(I){const L={};for(const{stack:k,id:F,glyph:N}of I)L[k]===void 0&&(L[k]={}),L[k].glyphs===void 0&&(L[k].glyphs={}),L[k].glyphs[F]=N&&{id:N.id,bitmap:N.bitmap.clone(),metrics:N.metrics},L[k].ascender=this.entries[k].ascender,L[k].descender=this.entries[k].descender;p(null,L)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==sD.none&&(this.localGlyphMode===sD.all?!!this.localFontFamily:!!this.localFontFamily&&(f["CJK Unified Ideographs"](s)||f["Hangul Syllables"](s)||f.Hiragana(s)||f.Katakana(s)||f["CJK Symbols and Punctuation"](s)||f["CJK Unified Ideographs Extension A"](s)||f["CJK Unified Ideographs Extension B"](s)))}_tinySDF(s,h,p){const _=this.localFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let b=s.tinySDF;if(!b){let ee="400";/bold/i.test(h)?ee="900":/medium/i.test(h)?ee="500":/light/i.test(h)&&(ee="200"),b=s.tinySDF=new Pm.TinySDF({fontFamily:_,fontWeight:ee,fontSize:24*Kl,buffer:3*Kl,radius:8*Kl}),b.fontWeight=ee}if(this.localGlyphs[b.fontWeight][p])return this.localGlyphs[b.fontWeight][p];const T=String.fromCodePoint(p),{data:I,width:L,height:k,glyphWidth:F,glyphHeight:N,glyphLeft:U,glyphTop:Z,glyphAdvance:Q}=b.draw(T);return this.localGlyphs[b.fontWeight][p]={id:p,bitmap:new of({width:L,height:k},I),metrics:{width:F/Kl,height:N/Kl,left:U/Kl,top:Z/Kl-27,advance:Q/Kl,localGlyph:!0}}}}Pm.loadGlyphRange=function(u,s,h,p,_){const b=256*s,T=b+255,I=p.transformRequest(p.normalizeGlyphsURL(h).replace("{fontstack}",u).replace("{range}",`${b}-${T}`),kv.Glyphs);Fd(I,(L,k)=>{if(L)_(L);else if(k){const F={},N=function(U){return new Em(U).readFields(Ane,{})}(k);for(const U of N.glyphs)F[U.id]=U;_(null,{glyphs:F,ascender:N.ascender,descender:N.descender})}})},Pm.TinySDF=class{constructor({fontSize:u=24,buffer:s=3,radius:h=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:b="normal",fontStyle:T="normal"}={}){this.buffer=s,this.cutoff=p,this.radius=h;const I=this.size=u+4*s,L=this._createCanvas(I),k=this.ctx=L.getContext("2d",{willReadFrequently:!0});k.font=`${T} ${b} ${u}px ${_}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(u){const s=document.createElement("canvas");return s.width=s.height=u,s}draw(u){const{width:s,actualBoundingBoxAscent:h,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:b}=this.ctx.measureText(u),T=Math.ceil(h),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-_))),L=Math.min(this.size-this.buffer,T+Math.ceil(p)),k=I+2*this.buffer,F=L+2*this.buffer,N=Math.max(k*F,0),U=new Uint8ClampedArray(N),Z={data:U,width:k,height:F,glyphWidth:I,glyphHeight:L,glyphTop:T,glyphLeft:0,glyphAdvance:s};if(I===0||L===0)return Z;const{ctx:Q,buffer:ee,gridInner:ie,gridOuter:oe}=this;Q.clearRect(ee,ee,I,L),Q.fillText(u,ee,ee+T);const _e=Q.getImageData(ee,ee,I,L);oe.fill(N0,0,N),ie.fill(0,0,N);for(let Se=0;Se<L;Se++)for(let xe=0;xe<I;xe++){const Re=_e.data[4*(Se*I+xe)+3]/255;if(Re===0)continue;const Te=(Se+ee)*k+xe+ee;if(Re===1)oe[Te]=0,ie[Te]=N0;else{const Be=.5-Re;oe[Te]=Be>0?Be*Be:0,ie[Te]=Be<0?Be*Be:0}}ON(oe,0,0,k,F,k,this.f,this.v,this.z),ON(ie,ee,ee,I,L,k,this.f,this.v,this.z);for(let Se=0;Se<N;Se++){const xe=Math.sqrt(oe[Se])-Math.sqrt(ie[Se]);U[Se]=Math.round(255-255*(xe/this.radius+this.cutoff))}return Z}};const uf=ds;function BN(u,s,h,p){const _=[],b=u.imagePrimary,T=b.pixelRatio,I=b.paddedRect.w-2*uf,L=b.paddedRect.h-2*uf,k=u.right-u.left,F=u.bottom-u.top,N=b.stretchX||[[0,I]],U=b.stretchY||[[0,L]],Z=(Je,yt)=>Je+yt[1]-yt[0],Q=N.reduce(Z,0),ee=U.reduce(Z,0),ie=I-Q,oe=L-ee;let _e=0,Se=Q,xe=0,Re=ee,Te=0,Be=ie,Ne=0,Xe=oe;if(b.content&&p){const Je=b.content;_e=DS(N,0,Je[0]),xe=DS(U,0,Je[1]),Se=DS(N,Je[0],Je[2]),Re=DS(U,Je[1],Je[3]),Te=Je[0]-_e,Ne=Je[1]-xe,Be=Je[2]-Je[0]-Se,Xe=Je[3]-Je[1]-Re}const ft=(Je,yt,_t,dt)=>{const Pt=PS(Je.stretch-_e,Se,k,u.left),It=LS(Je.fixed-Te,Be,Je.stretch,Q),zt=PS(yt.stretch-xe,Re,F,u.top),Ot=LS(yt.fixed-Ne,Xe,yt.stretch,ee),xt=PS(_t.stretch-_e,Se,k,u.left),mr=LS(_t.fixed-Te,Be,_t.stretch,Q),fr=PS(dt.stretch-xe,Re,F,u.top),Gt=LS(dt.fixed-Ne,Xe,dt.stretch,ee),Rr=new nr(Pt,zt),Sr=new nr(xt,zt),_r=new nr(xt,fr),$t=new nr(Pt,fr),Er=new nr(It/T,Ot/T),Jr=new nr(mr/T,Gt/T),Br=s*Math.PI/180;if(Br){const si=Math.sin(Br),Gn=Math.cos(Br),Ln=[Gn,-si,si,Gn];Rr._matMult(Ln),Sr._matMult(Ln),$t._matMult(Ln),_r._matMult(Ln)}const an=Je.stretch+Je.fixed,en=_t.stretch+_t.fixed,mn=yt.stretch+yt.fixed,Or=dt.stretch+dt.fixed,ci=u.imageSecondary;return{tl:Rr,tr:Sr,bl:$t,br:_r,texPrimary:{x:b.paddedRect.x+uf+an,y:b.paddedRect.y+uf+mn,w:en-an,h:Or-mn},texSecondary:ci?{x:ci.paddedRect.x+uf+an,y:ci.paddedRect.y+uf+mn,w:en-an,h:Or-mn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Er,pixelOffsetBR:Jr,minFontScaleX:Be/T/k,minFontScaleY:Xe/T/F,isSDF:h}};if(p&&(b.stretchX||b.stretchY)){const Je=FN(N,ie,Q),yt=FN(U,oe,ee);for(let _t=0;_t<Je.length-1;_t++){const dt=Je[_t],Pt=Je[_t+1];for(let It=0;It<yt.length-1;It++)_.push(ft(dt,yt[It],Pt,yt[It+1]))}}else _.push(ft({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:L+1}));return _}function DS(u,s,h){let p=0;for(const _ of u)p+=Math.max(s,Math.min(h,_[1]))-Math.max(s,Math.min(h,_[0]));return p}function FN(u,s,h){const p=[{fixed:-uf,stretch:0}];for(const[_,b]of u){const T=p[p.length-1];p.push({fixed:_-T.stretch,stretch:T.stretch}),p.push({fixed:_-T.stretch,stretch:T.stretch+(b-_)})}return p.push({fixed:s+uf,stretch:h}),p}function PS(u,s,h,p){return u/s*h+p}function LS(u,s,h,p){return u-s*h/p}function Rne(u,s,h,p){const _=s+u.positionedLines[p].lineOffset;return p===0?h+_/2:h+(_+(s+u.positionedLines[p-1].lineOffset))/2}function kne(u,s=1,h=!1){let p=1/0,_=1/0,b=-1/0,T=-1/0;const I=u[0];for(let Z=0;Z<I.length;Z++){const Q=I[Z];(!Z||Q.x<p)&&(p=Q.x),(!Z||Q.y<_)&&(_=Q.y),(!Z||Q.x>b)&&(b=Q.x),(!Z||Q.y>T)&&(T=Q.y)}const L=Math.min(b-p,T-_);let k=L/2;const F=new Qv([],One);if(L===0)return new nr(p,_);for(let Z=p;Z<b;Z+=L)for(let Q=_;Q<T;Q+=L)F.push(new Lm(Z+k,Q+k,k,u));let N=function(Z){let Q=0,ee=0,ie=0;const oe=Z[0];for(let _e=0,Se=oe.length,xe=Se-1;_e<Se;xe=_e++){const Re=oe[_e],Te=oe[xe],Be=Re.x*Te.y-Te.x*Re.y;ee+=(Re.x+Te.x)*Be,ie+=(Re.y+Te.y)*Be,Q+=3*Be}return new Lm(ee/Q,ie/Q,0,Z)}(u),U=F.length;for(;F.length;){const Z=F.pop();(Z.d>N.d||!N.d)&&(N=Z,h&&console.log("found best %d after %d probes",Math.round(1e4*Z.d)/1e4,U)),Z.max-N.d<=s||(k=Z.h/2,F.push(new Lm(Z.p.x-k,Z.p.y-k,k,u)),F.push(new Lm(Z.p.x+k,Z.p.y-k,k,u)),F.push(new Lm(Z.p.x-k,Z.p.y+k,k,u)),F.push(new Lm(Z.p.x+k,Z.p.y+k,k,u)),U+=4)}return h&&(console.log(`num probes: ${U}`),console.log(`best distance: ${N.d}`)),N.p}function One(u,s){return s.max-u.max}class Lm{constructor(s,h,p,_){this.p=new nr(s,h),this.h=p,this.d=function(b,T){let I=!1,L=1/0;for(let k=0;k<T.length;k++){const F=T[k];for(let N=0,U=F.length,Z=U-1;N<U;Z=N++){const Q=F[N],ee=F[Z];Q.y>b.y!=ee.y>b.y&&b.x<(ee.x-Q.x)*(b.y-Q.y)/(ee.y-Q.y)+Q.x&&(I=!I),L=Math.min(L,tF(b,Q,ee))}}return(I?1:-1)*Math.sqrt(L)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}}const lD=Number.POSITIVE_INFINITY,zne=Math.sqrt(2);function NN(u,[s,h]){let p=0,_=0;if(h===lD){s<0&&(s=0);const b=s/zne;switch(u){case"top-right":case"top-left":_=b-7;break;case"bottom-right":case"bottom-left":_=7-b;break;case"bottom":_=7-s;break;case"top":_=s-7}switch(u){case"top-right":case"bottom-right":p=-b;break;case"top-left":case"bottom-left":p=b;break;case"left":p=s;break;case"right":p=-s}}else{switch(s=Math.abs(s),h=Math.abs(h),u){case"top-right":case"top-left":case"top":_=h-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-h}switch(u){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}}return[p,_]}function uD(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Bne(u,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q){let ee=b.textMaxSize.evaluate(s,{},N);ee===void 0&&(ee=T);const ie=u.layers[0].layout,oe=ie.get("icon-offset").evaluate(s,{},N),_e=GN(h.horizontal)||h.vertical,Se=U.name==="globe",xe=Ya,Re=T/xe,Te=u.tilePixelRatio*ee/xe,Be=(Pt=u.overscaling,u.zoom>18&&Pt>2&&(Pt>>=1),Math.max(ir/(512*Pt),1)*ie.get("symbol-spacing")),Ne=ie.get("text-padding")*u.tilePixelRatio,Xe=ie.get("icon-padding")*u.tilePixelRatio,ft=On(ie.get("text-max-angle")),Je=ie.get("text-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",yt=ie.get("icon-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",_t=ie.get("symbol-placement"),dt=Be/2;var Pt;const It=ie.get("icon-text-fit").evaluate(s,{},N),zt=ie.get("icon-text-fit-padding").evaluate(s,{},N),Ot=It!=="none";let xt;u.hasAnyIconTextFit===!1&&Ot&&(u.hasAnyIconTextFit=!0),p&&Ot&&(u.allowVerticalPlacement&&h.vertical&&(xt=CN(p,h.vertical,It,zt,oe,Re)),_e&&(p=CN(p,_e,It,zt,oe,Re)));const mr=(fr,Gt,Rr)=>{if(Gt.x<0||Gt.x>=ir||Gt.y<0||Gt.y>=ir)return;let Sr=null;if(Se){const{x:_r,y:$t,z:Er}=U.projectTilePoint(Gt.x,Gt.y,Rr);Sr={anchor:new Hc(_r,$t,Er,0,void 0),up:U.upVector(Rr,Gt.x,Gt.y)}}(function(_r,$t,Er,Jr,Br,an,en,mn,Or,ci,si,Gn,Ln,Un,Ai,gi,Ui,Bi,so,Xi,ki,ca,Ra,ka,xi,Lo,jc){const fl=_r.addToLineVertexArray($t,Jr);let nu,gf,vf,Dp,$4,H4,j4,W4=0,Z4=0,q4=0,Y4=0,LD=-1,RD=-1;const Nu={};let X4=Ud("");const Pp=Er?Er.anchor:$t,kD=Or.layout.get("icon-text-fit").evaluate(ki,{},xi)!=="none";let OD=0,zD=0;if(Or._unevaluatedLayout.getValue("text-radial-offset")===void 0?[OD,zD]=Or.layout.get("text-offset").evaluate(ki,{},xi).map(ps=>ps*Ya):(OD=Or.layout.get("text-radial-offset").evaluate(ki,{},xi)*Ya,zD=lD),_r.allowVerticalPlacement&&Br.vertical){const ps=Br.vertical;if(Ai)H4=cD(ps),mn&&(j4=cD(mn));else{const gs=Or.layout.get("text-rotate").evaluate(ki,{},xi)+90;vf=RS(ci,Pp,$t,si,Gn,Ln,ps,Un,gs,gi),mn&&(Dp=RS(ci,Pp,$t,si,Gn,Ln,mn,Bi,gs))}}if(an){const ps=Or.layout.get("icon-rotate").evaluate(ki,{},xi),gs=BN(an,ps,Ra,kD),Nm=mn?BN(mn,ps,Ra,kD):void 0;gf=RS(ci,Pp,$t,si,Gn,Ln,an,Bi,ps),W4=4*gs.length;const Q4=_r.iconSizeData;let Lp=null;Q4.kind==="source"?(Lp=[Ql*Or.layout.get("icon-size").evaluate(ki,{},xi)],Lp[0]>cf&&Gi(`${_r.layerIds[0]}: Value for "icon-size" is >= ${V0}. Reduce your "icon-size".`)):Q4.kind==="composite"&&(Lp=[Ql*ca.compositeIconSizes[0].evaluate(ki,{},xi),Ql*ca.compositeIconSizes[1].evaluate(ki,{},xi)],(Lp[0]>cf||Lp[1]>cf)&&Gi(`${_r.layerIds[0]}: Value for "icon-size" is >= ${V0}. Reduce your "icon-size".`)),_r.addSymbols(_r.icon,gs,Lp,Xi,so,ki,!1,Er,$t,fl.lineStartIndex,fl.lineLength,-1,ka,xi,Lo,jc),LD=_r.icon.placedSymbolArray.length-1,Nm&&(Z4=4*Nm.length,_r.addSymbols(_r.icon,Nm,Lp,Xi,so,ki,Us.vertical,Er,$t,fl.lineStartIndex,fl.lineLength,-1,ka,xi,Lo,jc),RD=_r.icon.placedSymbolArray.length-1)}for(const ps in Br.horizontal){const gs=Br.horizontal[ps];nu||(X4=Ud(gs.text),Ai?$4=cD(gs):nu=RS(ci,Pp,$t,si,Gn,Ln,gs,Un,Or.layout.get("text-rotate").evaluate(ki,{},xi),gi));const Nm=gs.positionedLines.length===1;if(q4+=VN(_r,Er,$t,gs,en,Or,Ai,ki,gi,fl,Br.vertical?Us.horizontal:Us.horizontalOnly,Nm?Object.keys(Br.horizontal):[ps],Nu,LD,ca,ka,xi,Lo),Nm)break}Br.vertical&&(Y4+=VN(_r,Er,$t,Br.vertical,en,Or,Ai,ki,gi,fl,Us.vertical,["vertical"],Nu,RD,ca,ka,xi,Lo));let mf=-1;const BD=(ps,gs)=>ps?Math.max(ps,gs):gs;mf=BD($4,mf),mf=BD(H4,mf),mf=BD(j4,mf);const tae=mf>-1?1:0;_r.glyphOffsetArray.length>=65535&&Gi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ki.sortKey!==void 0&&_r.addToSortKeyRanges(_r.symbolInstances.length,ki.sortKey),_r.symbolInstances.emplaceBack($t.x,$t.y,Pp.x,Pp.y,Pp.z,Nu.right>=0?Nu.right:-1,Nu.center>=0?Nu.center:-1,Nu.left>=0?Nu.left:-1,Nu.vertical>=0?Nu.vertical:-1,LD,RD,X4,nu!==void 0?nu:_r.collisionBoxArray.length,nu!==void 0?nu+1:_r.collisionBoxArray.length,vf!==void 0?vf:_r.collisionBoxArray.length,vf!==void 0?vf+1:_r.collisionBoxArray.length,gf!==void 0?gf:_r.collisionBoxArray.length,gf!==void 0?gf+1:_r.collisionBoxArray.length,Dp||_r.collisionBoxArray.length,Dp?Dp+1:_r.collisionBoxArray.length,si,q4,Y4,W4,Z4,tae,0,OD,zD,mf,0,kD?1:0)})(u,Gt,Sr,fr,h,p,_,xt,u.layers[0],u.collisionBoxArray,s.index,s.sourceLayerIndex,u.index,Ne,Je,L,0,Xe,yt,oe,s,b,k,F,N,Z,Q)};if(_t==="line")for(const fr of LN(s.geometry,0,0,ir,ir)){const Gt=Lne(fr,Be,ft,h.vertical||_e,p,xe,Te,u.overscaling,ir);for(const Rr of Gt)_e&&Fne(u,_e.text,dt,Rr)||mr(fr,Rr,N)}else if(_t==="line-center"){for(const fr of s.geometry)if(fr.length>1){const Gt=Pne(fr,ft,h.vertical||_e,p,xe,Te);Gt&&mr(fr,Gt,N)}}else if(s.type==="Polygon")for(const fr of qE(s.geometry,0)){const Gt=kne(fr,16);mr(fr[0],new Hc(Gt.x,Gt.y,0,0,void 0),N)}else if(s.type==="LineString")for(const fr of s.geometry)mr(fr,new Hc(fr[0].x,fr[0].y,0,0,void 0),N);else if(s.type==="Point")for(const fr of s.geometry)for(const Gt of fr)mr([Gt],new Hc(Gt.x,Gt.y,0,0,void 0),N)}const V0=255,cf=V0*Ql;function VN(u,s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie,oe){const _e=function(Re,Te,Be,Ne,Xe,ft,Je,yt){const _t=[];if(Te.positionedLines.length===0)return _t;const dt=Ne.layout.get("text-rotate").evaluate(ft,{})*Math.PI/180,Pt=function(mr){const fr=mr[0],Gt=mr[1],Rr=fr*Gt;return Rr>0?[fr,-Gt]:Rr<0?[-fr,Gt]:fr===0?[Gt,fr]:[Gt,-fr]}(Be);let It=Math.abs(Te.top-Te.bottom);for(const mr of Te.positionedLines)It-=mr.lineOffset;const zt=Te.positionedLines.length,Ot=It/zt;let xt=Te.top-Be[1];for(let mr=0;mr<zt;++mr){const fr=Te.positionedLines[mr];xt=Rne(Te,Ot,xt,mr);for(const Gt of fr.positionedGlyphs){if(!Gt.rect)continue;const Rr=Gt.rect||{};let Sr=xN+1,_r=!0,$t=1,Er=0;if(Gt.imageName){const Xi=Je[Gt.imageName];if(!Xi)continue;if(Xi.sdf){Gi("SDF images are not supported in formatted text and will be ignored.");continue}_r=!1,$t=Xi.pixelRatio,Sr=ds/$t}const Jr=(Xe||yt)&&Gt.vertical,Br=Gt.metrics.advance*Gt.scale/2,an=Gt.metrics,en=Gt.rect;if(en===null)continue;yt&&Te.verticalizable&&(Er=Gt.imageName?Br-Gt.metrics.width*Gt.scale/2:0);const mn=Xe?[Gt.x+Br,Gt.y]:[0,0];let Or=[0,0],ci=[0,0],si=!1;Xe||(Jr?(ci=[Gt.x+Br+Pt[0],Gt.y+Pt[1]-Er],si=!0):Or=[Gt.x+Br+Be[0],Gt.y+Be[1]-Er]);const Gn=en.w*Gt.scale/($t*(Gt.localGlyph?Kl:1)),Ln=en.h*Gt.scale/($t*(Gt.localGlyph?Kl:1));let Un,Ai,gi,Ui;if(Jr){const Xi=Gt.y-xt,ki=new nr(-Br,Br-Xi),ca=-Math.PI/2,Ra=new nr(...ci);Un=new nr(-Br+Or[0],Or[1]),Un._rotateAround(ca,ki)._add(Ra),Un.x+=-Xi+Br,Un.y-=(an.left-Sr)*Gt.scale;const ka=Gt.imageName?an.advance*Gt.scale:Ya*Gt.scale,xi=String.fromCodePoint(Gt.glyph);dne(xi)?Un.x+=(1-Sr)*Gt.scale:pne(xi)?Un.x+=ka-an.height*Gt.scale+(-Sr-1)*Gt.scale:Un.x+=Gt.imageName||an.width+2*Sr===en.w&&an.height+2*Sr===en.h?(ka-Ln)/2:(ka-(an.height+2*Sr)*Gt.scale)/2,Ai=new nr(Un.x,Un.y-Gn),gi=new nr(Un.x+Ln,Un.y),Ui=new nr(Un.x+Ln,Un.y-Gn)}else{const Xi=(an.left-Sr)*Gt.scale-Br+Or[0],ki=(-an.top-Sr)*Gt.scale+Or[1],ca=Xi+Gn,Ra=ki+Ln;Un=new nr(Xi,ki),Ai=new nr(ca,ki),gi=new nr(Xi,Ra),Ui=new nr(ca,Ra)}if(dt){let Xi;Xi=Xe?new nr(0,0):si?new nr(Pt[0],Pt[1]):new nr(Be[0],Be[1]),Un._rotateAround(dt,Xi),Ai._rotateAround(dt,Xi),gi._rotateAround(dt,Xi),Ui._rotateAround(dt,Xi)}const Bi=new nr(0,0),so=new nr(0,0);_t.push({tl:Un,tr:Ai,bl:gi,br:Ui,texPrimary:Rr,texSecondary:void 0,writingMode:Te.writingMode,glyphOffset:mn,sectionIndex:Gt.sectionIndex,isSDF:_r,pixelOffsetTL:Bi,pixelOffsetBR:so,minFontScaleX:0,minFontScaleY:0})}}return _t}(0,p,L,b,T,I,_,u.allowVerticalPlacement),Se=u.textSizeData;let xe=null;Se.kind==="source"?(xe=[Ql*b.layout.get("text-size").evaluate(I,{},ie)],xe[0]>cf&&Gi(`${u.layerIds[0]}: Value for "text-size" is >= ${V0}. Reduce your "text-size".`)):Se.kind==="composite"&&(xe=[Ql*Q.compositeTextSizes[0].evaluate(I,{},ie),Ql*Q.compositeTextSizes[1].evaluate(I,{},ie)],(xe[0]>cf||xe[1]>cf)&&Gi(`${u.layerIds[0]}: Value for "text-size" is >= ${V0}. Reduce your "text-size".`)),u.addSymbols(u.text,_e,xe,L,T,I,F,s,h,k.lineStartIndex,k.lineLength,Z,ee,ie,oe,!1);for(const Re of N)U[Re]=u.text.placedSymbolArray.length-1;return 4*_e.length}function GN(u){for(const s in u)return u[s];return null}function RS(u,s,h,p,_,b,T,I,L,k){let F=T.top,N=T.bottom,U=T.left,Z=T.right;const Q=T.collisionPadding;if(Q&&(U-=Q[0],F-=Q[1],Z+=Q[2],N+=Q[3]),L){const ee=new nr(U,F),ie=new nr(Z,F),oe=new nr(U,N),_e=new nr(Z,N),Se=On(L);let xe=new nr(0,0);k&&(xe=new nr(k[0],k[1])),ee._rotateAround(Se,xe),ie._rotateAround(Se,xe),oe._rotateAround(Se,xe),_e._rotateAround(Se,xe),U=Math.min(ee.x,ie.x,oe.x,_e.x),Z=Math.max(ee.x,ie.x,oe.x,_e.x),F=Math.min(ee.y,ie.y,oe.y,_e.y),N=Math.max(ee.y,ie.y,oe.y,_e.y)}return u.emplaceBack(s.x,s.y,s.z,h.x,h.y,U,F,Z,N,I,p,_,b),u.length-1}function cD(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const s=u.bottom-u.top;return s>0?Math.max(10,s):null}function Fne(u,s,h,p){const _=u.compareText;if(s in _){const b=_[s];for(let T=b.length-1;T>=0;T--)if(p.dist(b[T])<h)return!0}else _[s]=[];return _[s].push(p),!1}function UN(u,s){const h=u.fovAboveCenter,p=u.elevation?u.elevation.getMinElevationBelowMSL()*s:0,_=(u._camera.position[2]*u.worldSize-p)/Math.cos(u._pitch),b=Math.sin(h)*_/Math.sin(Math.max(Math.PI/2-u._pitch-h,.01)),T=Math.sin(u._pitch)*b+_;return Math.min(1.01*T,_*(1/u._horizonShift))}function G0(u,s){if(!s.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:s};const h=Math.pow(2,-u.z),p=u.x*h,_=(u.x+1)*h,b=u.y*h,T=(u.y+1)*h,I=fs(p),L=fs(_),k=qa(b),F=qa(T),N=s.project(I,k),U=s.project(L,k),Z=s.project(L,F),Q=s.project(I,F);let ee=Math.min(N.x,U.x,Z.x,Q.x),ie=Math.min(N.y,U.y,Z.y,Q.y),oe=Math.max(N.x,U.x,Z.x,Q.x),_e=Math.max(N.y,U.y,Z.y,Q.y);const Se=h/16;function xe(Te,Be,Ne,Xe,ft,Je){const yt=(Ne+ft)/2,_t=(Xe+Je)/2,dt=s.project(fs(yt),qa(_t)),Pt=Math.max(0,ee-dt.x,ie-dt.y,dt.x-oe,dt.y-_e);ee=Math.min(ee,dt.x),oe=Math.max(oe,dt.x),ie=Math.min(ie,dt.y),_e=Math.max(_e,dt.y),Pt>Se&&(xe(Te,dt,Ne,Xe,yt,_t),xe(dt,Be,yt,_t,ft,Je))}xe(N,U,p,b,_,b),xe(U,Z,_,b,_,T),xe(Z,Q,_,T,p,T),xe(Q,N,p,T,p,b),ee-=Se,ie-=Se,oe+=Se,_e+=Se;const Re=1/Math.max(oe-ee,_e-ie);return{scale:Re,x:ee*Re,y:ie*Re,x2:oe*Re,y2:_e*Re,projection:s}}function $N(u,{x:s,y:h},p=0){return new nr(((s-p)*u.scale-u.x)*ir,(h*u.scale-u.y)*ir)}const Nne=o.a9.identity(new Float32Array(16));class hf{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,h){return{x:0,y:0,z:0}}unproject(s,h){return new Fn(0,0)}projectTilePoint(s,h,p){return{x:s,y:h,z:0}}locationPoint(s,h,p=!0){return s._coordinatePoint(s.locationCoordinate(h),p)}pixelsPerMeter(s,h){return Po(1,s)*h}pixelSpaceConversion(s,h,p){return 1}farthestPixelDistance(s){return UN(s,s.pixelsPerMeter)}pointCoordinate(s,h,p,_){const b=s.horizonLineFromTop(!1),T=new nr(h,Math.max(b,p));return s.rayIntersectionCoordinate(s.pointRayIntersection(T,_))}pointCoordinate3D(s,h,p){const _=new nr(h,p);if(s.elevation)return s.elevation.pointCoordinate(_);{const b=this.pointCoordinate(s,_.x,_.y,0);return[b.x,b.y,b.z]}}isPointAboveHorizon(s,h){if(s.elevation)return!this.pointCoordinate3D(s,h.x,h.y);const p=s.horizonLineFromTop();return h.y<p}createInversionMatrix(s,h){return Nne}createTileMatrix(s,h,p){let _,b,T;const I=p.canonical,L=o.a9.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=G0(I,this);_=1,b=k.x+p.wrap*k.scale,T=k.y,o.a9.scale(L,L,[_/k.scale,_/k.scale,s.pixelsPerMeter/h])}else _=h/s.zoomScale(I.z),b=(I.x+Math.pow(2,I.z)*p.wrap)*_,T=I.y*_;return o.a9.translate(L,L,[b,T,0]),o.a9.scale(L,L,[_/ir,_/ir,1]),L}upVector(s,h,p){return[0,0,1]}upVectorScale(s,h,p){return{metersToTile:1}}}class Vne extends hf{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[h,p]=this.parallels=s.parallels||[29.5,45.5],_=Math.sin(On(h));this.n=(_+Math.sin(On(p)))/2,this.c=1+_*(2*this.n-_),this.r0=Math.sqrt(this.c)/this.n}project(s,h){const{n:p,c:_,r0:b}=this,T=On(s-this.center[0]),I=On(h),L=Math.sqrt(_-2*p*Math.sin(I))/p;return{x:L*Math.sin(T*p),y:L*Math.cos(T*p)-b,z:0}}unproject(s,h){const{n:p,c:_,r0:b}=this,T=b+h;let I=Math.atan2(s,Math.abs(T))*Math.sign(T);T*p<0&&(I-=Math.PI*Math.sign(s)*Math.sign(T));const L=On(this.center[0])*p;I=Ul(I,-Math.PI-L,Math.PI-L);const k=wn(mo(I/p)+this.center[0],-180,180),F=Math.asin(wn((_-(s*s+T*T)*p*p)/(2*p),-1,1)),N=wn(mo(F),-ta,ta);return new Fn(k,N)}}const U0=1.340264,$0=-.081106,H0=893e-6,j0=.003796,kS=Math.sqrt(3)/2;class Gne extends hf{project(s,h){h=h/180*Math.PI,s=s/180*Math.PI;const p=Math.asin(kS*Math.sin(h)),_=p*p,b=_*_*_;return{x:.5*(s*Math.cos(p)/(kS*(U0+3*$0*_+b*(7*H0+9*j0*_)))/Math.PI+.5),y:1-.5*(p*(U0+$0*_+b*(H0+j0*_))/Math.PI+1),z:0}}unproject(s,h){s=(2*s-.5)*Math.PI;let p=h=(2*(1-h)-1)*Math.PI,_=p*p,b=_*_*_;for(let F,N,U,Z=0;Z<12&&(N=p*(U0+$0*_+b*(H0+j0*_))-h,U=U0+3*$0*_+b*(7*H0+9*j0*_),F=N/U,p=wn(p-F,-Math.PI/3,Math.PI/3),_=p*p,b=_*_*_,!(Math.abs(F)<1e-12));++Z);const T=kS*s*(U0+3*$0*_+b*(7*H0+9*j0*_))/Math.cos(p),I=Math.asin(Math.sin(p)/kS),L=wn(180*T/Math.PI,-180,180),k=wn(180*I/Math.PI,-ta,ta);return new Fn(L,k)}}class Une extends hf{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,h){return{x:.5+s/360,y:.5-h/360,z:0}}unproject(s,h){const p=360*(s-.5),_=wn(360*(.5-h),-ta,ta);return new Fn(p,_)}}const Rm=Math.PI/2;function OS(u){return Math.tan((Rm+u)/2)}class $ne extends hf{constructor(s){super(s),this.center=s.center||[0,30];const[h,p]=this.parallels=s.parallels||[30,30];let _=On(h),b=On(p);this.southernCenter=_+b<0,this.southernCenter&&(_=-_,b=-b);const T=Math.cos(_),I=OS(_);this.n=_===b?Math.sin(_):Math.log(T/Math.cos(b))/Math.log(OS(b)/I),this.f=T*Math.pow(OS(_),this.n)/this.n}project(s,h){h=On(h),this.southernCenter&&(h=-h),s=On(s-this.center[0]);const p=1e-6,{n:_,f:b}=this;b>0?h<-Rm+p&&(h=-Rm+p):h>Rm-p&&(h=Rm-p);const T=b/Math.pow(OS(h),_);let I=T*Math.sin(_*s),L=b-T*Math.cos(_*s);return I=.5*(I/Math.PI+.5),L=.5*(L/Math.PI+.5),{x:I,y:this.southernCenter?L:1-L,z:0}}unproject(s,h){s=(2*s-.5)*Math.PI,this.southernCenter&&(h=1-h),h=(2*(1-h)-.5)*Math.PI;const{n:p,f:_}=this,b=_-h,T=Math.sign(b),I=Math.sign(p)*Math.sqrt(s*s+b*b);let L=Math.atan2(s,Math.abs(b))*T;b*p<0&&(L-=Math.PI*Math.sign(s)*T);const k=wn(mo(L/p)+this.center[0],-180,180),F=wn(mo(2*Math.atan(Math.pow(_/I,1/p))-Rm),-ta,ta);return new Fn(k,this.southernCenter?-F:F)}}class HN extends hf{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,h){return{x:rf(s),y:Vc(h),z:0}}unproject(s,h){const p=fs(s),_=qa(h);return new Fn(p,_)}}const jN=On(ta);class Hne extends hf{project(s,h){const p=(h=On(h))*h,_=p*p;return{x:.5*((s=On(s))*(.8707-.131979*p+_*(_*(.003971*p-.001529*_)-.013791))/Math.PI+.5),y:1-.5*(h*(1.007226+p*(.015085+_*(.028874*p-.044475-.005916*_)))/Math.PI+1),z:0}}unproject(s,h){s=(2*s-.5)*Math.PI;let p=h=(2*(1-h)-1)*Math.PI,_=25,b=0,T=p*p;do{T=p*p;const k=T*T;b=(p*(1.007226+T*(.015085+k*(.028874*T-.044475-.005916*k)))-h)/(1.007226+T*(.045255+k*(.259866*T-.311325-.005916*11*k))),p=wn(p-b,-jN,jN)}while(Math.abs(b)>1e-6&&--_>0);T=p*p;const I=wn(mo(s/(.8707+T*(T*(T*T*T*(.003971-.001529*T)-.013791)-.131979))),-180,180),L=mo(p);return new Fn(I,L)}}const WN=On(ta);class jne extends hf{project(s,h){h=On(h),s=On(s);const p=Math.cos(h),_=2/Math.PI,b=Math.acos(p*Math.cos(s/2)),T=Math.sin(b)/b,I=.5*(s*_+2*p*Math.sin(s/2)/T)||0,L=.5*(h+Math.sin(h)/T)||0;return{x:.5*(I/Math.PI+.5),y:1-.5*(L/Math.PI+1),z:0}}unproject(s,h){let p=s=(2*s-.5)*Math.PI,_=h=(2*(1-h)-1)*Math.PI,b=25;const T=1e-6;let I=0,L=0;do{const k=Math.cos(_),F=Math.sin(_),N=2*F*k,U=F*F,Z=k*k,Q=Math.cos(p/2),ee=Math.sin(p/2),ie=2*Q*ee,oe=ee*ee,_e=1-Z*Q*Q,Se=_e?1/_e:0,xe=_e?Math.acos(k*Q)*Math.sqrt(1/_e):0,Re=.5*(2*xe*k*ee+2*p/Math.PI)-s,Te=.5*(xe*F+_)-h,Be=.5*Se*(Z*oe+xe*k*Q*U)+1/Math.PI,Ne=Se*(ie*N/4-xe*F*ee),Xe=.125*Se*(N*ee-xe*F*Z*ie),ft=.5*Se*(U*Q+xe*oe*k)+.5,Je=Ne*Xe-ft*Be;I=(Te*Ne-Re*ft)/Je,L=(Re*Xe-Te*Be)/Je,p=wn(p-I,-Math.PI,Math.PI),_=wn(_-L,-WN,WN)}while((Math.abs(I)>T||Math.abs(L)>T)&&--b>0);return new Fn(mo(p),mo(_))}}class ZN extends hf{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(On(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,h){const{scale:p,cosPhi:_}=this;return{x:On(s)*_*p+.5,y:-Math.sin(On(h))/_*p+.5,z:0}}unproject(s,h){const{scale:p,cosPhi:_}=this,b=-(h-.5)/p,T=wn(mo((s-.5)/p)/_,-180,180),I=Math.asin(wn(b*_,-1,1)),L=wn(mo(I),-ta,ta);return new Fn(T,L)}}class Wne extends HN{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,h,p){const _=E0(s,h,p),b=dS(Fu(p));return o.Q.transformMat4(_,_,b),{x:_[0],y:_[1],z:_[2]}}locationPoint(s,h){const p=wp(h.lat,h.lng),_=o.Q.normalize([],p),b=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(h),s._centerAltitude):s._centerAltitude,T=Po(1,0)*ir*b;o.Q.scaleAndAdd(p,p,_,T);const I=o.a9.identity(new Float64Array(16));return o.a9.multiply(I,s.pixelMatrix,s.globeMatrix),o.Q.transformMat4(p,p,I),new nr(p[0],p[1])}pixelsPerMeter(s,h){return Po(1,0)*h}pixelSpaceConversion(s,h,p){const _=Po(1,s)*h,b=cn(Po(1,45)*h,_,p);return this.pixelsPerMeter(s,h)/b}createTileMatrix(s,h,p){const _=VE(Fu(p.canonical));return o.a9.multiply(new Float64Array(16),s.globeMatrix,_)}createInversionMatrix(s,h){const{center:p}=s,_=dS(Fu(h));return o.a9.rotateY(_,_,On(p.lng)),o.a9.rotateX(_,_,On(p.lat)),o.a9.scale(_,_,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(_)}pointCoordinate(s,h,p,_){return cF(s,h,p,!0)||new oo(0,0)}pointCoordinate3D(s,h,p){const _=this.pointCoordinate(s,h,p,0);return[_.x,_.y,_.z]}isPointAboveHorizon(s,h){return!cF(s,h.x,h.y,!1)}farthestPixelDistance(s){const h=function(_,b){const T=_.cameraToCenterDistance,I=_._centerAltitude*b,L=_._camera,k=_._camera.forward(),F=o.Q.add([],o.Q.scale([],k,-T),[0,0,I]),N=_.worldSize/(2*Math.PI),U=[0,0,-N],Z=_.width/_.height,Q=Math.tan(_.fovAboveCenter),ee=o.Q.scale([],L.up(),Q),ie=o.Q.scale([],L.right(),Q*Z),oe=o.Q.normalize([],o.Q.add([],o.Q.add([],k,ee),ie)),_e=[];let Se;if(new OE(F,oe).closestPointOnSphere(U,N,_e)){const xe=o.Q.add([],_e,U),Re=o.Q.sub([],xe,F);Se=Math.cos(_.fovAboveCenter)*o.Q.length(Re)}else{const xe=o.Q.sub([],F,U),Re=o.Q.sub([],U,F);o.Q.normalize(Re,Re);const Te=o.Q.length(xe)-N;Se=Math.sqrt(Te*(Te+2*N));const Be=Math.acos(Se/(N+Te))-Math.acos(o.Q.dot(k,Re));Se*=Math.cos(Be)}return 1.01*Se}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),p=af(s.zoom);if(p>0){const _=UN(s,Po(1,s.center.lat)*s.worldSize),b=s.worldSize/(2*Math.PI),T=Math.max(s.width,s.height)/s.worldSize*Math.PI;return cn(h,_+b*(1-Math.cos(T)),Math.pow(p,10))}return h}upVector(s,h,p){return E0(h,p,s,1)}upVectorScale(s){return{metersToTile:cS(fS(Fu(s)))}}}function qN(u){const s=u.parallels,h=!!s&&Math.abs(s[0]+s[1])<.01;switch(u.name){case"mercator":return new HN(u);case"equirectangular":return new Une(u);case"naturalEarth":return new Hne(u);case"equalEarth":return new Gne(u);case"winkelTripel":return new jne(u);case"albers":return h?new ZN(u):new Vne(u);case"lambertConformalConic":return h?new ZN(u):new $ne(u);case"globe":return new Wne(u)}throw new Error(`Invalid projection name: ${u.name}`)}const Zne=xS.types,qne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zS(u,s,h,p,_,b,T,I,L,k,F,N,U){const Z=I?Math.min(cf,Math.round(I[0])):0,Q=I?Math.min(cf,Math.round(I[1])):0;u.emplaceBack(s,h,Math.round(32*p),Math.round(32*_),b,T,(Z<<1)+(L?1:0),Q,16*k,16*F,256*N,256*U)}function BS(u,s,h){u.emplaceBack(s,h)}function FS(u,s,h,p,_,b,T){u.emplaceBack(s,h,p,_,b,T)}function NS(u,s,h,p,_){u.emplaceBack(s,h,p,_),u.emplaceBack(s,h,p,_),u.emplaceBack(s,h,p,_),u.emplaceBack(s,h,p,_)}function Yne(u){for(const s of u.sections)if(j(s.text))return!0;return!1}class hD{constructor(s){this.layoutVertexArray=new ll,this.indexArray=new ba,this.programConfigurations=s,this.segments=new ea,this.dynamicLayoutVertexArray=new xa,this.opacityVertexArray=new Bu,this.placedSymbolArray=new R5,this.iconTransitioningVertexArray=new hs,this.globeExtVertexArray=new ul,this.zOffsetVertexArray=new S0}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(s,h,p,_,b){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,nne.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,ane.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,qne,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=s.createVertexBuffer(this.iconTransitioningVertexArray,sne.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,ine.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||b)&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,one.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||_)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}gr(hD,"SymbolBuffers");class fD{constructor(s,h,p){this.layoutVertexArray=new s,this.layoutAttributes=h,this.indexArray=new p,this.segments=new ea,this.collisionVertexArray=new Yl,this.collisionVertexArrayExt=new xa}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,lne.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,une.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}gr(fD,"CollisionBuffers");class VS{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(T=>T.fqid),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=o.a9.identity([]),this.placementViewportMatrix=o.a9.identity([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tD(this.zoom,h["text-size"]),this.iconSizeData=tD(this.zoom,h["icon-size"]);const p=this.layers[0].layout,_=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&_.constantOr(1)!==void 0,this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(T=>Us[T]),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=s.sourceID,this.projection=s.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=p.get("symbol-z-elevate")}createArrays(){this.text=new hD(new ef(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new hD(new ef(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new z5,this.lineVertexArray=new B5,this.symbolInstances=new O5}calculateGlyphDependencies(s,h,p,_,b){for(let T=0;T<s.length;T++){const I=s.codePointAt(T);if(I===void 0)break;if(h[I]=!0,_&&b&&I<=65535){const L=B0[s.charAt(T)];L&&(h[L.charCodeAt(0)]=!0)}}}populate(s,h,p,_){const b=this.layers[0],T=b.layout,I=this.projection.name==="globe",L=T.get("text-font"),k=T.get("text-field"),F=T.get("icon-image"),N=(k.value.kind!=="constant"||k.value.value instanceof Ha&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(L.value.kind!=="constant"||L.value.value.length>0),U=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,Z=T.get("symbol-sort-key");if(this.features=[],!N&&!U)return;const Q=h.iconDependencies,ee=h.glyphDependencies,ie=h.availableImages,oe=new he(this.zoom);for(const{feature:_e,id:Se,index:xe,sourceLayerIndex:Re}of s){const Te=b._featureFilter.needGeometry,Be=nf(_e,Te);if(!b._featureFilter.filter(oe,Be,p))continue;if(Te||(Be.geometry=Gc(_e,p,_)),I&&_e.type!==1&&p.z<=5){const Je=Be.geometry,yt=.98078528056,_t=(dt,Pt)=>{const It=E0(dt.x,dt.y,p,1),zt=E0(Pt.x,Pt.y,p,1);return o.Q.dot(It,zt)<yt};for(let dt=0;dt<Je.length;dt++)Je[dt]=Bte(Je[dt],_t)}let Ne,Xe;if(N){const Je=b.getValueAndResolveTokens("text-field",Be,p,ie),yt=Ha.factory(Je);Yne(yt)&&(this.hasRTLText=!0),(!this.hasRTLText||Ce()==="unavailable"||this.hasRTLText&&De.isParsed())&&(Ne=fne(yt,b,Be))}if(U){const Je=b.getValueAndResolveTokens("icon-image",Be,p,ie);Xe=Je instanceof jo?Je:jo.fromString(Je)}if(!Ne&&!Xe)continue;const ft=this.sortFeaturesByKey?Z.evaluate(Be,{},p):void 0;if(this.features.push({id:Se,text:Ne,icon:Xe,index:xe,sourceLayerIndex:Re,geometry:Be.geometry,properties:_e.properties,type:Zne[_e.type],sortKey:ft}),Xe&&(Q[Xe.namePrimary]=!0,Xe.nameSecondary&&(Q[Xe.nameSecondary]=!0)),Ne){const Je=L.evaluate(Be,{},p).join(","),yt=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Us.vertical)>=0;for(const _t of Ne.sections)if(_t.image)Q[_t.image.namePrimary]=!0;else{const dt=v(Ne.toString()),Pt=_t.fontStack||Je,It=ee[Pt]=ee[Pt]||{};this.calculateGlyphDependencies(_t.text,It,yt,this.allowVerticalPlacement,dt)}}}T.get("symbol-placement")==="line"&&(this.features=function(_e){const Se={},xe={},Re=[];let Te=0;function Be(Je){Re.push(_e[Je]),Te++}function Ne(Je,yt,_t){const dt=xe[Je];return delete xe[Je],xe[yt]=dt,Re[dt].geometry[0].pop(),Re[dt].geometry[0]=Re[dt].geometry[0].concat(_t[0]),dt}function Xe(Je,yt,_t){const dt=Se[yt];return delete Se[yt],Se[Je]=dt,Re[dt].geometry[0].shift(),Re[dt].geometry[0]=_t[0].concat(Re[dt].geometry[0]),dt}function ft(Je,yt,_t){const dt=_t?yt[0][yt[0].length-1]:yt[0][0];return`${Je}:${dt.x}:${dt.y}`}for(let Je=0;Je<_e.length;Je++){const yt=_e[Je],_t=yt.geometry,dt=yt.text?yt.text.toString():null;if(!dt){Be(Je);continue}const Pt=ft(dt,_t),It=ft(dt,_t,!0);if(Pt in xe&&It in Se&&xe[Pt]!==Se[It]){const zt=Xe(Pt,It,_t),Ot=Ne(Pt,It,Re[zt].geometry);delete Se[Pt],delete xe[It],xe[ft(dt,Re[Ot].geometry,!0)]=Ot,Re[zt].geometry=null}else Pt in xe?Ne(Pt,It,_t):It in Se?Xe(Pt,It,_t):(Be(Je),Se[Pt]=Te-1,xe[It]=Te-1)}return Re.filter(Je=>Je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((_e,Se)=>_e.sortKey-Se.sortKey)}update(s,h,p,_,b){const T=Object.keys(s).length!==0;if(T&&!this.stateDependentLayers.length)return;const I=T?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(s,h,I,p,_,b),this.icon.programConfigurations.updatePaintArrays(s,h,I,p,_,b)}updateZOffset(){const s=(b,T,I)=>{p+=T,p>b.length&&b.resize(p);for(let L=-T;L<0;L++)b.emplace(L+p,I)},h=(b,T,I)=>{_+=T,_>b.length&&b.resize(_);for(let L=-T;L<0;L++)b.emplace(L+_,I)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let p=0,_=0;for(let b=0;b<this.symbolInstances.length;b++){const T=this.symbolInstances.get(b),{numHorizontalGlyphVertices:I,numVerticalGlyphVertices:L,numIconVertices:k}=T,F=T.zOffset,N=k>0;if((I>0||L>0)&&(s(this.text.zOffsetVertexArray,I,F),s(this.text.zOffsetVertexArray,L,F)),N){const{placedIconSymbolIndex:U,verticalPlacedIconSymbolIndex:Z}=T;U>=0&&h(this.icon.zOffsetVertexArray,k,F),Z>=0&&h(this.icon.zOffsetVertexArray,T.numVerticalIconVertices,F)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=qN(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,h){const p=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:_,y:b}of h)this.lineVertexArray.emplaceBack(_,b);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,h,p,_,b,T,I,L,k,F,N,U,Z,Q,ee,ie){const oe=s.indexArray,_e=s.layoutVertexArray,Se=s.globeExtVertexArray,xe=s.segments.prepareSegment(4*h.length,_e,oe,this.canOverlap?T.sortKey:void 0),Re=this.glyphOffsetArray.length,Te=xe.vertexLength,Be=this.allowVerticalPlacement&&I===Us.vertical?Math.PI/2:0,Ne=T.text&&T.text.sections;for(let ft=0;ft<h.length;ft++){const{tl:Je,tr:yt,bl:_t,br:dt,texPrimary:Pt,texSecondary:It,pixelOffsetTL:zt,pixelOffsetBR:Ot,minFontScaleX:xt,minFontScaleY:mr,glyphOffset:fr,isSDF:Gt,sectionIndex:Rr}=h[ft],Sr=xe.vertexLength,_r=fr[1];if(zS(_e,k.x,k.y,Je.x,_r+Je.y,Pt.x,Pt.y,p,Gt,zt.x,zt.y,xt,mr),zS(_e,k.x,k.y,yt.x,_r+yt.y,Pt.x+Pt.w,Pt.y,p,Gt,Ot.x,zt.y,xt,mr),zS(_e,k.x,k.y,_t.x,_r+_t.y,Pt.x,Pt.y+Pt.h,p,Gt,zt.x,Ot.y,xt,mr),zS(_e,k.x,k.y,dt.x,_r+dt.y,Pt.x+Pt.w,Pt.y+Pt.h,p,Gt,Ot.x,Ot.y,xt,mr),L){const{x:$t,y:Er,z:Jr}=L.anchor,[Br,an,en]=L.up;FS(Se,$t,Er,Jr,Br,an,en),FS(Se,$t,Er,Jr,Br,an,en),FS(Se,$t,Er,Jr,Br,an,en),FS(Se,$t,Er,Jr,Br,an,en),NS(s.dynamicLayoutVertexArray,$t,Er,Jr,Be)}else NS(s.dynamicLayoutVertexArray,k.x,k.y,k.z,Be);if(ie){const $t=It||Pt;BS(s.iconTransitioningVertexArray,$t.x,$t.y),BS(s.iconTransitioningVertexArray,$t.x+$t.w,$t.y),BS(s.iconTransitioningVertexArray,$t.x,$t.y+$t.h),BS(s.iconTransitioningVertexArray,$t.x+$t.w,$t.y+$t.h)}oe.emplaceBack(Sr,Sr+1,Sr+2),oe.emplaceBack(Sr+1,Sr+2,Sr+3),xe.vertexLength+=4,xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fr[0]),ft!==h.length-1&&Rr===h[ft+1].sectionIndex||s.programConfigurations.populatePaintArrays(_e.length,T,T.index,{},Z,Q,ee,Ne&&Ne[Rr])}const Xe=L?L.anchor:k;s.placedSymbolArray.emplaceBack(Xe.x,Xe.y,Xe.z,k.x,k.y,Re,this.glyphOffsetArray.length-Re,Te,F,N,k.segment,p?p[0]:0,p?p[1]:0,_[0],_[1],I,0,!1,0,U,0)}_commitLayoutVertex(s,h,p,_,b,T,I){s.emplaceBack(h,p,_,b,T,Math.round(I.x),Math.round(I.y))}_addCollisionDebugVertices(s,h,p,_,b,T,I){const L=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),k=L.vertexLength,F=I.tileAnchorX,N=I.tileAnchorY;for(let Z=0;Z<4;Z++)p.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(p.collisionVertexArrayExt,h,s.padding,I.zOffset),this._commitLayoutVertex(p.layoutVertexArray,_,b,T,F,N,new nr(s.x1,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,_,b,T,F,N,new nr(s.x2,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,_,b,T,F,N,new nr(s.x2,s.y2)),this._commitLayoutVertex(p.layoutVertexArray,_,b,T,F,N,new nr(s.x1,s.y2)),L.vertexLength+=4;const U=p.indexArray;U.emplaceBack(k,k+1),U.emplaceBack(k+1,k+2),U.emplaceBack(k+2,k+3),U.emplaceBack(k+3,k),L.primitiveLength+=4}_addTextDebugCollisionBoxes(s,h,p,_,b,T){for(let I=_;I<b;I++){const L=p.get(I),k=this.getSymbolInstanceTextSize(s,T,h,I);this._addCollisionDebugVertices(L,k,this.textCollisionBox,L.projectedAnchorX,L.projectedAnchorY,L.projectedAnchorZ,T)}}_addIconDebugCollisionBoxes(s,h,p,_,b,T){for(let I=_;I<b;I++){const L=p.get(I),k=this.getSymbolInstanceIconSize(s,h,T.placedIconSymbolIndex);this._addCollisionDebugVertices(L,k,this.iconCollisionBox,L.projectedAnchorX,L.projectedAnchorY,L.projectedAnchorZ,T)}}generateCollisionDebugBuffers(s,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fD(Qh,pN.members,hs),this.iconCollisionBox=new fD(Qh,pN.members,hs);const p=Cm(this.iconSizeData,s),_=Cm(this.textSizeData,s);for(let b=0;b<this.symbolInstances.length;b++){const T=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(_,s,h,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(_,s,h,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(p,s,h,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(p,s,h,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(s,h,p,_){const b=this.text.placedSymbolArray.get(h.rightJustifiedTextSymbolIndex>=0?h.rightJustifiedTextSymbolIndex:h.centerJustifiedTextSymbolIndex>=0?h.centerJustifiedTextSymbolIndex:h.leftJustifiedTextSymbolIndex>=0?h.leftJustifiedTextSymbolIndex:h.verticalPlacedTextSymbolIndex>=0?h.verticalPlacedTextSymbolIndex:_),T=CS(this.textSizeData,s,b)/Ya;return this.tilePixelRatio*T}getSymbolInstanceIconSize(s,h,p){const _=this.icon.placedSymbolArray.get(p),b=CS(this.iconSizeData,s,_);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(s,h,p,_){s.emplaceBack(h,-p,-p,_),s.emplaceBack(h,p,-p,_),s.emplaceBack(h,p,p,_),s.emplaceBack(h,-p,p,_)}_updateTextDebugCollisionBoxes(s,h,p,_,b,T){for(let I=_;I<b;I++){const L=p.get(I),k=this.getSymbolInstanceTextSize(s,T,h,I);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,L.padding,T.zOffset)}}_updateIconDebugCollisionBoxes(s,h,p,_,b,T){for(let I=_;I<b;I++){const L=p.get(I),k=this.getSymbolInstanceIconSize(s,h,T.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,L.padding,T.zOffset)}}updateCollisionDebugBuffers(s,h){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=Cm(this.iconSizeData,s),_=Cm(this.textSizeData,s);for(let b=0;b<this.symbolInstances.length;b++){const T=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(_,s,h,T.textBoxStartIndex,T.textBoxEndIndex,T),this._updateTextDebugCollisionBoxes(_,s,h,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._updateIconDebugCollisionBoxes(p,s,h,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._updateIconDebugCollisionBoxes(p,s,h,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,h,p,_,b,T,I,L,k){const F={};if(h<p){const{x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe,featureIndex:Re}=s.get(h);F.textBox={x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe},F.textFeatureIndex=Re}if(_<b){const{x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe,featureIndex:Re}=s.get(_);F.verticalTextBox={x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe},F.verticalTextFeatureIndex=Re}if(T<I){const{x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe,featureIndex:Re}=s.get(T);F.iconBox={x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe},F.iconFeatureIndex=Re}if(L<k){const{x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe,featureIndex:Re}=s.get(L);F.verticalIconBox={x1:N,y1:U,x2:Z,y2:Q,padding:ee,projectedAnchorX:ie,projectedAnchorY:oe,projectedAnchorZ:_e,tileAnchorX:Se,tileAnchorY:xe},F.verticalIconFeatureIndex=Re}return F}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(s,h){const p=s.placedSymbolArray.get(h),_=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<_;b+=4)s.indexArray.emplaceBack(b,b+1,b+2),s.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(s),p=Math.cos(s),_=[],b=[],T=[];for(let I=0;I<this.symbolInstances.length;++I){T.push(I);const L=this.symbolInstances.get(I);_.push(0|Math.round(h*L.tileAnchorX+p*L.tileAnchorY)),b.push(L.featureIndex)}return T.sort((I,L)=>_[I]-_[L]||b[L]-b[I]),T}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let s=0;s<this.symbolInstances.length;++s)this.symbolInstanceIndexesSortedZOffset.push(s)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((s,h)=>this.symbolInstances.get(h).zOffset-this.symbolInstances.get(s).zOffset)}addToSortKeyRanges(s,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:_,centerJustifiedTextSymbolIndex:b,leftJustifiedTextSymbolIndex:T,verticalPlacedTextSymbolIndex:I,placedIconSymbolIndex:L,verticalPlacedIconSymbolIndex:k}=p;_>=0&&this.addIndicesForPlacedSymbol(this.text,_),b>=0&&b!==_&&this.addIndicesForPlacedSymbol(this.text,b),T>=0&&T!==b&&T!==_&&this.addIndicesForPlacedSymbol(this.text,T),I>=0&&this.addIndicesForPlacedSymbol(this.text,I),L>=0&&this.addIndicesForPlacedSymbol(this.icon,L),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}gr(VS,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),VS.addDynamicAttributes=NS;const Xne=new Ze({"symbol-placement":new Ve(Me.layout_symbol["symbol-placement"]),"symbol-spacing":new Ve(Me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ve(Me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qe(Me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ve(Me.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ve(Me.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Ve(Me.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ve(Me.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ve(Me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ve(Me.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qe(Me.layout_symbol["icon-size"]),"icon-text-fit":new Qe(Me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qe(Me.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qe(Me.layout_symbol["icon-image"]),"icon-rotate":new Qe(Me.layout_symbol["icon-rotate"]),"icon-padding":new Ve(Me.layout_symbol["icon-padding"]),"icon-keep-upright":new Ve(Me.layout_symbol["icon-keep-upright"]),"icon-offset":new Qe(Me.layout_symbol["icon-offset"]),"icon-anchor":new Qe(Me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ve(Me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ve(Me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ve(Me.layout_symbol["text-rotation-alignment"]),"text-field":new Qe(Me.layout_symbol["text-field"]),"text-font":new Qe(Me.layout_symbol["text-font"]),"text-size":new Qe(Me.layout_symbol["text-size"]),"text-max-width":new Qe(Me.layout_symbol["text-max-width"]),"text-line-height":new Qe(Me.layout_symbol["text-line-height"]),"text-letter-spacing":new Qe(Me.layout_symbol["text-letter-spacing"]),"text-justify":new Qe(Me.layout_symbol["text-justify"]),"text-radial-offset":new Qe(Me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ve(Me.layout_symbol["text-variable-anchor"]),"text-anchor":new Qe(Me.layout_symbol["text-anchor"]),"text-max-angle":new Ve(Me.layout_symbol["text-max-angle"]),"text-writing-mode":new Ve(Me.layout_symbol["text-writing-mode"]),"text-rotate":new Qe(Me.layout_symbol["text-rotate"]),"text-padding":new Ve(Me.layout_symbol["text-padding"]),"text-keep-upright":new Ve(Me.layout_symbol["text-keep-upright"]),"text-transform":new Qe(Me.layout_symbol["text-transform"]),"text-offset":new Qe(Me.layout_symbol["text-offset"]),"text-allow-overlap":new Ve(Me.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ve(Me.layout_symbol["text-ignore-placement"]),"text-optional":new Ve(Me.layout_symbol["text-optional"]),visibility:new Ve(Me.layout_symbol.visibility)});var dD={paint:new Ze({"icon-opacity":new Qe(Me.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Qe(Me.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Qe(Me.paint_symbol["text-emissive-strength"]),"icon-color":new Qe(Me.paint_symbol["icon-color"]),"icon-halo-color":new Qe(Me.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qe(Me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qe(Me.paint_symbol["icon-halo-blur"]),"icon-translate":new Ve(Me.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ve(Me.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Qe(Me.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Qe(Me.paint_symbol["text-opacity"]),"text-color":new Qe(Me.paint_symbol["text-color"],{runtimeType:Ho,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Qe(Me.paint_symbol["text-halo-color"]),"text-halo-width":new Qe(Me.paint_symbol["text-halo-width"]),"text-halo-blur":new Qe(Me.paint_symbol["text-halo-blur"]),"text-translate":new Ve(Me.paint_symbol["text-translate"]),"text-translate-anchor":new Ve(Me.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ve(Me.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ve(Me.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ve(Me.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ve(Me.paint_symbol["icon-color-brightness-max"])}),layout:Xne};class YN{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:dn,this.defaultValue=s}evaluate(s){if(s.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(s.formattedSection))return h.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gr(YN,"FormatSectionOverride",{omit:["defaultValue"]});class GS extends sn{constructor(s,h,p){super(s,dD,h,p),this._colorAdjustmentMatrix=o.a9.identity([])}recalculate(s,h){super.recalculate(s,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const _=[];for(const b of p)_.indexOf(b)<0&&_.push(b);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(s,h,p,_){return this._saturation===s&&this._contrast===h&&this._brightnessMin===p&&this._brightnessMax===_||(this._colorAdjustmentMatrix=function(b,T,I,L){b=fw(b),T=ks(T);const k=o.a9.create(),F=b/3,N=1-2*F,U=[N,F,F,0,F,N,F,0,F,F,N,0,0,0,0,1],Z=.5-.5*T,Q=L-I;return o.a9.multiply(k,[Q,0,0,0,0,Q,0,0,0,0,Q,0,I,I,I,1],[T,0,0,0,0,T,0,0,0,0,T,0,Z,Z,Z,1]),o.a9.multiply(k,k,U),k}(s,h,p,_),this._saturation=s,this._contrast=h,this._brightnessMin=p,this._brightnessMax=_),this._colorAdjustmentMatrix}getValueAndResolveTokens(s,h,p,_){const b=this.layout.get(s).evaluate(h,{},p,_),T=this._unevaluatedLayout._values[s];return T.isDataDriven()||dm(T.value)||!b?b:function(I,L){return L.replace(/{([^{}]+)}/g,(k,F)=>F in I?String(I[F]):"")}(h.properties,b)}createBucket(s){return new VS(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of dD.paint.overridableProperties){if(!GS.hasPaintOverride(this.layout,s))continue;const h=this.paint.get(s),p=new YN(h),_=new fm(p,h.property.specification,this.scope,this.options);let b=null;b=h.value.kind==="constant"||h.value.kind==="source"?new fp("source",_):new dp("composite",_,h.value.zoomStops,h.value._interpolationType),this.paint._values[s]=new rt(h.property,b,h.parameters)}}_handleOverridablePaintPropertyUpdate(s,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&GS.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,h){const p=s.get("text-field"),_=dD.paint.properties[h];let b=!1;const T=I=>{for(const L of I)if(_.overrides&&_.overrides.hasOverride(L))return void(b=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Ha)T(p.value.value.sections);else if(p.value.kind==="source"){const I=k=>{b||(k instanceof al&&la(k.value)===Bh?T(k.value.sections):k instanceof Xd?T(k.sections):k.eachChild(I))},L=p.value;L._styleExpression&&I(L._styleExpression.expression)}return b}getProgramIds(){const s=this.paint.get("icon-opacity").constantOr(1)!==0,h=this.paint.get("text-opacity").constantOr(1)!==0,p=[];return s&&p.push("symbolIcon"),h&&p.push("symbolSDF"),p}getDefaultProgramParams(s,h){return{config:new bp(this,h),overrideFog:!1}}}const Qne=new Ze({visibility:new Ve(Me.layout_background.visibility)});var Kne={paint:new Ze({"background-color":new Ve(Me.paint_background["background-color"]),"background-pattern":new Ve(Me.paint_background["background-pattern"]),"background-opacity":new Ve(Me.paint_background["background-opacity"]),"background-emissive-strength":new Ve(Me.paint_background["background-emissive-strength"])}),layout:Qne};const Jne=new Ze({visibility:new Ve(Me.layout_raster.visibility)});var eie={paint:new Ze({"raster-opacity":new Ve(Me.paint_raster["raster-opacity"]),"raster-color":new kt(Me.paint_raster["raster-color"]),"raster-color-mix":new Ve(Me.paint_raster["raster-color-mix"]),"raster-color-range":new Ve(Me.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ve(Me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ve(Me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ve(Me.paint_raster["raster-brightness-max"]),"raster-saturation":new Ve(Me.paint_raster["raster-saturation"]),"raster-contrast":new Ve(Me.paint_raster["raster-contrast"]),"raster-resampling":new Ve(Me.paint_raster["raster-resampling"]),"raster-fade-duration":new Ve(Me.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ve(Me.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ve(Me.paint_raster["raster-array-band"]),"raster-elevation":new Ve(Me.paint_raster["raster-elevation"])}),layout:Jne},pD=Kr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class gD{constructor(s,h,p,_){this.context=s,this.format=p,this.texture=s.gl.createTexture(),this.update(h,_)}update(s,h,p){const{width:_,height:b}=s,{context:T}=this,{gl:I}=T;if(I.bindTexture(I.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!h||h.premultiply!==!1)),p||this.size&&this.size[0]===_&&this.size[1]===b){const{x:L,y:k}=p||{x:0,y:0};if(s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap)I.texSubImage2D(I.TEXTURE_2D,0,L,k,I.RGBA,I.UNSIGNED_BYTE,s);else{let F=this.format,N=I.UNSIGNED_BYTE;this.format===I.R32F&&(F=I.RED,N=I.FLOAT),I.texSubImage2D(I.TEXTURE_2D,0,L,k,_,b,F,N,s.data)}}else if(this.size=[_,b],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap){let L=this.format;this.format===I.R8&&(L=I.RED),I.texImage2D(I.TEXTURE_2D,0,this.format,L,I.UNSIGNED_BYTE,s)}else{let L=this.format,k=this.format,F=I.UNSIGNED_BYTE;this.format===I.DEPTH_COMPONENT&&(L=I.DEPTH_COMPONENT16,F=I.UNSIGNED_SHORT),this.format===I.R8&&(k=I.RED),this.format===I.R32F&&(F=I.FLOAT,k=I.RED),I.texImage2D(I.TEXTURE_2D,0,L,_,b,0,k,F,s.data)}this.useMipmap=!!(h&&h.useMipmap),this.useMipmap&&I.generateMipmap(I.TEXTURE_2D)}bind(s,h,p=!1){const{context:_}=this,{gl:b}=_;b.bindTexture(b.TEXTURE_2D,this.texture),s!==this.minFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,s),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,this.useMipmap&&!p?s===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),h!==this.wrapS&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,h),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,h),this.wrapS=h)}bindExtraParam(s,h,p,_){const{context:b}=this,{gl:T}=b;T.bindTexture(T.TEXTURE_2D,this.texture),h!==this.magFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,h),this.magFilter=h),s!==this.minFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,this.useMipmap?s===T.NEAREST?T.NEAREST_MIPMAP_NEAREST:T.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),p!==this.wrapS&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,p),this.wrapS=p),_!==this.wrapT&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,_),this.wrapT=_)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class US{constructor(s,h){this.context=s,this.texture=h}bind(s,h){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),s!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,s),this.minFilter=s),h!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,h),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,h),this.wrapS=h)}}function $S(u,s,h,p,_,b,T,I){const L=[u,s,1,h,p,1,_,b,1],k=[T,I,1],F=o.ct.adjoint([],L),[N,U,Z]=o.Q.transformMat3(k,k,F);return o.ct.multiply(L,L,[N,0,0,0,U,0,0,0,Z])}function XN(u,s,h,p,_,b,T,I){const L=function(k,F,N,U,Z,Q,ee,ie){const oe=$S(0,0,1,0,1,1,0,1),_e=$S(k,F,N,U,Z,Q,ee,ie),Se=o.ct.adjoint([],oe);return o.ct.multiply(_e,_e,Se)}(u,s,h,p,_,b,T,I);return[L[2]/L[8]/ir,L[5]/L[8]/ir]}function HS(u){return[u[0],Math.min(Math.max(u[1],-ta),ta)]}class QN extends Mc{constructor(s,h,p,_){super(),this.id=s,this.dispatcher=p,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(_),this.options=h,this._dirty=!1}load(s,h){if(this._loaded=h||!1,this.fire(new Eu("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return s&&(this.coordinates=s),this._loaded=!0,void this._finishLoading();this._imageRequest=Ny(this.map._requestManager.transformRequest(this.url,kv.Image),(p,_)=>{this._imageRequest=null,this._loaded=!0,p?this.fire(new $v(p)):_&&(this.image=_ instanceof HTMLImageElement?nl.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}setTexture(s){if(!(s.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new US(this.map.painter.context,s.handle),this.width=s.dimensions[0],this.height=s.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Eu("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof US||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(s){if(this.coordinates=s,this._boundsArray=void 0,this._unsupportedCoords=!1,!s.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let h=s[0][1],p=s[0][1];for(const b of s)b[1]>p&&(p=b[1]),b[1]<h&&(h=b[1]);const _=(p+h)/2;if(_>ta?this.onNorthPole=!0:_<-ta&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const b=s.map(oo.fromLngLat);this.tileID=function(T){let I=1/0,L=1/0,k=-1/0,F=-1/0;for(const ee of T)I=Math.min(I,ee.x),L=Math.min(L,ee.y),k=Math.max(k,ee.x),F=Math.max(F,ee.y);const N=Math.max(k-I,F-L),U=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),Z=Math.pow(2,U);let Q=Math.floor((I+k)/2*Z);return Q>1&&(Q-=1),new Sp(U,Q,Math.floor((L+F)/2*Z))}(b),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Eu("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(s){for(const oe in this.tiles){const _e=this.tiles[oe];_e.state!=="loaded"&&(_e.state="loaded",_e.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const h=G0(new Sp(0,0,0),this.map.transform.projection),p=[h.projection.project(this.coordinates[0][0],this.coordinates[0][1]),h.projection.project(this.coordinates[1][0],this.coordinates[1][1]),h.projection.project(this.coordinates[2][0],this.coordinates[2][1]),h.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(oe){const _e=oe[1].x-oe[0].x,Se=oe[1].y-oe[0].y,xe=oe[2].x-oe[1].x,Re=oe[2].y-oe[1].y,Te=oe[3].x-oe[2].x,Be=oe[3].y-oe[2].y,Ne=oe[0].x-oe[3].x,Xe=oe[0].y-oe[3].y,ft=_e*Re-xe*Se,Je=xe*Be-Te*Re,yt=Te*Xe-Ne*Be,_t=Ne*Se-_e*Xe;return ft>0&&Je>0&&yt>0&&_t>0||ft<0&&Je<0&&yt<0&&_t<0}(p))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const _=G0(this.tileID,this.map.transform.projection),[b,T,I,L]=this.coordinates.map(oe=>{const _e=_.projection.project(oe[0],oe[1]);return $N(_,_e)._round()});this.perspectiveTransform=XN(b.x,b.y,T.x,T.y,I.x,I.y,L.x,L.y);const k=this._boundsArray=new Za;k.emplaceBack(b.x,b.y,0,0),k.emplaceBack(T.x,T.y,ir,0),k.emplaceBack(L.x,L.y,0,ir),k.emplaceBack(I.x,I.y,ir,ir),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=s.createVertexBuffer(k,pD.members),this.boundsSegments=ea.simpleSegment(0,0,4,2);const F=[],N=[HS((U=this.coordinates)[0]),HS(U[1]),HS(U[2]),HS(U[3])];var U;const[Z,Q,ee,ie]=function(oe){let _e=oe[0][0],Se=_e,xe=oe[0][1],Re=xe;for(let Te=1;Te<oe.length;Te++)oe[Te][0]<_e?_e=oe[Te][0]:oe[Te][0]>Se&&(Se=oe[Te][0]),oe[Te][1]<xe?xe=oe[Te][1]:oe[Te][1]>Re&&(Re=oe[Te][1]);return[_e,xe,Se-_e,Re-xe]}(N);{const oe=new Za,[_e,Se,xe,Re]=function(zt){let Ot=zt[0].x,xt=Ot,mr=zt[0].y,fr=mr;for(let Gt=1;Gt<zt.length;Gt++)zt[Gt].x<Ot?Ot=zt[Gt].x:zt[Gt].x>xt&&(xt=zt[Gt].x),zt[Gt].y<mr?mr=zt[Gt].y:zt[Gt].y>fr&&(fr=zt[Gt].y);return[Ot,mr,xt-Ot,fr-mr]}(p),Te=zt=>[(zt.x-_e)/xe,(zt.y-Se)/Re],[Be,Ne,Xe,ft]=p.map(Te),Je=function(zt,Ot,xt,mr,fr,Gt,Rr,Sr){const _r=$S(0,0,1,0,1,1,0,1),$t=$S(zt,Ot,xt,mr,fr,Gt,Rr,Sr),Er=o.ct.adjoint([],$t);return o.ct.multiply(_r,_r,Er)}(Be[0],Be[1],Ne[0],Ne[1],Xe[0],Xe[1],ft[0],ft[1]);this.elevatedGlobePerspectiveTransform=XN(Be[0],Be[1],Ne[0],Ne[1],Xe[0],Xe[1],ft[0],ft[1]);const yt=(zt,Ot)=>{F.push(zt.lng);const xt=Math.round((zt.lng-Z)/ee*ir),mr=Math.round((zt.lat-Q)/ie*ir),fr=Te(Ot),Gt=o.Q.transformMat3([],[fr[0],fr[1],1],Je),Rr=Math.round(Gt[0]/Gt[2]*ir),Sr=Math.round(Gt[1]/Gt[2]*ir);oe.emplaceBack(xt,mr,Rr,Sr)},_t=p[3].x-p[0].x,dt=p[3].y-p[0].y,Pt=p[2].x-p[1].x,It=p[2].y-p[1].y;for(let zt=0;zt<65;zt++){const Ot=zt/64,xt=[p[0].x+Ot*_t,p[0].y+Ot*dt],mr=[p[1].x+Ot*Pt,p[1].y+Ot*It],fr=mr[0]-xt[0],Gt=mr[1]-xt[1];for(let Rr=0;Rr<65;Rr++){const Sr=Rr/64,_r={x:xt[0]+fr*Sr,y:xt[1]+Gt*Sr,z:0};yt(h.projection.unproject(_r.x,_r.y),_r)}}this.elevatedGlobeVertexBuffer=s.createVertexBuffer(oe,pD.members)}{this.maxLongitudeTriangleSize=0;let oe=[],_e=new ba;const Se=(xe,Re,Te)=>{_e.emplaceBack(xe,Re,Te);const Be=F[xe],Ne=F[Re],Xe=F[Te],ft=Math.min(Math.min(Be,Ne),Xe),Je=Math.max(Math.max(Be,Ne),Xe)-ft;Je>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Je),oe.push(ft+Je/2)};for(let xe=0;xe<64;xe++)for(let Re=0;Re<64;Re++){const Te=65*xe+Re,Be=Te+1,Ne=Te+65,Xe=Ne+1;Se(Te,Ne,Be),Se(Be,Ne,Xe)}[oe,_e]=function(xe,Re){const Te=Array.from({length:xe.length},(Xe,ft)=>ft);Te.sort((Xe,ft)=>xe[Xe]-xe[ft]);const Be=[],Ne=new ba;for(let Xe=0;Xe<Te.length;Xe++){const ft=Te[Xe];Be.push(xe[ft]);const Je=3*ft,yt=Je+1;Ne.emplaceBack(Re.uint16[Je],Re.uint16[yt],Re.uint16[yt+1])}return[Be,Ne]}(oe,_e),this.elevatedGlobeTrianglesCenterLongitudes=oe,this.elevatedGlobeIndexBuffer=s.createIndexBuffer(_e)}this.elevatedGlobeSegments=ea.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ee/ir,0,ie/ir,0,0,Q,Z,0])}prepare(){const s=Object.keys(this.tiles).length!==0;if(this.tileID&&!s)return;const h=this.map.painter.context,p=h.gl;!this._dirty||this.texture instanceof US||(this.texture?this.texture.update(this.image):(this.texture=new gD(h,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),s&&this._prepareData(h)}loadTile(s,h){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},h(null)):(s.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(s){const h=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!h)return null;const p=this.elevatedGlobeTrianglesCenterLongitudes;let _=((F,N)=>F+360*Math.round((N-F)/360))(s+180,p[0]);const b=new ea,T=(F,N)=>{b.segments.push({vertexOffset:0,primitiveOffset:F,vertexLength:h.segments[0].vertexLength,primitiveLength:N,sortKey:void 0,vaos:{}})},I=.51*this.maxLongitudeTriangleSize;if(Math.abs(p[0]-_)<=I){const F=ky(p,0,p.length,_+I);return F===p.length||T(F,Ac(p,F+1,p.length,_+360-I)-F),b}_<p[0]&&(_+=360);const L=Ac(p,0,p.length,_-I);if(L===p.length)return T(0,p.length),b;T(0,L-0);const k=ky(p,L+1,p.length,_+I);return k!==p.length&&T(k,p.length-k),b}}const tie=(Math.pow(256,2)-1)/16907520;class KN extends sn{constructor(s,h,p){super(s,eie,h,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(s){return!(s&&s._source instanceof QN&&(s._source.onNorthPole||s._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(s){s!=="raster-color"&&s!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(s){if(!this.hasColorMap()||!this._curRampRange)return;const h=this._transitionablePaint._values["raster-color"].value.expression,[p,_]=s||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(p)&&isNaN(_)||p===this._curRampRange[0]&&_===this._curRampRange[1]||(this.colorRamp=D0({expression:h,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:p,end:_}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[p,_])}}const rie=new Ze({visibility:new Ve(Me["layout_raster-particle"].visibility)});var nie={paint:new Ze({"raster-particle-array-band":new Ve(Me["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ve(Me["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new kt(Me["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ve(Me["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ve(Me["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ve(Me["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ve(Me["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:rie};class JN extends sn{constructor(s,h,p){super(s,nie,h,p),this._updateColorRamp(),this.lastInvalidatedAt=nl.now()}onRemove(s){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(s){return!1}_handleSpecialPaintPropertyUpdate(s){s!=="raster-particle-color"&&s!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),s==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const s=this._transitionablePaint._values["raster-particle-color"].value.expression,h=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=D0({expression:s,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:h}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=nl.now()}}class iie extends sn{constructor(s,h){super(s,{},h),this.implementation=s,s.slot&&(this.slot=s.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(s){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}const aie=new Ze({visibility:new Ve(Me.layout_sky.visibility)});var oie={paint:new Ze({"sky-type":new Ve(Me.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ve(Me.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ve(Me.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ve(Me.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ve(Me.paint_sky["sky-gradient-radius"]),"sky-gradient":new kt(Me.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ve(Me.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ve(Me.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ve(Me.paint_sky["sky-opacity"])}),layout:aie};function vD(u,s,h){const p=[0,0,1],_=o.bl.identity([]);return o.bl.rotateY(_,_,h?-On(u)+Math.PI:On(u)),o.bl.rotateX(_,_,-On(s)),o.Q.transformQuat(p,p,_),o.Q.normalize(p,p)}var sie={paint:new Ze({})};function e4(u,s){const h=jS(u.projection,u.zoom,u.width,u.height),p=function(b,T,I,L,k){const F=new Fn(I.lng-180*ff,I.lat),N=new Fn(I.lng+180*ff,I.lat),U=b.project(F.lng,F.lat),Z=b.project(N.lng,N.lat),Q=-Math.atan2(Z.y-U.y,Z.x-U.x),ee=oo.fromLngLat(I);ee.y=wn(ee.y,-1+ff,1-ff);const ie=ee.toLngLat(),oe=b.project(ie.lng,ie.lat),_e=oo.fromLngLat(ie);_e.x+=ff;const Se=_e.toLngLat(),xe=b.project(Se.lng,Se.lat),Re=n4(xe.x-oe.x,xe.y-oe.y,Q),Te=oo.fromLngLat(ie);Te.y+=ff;const Be=Te.toLngLat(),Ne=b.project(Be.lng,Be.lat),Xe=n4(Ne.x-oe.x,Ne.y-oe.y,Q),ft=Math.abs(Re.x)/Math.abs(Xe.y),Je=o.a9.identity([]);o.a9.rotateZ(Je,Je,-Q*(1-(k?0:L)));const yt=o.a9.identity([]);return o.a9.scale(yt,yt,[1,1-(1-ft)*L,1]),yt[4]=-Xe.x/Xe.y*L,o.a9.rotateZ(yt,yt,Q),o.a9.multiply(yt,Je,yt),yt}(u.projection,0,u.center,h,s),_=t4(u);return o.a9.scale(p,p,[_,_,1]),p}function t4(u){const s=u.projection,h=jS(u.projection,u.zoom,u.width,u.height),p=r4(s,u.center),_=r4(s,Fn.convert(s.center));return Math.pow(2,p*h+(1-h)*_)}function jS(u,s,h,p,_=1/0){const b=u.range;if(!b)return 0;const T=Math.min(_,Math.max(h,p)),I=Math.log(T/1024)/Math.LN2;return Pd(b[0]+I,b[1]+I,s)}const ff=1/4e4;function r4(u,s){const h=wn(s.lat,-ta,ta),p=new Fn(s.lng-180*ff,h),_=new Fn(s.lng+180*ff,h),b=u.project(p.lng,h),T=u.project(_.lng,h),I=oo.fromLngLat(p),L=oo.fromLngLat(_),k=T.x-b.x,F=T.y-b.y,N=L.x-I.x,U=L.y-I.y,Z=Math.sqrt((N*N+U*U)/(k*k+F*F));return Math.log(Z)/Math.LN2}function n4(u,s,h){const p=Math.cos(h),_=Math.sin(h);return{x:u*p-s*_,y:u*_+s*p}}function i4(u,s,h){o.a9.identity(u),o.a9.rotateZ(u,u,On(s[2])),o.a9.rotateX(u,u,On(s[0])),o.a9.rotateY(u,u,On(s[1])),o.a9.scale(u,u,h),o.a9.multiply(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function WS(u,s,h,p,_,b,T,I){const L=[h[0]-s[0],h[1]-s[1],0],k=[p[0]-s[0],p[1]-s[1],0];if(o.Q.length(L)<1e-12||o.Q.length(k)<1e-12)return o.bl.identity(u);const F=o.Q.cross([],L,k);o.Q.normalize(F,F),o.Q.subtract(k,p,s),L[2]=(b-_)*I,k[2]=(T-_)*I;const N=L;return o.Q.cross(N,L,k),o.Q.normalize(N,N),o.bl.rotationTo(u,F,N)}function mD(u,s,h=!1){const p=af(s.zoom),_=function(b,T,I){const L=T.worldSize,k=[b[12],b[13],b[14]],F=qa(k[1]/L),N=fs(k[0]/L),U=o.a9.identity([]),Z=Po(1,F)*L,Q=Po(1,0)*L*Tp(F,T.zoom),ee=1/GE(L);let ie=Q*ee;if(I){const xe=jS(T.projection,T.zoom,T.width,T.height,1024);ie=ee*T.projection.pixelSpaceConversion(T.center.lat,L,xe)}const oe=wp(F,N);o.Q.add(oe,oe,o.Q.scale([],o.Q.normalize([],oe),Z*ie*k[2]));const _e=function(xe){const Re=[xe[0],xe[1],xe[2]];let Te=[0,1,0];const Be=o.Q.cross([],Te,Re);return o.Q.cross(Te,Re,Be),o.Q.squaredLength(Te)===0&&(Te=[0,1,0],o.Q.cross(Be,Re,Te)),o.Q.normalize(Be,Be),o.Q.normalize(Te,Te),o.Q.normalize(Re,Re),[Be[0],Be[1],Be[2],0,Te[0],Te[1],Te[2],0,Re[0],Re[1],Re[2],0,xe[0],xe[1],xe[2],1]}(oe);o.a9.scale(U,U,[ie,ie,ie*Z]),o.a9.translate(U,U,[-k[0],-k[1],-k[2]]);const Se=o.a9.multiply([],T.globeMatrix,_e);return o.a9.multiply(Se,Se,U),o.a9.multiply(Se,Se,b),Se}(u,s,h);if(p>0){const b=function(T,I){const L=I.worldSize,k=Po(1,0)*L*Tp(I.center.lat,I.zoom)/GE(L),F=Po(1,I.center.lat)*L,N=o.a9.identity([]);return o.a9.rotateY(N,N,On(I.center.lng)),o.a9.rotateX(N,N,On(I.center.lat)),o.a9.translate(N,N,[0,0,Do]),o.a9.scale(N,N,[k,k,k*F]),o.a9.translate(N,N,[I.point.x-.5*L,I.point.y-.5*L,0]),o.a9.multiply(N,N,T),o.a9.multiply(N,I.globeMatrix,N)}(u,s);return function(T,I,L){const k=(Q,ee,ie)=>{const oe=o.Q.length(Q),_e=o.Q.length(ee),Se=Uc(Q,ee,ie);return o.Q.scale(Se,Se,1/o.Q.length(Se)*cn(oe,_e,ie))},F=k([T[0],T[1],T[2]],[I[0],I[1],I[2]],L),N=k([T[4],T[5],T[6]],[I[4],I[5],I[6]],L),U=k([T[8],T[9],T[10]],[I[8],I[9],I[10]],L),Z=Uc([T[12],T[13],T[14]],[I[12],I[13],I[14]],L);return[F[0],F[1],F[2],0,N[0],N[1],N[2],0,U[0],U[1],U[2],0,Z[0],Z[1],Z[2],1]}(_,b,p)}return _}function a4(u,s,h,p){const _=Li.projectAabbCorners(p,h);let b=Number.MAX_VALUE,T=-1;for(let k=0;k<_.length;++k){const F=_[k];F[0]=(.5*F[0]+.5)*s.width,F[1]=(.5-.5*F[1])*s.height,F[2]<b&&(T=k,b=F[2])}const I=k=>new nr(_[k][0],_[k][1]);let L;switch(T){case 0:case 6:L=[I(1),I(5),I(4),I(7),I(3),I(2),I(1)];break;case 1:case 7:L=[I(0),I(4),I(5),I(6),I(2),I(3),I(0)];break;case 3:case 5:L=[I(1),I(0),I(4),I(7),I(6),I(2),I(1)];break;default:L=[I(1),I(5),I(6),I(7),I(3),I(0),I(1)]}if(PE(u,L))return b}const lie=Kr([{name:"a_pos_3f",components:3,type:"Float32"}]),uie=Kr([{name:"a_color_3f",components:3,type:"Float32"}]),cie=Kr([{name:"a_color_4f",components:4,type:"Float32"}]),hie=Kr([{name:"a_uv_2f",components:2,type:"Float32"}]),fie=Kr([{name:"a_normal_3f",components:3,type:"Float32"}]),die=Kr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),pie=Kr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class ZS{constructor(s,h,p,_){this.message=(s?`${s}: `:"")+p,_&&(this.identifier=_),h!=null&&h.__line__&&(this.line=h.__line__)}}function o4(u,s){const h=u.indexOf("://")===-1;try{return new URL(u,h&&s?"http://example.com":void 0),!0}catch{return!1}}class s4{constructor(s,h){this.feature=s,this.instancedDataOffset=h,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class l4{constructor(){this.instancedDataArray=new vE,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class _D{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.fqid),this.projection=s.projection,this.index=s.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1}populate(s,h,p,_){this.tileToMeter=aS(p);const b=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:T,id:I,index:L,sourceLayerIndex:k}of s){const F=I??(T.properties&&T.properties.hasOwnProperty("id")?T.properties.id:void 0),N=nf(T,b);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),N,p))continue;const U={id:F,sourceLayerIndex:k,index:L,geometry:b?N.geometry:Gc(T,p,_),properties:T.properties,type:T.type,patterns:{}},Z=this.addFeature(U,U.geometry,N);Z&&h.featureIndex.insert(T,U.geometry,L,k,this.index,this.instancesPerModel[Z].instancedDataArray.length,ir/32)}this.lookup=null}update(s,h,p,_){for(const b in this.instancesPerModel){const T=this.instancesPerModel[b];for(const I in s)T.idToFeaturesIndex.hasOwnProperty(I)&&(this.evaluate(T.features[T.idToFeaturesIndex[I]],s[I],T,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let s=!1;for(const h in this.instancesPerModel){const p=this.instancesPerModel[h];for(const _ of p.features){const b=this.layers[0],T=_.feature,I=this.canonical,L=b.paint.get("model-rotation").evaluate(T,{},I),k=b.paint.get("model-scale").evaluate(T,{},I),F=b.paint.get("model-translation").evaluate(T,{},I);o.Q.exactEquals(_.rotation,L)&&o.Q.exactEquals(_.scale,k)&&o.Q.exactEquals(_.translation,F)||(this.evaluate(_,_.featureStates,p,!0),s=!0)}}return s}isEmpty(){for(const s in this.instancesPerModel)if(this.instancesPerModel[s].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(s){if(!this.uploaded)for(const h in this.instancesPerModel){const p=this.instancesPerModel[h];p.instancedDataArray.length<0||p.instancedDataArray.length===0||(p.instancedDataBuffer?p.instancedDataBuffer.updateData(p.instancedDataArray):p.instancedDataBuffer=s.createVertexBuffer(p.instancedDataArray,die.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const h in this.instancesPerModel){const p=this.instancesPerModel[h];p.instancedDataArray.length!==0&&p.instancedDataBuffer&&p.instancedDataBuffer.destroy()}const s=this.layers[0].modelManager;if(s&&this.modelUris)for(const h of this.modelUris)s.removeModel(h,"")}addFeature(s,h,p){const _=this.layers[0],b=_.layout.get("model-id").evaluate(p,{},this.canonical);if(!b)return Gi(`modelId is not evaluated for layer ${_.id} and it is not going to get rendered.`),b;o4(b,!1)&&(this.modelUris.includes(b)||this.modelUris.push(b)),this.instancesPerModel[b]||(this.instancesPerModel[b]=new l4);const T=this.instancesPerModel[b],I=T.instancedDataArray,L=new s4(p,I.length);for(const k of h)for(const F of k){if(F.x<0||F.x>=ir||F.y<0||F.y>=ir)continue;const N=(this.lookupDim-1)/ir,U=this.lookupDim*(F.y*N|0)+F.x*N|0;if(this.lookup){if(this.lookup[U]!==0)continue;this.lookup[U]=1}this.instanceCount++;const Z=I.length;I.resize(Z+1),T.instancesEvaluatedElevation.push(0),I.float32[16*Z]=F.x,I.float32[16*Z+1]=F.y}return L.instancedDataCount=T.instancedDataArray.length-L.instancedDataOffset,L.instancedDataCount>0&&(s.id&&(T.idToFeaturesIndex[s.id]=T.features.length),T.features.push(L),this.evaluate(L,{},T,!1)),b}getModelUris(){return this.modelUris}evaluate(s,h,p,_){const b=this.layers[0],T=s.feature,I=this.canonical,L=s.rotation=b.paint.get("model-rotation").evaluate(T,h,I),k=s.scale=b.paint.get("model-scale").evaluate(T,h,I),F=s.translation=b.paint.get("model-translation").evaluate(T,h,I),N=b.paint.get("model-color").evaluate(T,h,I);N.a=b.paint.get("model-color-mix-intensity").evaluate(T,h,I);const U=[];this.maxVerticalOffset<F[2]&&(this.maxVerticalOffset=F[2]),this.maxScale=Math.max(Math.max(this.maxScale,k[0]),Math.max(k[1],k[2])),i4(U,L,k);const Z=Math.round(100*N.a)+N.b/1.05;for(let Q=0;Q<s.instancedDataCount;++Q){const ee=s.instancedDataOffset+Q,ie=16*ee,oe=p.instancedDataArray.float32;let _e=0;_&&(_e=oe[ie+6]-p.instancesEvaluatedElevation[ee]);const Se=0|oe[ie+1];oe[ie]=(0|oe[ie])+N.r/1.05,oe[ie+1]=Se+N.g/1.05,oe[ie+2]=Z,oe[ie+3]=1/(I.z>10?this.tileToMeter:aS(I,Se)),oe[ie+4]=F[0],oe[ie+5]=F[1],oe[ie+6]=F[2]+_e,oe[ie+7]=U[0],oe[ie+8]=U[1],oe[ie+9]=U[2],oe[ie+10]=U[4],oe[ie+11]=U[5],oe[ie+12]=U[6],oe[ie+13]=U[8],oe[ie+14]=U[9],oe[ie+15]=U[10],p.instancesEvaluatedElevation[ee]=F[2]}}}gr(_D,"ModelBucket",{omit:["layers"]}),gr(l4,"PerModelAttributes"),gr(s4,"ModelFeature");const gie=new Ze({visibility:new Ve(Me.layout_model.visibility),"model-id":new Qe(Me.layout_model["model-id"])});var vie={paint:new Ze({"model-opacity":new Ve(Me.paint_model["model-opacity"]),"model-rotation":new Qe(Me.paint_model["model-rotation"]),"model-scale":new Qe(Me.paint_model["model-scale"]),"model-translation":new Qe(Me.paint_model["model-translation"]),"model-color":new Qe(Me.paint_model["model-color"]),"model-color-mix-intensity":new Qe(Me.paint_model["model-color-mix-intensity"]),"model-type":new Ve(Me.paint_model["model-type"]),"model-cast-shadows":new Ve(Me.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ve(Me.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ve(Me.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Qe(Me.paint_model["model-emissive-strength"]),"model-roughness":new Qe(Me.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Qe(Me.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ve(Me.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ve(Me.paint_model["model-front-cutoff"])}),layout:gie};const Mp=64,km={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function u4(u,s,h,p,_,b,T,I,L,k=!1){const F=h.zoom,N=h.project(p),U=Tp(p.lat,F),Z=1/U;o.a9.identity(u),o.a9.translate(u,u,[N.x+T[0]*Z,N.y+T[1]*Z,T[2]]);let Q=1,ee=1;const ie=h.worldSize;if(k){if(h.projection.name==="mercator"){let xe=0;h.elevation&&(xe=h.elevation.getAtPointOrZero(new oo(N.x/ie,N.y/ie),0));const Re=o.aa.transformMat4([],[N.x,N.y,xe,1],h.projMatrix)[3]/h.cameraToCenterDistance;Q=Re,ee=Re*Tp(h.center.lat,F)}else if(h.projection.name==="globe"){const xe=mD(u,h),Re=o.a9.multiply([],h.projMatrix,xe),Te=[0,0,0,1];o.aa.transformMat4(Te,Te,Re);const Be=Te[3]/h.cameraToCenterDistance,Ne=af(F),Xe=h.projection.pixelsPerMeter(p.lat,ie)*Tp(p.lat,F),ft=h.projection.pixelsPerMeter(h.center.lat,ie)*Tp(h.center.lat,F);Q=Be/cn(Xe,X5(h.center.lat),Ne),ee=Be*U/Xe,Q*=ft,ee*=ft}}else Q=Z;o.a9.scale(u,u,[Q,Q,ee]);const oe=[...u],_e=s.orientation,Se=[];if(i4(Se,[_e[0]+_[0],_e[1]+_[1],_e[2]+_[2]],b),o.a9.multiply(u,oe,Se),I&&h.elevation){let xe=0;const Re=[];if(L&&h.elevation){xe=function(Ne,Xe,ft,Je,yt){const _t=Xe.elevation;if(!_t)return 0;const dt=Li.projectAabbCorners(ft,Je),Pt=Po(1,yt.lat)*Xe.worldSize,It=function(Er,Jr){const Br=[0,0,1],an=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const en of an){const mn=Er[en.corners[0]],Or=Er[en.corners[1]],ci=Er[en.corners[2]],si=[Or[0]-mn[0],Or[1]-mn[1],Jr*(Or[2]-mn[2])],Gn=o.Q.cross(si,si,[ci[0]-mn[0],ci[1]-mn[1],Jr*(ci[2]-mn[2])]);o.Q.normalize(Gn,Gn),en.dotProductWithUp=o.Q.dot(Gn,Br)}return an.sort((en,mn)=>en.dotProductWithUp-mn.dotProductWithUp),an[0].corners}(dt,Pt),zt=dt[It[0]],Ot=dt[It[1]],xt=dt[It[2]],mr=dt[It[3]],fr=_t.getAtPointOrZero(new oo(zt[0]/Xe.worldSize,zt[1]/Xe.worldSize),0),Gt=_t.getAtPointOrZero(new oo(Ot[0]/Xe.worldSize,Ot[1]/Xe.worldSize),0),Rr=_t.getAtPointOrZero(new oo(xt[0]/Xe.worldSize,xt[1]/Xe.worldSize),0),Sr=_t.getAtPointOrZero(new oo(mr[0]/Xe.worldSize,mr[1]/Xe.worldSize),0),_r=(fr+Sr)/2,$t=(Gt+Rr)/2;return _r>$t?Gt<Rr?WS(Ne,Ot,mr,zt,Gt,Sr,fr,Pt):WS(Ne,xt,zt,mr,Rr,fr,Sr,Pt):fr<Sr?WS(Ne,zt,Ot,xt,fr,Gt,Rr,Pt):WS(Ne,mr,xt,Ot,Sr,Rr,Gt,Pt),Math.max(_r,$t)}(Re,h,s.aabb,u,p);const Te=o.a9.fromQuat([],Re),Be=o.a9.multiply([],Te,Se);o.a9.multiply(u,oe,Be)}else xe=h.elevation.getAtPointOrZero(new oo(N.x/ie,N.y/ie),0);xe!==0&&(u[14]+=xe)}}function W0(u,s,h=!1){u.uploaded||(u.gfxTexture=new gD(s,u.image,h?s.gl.R8:s.gl.RGBA,{useMipmap:u.sampler.minFilter>=s.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function mie(u,s,h){u.indexBuffer=s.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=s.createVertexBuffer(u.vertexArray,lie.members,!1,!0),u.normalArray&&(u.normalBuffer=s.createVertexBuffer(u.normalArray,fie.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=s.createVertexBuffer(u.texcoordArray,hie.members,!1,!0)),u.colorArray&&(u.colorBuffer=s.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?uie:cie).members,!1,!0)),u.featureArray&&(u.pbrBuffer=s.createVertexBuffer(u.featureArray,pie.members,!0)),u.segments=ea.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const p=u.material;p.pbrMetallicRoughness.baseColorTexture&&W0(p.pbrMetallicRoughness.baseColorTexture,s),p.pbrMetallicRoughness.metallicRoughnessTexture&&W0(p.pbrMetallicRoughness.metallicRoughnessTexture,s),p.normalTexture&&W0(p.normalTexture,s),p.occlusionTexture&&W0(p.occlusionTexture,s,h),p.emissionTexture&&W0(p.emissionTexture,s)}function yD(u,s,h){if(u.meshes)for(const p of u.meshes)mie(p,s,h);if(u.children)for(const p of u.children)yD(p,s,h)}function qS(u){if(u.meshes)for(const s of u.meshes)s.indexArray.destroy(),s.vertexArray.destroy(),s.colorArray&&s.colorArray.destroy(),s.normalArray&&s.normalArray.destroy(),s.texcoordArray&&s.texcoordArray.destroy(),s.featureArray&&s.featureArray.destroy();if(u.children)for(const s of u.children)qS(s)}function xD(u){if(u.meshes)for(const h of u.meshes)h.vertexBuffer&&(h.vertexBuffer.destroy(),h.indexBuffer.destroy(),h.normalBuffer&&h.normalBuffer.destroy(),h.texcoordBuffer&&h.texcoordBuffer.destroy(),h.colorBuffer&&h.colorBuffer.destroy(),h.pbrBuffer&&h.pbrBuffer.destroy(),h.segments.destroy(),h.material&&((s=h.material).pbrMetallicRoughness.baseColorTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),s.pbrMetallicRoughness.metallicRoughnessTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),s.normalTexture&&s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.destroy(),s.emissionTexture&&s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.destroy(),s.occlusionTexture&&s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.destroy()));var s;if(u.children)for(const h of u.children)xD(h)}class _ie{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class yie{constructor(){this.tasks={},this.taskQueue=[],Py(["process"],this),this.invoker=new _ie(this.process),this.nextId=0}add(s,h){const p=this.nextId++,_=function({type:b,isSymbolTile:T,zoom:I}){return I=I||0,b==="message"?0:b!=="maybePrepare"||T?b!=="parseTile"||T?b==="parseTile"&&T?300-I:b==="maybePrepare"&&T?400-I:500:200-I:100-I}(h);if(_===0){Hl();try{s()}finally{}return null}return this.tasks[p]={fn:s,metadata:h,priority:_,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){Hl();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const h=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!h)return;h.fn()}finally{}}pick(){let s=null,h=1/0;for(let _=0;_<this.taskQueue.length;_++){const b=this.tasks[this.taskQueue[_]];b.priority<h&&(h=b.priority,s=_)}if(s===null)return null;const p=this.taskQueue[s];return this.taskQueue.splice(s,1),p}remove(){this.invoker.remove()}}class c4{constructor(s,h,p){this.target=s,this.parent=h,this.mapId=p,this.callbacks={},this.cancelCallbacks={},Py(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new yie}send(s,h,p,_,b=!1,T){const I=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(p.metadata=T,this.callbacks[I]=p);const L=new Set;return this.target.postMessage({id:I,type:s,hasCallback:!!p,targetMapId:_,mustQueue:b,sourceMapId:this.mapId,data:gp(h,L)},L),{cancel:()=>{p&&delete this.callbacks[I],this.target.postMessage({id:I,type:"<cancel>",targetMapId:_,sourceMapId:this.mapId})}}}receive(s){const h=s.data,p=h.id;if(p&&(!h.targetMapId||this.mapId===h.targetMapId))if(h.type==="<cancel>"){const _=this.cancelCallbacks[p];delete this.cancelCallbacks[p],_&&_.cancel()}else if(h.mustQueue||Hl()){const _=this.callbacks[p],b=this.scheduler.add(()=>this.processTask(p,h),_&&_.metadata||{type:"message"});b&&(this.cancelCallbacks[p]=b)}else this.processTask(p,h)}processTask(s,h){if(delete this.cancelCallbacks[s],h.type==="<response>"){const p=this.callbacks[s];delete this.callbacks[s],p&&(h.error?p(w(h.error)):p(null,w(h.data)))}else{const p=new Set,_=h.hasCallback?(T,I)=>{this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:T?gp(T):null,data:gp(I,p)},p)}:T=>{},b=w(h.data);if(this.parent[h.type])this.parent[h.type](h.sourceMapId,b,_);else if(this.parent.getWorkerSource){const T=h.type.split(".");this.parent.getWorkerSource(h.sourceMapId,T[0],b.source,b.scope)[T[1]](b,_)}else _(new Error(`Could not find function ${h.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Om{constructor(s,h){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=Zn();const p=this.workerPool.acquire(this.id);for(let _=0;_<p.length;_++){const b=new Om.Actor(p[_],h,this.id);b.name=`Worker ${_}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,h,p){Ey(this.actors,(_,b)=>{_.send(s,h,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}Om.Actor=c4;var Z0={workerUrl:"",workerClass:null,workerParams:void 0};function xie(){return Z0.workerClass!=null?new Z0.workerClass:new self.Worker(Z0.workerUrl,Z0.workerParams)}const bD="mapboxgl_preloaded_worker_pool";class q0{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<q0.workerCount;)this.workers.push(new xie);return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.workers&&this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[bD]}numActive(){return Object.keys(this.active).length}}let Y0;function YS(){return Y0||(Y0=new q0),Y0}q0.workerCount=2;let XS,wD,Jl,zm,SD,Bm=null;function h4(){return Hl()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:wD||m.DRACO_URL}function f4(){if(Hl()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(zm)return zm;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return zm=WebAssembly.validate(u)?m.MESHOPT_SIMD_URL:m.MESHOPT_URL,zm}const QS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},bie={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},X0={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function d4(u,s,h){const p=h.json.bufferViews.length,_=h.buffers.length;s.bufferView=p,h.json.bufferViews[p]={buffer:_,byteLength:u.byteLength},h.buffers[_]=u}const TD="KHR_draco_mesh_compression";function wie(u,s){const h=u.extensions&&u.extensions[TD];if(!h)return;const p=new Jl.Decoder,_=m4(s,h.bufferView),b=new Jl.Mesh;if(!p.DecodeArrayToMesh(_,_.byteLength,b))throw new Error("Failed to decode Draco mesh");const T=s.json.accessors[u.indices],I=QS[T.componentType],L=T.count*I.BYTES_PER_ELEMENT,k=Jl._malloc(L);I===Uint16Array?p.GetTrianglesUInt16Array(b,L,k):p.GetTrianglesUInt32Array(b,L,k),d4(Jl.memory.buffer.slice(k,k+L),T,s),Jl._free(k);for(const F of Object.keys(h.attributes)){const N=p.GetAttributeByUniqueId(b,h.attributes[F]),U=s.json.accessors[u.attributes[F]],Z=bie[U.componentType],Q=U.count*X0[U.type]*QS[U.componentType].BYTES_PER_ELEMENT,ee=Jl._malloc(Q);p.GetAttributeDataArrayForAllPoints(b,N,Jl[Z],Q,ee),d4(Jl.memory.buffer.slice(ee,ee+Q),U,s),Jl._free(ee)}p.destroy(),b.destroy(),delete u.extensions[TD]}const KS="EXT_meshopt_compression";function Sie(u,s){if(!u.extensions||!u.extensions[KS])return;const h=u.extensions[KS],p=new Uint8Array(s.buffers[h.buffer],h.byteOffset||0,h.byteLength||0),_=new Uint8Array(h.count*h.byteStride);SD.decodeGltfBuffer(_,h.count,h.byteStride,p,h.mode,h.filter),u.buffer=s.buffers.length,u.byteOffset=0,s.buffers[u.buffer]=_.buffer,delete u.extensions[KS]}const p4=1179937895,g4=new TextDecoder("utf8");function v4(u,s){return new URL(u,s).href}function Tie(u,s,h,p){return fetch(v4(u.uri,p)).then(_=>_.arrayBuffer()).then(_=>{s.buffers[h]=_})}function m4(u,s){const h=u.json.bufferViews[s];return new Uint8Array(u.buffers[h.buffer],h.byteOffset||0,h.byteLength)}function Aie(u,s,h,p){if(u.uri){const _=v4(u.uri,p);return fetch(_).then(b=>b.blob()).then(b=>createImageBitmap(b)).then(b=>{s.images[h]=b})}if(u.bufferView!==void 0){const _=m4(s,u.bufferView),b=new Blob([_],{type:u.mimeType});return createImageBitmap(b).then(T=>{s.images[h]=T})}}function _4(u,s=0,h){const p={json:null,images:[],buffers:[]};if(new Uint32Array(u,s,1)[0]===p4){const F=new Uint32Array(u,s);let N=2;const U=(F[N++]>>2)-3,Z=F[N++]>>2;if(N++,p.json=JSON.parse(g4.decode(F.subarray(N,N+Z))),N+=Z,N<U){const Q=F[N++];N++;const ee=s+(N<<2);p.buffers[0]=u.slice(ee,ee+Q)}}else p.json=JSON.parse(g4.decode(new Uint8Array(u,s)));const{buffers:_,images:b,meshes:T,extensionsUsed:I,bufferViews:L}=p.json;let k=Promise.resolve();if(_){const F=[];for(let N=0;N<_.length;N++){const U=_[N];U.uri?F.push(Tie(U,p,N,h)):p.buffers[N]||(p.buffers[N]=null)}k=Promise.all(F)}return k.then(()=>{const F=[],N=I&&I.includes(TD),U=I&&I.includes(KS);if(N&&F.push(function(){if(!Jl)return XS||(XS=function(Z){let Q,ee=null;function ie(){Q=new Uint8Array(ee.buffer)}function oe(){throw new Error("Unexpected Draco error.")}const _e={a:{a:oe,d:function(Se,xe,Re){return Q.copyWithin(Se,xe,xe+Re)},c:function(Se){const xe=Q.length,Re=Math.max(Se>>>0,Math.ceil(1.2*xe)),Te=Math.ceil((Re-xe)/65536);try{return ee.grow(Te),ie(),!0}catch{return!1}},b:oe}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(Z,_e):Z.then(Se=>Se.arrayBuffer()).then(Se=>WebAssembly.instantiate(Se,_e))).then(Se=>{const{Rb:xe,Qb:Re,P:Te,T:Be,X:Ne,Ja:Xe,La:ft,Qa:Je,Va:yt,Wa:_t,eb:dt,jb:Pt,f:It,e:zt,yb:Ot,zb:xt,Ab:mr,Bb:fr,Db:Gt,Gb:Rr}=Se.instance.exports;ee=zt;const Sr=(()=>{let _r=0,$t=0,Er=0,Jr=0;return Br=>{Er&&(xe(Jr),xe(_r),$t+=Er,Er=_r=0),_r||($t+=128,_r=Re($t));const an=Br.length+7&-8;let en=_r;an>=$t&&(Er=an,en=Jr=Re(an));for(let mn=0;mn<Br.length;mn++)Q[en+mn]=Br[mn];return en}})();return ie(),It(),{memory:zt,_free:xe,_malloc:Re,Mesh:class{constructor(){this.ptr=Te()}destroy(){Be(this.ptr)}},Decoder:class{constructor(){this.ptr=Xe()}destroy(){Pt(this.ptr)}DecodeArrayToMesh(_r,$t,Er){const Jr=Sr(_r),Br=ft(this.ptr,Jr,$t,Er.ptr);return!!Ne(Br)}GetAttributeByUniqueId(_r,$t){return{ptr:Je(this.ptr,_r.ptr,$t)}}GetTrianglesUInt16Array(_r,$t,Er){yt(this.ptr,_r.ptr,$t,Er)}GetTrianglesUInt32Array(_r,$t,Er){_t(this.ptr,_r.ptr,$t,Er)}GetAttributeDataArrayForAllPoints(_r,$t,Er,Jr,Br){dt(this.ptr,_r.ptr,$t.ptr,Er,Jr,Br)}},DT_INT8:Ot(),DT_UINT8:xt(),DT_INT16:mr(),DT_UINT16:fr(),DT_UINT32:Gt(),DT_FLOAT32:Rr()}})}(fetch(h4())),XS.then(Z=>{Jl=Z,XS=void 0}))}()),U&&F.push(function(){if(SD)return;const Z=function(Q){let ee;const ie=WebAssembly.instantiateStreaming(Q,{}).then(Se=>{ee=Se.instance,ee.exports.__wasm_call_ctors()}),oe={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},_e={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ie,supported:!0,decodeGltfBuffer(Se,xe,Re,Te,Be,Ne){(function(Xe,ft,Je,yt,_t,dt,Pt){const It=Xe.exports.sbrk,zt=yt+3&-4,Ot=It(zt*_t),xt=It(dt.length),mr=new Uint8Array(Xe.exports.memory.buffer);mr.set(dt,xt);const fr=ft(Ot,yt,_t,xt,dt.length);if(fr===0&&Pt&&Pt(Ot,zt,_t),Je.set(mr.subarray(Ot,Ot+yt*_t)),It(Ot-It(0)),fr!==0)throw new Error(`Malformed buffer data: ${fr}`)})(ee,ee.exports[_e[Be]],Se,xe,Re,Te,ee.exports[oe[Ne]])}}}(fetch(f4()));return Z.ready.then(()=>{SD=Z})}()),b)for(let Z=0;Z<b.length;Z++)F.push(Aie(b[Z],p,Z,h));return(F.length?Promise.all(F):Promise.resolve()).then(()=>{if(N&&T)for(const{primitives:Z}of T)for(const Q of Z)wie(Q,p);if(U&&T&&L)for(const Z of L)Sie(Z,p);return p})})}class y4{constructor(s,h,p,_){if(this.triangleCount=h.length/3,this.min=new nr(0,0),this.max=new nr(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||s.length===0)return;const[b,T]=[s[0].clone(),s[0].clone()];for(let N=1;N<s.length;++N){const U=s[N];b.x=Math.min(b.x,U.x),b.y=Math.min(b.y,U.y),T.x=Math.max(T.x,U.x),T.y=Math.max(T.y,U.y)}if(_){const N=Math.ceil(Math.max(T.x-b.x,T.y-b.y)/_);p=Math.max(p,N)}if(p===0)return;this.min=b,this.max=T;const I=this.max.sub(this.min);I.x=Math.max(I.x,1),I.y=Math.max(I.y,1);const L=Math.max(I.x,I.y)/p;this.cellsX=Math.max(1,Math.ceil(I.x/L)),this.cellsY=Math.max(1,Math.ceil(I.y/L)),this.xScale=1/L,this.yScale=1/L;const k=[];for(let N=0;N<this.triangleCount;N++){const U=s[h[3*N+0]].sub(this.min),Z=s[h[3*N+1]].sub(this.min),Q=s[h[3*N+2]].sub(this.min),ee=df(Math.floor(Math.min(U.x,Z.x,Q.x)),this.xScale,this.cellsX),ie=df(Math.floor(Math.max(U.x,Z.x,Q.x)),this.xScale,this.cellsX),oe=df(Math.floor(Math.min(U.y,Z.y,Q.y)),this.yScale,this.cellsY),_e=df(Math.floor(Math.max(U.y,Z.y,Q.y)),this.yScale,this.cellsY),Se=new nr(0,0),xe=new nr(0,0),Re=new nr(0,0),Te=new nr(0,0);for(let Be=oe;Be<=_e;++Be){Se.y=xe.y=Be*L,Re.y=Te.y=(Be+1)*L;for(let Ne=ee;Ne<=ie;++Ne)Se.x=Re.x=Ne*L,xe.x=Te.x=(Ne+1)*L,(kE(U,Z,Q,Se,xe,Te)||kE(U,Z,Q,Se,Te,Re))&&k.push({cellIdx:Be*this.cellsX+Ne,triIdx:N})}}if(k.length===0)return;k.sort((N,U)=>N.cellIdx-U.cellIdx||N.triIdx-U.triIdx);let F=0;for(;F<k.length;){const N=k[F].cellIdx,U={start:this.payload.length,len:0};for(;F<k.length&&k[F].cellIdx===N;)++U.len,this.payload.push(k[F++].triIdx);this.cells[N]=U}}query(s,h,p){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>h.x||s.y>this.max.y||this.min.y>h.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let L=0;L<this.lookup.length;L++)this.lookup[L]=0;const _=df(s.x-this.min.x,this.xScale,this.cellsX),b=df(h.x-this.min.x,this.xScale,this.cellsX),T=df(s.y-this.min.y,this.yScale,this.cellsY),I=df(h.y-this.min.y,this.yScale,this.cellsY);for(let L=T;L<=I;L++)for(let k=_;k<=b;k++){const F=this.cells[L*this.cellsX+k];if(F)for(let N=0;N<F.len;N++){const U=this.payload[F.start+N],Z=Math.floor(U/8),Q=1<<U%8;if(!(this.lookup[Z]&Q)&&(this.lookup[Z]|=Q,p.push(U),p.length===this.triangleCount))return}}}}function df(u,s,h){return Math.max(0,Math.min(h-1,Math.floor(u*s)))}function Ip(u,s){const h=u.json.bufferViews[s.bufferView],p=QS[s.componentType];return new p(u.buffers[h.buffer],(s.byteOffset||0)+(h.byteOffset||0),s.count*(h.byteStride&&h.byteStride!==X0[s.type]*p.BYTES_PER_ELEMENT?h.byteStride/p.BYTES_PER_ELEMENT:X0[s.type]))}function AD(u,s,h,p){const _=QS[s.componentType],b=function(F){switch(F){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(_),T=u.json.bufferViews[s.bufferView],I=T.byteStride?T.byteStride/_.BYTES_PER_ELEMENT:X0[s.type],L=h.float32,k=L.length/h.capacity;for(let F=0,N=0;F<s.count*I;F+=I,N+=k)for(let U=0;U<k;U++)L[N+U]=p[F+U]*b;h._trim()}function Cie(u,s,h){const p=u.indices,_=u.attributes,b={};b.indexArray=new ba;const T=s.json.accessors[p],I=T.count/3;b.indexArray.reserve(I);const L=Ip(s,T);for(let U=0;U<I;U++)b.indexArray.emplaceBack(L[3*U],L[3*U+1],L[3*U+2]);b.indexArray._trim(),b.vertexArray=new xp;const k=s.json.accessors[_.POSITION];b.vertexArray.reserve(k.count);const F=Ip(s,k);for(let U=0;U<k.count;U++)b.vertexArray.emplaceBack(F[3*U],F[3*U+1],F[3*U+2]);if(b.vertexArray._trim(),b.aabb=new Li(k.min,k.max),b.centroid=function(U,Z){const Q=[0,0,0],ee=U.length;if(ee>0){for(let ie=0;ie<ee;ie++){const oe=3*U[ie];Q[0]+=Z[oe],Q[1]+=Z[oe+1],Q[2]+=Z[oe+2]}Q[0]/=ee,Q[1]/=ee,Q[2]/=ee}return Q}(L,F),_.COLOR_0!==void 0){const U=s.json.accessors[_.COLOR_0],Z=X0[U.type],Q=Ip(s,U);b.colorArray=Z===3?new xp:new xa,b.colorArray.resize(U.count),AD(s,U,b.colorArray,Q)}if(_.NORMAL!==void 0){b.normalArray=new xp;const U=s.json.accessors[_.NORMAL];b.normalArray.resize(U.count);const Z=Ip(s,U);AD(s,U,b.normalArray,Z)}if(_.TEXCOORD_0!==void 0&&h.length>0){b.texcoordArray=new Pa;const U=s.json.accessors[_.TEXCOORD_0];b.texcoordArray.resize(U.count);const Z=Ip(s,U);AD(s,U,b.texcoordArray,Z)}if(_._FEATURE_ID_RGBA4444!==void 0){const U=s.json.accessors[_._FEATURE_ID_RGBA4444];s.json.extensionsUsed&&s.json.extensionsUsed.includes("EXT_meshopt_compression")&&(b.featureData=Ip(s,U))}_._FEATURE_RGBA4444!==void 0&&(b.featureData=new Uint32Array(Ip(s,s.json.accessors[_._FEATURE_RGBA4444]).buffer));const N=u.material;return b.material=function(U,Z){const{emissiveFactor:Q=[0,0,0],alphaMode:ee="OPAQUE",alphaCutoff:ie=.5,normalTexture:oe,occlusionTexture:_e,emissiveTexture:Se,doubleSided:xe}=U,{baseColorFactor:Re=[1,1,1,1],metallicFactor:Te=1,roughnessFactor:Be=1,baseColorTexture:Ne,metallicRoughnessTexture:Xe}=U.pbrMetallicRoughness||{},ft=_e?Z[_e.index]:void 0;if(_e&&_e.extensions&&_e.extensions.KHR_texture_transform&&ft){const Je=_e.extensions.KHR_texture_transform;ft.offsetScale=[Je.offset[0],Je.offset[1],Je.scale[0],Je.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Jn(...Re),metallicFactor:Te,roughnessFactor:Be,baseColorTexture:Ne?Z[Ne.index]:void 0,metallicRoughnessTexture:Xe?Z[Xe.index]:void 0},doubleSided:xe,emissiveFactor:Q,alphaMode:ee,alphaCutoff:ie,normalTexture:oe?Z[oe.index]:void 0,occlusionTexture:ft,emissionTexture:Se?Z[Se.index]:void 0,defined:U.defined===void 0}}(N!==void 0?s.json.materials[N]:{defined:!1},h),b}function x4(u,s,h){const{matrix:p,rotation:_,translation:b,scale:T,mesh:I,extras:L,children:k}=u,F={};if(F.matrix=p||o.a9.fromRotationTranslationScale([],_||[0,0,0,1],b||[0,0,0],T||[1,1,1]),I!==void 0){F.meshes=h[I];const N=F.anchor=[0,0];for(const U of F.meshes){const{min:Z,max:Q}=U.aabb;N[0]+=Z[0]+Q[0],N[1]+=Z[1]+Q[1]}N[0]=Math.floor(N[0]/F.meshes.length/2),N[1]=Math.floor(N[1]/F.meshes.length/2)}if(L&&(L.id&&(F.id=L.id),L.lights&&(F.lights=function(N){if(!N.length)return[];const U=function(oe){const _e=atob(oe),Se=new Uint8Array(_e.length);for(let xe=0;xe<_e.length;xe++)Se[xe]=_e.codePointAt(xe);return Se}(N),Z=[],Q=U.length/24,ee=new Uint16Array(U.buffer),ie=new Float32Array(U.buffer);for(let oe=0;oe<Q;oe++){const _e=ee[2*oe*6]/30,Se=ee[2*oe*6+1]/30,xe=ee[2*oe*6+10]/100,Re=ie[6*oe+1],Te=ie[6*oe+2],Be=ie[6*oe+3],Ne=ie[6*oe+4],Xe=Be-Re,ft=Ne-Te,Je=Math.hypot(Xe,ft);Z.push({pos:[Re+.5*Xe,Te+.5*ft,Se],normal:[ft/Je,-Xe/Je,0],width:Je,height:_e,depth:xe,points:[Re,Te,Be,Ne]})}return Z}(L.lights))),k){const N=[];for(const U of k)N.push(x4(s.json.nodes[U],s,h));F.children=N}return F}function Mie(u){if(u.vertices.length===0||u.indices.length===0)return null;const s=new y4(u.vertices,u.indices,8,256),[h,p]=[s.min.clone(),s.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:s,min:h,max:p}}function Iie(u){if(!u.extras||!u.extras.ground)return null;const s=u.extras.ground;if(!s||!Array.isArray(s)||s.length===0)return null;const h=s[0];if(!h||!Array.isArray(h)||h.length===0)return null;const p=[];for(const T of h){if(!Array.isArray(T)||T.length!==2)continue;const I=T[0],L=T[1];typeof I=="number"&&typeof L=="number"&&p.push(new nr(I,L))}if(p.length<3)return null;p.length>1&&p[p.length-1].equals(p[0])&&p.pop();let _=0;for(let T=0;T<p.length;T++){const I=p[T],L=p[(T+1)%p.length],k=p[(T+2)%p.length];_+=(I.x-L.x)*(k.y-L.y)-(k.x-L.x)*(I.y-L.y)}_>0&&p.reverse();const b=_S(p.flatMap(T=>[T.x,T.y]),[]);return b.length===0?null:{vertices:p,indices:b}}function Eie(u,s){const h=[],p=[];let _=0;const b=[];for(const T of u){_=h.length;const I=T.vertexArray.float32,L=T.indexArray.uint16;for(let k=0;k<T.vertexArray.length;k++)b[0]=I[3*k+0],b[1]=I[3*k+1],b[2]=I[3*k+2],o.Q.transformMat4(b,b,s),h.push(new nr(b[0],b[1]));for(let k=0;k<3*T.indexArray.length;k++)p.push(L[k]+_)}if(p.length%3!=0)return null;for(let T=0;T<p.length;T+=3){const I=h[p[T+0]],L=h[p[T+1]],k=h[p[T+2]];(I.x-L.x)*(k.y-L.y)-(k.x-L.x)*(I.y-L.y)>0&&([p[T+1],p[T+2]]=[p[T+2],p[T+1]])}return{vertices:h,indices:p}}function b4(u){const s=function(L,k){const F=[],N=WebGL2RenderingContext;if(L.json.textures)for(const U of L.json.textures){const Z={magFilter:N.LINEAR,minFilter:N.NEAREST,wrapS:N.REPEAT,wrapT:N.REPEAT};U.sampler!==void 0&&Object.assign(Z,L.json.samplers[U.sampler]),F.push({image:k[U.source],sampler:Z,uploaded:!1})}return F}(u,u.images),h=function(L,k){const F=[];for(const N of L.json.meshes){const U=[];for(const Z of N.primitives)U.push(Cie(Z,L,k));F.push(U)}return F}(u,s),{scenes:p,scene:_,nodes:b}=u.json,T=p?p[_||0].nodes:b,I=[];for(const L of T)I.push(x4(b[L],u,h));return function(L,k,F){const N={},U=new Set;for(let Z=0;Z<L.length;Z++){const Q=F[k[Z]];if(!Q.extras)continue;const ee=Q.extras["mapbox:footprint:version"],ie=Q.extras["mapbox:footprint:id"];(ee||ie)&&U.add(Z),ee==="1.0.0"&&ie&&(N[ie]=Z)}for(let Z=0;Z<L.length;Z++){if(U.has(Z))continue;const Q=L[Z],ee=F[k[Z]];if(!ee.extras)continue;let ie=null;Q.id in N&&(ie=Eie(L[N[Q.id]].meshes,Q.matrix)),ie||(ie=Iie(ee)),ie&&(Q.footprint=Mie(ie))}if(U.size>0){const Z=Array.from(U.values()).sort((Q,ee)=>Q-ee);for(let Q=Z.length-1;Q>=0;Q--)L.splice(Z[Q],1)}}(I,T,u.json.nodes),I}function Die(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const s=u.vertexArray.float32,h=u.aabb.min[0]-1,p=u.aabb.min[1]-1,_=Mp/(u.aabb.max[0]-h+2),b=Mp/(u.aabb.max[1]-p+2);for(let T=0;T<s.length;T+=3){const I=s[T+2],L=(s[T+0]-h)*_|0,k=(s[T+1]-p)*b|0;I>u.heightmap[k*Mp+L]&&(u.heightmap[k*Mp+L]=I)}}function Pie(u,s){const h={};h.indexArray=new ba,h.indexArray.reserve(4*u.length),h.vertexArray=new xp,h.vertexArray.reserve(10*u.length),h.colorArray=new xa,h.vertexArray.reserve(10*u.length);let p=0;for(const T of u){const I=Math.min(10,Math.max(4,1.3*T.height))*s,L=[-T.normal[1],T.normal[0],0],k=Math.min(.29,.1*T.width/T.depth),F=T.width-2*T.depth*s*(k+.01),N=o.Q.scaleAndAdd([],T.pos,L,F/2),U=o.Q.scaleAndAdd([],T.pos,L,-F/2),Z=[N[0],N[1],N[2]+T.height],Q=[U[0],U[1],U[2]+T.height],ee=o.Q.scaleAndAdd([],T.normal,L,k);o.Q.scale(ee,ee,I);const ie=o.Q.scaleAndAdd([],T.normal,L,-k);o.Q.scale(ie,ie,I),o.Q.add(ee,N,ee),o.Q.add(ie,U,ie),N[2]+=.1,U[2]+=.1,h.vertexArray.emplaceBack(ee[0],ee[1],ee[2]),h.vertexArray.emplaceBack(ie[0],ie[1],ie[2]),h.vertexArray.emplaceBack(N[0],N[1],N[2]),h.vertexArray.emplaceBack(U[0],U[1],U[2]),h.vertexArray.emplaceBack(Z[0],Z[1],Z[2]),h.vertexArray.emplaceBack(Q[0],Q[1],Q[2]),h.vertexArray.emplaceBack(N[0],N[1],N[2]),h.vertexArray.emplaceBack(U[0],U[1],U[2]),h.vertexArray.emplaceBack(ee[0],ee[1],ee[2]),h.vertexArray.emplaceBack(ie[0],ie[1],ie[2]);const oe=F/I/2;h.colorArray.emplaceBack(-oe-k,-1,oe,.8),h.colorArray.emplaceBack(oe+k,-1,oe,.8),h.colorArray.emplaceBack(-oe,0,oe,1.3),h.colorArray.emplaceBack(oe,0,oe,1.3),h.colorArray.emplaceBack(oe+k,-.8,oe,.7),h.colorArray.emplaceBack(oe+k,-.8,oe,.7),h.colorArray.emplaceBack(0,0,oe,1.3),h.colorArray.emplaceBack(0,0,oe,1.3),h.colorArray.emplaceBack(oe+k,-1.2,oe,.8),h.colorArray.emplaceBack(oe+k,-1.2,oe,.8),h.indexArray.emplaceBack(6+p,4+p,8+p),h.indexArray.emplaceBack(7+p,9+p,5+p),h.indexArray.emplaceBack(0+p,1+p,2+p),h.indexArray.emplaceBack(1+p,3+p,2+p),p+=10}const _={defined:!0,emissiveFactor:[0,0,0]},b={};return b.baseColorFactor=Jn.white,_.pbrMetallicRoughness=b,h.material=_,h.aabb=new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),h}gr(y4,"TriangleGridIndex");class w4{constructor(s){this._stringToNumber={},this._numberToString=[];for(let h=0;h<s.length;h++){const p=s[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const Lie=["tile","layer","source","sourceLayer","state"];class S4{constructor(s,h,p,_,b){this.type="Feature",this._vectorTileFeature=s,this._z=h,this._x=p,this._y=_,this.properties=s.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(s.id=this.id);for(const h of Lie)this[h]!==void 0&&(s[h]=this[h]);return s}}class T4{constructor(s,h){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Xh(ir,16,0),this.featureIndexArray=new N5,this.promoteId=h,this.is3DTile=!1}insert(s,h,p,_,b,T=0,I=0){const L=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,_,b,T);const k=this.grid;for(let F=0;F<h.length;F++){const N=h[F],U=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<N.length;Z++){const Q=N[Z];U[0]=Math.min(U[0],Q.x),U[1]=Math.min(U[1],Q.y),U[2]=Math.max(U[2],Q.x),U[3]=Math.max(U[3],Q.y)}I!==0&&(U[0]-=I,U[1]-=I,U[2]+=I,U[3]+=I),U[0]<ir&&U[1]<ir&&U[2]>=0&&U[3]>=0&&k.insert(L,U[0],U[1],U[2],U[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new KE(new Em(this.rawTileData)).layers,this.sourceLayerCoder=new w4(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,h,p,_){this.loadVTLayers();const b=s.params||{},T=lr(b.filter),I=s.tileResult,L=s.transform,k=I.bufferedTilespaceBounds,F=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(Q,ee,ie,oe)=>nF(I.bufferedTilespaceGeometry,Q,ee,ie,oe));F.sort(Rie);let N=null;L.elevation&&F.length>0&&(N=Tm.create(L.elevation,this.tileID));const U={};let Z;for(let Q=0;Q<F.length;Q++){const ee=F[Q];if(ee===Z)continue;Z=ee;const ie=this.featureIndexArray.get(ee);let oe=null;if(this.is3DTile){const _e=this.bucketLayerIDs[0][0],Se=h[_e];if(Se.type!=="model")continue;const{queryFeature:xe,intersectionZ:Re}=Se.queryIntersectsMatchingFeature(I,ie.featureIndex,T,L);xe&&this.appendToResult(U,_e,ie.featureIndex,xe,Re)}else this.loadMatchingFeature(U,ie,T,b.layers,b.availableImages,h,p,_,(_e,Se,xe,Re=0)=>(oe||(oe=Gc(_e,this.tileID.canonical,s.tileTransform)),Se.queryIntersectsFeature(I,_e,xe,oe,this.z,s.transform,s.pixelPosMatrix,N,Re)))}return U}loadMatchingFeature(s,h,p,_,b,T,I,L,k){const{featureIndex:F,bucketIndex:N,sourceLayerIndex:U,layoutVertexArrayOffset:Z}=h,Q=this.bucketLayerIDs[N];if(_&&!function(_e,Se){for(let xe=0;xe<_e.length;xe++)if(Se.indexOf(_e[xe])>=0)return!0;return!1}(_,Q))return;const ee=this.sourceLayerCoder.decode(U),ie=this.vtLayers[ee].feature(F);if(p.needGeometry){const _e=nf(ie,!0);if(!p.filter(new he(this.tileID.overscaledZ),_e,this.tileID.canonical))return}else if(!p.filter(new he(this.tileID.overscaledZ),ie))return;const oe=this.getId(ie,ee);for(let _e=0;_e<Q.length;_e++){const Se=Q[_e];if(_&&_.indexOf(Se)<0)continue;const xe=T[Se];if(!xe)continue;let Re={};oe!==void 0&&L&&(Re=L.getState(xe.sourceLayer||"_geojsonTileLayer",oe));const Te=!k||k(ie,xe,Re,Z);if(!Te)continue;const Be=new S4(ie,this.z,this.x,this.y,oe),Ne=us({},I[Se]);Ne.paint=A4(Ne.paint,xe.paint,ie,Re,b),Ne.layout=A4(Ne.layout,xe.layout,ie,Re,b),Be.layer=Ne,this.appendToResult(s,Se,F,Be,Te)}}appendToResult(s,h,p,_,b){let T=s[h];T===void 0&&(T=s[h]=[]),T.push({featureIndex:p,feature:_,intersectionZ:b})}lookupSymbolFeatures(s,h,p,_,b,T,I,L){const k={};this.loadVTLayers();const F=lr(b);for(const N of s)this.loadMatchingFeature(k,{bucketIndex:p,sourceLayerIndex:_,featureIndex:N,layoutVertexArrayOffset:0},F,T,I,L,h);return k}loadFeature(s){const{featureIndex:h,sourceLayerIndex:p}=s;this.loadVTLayers();const _=this.sourceLayerCoder.decode(p),b=this.vtFeatures[_];if(b[h])return b[h];const T=this.vtLayers[_].feature(h);return b[h]=T,T}hasLayer(s){for(const h of this.bucketLayerIDs)for(const p of h)if(s===p)return!0;return!1}getId(s,h){let p=s.id;if(this.promoteId){const _=typeof this.promoteId=="string"?this.promoteId:this.promoteId[h];_!=null&&(p=s.properties[_]),typeof p=="boolean"&&(p=Number(p))}return p}}function A4(u,s,h,p,_){return Ih(u,(b,T)=>{const I=s instanceof st?s.get(T):null;return I&&I.evaluate?I.evaluate(h,p,_):I})}function Rie(u,s){return s-u}gr(T4,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const CD=new Float32Array(262144),Ep=new Uint8Array(262144);function C4(u){let s=0;if(u.meshes)for(const h of u.meshes)s=Math.max(s,h.aabb.max[2]);if(u.children)for(const h of u.children)s=Math.max(s,C4(h));return s}function M4(u,s,h){if(u.meshes)for(const p of u.meshes)p.aabb.min[0]!==1/0&&h.insert(s,p.aabb.min[0],p.aabb.min[1],p.aabb.max[0],p.aabb.max[1]);if(u.children)for(const p of u.children)M4(p,s,h)}const I4=["","wall","door","roof","window","lamp","logo"];class E4{constructor(s){this.node=s,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:s.id,geometry:[],properties:{height:C4(s)}}}getLocalBounds(){if(!this.node.meshes)return new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let s=0;const h=new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const p of this.node.meshes)this.node.lightMeshIndex!==s&&h.encapsulate(p.aabb),s++;this.aabb=Li.applyTransform(h,this.node.matrix)}return this.aabb}}class JS{constructor(s,h,p,_,b,T){this.id=h,this.modelTraits|=km.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=km.HasMapboxMeshFeatures),_&&(this.modelTraits|=km.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=b,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const I of s)this.nodesInfo.push(new E4(I)),M4(I,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0)}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(s){if(!this.needsUpload)return;const h=this.getNodesInfo();for(const p of h){const _=p.node;this.uploaded?this.updatePbrBuffer(_):yD(_,s,!0)}for(const p of h)qS(p.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(s){let h=!1;if(!s.meshes)return h;for(const p of s.meshes)p.pbrBuffer&&(p.pbrBuffer.updateData(p.featureArray),h=!0);return h}needsReEvaluation(s,h,p){const _=s.transform.projectionOptions,b=s.style.getBrightness(),T=this.brightness!==b;return!!(!this.uploaded||this.dirty||_.name!==this.projection.name||Q0(p.paint.get("model-color").value,T)||Q0(p.paint.get("model-color-mix-intensity").value,T)||Q0(p.paint.get("model-roughness").value,T)||Q0(p.paint.get("model-emissive-strength").value,T)||Q0(p.paint.get("model-height-based-emissive-strength-multiplier").value,T))&&(this.projection=_,this.brightness=b,!0)}evaluateScale(s,h){if(s.transform.zoom===this.zoom)return;this.zoom=s.transform.zoom;const p=this.getNodesInfo(),_=this.id.canonical;for(const b of p){const T=b.feature;b.evaluatedScale=h.paint.get("model-scale").evaluate(T,{},_)}}evaluate(s){const h=this.getNodesInfo();for(const p of h){if(!p.node.meshes)continue;const _=p.feature,b=p.node.meshes&&p.node.meshes[0].featureData,T=p.evaluatedColor[2],I=p.evaluatedRMEA[2],L=this.id.canonical;if(p.hasTranslucentParts=!1,b){for(let k=0;k<I4.length;k++){const F=I4[k];F.length&&(_.properties.part=F);const N=s.paint.get("model-color").evaluate(_,{},L),U=s.paint.get("model-color-mix-intensity").evaluate(_,{},L);p.evaluatedColor[k]=[N.r,N.g,N.b,U],p.evaluatedRMEA[k][0]=s.paint.get("model-roughness").evaluate(_,{},L),p.evaluatedRMEA[k][2]=s.paint.get("model-emissive-strength").evaluate(_,{},L),p.evaluatedRMEA[k][3]=N.a,p.emissionHeightBasedParams[k]=s.paint.get("model-height-based-emissive-strength-multiplier").evaluate(_,{},L),!p.hasTranslucentParts&&N.a<1&&(p.hasTranslucentParts=!0)}delete _.properties.part,Oie(p,T!==p.evaluatedColor[2]||I!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=s.paint.get("model-emissive-strength").evaluate(_,{},L);p.evaluatedScale=s.paint.get("model-scale").evaluate(_,{},L),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(s,h,p,_){const b=s.findDEMTileFor(p);if(b&&(b.tileID.canonical!==this.terrainTile||h!==this.terrainExaggeration)){if(b.dem&&b.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=b.tileID.overscaledZ;const T=Tm.create(s,p,b);if(!T)return;this.modelTraits&km.HasMapboxMeshFeatures&&this.updateDEM(s,T,p,_);for(const I of this.getNodesInfo()){const L=I.node;if(!L.footprint||!L.footprint.vertices||!L.footprint.vertices.length)continue;const k=L.footprint.vertices;let F=T.getElevationAt(k[0].x,k[0].y,!0,!0);for(let N=1;N<k.length;N++)F=Math.min(F,T.getElevationAt(k[N].x,k[N].y,!0,!0));L.elevation=F}}this.terrainTile=b.tileID.canonical,this.terrainExaggeration=h}}updateDEM(s,h,p,_){let b=h._dem._modifiedForSources[_];if(b===void 0&&(h._dem._modifiedForSources[_]=[],b=h._dem._modifiedForSources[_]),b.includes(p.canonical))return;const T=h._dem.dim;b.push(p.canonical);let I=!1;for(const L of this.getNodesInfo()){const k=L.node;if(!k.footprint||!k.footprint.grid)continue;const F=k.footprint.grid,N=h.tileCoordToPixel(F.min.x,F.min.y),U=h.tileCoordToPixel(F.max.x,F.max.y),Z=Math.min(Math.min(T-U.y,N.x),Math.min(N.y,T-U.x));if(Z<0)continue;const Q=wn(Z,2,5);let ee=Math.max(0,N.x-Q),ie=Math.max(0,N.y-Q),oe=Math.min(U.x+Q,T-1),_e=Math.min(U.y+Q,T-1);for(let Te=ie;Te<=_e;++Te)for(let Be=ee;Be<=oe;++Be)Ep[Te*T+Be]=255;let Se=0,xe=0;for(let Te=0;Te<F.cellsY;++Te)for(let Be=0;Be<F.cellsX;++Be){if(!F.cells[Te*F.cellsX+Be])continue;const Ne=h.tileCoordToPixel(F.min.x+Be/F.xScale,F.min.y+Te/F.yScale),Xe=h.tileCoordToPixel(F.min.x+(Be+1)/F.xScale,F.min.y+(Te+1)/F.yScale);for(let ft=Ne.y;ft<=Math.min(Xe.y+1,T-1);++ft)for(let Je=Ne.x;Je<=Math.min(Xe.x+1,T-1);++Je)Ep[ft*T+Je]===255&&(Ep[ft*T+Je]=0,Se+=h.getElevationAtPixel(Je,ft),xe++)}const Re=Se/xe;ee=Math.max(1,N.x-Q),ie=Math.max(1,N.y-Q),oe=Math.min(U.x+Q,T-2),_e=Math.min(U.y+Q,T-2),I=!0;for(let Te=ie;Te<=_e;++Te)for(let Be=ee;Be<=oe;++Be)Ep[Te*T+Be]===0&&(CD[Te*T+Be]=h._dem.set(Be,Te,Re));for(let Te=1;Te<Q;++Te){ee=Math.max(1,N.x-Te),ie=Math.max(1,N.y-Te),oe=Math.min(U.x+Te,T-2),_e=Math.min(U.y+Te,T-2);for(let Be=ie;Be<=_e;++Be)for(let Ne=ee;Ne<=oe;++Ne){const Xe=Be*T+Ne;if(Ep[Xe]===255){let ft=0,Je=0,yt=-1,_t=-1;for(let dt=-1;dt<=1;++dt)for(let Pt=-1;Pt<=1;++Pt){const It=(Be+dt)*T+Ne+Pt;if(Ep[It]>=Te)continue;const zt=CD[It],Ot=Math.abs(zt);Ot>Je&&(ft=zt,Je=Ot,yt=Pt,_t=dt)}if(Je>.1){const dt=1-(Te+.5*Math.abs(yt*_t))/Q;let Pt=h._dem.get(Ne,Be)+ft*dt;const It=h._dem.get(Ne+yt,Be+_t),zt=h._dem.get(Ne-yt,Be-_t,!0);(Pt-It)*(Pt-zt)>0&&(Pt=(It+zt)/2),CD[Xe]=h._dem.set(Ne,Be,Pt),Ep[Xe]=Te}}}}}I&&(h._demTile.needsDEMTextureUpload=!0,h._dem._timestamp=nl.now())}getNodesInfo(){return this.nodesInfo}destroy(){const s=this.getNodesInfo();for(const h of s)qS(h.node),xD(h.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(s,h){if(h.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=h.updateTime;const p=h.getReplacementRegionsForTile(s.toUnwrapped()),_=this.getNodesInfo();for(let b=0;b<this.nodesInfo.length;b++){const T=_[b].node;_[b].hiddenByReplacement=!!T.footprint&&!p.find(I=>I.footprint===T.footprint)}}getHeightAtTileCoord(s,h){const p=this.getNodesInfo(),_=[],b=[0,0,0];for(let T=0;T<this.nodesInfo.length;T++){const I=p[T],L=I.node.meshes[0],k=Li.applyTransform(L.aabb,I.node.matrix);if(s<k.min[0]||h<k.min[1]||s>k.max[0]||h>k.max[1])continue;const F=(s-L.aabb.min[0])/(L.aabb.max[0]-L.aabb.min[0])*Mp|0,N=Math.min(63,(h-L.aabb.min[1])/(L.aabb.max[1]-L.aabb.min[1])*Mp|0)*Mp+Math.min(63,F);if(b[2]=L.heightmap[N],o.Q.transformMat4(b,b,I.node.matrix),!(L.heightmap[N]<0&&I.node.footprint))return I.hiddenByReplacement?void 0:{height:b[2],maxHeight:I.feature.properties.height,hidden:!1,verticalScale:I.evaluatedScale[2]};if(I.node.footprint.grid.query(new nr(s,h),new nr(s,h),_),_.length>0)return{height:void 0,maxHeight:I.feature.properties.height,hidden:I.hiddenByReplacement,verticalScale:I.evaluatedScale[2]}}}}function Q0(u,s){return!u.isLightConstant&&s}function kie(u,s,h,p,_,b,T,I){let L=(61440&s|(61440&s)>>4)>>8,k=(3840&s|(3840&s)>>4)>>4,F=240&s|(240&s)>>4;h[3]>0&&(L=cn(L,255*h[0],h[3]),k=cn(k,255*h[1],h[3]),F=cn(F,255*h[2],h[3]));const N=L<<8|k,U=F<<8|Math.floor(255*p[3]),Z=function(Te){const Be=wn(Te,0,2);return Math.min(Math.round(.5*Be*255),255)}(p[2])<<8|15*p[0]<<4|15*p[1],Q=wn(_[0],0,1),ee=wn(_[1],0,1),ie=wn(_[2],0,1),oe=wn(_[3],0,1);let _e,Se,xe,Re;if(Q!==ee&&T!==b&&ee!==Q){const Te=T-b;Se=1/(Te*(ee-Q)),xe=-(b+Te*Q)/(Te*(ee-Q));const Be=wn(_[4],-1,1);Re=Math.pow(10,Be),_e=255*ie<<8|255*oe}else _e=65535,Se=0,xe=1,Re=1;if(u.emplaceBack(N,U,Z,_e,Se,xe,Re),I){const Te=I.length;I.clear();for(let Be=0;Be<Te;Be++)I.emplaceBack(N,U,Z,_e,Se,xe,Re)}}function Oie(u,s,h){const p=u.node;let _=0;const b=h&km.HasMeshoptCompression;for(const T of p.meshes){if(p.lights&&p.lightMeshIndex===_||!T.featureData)continue;T.featureArray=new rS,T.featureArray.reserve(T.featureData.length);let I=s;for(const L of T.featureData){const k=b?65535&L:L>>16&65535,F=b?L>>16&65535:65535&L,N=(15&F)<8?15&F:0,U=u.evaluatedRMEA[N],Z=u.evaluatedColor[N],Q=u.emissionHeightBasedParams[N];let ee;if(I&&N===2&&p.lights&&(ee=new rS,ee.resize(10*p.lights.length)),kie(T.featureArray,k,Z,U,Q,T.aabb.min[2],T.aabb.max[2],ee),ee&&I){I=!1;const ie=p.meshes[p.lightMeshIndex];ie.featureArray=ee,ie.featureArray._trim()}}T.featureArray._trim(),_++}}function D4(u,s,h,p){const _=1<<u.z;s.lat=qa((p/ir+u.y)/_),s.lng=fs((h/ir+u.x)/_)}gr(JS,"Tiled3dModelBucket",{omit:["layers"]}),gr(E4,"Tiled3dModelFeature");const zie={circle:class extends sn{constructor(u,s,h){super(u,Hte,s,h)}createBucket(u){return new DE(u)}queryRadius(u){const s=u;return bm("circle-radius",this,s)+bm("circle-stroke-width",this,s)+lS(this.paint.get("circle-translate"))}queryIntersectsFeature(u,s,h,p,_,b,T,I){const L=aF(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(s,h)+this.paint.get("circle-stroke-width").evaluate(s,h);return yF(u,p,b,T,I,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",L,k)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,s){const h=_F(this);return{config:new bp(this,s),defines:h,overrideFog:!1}}},heatmap:class extends sn{createBucket(u){return new bF(u)}constructor(u,s,h){super(u,rre,s,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=D0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return bm("heatmap-radius",this,u)}queryIntersectsFeature(u,s,h,p,_,b,T,I){const L=this.paint.get("heatmap-radius").evaluate(s,h);return yF(u,p,b,T,I,!0,!0,new nr(0,0),L)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,s){return u==="heatmap"?{config:new bp(this,s),overrideFog:!1}:{}}},hillshade:class extends sn{constructor(u,s,h){super(u,ire,s,h)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,s){return{overrideFog:!1}}},fill:class extends sn{constructor(u,s,h){super(u,_re,s,h)}getProgramIds(){const u=this.paint.get("fill-pattern"),s=u&&u.constantOr(1),h=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&h.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),h}getDefaultProgramParams(u,s){return{config:new bp(this,s),overrideFog:!1}}recalculate(u,s){super.recalculate(u,s);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new QE(u)}queryRadius(){return lS(this.paint.get("fill-translate"))}queryIntersectsFeature(u,s,h,p,_,b){return!u.queryGeometry.isAboveHorizon&&eF(iF(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends sn{constructor(u,s,h){super(u,Wre,s,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new AS(u)}queryRadius(){return lS(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,s,h,p,_,b,T,I,L){const k=aF(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),F=this.paint.get("fill-extrusion-height").evaluate(s,h),N=this.paint.get("fill-extrusion-base").evaluate(s,h),U=[0,0],Z=I&&b.elevation,Q=b.elevation?b.elevation.exaggeration():1,ee=u.tile.getBucket(this);if(Z&&ee instanceof AS){const xe=ee.centroidVertexArray,Re=L+1;Re<xe.length&&(U[0]=xe.geta_centroid_pos0(Re),U[1]=xe.geta_centroid_pos1(Re))}if(U[0]===0&&U[1]===1)return!1;b.projection.name==="globe"&&(p=rN([p],[new nr(0,0),new nr(ir,ir)],u.tileID.canonical).map(xe=>xe.polygon).flat());const ie=Z?I:null,[oe,_e]=function(xe,Re,Te,Be,Ne,Xe,ft,Je,yt,_t,dt){return xe.projection.name==="globe"?function(Pt,It,zt,Ot,xt,mr,fr,Gt,Rr,Sr,_r){const $t=[],Er=[],Jr=Pt.projection.upVectorScale(_r,Pt.center.lat,Pt.worldSize).metersToTile,Br=[0,0,0,1],an=[0,0,0,1],en=(Or,ci,si,Gn)=>{Or[0]=ci,Or[1]=si,Or[2]=Gn,Or[3]=1},mn=tN();zt>0&&(zt+=mn),Ot+=mn;for(const Or of It){const ci=[],si=[];for(const Gn of Or){const Ln=Gn.x+xt.x,Un=Gn.y+xt.y,Ai=Pt.projection.projectTilePoint(Ln,Un,_r),gi=Pt.projection.upVector(_r,Gn.x,Gn.y);let Ui=zt,Bi=Ot;if(fr){const so=iN(Ln,Un,zt,Ot,fr,Gt,Rr,Sr);Ui+=so.base,Bi+=so.top}zt!==0?en(Br,Ai.x+gi[0]*Jr*Ui,Ai.y+gi[1]*Jr*Ui,Ai.z+gi[2]*Jr*Ui):en(Br,Ai.x,Ai.y,Ai.z),en(an,Ai.x+gi[0]*Jr*Bi,Ai.y+gi[1]*Jr*Bi,Ai.z+gi[2]*Jr*Bi),o.Q.transformMat4(Br,Br,mr),o.Q.transformMat4(an,an,mr),ci.push(new Am(Br[0],Br[1],Br[2])),si.push(new Am(an[0],an[1],an[2]))}$t.push(ci),Er.push(si)}return[$t,Er]}(xe,Re,Te,Be,Ne,Xe,ft,Je,yt,_t,dt):ft?function(Pt,It,zt,Ot,xt,mr,fr,Gt,Rr){const Sr=[],_r=[],$t=[0,0,0,1];for(const Er of Pt){const Jr=[],Br=[];for(const an of Er){const en=an.x+Ot.x,mn=an.y+Ot.y,Or=iN(en,mn,It,zt,mr,fr,Gt,Rr);$t[0]=en,$t[1]=mn,$t[2]=Or.base,$t[3]=1,o.aa.transformMat4($t,$t,xt),$t[3]=Math.max($t[3],1e-5);const ci=new Am($t[0]/$t[3],$t[1]/$t[3],$t[2]/$t[3]);$t[0]=en,$t[1]=mn,$t[2]=Or.top,$t[3]=1,o.aa.transformMat4($t,$t,xt),$t[3]=Math.max($t[3],1e-5);const si=new Am($t[0]/$t[3],$t[1]/$t[3],$t[2]/$t[3]);Jr.push(ci),Br.push(si)}Sr.push(Jr),_r.push(Br)}return[Sr,_r]}(Re,Te,Be,Ne,Xe,ft,Je,yt,_t):function(Pt,It,zt,Ot,xt){const mr=[],fr=[],Gt=xt[8]*It,Rr=xt[9]*It,Sr=xt[10]*It,_r=xt[11]*It,$t=xt[8]*zt,Er=xt[9]*zt,Jr=xt[10]*zt,Br=xt[11]*zt;for(const an of Pt){const en=[],mn=[];for(const Or of an){const ci=Or.x+Ot.x,si=Or.y+Ot.y,Gn=xt[0]*ci+xt[4]*si+xt[12],Ln=xt[1]*ci+xt[5]*si+xt[13],Un=xt[2]*ci+xt[6]*si+xt[14],Ai=xt[3]*ci+xt[7]*si+xt[15],gi=Gn+Gt,Ui=Ln+Rr,Bi=Un+Sr,so=Math.max(Ai+_r,1e-5),Xi=Gn+$t,ki=Ln+Er,ca=Un+Jr,Ra=Math.max(Ai+Br,1e-5);en.push(new Am(gi/so,Ui/so,Bi/so)),mn.push(new Am(Xi/Ra,ki/Ra,ca/Ra))}mr.push(en),fr.push(mn)}return[mr,fr]}(Re,Te,Be,Ne,Xe)}(b,p,N,F,k,T,ie,U,Q,b.center.lat,u.tileID.canonical),Se=u.queryGeometry;return function(xe,Re,Te){let Be=1/0;eF(Te,Re)&&(Be=nN(Te,Re[0]));for(let Ne=0;Ne<Re.length;Ne++){const Xe=Re[Ne],ft=xe[Ne];for(let Je=0;Je<Xe.length-1;Je++){const yt=Xe[Je],_t=[yt,Xe[Je+1],ft[Je+1],ft[Je],yt];PE(Te,_t)&&(Be=Math.min(Be,nN(Te,_t)))}}return Be!==1/0&&Be}(oe,_e,Se.isPointQuery()?Se.screenBounds:Se.screenGeometry)}},line:class extends sn{constructor(u,s,h){super(u,oN,s,h),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof op,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,s){super.recalculate(u,s),this.paint._values["line-floorwidth"]=fN.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new eD(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,s){const h=cN(this);return{config:new bp(this,s),defines:h,overrideFog:!1}}queryRadius(u){const s=u,h=dN(bm("line-width",this,s),bm("line-gap-width",this,s)),p=bm("line-offset",this,s);return h/2+Math.abs(p)+lS(this.paint.get("line-translate"))}queryIntersectsFeature(u,s,h,p,_,b){if(u.queryGeometry.isAboveHorizon)return!1;const T=iF(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),I=u.pixelToTileUnitsFactor/2*dN(this.paint.get("line-width").evaluate(s,h),this.paint.get("line-gap-width").evaluate(s,h)),L=this.paint.get("line-offset").evaluate(s,h);return L&&(p=function(k,F){const N=[],U=new nr(0,0);for(let Z=0;Z<k.length;Z++){const Q=k[Z],ee=[];for(let ie=0;ie<Q.length;ie++){const oe=Q[ie],_e=Q[ie+1],Se=ie===0?U:oe.sub(Q[ie-1])._unit()._perp(),xe=ie===Q.length-1?U:_e.sub(oe)._unit()._perp(),Re=Se._add(xe)._unit();Re._mult(1/(Re.x*xe.x+Re.y*xe.y)),ee.push(Re._mult(F)._add(oe))}N.push(ee)}return N}(p,L*u.pixelToTileUnitsFactor)),function(k,F,N){for(let U=0;U<F.length;U++){const Z=F[U];if(k.length>=3){for(let Q=0;Q<Z.length;Q++)if(Ap(k,Z[Q]))return!0}if(Vte(k,Z,N))return!0}return!1}(T,p,I)}isTileClipped(){return!0}},symbol:GS,background:class extends sn{constructor(u,s,h){super(u,Kne,s,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,s){return{overrideFog:!1}}},raster:KN,"raster-particle":JN,sky:class extends sn{constructor(u,s,h){super(u,oie,s,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=D0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(u,s){if(this.paint.get("sky-type")==="atmosphere"){const p=this.paint.get("sky-atmosphere-sun"),_=!p,b=u.style.light,T=b.properties.get("position");return _&&b.properties.get("anchor")==="viewport"&&Gi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),_?vD(T.azimuthal,90-T.polar,s):vD(p[0],90-p[1],s)}const h=this.paint.get("sky-gradient-center");return vD(h[0],90-h[1],s)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends sn{constructor(u,s,h){super(u,sie,s)}},model:class extends sn{constructor(u,s,h){super(u,vie,s,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new _D(u)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof JS?ir-1:0}queryIntersectsFeature(u,s,h,p,_,b){if(!this.modelManager)return!1;const T=this.modelManager,I=u.tile.getBucket(this);if(!(I&&I instanceof _D))return!1;const L=I;for(const k in L.instancesPerModel){const F=L.instancesPerModel[k],N=s.id!==void 0?s.id:s.properties&&s.properties.hasOwnProperty("id")?s.properties.id:void 0;if(F.idToFeaturesIndex.hasOwnProperty(N)){const U=F.features[F.idToFeaturesIndex[N]],Z=T.getModel(k,this.scope);if(!Z)return!1;let Q=o.a9.create();const ee=new Fn(0,0),ie=L.canonical;let oe=Number.MAX_VALUE;for(let _e=0;_e<U.instancedDataCount;++_e){const Se=16*(U.instancedDataOffset+_e),xe=F.instancedDataArray.float32,Re=[xe[Se+4],xe[Se+5],xe[Se+6]];D4(ie,ee,xe[Se],0|xe[Se+1]),u4(Q,Z,b,ee,U.rotation,U.scale,Re,!1,!1,!1),b.projection.name==="globe"&&(Q=mD(Q,b));const Te=o.a9.multiply([],b.projMatrix,Q),Be=u.queryGeometry,Ne=a4(Be.isPointQuery()?Be.screenBounds:Be.screenGeometry,b,Te,Z.aabb);Ne!=null&&(oe=Math.min(Ne,oe))}return oe!==Number.MAX_VALUE&&oe}}return!1}_handleOverridablePaintPropertyUpdate(u,s,h){return!(!this.layout||s.isDataDriven()||h.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const s=this._transitionablePaint._values[u];return s!=null&&s.value!=null&&s.value.expression!=null&&s.value.expression instanceof dp}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(u,s,h,p){const _=u.tile,b=_.getBucket(this);let T=null,I=Number.MAX_VALUE;if(!(b&&b instanceof JS))return{queryFeature:T,intersectionZ:I};const L=b.getNodesInfo()[s];if(L.hiddenByReplacement||!L.node.meshes||!h.filter(new he(_.tileID.overscaledZ),L.feature,_.tileID.canonical))return{queryFeature:T,intersectionZ:I};const k=L.node,F=p.calculatePosMatrix(_.tileID.toUnwrapped(),p.worldSize),N=L.evaluatedScale;let U=0;p.elevation&&k.elevation&&(U=k.elevation*p.elevation.exaggeration()),o.a9.translate(F,F,[(k.anchor?k.anchor[0]:0)*(N[0]-1),(k.anchor?k.anchor[1]:0)*(N[1]-1),U]),o.a9.scale(F,F,N),o.a9.multiply(F,F,k.matrix);const Z=u.queryGeometry,Q=Z.isPointQuery()?Z.screenBounds:Z.screenGeometry,ee=function(oe){const _e=o.a9.multiply([],F,oe.matrix),Se=o.a9.multiply(_e,p.expandedFarZProjMatrix,_e);for(let xe=0;xe<oe.meshes.length;++xe){const Re=oe.meshes[xe];if(xe===oe.lightMeshIndex)continue;const Te=a4(Q,p,Se,Re.aabb);Te!=null&&(I=Math.min(Te,I))}if(oe.children)for(const xe of oe.children)ee(xe)};if(ee(k),I===Number.MAX_VALUE)return{queryFeature:T,intersectionZ:I};const ie=new Fn(0,0);return D4(_.tileID.canonical,ie,L.node.anchor[0],L.node.anchor[1]),T={type:"Feature",geometry:{type:"Point",coordinates:[ie.lng,ie.lat]},properties:L.feature.properties,id:L.feature.id,state:{},layer:this.serialize()},{queryFeature:T,intersectionZ:I}}}},Xr={read:function(u,s){return u.readFields(Xr._readField,{header_length:0,x:0,y:0,z:0,layers:[]},s)},_readField:function(u,s,h){u===1?s.header_length=h.readFixed32():u===2?s.x=h.readVarint():u===3?s.y=h.readVarint():u===4?s.z=h.readVarint():u===5&&s.layers.push(Xr.Layer.read(h,h.readVarint()+h.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};Xr.Filter.read=function(u,s){return u.readFields(Xr.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},s)},Xr.Filter._readField=function(u,s,h){u===1?(s.delta_filter=Xr.Filter.Delta.read(h,h.readVarint()+h.pos),s.filter="delta_filter"):u===2?(s.zigzag_filter=Xr.Filter.Zigzag.read(h,h.readVarint()+h.pos),s.filter="zigzag_filter"):u===3?(s.bitshuffle_filter=Xr.Filter.BitShuffle.read(h,h.readVarint()+h.pos),s.filter="bitshuffle_filter"):u===4&&(s.byteshuffle_filter=Xr.Filter.ByteShuffle.read(h,h.readVarint()+h.pos),s.filter="byteshuffle_filter")},Xr.Filter.Delta={},Xr.Filter.Delta.read=function(u,s){return u.readFields(Xr.Filter.Delta._readField,{block_size:0},s)},Xr.Filter.Delta._readField=function(u,s,h){u===1&&(s.block_size=h.readVarint())},Xr.Filter.Zigzag={},Xr.Filter.Zigzag.read=function(u,s){return u.readFields(Xr.Filter.Zigzag._readField,{},s)},Xr.Filter.Zigzag._readField=function(u,s,h){},Xr.Filter.BitShuffle={},Xr.Filter.BitShuffle.read=function(u,s){return u.readFields(Xr.Filter.BitShuffle._readField,{},s)},Xr.Filter.BitShuffle._readField=function(u,s,h){},Xr.Filter.ByteShuffle={},Xr.Filter.ByteShuffle.read=function(u,s){return u.readFields(Xr.Filter.ByteShuffle._readField,{},s)},Xr.Filter.ByteShuffle._readField=function(u,s,h){},Xr.Codec={},Xr.Codec.read=function(u,s){return u.readFields(Xr.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},s)},Xr.Codec._readField=function(u,s,h){u===1?(s.gzip_data=Xr.Codec.GzipData.read(h,h.readVarint()+h.pos),s.codec="gzip_data"):u===2?(s.jpeg_image=Xr.Codec.JpegImage.read(h,h.readVarint()+h.pos),s.codec="jpeg_image"):u===3?(s.webp_image=Xr.Codec.WebpImage.read(h,h.readVarint()+h.pos),s.codec="webp_image"):u===4&&(s.png_image=Xr.Codec.PngImage.read(h,h.readVarint()+h.pos),s.codec="png_image")},Xr.Codec.GzipData={},Xr.Codec.GzipData.read=function(u,s){return u.readFields(Xr.Codec.GzipData._readField,{},s)},Xr.Codec.GzipData._readField=function(u,s,h){},Xr.Codec.JpegImage={},Xr.Codec.JpegImage.read=function(u,s){return u.readFields(Xr.Codec.JpegImage._readField,{},s)},Xr.Codec.JpegImage._readField=function(u,s,h){},Xr.Codec.WebpImage={},Xr.Codec.WebpImage.read=function(u,s){return u.readFields(Xr.Codec.WebpImage._readField,{},s)},Xr.Codec.WebpImage._readField=function(u,s,h){},Xr.Codec.PngImage={},Xr.Codec.PngImage.read=function(u,s){return u.readFields(Xr.Codec.PngImage._readField,{},s)},Xr.Codec.PngImage._readField=function(u,s,h){},Xr.DataIndexEntry={},Xr.DataIndexEntry.read=function(u,s){return u.readFields(Xr.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},s)},Xr.DataIndexEntry._readField=function(u,s,h){u===1?s.first_byte=h.readFixed64():u===2?s.last_byte=h.readFixed64():u===3?s.filters.push(Xr.Filter.read(h,h.readVarint()+h.pos)):u===4?s.codec=Xr.Codec.read(h,h.readVarint()+h.pos):u===5?s.offset=h.readFloat():u===6?s.scale=h.readFloat():u===7&&s.bands.push(h.readString())},Xr.Layer={},Xr.Layer.read=function(u,s){return u.readFields(Xr.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},s)},Xr.Layer._readField=function(u,s,h){u===1?s.version=h.readVarint():u===2?s.name=h.readString():u===3?s.units=h.readString():u===4?s.tilesize=h.readVarint():u===5?s.buffer=h.readVarint():u===6?s.pixel_format=h.readVarint():u===7&&s.data_index.push(Xr.DataIndexEntry.read(h,h.readVarint()+h.pos))};const eu={read:function(u,s){return u.readFields(eu._readField,{uint32_values:null,values:null,fixed32_values:null},s)},_readField:function(u,s,h){u===2?(s.uint32_values=eu.Uint32Values.read(h,h.readVarint()+h.pos),s.values="uint32_values"):u===3&&(s.fixed32_values=eu.Fixed32Values.read(h,h.readVarint()+h.pos),s.values="fixed32_values")},Uint32Values:{}};eu.Uint32Values.read=function(u,s){return u.readFields(eu.Uint32Values._readField,{values:[]},s)},eu.Uint32Values._readField=function(u,s,h){u===1&&(s.readValuesInto=function(p){if(p.type!==2)throw new Error(`Unsupported pbf type "${p.type}"`);const _=function(T){return T.type===2?T.readVarint()+T.pos:T.pos+1}(p),b=p.pos;return p.pos=_,function(T){p.pos=b;let I=0;for(;p.pos<_;){const L=p.readVarint();T[I++]=L}return T}}(h))},eu.Fixed32Values={},eu.Fixed32Values.read=function(u,s){return u.readFields(eu.Fixed32Values._readField,{values:[]},s)},eu.Fixed32Values._readField=function(u,s,h){throw new Error("Not implemented")};/**
 * tiny-lru
 *
 * @copyright 2024 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.2.6
 */class Bie{constructor(s=0,h=0,p=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=s,this.resetTtl=p,this.size=0,this.ttl=h}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(s){if(this.has(s)){const h=this.items[s];delete this.items[s],this.size--,h.prev!==null&&(h.prev.next=h.next),h.next!==null&&(h.next.prev=h.prev),this.first===h&&(this.first=h.next),this.last===h&&(this.last=h.prev)}return this}entries(s=this.keys()){return s.map(h=>[h,this.get(h)])}evict(s=!1){if(s||this.size>0){const h=this.first;delete this.items[h.key],--this.size==0?(this.first=null,this.last=null):(this.first=h.next,this.first.prev=null)}return this}expiresAt(s){let h;return this.has(s)&&(h=this.items[s].expiry),h}get(s){let h;if(this.has(s)){const p=this.items[s];this.ttl>0&&p.expiry<=Date.now()?this.delete(s):(h=p.value,this.set(s,h,!0))}return h}has(s){return s in this.items}keys(){const s=[];let h=this.first;for(;h!==null;)s.push(h.key),h=h.next;return s}set(s,h,p=!1,_=this.resetTtl){let b;if(p||this.has(s)){if(b=this.items[s],b.value=h,p===!1&&_&&(b.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==b){const T=this.last,I=b.next,L=b.prev;this.first===b&&(this.first=b.next),b.next=null,b.prev=this.last,T.next=b,L!==null&&(L.next=I),I!==null&&(I.prev=L)}}else this.max>0&&this.size===this.max&&this.evict(!0),b=this.items[s]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:s,prev:this.last,next:null,value:h},++this.size==1?this.first=b:this.last.next=b;return this.last=b,this}values(s=this.keys()){return s.map(h=>this.get(h))}}function Fie(u,s){if(s.length!==4)throw new Error(`Expected data of dimension 4 but got ${s.length}.`);let h=s[3];for(let p=2;p>=1;p--){const _=p===1?1:0,b=p===2?1:0;for(let T=0;T<s[0];T++){const I=s[1]*T;for(let L=_;L<s[1];L++){const k=s[2]*(L+I);for(let F=b;F<s[2];F++){const N=s[3]*(F+k);for(let U=0;U<s[3];U++){const Z=N+U;u[Z]+=u[Z-h]}}}}h*=s[p]}return u}function Nie(u){for(let s=0,h=u.length;s<h;s++)u[s]=u[s]>>>1^-(1&u[s]);return u}function Vie(u,s){switch(s){case"uint32":return u;case"uint16":for(let h=0;h<u.length;h+=2){const p=u[h],_=u[h+1];u[h]=(240&p)>>4|(61440&p)>>8|(240&_)<<4|61440&_,u[h+1]=15&p|(3840&p)>>4|(15&_)<<8|(3840&_)<<4}return u;case"uint8":for(let h=0;h<u.length;h+=4){const p=u[h],_=u[h+1],b=u[h+2],T=u[h+3];u[h+0]=(192&p)>>6|(192&_)>>4|(192&b)>>2|192&T,u[h+1]=(48&p)>>4|(48&_)>>2|48&b|(48&T)<<2,u[h+2]=(12&p)>>2|12&_|(12&b)<<2|(12&T)<<4,u[h+3]=3&p|(3&_)<<2|(3&b)<<4|(3&T)<<6}return u;default:throw new Error(`Invalid pixel format, "${s}"`)}}class pf extends Error{constructor(s){super(s),this.name="MRTError"}}var $s=Uint8Array,K0=Uint16Array,Gie=Int32Array,P4=new $s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),L4=new $s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Uie=new $s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R4=function(u,s){for(var h=new K0(31),p=0;p<31;++p)h[p]=s+=1<<u[p-1];var _=new Gie(h[30]);for(p=1;p<30;++p)for(var b=h[p];b<h[p+1];++b)_[b]=b-h[p]<<5|p;return{b:h,r:_}},k4=R4(P4,2),O4=k4.b,$ie=k4.r;O4[28]=258,$ie[258]=28;for(var Hie=R4(L4,0).b,z4=new K0(32768),ia=0;ia<32768;++ia){var Fm=(43690&ia)>>1|(21845&ia)<<1;z4[ia]=((65280&(Fm=(61680&(Fm=(52428&Fm)>>2|(13107&Fm)<<2))>>4|(3855&Fm)<<4))>>8|(255&Fm)<<8)>>1}var J0=function(u,s,h){for(var p=u.length,_=0,b=new K0(s);_<p;++_)u[_]&&++b[u[_]-1];var T,I=new K0(s);for(_=1;_<s;++_)I[_]=I[_-1]+b[_-1]<<1;{T=new K0(1<<s);var L=15-s;for(_=0;_<p;++_)if(u[_])for(var k=_<<4|u[_],F=s-u[_],N=I[u[_]-1]++<<F,U=N|(1<<F)-1;N<=U;++N)T[z4[N]>>L]=k}return T},ex=new $s(288);for(ia=0;ia<144;++ia)ex[ia]=8;for(ia=144;ia<256;++ia)ex[ia]=9;for(ia=256;ia<280;++ia)ex[ia]=7;for(ia=280;ia<288;++ia)ex[ia]=8;var B4=new $s(32);for(ia=0;ia<32;++ia)B4[ia]=5;var jie=J0(ex,9),Wie=J0(B4,5),MD=function(u){for(var s=u[0],h=1;h<u.length;++h)u[h]>s&&(s=u[h]);return s},tu=function(u,s,h){var p=s/8|0;return(u[p]|u[p+1]<<8)>>(7&s)&h},ID=function(u,s){var h=s/8|0;return(u[h]|u[h+1]<<8|u[h+2]<<16)>>(7&s)},Zie=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ru=function(u,s,h){var p=new Error(s||Zie[u]);if(p.code=u,Error.captureStackTrace&&Error.captureStackTrace(p,ru),!h)throw p;return p},qie=new $s(0),Yie=typeof TextDecoder<"u"&&new TextDecoder;try{Yie.decode(qie,{stream:!0})}catch{}const Xie={gzip_data:"gzip"},Qie={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Kie={uint32:1,uint16:2,uint8:4},Jie={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class F4{constructor(s=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=s}getLayer(s){return this.layers[s]}getHeaderLength(s){const h=new Uint8Array(s),p=new DataView(s);if(h[0]!==13)throw new pf("File is not a valid MRT.");return p.getUint32(1,!0)}parseHeader(s){const h=new Uint8Array(s),p=this.getHeaderLength(s);if(h.length<p)throw new pf(`Expected header with length >= ${p} but got buffer of length ${h.length}`);const _=new Em(h.subarray(0,p)),b=Xr.read(_);if(!isNaN(this.x)&&(this.x!==b.x||this.y!==b.y||this.z!==b.z))throw new pf(`Invalid attempt to parse header ${b.z}/${b.x}/${b.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=b.x,this.y=b.y,this.z=b.z;for(const T of b.layers)this.layers[T.name]=new eae(T,{cacheSize:this._cacheSize});return this}createDecodingTask(s){const h=[],p=this.getLayer(s.layerName);for(let _=0;_<p.dataIndex.length;_++){const b=p.dataIndex[_],T=b.first_byte-s.firstByte,I=b.last_byte+1-s.firstByte;if(_<s.firstBlock||_>s.lastBlock||p._blocksInProgress.has(_))continue;const L={layerName:p.name,firstByte:T,lastByte:I,pixelFormat:p.pixelFormat,blockIndex:_,blockShape:[b.bands.length].concat(p.bandShape),buffer:p.buffer,codec:b.codec.codec,filters:b.filters.map(k=>k.filter)};p._blocksInProgress.add(_),h.push(L)}return new N4(h,()=>{h.forEach(_=>p._blocksInProgress.delete(_.blockIndex))},(_,b)=>{if(h.forEach(T=>p._blocksInProgress.delete(T.blockIndex)),_)throw _;b.forEach(T=>{this.getLayer(T.layerName).processDecodedData(T)})})}}class eae{constructor({version:s,name:h,units:p,tilesize:_,pixel_format:b,buffer:T,data_index:I},L){if(this.version=s,this.version!==1)throw new pf(`Cannot parse raster layer encoded with MRT version ${s}`);this.name=h,this.units=p,this.tileSize=_,this.buffer=T,this.pixelFormat=Qie[b],this.dataIndex=I,this.bandShape=[_+2*T,_+2*T,Kie[this.pixelFormat]],this._decodedBlocks=function(k=1e3,F=0,N=!1){if(isNaN(k)||k<0)throw new TypeError("Invalid max value");if(isNaN(F)||F<0)throw new TypeError("Invalid ttl value");if(typeof N!="boolean")throw new TypeError("Invalid resetTtl value");return new Bie(k,F,N)}(L?L.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(s){const h=s.blockIndex.toString();this._decodedBlocks.get(h)||this._decodedBlocks.set(h,s.data)}getBlockForBand(s){let h=0;switch(typeof s){case"string":for(const[p,_]of this.dataIndex.entries()){for(const[b,T]of _.bands.entries())if(T===s)return{bandIndex:h+b,blockIndex:p,blockBandIndex:b};h+=_.bands.length}break;case"number":for(const[p,_]of this.dataIndex.entries()){if(s>=h&&s<h+_.bands.length)return{bandIndex:s,blockIndex:p,blockBandIndex:s-h};h+=_.bands.length}break;default:throw new pf(`Invalid band \`${JSON.stringify(s)}\`. Expected string or integer.`)}throw new pf(`Band not found: ${JSON.stringify(s)}`)}getDataRange(s){let h=1/0,p=-1/0,_=1/0,b=-1/0;for(const T of s){const{blockIndex:I}=this.getBlockForBand(T);if(I<0)throw new pf(`Invalid band: ${JSON.stringify(T)}`);const L=this.dataIndex[I];_=Math.min(_,I),b=Math.max(b,I),h=Math.min(h,L.first_byte),p=Math.max(p,L.last_byte)}return{layerName:this.name,firstByte:h,lastByte:p,firstBlock:_,lastBlock:b}}hasBand(s){const{blockIndex:h}=this.getBlockForBand(s);return h>=0}hasDataForBand(s){const{blockIndex:h}=this.getBlockForBand(s);return h>=0&&!!this._decodedBlocks.get(h.toString())}getBandView(s){const{blockIndex:h,blockBandIndex:p}=this.getBlockForBand(s),_=this._decodedBlocks.get(h.toString());if(!_)throw new pf(`Data for band ${JSON.stringify(s)} of layer "${this.name}" not decoded.`);const b=this.dataIndex[h],T=this.bandShape.reduce((k,F)=>k*F,1),I=p*T,L=_.subarray(I,I+T);return{data:L,bytes:new Uint8Array(L.buffer).subarray(L.byteOffset,L.byteOffset+L.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:b.offset,scale:b.scale}}}class N4{constructor(s,h,p){this.tasks=s,this._onCancel=h,this._onComplete=p,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(s,h){this._finalized||(this._onComplete(s,h),this._finalized=!0)}}F4.performDecoding=function(u,s){return Promise.all(s.tasks.map(h=>{const{layerName:p,firstByte:_,lastByte:b,pixelFormat:T,blockShape:I,blockIndex:L,filters:k,codec:F}=h,N=new Uint8Array(u).subarray(_,b+1),U=new Uint32Array(I[0]*I[1]*I[2]);let Z;if(F!=="gzip_data")throw new Error(`Unhandled codec: ${F}`);return Z=function(Q,ee){if(!globalThis.DecompressionStream&&ee==="gzip_data")return Promise.resolve(((Se=function(Te){Te[0]==31&&Te[1]==139&&Te[2]==8||ru(6,"invalid gzip data");var Be=Te[3],Ne=10;4&Be&&(Ne+=2+(Te[10]|Te[11]<<8));for(var Xe=(Be>>3&1)+(Be>>4&1);Xe>0;Xe-=!Te[Ne++]);return Ne+(2&Be)}(_e=Q))+8>_e.length&&ru(6,"invalid gzip data"),function(Te,Be,Ne,Xe){var ft=Te.length;if(!ft||Be.f&&!Be.l)return Ne||new $s(0);var Je=!Ne,yt=Je||Be.i!=2,_t=Be.i;Je&&(Ne=new $s(3*ft));var dt,Pt,It=function(gf){var vf=Ne.length;if(gf>vf){var Dp=new $s(Math.max(2*vf,gf));Dp.set(Ne),Ne=Dp}},zt=Be.f||0,Ot=Be.p||0,xt=Be.b||0,mr=Be.l,fr=Be.d,Gt=Be.m,Rr=Be.n,Sr=8*ft;do{if(!mr){zt=tu(Te,Ot,1);var _r=tu(Te,Ot+1,3);if(Ot+=3,!_r){var $t=Te[(Ln=4+((Ot+7)/8|0))-4]|Te[Ln-3]<<8,Er=Ln+$t;if(Er>ft){_t&&ru(0);break}yt&&It(xt+$t),Ne.set(Te.subarray(Ln,Er),xt),Be.b=xt+=$t,Be.p=Ot=8*Er,Be.f=zt;continue}if(_r==1)mr=jie,fr=Wie,Gt=9,Rr=5;else if(_r==2){var Jr=tu(Te,Ot,31)+257,Br=tu(Te,Ot+10,15)+4,an=Jr+tu(Te,Ot+5,31)+1;Ot+=14;for(var en=new $s(an),mn=new $s(19),Or=0;Or<Br;++Or)mn[Uie[Or]]=tu(Te,Ot+3*Or,7);Ot+=3*Br;var ci=MD(mn),si=(1<<ci)-1,Gn=J0(mn,ci);for(Or=0;Or<an;){var Ln,Un=Gn[tu(Te,Ot,si)];if(Ot+=15&Un,(Ln=Un>>4)<16)en[Or++]=Ln;else{var Ai=0,gi=0;for(Ln==16?(gi=3+tu(Te,Ot,3),Ot+=2,Ai=en[Or-1]):Ln==17?(gi=3+tu(Te,Ot,7),Ot+=3):Ln==18&&(gi=11+tu(Te,Ot,127),Ot+=7);gi--;)en[Or++]=Ai}}var Ui=en.subarray(0,Jr),Bi=en.subarray(Jr);Gt=MD(Ui),Rr=MD(Bi),mr=J0(Ui,Gt),fr=J0(Bi,Rr)}else ru(1);if(Ot>Sr){_t&&ru(0);break}}yt&&It(xt+131072);for(var so=(1<<Gt)-1,Xi=(1<<Rr)-1,ki=Ot;;ki=Ot){var ca=(Ai=mr[ID(Te,Ot)&so])>>4;if((Ot+=15&Ai)>Sr){_t&&ru(0);break}if(Ai||ru(2),ca<256)Ne[xt++]=ca;else{if(ca==256){ki=Ot,mr=null;break}var Ra=ca-254;ca>264&&(Ra=tu(Te,Ot,(1<<(Lo=P4[Or=ca-257]))-1)+O4[Or],Ot+=Lo);var ka=fr[ID(Te,Ot)&Xi],xi=ka>>4;if(ka||ru(3),Ot+=15&ka,Bi=Hie[xi],xi>3){var Lo=L4[xi];Bi+=ID(Te,Ot)&(1<<Lo)-1,Ot+=Lo}if(Ot>Sr){_t&&ru(0);break}yt&&It(xt+131072);var jc=xt+Ra;if(xt<Bi){var fl=0-Bi,nu=Math.min(Bi,jc);for(fl+xt<0&&ru(3);xt<nu;++xt)Ne[xt]=(void 0)[fl+xt]}for(;xt<jc;++xt)Ne[xt]=Ne[xt-Bi]}}Be.l=mr,Be.p=ki,Be.b=xt,Be.f=zt,mr&&(zt=1,Be.m=Gt,Be.d=fr,Be.n=Rr)}while(!zt);return xt!=Ne.length&&Je?(dt=Ne,((Pt=xt)==null||Pt>dt.length)&&(Pt=dt.length),new $s(dt.subarray(0,Pt))):Ne.subarray(0,xt)}(_e.subarray(Se,-8),{i:2},new $s(((ie=_e)[(oe=ie.length)-4]|ie[oe-3]<<8|ie[oe-2]<<16|ie[oe-1]<<24)>>>0))));var ie,oe,_e,Se;const xe=Xie[ee];if(!xe)throw new Error(`Unhandled codec: ${ee}`);const Re=new globalThis.DecompressionStream(xe);return new Response(new Blob([Q]).stream().pipeThrough(Re)).arrayBuffer().then(Te=>new Uint8Array(Te))}(N,F).then(Q=>{const ee=eu.read(new Em(Q));if(ee.values==="uint32_values")return ee.uint32_values.readValuesInto(U),new Jie[T](U.buffer);throw new Error(`Unhandled numeric data "${ee.values}"`)}),Z.then(Q=>{for(let ee=k.length-1;ee>=0;ee--)switch(k[ee]){case"delta_filter":Fie(Q,I);break;case"zigzag_filter":Nie(Q);break;case"bitshuffle_filter":Vie(Q,T);break;default:throw new Error(`Unhandled filter "${k[ee]}"`)}return{layerName:p,blockIndex:L,data:Q}}).catch(Q=>{throw Q})}))},gr(N4,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const V4=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ED{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(s,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=p>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const b=V4[15&p];if(!b)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(s,2,1),[I]=new Uint32Array(s,4,1);return new ED(I,T,b,s)}constructor(s,h=64,p=Float64Array,_){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const b=V4.indexOf(this.ArrayType),T=2*s*this.ArrayType.BYTES_PER_ELEMENT,I=s*this.IndexArrayType.BYTES_PER_ELEMENT,L=(8-I%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${p}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+I+L,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+T+I+L),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+I+L,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=s)}add(s,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=s,this.coords[this._pos++]=h,p}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return DD(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,h,p,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:T,nodeSize:I}=this,L=[0,b.length-1,0],k=[];for(;L.length;){const F=L.pop()||0,N=L.pop()||0,U=L.pop()||0;if(N-U<=I){for(let ie=U;ie<=N;ie++){const oe=T[2*ie],_e=T[2*ie+1];oe>=s&&oe<=p&&_e>=h&&_e<=_&&k.push(b[ie])}continue}const Z=U+N>>1,Q=T[2*Z],ee=T[2*Z+1];Q>=s&&Q<=p&&ee>=h&&ee<=_&&k.push(b[Z]),(F===0?s<=Q:h<=ee)&&(L.push(U),L.push(Z-1),L.push(1-F)),(F===0?p>=Q:_>=ee)&&(L.push(Z+1),L.push(N),L.push(1-F))}return k}within(s,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:b,nodeSize:T}=this,I=[0,_.length-1,0],L=[],k=p*p;for(;I.length;){const F=I.pop()||0,N=I.pop()||0,U=I.pop()||0;if(N-U<=T){for(let ie=U;ie<=N;ie++)U4(b[2*ie],b[2*ie+1],s,h)<=k&&L.push(_[ie]);continue}const Z=U+N>>1,Q=b[2*Z],ee=b[2*Z+1];U4(Q,ee,s,h)<=k&&L.push(_[Z]),(F===0?s-p<=Q:h-p<=ee)&&(I.push(U),I.push(Z-1),I.push(1-F)),(F===0?s+p>=Q:h+p>=ee)&&(I.push(Z+1),I.push(N),I.push(1-F))}return L}}function DD(u,s,h,p,_,b){if(_-p<=h)return;const T=p+_>>1;G4(u,s,T,p,_,b),DD(u,s,h,p,T-1,1-b),DD(u,s,h,T+1,_,1-b)}function G4(u,s,h,p,_,b){for(;_>p;){if(_-p>600){const k=_-p+1,F=h-p+1,N=Math.log(k),U=.5*Math.exp(2*N/3),Z=.5*Math.sqrt(N*U*(k-U)/k)*(F-k/2<0?-1:1);G4(u,s,h,Math.max(p,Math.floor(h-F*U/k+Z)),Math.min(_,Math.floor(h+(k-F)*U/k+Z)),b)}const T=s[2*h+b];let I=p,L=_;for(tx(u,s,p,h),s[2*_+b]>T&&tx(u,s,p,_);I<L;){for(tx(u,s,I,L),I++,L--;s[2*I+b]<T;)I++;for(;s[2*L+b]>T;)L--}s[2*p+b]===T?tx(u,s,p,L):(L++,tx(u,s,L,_)),L<=h&&(p=L+1),h<=L&&(_=L-1)}}function tx(u,s,h,p){PD(u,h,p),PD(s,2*h,2*p),PD(s,2*h+1,2*p+1)}function PD(u,s,h){const p=u[s];u[s]=u[h],u[h]=p}function U4(u,s,h,p){const _=u-h,b=s-p;return _*_+b*b}o.$=class{constructor(u){this.specification=u}possiblyEvaluate(u,s){return function([h,p]){const _=kd([1,h,p]);return{x:_.x,y:_.y,z:_.z}}(u.expression.evaluate(s))}interpolate(u,s,h){return{x:cn(u.x,s.x,h),y:cn(u.y,s.y,h),z:cn(u.z,s.z,h)}}},o.A=Tt,o.B=b0,o.C=Io,o.D=qw,o.E=Mc,o.F=function(u){const s=u.value;let h=[];if(!s)return h;const p=Pu(s);return p!=="string"?(h=h.concat([new ZS(u.key,s,`string expected, "${p}" found`)]),h):(o4(s,!0)||(h=h.concat([new ZS(u.key,s,`invalid url "${s}"`)])),h)},o.G=Me,o.H=Ze,o.I=oD,o.J=Ve,o.K=class{constructor(u){this.specification=u}possiblyEvaluate(u,s){return kd(u.expression.evaluate(s))}interpolate(u,s,h){return{x:cn(u.x,s.x,h),y:cn(u.y,s.y,h),z:cn(u.z,s.z,h),azimuthal:cn(u.azimuthal,s.azimuthal,h),polar:cn(u.polar,s.polar,h)}}},o.L=ze,o.M=class{constructor(u,s,h,p){this.id=u,this.position=s!=null?new Fn(s[0],s[1]):new Fn(0,0),this.orientation=h??[0,0,0],this.nodes=p,this.uploaded=!1,this.aabb=new Li([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,s){if(o.a9.multiply(u.matrix,s,u.matrix),u.meshes)for(const h of u.meshes){const p=Li.applyTransform(h.aabb,u.matrix);this.aabb.encapsulate(p)}if(u.children)for(const h of u.children)this._applyTransformations(h,u.matrix)}computeBoundsAndApplyParent(){const u=o.a9.identity([]);for(const s of this.nodes)this._applyTransformations(s,u)}computeModelMatrix(u,s,h,p,_,b,T=!1){u4(this.matrix,this,u.transform,this.position,s,h,p,_,b,T)}upload(u){if(!this.uploaded){for(const s of this.nodes)yD(s,u);for(const s of this.nodes)qS(s);this.uploaded=!0}}destroy(){for(const u of this.nodes)xD(u)}},o.N=he,o.O=oo,o.P=nr,o.R=kv,o.S=Pd,o.T=gD,o.U=st,o.V=ZS,o.W=af,o.X=cn,o.Y=ir,o.Z=dp,o._=jd,o.a=$v,o.a$=Py,o.a0=function(u,s,h=0,p=!0){const _=new nr(h,h),b=u.sub(_),T=s.add(_),I=[b,new nr(T.x,b.y),T,new nr(b.x,T.y)];return p&&I.push(b.clone()),I},o.a1=function(u,s){const h=[];for(let p=0;p<u.length;p++){const _=Ul(p-1,-1,u.length-1),b=Ul(p+1,-1,u.length-1),T=u[p],I=u[b],L=u[_].sub(T).unit(),k=I.sub(T).unit(),F=k.angleWithSep(L.x,L.y),N=L.add(k).unit().mult(-1*s/Math.sin(F/2));h.push(T.add(N))}return h},o.a2=$N,o.a3=nF,o.a4=function(u,s,h=0){return o.Q.fromValues(((s.x-h)*u.scale-u.x)*ir,(s.y*u.scale-u.y)*ir,Y5(s.z,s.y))},o.a5=OE,o.a6=sN,o.a7=function(u){let s=1/0,h=1/0,p=-1/0,_=-1/0;for(const b of u)s=Math.min(s,b.x),h=Math.min(h,b.y),p=Math.max(p,b.x),_=Math.max(_,b.y);return{min:new nr(s,h),max:new nr(p,_)}},o.a8=rf,o.aA=Jn,o.aB=Kr,o.aC=$w,o.aD=mE,o.aE=ea,o.aF=Zn,o.aG=P5,o.aH=VS,o.aI=function(){De.isLoading()||De.isLoaded()||Ce()!=="deferred"||Ae()},o.aJ=lr,o.aK=nf,o.aL=S4,o.aM=$o,o.aN=eD,o.aO=QE,o.aP=Gc,o.aQ=Wa,o.aR=gE,o.aS=uF,o.aT=_S,o.aU=pD,o.aV=function(u,s){const h=af(s.zoom);if(h===0)return Fu(u);const p=hS(u),_=NE(p),b=rf(p.getWest())*s.worldSize,T=rf(p.getEast())*s.worldSize,I=Vc(p.getNorth())*s.worldSize,L=Vc(p.getSouth())*s.worldSize,k=[b,I,0],F=[T,I,0],N=[b,L,0],U=[T,L,0],Z=o.a9.invert([],s.globeMatrix);return o.Q.transformMat4(k,k,Z),o.Q.transformMat4(F,F,Z),o.Q.transformMat4(N,N,Z),o.Q.transformMat4(U,U,Z),_[0]=Uc(_[0],N,h),_[1]=Uc(_[1],U,h),_[2]=Uc(_[2],F,h),_[3]=Uc(_[3],k,h),Li.fromPoints(_)},o.aW=dS,o.aX=E0,o.aY=Uc,o.aZ=ya,o.a_=Wte,o.ab=Ap,o.ac=K5,o.ad=wn,o.ae=Do,o.af=function(u,s){const h={};for(let p=0;p<s.length;p++){const _=s[p];_ in u&&(h[_]=u[_])}return h},o.ag=tf,o.ah=Vc,o.ai=class{constructor(u){this.entries={},this.scheduler=u}request(u,s,h,p){const _=this.entries[u]=this.entries[u]||{callbacks:[]};if(_.result){const[b,T]=_.result;return this.scheduler?this.scheduler.add(()=>{p(b,T)},s):p(b,T),()=>{}}return _.callbacks.push(p),_.cancel||(_.cancel=h((b,T)=>{_.result=[b,T];for(const I of _.callbacks)this.scheduler?this.scheduler.add(()=>{I(b,T)},s):I(b,T);setTimeout(()=>delete this.entries[u],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(b=>b!==p),_.callbacks.length||(_.cancel(),delete this.entries[u]))}}},o.aj=di,o.ak=function(u,s,h){const p=JSON.stringify(u.request);return u.data&&(this.deduped.entries[p]={result:[null,u.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},_=>{const b=Fd(u.request,(T,I,L,k)=>{T?_(T):I&&_(null,{vectorTile:h?void 0:new KE(new Em(I)),rawData:I,cacheControl:L,expires:k})});return()=>{b.cancel(),_()}},s)},o.al=function(u){zy++,zy>dw&&(u.getActor().send("enforceCacheSizeLimit",Lv),zy=0)},o.am=Co,o.an=Ev,o.ao=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},o.ap=ao,o.aq=KN,o.ar=JN,o.as=QN,o.at=function(u,s){const h=document.createElement("video");h.muted=!0,h.onloadstart=function(){s(null,h)};for(let p=0;p<u.length;p++){const _=document.createElement("source");Fy(u[p])||(h.crossOrigin="Anonymous"),_.src=u[p],h.appendChild(_)}return{cancel:()=>{}}},o.au=US,o.av=G0,o.aw=fs,o.ax=qa,o.ay=Za,o.az=ba,o.b=Eu,o.b$=Pm,o.b0=F4,o.b1=Fd,o.b2=function(u){const s=[];for(const h in u)s.push(u[h]);return s},o.b3=function(u,s){const h=[];for(const p in u)p in s||h.push(p);return h},o.b4=Ey,o.b5=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.b6=function(u,s){const{x:h,y:p}=u.point,_=gF(h,p,u.worldSize/u._pixelsPerMercatorPixel,0,0);return o.a9.multiply(_,_,VE(Fu(s)))},o.b8=Cm,o.b9=Us,o.bA=W5,o.bB=function(u){const s=o.a9.identity(new Float64Array(16));o.a9.multiply(s,u.pixelMatrix,u.globeMatrix);const h=[0,cl,0],p=[0,hl,0];return o.Q.transformMat4(h,h,s),o.Q.transformMat4(p,p,s),[h[0]>0&&h[0]<=u.width&&h[1]>0&&h[1]<=u.height&&!UE(u,new Fn(u.center.lat,90)),p[0]>0&&p[0]<=u.width&&p[1]>0&&p[1]<=u.height&&!UE(u,new Fn(u.center.lat,-90))]},o.bC=function(u,s){const{scale:h}=u.tileTransform,p=h*ir/(u.tileSize*Math.pow(2,s.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return o.b7.scale(new Float32Array(4),s.inverseAdjustmentMatrix,[p,p])},o.bD=jS,o.bE=e4,o.bF=function(u){const s=e4(u,!0);return o.b7.invert([],[s[0],s[1],s[4],s[5]])},o.bG=zE,o.bH=function(u){const{x:s,y:h}=u.point,{lng:p,lat:_}=u._center;return gF(s,h,u.worldSize,p,_)},o.bI=mo,o.bJ=SE,o.bK=function(u){const s=Math.round((u+45+360)%360/90)%4;return lw[s]},o.bL=45,o.bM=CE,o.bN=A0,o.bO=Kh,o.bP=xE,o.bQ=Eo,o.bR=iS,o.bS=$5,o.bT=function(u,s,h){const p=Math.sqrt(u*u+s*s+h*h),_=p>0?Math.acos(h/p)*Iy:0;let b=u!==0||s!==0?Math.atan2(-s,-u)*Iy+90:0;return b<0&&(b+=360),[p,b,_]},o.bU=aS,o.bV=Li,o.bW=kd,o.bX=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},o.bY=function(u){return u({pluginStatus:le,pluginURL:se}),ye.on("pluginStateChange",u),u},o.bZ=Om,o.b_=YS,o.ba=CS,o.bb=function(u,s,h,p,_){const b=5*s+2;u.float32[b+0]=h,u.float32[b+1]=p,u.float32[b+2]=_},o.bc=NS,o.bd=LN,o.be=PE,o.bf=Ya,o.bg=uD,o.bh=NN,o.bi=aD,o.bj=ED,o.bk=Ul,o.bm=On,o.bn=Tc,o.bo=Po,o.bp=function(u,s,h){u[4*s+0]=h[0],u[4*s+1]=h[1],u[4*s+2]=h[2],u[4*s+3]=h[3]},o.bq=Fn,o.br=qN,o.bs=q5,o.bt=BE,o.bu=t4,o.bv=Sp,o.bw=fF,o.bx=function(u,s,h,p,_,b,T,I,L){if(L.name==="globe")return fF(u,s,new Sp(h,p,_),!1);const k=G0({z:h,x:p,y:_},L);return new Li([(b+k.x/k.scale)*s,s*(k.y/k.scale),T],[(b+k.x2/k.scale)*s,s*(k.y2/k.scale),I])},o.by=function(u,s,h){let p=0;for(let _=0;_<2;++_)u[_]>0&&(p+=(u[_]-0)*(u[_]-0)),s[_]<0&&(p+=(0-s[_])*(0-s[_]));return p},o.bz=ta,o.c=b4,o.c$=[1,1,1],o.c0=sD,o.c1=Rh,o.c2=ue,o.c3=x,o.c4=Pv,o.c5=Ud,o.c6=$l,o.c7=function(u,s,h){return u.type==="custom"?new iie(u,s):new zie[u.type](u,s,h)},o.c8=function(u){const s=u.indexOf(Ji);return s>=0?u.slice(0,s):u},o.c9=function(u){return u.indexOf(Ji)>=0},o.cA=u=>({u_matrix:new A0(u),u_pixels_to_tile_units:new bE(u),u_device_pixel_ratio:new Eo(u),u_units_to_pixels:new Kh(u),u_dash_image:new iS(u),u_gradient_image:new iS(u),u_image_height:new Eo(u),u_texsize:new Kh(u),u_tile_units_to_pixels:new Eo(u),u_alpha_discard_threshold:new Eo(u),u_trim_offset:new Kh(u),u_emissive_strength:new Eo(u)}),o.cB=u=>({u_matrix:new A0(u),u_texsize:new Kh(u),u_pixels_to_tile_units:new bE(u),u_device_pixel_ratio:new Eo(u),u_image:new iS(u),u_units_to_pixels:new Kh(u),u_tile_units_to_pixels:new Eo(u),u_alpha_discard_threshold:new Eo(u),u_trim_offset:new Kh(u)}),o.cC=mp,o.cD=cne,o.cE=hne,o.cF=_F,o.cG=(u,s,h,p,_,b)=>{const T=u.transform,I=T.projection.name==="globe";let L;if(b.paint.get("circle-pitch-alignment")==="map")if(I){const F=pF(T.zoom,s.canonical)*T._pixelsPerMercatorPixel;L=Float32Array.from([F,0,0,F])}else L=T.calculatePixelsToTileUnitsMatrix(h);else L=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const k={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(T.projection),u_matrix:u.translatePosMatrix(s.projMatrix,h,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:nl.devicePixelRatio,u_extrude_scale:L,u_inv_rot_matrix:Qte,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:b.paint.get("circle-emissive-strength")};if(I){k.u_inv_rot_matrix=p,k.u_merc_center=_,k.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],k.u_zoom_transition=af(T.zoom);const F=_[0]*ir,N=_[1]*ir;k.u_up_dir=T.projection.upVector(new Sp(0,0,0),F,N)}return k},o.cH=cN,o.cI=(u,s,h,p,_,b)=>{const T=u.transform;return{u_matrix:uN(u,s,h,p),u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:lN(s,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:b}},o.cJ=(u,s,h,p,_,b,T)=>{const I=u.transform,L=I.calculatePixelsToTileUnitsMatrix(s);return{u_matrix:uN(u,s,h,p),u_pixels_to_tile_units:L,u_device_pixel_ratio:b,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:hN(h)&&s.lineAtlasTexture?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:lN(s,u.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_emissive_strength:h.paint.get("line-emissive-strength")}},o.cK=Dy,o.cL=D0,o.cM=tN,o.cN=kte,o.cO=AS,o.cP=lf,o.cQ=450,o.cR=7,o.cS=tie,o.cT=256,o.cU=VE,o.cV=xp,o.cW=yp,o.cX=dE,o.cY=function(u,s,h,p,_){return wn((u-s)/(h-s)*(_-p)+p,p,_)},o.cZ=Tp,o.c_=mD,o.ca=function(u){const s=u.indexOf(Ji);return s>=0?u.slice(s+1):""},o.cb=function(u){const s=[],h=u.id;return h===void 0&&s.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&s.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&s.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),s},o.cc=Ld,o.cd=ye,o.ce=Bd,o.cf=H5,o.cg=class extends Fc{constructor(u){super(u),this.current=Cte}set(u,s,h){if(this.fetchUniformLocation(u,s)){for(let p=0;p<9;p++)if(h[p]!==this.current[p]){this.current=h,this.gl.uniformMatrix3fv(this.location,!1,h);break}}}},o.ch=Sv,o.ci=function(u,s,h){const p=af(h.zoom),_=u.style.map._antialias,b=s.options.extStandardDerivativesForceOff||u.terrain&&u.terrain.exaggeration()>0;return p===0&&!_&&!b},o.cj=function(u){const s=u.pixelsPerMeter,h=s/Po(1,u.center.lat),p=o.a9.identity(new Float64Array(16));return o.a9.translate(p,p,[u.point.x,u.point.y,0]),o.a9.scale(p,p,[h,h,s]),Float32Array.from(p)},o.ck=hS,o.cl=function(u){const s=ta-5;u=wn(u,-s,s)/s*90;const h=Math.pow(Math.abs(Math.sin(On(u))),3);return Math.round(h*(TE.length-1))},o.cm=function(u,s,h,p){const _=s.getNorth(),b=s.getSouth(),T=s.getWest(),I=s.getEast(),L=1<<u.z,k=I-T,F=_-b,N=k/mm,U=-F/TE[h],Z=[0,N,0,U,0,0,_,T,0];if(u.z>0){const Q=180/p;o.ct.multiply(Z,Z,[Q/k+1,0,0,0,Q/F+1,0,-.5*Q/N,.5*Q/U,1])}return Z[2]=L,Z[5]=u.x,Z[8]=u.y,Z},o.cn=Fu,o.co=function(u,s,h){const p=o.a9.identity(new Float64Array(16)),_=(s/(1<<u)-.5)*Math.PI*2;return o.a9.rotateY(p,h.globeMatrix,_),Float32Array.from(p)},o.cp=class{isDataAvailableAtPoint(u){const s=this._source();if(this.isUsingMockSource()||!s||u.y<0||u.y>1)return!1;const h=s.getSource().maxzoom,p=1<<h,_=Math.floor(u.x),b=Math.floor((u.x-_)*p),T=Math.floor(u.y*p),I=this.findDEMTileFor(new ao(h,_,h,b,T));return!(!I||!I.dem)}getAtPointOrZero(u,s=0){return this.getAtPoint(u,s)||0}getAtPoint(u,s,h=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const p=this._source();if(!p||u.y<0||u.y>1)return s;const _=p.getSource().maxzoom,b=1<<_,T=Math.floor(u.x),I=u.x-T,L=new ao(_,T,_,Math.floor(I*b),Math.floor(u.y*b)),k=this.findDEMTileFor(L);if(!k||!k.dem)return s;const F=k.dem,N=1<<k.tileID.canonical.z,U=(I*N-k.tileID.canonical.x)*F.dim,Z=(u.y*N-k.tileID.canonical.y)*F.dim,Q=Math.floor(U),ee=Math.floor(Z);return(h?this.exaggeration():1)*cn(cn(F.get(Q,ee),F.get(Q,ee+1),Z-ee),cn(F.get(Q+1,ee),F.get(Q+1,ee+1),Z-ee),U-Q)}getAtTileOffset(u,s,h){const p=1<<u.canonical.z;return this.getAtPointOrZero(new oo(u.wrap+(u.canonical.x+s/ir)/p,(u.canonical.y+h/ir)/p))}getAtTileOffsetFunc(u,s,h,p){return _=>{const b=this.getAtTileOffset(u,_.x,_.y),T=p.upVector(u.canonical,_.x,_.y),I=p.upVectorScale(u.canonical,s,h).metersToTile;return o.Q.scale(T,T,b*I),T}}getForTilePoints(u,s,h,p){if(this.isUsingMockSource())return!1;const _=Tm.create(this,u,p);return!!_&&(s.forEach(b=>{b[2]=this.exaggeration()*_.getElevationAt(b[0],b[1],h)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(u);if(!s||!s.dem)return null;const h=s.dem.tree,p=s.tileID,_=1<<u.canonical.z-p.canonical.z;let b=u.canonical.x/_-p.canonical.x,T=u.canonical.y/_-p.canonical.y,I=0;for(let L=0;L<u.canonical.z-p.canonical.z&&!h.leaves[I];L++){b*=2,T*=2;const k=2*Math.floor(T)+Math.floor(b);I=h.childOffsets[I]+k,b%=1,T%=1}return{min:this.exaggeration()*h.minimums[I],max:this.exaggeration()*h.maximums[I]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,s,h){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let s=!1,h=Number.MAX_VALUE,p=Number.MIN_VALUE;for(const _ of u){const b=this.getMinMaxForTile(_.tileID);b&&(h=Math.min(h,b.min),p=Math.max(p,b.max),s=!0)}return s?{min:h,max:p}:null}},o.cq=cS,o.cr=TF,o.cs=function(u,s){return[Math.pow(u[0],2.2)*s,Math.pow(u[1],2.2)*s,Math.pow(u[2],2.2)*s]},o.cu=pF,o.cv=fw,o.cw=ks,o.cx=256,o.cy=function(u,s){const h=[0,0,0],p=dS(Fu(s.canonical));return o.Q.transformMat4(h,h,p),o.Q.transformMat4(h,h,u),h},o.cz=u=>({u_camera_to_center_distance:new Eo(u),u_extrude_scale:new bE(u),u_device_pixel_ratio:new Eo(u),u_matrix:new A0(u),u_inv_rot_matrix:new A0(u),u_merc_center:new Kh(u),u_tile_id:new xE(u),u_zoom_transition:new Eo(u),u_up_dir:new xE(u),u_emissive_strength:new Eo(u)}),o.d=Ny,o.d$=c4,o.d0=Tm,o.d1=km,o.d2=hs,o.d3=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u){const s=kF(new nr(0,0),new nr(ir,ir),u),h=[];for(const p of this._activeRegions){if(p.hiddenByOverlap||!RF(s,p))continue;const _=Lre(p.min,p.max,u);h.push({min:_.min,max:_.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId})}return h}setSources(u){this._setSources(u.map(s=>({getSourceId:()=>s.cache.id,getFootprints:()=>{const h=[];for(const p of s.cache.getVisibleCoordinates()){const _=s.cache.getTile(p).buckets[s.layer];if(_)for(const b of _.getNodesInfo()){const T=b.node;T.footprint&&h.push({footprint:T.footprint,id:p.toUnwrapped()})}}return h}})))}_addSource(u){const s=u.getFootprints();if(s.length!==0){for(const h of s){if(!h.footprint)continue;const p=kF(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:p.min,max:p.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint})}this._sourceIds.push(u.getSourceId())}}_computeReplacement(){this._activeRegions.sort((s,h)=>s.priority-h.priority||wS(s.min,h.min)||wS(s.max,h.max));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let s=0,h=0;for(;!u&&s!==this._activeRegions.length;){const p=this._activeRegions[s],_=this._prevRegions[h];u=p.priority!==_.priority||!LF(p,_),++s,++h}}if(u){++this._updateTime;const s=h=>{const p=this._activeRegions;if(h>=p.length)return h;const _=p[h].priority;for(;h<p.length&&p[h].priority===_;)++h;return h};if(this._sourceIds.length>1){let h=0,p=s(h);for(;h!==p;){let _=h;const b=h;for(;_!==p;){const T=this._activeRegions[_];T.hiddenByOverlap=!1;for(let I=0;I<b;I++){const L=this._activeRegions[I];if(!L.hiddenByOverlap&&RF(T,L)&&(T.hiddenByOverlap=zF(T.footprint,T.tileId,L.footprint,L.tileId),T.hiddenByOverlap))break}++_}h=p,p=s(h)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let s=u.length-1;s>=0;s--)this._addSource(u[s]);this._computeReplacement()}},o.d4=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,s){const h=new Wa,p=new ba,_=[],b=u+1+2,T=s[0]+1,I=s[0]+1+(1+s.length),L=(k,F,N)=>{let U=k===b-1?k-2:k===0?k:k-1;return U+=N?24575:0,[U,F]};for(let k=0;k<b;++k)h.emplaceBack(...L(k,0,!0));for(let k=0;k<T;++k)for(let F=0;F<b;++F)h.emplaceBack(...L(F,k,(F===0||F===b-1)&&!0));for(let k=0;k<s.length;++k){const F=s[k];for(let N=0;N<b;++N)h.emplaceBack(...L(N,F,!0))}for(let k=0;k<s.length;++k){const F=p.length,N=s[k]+1+2,U=new ba;for(let ee=0;ee<N-1;ee++){const ie=ee===N-2,oe=ie?b*(I-s.length+k-ee):b;for(let _e=0;_e<b-1;_e++){const Se=ee*b+_e;ee===0||ie||_e===0||_e===b-2?(U.emplaceBack(Se+1,Se,Se+oe),U.emplaceBack(Se+oe,Se+oe+1,Se+1)):(p.emplaceBack(Se+1,Se,Se+oe),p.emplaceBack(Se+oe,Se+oe+1,Se+1))}}const Z=ea.simpleSegment(0,F,h.length,p.length-F);for(let ee=0;ee<U.uint16.length;ee+=3)p.emplaceBack(U.uint16[ee],U.uint16[ee+1],U.uint16[ee+2]);const Q=ea.simpleSegment(0,F,h.length,p.length-F);_.push({withoutSkirts:Z,withSkirts:Q})}return{vertices:h,indices:p,segments:_}}_createGrid(u){const s=this._fillGridMeshWithLods(mm,TE);this._gridSegments=s.segments,this._gridBuffer=u.createVertexBuffer(s.vertices,uF.members),this._gridIndexBuffer=u.createIndexBuffer(s.indices,!0)}_createPoles(u){const s=new ba;for(let T=0;T<=mm;T++)s.emplaceBack(0,T+1,T+2);this._poleIndexBuffer=u.createIndexBuffer(s,!0);const h=new yp,p=new yp,_=new yp,b=new yp;this._poleSegments=[];for(let T=0,I=0;T<SE;T++){const L=360/(1<<T);h.emplaceBack(0,-Do,0,.5,0),p.emplaceBack(0,-Do,0,.5,1),_.emplaceBack(0,-Do,0,.5,.5),b.emplaceBack(0,-Do,0,.5,.5);for(let k=0;k<=mm;k++){let F=k/mm,N=0;const U=cn(0,L,F),[Z,Q,ee]=_m(Yte,Xte,U,Do);h.emplaceBack(Z,Q,ee,F,N),p.emplaceBack(Z,Q,ee,F,1-N);const ie=On(U);F=.5+.5*Math.sin(ie),N=.5+.5*Math.cos(ie),_.emplaceBack(Z,Q,ee,F,N),b.emplaceBack(Z,Q,ee,F,1-N)}this._poleSegments.push(ea.simpleSegment(I,0,66,64)),I+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(h,uS,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(p,uS,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(_,uS,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(b,uS,!1)}getGridBuffers(u,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,s){return[s?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,s?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},o.d5=function(u){return Gv.has(u)},o.d6=uw,o.d7=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.d8=Rs,o.d9=Q5,o.dA=q0,o.dB=function(u){const s=Oy();if(!s)return;const h=s.delete(Dh);u&&h.catch(u).then(()=>u())},o.dC=Z0,o.dD=h4,o.dE=function(u){wD=nl.resolveURL(u),Bm||(Bm=new Om(YS(),new Mc)),Bm.broadcast("setDracoUrl",wD)},o.dF=f4,o.dG=function(u){zm=nl.resolveURL(u),Bm||(Bm=new Om(YS(),new Mc)),Bm.broadcast("setMeshoptUrl",zm)},o.dH=gr,o.dI=of,o.dJ=Kl,o.dK=w4,o.dL=T4,o.dM=aN,o.dN=Ih,o.dO=kN,o.dP=function(u,s,h,p,_,b,T,I,L,k,F){u.createArrays(),u.tilePixelRatio=ir/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const N=u.layers[0].layout,U=u.layers[0]._unevaluatedLayout._values,Z={};if(u.textSizeData.kind==="composite"){const{minZoom:oe,maxZoom:_e}=u.textSizeData;Z.compositeTextSizes=[U["text-size"].possiblyEvaluate(new he(oe),I),U["text-size"].possiblyEvaluate(new he(_e),I)]}if(u.iconSizeData.kind==="composite"){const{minZoom:oe,maxZoom:_e}=u.iconSizeData;Z.compositeIconSizes=[U["icon-size"].possiblyEvaluate(new he(oe),I),U["icon-size"].possiblyEvaluate(new he(_e),I)]}Z.layoutTextSize=U["text-size"].possiblyEvaluate(new he(L+1),I),Z.layoutIconSize=U["icon-size"].possiblyEvaluate(new he(L+1),I),Z.textMaxSize=U["text-size"].possiblyEvaluate(new he(18),I);const Q=N.get("text-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",ee=N.get("text-size");let ie=!1;for(const oe of u.features)if(oe.icon&&oe.icon.nameSecondary){ie=!0;break}for(const oe of u.features){const _e=N.get("text-font").evaluate(oe,{},I).join(","),Se=ee.evaluate(oe,{},I),xe=Z.layoutTextSize.evaluate(oe,{},I),Re=(Z.layoutIconSize.evaluate(oe,{},I),{horizontal:{},vertical:void 0}),Te=oe.text;let Be,Ne=[0,0];if(Te){const Je=Te.toString(),yt=N.get("text-letter-spacing").evaluate(oe,{},I)*Ya,_t=N.get("text-line-height").evaluate(oe,{},I)*Ya,dt=S(Je)?yt:0,Pt=N.get("text-anchor").evaluate(oe,{},I),It=N.get("text-variable-anchor");if(!It){const fr=N.get("text-radial-offset").evaluate(oe,{},I);Ne=fr?NN(Pt,[fr*Ya,lD]):N.get("text-offset").evaluate(oe,{},I).map(Gt=>Gt*Ya)}let zt=Q?"center":N.get("text-justify").evaluate(oe,{},I);const Ot=N.get("symbol-placement")==="point",xt=Ot?N.get("text-max-width").evaluate(oe,{},I)*Ya:1/0,mr=fr=>{u.allowVerticalPlacement&&v(Je)&&(Re.vertical=iD(Te,s,h,_,_e,xt,_t,Pt,fr,dt,Ne,Us.vertical,!0,xe,Se))};if(!Q&&It){const fr=zt==="auto"?It.map(Rr=>uD(Rr)):[zt];let Gt=!1;for(let Rr=0;Rr<fr.length;Rr++){const Sr=fr[Rr];if(!Re.horizontal[Sr])if(Gt)Re.horizontal[Sr]=Re.horizontal[0];else{const _r=iD(Te,s,h,_,_e,xt,_t,"center",Sr,dt,Ne,Us.horizontal,!1,xe,Se);_r&&(Re.horizontal[Sr]=_r,Gt=_r.positionedLines.length===1)}}mr("left")}else{if(zt==="auto"&&(zt=uD(Pt)),Ot||N.get("text-writing-mode").indexOf("horizontal")>=0||!v(Je)){const fr=iD(Te,s,h,_,_e,xt,_t,Pt,zt,dt,Ne,Us.horizontal,!1,xe,Se);fr&&(Re.horizontal[zt]=fr)}mr(Ot?"left":zt)}}let Xe=!1;if(oe.icon&&oe.icon.namePrimary){const Je=p[oe.icon.namePrimary];Je&&(Be=Dne(_[oe.icon.namePrimary],oe.icon.nameSecondary?_[oe.icon.nameSecondary]:void 0,N.get("icon-offset").evaluate(oe,{},I),N.get("icon-anchor").evaluate(oe,{},I)),Xe=Je.sdf,u.sdfIcons===void 0?u.sdfIcons=Je.sdf:u.sdfIcons!==Je.sdf&&Gi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Je.pixelRatio!==u.pixelRatio||N.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const ft=GN(Re.horizontal)||Re.vertical;u.iconsInText||(u.iconsInText=!!ft&&ft.iconsInText),(ft||Be)&&Bne(u,oe,Re,Be,p,Z,xe,0,Ne,Xe,T,I,k,F,ie)}b&&u.generateCollisionDebugBuffers(L,u.collisionBoxArray)},o.dQ=KE,o.dR=Em,o.dS=SS,o.dT=xS,o.dU=yS,o.dV=wv,o.dW=gN,o.dX=z,o.dY=function(u){let s=0;if(new Uint32Array(u,0,1)[0]!==p4){const h=new Uint32Array(u,0,7),[,,p,_,b,T]=h;s=h.byteLength+_+b+T+b,(p!==u.byteLength||s>=u.byteLength)&&Gi("Invalid b3dm header information.")}return _4(u,s)},o.dZ=function(u,s){const h=b4(u);for(const p of h){for(const _ of p.meshes)Die(_);p.lights&&(p.lightMeshIndex=p.meshes.length,p.meshes.push(Pie(p.lights,s)))}return h},o.d_=JS,o.da=wp,o.db=function([u,s,h]){const p=Math.hypot(u,s,h),_=Math.atan2(u,h),b=.5*Math.PI-Math.acos(-s/p);return new Fn(mo(_),mo(b))},o.dc=ym,o.dd=m,o.de=UE,o.df=vF,o.dg=function(u){const s=[0,0,0],h=o.a9.identity(new Float64Array(16));return o.a9.multiply(h,u.pixelMatrix,u.globeMatrix),o.Q.transformMat4(s,s,h),new nr(s[0],s[1])},o.dh=function(u){const s=u.navigator?u.navigator.userAgent:null;return!!function(h){if(Iv==null){const p=h.navigator?h.navigator.userAgent:null;Iv=!!h.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))}return Iv}(u)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.di=class{constructor(u,s,h){this._transformRequestFn=u,this._customAccessToken=s,this._silenceAuthErrors=!!h,this._createSkuToken()}_createSkuToken(){const u=function(){let s="";for(let h=0;h<10;h++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Vd,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=u.token,this._skuTokenExpiresAt=u.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(u,s){return this._transformRequestFn&&this._transformRequestFn(u,s)||{url:u}}normalizeStyleURL(u,s){if(!x(u))return u;const h=Os(u);return h.params.push(`sdk=js-${d}`),h.path=`/styles/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||s)}normalizeGlyphsURL(u,s){if(!x(u))return u;const h=Os(u);return h.path=`/fonts/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||s)}normalizeModelURL(u,s){if(!x(u))return u;const h=Os(u);return h.path=`/models/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||s)}normalizeSourceURL(u,s,h,p){if(!x(u))return u;const _=Os(u);return _.path=`/v4/${_.authority}.json`,_.params.push("secure"),h&&_.params.push(`language=${h}`),p&&_.params.push(`worldview=${p}`),this._makeAPIURL(_,this._customAccessToken||s)}normalizeSpriteURL(u,s,h,p){const _=Os(u);return x(u)?(_.path=`/styles/v1${_.path}/sprite${s}${h}`,this._makeAPIURL(_,this._customAccessToken||p)):(_.path+=`${s}${h}`,kh(_))}normalizeTileURL(u,s,h){if(this._isSkuTokenExpired()&&this._createSkuToken(),u&&!x(u))return u;const p=Os(u);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||h&&p.authority!=="raster"&&h===512?"@2x":""}${Cc.supported?".webp":"$1"}`),p.authority==="raster"?p.path=`/${m.RASTER_URL_PREFIX}${p.path}`:p.authority==="rasterarrays"?p.path=`/${m.RASTERARRAYS_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${m.TILE_URL_VERSION}${p.path}`);const _=this._customAccessToken||function(b){for(const T of b){const I=T.match(/^access_token=(.*)$/);if(I)return I[1]}return null}(p.params)||m.ACCESS_TOKEN;return m.REQUIRE_ACCESS_TOKEN&&_&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,_)}canonicalizeTileURL(u,s){const h=Os(u);if(!h.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!h.path.match(/\.[\w]+$/))return u;let p="mapbox://";h.path.match(/^\/raster\/v1\//)?p+=`raster/${h.path.replace(`/${m.RASTER_URL_PREFIX}/`,"")}`:h.path.match(/^\/rasterarrays\/v1\//)?p+=`rasterarrays/${h.path.replace(`/${m.RASTERARRAYS_URL_PREFIX}/`,"")}`:p+=`tiles/${h.path.replace(`/${m.TILE_URL_VERSION}/`,"")}`;let _=h.params;return s&&(_=_.filter(b=>!b.match(/^access_token=/))),_.length&&(p+=`?${_.join("&")}`),p}canonicalizeTileset(u,s){const h=!!s&&x(s),p=[];for(const _ of u.tiles||[])y(_)?p.push(this.canonicalizeTileURL(_,h)):p.push(_);return p}_makeAPIURL(u,s){const h="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",p=Os(m.API_URL);if(u.protocol=p.protocol,u.authority=p.authority,u.protocol==="http"){const _=u.params.indexOf("secure");_>=0&&u.params.splice(_,1)}if(p.path!=="/"&&(u.path=`${p.path}${u.path}`),!m.REQUIRE_ACCESS_TOKEN)return kh(u);if(s=s||m.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${h}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${h}`)}return u.params=u.params.filter(_=>_.indexOf("access_token")===-1),u.params.push(`access_token=${s||""}`),kh(u)}},o.dj=function(u,s){s?Gv.add(u):Gv.delete(u)},o.dk=Cc,o.dl=Nv,o.dm=Uy,o.dn=Bv,o.dp=Mo,o.dq=qI,o.dr=function(u){Gv.delete(u)},o.ds=Vv,o.dt=Iu,o.du=d,o.dv=function(u,s){Lv=u,dw=s},o.dw=function(u,s,h=!1){if(le===q||le===K||le===te)throw new Error("setRTLTextPlugin cannot be called multiple times.");se=nl.resolveURL(u),le=q,ne=s,ce(),h||Ae()},o.dx=Ce,o.dy=function(){YS().acquire(bD)},o.dz=function(){const u=Y0;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(bD),Y0=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.e=us,o.e0=De,o.e1=function(u){Ph(),jl&&jl.then(s=>{s.keys().then(h=>{for(let p=0;p<h.length-u;p++)s.delete(h[p])})})},o.f=nl,o.g=function(u,s){return Bd(us(u,{type:"json"}),s)},o.h=Gs,o.i=class extends ZS{},o.j=Pu,o.k=Wv,o.l=function(u){return fetch(u).then(s=>s.arrayBuffer()).then(s=>_4(s,0,u))},o.m=hm,o.n=Yw,o.o=dm,o.p=RN,o.q=ot,o.r=Kw,o.s=qh,o.t=Yh,o.u=nt,o.v=np,o.w=Gi,o.x=ap,o.y=ku}),l(["./shared"],function(o){function d(qe){const ge=qe?qe.url.toString():void 0;return ge?performance.getEntriesByName(ge):[]}function g(qe){if(typeof qe=="number"||typeof qe=="boolean"||typeof qe=="string"||qe==null)return JSON.stringify(qe);if(Array.isArray(qe)){let be="[";for(const ke of qe)be+=`${g(ke)},`;return`${be}]`}let ge="{";for(const be of Object.keys(qe).sort())ge+=`${be}:${g(qe[be])},`;return`${ge}}`}function m(qe){let ge="";for(const be of o.b5)ge+=`/${g(qe[be])}`;return ge}class y{constructor(ge){this.keyCache={},this._layers={},this._layerConfigs={},ge&&this.replace(ge)}replace(ge,be){this._layerConfigs={},this._layers={},this.update(ge,[],be)}update(ge,be,ke){this._options=ke;for(const ut of ge)this._layerConfigs[ut.id]=ut,(this._layers[ut.id]=o.c7(ut,this.scope,this._options)).compileFilter(),this.keyCache[ut.id]&&delete this.keyCache[ut.id];for(const ut of be)delete this.keyCache[ut],delete this._layerConfigs[ut],delete this._layers[ut];this.familiesBySource={};const tt=function(ut,St){const vt={};for(let Dt=0;Dt<ut.length;Dt++){const Vt=St&&St[ut[Dt].id]||m(ut[Dt]);St&&(St[ut[Dt].id]=Vt);let jt=vt[Vt];jt||(jt=vt[Vt]=[]),jt.push(ut[Dt])}const Ye=[];for(const Dt in vt)Ye.push(vt[Dt]);return Ye}(o.b2(this._layerConfigs),this.keyCache);for(const ut of tt){const St=ut.map(Yt=>this._layers[Yt.id]),vt=St[0];if(vt.visibility==="none")continue;const Ye=vt.source||"";let Dt=this.familiesBySource[Ye];Dt||(Dt=this.familiesBySource[Ye]={});const Vt=vt.sourceLayer||"_geojsonTileLayer";let jt=Dt[Vt];jt||(jt=Dt[Vt]=[]),jt.push(St)}}}const x=1*o.dJ;class A{constructor(ge){const be={},ke=[];for(const vt in ge){const Ye=ge[vt],Dt=be[vt]={};for(const Vt in Ye.glyphs){const jt=Ye.glyphs[+Vt];if(!jt||jt.bitmap.width===0||jt.bitmap.height===0)continue;const Yt=jt.metrics.localGlyph?x:1,Nr={x:0,y:0,w:jt.bitmap.width+2*Yt,h:jt.bitmap.height+2*Yt};ke.push(Nr),Dt[Vt]=Nr}}const{w:tt,h:ut}=o.p(ke),St=new o.dI({width:tt||1,height:ut||1});for(const vt in ge){const Ye=ge[vt];for(const Dt in Ye.glyphs){const Vt=Ye.glyphs[+Dt];if(!Vt||Vt.bitmap.width===0||Vt.bitmap.height===0)continue;const jt=be[vt][Dt],Yt=Vt.metrics.localGlyph?x:1;o.dI.copy(Vt.bitmap,St,{x:0,y:0},{x:jt.x+Yt,y:jt.y+Yt},Vt.bitmap)}}this.image=St,this.positions=be}}o.dH(A,"GlyphAtlas");class M{constructor(ge){this.tileID=new o.ap(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),this.tileZoom=ge.tileZoom,this.uid=ge.uid,this.zoom=ge.zoom,this.canonical=ge.tileID.canonical,this.pixelRatio=ge.pixelRatio,this.tileSize=ge.tileSize,this.source=ge.source,this.scope=ge.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ge.showCollisionBoxes,this.collectResourceTiming=!!ge.collectResourceTiming,this.promoteId=ge.promoteId,this.isSymbolTile=ge.isSymbolTile,this.tileTransform=o.av(ge.tileID.canonical,ge.projection),this.projection=ge.projection,this.brightness=ge.brightness,this.extraShadowCaster=!!ge.extraShadowCaster}parse(ge,be,ke,tt,ut){this.status="parsing",this.data=ge,this.collisionBoxArray=new o.aG;const St=new o.dK(Object.keys(ge.layers).sort()),vt=new o.dL(this.tileID,this.promoteId);vt.bucketLayerIDs=[];const Ye={},Dt=new o.dM(256,256),Vt={featureIndex:vt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Dt,availableImages:ke,brightness:this.brightness},jt=be.familiesBySource[this.source];for(const ai in jt){const Si=ge.layers[ai];if(!Si)continue;let pa=!1,Ii=!1,po=!1;for(const sa of jt[ai])sa[0].type==="symbol"?pa=!0:Ii=!0,sa[0].is3D()&&sa[0].type!=="model"&&(po=!0);if(this.extraShadowCaster&&!po||this.isSymbolTile===!0&&!pa||this.isSymbolTile===!1&&!Ii)continue;Si.version===1&&o.w(`Vector tile source "${this.source}" layer "${ai}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const no=St.encode(ai),Ds=[];for(let sa=0;sa<Si.length;sa++){const Ni=Si.feature(sa),Ct=vt.getId(Ni,ai);Ds.push({feature:Ni,id:Ct,index:sa,sourceLayerIndex:no})}for(const sa of jt[ai]){const Ni=sa[0];(!this.extraShadowCaster||Ni.is3D()&&Ni.type!=="model")&&(this.isSymbolTile!==void 0&&Ni.type==="symbol"!==this.isSymbolTile||Ni.minzoom&&this.zoom<Math.floor(Ni.minzoom)||Ni.maxzoom&&this.zoom>=Ni.maxzoom||Ni.visibility!=="none"&&(D(sa,this.zoom,Vt.brightness,ke),(Ye[Ni.id]=Ni.createBucket({index:vt.bucketLayerIDs.length,layers:sa,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:no,sourceID:this.source,projection:this.projection.spec})).populate(Ds,Vt,this.tileID.canonical,this.tileTransform),vt.bucketLayerIDs.push(sa.map(Ct=>Ct.id))))}}let Yt,Nr,Qr,xn;Dt.trim();const jn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Wn=()=>{if(Yt)return this.status="done",ut(Yt);if(this.extraShadowCaster)this.status="done",ut(null,{buckets:o.b2(Ye).filter(ai=>!ai.isEmpty()),featureIndex:vt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Vt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Nr&&Qr&&xn){const ai=new A(Nr),Si=new o.dO(Qr,xn);for(const pa in Ye){const Ii=Ye[pa];Ii instanceof o.aH?(D(Ii.layers,this.zoom,Vt.brightness,ke),o.dP(Ii,Nr,ai.positions,Qr,Si.iconPositions,this.showCollisionBoxes,ke,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Ii.hasPattern&&(Ii instanceof o.aN||Ii instanceof o.aO||Ii instanceof o.cO)&&(D(Ii.layers,this.zoom,Vt.brightness,ke),Ii.addFeatures(Vt,this.tileID.canonical,Si.patternPositions,ke,this.tileTransform,this.brightness))}this.status="done",ut(null,{buckets:o.b2(Ye).filter(pa=>!pa.isEmpty()),featureIndex:vt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ai.image,lineAtlas:Dt,imageAtlas:Si,brightness:Vt.brightness})}};if(!this.extraShadowCaster){const ai=o.dN(Vt.glyphDependencies,Ii=>Object.keys(Ii).map(Number));Object.keys(ai).length?tt.send("getGlyphs",{uid:this.uid,stacks:ai,scope:this.scope},(Ii,po)=>{Yt||(Yt=Ii,Nr=po,Wn())},void 0,!1,jn):Nr={};const Si=Object.keys(Vt.iconDependencies);Si.length?tt.send("getImages",{icons:Si,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Ii,po)=>{Yt||(Yt=Ii,Qr=po,Wn())},void 0,!1,jn):Qr={};const pa=Object.keys(Vt.patternDependencies);pa.length?tt.send("getImages",{icons:pa,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Ii,po)=>{Yt||(Yt=Ii,xn=po,Wn())},void 0,!1,jn):xn={}}Wn()}}function D(qe,ge,be,ke){const tt=new o.N(ge,{brightness:be});for(const ut of qe)ut.recalculate(tt,ke)}class P extends o.E{constructor(ge,be,ke,tt,ut,St){super(),this.actor=ge,this.layerIndex=be,this.availableImages=ke,this.loadVectorData=ut||o.ak,this.loading={},this.loaded={},this.deduped=new o.ai(ge.scheduler),this.isSpriteLoaded=tt,this.scheduler=ge.scheduler,this.brightness=St}loadTile(ge,be){const ke=ge.uid,tt=ge&&ge.request,ut=tt&&tt.collectResourceTiming,St=this.loading[ke]=new M(ge);St.abort=this.loadVectorData(ge,(vt,Ye)=>{const Dt=!this.loading[ke];if(delete this.loading[ke],Dt||vt||!Ye)return St.status="done",Dt||(this.loaded[ke]=St),be(vt);const Vt=Ye.rawData,jt={};Ye.expires&&(jt.expires=Ye.expires),Ye.cacheControl&&(jt.cacheControl=Ye.cacheControl),St.vectorTile=Ye.vectorTile||new o.dQ(new o.dR(Vt));const Yt=()=>{St.parse(St.vectorTile,this.layerIndex,this.availableImages,this.actor,(Nr,Qr)=>{if(Nr||!Qr)return be(Nr);const xn={};if(ut){const jn=d(tt);jn.length>0&&(xn.resourceTiming=JSON.parse(JSON.stringify(jn)))}be(null,o.e({rawTileData:Vt.slice(0)},Qr,jt,xn))})};this.isSpriteLoaded?Yt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Yt,{type:"parseTile",isSymbolTile:ge.isSymbolTile,zoom:ge.tileZoom}):Yt()}),this.loaded=this.loaded||{},this.loaded[ke]=St})}reloadTile(ge,be){const ke=this.loaded,tt=ge.uid,ut=this;if(ke&&ke[tt]){const St=ke[tt];St.showCollisionBoxes=ge.showCollisionBoxes,St.projection=ge.projection,St.brightness=ge.brightness,St.tileTransform=o.av(ge.tileID.canonical,ge.projection),St.extraShadowCaster=ge.extraShadowCaster;const vt=(Ye,Dt)=>{const Vt=St.reloadCallback;Vt&&(delete St.reloadCallback,St.parse(St.vectorTile,ut.layerIndex,this.availableImages,ut.actor,Vt)),be(Ye,Dt)};St.status==="parsing"?St.reloadCallback=vt:St.status==="done"&&(St.vectorTile?St.parse(St.vectorTile,this.layerIndex,this.availableImages,this.actor,vt):vt())}else be(null,void 0)}abortTile(ge,be){const ke=ge.uid,tt=this.loading[ke];tt&&(tt.abort&&tt.abort(),delete this.loading[ke]),be()}removeTile(ge,be){const ke=this.loaded,tt=ge.uid;ke&&ke[tt]&&delete ke[tt],be()}}class O{loadTile(ge,be){const{uid:ke,encoding:tt,rawImageData:ut,padding:St}=ge,vt=ImageBitmap&&ut instanceof ImageBitmap?this.getImageData(ut,St):ut;be(null,new o.dS(ke,vt,tt,St<1))}getImageData(ge,be){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ge.width,ge.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ge.width,this.offscreenCanvas.height=ge.height,this.offscreenCanvasContext.drawImage(ge,0,0,ge.width,ge.height);const ke=this.offscreenCanvasContext.getImageData(-be,-be,ge.width+2*be,ge.height+2*be);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ke}}class z{decodeRasterArray({task:ge,buffer:be},ke){o.b0.performDecoding(be,ge).then(tt=>{ke(null,tt)},tt=>{ke(tt)})}}const V=o.dT.prototype.toGeoJSON;let H=class{constructor(qe){this._feature=qe,this.extent=o.Y,this.type=qe.type,this.properties=qe.tags,"id"in qe&&!isNaN(qe.id)&&(this.id=parseInt(qe.id,10))}loadGeometry(){if(this._feature.type===1){const qe=[];for(const ge of this._feature.geometry)qe.push([new o.P(ge[0],ge[1])]);return qe}{const qe=[];for(const ge of this._feature.geometry){const be=[];for(const ke of ge)be.push(new o.P(ke[0],ke[1]));qe.push(be)}return qe}}toGeoJSON(qe,ge,be){return V.call(this,qe,ge,be)}},$=class{constructor(qe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.Y,this.length=qe.length,this._features=qe}feature(qe){return new H(this._features[qe])}};var X={exports:{}},W=o.dV,Y=o.dU.VectorTileFeature,J=re;function re(qe,ge){this.options=ge||{},this.features=qe,this.length=qe.length}function ae(qe,ge){this.id=typeof qe.id=="number"?qe.id:void 0,this.type=qe.type,this.rawGeometry=qe.type===1?[qe.geometry]:qe.geometry,this.properties=qe.tags,this.extent=ge||4096}re.prototype.feature=function(qe){return new ae(this.features[qe],this.options.extent)},ae.prototype.loadGeometry=function(){var qe=this.rawGeometry;this.geometry=[];for(var ge=0;ge<qe.length;ge++){for(var be=qe[ge],ke=[],tt=0;tt<be.length;tt++)ke.push(new W(be[tt][0],be[tt][1]));this.geometry.push(ke)}return this.geometry},ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var qe=this.geometry,ge=1/0,be=-1/0,ke=1/0,tt=-1/0,ut=0;ut<qe.length;ut++)for(var St=qe[ut],vt=0;vt<St.length;vt++){var Ye=St[vt];ge=Math.min(ge,Ye.x),be=Math.max(be,Ye.x),ke=Math.min(ke,Ye.y),tt=Math.max(tt,Ye.y)}return[ge,ke,be,tt]},ae.prototype.toGeoJSON=Y.prototype.toGeoJSON;var pe=o.dW,de=J;function ve(qe){var ge=new pe;return function(be,ke){for(var tt in be.layers)ke.writeMessage(3,me,be.layers[tt])}(qe,ge),ge.finish()}function me(qe,ge){var be;ge.writeVarintField(15,qe.version||1),ge.writeStringField(1,qe.name||""),ge.writeVarintField(5,qe.extent||4096);var ke={keys:[],values:[],keycache:{},valuecache:{}};for(be=0;be<qe.length;be++)ke.feature=qe.feature(be),ge.writeMessage(2,Ie,ke);var tt=ke.keys;for(be=0;be<tt.length;be++)ge.writeStringField(3,tt[be]);var ut=ke.values;for(be=0;be<ut.length;be++)ge.writeMessage(4,We,ut[be])}function Ie(qe,ge){var be=qe.feature;be.id!==void 0&&ge.writeVarintField(1,be.id),ge.writeMessage(2,Le,qe),ge.writeVarintField(3,be.type),ge.writeMessage(4,Ke,be)}function Le(qe,ge){var be=qe.feature,ke=qe.keys,tt=qe.values,ut=qe.keycache,St=qe.valuecache;for(var vt in be.properties){var Ye=be.properties[vt],Dt=ut[vt];if(Ye!==null){Dt===void 0&&(ke.push(vt),ut[vt]=Dt=ke.length-1),ge.writeVarint(Dt);var Vt=typeof Ye;Vt!=="string"&&Vt!=="boolean"&&Vt!=="number"&&(Ye=JSON.stringify(Ye));var jt=Vt+":"+Ye,Yt=St[jt];Yt===void 0&&(tt.push(Ye),St[jt]=Yt=tt.length-1),ge.writeVarint(Yt)}}}function Ee(qe,ge){return(ge<<3)+(7&qe)}function Ue(qe){return qe<<1^qe>>31}function Ke(qe,ge){for(var be=qe.loadGeometry(),ke=qe.type,tt=0,ut=0,St=be.length,vt=0;vt<St;vt++){var Ye=be[vt],Dt=1;ke===1&&(Dt=Ye.length),ge.writeVarint(Ee(1,Dt));for(var Vt=ke===3?Ye.length-1:Ye.length,jt=0;jt<Vt;jt++){jt===1&&ke!==1&&ge.writeVarint(Ee(2,Vt-1));var Yt=Ye[jt].x-tt,Nr=Ye[jt].y-ut;ge.writeVarint(Ue(Yt)),ge.writeVarint(Ue(Nr)),tt+=Yt,ut+=Nr}ke===3&&ge.writeVarint(Ee(7,1))}}function We(qe,ge){var be=typeof qe;be==="string"?ge.writeStringField(1,qe):be==="boolean"?ge.writeBooleanField(7,qe):be==="number"&&(qe%1!=0?ge.writeDoubleField(3,qe):qe<0?ge.writeSVarintField(6,qe):ge.writeVarintField(5,qe))}X.exports=ve,X.exports.fromVectorTileJs=ve,X.exports.fromGeojsonVt=function(qe,ge){ge=ge||{};var be={};for(var ke in qe)be[ke]=new de(qe[ke].features,ge),be[ke].name=ke,be[ke].version=ge.version,be[ke].extent=ge.extent;return ve({layers:be})},X.exports.GeoJSONWrapper=de;var Rt=o.dX(X.exports);const Et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:qe=>qe},ar=Math.fround||(ur=new Float32Array(1),qe=>(ur[0]=+qe,ur[0]));var ur;const cr=3,lt=5,qt=6;class Ut{constructor(ge){this.options=Object.assign(Object.create(Et),ge),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ge){const{log:be,minZoom:ke,maxZoom:tt}=this.options;be&&console.time("total time");const ut=`prepare ${ge.length} points`;be&&console.time(ut),this.points=ge;const St=[];for(let Ye=0;Ye<ge.length;Ye++){const Dt=ge[Ye];if(!Dt.geometry)continue;const[Vt,jt]=Dt.geometry.coordinates,Yt=ar(Oe(Vt)),Nr=ar($e(jt));St.push(Yt,Nr,1/0,Ye,-1,1),this.options.reduce&&St.push(0)}let vt=this.trees[tt+1]=this._createTree(St);be&&console.timeEnd(ut);for(let Ye=tt;Ye>=ke;Ye--){const Dt=+Date.now();vt=this.trees[Ye]=this._createTree(this._cluster(vt,Ye)),be&&console.log("z%d: %d clusters in %dms",Ye,vt.numItems,+Date.now()-Dt)}return be&&console.timeEnd("total time"),this}getClusters(ge,be){let ke=((ge[0]+180)%360+360)%360-180;const tt=Math.max(-90,Math.min(90,ge[1]));let ut=ge[2]===180?180:((ge[2]+180)%360+360)%360-180;const St=Math.max(-90,Math.min(90,ge[3]));if(ge[2]-ge[0]>=360)ke=-180,ut=180;else if(ke>ut){const jt=this.getClusters([ke,tt,180,St],be),Yt=this.getClusters([-180,tt,ut,St],be);return jt.concat(Yt)}const vt=this.trees[this._limitZoom(be)],Ye=vt.range(Oe(ke),$e(St),Oe(ut),$e(tt)),Dt=vt.data,Vt=[];for(const jt of Ye){const Yt=this.stride*jt;Vt.push(Dt[Yt+lt]>1?rr(Dt,Yt,this.clusterProps):this.points[Dt[Yt+cr]])}return Vt}getChildren(ge){const be=this._getOriginId(ge),ke=this._getOriginZoom(ge),tt="No cluster with the specified id.",ut=this.trees[ke];if(!ut)throw new Error(tt);const St=ut.data;if(be*this.stride>=St.length)throw new Error(tt);const vt=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),Ye=ut.within(St[be*this.stride],St[be*this.stride+1],vt),Dt=[];for(const Vt of Ye){const jt=Vt*this.stride;St[jt+4]===ge&&Dt.push(St[jt+lt]>1?rr(St,jt,this.clusterProps):this.points[St[jt+cr]])}if(Dt.length===0)throw new Error(tt);return Dt}getLeaves(ge,be,ke){const tt=[];return this._appendLeaves(tt,ge,be=be||10,ke=ke||0,0),tt}getTile(ge,be,ke){const tt=this.trees[this._limitZoom(ge)],ut=Math.pow(2,ge),{extent:St,radius:vt}=this.options,Ye=vt/St,Dt=(ke-Ye)/ut,Vt=(ke+1+Ye)/ut,jt={features:[]};return this._addTileFeatures(tt.range((be-Ye)/ut,Dt,(be+1+Ye)/ut,Vt),tt.data,be,ke,ut,jt),be===0&&this._addTileFeatures(tt.range(1-Ye/ut,Dt,1,Vt),tt.data,ut,ke,ut,jt),be===ut-1&&this._addTileFeatures(tt.range(0,Dt,Ye/ut,Vt),tt.data,-1,ke,ut,jt),jt.features.length?jt:null}getClusterExpansionZoom(ge){let be=this._getOriginZoom(ge)-1;for(;be<=this.options.maxZoom;){const ke=this.getChildren(ge);if(be++,ke.length!==1)break;ge=ke[0].properties.cluster_id}return be}_appendLeaves(ge,be,ke,tt,ut){const St=this.getChildren(be);for(const vt of St){const Ye=vt.properties;if(Ye&&Ye.cluster?ut+Ye.point_count<=tt?ut+=Ye.point_count:ut=this._appendLeaves(ge,Ye.cluster_id,ke,tt,ut):ut<tt?ut++:ge.push(vt),ge.length===ke)break}return ut}_createTree(ge){const be=new o.bj(ge.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ke=0;ke<ge.length;ke+=this.stride)be.add(ge[ke],ge[ke+1]);return be.finish(),be.data=ge,be}_addTileFeatures(ge,be,ke,tt,ut,St){for(const vt of ge){const Ye=vt*this.stride,Dt=be[Ye+lt]>1;let Vt,jt,Yt;if(Dt)Vt=br(be,Ye,this.clusterProps),jt=be[Ye],Yt=be[Ye+1];else{const xn=this.points[be[Ye+cr]];Vt=xn.properties;const[jn,Wn]=xn.geometry.coordinates;jt=Oe(jn),Yt=$e(Wn)}const Nr={type:1,geometry:[[Math.round(this.options.extent*(jt*ut-ke)),Math.round(this.options.extent*(Yt*ut-tt))]],tags:Vt};let Qr;Qr=Dt||this.options.generateId?be[Ye+cr]:this.points[be[Ye+cr]].id,Qr!==void 0&&(Nr.id=Qr),St.features.push(Nr)}}_limitZoom(ge){return Math.max(this.options.minZoom,Math.min(Math.floor(+ge),this.options.maxZoom+1))}_cluster(ge,be){const{radius:ke,extent:tt,reduce:ut,minPoints:St}=this.options,vt=ke/(tt*Math.pow(2,be)),Ye=ge.data,Dt=[],Vt=this.stride;for(let jt=0;jt<Ye.length;jt+=Vt){if(Ye[jt+2]<=be)continue;Ye[jt+2]=be;const Yt=Ye[jt],Nr=Ye[jt+1],Qr=ge.within(Ye[jt],Ye[jt+1],vt),xn=Ye[jt+lt];let jn=xn;for(const Wn of Qr){const ai=Wn*Vt;Ye[ai+2]>be&&(jn+=Ye[ai+lt])}if(jn>xn&&jn>=St){let Wn,ai=Yt*xn,Si=Nr*xn,pa=-1;const Ii=(jt/Vt<<5)+(be+1)+this.points.length;for(const po of Qr){const no=po*Vt;if(Ye[no+2]<=be)continue;Ye[no+2]=be;const Ds=Ye[no+lt];ai+=Ye[no]*Ds,Si+=Ye[no+1]*Ds,Ye[no+4]=Ii,ut&&(Wn||(Wn=this._map(Ye,jt,!0),pa=this.clusterProps.length,this.clusterProps.push(Wn)),ut(Wn,this._map(Ye,no)))}Ye[jt+4]=Ii,Dt.push(ai/jn,Si/jn,1/0,Ii,-1,jn),ut&&Dt.push(pa)}else{for(let Wn=0;Wn<Vt;Wn++)Dt.push(Ye[jt+Wn]);if(jn>1)for(const Wn of Qr){const ai=Wn*Vt;if(!(Ye[ai+2]<=be)){Ye[ai+2]=be;for(let Si=0;Si<Vt;Si++)Dt.push(Ye[ai+Si])}}}}return Dt}_getOriginId(ge){return ge-this.points.length>>5}_getOriginZoom(ge){return(ge-this.points.length)%32}_map(ge,be,ke){if(ge[be+lt]>1){const St=this.clusterProps[ge[be+qt]];return ke?Object.assign({},St):St}const tt=this.points[ge[be+cr]].properties,ut=this.options.map(tt);return ke&&ut===tt?Object.assign({},ut):ut}}function rr(qe,ge,be){return{type:"Feature",id:qe[ge+cr],properties:br(qe,ge,be),geometry:{type:"Point",coordinates:[(ke=qe[ge],360*(ke-.5)),ct(qe[ge+1])]}};var ke}function br(qe,ge,be){const ke=qe[ge+lt],tt=ke>=1e4?`${Math.round(ke/1e3)}k`:ke>=1e3?Math.round(ke/100)/10+"k":ke,ut=qe[ge+qt],St=ut===-1?{}:Object.assign({},be[ut]);return Object.assign(St,{cluster:!0,cluster_id:qe[ge+cr],point_count:ke,point_count_abbreviated:tt})}function Oe(qe){return qe/360+.5}function $e(qe){const ge=Math.sin(qe*Math.PI/180),be=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return be<0?0:be>1?1:be}function ct(qe){const ge=(180-360*qe)*Math.PI/180;return 360*Math.atan(Math.exp(ge))/Math.PI-90}var bt={exports:{}};bt.exports=function(){function qe(Ct,Mt,Ft,Qt){for(var Xt,or=Qt,sr=Ft-Mt>>1,Kt=Ft-Mt,hr=Ct[Mt],tr=Ct[Mt+1],Hr=Ct[Ft],Dn=Ct[Ft+1],Tr=Mt+3;Tr<Ft;Tr+=3){var hi=ge(Ct[Tr],Ct[Tr+1],hr,tr,Hr,Dn);if(hi>or)Xt=Tr,or=hi;else if(hi===or){var Vi=Math.abs(Tr-sr);Vi<Kt&&(Xt=Tr,Kt=Vi)}}or>Qt&&(Xt-Mt>3&&qe(Ct,Mt,Xt,Qt),Ct[Xt+2]=or,Ft-Xt>3&&qe(Ct,Xt,Ft,Qt))}function ge(Ct,Mt,Ft,Qt,Xt,or){var sr=Xt-Ft,Kt=or-Qt;if(sr!==0||Kt!==0){var hr=((Ct-Ft)*sr+(Mt-Qt)*Kt)/(sr*sr+Kt*Kt);hr>1?(Ft=Xt,Qt=or):hr>0&&(Ft+=sr*hr,Qt+=Kt*hr)}return(sr=Ct-Ft)*sr+(Kt=Mt-Qt)*Kt}function be(Ct,Mt,Ft,Qt){var Xt={id:Ct===void 0?null:Ct,type:Mt,geometry:Ft,tags:Qt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(or){var sr=or.geometry,Kt=or.type;if(Kt==="Point"||Kt==="MultiPoint"||Kt==="LineString")ke(or,sr);else if(Kt==="Polygon"||Kt==="MultiLineString")for(var hr=0;hr<sr.length;hr++)ke(or,sr[hr]);else if(Kt==="MultiPolygon")for(hr=0;hr<sr.length;hr++)for(var tr=0;tr<sr[hr].length;tr++)ke(or,sr[hr][tr])}(Xt),Xt}function ke(Ct,Mt){for(var Ft=0;Ft<Mt.length;Ft+=3)Ct.minX=Math.min(Ct.minX,Mt[Ft]),Ct.minY=Math.min(Ct.minY,Mt[Ft+1]),Ct.maxX=Math.max(Ct.maxX,Mt[Ft]),Ct.maxY=Math.max(Ct.maxY,Mt[Ft+1])}function tt(Ct,Mt,Ft,Qt){if(Mt.geometry){var Xt=Mt.geometry.coordinates,or=Mt.geometry.type,sr=Math.pow(Ft.tolerance/((1<<Ft.maxZoom)*Ft.extent),2),Kt=[],hr=Mt.id;if(Ft.promoteId?hr=Mt.properties[Ft.promoteId]:Ft.generateId&&(hr=Qt||0),or==="Point")ut(Xt,Kt);else if(or==="MultiPoint")for(var tr=0;tr<Xt.length;tr++)ut(Xt[tr],Kt);else if(or==="LineString")St(Xt,Kt,sr,!1);else if(or==="MultiLineString"){if(Ft.lineMetrics){for(tr=0;tr<Xt.length;tr++)St(Xt[tr],Kt=[],sr,!1),Ct.push(be(hr,"LineString",Kt,Mt.properties));return}vt(Xt,Kt,sr,!1)}else if(or==="Polygon")vt(Xt,Kt,sr,!0);else{if(or!=="MultiPolygon"){if(or==="GeometryCollection"){for(tr=0;tr<Mt.geometry.geometries.length;tr++)tt(Ct,{id:hr,geometry:Mt.geometry.geometries[tr],properties:Mt.properties},Ft,Qt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(tr=0;tr<Xt.length;tr++){var Hr=[];vt(Xt[tr],Hr,sr,!0),Kt.push(Hr)}}Ct.push(be(hr,or,Kt,Mt.properties))}}function ut(Ct,Mt){Mt.push(Ye(Ct[0])),Mt.push(Dt(Ct[1])),Mt.push(0)}function St(Ct,Mt,Ft,Qt){for(var Xt,or,sr=0,Kt=0;Kt<Ct.length;Kt++){var hr=Ye(Ct[Kt][0]),tr=Dt(Ct[Kt][1]);Mt.push(hr),Mt.push(tr),Mt.push(0),Kt>0&&(sr+=Qt?(Xt*tr-hr*or)/2:Math.sqrt(Math.pow(hr-Xt,2)+Math.pow(tr-or,2))),Xt=hr,or=tr}var Hr=Mt.length-3;Mt[2]=1,qe(Mt,0,Hr,Ft),Mt[Hr+2]=1,Mt.size=Math.abs(sr),Mt.start=0,Mt.end=Mt.size}function vt(Ct,Mt,Ft,Qt){for(var Xt=0;Xt<Ct.length;Xt++){var or=[];St(Ct[Xt],or,Ft,Qt),Mt.push(or)}}function Ye(Ct){return Ct/360+.5}function Dt(Ct){var Mt=Math.sin(Ct*Math.PI/180),Ft=.5-.25*Math.log((1+Mt)/(1-Mt))/Math.PI;return Ft<0?0:Ft>1?1:Ft}function Vt(Ct,Mt,Ft,Qt,Xt,or,sr,Kt){if(Qt/=Mt,or>=(Ft/=Mt)&&sr<Qt)return Ct;if(sr<Ft||or>=Qt)return null;for(var hr=[],tr=0;tr<Ct.length;tr++){var Hr=Ct[tr],Dn=Hr.geometry,Tr=Hr.type,hi=Xt===0?Hr.minX:Hr.minY,Vi=Xt===0?Hr.maxX:Hr.maxY;if(hi>=Ft&&Vi<Qt)hr.push(Hr);else if(!(Vi<Ft||hi>=Qt)){var yi=[];if(Tr==="Point"||Tr==="MultiPoint")jt(Dn,yi,Ft,Qt,Xt);else if(Tr==="LineString")Yt(Dn,yi,Ft,Qt,Xt,!1,Kt.lineMetrics);else if(Tr==="MultiLineString")Qr(Dn,yi,Ft,Qt,Xt,!1);else if(Tr==="Polygon")Qr(Dn,yi,Ft,Qt,Xt,!0);else if(Tr==="MultiPolygon")for(var Ki=0;Ki<Dn.length;Ki++){var Zi=[];Qr(Dn[Ki],Zi,Ft,Qt,Xt,!0),Zi.length&&yi.push(Zi)}if(yi.length){if(Kt.lineMetrics&&Tr==="LineString"){for(Ki=0;Ki<yi.length;Ki++)hr.push(be(Hr.id,Tr,yi[Ki],Hr.tags));continue}Tr!=="LineString"&&Tr!=="MultiLineString"||(yi.length===1?(Tr="LineString",yi=yi[0]):Tr="MultiLineString"),Tr!=="Point"&&Tr!=="MultiPoint"||(Tr=yi.length===3?"Point":"MultiPoint"),hr.push(be(Hr.id,Tr,yi,Hr.tags))}}}return hr.length?hr:null}function jt(Ct,Mt,Ft,Qt,Xt){for(var or=0;or<Ct.length;or+=3){var sr=Ct[or+Xt];sr>=Ft&&sr<=Qt&&(Mt.push(Ct[or]),Mt.push(Ct[or+1]),Mt.push(Ct[or+2]))}}function Yt(Ct,Mt,Ft,Qt,Xt,or,sr){for(var Kt,hr,tr=Nr(Ct),Hr=Xt===0?jn:Wn,Dn=Ct.start,Tr=0;Tr<Ct.length-3;Tr+=3){var hi=Ct[Tr],Vi=Ct[Tr+1],yi=Ct[Tr+2],Ki=Ct[Tr+3],Zi=Ct[Tr+4],Bn=Xt===0?hi:Vi,Uo=Xt===0?Ki:Zi,Ps=!1;sr&&(Kt=Math.sqrt(Math.pow(hi-Ki,2)+Math.pow(Vi-Zi,2))),Bn<Ft?Uo>Ft&&(hr=Hr(tr,hi,Vi,Ki,Zi,Ft),sr&&(tr.start=Dn+Kt*hr)):Bn>Qt?Uo<Qt&&(hr=Hr(tr,hi,Vi,Ki,Zi,Qt),sr&&(tr.start=Dn+Kt*hr)):xn(tr,hi,Vi,yi),Uo<Ft&&Bn>=Ft&&(hr=Hr(tr,hi,Vi,Ki,Zi,Ft),Ps=!0),Uo>Qt&&Bn<=Qt&&(hr=Hr(tr,hi,Vi,Ki,Zi,Qt),Ps=!0),!or&&Ps&&(sr&&(tr.end=Dn+Kt*hr),Mt.push(tr),tr=Nr(Ct)),sr&&(Dn+=Kt)}var Da=Ct.length-3;hi=Ct[Da],Vi=Ct[Da+1],yi=Ct[Da+2],(Bn=Xt===0?hi:Vi)>=Ft&&Bn<=Qt&&xn(tr,hi,Vi,yi),Da=tr.length-3,or&&Da>=3&&(tr[Da]!==tr[0]||tr[Da+1]!==tr[1])&&xn(tr,tr[0],tr[1],tr[2]),tr.length&&Mt.push(tr)}function Nr(Ct){var Mt=[];return Mt.size=Ct.size,Mt.start=Ct.start,Mt.end=Ct.end,Mt}function Qr(Ct,Mt,Ft,Qt,Xt,or){for(var sr=0;sr<Ct.length;sr++)Yt(Ct[sr],Mt,Ft,Qt,Xt,or,!1)}function xn(Ct,Mt,Ft,Qt){Ct.push(Mt),Ct.push(Ft),Ct.push(Qt)}function jn(Ct,Mt,Ft,Qt,Xt,or){var sr=(or-Mt)/(Qt-Mt);return Ct.push(or),Ct.push(Ft+(Xt-Ft)*sr),Ct.push(1),sr}function Wn(Ct,Mt,Ft,Qt,Xt,or){var sr=(or-Ft)/(Xt-Ft);return Ct.push(Mt+(Qt-Mt)*sr),Ct.push(or),Ct.push(1),sr}function ai(Ct,Mt){for(var Ft=[],Qt=0;Qt<Ct.length;Qt++){var Xt,or=Ct[Qt],sr=or.type;if(sr==="Point"||sr==="MultiPoint"||sr==="LineString")Xt=Si(or.geometry,Mt);else if(sr==="MultiLineString"||sr==="Polygon"){Xt=[];for(var Kt=0;Kt<or.geometry.length;Kt++)Xt.push(Si(or.geometry[Kt],Mt))}else if(sr==="MultiPolygon")for(Xt=[],Kt=0;Kt<or.geometry.length;Kt++){for(var hr=[],tr=0;tr<or.geometry[Kt].length;tr++)hr.push(Si(or.geometry[Kt][tr],Mt));Xt.push(hr)}Ft.push(be(or.id,sr,Xt,or.tags))}return Ft}function Si(Ct,Mt){var Ft=[];Ft.size=Ct.size,Ct.start!==void 0&&(Ft.start=Ct.start,Ft.end=Ct.end);for(var Qt=0;Qt<Ct.length;Qt+=3)Ft.push(Ct[Qt]+Mt,Ct[Qt+1],Ct[Qt+2]);return Ft}function pa(Ct,Mt){if(Ct.transformed)return Ct;var Ft,Qt,Xt,or=1<<Ct.z,sr=Ct.x,Kt=Ct.y;for(Ft=0;Ft<Ct.features.length;Ft++){var hr=Ct.features[Ft],tr=hr.geometry,Hr=hr.type;if(hr.geometry=[],Hr===1)for(Qt=0;Qt<tr.length;Qt+=2)hr.geometry.push(Ii(tr[Qt],tr[Qt+1],Mt,or,sr,Kt));else for(Qt=0;Qt<tr.length;Qt++){var Dn=[];for(Xt=0;Xt<tr[Qt].length;Xt+=2)Dn.push(Ii(tr[Qt][Xt],tr[Qt][Xt+1],Mt,or,sr,Kt));hr.geometry.push(Dn)}}return Ct.transformed=!0,Ct}function Ii(Ct,Mt,Ft,Qt,Xt,or){return[Math.round(Ft*(Ct*Qt-Xt)),Math.round(Ft*(Mt*Qt-or))]}function po(Ct,Mt,Ft,Qt,Xt){for(var or=Mt===Xt.maxZoom?0:Xt.tolerance/((1<<Mt)*Xt.extent),sr={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ft,y:Qt,z:Mt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Kt=0;Kt<Ct.length;Kt++){sr.numFeatures++,no(sr,Ct[Kt],or,Xt);var hr=Ct[Kt].minX,tr=Ct[Kt].minY,Hr=Ct[Kt].maxX,Dn=Ct[Kt].maxY;hr<sr.minX&&(sr.minX=hr),tr<sr.minY&&(sr.minY=tr),Hr>sr.maxX&&(sr.maxX=Hr),Dn>sr.maxY&&(sr.maxY=Dn)}return sr}function no(Ct,Mt,Ft,Qt){var Xt=Mt.geometry,or=Mt.type,sr=[];if(or==="Point"||or==="MultiPoint")for(var Kt=0;Kt<Xt.length;Kt+=3)sr.push(Xt[Kt]),sr.push(Xt[Kt+1]),Ct.numPoints++,Ct.numSimplified++;else if(or==="LineString")Ds(sr,Xt,Ct,Ft,!1,!1);else if(or==="MultiLineString"||or==="Polygon")for(Kt=0;Kt<Xt.length;Kt++)Ds(sr,Xt[Kt],Ct,Ft,or==="Polygon",Kt===0);else if(or==="MultiPolygon")for(var hr=0;hr<Xt.length;hr++){var tr=Xt[hr];for(Kt=0;Kt<tr.length;Kt++)Ds(sr,tr[Kt],Ct,Ft,!0,Kt===0)}if(sr.length){var Hr=Mt.tags||null;if(or==="LineString"&&Qt.lineMetrics){for(var Dn in Hr={},Mt.tags)Hr[Dn]=Mt.tags[Dn];Hr.mapbox_clip_start=Xt.start/Xt.size,Hr.mapbox_clip_end=Xt.end/Xt.size}var Tr={geometry:sr,type:or==="Polygon"||or==="MultiPolygon"?3:or==="LineString"||or==="MultiLineString"?2:1,tags:Hr};Mt.id!==null&&(Tr.id=Mt.id),Ct.features.push(Tr)}}function Ds(Ct,Mt,Ft,Qt,Xt,or){var sr=Qt*Qt;if(Qt>0&&Mt.size<(Xt?sr:Qt))Ft.numPoints+=Mt.length/3;else{for(var Kt=[],hr=0;hr<Mt.length;hr+=3)(Qt===0||Mt[hr+2]>sr)&&(Ft.numSimplified++,Kt.push(Mt[hr]),Kt.push(Mt[hr+1])),Ft.numPoints++;Xt&&function(tr,Hr){for(var Dn=0,Tr=0,hi=tr.length,Vi=hi-2;Tr<hi;Vi=Tr,Tr+=2)Dn+=(tr[Tr]-tr[Vi])*(tr[Tr+1]+tr[Vi+1]);if(Dn>0===Hr)for(Tr=0,hi=tr.length;Tr<hi/2;Tr+=2){var yi=tr[Tr],Ki=tr[Tr+1];tr[Tr]=tr[hi-2-Tr],tr[Tr+1]=tr[hi-1-Tr],tr[hi-2-Tr]=yi,tr[hi-1-Tr]=Ki}}(Kt,or),Ct.push(Kt)}}function sa(Ct,Mt){var Ft=(Mt=this.options=function(Xt,or){for(var sr in or)Xt[sr]=or[sr];return Xt}(Object.create(this.options),Mt)).debug;if(Ft&&console.time("preprocess data"),Mt.maxZoom<0||Mt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Mt.promoteId&&Mt.generateId)throw new Error("promoteId and generateId cannot be used together.");var Qt=function(Xt,or){var sr=[];if(Xt.type==="FeatureCollection")for(var Kt=0;Kt<Xt.features.length;Kt++)tt(sr,Xt.features[Kt],or,Kt);else tt(sr,Xt.type==="Feature"?Xt:{geometry:Xt},or);return sr}(Ct,Mt);this.tiles={},this.tileCoords=[],Ft&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Mt.indexMaxZoom,Mt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Qt=function(Xt,or){var sr=or.buffer/or.extent,Kt=Xt,hr=Vt(Xt,1,-1-sr,sr,0,-1,2,or),tr=Vt(Xt,1,1-sr,2+sr,0,-1,2,or);return(hr||tr)&&(Kt=Vt(Xt,1,-sr,1+sr,0,-1,2,or)||[],hr&&(Kt=ai(hr,1).concat(Kt)),tr&&(Kt=Kt.concat(ai(tr,-1)))),Kt}(Qt,Mt)).length&&this.splitTile(Qt,0,0,0),Ft&&(Qt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ni(Ct,Mt,Ft){return 32*((1<<Ct)*Ft+Mt)+Ct}return sa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},sa.prototype.splitTile=function(Ct,Mt,Ft,Qt,Xt,or,sr){for(var Kt=[Ct,Mt,Ft,Qt],hr=this.options,tr=hr.debug;Kt.length;){Qt=Kt.pop(),Ft=Kt.pop(),Mt=Kt.pop(),Ct=Kt.pop();var Hr=1<<Mt,Dn=Ni(Mt,Ft,Qt),Tr=this.tiles[Dn];if(!Tr&&(tr>1&&console.time("creation"),Tr=this.tiles[Dn]=po(Ct,Mt,Ft,Qt,hr),this.tileCoords.push({z:Mt,x:Ft,y:Qt}),tr)){tr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Mt,Ft,Qt,Tr.numFeatures,Tr.numPoints,Tr.numSimplified),console.timeEnd("creation"));var hi="z"+Mt;this.stats[hi]=(this.stats[hi]||0)+1,this.total++}if(Tr.source=Ct,Xt){if(Mt===hr.maxZoom||Mt===Xt)continue;var Vi=1<<Xt-Mt;if(Ft!==Math.floor(or/Vi)||Qt!==Math.floor(sr/Vi))continue}else if(Mt===hr.indexMaxZoom||Tr.numPoints<=hr.indexMaxPoints)continue;if(Tr.source=null,Ct.length!==0){tr>1&&console.time("clipping");var yi,Ki,Zi,Bn,Uo,Ps,Da=.5*hr.buffer/hr.extent,xc=.5-Da,Dd=.5+Da,go=1+Da;yi=Ki=Zi=Bn=null,Uo=Vt(Ct,Hr,Ft-Da,Ft+Dd,0,Tr.minX,Tr.maxX,hr),Ps=Vt(Ct,Hr,Ft+xc,Ft+go,0,Tr.minX,Tr.maxX,hr),Ct=null,Uo&&(yi=Vt(Uo,Hr,Qt-Da,Qt+Dd,1,Tr.minY,Tr.maxY,hr),Ki=Vt(Uo,Hr,Qt+xc,Qt+go,1,Tr.minY,Tr.maxY,hr),Uo=null),Ps&&(Zi=Vt(Ps,Hr,Qt-Da,Qt+Dd,1,Tr.minY,Tr.maxY,hr),Bn=Vt(Ps,Hr,Qt+xc,Qt+go,1,Tr.minY,Tr.maxY,hr),Ps=null),tr>1&&console.timeEnd("clipping"),Kt.push(yi||[],Mt+1,2*Ft,2*Qt),Kt.push(Ki||[],Mt+1,2*Ft,2*Qt+1),Kt.push(Zi||[],Mt+1,2*Ft+1,2*Qt),Kt.push(Bn||[],Mt+1,2*Ft+1,2*Qt+1)}}},sa.prototype.getTile=function(Ct,Mt,Ft){var Qt=this.options,Xt=Qt.extent,or=Qt.debug;if(Ct<0||Ct>24)return null;var sr=1<<Ct,Kt=Ni(Ct,Mt=(Mt%sr+sr)%sr,Ft);if(this.tiles[Kt])return pa(this.tiles[Kt],Xt);or>1&&console.log("drilling down to z%d-%d-%d",Ct,Mt,Ft);for(var hr,tr=Ct,Hr=Mt,Dn=Ft;!hr&&tr>0;)tr--,Hr=Math.floor(Hr/2),Dn=Math.floor(Dn/2),hr=this.tiles[Ni(tr,Hr,Dn)];return hr&&hr.source?(or>1&&console.log("found parent tile z%d-%d-%d",tr,Hr,Dn),or>1&&console.time("drilling down"),this.splitTile(hr.source,tr,Hr,Dn,Ct,Mt,Ft),or>1&&console.timeEnd("drilling down"),this.tiles[Kt]?pa(this.tiles[Kt],Xt):null):null},function(Ct,Mt){return new sa(Ct,Mt)}}();var At=o.dX(bt.exports);function Jt(qe,ge){const be=qe.tileID.canonical;if(!this._geoJSONIndex)return ge(null,null);const ke=this._geoJSONIndex.getTile(be.z,be.x,be.y);if(!ke)return ge(null,null);const tt=new $(ke.features);let ut=Rt(tt);ut.byteOffset===0&&ut.byteLength===ut.buffer.byteLength||(ut=new Uint8Array(ut)),ge(null,{vectorTile:tt,rawData:ut.buffer})}class mt extends P{constructor(ge,be,ke,tt,ut,St){super(ge,be,ke,tt,Jt,St),ut&&(this.loadGeoJSON=ut),this._featureMap=new Map}loadData(ge,be){const ke=ge&&ge.request,tt=ke&&ke.collectResourceTiming;this.loadGeoJSON(ge,(ut,St)=>{if(ut||!St)return be(ut);if(typeof St!="object")return be(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));{try{if(ge.filter){const Ye=o.t(ge.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ye.result==="error")throw new Error(Ye.value.map(Dt=>`${Dt.key}: ${Dt.message}`).join(", "));St.features=St.features.filter(Dt=>Ye.value.evaluate({zoom:0},Dt))}if(ge.dynamic){St.type==="Feature"&&(St={type:"FeatureCollection",features:[St]}),ge.append||this._featureMap.clear();for(const Ye of St.features||[]){const Dt=Ye.id;Dt!==void 0&&(Ye.geometry?this._featureMap.set(Dt,Ye):this._featureMap.delete(Dt))}St.features=[...this._featureMap.values()]}this._geoJSONIndex=ge.cluster?new Ut(function({superclusterOptions:Ye,clusterProperties:Dt}){if(!Dt||!Ye)return Ye;const Vt={},jt={},Yt={accumulated:null,zoom:0},Nr={properties:null},Qr=Object.keys(Dt);for(const xn of Qr){const[jn,Wn]=Dt[xn],ai=o.t(Wn),Si=o.t(typeof jn=="string"?[jn,["accumulated"],["get",xn]]:jn);Vt[xn]=ai.value,jt[xn]=Si.value}return Ye.map=xn=>{Nr.properties=xn;const jn={};for(const Wn of Qr)jn[Wn]=Vt[Wn].evaluate(Yt,Nr);return jn},Ye.reduce=(xn,jn)=>{Nr.properties=jn;for(const Wn of Qr)Yt.accumulated=xn[Wn],xn[Wn]=jt[Wn].evaluate(Yt,Nr)},Ye}(ge)).load(St.features):At(St,ge.geojsonVtOptions)}catch(Ye){return be(Ye)}this.loaded={};const vt={};if(tt){const Ye=d(ke);Ye&&(vt.resourceTiming={},vt.resourceTiming[ge.source]=JSON.parse(JSON.stringify(Ye)))}be(null,vt)}})}reloadTile(ge,be){const ke=this.loaded;return ke&&ke[ge.uid]?super.reloadTile(ge,be):this.loadTile(ge,be)}loadGeoJSON(ge,be){if(ge.request)o.g(ge.request,be);else{if(typeof ge.data!="string")return be(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));try{return be(null,JSON.parse(ge.data))}catch{return be(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ge,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(ge.clusterId))}catch(ke){be(ke)}}getClusterChildren(ge,be){try{be(null,this._geoJSONIndex.getChildren(ge.clusterId))}catch(ke){be(ke)}}getClusterLeaves(ge,be){try{be(null,this._geoJSONIndex.getLeaves(ge.clusterId,ge.limit,ge.offset))}catch(ke){be(ke)}}}class ht{constructor(ge,be){this.tileID=new o.ap(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),this.tileZoom=ge.tileZoom,this.uid=ge.uid,this.zoom=ge.zoom,this.canonical=ge.tileID.canonical,this.pixelRatio=ge.pixelRatio,this.tileSize=ge.tileSize,this.source=ge.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ge.projection,this.brightness=be}parse(ge,be,ke,tt){this.status="parsing";const ut=new o.ap(ke.tileID.overscaledZ,ke.tileID.wrap,ke.tileID.canonical.z,ke.tileID.canonical.x,ke.tileID.canonical.y),St={},vt=be.familiesBySource[ke.source],Ye=new o.dL(ut,ke.promoteId);return Ye.bucketLayerIDs=[],Ye.is3DTile=!0,o.dY(ge).then(Dt=>{if(!Dt)return tt(new Error("Could not parse tile"));const Vt=o.dZ(Dt,1/o.bU(ke.tileID.canonical)),jt=Dt.json.extensionsUsed&&Dt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Dt.json.asset.extras&&Dt.json.asset.extras.MAPBOX_mesh_features,Yt=Dt.json.extensionsUsed&&Dt.json.extensionsUsed.includes("EXT_meshopt_compression"),Nr=new o.N(this.zoom,{brightness:this.brightness});for(const Qr in vt)for(const xn of vt[Qr]){const jn=xn[0];Ye.bucketLayerIDs.push(xn.map(ai=>ai.id)),jn.recalculate(Nr,[]);const Wn=new o.d_(Vt,ut,jt,Yt,this.brightness,Ye);jt||(Wn.needsUpload=!0),St[jn.fqid]=Wn,Wn.evaluate(jn)}this.status="done",tt(null,{buckets:St,featureIndex:Ye})}).catch(Dt=>tt(new Error(Dt.message)))}}class er{constructor(ge,be,ke,tt,ut,St){this.actor=ge,this.layerIndex=be,this.brightness=St,this.loading={},this.loaded={}}loadTile(ge,be){const ke=ge.uid,tt=this.loading[ke]=new ht(ge,this.brightness);o.b1(ge.request,(ut,St)=>{const vt=!this.loading[ke];return delete this.loading[ke],vt||ut?(tt.status="done",vt||(this.loaded[ke]=tt),be(ut)):St&&St.byteLength!==0?void tt.parse(St,this.layerIndex,ge,(Ye,Dt)=>{tt.status="done",this.loaded=this.loaded||{},this.loaded[ke]=tt,Ye||!Dt?be(Ye):be(null,Dt)}):(tt.status="done",this.loaded[ke]=tt,be())})}reloadTile(ge,be){const ke=this.loaded,tt=ge.uid;if(ke&&ke[tt]){const ut=ke[tt];ut.projection=ge.projection,ut.brightness=ge.brightness;const St=(vt,Ye)=>{ut.reloadCallback&&(delete ut.reloadCallback,this.loadTile(ge,be)),be(vt,Ye)};ut.status==="parsing"?ut.reloadCallback=St:ut.status==="done"&&this.loadTile(ge,be)}}abortTile(ge,be){const ke=ge.uid;this.loading[ke]&&delete this.loading[ke],be()}removeTile(ge,be){const ke=this.loaded,tt=ge.uid;ke&&ke[tt]&&delete ke[tt],be()}}class Bt{constructor(ge){this.self=ge,this.actor=new o.d$(ge,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.br({name:"mercator"}),this.workerSourceTypes={vector:P,geojson:mt,"batched-model":er},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(be,ke)=>{if(this.workerSourceTypes[be])throw new Error(`Worker source with name "${be}" already registered.`);this.workerSourceTypes[be]=ke},this.self.registerRTLTextPlugin=be=>{if(o.e0.isParsed())throw new Error("RTL text plugin already registered.");o.e0.applyArabicShaping=be.applyArabicShaping,o.e0.processBidirectionalText=be.processBidirectionalText,o.e0.processStyledBidirectionalText=be.processStyledBidirectionalText}}clearCaches(ge,be,ke){delete this.layerIndexes[ge],delete this.availableImages[ge],delete this.workerSources[ge],delete this.demWorkerSources[ge],delete this.rasterArrayWorkerSource,ke()}checkIfReady(ge,be,ke){ke()}setReferrer(ge,be){this.referrer=be}spriteLoaded(ge,{scope:be,isLoaded:ke}){if(this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),this.isSpriteLoaded[ge][be]=ke,this.workerSources[ge]&&this.workerSources[ge][be])for(const tt in this.workerSources[ge][be]){const ut=this.workerSources[ge][be][tt];for(const St in ut)ut[St]instanceof P&&(ut[St].isSpriteLoaded=ke,ut[St].fire(new o.b("isSpriteLoaded")))}}setImages(ge,{scope:be,images:ke},tt){if(this.availableImages[ge]||(this.availableImages[ge]={}),this.availableImages[ge][be]=ke,this.workerSources[ge]&&this.workerSources[ge][be]){for(const ut in this.workerSources[ge][be]){const St=this.workerSources[ge][be][ut];for(const vt in St)St[vt].availableImages=ke}tt()}else tt()}setProjection(ge,be){this.projections[ge]=o.br(be)}setBrightness(ge,be,ke){this.brightness=be,ke()}setLayers(ge,be,ke){this.getLayerIndex(ge,be.scope).replace(be.layers,be.options),ke()}updateLayers(ge,be,ke){this.getLayerIndex(ge,be.scope).update(be.layers,be.removedIds,be.options),ke()}loadTile(ge,be,ke){be.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,be.type,be.source,be.scope).loadTile(be,ke)}loadDEMTile(ge,be,ke){this.getDEMWorkerSource(ge,be.source,be.scope).loadTile(be,ke)}decodeRasterArray(ge,be,ke){this.getRasterArrayWorkerSource().decodeRasterArray(be,ke)}reloadTile(ge,be,ke){be.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,be.type,be.source,be.scope).reloadTile(be,ke)}abortTile(ge,be,ke){this.getWorkerSource(ge,be.type,be.source,be.scope).abortTile(be,ke)}removeTile(ge,be,ke){this.getWorkerSource(ge,be.type,be.source,be.scope).removeTile(be,ke)}removeSource(ge,be,ke){if(!(this.workerSources[ge]&&this.workerSources[ge][be.scope]&&this.workerSources[ge][be.scope][be.type]&&this.workerSources[ge][be.scope][be.type][be.source]))return;const tt=this.workerSources[ge][be.scope][be.type][be.source];delete this.workerSources[ge][be.scope][be.type][be.source],tt.removeSource!==void 0?tt.removeSource(be,ke):ke()}loadWorkerSource(ge,be,ke){try{this.self.importScripts(be.url),ke()}catch(tt){ke(tt.toString())}}syncRTLPluginState(ge,be,ke){try{o.e0.setState(be);const tt=o.e0.getPluginURL();if(o.e0.isLoaded()&&!o.e0.isParsed()&&tt!=null){this.self.importScripts(tt);const ut=o.e0.isParsed();ke(ut?void 0:new Error(`RTL Text Plugin failed to import scripts from ${tt}`),ut)}}catch(tt){ke(tt.toString())}}setDracoUrl(ge,be){this.dracoUrl=be}getAvailableImages(ge,be){this.availableImages[ge]||(this.availableImages[ge]={});let ke=this.availableImages[ge][be];return ke||(ke=[]),ke}getLayerIndex(ge,be){this.layerIndexes[ge]||(this.layerIndexes[ge]={});let ke=this.layerIndexes[ge][be];return ke||(ke=this.layerIndexes[ge][be]=new y,ke.scope=be),ke}getWorkerSource(ge,be,ke,tt){if(this.workerSources[ge]||(this.workerSources[ge]={}),this.workerSources[ge][tt]||(this.workerSources[ge][tt]={}),this.workerSources[ge][tt][be]||(this.workerSources[ge][tt][be]={}),this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),!this.workerSources[ge][tt][be][ke]){const ut={send:(St,vt,Ye,Dt,Vt,jt)=>{this.actor.send(St,vt,Ye,ge,Vt,jt)},scheduler:this.actor.scheduler};this.workerSources[ge][tt][be][ke]=new this.workerSourceTypes[be](ut,this.getLayerIndex(ge,tt),this.getAvailableImages(ge,tt),this.isSpriteLoaded[ge][tt],void 0,this.brightness)}return this.workerSources[ge][tt][be][ke]}getDEMWorkerSource(ge,be,ke){return this.demWorkerSources[ge]||(this.demWorkerSources[ge]={}),this.demWorkerSources[ge][ke]||(this.demWorkerSources[ge][ke]={}),this.demWorkerSources[ge][ke][be]||(this.demWorkerSources[ge][ke][be]=new O),this.demWorkerSources[ge][ke][be]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new z),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ge,be){o.e1(be)}getWorkerPerformanceMetrics(ge,be,ke){ke(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Bt(self)),Bt}),l(["./shared"],function(o){function d(w,f){if(Array.isArray(w)){if(!Array.isArray(f)||w.length!==f.length)return!1;for(let v=0;v<w.length;v++)if(!d(w[v],f[v]))return!1;return!0}if(typeof w=="object"&&w!==null&&f!==null){if(typeof f!="object"||Object.keys(w).length!==Object.keys(f).length)return!1;for(const v in w)if(!d(w[v],f[v]))return!1;return!0}return w===f}var g=m;function m(w){return!function(f){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,C,E=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(E);try{C=new Worker(R),S=!0}catch{S=!1}return C&&C.terminate(),URL.revokeObjectURL(R),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var C=S.getContext("2d");if(!C)return!1;var E=C.getImageData(0,0,1,1);return E&&E.width===S.width}()?(y[v=f&&f.failIfMajorPerformanceCaveat]===void 0&&(y[v]=function(S){var C,E=function(R){var B=document.createElement("canvas"),G=Object.create(m.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=R,B.getContext("webgl2",G)}(S);if(!E)return!1;try{C=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!C||E.isContextLost())&&(E.shaderSource(C,"void main() {}"),E.compileShader(C),E.getShaderParameter(C,E.COMPILE_STATUS)===!0)}(v)),y[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var v}(w)}var y={};function x(w,f,v){const S=document.createElement(w);return f!=null&&(S.className=f),v&&v.appendChild(S),S}function A(w,f,v){const S=document.createElementNS("http://www.w3.org/2000/svg",w);for(const C of Object.keys(f))S.setAttributeNS(null,C,String(f[C]));return v&&v.appendChild(S),S}m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const M=typeof document<"u"?document.documentElement&&document.documentElement.style:null,D=M&&M.userSelect!==void 0?"userSelect":"WebkitUserSelect";let P;function O(){M&&D&&(P=M[D],M[D]="none")}function z(){M&&D&&(M[D]=P)}function V(w){w.preventDefault(),w.stopPropagation(),window.removeEventListener("click",V,!0)}function H(){window.addEventListener("click",V,!0),window.setTimeout(()=>{window.removeEventListener("click",V,!0)},0)}function $(w,f){const v=w.getBoundingClientRect();return Y(w,v,f)}function X(w,f){const v=w.getBoundingClientRect(),S=[];for(let C=0;C<f.length;C++)S.push(Y(w,v,f[C]));return S}function W(w){return window.InstallTrigger!==void 0&&w.button===2&&w.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:w.button}function Y(w,f,v){const S=w.offsetWidth===f.width?1:w.offsetWidth/f.width;return new o.P((v.clientX-f.left)*S,(v.clientY-f.top)*S)}class J{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(f,v){this._updatedSourceCaches[f]=v,this.setDirty()}discardSourceCacheUpdate(f){delete this._updatedSourceCaches[f]}updateLayer(f){const v=f.scope;this._updatedLayers[v]=this._updatedLayers[v]||new Set,this._updatedLayers[v].add(f.id),this.setDirty()}removeLayer(f){const v=f.scope;this._removedLayers[v]=this._removedLayers[v]||{},this._updatedLayers[v]=this._updatedLayers[v]||new Set,this._removedLayers[v][f.id]=f,this._updatedLayers[v].delete(f.id),this._updatedPaintProps.delete(f.fqid),this.setDirty()}getRemovedLayer(f){return this._removedLayers[f.scope]?this._removedLayers[f.scope][f.id]:null}discardLayerRemoval(f){this._removedLayers[f.scope]&&delete this._removedLayers[f.scope][f.id]}getLayerUpdatesByScope(){const f={};for(const v in this._updatedLayers)f[v]=f[v]||{},f[v].updatedIds=Array.from(this._updatedLayers[v].values());for(const v in this._removedLayers)f[v]=f[v]||{},f[v].removedIds=Object.keys(this._removedLayers[v]);return f}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(f){this._updatedPaintProps.add(f.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(f){this._updatedImages.add(f),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}class re extends o.E{constructor(f){super(),this.requestManager=f,this.models={"":{}},this.numModelsLoading={}}loadModel(f,v){return o.l(this.requestManager.transformRequest(v,o.R.Model).url).then(S=>{if(!S)return;const C=o.c(S),E=new o.M(f,void 0,void 0,C);return E.computeBoundsAndApplyParent(),E}).catch(S=>{if(S&&S.status===404)return null;this.fire(new o.a(new Error(`Could not load model ${f} from ${v}: ${S.message}`)))})}load(f,v){this.models[v]||(this.models[v]={});const S=Object.keys(f);this.numModelsLoading[v]=(this.numModelsLoading[v]||0)+S.length;const C=[];for(const E of S)C.push(this.loadModel(E,f[E]));Promise.allSettled(C).then(E=>{for(let R=0;R<E.length;R++){const{status:B,value:G}=E[R];B==="fulfilled"&&G&&(this.models[v][S[R]]={model:G,numReferences:1})}this.numModelsLoading[v]-=S.length,this.fire(new o.b("data",{dataType:"style"}))}).catch(E=>{this.fire(new o.a(new Error(`Could not load models: ${E.message}`)))})}isLoaded(){for(const f in this.numModelsLoading)if(this.numModelsLoading[f]>0)return!1;return!0}hasModel(f,v){return!!this.getModel(f,v)}getModel(f,v){return this.models[v]||(this.models[v]={}),this.models[v][f]?this.models[v][f].model:void 0}addModel(f,v,S){this.models[S]||(this.models[S]={}),this.hasModel(f,S)&&this.models[S][f].numReferences++,this.load({[f]:this.requestManager.normalizeModelURL(v)},S)}addModels(f,v){this.models[v]||(this.models[v]={});const S={};for(const C in f)this.models[v][C]={},S[C]=this.requestManager.normalizeModelURL(f[C]);this.load(S,v)}addModelsFromBucket(f,v){this.models[v]||(this.models[v]={});const S={};for(const C of f)this.hasModel(C,v)?this.models[v][C].numReferences++:S[C]=this.requestManager.normalizeModelURL(C);this.load(S,v)}removeModel(f,v){if(this.models[v]&&this.models[v][f]&&(this.models[v][f].numReferences--,this.models[v][f].numReferences===0)){const S=this.models[v][f].model;delete this.models[v][f],S.destroy()}}listModels(f){return this.models[f]||(this.models[f]={}),Object.keys(this.models[f])}upload(f,v){this.models[v]||(this.models[v]={});for(const S in this.models[v])this.models[v][S].model&&this.models[v][S].model.upload(f.context)}}class ae{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(f,v,S){const C=String(v);if(this.stateChanges[f]=this.stateChanges[f]||{},this.stateChanges[f][C]=this.stateChanges[f][C]||{},o.e(this.stateChanges[f][C],S),this.deletedStates[f]===null){this.deletedStates[f]={};for(const E in this.state[f])E!==C&&(this.deletedStates[f][E]=null)}else if(this.deletedStates[f]&&this.deletedStates[f][C]===null){this.deletedStates[f][C]={};for(const E in this.state[f][C])S[E]||(this.deletedStates[f][C][E]=null)}else for(const E in S)this.deletedStates[f]&&this.deletedStates[f][C]&&this.deletedStates[f][C][E]===null&&delete this.deletedStates[f][C][E]}removeFeatureState(f,v,S){if(this.deletedStates[f]===null)return;const C=String(v);if(this.deletedStates[f]=this.deletedStates[f]||{},S&&v!==void 0)this.deletedStates[f][C]!==null&&(this.deletedStates[f][C]=this.deletedStates[f][C]||{},this.deletedStates[f][C][S]=null);else if(v!==void 0)if(this.stateChanges[f]&&this.stateChanges[f][C])for(S in this.deletedStates[f][C]={},this.stateChanges[f][C])this.deletedStates[f][C][S]=null;else this.deletedStates[f][C]=null;else this.deletedStates[f]=null}getState(f,v){const S=String(v),C=o.e({},(this.state[f]||{})[S],(this.stateChanges[f]||{})[S]);if(this.deletedStates[f]===null)return{};if(this.deletedStates[f]){const E=this.deletedStates[f][v];if(E===null)return{};for(const R in E)delete C[R]}return C}initializeTileState(f,v){f.setFeatureState(this.state,v)}coalesceChanges(f,v){const S={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const E={};for(const R in this.stateChanges[C])this.state[C][R]||(this.state[C][R]={}),o.e(this.state[C][R],this.stateChanges[C][R]),E[R]=this.state[C][R];S[C]=E}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const E={};if(this.deletedStates[C]===null)for(const R in this.state[C])E[R]={},this.state[C][R]={};else for(const R in this.deletedStates[C]){if(this.deletedStates[C][R]===null)this.state[C][R]={};else if(this.state[C][R])for(const B of Object.keys(this.deletedStates[C][R]))delete this.state[C][R][B];E[R]=this.state[C][R]}S[C]=S[C]||{},o.e(S[C],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(S).length!==0)for(const C in f)f[C].setFeatureState(S,v)}}function pe(w){const{userImage:f}=w;return!!(f&&f.render&&f.render())&&(w.data.replace(new Uint8Array(f.data.buffer)),!0)}class de extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(f){this.images[f]={},this.loaded[f]=!1,this.updatedImages[f]={},this.patterns[f]={},this.callbackDispatchedThisFrame[f]={},this.atlasImage[f]=new o.h({width:1,height:1})}isLoaded(){for(const f in this.loaded)if(!this.loaded[f])return!1;return!0}setLoaded(f,v){if(this.loaded[v]!==f&&(this.loaded[v]=f,f)){for(const{ids:S,callback:C}of this.requestors)this._notify(S,v,C);this.requestors=[]}}hasImage(f,v){return!!this.getImage(f,v)}getImage(f,v){return this.images[v][f]}addImage(f,v,S){this._validate(f,S)&&(this.images[v][f]=S)}_validate(f,v){let S=!0;return this._validateStretch(v.stretchX,v.data&&v.data.width)||(this.fire(new o.a(new Error(`Image "${f}" has invalid "stretchX" value`))),S=!1),this._validateStretch(v.stretchY,v.data&&v.data.height)||(this.fire(new o.a(new Error(`Image "${f}" has invalid "stretchY" value`))),S=!1),this._validateContent(v.content,v)||(this.fire(new o.a(new Error(`Image "${f}" has invalid "content" value`))),S=!1),S}_validateStretch(f,v){if(!f)return!0;let S=0;for(const C of f){if(C[0]<S||C[1]<C[0]||v<C[1])return!1;S=C[1]}return!0}_validateContent(f,v){return!(f&&(f.length!==4||f[0]<0||v.data.width<f[0]||f[1]<0||v.data.height<f[1]||f[2]<0||v.data.width<f[2]||f[3]<0||v.data.height<f[3]||f[2]<f[0]||f[3]<f[1]))}updateImage(f,v,S){S.version=this.images[v][f].version+1,this.images[v][f]=S,this.updatedImages[v][f]=!0}removeImage(f,v){const S=this.images[v][f];delete this.images[v][f],delete this.patterns[v][f],S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()}listImages(f){return Object.keys(this.images[f])}getImages(f,v,S){let C=!0;const E=!!this.loaded[v];if(!E)for(const R of f)this.images[v][R]||(C=!1);E||C?this._notify(f,v,S):this.requestors.push({ids:f,scope:v,callback:S})}getUpdatedImages(f){return this.updatedImages[f]}_notify(f,v,S){const C={};for(const E of f){this.images[v][E]||this.fire(new o.b("styleimagemissing",{id:E}));const R=this.images[v][E];R?C[E]={data:R.data.clone(),pixelRatio:R.pixelRatio,sdf:R.sdf,version:R.version,stretchX:R.stretchX,stretchY:R.stretchY,content:R.content,hasRenderCallback:!!(R.userImage&&R.userImage.render)}:o.w(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}S(null,C)}getPixelSize(f){const{width:v,height:S}=this.atlasImage[f];return{width:v,height:S}}getPattern(f,v){const S=this.patterns[v][f],C=this.getImage(f,v);if(!C)return null;if(S&&S.position.version===C.version)return S.position;if(S)S.position.version=C.version;else{const E={w:C.data.width+2,h:C.data.height+2,x:0,y:0},R=new o.I(E,C);this.patterns[v][f]={bin:E,position:R}}return this._updatePatternAtlas(v),this.patterns[v][f].position}bind(f,v){const S=f.gl;let C=this.atlasTexture[v];C?this.dirty&&(C.update(this.atlasImage[v]),this.dirty=!1):(C=new o.T(f,this.atlasImage[v],S.RGBA),this.atlasTexture[v]=C),C.bind(S.LINEAR,S.CLAMP_TO_EDGE)}_updatePatternAtlas(f){const v=[];for(const R in this.patterns[f])v.push(this.patterns[f][R].bin);const{w:S,h:C}=o.p(v),E=this.atlasImage[f];E.resize({width:S||1,height:C||1});for(const R in this.patterns[f]){const{bin:B}=this.patterns[f][R],G=B.x+1,j=B.y+1,q=this.images[f][R].data,K=q.width,te=q.height;o.h.copy(q,E,{x:0,y:0},{x:G,y:j},{width:K,height:te}),o.h.copy(q,E,{x:0,y:te-1},{x:G,y:j-1},{width:K,height:1}),o.h.copy(q,E,{x:0,y:0},{x:G,y:j+te},{width:K,height:1}),o.h.copy(q,E,{x:K-1,y:0},{x:G-1,y:j},{width:1,height:te}),o.h.copy(q,E,{x:0,y:0},{x:G+K,y:j},{width:1,height:te})}this.dirty=!0}beginFrame(){for(const f in this.images)this.callbackDispatchedThisFrame[f]={}}dispatchRenderCallbacks(f,v){for(const S of f){if(this.callbackDispatchedThisFrame[v][S])continue;this.callbackDispatchedThisFrame[v][S]=!0;const C=this.images[v][S];pe(C)&&this.updateImage(S,v,C)}}}function ve(w){const f=w.key,v=w.value,S=w.valueSpec||{},C=w.objectElementValidators||{},E=w.style,R=w.styleSpec;let B=[];const G=o.j(v);if(G!=="object")return[new o.V(f,v,`object expected, ${G} found`)];for(const j in v){const q=j.split(".")[0];let K;C[q]?K=C[q]:S[q]?K=At:C["*"]?K=C["*"]:S["*"]&&(K=At),K?B=B.concat(K({key:(f&&`${f}.`)+j,value:v[j],valueSpec:S[q]||S["*"],style:E,styleSpec:R,object:v,objectKey:j},v)):B.push(new o.i(f,v[j],`unknown property "${j}"`))}for(const j in S)C[j]||S[j].required&&S[j].default===void 0&&v[j]===void 0&&B.push(new o.V(f,v,`missing required property "${j}"`));return B}function me(w){const f=w.value,v=w.valueSpec,S=w.style,C=w.styleSpec,E=w.key,R=w.arrayElementValidator||At;if(o.j(f)!=="array")return[new o.V(E,f,`array expected, ${o.j(f)} found`)];if(v.length&&f.length!==v.length)return[new o.V(E,f,`array length ${v.length} expected, length ${f.length} found`)];if(v["min-length"]&&f.length<v["min-length"])return[new o.V(E,f,`array length at least ${v["min-length"]} expected, length ${f.length} found`)];let B={type:v.value,values:v.values,minimum:v.minimum,maximum:v.maximum,function:void 0};C.$version<7&&(B.function=v.function),o.j(v.value)==="object"&&(B=v.value);let G=[];for(let j=0;j<f.length;j++)G=G.concat(R({array:f,arrayIndex:j,value:f[j],valueSpec:B,style:S,styleSpec:C,key:`${E}[${j}]`},!0));return G}function Ie(w){const f=w.key,v=w.value,S=w.valueSpec;let C=o.j(v);if(C==="number"&&v!=v&&(C="NaN"),C!=="number")return[new o.V(f,v,`number expected, ${C} found`)];if("minimum"in S){let E=S.minimum;if(o.j(S.minimum)==="array"&&(E=S.minimum[w.arrayIndex]),v<E)return[new o.V(f,v,`${v} is less than the minimum value ${E}`)]}if("maximum"in S){let E=S.maximum;if(o.j(S.maximum)==="array"&&(E=S.maximum[w.arrayIndex]),v>E)return[new o.V(f,v,`${v} is greater than the maximum value ${E}`)]}return[]}function Le(w){const f=w.valueSpec,v=o.u(w.value.type);let S,C,E,R={};const B=v!=="categorical"&&w.value.property===void 0,G=!B,j=o.j(w.value.stops)==="array"&&o.j(w.value.stops[0])==="array"&&o.j(w.value.stops[0][0])==="object",q=ve({key:w.key,value:w.value,valueSpec:w.styleSpec.function,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{stops:function(ne){if(v==="identity")return[new o.V(ne.key,ne.value,'identity function may not have a "stops" property')];let le=[];const se=ne.value;return le=le.concat(me({key:ne.key,value:se,valueSpec:ne.valueSpec,style:ne.style,styleSpec:ne.styleSpec,arrayElementValidator:K})),o.j(se)==="array"&&se.length===0&&le.push(new o.V(ne.key,se,"array must have at least one stop")),le},default:function(ne){return At({key:ne.key,value:ne.value,valueSpec:f,style:ne.style,styleSpec:ne.styleSpec})}}});return v==="identity"&&B&&q.push(new o.V(w.key,w.value,'missing required property "property"')),v==="identity"||w.value.stops||q.push(new o.V(w.key,w.value,'missing required property "stops"')),v==="exponential"&&w.valueSpec.expression&&!o.s(w.valueSpec)&&q.push(new o.V(w.key,w.value,"exponential functions not supported")),w.styleSpec.$version>=8&&(G&&!o.m(w.valueSpec)?q.push(new o.V(w.key,w.value,"property functions not supported")):B&&!o.n(w.valueSpec)&&q.push(new o.V(w.key,w.value,"zoom functions not supported"))),v!=="categorical"&&!j||w.value.property!==void 0||q.push(new o.V(w.key,w.value,'"property" property is required')),q;function K(ne){let le=[];const se=ne.value,ue=ne.key;if(o.j(se)!=="array")return[new o.V(ue,se,`array expected, ${o.j(se)} found`)];if(se.length!==2)return[new o.V(ue,se,`array length 2 expected, length ${se.length} found`)];if(j){if(o.j(se[0])!=="object")return[new o.V(ue,se,`object expected, ${o.j(se[0])} found`)];if(se[0].zoom===void 0)return[new o.V(ue,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new o.V(ue,se,"object stop key must have value")];const ce=o.u(se[0].zoom);if(typeof ce!="number")return[new o.V(ue,se[0].zoom,"stop zoom values must be numbers")];if(E&&E>ce)return[new o.V(ue,se[0].zoom,"stop zoom values must appear in ascending order")];ce!==E&&(E=ce,C=void 0,R={}),le=le.concat(ve({key:`${ue}[0]`,value:se[0],valueSpec:{zoom:{}},style:ne.style,styleSpec:ne.styleSpec,objectElementValidators:{zoom:Ie,value:te}}))}else le=le.concat(te({key:`${ue}[0]`,value:se[0],valueSpec:{},style:ne.style,styleSpec:ne.styleSpec},se));return o.o(o.q(se[1]))?le.concat([new o.V(`${ue}[1]`,se[1],"expressions are not allowed in function stops.")]):le.concat(At({key:`${ue}[1]`,value:se[1],valueSpec:f,style:ne.style,styleSpec:ne.styleSpec}))}function te(ne,le){const se=o.j(ne.value),ue=o.u(ne.value),ce=ne.value!==null?ne.value:le;if(S){if(se!==S)return[new o.V(ne.key,ce,`${se} stop domain type must match previous stop domain type ${S}`)]}else S=se;if(se!=="number"&&se!=="string"&&se!=="boolean"&&typeof ue!="number"&&typeof ue!="string"&&typeof ue!="boolean")return[new o.V(ne.key,ce,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&v!=="categorical"){let ye=`number expected, ${se} found`;return o.m(f)&&v===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(ne.key,ce,ye)]}return v!=="categorical"||se!=="number"||typeof ue=="number"&&isFinite(ue)&&Math.floor(ue)===ue?v!=="categorical"&&se==="number"&&typeof ue=="number"&&typeof C=="number"&&C!==void 0&&ue<C?[new o.V(ne.key,ce,"stop domain values must appear in ascending order")]:(C=ue,v==="categorical"&&ue in R?[new o.V(ne.key,ce,"stop domain values must be unique")]:(R[ue]=!0,[])):[new o.V(ne.key,ce,`integer expected, found ${String(ue)}`)]}}function Ee(w){const f=(w.expressionContext==="property"?o.r:o.t)(o.q(w.value),w.valueSpec);if(f.result==="error")return f.value.map(S=>new o.V(`${w.key}${S.key}`,w.value,S.message));const v=f.value.expression||f.value._styleExpression.expression;if(w.expressionContext==="property"&&w.propertyKey==="text-font"&&!v.outputDefined())return[new o.V(w.key,w.value,`Invalid data expression for "${w.propertyKey}". Output values must be contained as literals within the expression.`)];if(w.expressionContext==="property"&&w.propertyType==="layout"&&!o.v(v))return[new o.V(w.key,w.value,'"feature-state" data expressions are not supported with layout properties.')];if(w.expressionContext==="filter")return Ue(v,w);if(w.expressionContext&&w.expressionContext.indexOf("cluster")===0){if(!o.x(v,["zoom","feature-state"]))return[new o.V(w.key,w.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(w.expressionContext==="cluster-initial"&&!o.y(v))return[new o.V(w.key,w.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ue(w,f){const v=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(f.valueSpec&&f.valueSpec.expression)for(const C of f.valueSpec.expression.parameters)v.delete(C);if(v.size===0)return[];const S=[];return w instanceof o.C&&v.has(w.name)?[new o.V(f.key,f.value,`["${w.name}"] expression is not supported in a filter for a ${f.object.type} layer with id: ${f.object.id}`)]:(w.eachChild(C=>{S.push(...Ue(C,f))}),S)}function Ke(w){const f=w.key,v=w.value,S=w.valueSpec,C=[];return Array.isArray(S.values)?S.values.indexOf(o.u(v))===-1&&C.push(new o.V(f,v,`expected one of [${S.values.join(", ")}], ${JSON.stringify(v)} found`)):Object.keys(S.values).indexOf(o.u(v))===-1&&C.push(new o.V(f,v,`expected one of [${Object.keys(S.values).join(", ")}], ${JSON.stringify(v)} found`)),C}function We(w){return o.A(o.q(w.value))?Ee(o.k({},w,{expressionContext:"filter",valueSpec:w.styleSpec[`filter_${w.layerType||"fill"}`]})):Rt(w)}function Rt(w){const f=w.value,v=w.key;if(o.j(f)!=="array")return[new o.V(v,f,`array expected, ${o.j(f)} found`)];const S=w.styleSpec;let C,E=[];if(f.length<1)return[new o.V(v,f,"filter array must have at least 1 element")];switch(E=E.concat(Ke({key:`${v}[0]`,value:f[0],valueSpec:S.filter_operator,style:w.style,styleSpec:w.styleSpec})),o.u(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&o.u(f[1])==="$type"&&E.push(new o.V(v,f,`"$type" cannot be use with operator "${f[0]}"`));case"==":case"!=":f.length!==3&&E.push(new o.V(v,f,`filter array for operator "${f[0]}" must have 3 elements`));case"in":case"!in":f.length>=2&&(C=o.j(f[1]),C!=="string"&&E.push(new o.V(`${v}[1]`,f[1],`string expected, ${C} found`)));for(let R=2;R<f.length;R++)C=o.j(f[R]),o.u(f[1])==="$type"?E=E.concat(Ke({key:`${v}[${R}]`,value:f[R],valueSpec:S.geometry_type,style:w.style,styleSpec:w.styleSpec})):C!=="string"&&C!=="number"&&C!=="boolean"&&E.push(new o.V(`${v}[${R}]`,f[R],`string, number, or boolean expected, ${C} found`));break;case"any":case"all":case"none":for(let R=1;R<f.length;R++)E=E.concat(Rt({key:`${v}[${R}]`,value:f[R],style:w.style,styleSpec:w.styleSpec}));break;case"has":case"!has":C=o.j(f[1]),f.length!==2?E.push(new o.V(v,f,`filter array for "${f[0]}" operator must have 2 elements`)):C!=="string"&&E.push(new o.V(`${v}[1]`,f[1],`string expected, ${C} found`))}return E}function Et(w,f){const v=w.key,S=w.style,C=w.layer,E=w.styleSpec,R=w.value,B=w.objectKey,G=E[`${f}_${w.layerType}`];if(!G)return[];const j=B.match(/^(.*)-transition$/);if(f==="paint"&&j&&G[j[1]]&&G[j[1]].transition)return At({key:v,value:R,valueSpec:E.transition,style:S,styleSpec:E});const q=w.valueSpec||G[B];if(!q)return[new o.i(v,R,`unknown property "${B}"`)];let K;if(o.j(R)==="string"&&o.m(q)&&!q.tokens&&(K=/^{([^}]+)}$/.exec(R))){const ne=`\`{ "type": "identity", "property": ${K?JSON.stringify(K[1]):'"_"'} }\``;return[new o.V(v,R,`"${B}" does not support interpolation syntax
Use an identity property function instead: ${ne}.`)]}const te=[];if(w.layerType==="symbol")B!=="text-field"||!S||S.glyphs||S.imports||te.push(new o.V(v,R,'use of "text-field" requires a style "glyphs" property')),B==="text-font"&&o.B(o.q(R))&&o.u(R.type)==="identity"&&te.push(new o.V(v,R,'"text-font" does not support identity functions'));else if(w.layerType==="model"&&f==="paint"&&C&&C.layout&&C.layout.hasOwnProperty("model-id")&&o.m(q)&&(o.D(q)||o.n(q))){const ne=o.r(o.q(R),q),le=ne.value.expression||ne.value._styleExpression.expression;le&&!o.x(le,["measure-light"])&&(B==="model-emissive-strength"&&o.y(le)&&o.v(le)||te.push(new o.V(v,R,`${B} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return te.concat(At({key:w.key,value:R,valueSpec:q,style:S,styleSpec:E,expressionContext:"property",propertyType:f,propertyKey:B}))}function ar(w){return Et(w,"paint")}function ur(w){return Et(w,"layout")}function cr(w){let f=[];const v=w.value,S=w.key,C=w.style,E=w.styleSpec;v.type||v.ref||f.push(new o.V(S,v,'either "type" or "ref" is required'));let R=o.u(v.type);const B=o.u(v.ref);if(v.id){const G=o.u(v.id);for(let j=0;j<w.arrayIndex;j++){const q=C.layers[j];o.u(q.id)===G&&f.push(new o.V(S,v.id,`duplicate layer id "${v.id}", previously used at line ${q.id.__line__}`))}}if("ref"in v){let G;["type","source","source-layer","filter","layout"].forEach(j=>{j in v&&f.push(new o.V(S,v[j],`"${j}" is prohibited for ref layers`))}),C.layers.forEach(j=>{o.u(j.id)===B&&(G=j)}),G?G.ref?f.push(new o.V(S,v.ref,"ref cannot reference another ref layer")):R=o.u(G.type):typeof B=="string"&&f.push(new o.V(S,v.ref,`ref layer "${B}" not found`))}else if(R!=="background"&&R!=="sky"&&R!=="slot")if(v.source){const G=C.sources&&C.sources[v.source],j=G&&o.u(G.type);G?j==="vector"&&R==="raster"?f.push(new o.V(S,v.source,`layer "${v.id}" requires a raster source`)):j==="raster"&&R!=="raster"?f.push(new o.V(S,v.source,`layer "${v.id}" requires a vector source`)):j!=="vector"||v["source-layer"]?j==="raster-dem"&&R!=="hillshade"?f.push(new o.V(S,v.source,"raster-dem source can only be used with layer type 'hillshade'.")):j!=="raster-array"||["raster","raster-particle"].includes(R)?R!=="line"||!v.paint||!v.paint["line-gradient"]&&!v.paint["line-trim-offset"]||j==="geojson"&&G.lineMetrics?R==="raster-particle"&&j!=="raster-array"&&f.push(new o.V(S,v.source,`layer "${v.id}" requires a 'raster-array' source.`)):f.push(new o.V(S,v,`layer "${v.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):f.push(new o.V(S,v.source,"raster-array source can only be used with layer type 'raster'.")):f.push(new o.V(S,v,`layer "${v.id}" must specify a "source-layer"`)):f.push(new o.V(S,v.source,`source "${v.source}" not found`))}else f.push(new o.V(S,v,'missing required property "source"'));return f=f.concat(ve({key:S,value:v,valueSpec:E.layer,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":()=>[],type:()=>At({key:`${S}.type`,value:v.type,valueSpec:E.layer.type,style:w.style,styleSpec:w.styleSpec,object:v,objectKey:"type"}),filter:G=>We(o.k({layerType:R},G)),layout:G=>ve({layer:v,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":j=>ur(o.k({layerType:R},j))}}),paint:G=>ve({layer:v,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":j=>ar(o.k({layerType:R,layer:v},j))}})}})),f}function lt(w){const f=w.value,v=w.key,S=o.j(f);return S!=="string"?[new o.V(v,f,`string expected, ${S} found`)]:[]}const qt={promoteId:function({key:w,value:f}){if(o.j(f)==="string")return lt({key:w,value:f});{const v=[];for(const S in f)v.push(...lt({key:`${w}.${S}`,value:f[S]}));return v}}};function Ut(w){const f=w.value,v=w.key,S=w.styleSpec,C=w.style;if(!f.type)return[new o.V(v,f,'"type" is required')];const E=o.u(f.type);let R=[];switch(["vector","raster","raster-dem","raster-array"].includes(E)&&(f.url||f.tiles||R.push(new o.i(v,f,'Either "url" or "tiles" is required.'))),E){case"vector":case"raster":case"raster-dem":case"raster-array":return R=R.concat(ve({key:v,value:f,valueSpec:S[`source_${E.replace("-","_")}`],style:w.style,styleSpec:S,objectElementValidators:qt})),R;case"geojson":if(R=ve({key:v,value:f,valueSpec:S.source_geojson,style:C,styleSpec:S,objectElementValidators:qt}),f.cluster)for(const B in f.clusterProperties){const[G,j]=f.clusterProperties[B],q=typeof G=="string"?[G,["accumulated"],["get",B]]:G;R.push(...Ee({key:`${v}.${B}.map`,value:j,expressionContext:"cluster-map"})),R.push(...Ee({key:`${v}.${B}.reduce`,value:q,expressionContext:"cluster-reduce"}))}return R;case"video":return ve({key:v,value:f,valueSpec:S.source_video,style:C,styleSpec:S});case"image":return ve({key:v,value:f,valueSpec:S.source_image,style:C,styleSpec:S});case"canvas":return[new o.V(v,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ke({key:`${v}.type`,value:f.type,valueSpec:{values:rr(S)},style:C,styleSpec:S})}}function rr(w){return w.source.reduce((f,v)=>{const S=w[v];return S.type.type==="enum"&&(f=f.concat(Object.keys(S.type.values))),f},[])}function br(w){const f=w.value,v=w.styleSpec,S=v.light,C=w.style;let E=[];const R=o.j(f);if(f===void 0)return E;if(R!=="object")return E=E.concat([new o.V("light",f,`object expected, ${R} found`)]),E;for(const B in f){const G=B.match(/^(.*)-transition$/);E=E.concat(G&&S[G[1]]&&S[G[1]].transition?At({key:B,value:f[B],valueSpec:v.transition,style:C,styleSpec:v}):S[B]?At({key:B,value:f[B],valueSpec:S[B],style:C,styleSpec:v}):[new o.V(B,f[B],`unknown property "${B}"`)])}return E}function Oe(w){const f=w.value;let v=[];if(!f)return v;const S=o.j(f);if(S!=="object")return v=v.concat([new o.V("light-3d",f,`object expected, ${S} found`)]),v;const C=w.styleSpec,E=C["light-3d"],R=w.key,B=w.style,G=w.style.lights;for(const K of["type","id"])if(!(K in f))return v=v.concat([new o.V("light-3d",f,`missing property ${K} on light`)]),v;if(f.type&&G)for(let K=0;K<w.arrayIndex;K++){const te=o.u(f.type),ne=G[K];o.u(ne.type)===te&&v.push(new o.V(R,f.id,`duplicate light type "${f.type}", previously defined at line ${ne.id.__line__}`))}const j=`properties_light_${f.type}`;if(!(j in C))return v=v.concat([new o.V("light-3d",f,`Invalid light type ${f.type}`)]),v;const q=C[j];for(const K in f)if(K==="properties"){const te=f[K],ne=o.j(te);if(ne!=="object")return v=v.concat([new o.V("properties",te,`object expected, ${ne} found`)]),v;for(const le in te)v=v.concat(q[le]?At({key:le,value:te[le],valueSpec:q[le],style:B,styleSpec:C}):[new o.i(w.key,te[le],`unknown property "${le}"`)])}else{const te=K.match(/^(.*)-transition$/);v=v.concat(te&&E[te[1]]&&E[te[1]].transition?At({key:K,value:f[K],valueSpec:C.transition,style:B,styleSpec:C}):E[K]?At({key:K,value:f[K],valueSpec:E[K],style:B,styleSpec:C}):[new o.i(K,f[K],`unknown property "${K}"`)])}return v}function $e(w){const f=w.value,v=w.key,S=w.style,C=w.styleSpec,E=C.terrain;let R=[];const B=o.j(f);if(f===void 0||B==="null")return R;if(B!=="object")return R=R.concat([new o.V("terrain",f,`object expected, ${B} found`)]),R;for(const G in f){const j=G.match(/^(.*)-transition$/);R=R.concat(j&&E[j[1]]&&E[j[1]].transition?At({key:G,value:f[G],valueSpec:C.transition,style:S,styleSpec:C}):E[G]?At({key:G,value:f[G],valueSpec:E[G],style:S,styleSpec:C}):[new o.i(G,f[G],`unknown property "${G}"`)])}if(f.source){const G=S.sources&&S.sources[f.source],j=G&&o.u(G.type);G?j!=="raster-dem"&&R.push(new o.V(v,f.source,`terrain cannot be used with a source of type ${String(j)}, it only be used with a "raster-dem" source type`)):R.push(new o.V(v,f.source,`source "${f.source}" not found`))}else R.push(new o.V(v,f,'terrain is missing required property "source"'));return R}function ct(w){const f=w.value,v=w.style,S=w.styleSpec,C=S.fog;let E=[];const R=o.j(f);if(f===void 0)return E;if(R!=="object")return E=E.concat([new o.V("fog",f,`object expected, ${R} found`)]),E;for(const B in f){const G=B.match(/^(.*)-transition$/);E=E.concat(G&&C[G[1]]&&C[G[1]].transition?At({key:B,value:f[B],valueSpec:S.transition,style:v,styleSpec:S}):C[B]?At({key:B,value:f[B],valueSpec:C[B],style:v,styleSpec:S}):[new o.i(B,f[B],`unknown property "${B}"`)])}return E}const bt={"*":()=>[],array:me,boolean:function(w){const f=w.value,v=w.key,S=o.j(f);return S!=="boolean"?[new o.V(v,f,`boolean expected, ${S} found`)]:[]},number:Ie,color:function(w){const f=w.key,v=w.value,S=o.j(v);return S!=="string"?[new o.V(f,v,`color expected, ${S} found`)]:o.z(v)===null?[new o.V(f,v,`color expected, "${v}" found`)]:[]},enum:Ke,filter:We,function:Le,layer:cr,object:ve,source:Ut,model:o.F,light:br,"light-3d":Oe,terrain:$e,fog:ct,string:lt,formatted:function(w){return lt(w).length===0?[]:Ee(w)},resolvedImage:function(w){return lt(w).length===0?[]:Ee(w)},projection:function(w){const f=w.value,v=w.styleSpec,S=v.projection,C=w.style;let E=[];const R=o.j(f);if(R==="object")for(const B in f)E=E.concat(At({key:B,value:f[B],valueSpec:S[B],style:C,styleSpec:v}));else R!=="string"&&(E=E.concat([new o.V("projection",f,`object or string expected, ${R} found`)]));return E},import:function(w){const{value:f,styleSpec:v}=w,{data:S,...C}=f;Object.defineProperty(C,"__line__",{value:f.__line__,enumerable:!1});let E=ve(o.k({},w,{value:C,valueSpec:v.import}));return o.u(C.id)===""&&E.push(new o.V(`${w.key}.id`,C,"import id can't be an empty string")),S&&(E=E.concat(mt(S,v,{key:`${w.key}.data`}))),E}};function At(w,f=!1){const v=w.value,S=w.valueSpec,C=w.styleSpec;if(S.expression&&o.B(o.u(v)))return Le(w);if(S.expression&&o.o(o.q(v)))return Ee(w);if(S.type&&bt[S.type]){const E=bt[S.type](w);return f===!0&&E.length>0&&o.j(w.value)==="array"?Ee(w):E}return ve(o.k({},w,{valueSpec:S.type?C[S.type]:S}))}function Jt(w){const f=w.value,v=w.key,S=lt(w);return S.length||(f.indexOf("{fontstack}")===-1&&S.push(new o.V(v,f,'"glyphs" url must include a "{fontstack}" token')),f.indexOf("{range}")===-1&&S.push(new o.V(v,f,'"glyphs" url must include a "{range}" token'))),S}function mt(w,f=o.G,v={}){return At({key:v.key||"",value:w,valueSpec:f.$root,styleSpec:f,style:w,objectElementValidators:{glyphs:Jt,"*":()=>[]}})}function ht(w,f=o.G){return Ye(mt(w,f))}const er=w=>Ye(Ut(w)),Bt=w=>Ye(br(w)),qe=w=>Ye(Oe(w)),ge=w=>Ye($e(w)),be=w=>Ye(ct(w)),ke=w=>Ye(cr(w)),tt=w=>Ye(We(w)),ut=w=>Ye(ar(w)),St=w=>Ye(ur(w)),vt=w=>Ye(o.F(w));function Ye(w){return w.slice().sort((f,v)=>f.line&&v.line?f.line-v.line:0)}function Dt(w,f){let v=!1;if(f&&f.length)for(const S of f)S instanceof o.i?o.w(S.message):(w.fire(new o.a(new Error(S.message))),v=!0);return v}const Vt=new o.H({anchor:new o.J(o.G.light.anchor),position:new o.K(o.G.light.position),color:new o.J(o.G.light.color),intensity:new o.J(o.G.light.intensity)});class jt extends o.E{constructor(f,v="flat"){super(),this._transitionable=new o.L(Vt),this.setLight(f,v),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(f,v,S={}){this._validate(Bt,f,S)||(this._transitionable.setTransitionOrValue(f),this.id=v)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,v,S){return(!S||S.validate!==!1)&&Dt(this,f.call(ht,o.e({value:v,style:{glyphs:!0,sprite:!0},styleSpec:o.G})))}}const Yt=new o.H({source:new o.J(o.G.terrain.source),exaggeration:new o.J(o.G.terrain.exaggeration)});let Nr=class extends o.E{constructor(w,f,v,S){super(),this.scope=v,this._transitionable=new o.L(Yt,v,S),this._transitionable.setTransitionOrValue(w,S),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=f}get(){return this._transitionable.serialize()}set(w,f){this._transitionable.setTransitionOrValue(w,f)}updateTransitions(w){this._transitioning=this._transitionable.transitioned(w,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(w){this.properties=this._transitioning.possiblyEvaluate(w)}getExaggeration(w){return this._transitioning.possiblyEvaluate(new o.N(w)).get("exaggeration")}isZoomDependent(){const w=this._transitionable._values.exaggeration;return w!=null&&w.value!=null&&w.value.expression!=null&&w.value.expression instanceof o.Z}};const Qr=45,xn=65,jn=.05;function Wn(w,f,v,S){const C=o.S(Qr,xn,v),[E,R]=ai(w,S);let B=1-Math.min(1,Math.exp((f-E)/(R-E)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*C*w.alpha}function ai(w,f){const v=.5/Math.tan(.5*f);return[w.range[0]+v,w.range[1]+v]}function Si(w,f,v,S,C){const E=o.Q.transformMat4([],[f,v,S],C.mercatorFogMatrix);return Wn(w,o.Q.length(E),C.pitch,C._fov)}function pa(w,f,v,S,C,E,R){const B=[[v,S,0],[C,S,0],[C,E,0],[v,E,0]];let G=Number.MAX_VALUE,j=-Number.MAX_VALUE;for(const q of B){const K=o.Q.transformMat4([],q,f),te=o.Q.length(K);G=Math.min(G,te),j=Math.max(j,te)}return[Wn(w,G,R.pitch,R._fov),Wn(w,j,R.pitch,R._fov)]}const Ii=new o.H({range:new o.J(o.G.fog.range),color:new o.J(o.G.fog.color),"high-color":new o.J(o.G.fog["high-color"]),"space-color":new o.J(o.G.fog["space-color"]),"horizon-blend":new o.J(o.G.fog["horizon-blend"]),"star-intensity":new o.J(o.G.fog["star-intensity"]),"vertical-range":new o.J(o.G.fog["vertical-range"])});class po extends o.E{constructor(f,v,S,C){super(),this._transitionable=new o.L(Ii,S,new Map(C)),this.set(f,C),this._transitioning=this._transitionable.untransitioned(),this._transform=v,this.properties=new o.U(Ii)}get state(){const f=this._transform,v=f.projection.name==="globe",S=o.W(f.zoom),C=this.properties.get("range"),E=[.5,3];return{range:v?[o.X(E[0],C[0],S),o.X(E[1],C[1],S)]:C,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(f,v,S={}){if(this._validate(be,f,S))return;const C=o.e({},f);for(const E of Object.keys(o.G.fog))C[E]===void 0&&(C[E]=o.G.fog[E].default);this._options=C,this._transitionable.setTransitionOrValue(this._options,v)}getOpacity(f){if(!this._transform.projection.supportsFog)return 0;const v=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.S(Qr,xn,f))*v.a}getOpacityAtLatLng(f,v){return this._transform.projection.supportsFog?function(S,C,E){const R=o.O.fromLngLat(C),B=E.elevation?E.elevation.getAtPointOrZero(R):0;return Si(S,R.x,R.y,B,E)}(this.state,f,v):0}getOpacityForTile(f){if(!this._transform.projection.supportsFog)return[1,1];const v=this._transform.calculateFogTileMatrix(f.toUnwrapped());return pa(this.state,v,0,0,o.Y,o.Y,this._transform)}getOpacityForBounds(f,v,S,C,E){return this._transform.projection.supportsFog?pa(this.state,f,v,S,C,E,this._transform):[1,1]}getFovAdjustedRange(f){return this._transform.projection.supportsFog?ai(this.state,f):[0,1]}isVisibleOnFrustum(f){if(!this._transform.projection.supportsFog)return!1;const v=[4,5,6,7];for(const S of v){const C=f.points[S];let E;if(C[2]>=0)E=C;else{const R=f.points[S-4];E=o._(R,C,R[2]/(R[2]-C[2]))}if(Si(this.state,E[0],E[1],0,this._transform)>=jn)return!0}return!1}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,v,S){return(!S||S.validate!==!1)&&Dt(this,f.call(ht,o.e({value:v,style:{glyphs:!0,sprite:!0},styleSpec:o.G})))}}class no extends o.E{constructor(f,v,S,C){super(),this.scope=S,this._options=f,this.properties=new o.U(v),this._transitionable=new o.L(v,S,new Map(C)),this._transitionable.setTransitionOrValue(f.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(f){this._transitionable.setTransitionOrValue(this._options.properties,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(f,v){this._options=f,this._transitionable.setTransitionOrValue(f.properties,v)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const Ds=new o.H({color:new o.J(o.G.properties_light_ambient.color),intensity:new o.J(o.G.properties_light_ambient.intensity)}),sa=new o.H({direction:new o.$(o.G.properties_light_directional.direction),color:new o.J(o.G.properties_light_directional.color),intensity:new o.J(o.G.properties_light_directional.intensity),"cast-shadows":new o.J(o.G.properties_light_directional["cast-shadows"]),"shadow-intensity":new o.J(o.G.properties_light_directional["shadow-intensity"])});class Ni{constructor(f,v,S,C){this.screenBounds=f,this.cameraPoint=v,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=S,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,C)}static createFromScreenPoints(f,v){let S,C;if(f instanceof o.P||typeof f[0]=="number"){const E=o.P.convert(f);S=[E],C=v.isPointAboveHorizon(E)}else{const E=o.P.convert(f[0]),R=o.P.convert(f[1]);S=[E,R],C=o.a0(E,R).every(B=>v.isPointAboveHorizon(B))}return new Ni(S,v.getCameraPoint(),C,v)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(f){return o.a0(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],f)}bufferedCameraGeometry(f){const v=this.screenBounds[0],S=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],C=o.a0(v,S,0,!1);return this.cameraPoint.y>S.y&&(this.cameraPoint.x>v.x&&this.cameraPoint.x<S.x?C.splice(3,0,this.cameraPoint):this.cameraPoint.x>=S.x?C[2]=this.cameraPoint:this.cameraPoint.x<=v.x&&(C[3]=this.cameraPoint)),o.a1(C,f)}bufferedCameraGeometryGlobe(f){const v=this.screenBounds[0],S=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],C=o.a0(v,S,f),E=this.cameraPoint.clone();switch(3*((E.y>v.y)+(E.y>S.y))+((E.x>v.x)+(E.x>S.x))){case 0:C[0]=E,C[4]=E.clone();break;case 1:C.splice(1,0,E);break;case 2:C[1]=E;break;case 3:C.splice(4,0,E);break;case 5:C.splice(2,0,E);break;case 6:C[3]=E;break;case 7:C.splice(3,0,E);break;case 8:C[2]=E}return C}containsTile(f,v,S,C=0){const E=f.queryPadding/v._pixelsPerMercatorPixel+1,R=S?this._bufferedCameraMercator(E,v):this._bufferedScreenMercator(E,v);let B=f.tileID.wrap+(R.unwrapped?C:0);const G=R.polygon.map(ue=>o.a2(f.tileTransform,ue,B));if(!o.a3(G,0,0,o.Y,o.Y))return;B=f.tileID.wrap+(this.screenGeometryMercator.unwrapped?C:0);const j=this.screenGeometryMercator.polygon.map(ue=>o.a4(f.tileTransform,ue,B)),q=j.map(ue=>new o.P(ue[0],ue[1])),K=v.getFreeCameraOptions().position||new o.O(0,0,0),te=o.a4(f.tileTransform,K,B),ne=j.map(ue=>{const ce=o.Q.sub(ue,ue,te);return o.Q.normalize(ce,ce),new o.a5(te,ce)}),le=o.a6(f,1,v.zoom)*v._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:q,tilespaceRays:ne,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(se=o.a7(G),se.min.x=o.ad(se.min.x,0,o.Y),se.min.y=o.ad(se.min.y,0,o.Y),se.max.x=o.ad(se.max.x,0,o.Y),se.max.y=o.ad(se.max.y,0,o.Y),se),tile:f,tileID:f.tileID,pixelToTileUnitsFactor:le};var se}_bufferedScreenMercator(f,v){const S=Ft(f);if(this._screenRaycastCache[S])return this._screenRaycastCache[S];{let C;return C=v.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(f),v):{polygon:this.bufferedScreenGeometry(f).map(E=>v.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[S]=C,C}}_bufferedCameraMercator(f,v){const S=Ft(f);if(this._cameraRaycastCache[S])return this._cameraRaycastCache[S];{let C;return C=v.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(f),v):{polygon:this.bufferedCameraGeometry(f).map(E=>v.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[S]=C,C}}_projectAndResample(f,v){const S=function(E,R){const B=o.a9.multiply([],R.pixelMatrix,R.globeMatrix),G=[0,-o.ae,0,1],j=[0,o.ae,0,1],q=[0,0,0,1];o.aa.transformMat4(G,G,B),o.aa.transformMat4(j,j,B),o.aa.transformMat4(q,q,B);const K=new o.P(G[0]/G[3],G[1]/G[3]),te=new o.P(j[0]/j[3],j[1]/j[3]),ne=o.ab(E,K)&&G[3]<q[3],le=o.ab(E,te)&&j[3]<q[3];if(!ne&&!le)return null;const se=function(we,Fe,ze){for(let je=1;je<we.length;je++){const it=Mt(Fe.pointCoordinate3D(we[je-1]).x),Ge=Mt(Fe.pointCoordinate3D(we[je]).x);if(ze<0){if(it<Ge)return{idx:je,t:-it/(Ge-1-it)}}else if(Ge<it)return{idx:je,t:(1-it)/(Ge+1-it)}}return null}(E,R,ne?-1:1);if(!se)return null;const{idx:ue,t:ce}=se;let ye=ue>1?Ct(E.slice(0,ue),R):[],Ce=ue<E.length?Ct(E.slice(ue),R):[];ye=ye.map(we=>new o.P(Mt(we.x),we.y)),Ce=Ce.map(we=>new o.P(Mt(we.x),we.y));const Ae=[...ye];Ae.length===0&&Ae.push(Ce[Ce.length-1]);const De=o.X(Ae[Ae.length-1].y,(Ce.length===0?ye[0]:Ce[0]).y,ce);let he;return he=ne?[new o.P(0,De),new o.P(0,0),new o.P(1,0),new o.P(1,De)]:[new o.P(1,De),new o.P(1,1),new o.P(0,1),new o.P(0,De)],Ae.push(...he),Ce.length===0?Ae.push(ye[0]):Ae.push(...Ce),{polygon:Ae.map(we=>new o.O(we.x,we.y)),unwrapped:!1}}(f,v);if(S)return S;const C=function(E,R){let B=!1,G=-1/0,j=0;for(let K=0;K<E.length-1;K++)E[K].x>G&&(G=E[K].x,j=K);for(let K=0;K<E.length-1;K++){const te=(j+K)%(E.length-1),ne=E[te],le=E[te+1];Math.abs(ne.x-le.x)>.5&&(ne.x<le.x?(ne.x+=1,te===0&&(E[E.length-1].x+=1)):(le.x+=1,te+1===E.length-1&&(E[0].x+=1)),B=!0)}const q=o.a8(R.center.lng);return B&&q<Math.abs(q-1)&&E.forEach(K=>{K.x-=1}),{polygon:E,unwrapped:B}}(Ct(f,v).map(E=>new o.P(Mt(E.x),E.y)),v);return{polygon:C.polygon.map(E=>new o.O(E.x,E.y)),unwrapped:C.unwrapped}}}function Ct(w,f){return o.ac(w,v=>{const S=f.pointCoordinate3D(v);v.x=S.x,v.y=S.y},1/256)}function Mt(w){return w<0?1+w%1:w%1}function Ft(w){return 100*w|0}function Qt(w,f,v,S,C){const E=function(R,B){if(R)return C(R);if(B){w.url&&B.tiles&&w.tiles&&delete w.tiles;const G=o.af(o.e(B,w),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);B.vector_layers&&(G.vectorLayers=B.vector_layers,G.vectorLayerIds=G.vectorLayers.map(j=>j.id)),B.raster_layers&&(G.rasterLayers=B.raster_layers,G.rasterLayerIds=G.rasterLayers.map(j=>j.id)),G.tiles=f.canonicalizeTileset(G,w.url),C(null,G)}};return w.url?o.g(f.transformRequest(f.normalizeSourceURL(w.url,null,v,S),o.R.Source),E):o.f.frame(()=>E(null,w))}class Xt{constructor(f,v,S){this.bounds=o.ag.convert(this.validateBounds(f)),this.minzoom=v||0,this.maxzoom=S||24}validateBounds(f){return Array.isArray(f)&&f.length===4?[Math.max(-180,f[0]),Math.max(-90,f[1]),Math.min(180,f[2]),Math.min(90,f[3])]:[-180,-90,180,90]}contains(f){const v=Math.pow(2,f.z),S=Math.floor(o.a8(this.bounds.getWest())*v),C=Math.floor(o.ah(this.bounds.getNorth())*v),E=Math.ceil(o.a8(this.bounds.getEast())*v),R=Math.ceil(o.ah(this.bounds.getSouth())*v);return f.x>=S&&f.x<E&&f.y>=C&&f.y<R}}class or extends o.E{constructor(f,v,S,C){if(super(),this.id=f,this.dispatcher=S,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.af(v,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},v),this._collectResourceTiming=!!v.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C),this._tileWorkers={},this._deduped=new o.ai}load(f){this._loaded=!1,this.fire(new o.b("dataloading",{dataType:"source"}));const v=Array.isArray(this.map._language)?this.map._language.join():this.map._language,S=this.map._worldview;this._tileJSONRequest=Qt(this._options,this.map._requestManager,v,S,(C,E)=>{this._tileJSONRequest=null,this._loaded=!0,C?(v&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${v}`),S&&S.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${S}`),this.fire(new o.a(C))):E&&(o.e(this,E),E.bounds&&(this.tileBounds=new Xt(E.bounds,this.minzoom,this.maxzoom)),o.am(E.tiles,this.map._requestManager._customAccessToken),this.fire(new o.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.b("data",{dataType:"source",sourceDataType:"content"}))),f&&f(C)})}loaded(){return this._loaded}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest();const f=o.aj(this.id,this.scope);this.load(()=>this.map.style.clearSource(f))}setTiles(f){return this._options.tiles=f,this.reload(),this}setUrl(f){return this.url=f,this._options.url=f,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.e({},this._options)}loadTile(f,v){const S=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),C={request:this.map._requestManager.transformRequest(S,o.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:f.isExtraShadowCaster};if(C.request.collectResourceTiming=this._collectResourceTiming,f.actor&&f.state!=="expired")f.state==="loading"?f.reloadCallback=v:f.request=f.actor.send("reloadTile",C,E.bind(this));else if(f.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)f.request=f.actor.send("loadTile",C,E.bind(this),void 0,!0);else{const R=o.ak.call({deduped:this._deduped},C,(B,G)=>{B||!G?E.call(this,B):(C.data={cacheControl:G.cacheControl,expires:G.expires,rawData:G.rawData.slice(0)},f.actor&&f.actor.send("loadTile",C,E.bind(this),void 0,!0))},!0);f.request={cancel:R}}function E(R,B){return delete f.request,f.aborted?v(null):R&&R.status!==404?v(R):(B&&B.resourceTiming&&(f.resourceTiming=B.resourceTiming),this.map._refreshExpiredTiles&&B&&f.setExpiryData(B),f.loadVectorData(B,this.map.painter),o.al(this.dispatcher),v(null),void(f.reloadCallback&&(this.loadTile(f,f.reloadCallback),f.reloadCallback=null)))}}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.actor&&f.actor.send("abortTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(f){f.actor&&f.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class sr extends o.E{constructor(f,v,S,C){super(),this.id=f,this.dispatcher=S,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},v),o.e(this,o.af(v,["url","scheme","tileSize"]))}load(f){this._loaded=!1,this.fire(new o.b("dataloading",{dataType:"source"})),this._tileJSONRequest=Qt(this._options,this.map._requestManager,null,null,(v,S)=>{this._tileJSONRequest=null,this._loaded=!0,v?this.fire(new o.a(v)):S&&(o.e(this,S),S.bounds&&(this.tileBounds=new Xt(S.bounds,this.minzoom,this.maxzoom)),o.am(S.tiles),this.fire(new o.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.b("data",{dataType:"source",sourceDataType:"content"}))),f&&f(v)})}loaded(){return this._loaded}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest();const f=o.aj(this.id,this.scope);this.load(()=>this.map.style.clearSource(f))}setTiles(f){return this._options.tiles=f,this.reload(),this}setUrl(f){return this.url=f,this._options.url=f,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.e({},this._options)}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,v){const S=o.f.devicePixelRatio>=2,C=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),S,this.tileSize);f.request=o.d(this.map._requestManager.transformRequest(C,o.R.Tile),(E,R,B,G)=>(delete f.request,f.aborted?(f.state="unloaded",v(null)):E?(f.state="errored",v(E)):R?(this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:B,expires:G}),f.setTexture(R,this.map.painter),f.state="loaded",o.al(this.dispatcher),void v(null)):v(null)))}abortTile(f,v){f.request&&(f.request.cancel(),delete f.request),v()}unloadTile(f,v){f.texture&&f.texture instanceof o.T?(f.destroy(!0),f.texture&&f.texture instanceof o.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),v()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Kt extends sr{constructor(f,v,S,C){super(f,v,S,C),this.type="raster-array",this.maxzoom=22,this._options=o.e({type:"raster-array"},v)}triggerRepaint(f){const v=this.map.painter._terrain,S=this.map.style.getSourceCache(this.id);v&&v.enabled&&S&&v._clearRenderCacheForTile(S.id,f.tileID),this.map.triggerRepaint()}loadTile(f,v){const S=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),C=this.map._requestManager.transformRequest(S,o.R.Tile);f.requestParams=C,f.actor||(f.actor=this.dispatcher.getActor()),f.request=f.fetchHeader(void 0,(E,R,B,G)=>{if(delete f.request,f.aborted)return f.state="unloaded",v(null);if(E)return E.code===20?void 0:(f.state="errored",v(E));this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:B,expires:G}),f.state="empty",v(null)})}unloadTile(f){const v=f.texture;v&&v instanceof o.T?(f.destroy(!0),this.map.painter.saveTileTexture(v)):(f.destroy(),f.flushQueues(),f._isHeaderLoaded=!1,delete f._mrt,delete f.textureDescriptor),f.fbo&&(f.fbo.destroy(),delete f.fbo),delete f.request,delete f.requestParams,delete f.neighboringTiles,f.state="unloaded"}prepareTile(f,v,S){f._isHeaderLoaded&&(f.state!=="empty"&&(f.state="reloading"),f.fetchBand(v,S,(C,E)=>{if(C)return f.state="errored",this.fire(new o.a(C)),void this.triggerRepaint(f);E&&(f.setTexture(E,this.map.painter),f.state="loaded",this.triggerRepaint(f))}))}getInitialBand(f){if(!this.rasterLayers)return 0;const v=this.rasterLayers.find(({id:E})=>E===f),S=v&&v.fields,C=S&&S.bands&&S.bands;return C?C[0]:0}getTextureDescriptor(f,v,S){if(!f)return;const C=v.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!C)return;let E=null;v instanceof o.aq?E=v.paint.get("raster-array-band"):v instanceof o.ar&&(E=v.paint.get("raster-particle-array-band"));const R=E||this.getInitialBand(C);if(R!=null)if(f.textureDescriptor){if(!f.updateNeeded(C,R)||S)return Object.assign({},f.textureDescriptor,{texture:f.texture})}else this.prepareTile(f,C,R)}}const hr=32,tr=33,Hr=new Uint16Array(8184);for(let w=0;w<2046;w++){let f=w+2,v=0,S=0,C=0,E=0,R=0,B=0;for(1&f?C=E=R=hr:v=S=B=hr;(f>>=1)>1;){const j=v+C>>1,q=S+E>>1;1&f?(C=v,E=S,v=R,S=B):(v=C,S=E,C=R,E=B),R=j,B=q}const G=4*w;Hr[G+0]=v,Hr[G+1]=S,Hr[G+2]=C,Hr[G+3]=E}const Dn=new Uint16Array(2178),Tr=new Uint8Array(1089),hi=new Uint16Array(1089);function Vi(w){return w===0?-.03125:w===32?.03125:0}class yi{constructor(f,v,S,C){this.id=yi.uniqueIdxCounter,yi.uniqueIdxCounter++,this.context=f;const E=f.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!S,this.context.unbindVAO(),f.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,v.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||C||v.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(f){this.id=yi.uniqueIdxCounter,yi.uniqueIdxCounter++;const v=this.context.gl;this.context.unbindVAO(),this.bind(),v.bufferSubData(v.ELEMENT_ARRAY_BUFFER,0,f.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}yi.uniqueIdxCounter=0;const Ki={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zi{constructor(f,v,S,C,E,R){this.length=v.length,this.attributes=S,this.itemSize=v.bytesPerElement,this.dynamicDraw=C,this.instanceCount=R,this.context=f;const B=f.gl;this.buffer=B.createBuffer(),f.bindVertexBuffer.set(this.buffer),B.bufferData(B.ARRAY_BUFFER,v.arrayBuffer,this.dynamicDraw?B.DYNAMIC_DRAW:B.STATIC_DRAW),this.dynamicDraw||E||v.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(f){const v=this.context.gl;this.bind(),v.bufferSubData(v.ARRAY_BUFFER,0,f.arrayBuffer)}enableAttributes(f,v){for(let S=0;S<this.attributes.length;S++){const C=v.attributes[this.attributes[S].name];C!==void 0&&f.enableVertexAttribArray(C)}}setVertexAttribPointers(f,v,S){for(let C=0;C<this.attributes.length;C++){const E=this.attributes[C],R=v.attributes[E.name];R!==void 0&&f.vertexAttribPointer(R,E.components,f[Ki[E.type]],!1,this.itemSize,E.offset+this.itemSize*(S||0))}}setVertexAttribDivisor(f,v,S){for(let C=0;C<this.attributes.length;C++){const E=v.attributes[this.attributes[C].name];E!==void 0&&this.instanceCount&&this.instanceCount>0&&f.vertexAttribDivisor(E,S)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Bn{constructor(f){this.gl=f.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(f){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Uo extends Bn{getDefault(){return o.aA.transparent}set(f){const v=this.current;(f.r!==v.r||f.g!==v.g||f.b!==v.b||f.a!==v.a||this.dirty)&&(this.gl.clearColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)}}class Ps extends Bn{getDefault(){return 1}set(f){(f!==this.current||this.dirty)&&(this.gl.clearDepth(f),this.current=f,this.dirty=!1)}}class Da extends Bn{getDefault(){return 0}set(f){(f!==this.current||this.dirty)&&(this.gl.clearStencil(f),this.current=f,this.dirty=!1)}}class xc extends Bn{getDefault(){return[!0,!0,!0,!0]}set(f){const v=this.current;(f[0]!==v[0]||f[1]!==v[1]||f[2]!==v[2]||f[3]!==v[3]||this.dirty)&&(this.gl.colorMask(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)}}class Dd extends Bn{getDefault(){return!0}set(f){(f!==this.current||this.dirty)&&(this.gl.depthMask(f),this.current=f,this.dirty=!1)}}class go extends Bn{getDefault(){return 255}set(f){(f!==this.current||this.dirty)&&(this.gl.stencilMask(f),this.current=f,this.dirty=!1)}}class UI extends Bn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(f){const v=this.current;(f.func!==v.func||f.ref!==v.ref||f.mask!==v.mask||this.dirty)&&(this.gl.stencilFunc(f.func,f.ref,f.mask),this.current=f,this.dirty=!1)}}class bn extends Bn{getDefault(){const f=this.gl;return[f.KEEP,f.KEEP,f.KEEP]}set(f){const v=this.current;(f[0]!==v[0]||f[1]!==v[1]||f[2]!==v[2]||this.dirty)&&(this.gl.stencilOp(f[0],f[1],f[2]),this.current=f,this.dirty=!1)}}class by extends Bn{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;f?v.enable(v.STENCIL_TEST):v.disable(v.STENCIL_TEST),this.current=f,this.dirty=!1}}class vo extends Bn{getDefault(){return[0,1]}set(f){const v=this.current;(f[0]!==v[0]||f[1]!==v[1]||this.dirty)&&(this.gl.depthRange(f[0],f[1]),this.current=f,this.dirty=!1)}}class Gl extends Bn{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;f?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST),this.current=f,this.dirty=!1}}class Wb extends Bn{getDefault(){return this.gl.LESS}set(f){(f!==this.current||this.dirty)&&(this.gl.depthFunc(f),this.current=f,this.dirty=!1)}}class Zb extends Bn{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;f?v.enable(v.BLEND):v.disable(v.BLEND),this.current=f,this.dirty=!1}}class wy extends Bn{getDefault(){const f=this.gl;return[f.ONE,f.ZERO,f.ONE,f.ZERO]}set(f){const v=this.current;(f[0]!==v[0]||f[1]!==v[1]||f[2]!==v[2]||f[3]!==v[3]||this.dirty)&&(this.gl.blendFuncSeparate(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)}}class qb extends Bn{getDefault(){return o.aA.transparent}set(f){const v=this.current;(f.r!==v.r||f.g!==v.g||f.b!==v.b||f.a!==v.a||this.dirty)&&(this.gl.blendColor(f.r,f.g,f.b,f.a),this.current=f,this.dirty=!1)}}class Yb extends Bn{getDefault(){return this.gl.FUNC_ADD}set(f){(f!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(f,f),this.current=f,this.dirty=!1)}}class Xb extends Bn{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;f?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE),this.current=f,this.dirty=!1}}class Qb extends Bn{getDefault(){return this.gl.BACK}set(f){(f!==this.current||this.dirty)&&(this.gl.cullFace(f),this.current=f,this.dirty=!1)}}class Kb extends Bn{getDefault(){return this.gl.CCW}set(f){(f!==this.current||this.dirty)&&(this.gl.frontFace(f),this.current=f,this.dirty=!1)}}let _v=class extends Bn{getDefault(){return null}set(w){(w!==this.current||this.dirty)&&(this.gl.useProgram(w),this.current=w,this.dirty=!1)}};class rn extends Bn{getDefault(){return this.gl.TEXTURE0}set(f){(f!==this.current||this.dirty)&&(this.gl.activeTexture(f),this.current=f,this.dirty=!1)}}class Sy extends Bn{getDefault(){const f=this.gl;return[0,0,f.drawingBufferWidth,f.drawingBufferHeight]}set(f){const v=this.current;(f[0]!==v[0]||f[1]!==v[1]||f[2]!==v[2]||f[3]!==v[3]||this.dirty)&&(this.gl.viewport(f[0],f[1],f[2],f[3]),this.current=f,this.dirty=!1)}}class bc extends Bn{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;v.bindFramebuffer(v.FRAMEBUFFER,f),this.current=f,this.dirty=!1}}class Jb extends Bn{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;v.bindRenderbuffer(v.RENDERBUFFER,f),this.current=f,this.dirty=!1}}class ew extends Bn{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;v.bindTexture(v.TEXTURE_2D,f),this.current=f,this.dirty=!1}}class tw extends Bn{getDefault(){return null}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;v.bindBuffer(v.ARRAY_BUFFER,f),this.current=f,this.dirty=!1}}class rw extends Bn{getDefault(){return null}set(f){const v=this.gl;v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,f),this.current=f,this.dirty=!1}}class nw extends Bn{getDefault(){return null}set(f){this.gl&&(f!==this.current||this.dirty)&&(this.gl.bindVertexArray(f),this.current=f,this.dirty=!1)}}class iw extends Bn{getDefault(){return 4}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_ALIGNMENT,f),this.current=f,this.dirty=!1}}class aw extends Bn{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),this.current=f,this.dirty=!1}}class ow extends Bn{getDefault(){return!1}set(f){if(f===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,f),this.current=f,this.dirty=!1}}class yv extends Bn{constructor(f,v){super(f),this.context=f,this.parent=v}getDefault(){return null}}class $I extends yv{setDirty(){this.dirty=!0}set(f){if(f===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const v=this.gl;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,f,0),this.current=f,this.dirty=!1}}class xv extends yv{attachment(){return this.gl.DEPTH_ATTACHMENT}set(f){if(f===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const v=this.gl;v.framebufferRenderbuffer(v.FRAMEBUFFER,this.attachment(),v.RENDERBUFFER,f),this.current=f,this.dirty=!1}}class HI extends yv{attachment(){return this.gl.DEPTH_ATTACHMENT}set(f){if(f===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const v=this.gl;v.framebufferTexture2D(v.FRAMEBUFFER,this.attachment(),v.TEXTURE_2D,f,0),this.current=f,this.dirty=!1}}class jI extends xv{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class WI{constructor(f,v,S,C,E){this.context=f,this.width=v,this.height=S;const R=this.framebuffer=f.gl.createFramebuffer();C&&(this.colorAttachment=new $I(f,R)),E&&(this.depthAttachmentType=E,this.depthAttachment=E==="renderbuffer"?new xv(f,R):new HI(f,R))}destroy(){const f=this.context.gl;if(this.colorAttachment){const v=this.colorAttachment.get();v&&f.deleteTexture(v)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const v=this.depthAttachment.get();v&&f.deleteRenderbuffer(v)}else{const v=this.depthAttachment.get();v&&f.deleteTexture(v)}f.deleteFramebuffer(this.framebuffer)}}class Pr{constructor(f,v,S){this.func=f,this.mask=v,this.range=S}}Pr.ReadOnly=!1,Pr.ReadWrite=!0,Pr.disabled=new Pr(519,Pr.ReadOnly,[0,1]);const Ty=7680;class qr{constructor(f,v,S,C,E,R){this.test=f,this.ref=v,this.mask=S,this.fail=C,this.depthFail=E,this.pass=R}}qr.disabled=new qr({func:519,mask:0},0,0,Ty,Ty,Ty);const bv=771;class fn{constructor(f,v,S,C){this.blendFunction=f,this.blendColor=v,this.mask=S,this.blendEquation=C}}fn.Replace=[1,0,1,0],fn.disabled=new fn(fn.Replace,o.aA.transparent,[!1,!1,!1,!1]),fn.unblended=new fn(fn.Replace,o.aA.transparent,[!0,!0,!0,!0]),fn.alphaBlended=new fn([1,bv,1,bv],o.aA.transparent,[!0,!0,!0,!0]),fn.multiply=new fn([774,0,774,0],o.aA.transparent,[!0,!0,!0,!0]);const Ay=1029,Cy=2305;class Vr{constructor(f,v,S){this.enable=f,this.mode=v,this.frontFace=S}}Vr.disabled=new Vr(!1,Ay,Cy),Vr.backCCW=new Vr(!0,Ay,Cy),Vr.backCW=new Vr(!0,Ay,2304),Vr.frontCW=new Vr(!0,1028,2304),Vr.frontCCW=new Vr(!0,1028,Cy);class rl{constructor(f,v){this.gl=f,this.clearColor=new Uo(this),this.clearDepth=new Ps(this),this.clearStencil=new Da(this),this.colorMask=new xc(this),this.depthMask=new Dd(this),this.stencilMask=new go(this),this.stencilFunc=new UI(this),this.stencilOp=new bn(this),this.stencilTest=new by(this),this.depthRange=new vo(this),this.depthTest=new Gl(this),this.depthFunc=new Wb(this),this.blend=new Zb(this),this.blendFunc=new wy(this),this.blendColor=new qb(this),this.blendEquation=new Yb(this),this.cullFace=new Xb(this),this.cullFaceSide=new Qb(this),this.frontFace=new Kb(this),this.program=new _v(this),this.activeTexture=new rn(this),this.viewport=new Sy(this),this.bindFramebuffer=new bc(this),this.bindRenderbuffer=new Jb(this),this.bindTexture=new ew(this),this.bindVertexBuffer=new tw(this),this.bindElementBuffer=new rw(this),this.bindVertexArrayOES=new nw(this),this.pixelStoreUnpack=new iw(this),this.pixelStoreUnpackPremultiplyAlpha=new aw(this),this.pixelStoreUnpackFlipY=new ow(this),this.options=v?{...v}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=f.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=f.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=f.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=f.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=f.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=f.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=f.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE),this.maxPointSize=f.getParameter(f.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(f,v,S){return new yi(this,f,v,S)}createVertexBuffer(f,v,S,C,E){return new Zi(this,f,v,S,C,E)}createRenderbuffer(f,v,S){const C=this.gl,E=C.createRenderbuffer();return this.bindRenderbuffer.set(E),C.renderbufferStorage(C.RENDERBUFFER,f,v,S),this.bindRenderbuffer.set(null),E}createFramebuffer(f,v,S,C){return new WI(this,f,v,S,C)}clear({color:f,depth:v,stencil:S,colorMask:C}){const E=this.gl;let R=0;f&&(R|=E.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set(C||[!0,!0,!0,!0])),v!==void 0&&(R|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(v),this.depthMask.set(!0)),S!==void 0&&(R|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(S),this.stencilMask.set(255)),E.clear(R)}setCullFace(f){f.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(f.mode),this.frontFace.set(f.frontFace))}setDepthMode(f){f.func!==this.gl.ALWAYS||f.mask?(this.depthTest.set(!0),this.depthFunc.set(f.func),this.depthMask.set(f.mask),this.depthRange.set(f.range)):this.depthTest.set(!1)}setStencilMode(f){f.test.func!==this.gl.ALWAYS||f.mask?(this.stencilTest.set(!0),this.stencilMask.set(f.mask),this.stencilOp.set([f.fail,f.depthFail,f.pass]),this.stencilFunc.set({func:f.test.func,ref:f.ref,mask:f.test.mask})):this.stencilTest.set(!1)}setColorMode(f){d(f.blendFunction,fn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(f.blendFunction),this.blendColor.set(f.blendColor),f.blendEquation?this.blendEquation.set(f.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(f.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}var ZI=o.aB([{name:"a_index",type:"Int16",components:1}]);const wc=.15000000000000002;class sw{constructor(f,v,S,C){const E={width:S[0],height:S[1],data:null},R=f.gl;this.targetColorTexture=new o.T(f,E,R.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new o.T(f,E,R.RGBA,{useMipmap:!1}),this.context=f,this.setParticleTextureDimension(v,C),this.lastInvalidatedAt=0}setParticleTextureDimension(f,v){if(this.particleTextureDimension===v)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const S=this.context.gl,C=v*v,E=new Uint8Array(4*C),R=.7692307692307692,B=o.aC(f.key);for(let q=0;q<E.length;q+=4){const K=R*(B()+wc),te=R*(B()+wc),ne=255*K%1,le=255*te%1,se=ne,ue=te-le/255,ce=le;E[q+0]=Math.floor(255*(K-ne/255)),E[q+1]=Math.floor(255*se),E[q+2]=Math.floor(255*ue),E[q+3]=Math.floor(255*ce)}const G=new o.h({width:v,height:v},E);this.particleTexture0=new o.T(this.context,G,S.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,G,S.RGBA,{premultiply:!1,useMipmap:!1});const j=new o.aD;j.reserve(C);for(let q=0;q<C;q++)j.emplaceBack(q);this.particleIndexBuffer=this.context.createVertexBuffer(j,ZI.members,!0),this.particleSegment=o.aE.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=v}update(f){return!(this.lastInvalidatedAt<f&&(this.lastInvalidatedAt=o.f.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}const wv={type:2,extent:o.Y,loadGeometry:()=>[[new o.P(0,0),new o.P(o.Y+1,0),new o.P(o.Y+1,o.Y+1),new o.P(0,o.Y+1),new o.P(0,0)]]};class Ls{constructor(f,v,S,C,E){this.tileID=f,this.uid=o.aF(),this.uses=0,this.tileSize=v,this.tileZoom=S,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=E,C&&C.style&&(this._lastUpdatedBrightness=C.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",C&&C.transform&&(this.projection=C.transform.projection)}registerFadeDuration(f){const v=f+this.timeAdded;v<o.f.now()||this.fadeEndTime&&v<this.fadeEndTime||(this.fadeEndTime=v)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.av(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(f,v,S){if(this.unloadVectorData(),this.state="loaded",f){f.featureIndex&&(this.latestFeatureIndex=f.featureIndex,f.rawTileData?(this.latestRawTileData=f.rawTileData,this.latestFeatureIndex.rawTileData=f.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=f.collisionBoxArray,this.buckets=function(C,E){const R={};if(!E)return R;for(const B of C){const G=B.layerIds.map(j=>E.getLayer(j)).filter(Boolean);if(G.length!==0){B.layers=G,B.stateDependentLayerIds&&(B.stateDependentLayers=B.stateDependentLayerIds.map(j=>G.filter(q=>q.id===j)[0]));for(const j of G)R[j.fqid]=B}}return R}(f.buckets,v.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const E=this.buckets[C];if(E instanceof o.aH){if(this.hasSymbolBuckets=!0,!S)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const E=this.buckets[C];if(E instanceof o.aH&&E.hasRTLText){this.hasRTLText=!0,o.aI();break}}this.queryPadding=0;for(const C in this.buckets){const E=this.buckets[C],R=v.style.getOwnLayer(C);if(!R)continue;const B=R.queryRadius(E);this.queryPadding=Math.max(this.queryPadding,B)}f.imageAtlas&&(this.imageAtlas=f.imageAtlas),f.glyphAtlasImage&&(this.glyphAtlasImage=f.glyphAtlasImage),f.lineAtlas&&(this.lineAtlas=f.lineAtlas),this._lastUpdatedBrightness=f.brightness}else this.collisionBoxArray=new o.aG}unloadVectorData(){if(this.hasData()){for(const f in this.buckets)this.buckets[f].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(f){return this.buckets[f.fqid]}upload(f){for(const C in this.buckets){const E=this.buckets[C];E.uploadPending()&&E.upload(f)}const v=f.gl,S=this.imageAtlas;if(S&&!S.uploaded){const C=!!Object.keys(S.patternPositions).length;this.imageAtlasTexture=new o.T(f,S.image,v.RGBA,{useMipmap:C}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(f,this.glyphAtlasImage,v.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(f,this.lineAtlas.image,v.R8),this.lineAtlas.uploaded=!0)}prepare(f,v,S){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(f,this.imageAtlasTexture,S),!v||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const C=v.style.getBrightness();(this._lastUpdatedBrightness||C)&&(this._lastUpdatedBrightness&&C&&Math.abs(this._lastUpdatedBrightness-C)<.001||(this._lastUpdatedBrightness=C,this.updateBuckets(void 0,v)))}queryRenderedFeatures(f,v,S,C,E,R,B,G){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:C,pixelPosMatrix:B,transform:R,params:E,tileTransform:this.tileTransform},f,v,S):{}}querySourceFeatures(f,v){const S=this.latestFeatureIndex;if(!S||!S.rawTileData)return;const C=S.loadVTLayers(),E=v?v.sourceLayer:"",R=C._geojsonTileLayer||C[E];if(!R)return;const B=o.aJ(v&&v.filter),{z:G,x:j,y:q}=this.tileID.canonical,K={z:G,x:j,y:q};for(let te=0;te<R.length;te++){const ne=R.feature(te);if(B.needGeometry){const ue=o.aK(ne,!0);if(!B.filter(new o.N(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!B.filter(new o.N(this.tileID.overscaledZ),ne))continue;const le=S.getId(ne,E),se=new o.aL(ne,G,j,q,le);se.tile=K,f.push(se)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const f in this.buckets)if(this.buckets[f].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(f){const v=this.expirationTime;if(f.cacheControl){const S=o.aM(f.cacheControl);S["max-age"]&&(this.expirationTime=Date.now()+1e3*S["max-age"])}else f.expires&&(this.expirationTime=new Date(f.expires).getTime());if(this.expirationTime){const S=Date.now();let C=!1;if(this.expirationTime>S)C=!1;else if(v)if(this.expirationTime<v)C=!0;else{const E=this.expirationTime-v;E?this.expirationTime=S+Math.max(E,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(f,v){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(f).length!==0&&v&&this.updateBuckets(f,v)}updateBuckets(f,v){if(!this.latestFeatureIndex)return;const S=this.latestFeatureIndex.loadVTLayers(),C=v.style.listImages(),E=v.style.getBrightness();for(const R in this.buckets){if(!v.style.hasLayer(R))continue;const B=this.buckets[R],G=B.layers[0].sourceLayer||"_geojsonTileLayer",j=S[G];let q={};if(f&&(q=f[G],!j||!q||Object.keys(q).length===0))continue;if(B.update(q,j,C,this.imageAtlas&&this.imageAtlas.patternPositions||{},E),B instanceof o.aN||B instanceof o.aO){const te=v.style.getOwnSourceCache(B.layers[0].source);v._terrain&&v._terrain.enabled&&te&&B.programConfigurations.needsUpload&&v._terrain._clearRenderCacheForTile(te.id,this.tileID)}const K=v&&v.style&&v.style.getOwnLayer(R);K&&(this.queryPadding=Math.max(this.queryPadding,K.queryRadius(B)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.f.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(f){this.symbolFadeHoldUntil=o.f.now()+f}setTexture(f,v){const S=v.context,C=S.gl;this.texture=this.texture||v.getTileTexture(f.width),this.texture&&this.texture instanceof o.T?this.texture.update(f,{useMipmap:!0}):(this.texture=new o.T(S,f,C.RGBA,{useMipmap:!0}),this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE))}setDependencies(f,v){const S={};for(const C of v)S[C]=!0;this.dependencies[f]=S}hasDependency(f,v){for(const S of f){const C=this.dependencies[S];if(C){for(const E of v)if(C[E])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(f,v){if(!v||v.name==="mercator"||this._tileDebugBuffer)return;const S=o.aP(wv,this.tileID.canonical,this.tileTransform)[0],C=new o.aQ,E=new o.aR;for(let R=0;R<S.length;R++){const{x:B,y:G}=S[R];C.emplaceBack(B,G),E.emplaceBack(R)}E.emplaceBack(0),this._tileDebugIndexBuffer=f.createIndexBuffer(E),this._tileDebugBuffer=f.createVertexBuffer(C,o.aS.members),this._tileDebugSegments=o.aE.simpleSegment(0,0,C.length,E.length)}_makeTileBoundsBuffers(f,v){if(this._tileBoundsBuffer||!v||v.name==="mercator")return;const S=o.aP(wv,this.tileID.canonical,this.tileTransform)[0];let C,E;if(this.isRaster){const R=function(B,G){const j=o.av(B,G),q=Math.pow(2,B.z);for(let ue=0;ue<tr;ue++)for(let ce=0;ce<tr;ce++){const ye=o.aw((B.x+(ce+Vi(ce))/hr)/q),Ce=o.ax((B.y+(ue+Vi(ue))/hr)/q),Ae=G.project(ye,Ce),De=ue*tr+ce;Dn[2*De+0]=Math.round((Ae.x*j.scale-j.x)*o.Y),Dn[2*De+1]=Math.round((Ae.y*j.scale-j.y)*o.Y)}Tr.fill(0),hi.fill(0);for(let ue=2045;ue>=0;ue--){const ce=4*ue,ye=Hr[ce+0],Ce=Hr[ce+1],Ae=Hr[ce+2],De=Hr[ce+3],he=ye+Ae>>1,we=Ce+De>>1,Fe=he+we-Ce,ze=we+ye-he,je=Ce*tr+ye,it=De*tr+Ae,Ge=we*tr+he,rt=Math.hypot((Dn[2*je+0]+Dn[2*it+0])/2-Dn[2*Ge+0],(Dn[2*je+1]+Dn[2*it+1])/2-Dn[2*Ge+1])>=16;Tr[Ge]=Tr[Ge]||(rt?1:0),ue<1022&&(Tr[Ge]=Tr[Ge]||Tr[(Ce+ze>>1)*tr+(ye+Fe>>1)]||Tr[(De+ze>>1)*tr+(Ae+Fe>>1)])}const K=new o.ay,te=new o.az;let ne=0;function le(ue,ce){const ye=ce*tr+ue;return hi[ye]===0&&(K.emplaceBack(Dn[2*ye+0],Dn[2*ye+1],ue*o.Y/hr,ce*o.Y/hr),hi[ye]=++ne),hi[ye]-1}function se(ue,ce,ye,Ce,Ae,De){const he=ue+ye>>1,we=ce+Ce>>1;if(Math.abs(ue-Ae)+Math.abs(ce-De)>1&&Tr[we*tr+he])se(Ae,De,ue,ce,he,we),se(ye,Ce,Ae,De,he,we);else{const Fe=le(ue,ce),ze=le(ye,Ce),je=le(Ae,De);te.emplaceBack(Fe,ze,je)}}return se(0,0,hr,hr,hr,0),se(hr,hr,0,0,0,hr),{vertices:K,indices:te}}(this.tileID.canonical,v);C=R.vertices,E=R.indices}else{C=new o.ay,E=new o.az;for(const{x:B,y:G}of S)C.emplaceBack(B,G,0,0);const R=o.aT(C.int16,void 0,4);for(let B=0;B<R.length;B+=3)E.emplaceBack(R[B],R[B+1],R[B+2])}this._tileBoundsBuffer=f.createVertexBuffer(C,o.aU.members),this._tileBoundsIndexBuffer=f.createIndexBuffer(E),this._tileBoundsSegments=o.aE.simpleSegment(0,0,C.length,E.length)}_makeGlobeTileDebugBuffers(f,v){const S=v.projection;if(!S||S.name!=="globe"||v.freezeTileCoverage)return;const C=this.tileID.canonical,E=o.aV(C,v),R=o.aW(E),B=o.W(v.zoom);let G;B>0&&(G=o.a9.invert(new Float64Array(16),v.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(f,C,v,R,G,B),this._makeGlobeTileDebugTextBuffer(f,C,v,R,G,B)}_globePoint(f,v,S,C,E,R,B){let G=o.aX(f,v,S);if(R){const j=1<<S.z,q=o.a8(C.center.lng),K=o.ah(C.center.lat),te=(S.x+.5)/j-q;let ne=0;te>.5?ne=-1:te<-.5&&(ne=1);let le=(f/o.Y+S.x)/j+ne,se=(v/o.Y+S.y)/j;le=(le-q)*C._pixelsPerMercatorPixel+q,se=(se-K)*C._pixelsPerMercatorPixel+K;const ue=[le*C.worldSize,se*C.worldSize,0];o.Q.transformMat4(ue,ue,R),G=o.aY(G,ue,B)}return o.Q.transformMat4(G,G,E)}_makeGlobeTileDebugBorderBuffer(f,v,S,C,E,R){const B=new o.aQ,G=new o.aR,j=new o.aZ,q=(te,ne,le,se,ue)=>{const ce=(le-te)/(ue-1),ye=(se-ne)/(ue-1),Ce=B.length;for(let Ae=0;Ae<ue;Ae++){const De=te+Ae*ce,he=ne+Ae*ye;B.emplaceBack(De,he);const we=this._globePoint(De,he,v,S,C,E,R);j.emplaceBack(we[0],we[1],we[2]),G.emplaceBack(Ce+Ae)}},K=o.Y;q(0,0,K,0,16),q(K,0,K,K,16),q(K,K,0,K,16),q(0,K,0,0,16),this._tileDebugIndexBuffer=f.createIndexBuffer(G),this._tileDebugBuffer=f.createVertexBuffer(B,o.aS.members),this._globeTileDebugBorderBuffer=f.createVertexBuffer(j,o.a_.members),this._tileDebugSegments=o.aE.simpleSegment(0,0,B.length,G.length)}_makeGlobeTileDebugTextBuffer(f,v,S,C,E,R){const B=o.Y/4,G=new o.aQ,j=new o.az,q=new o.aZ,K=25;j.reserve(32),G.reserve(K),q.reserve(K);const te=(ne,le)=>K*ne+le;for(let ne=0;ne<K;ne++){const le=ne*B;for(let se=0;se<K;se++){const ue=se*B;G.emplaceBack(ue,le);const ce=this._globePoint(ue,le,v,S,C,E,R);q.emplaceBack(ce[0],ce[1],ce[2])}}for(let ne=0;ne<4;ne++)for(let le=0;le<4;le++){const se=te(ne,le),ue=te(ne,le+1),ce=te(ne+1,le),ye=te(ne+1,le+1);j.emplaceBack(se,ue,ce),j.emplaceBack(ce,ue,ye)}this._tileDebugTextIndexBuffer=f.createIndexBuffer(j),this._tileDebugTextBuffer=f.createVertexBuffer(G,o.aS.members),this._globeTileDebugTextBuffer=f.createVertexBuffer(q,o.a_.members),this._tileDebugTextSegments=o.aE.simpleSegment(0,0,K,32)}destroy(f=!1){for(const v in this.buckets)this.buckets[v].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!f&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const nr={vector:or,raster:sr,"raster-dem":class extends sr{constructor(w,f,v,S){super(w,f,v,S),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},f),this.encoding=f.encoding||"mapbox"}loadTile(w,f){const v=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function S(C,E){C&&(w.state="errored",f(C)),E&&(w.dem=E,w.dem.onDeserialize(),w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0,w.state="loaded",f(null))}w.request=o.d(this.map._requestManager.transformRequest(v,o.R.Tile),(function(C,E,R,B){if(delete w.request,w.aborted)w.state="unloaded",f(null);else if(C)w.state="errored",f(C);else if(E){this.map._refreshExpiredTiles&&w.setExpiryData({cacheControl:R,expires:B});const G=ImageBitmap&&E instanceof ImageBitmap&&o.an(),j=1-(E.width-o.ao(E.width))/2;j<1||w.neighboringTiles||(w.neighboringTiles=this._getNeighboringTiles(w.tileID));const q=G?E:o.f.getImageData(E,j),K={uid:w.uid,coord:w.tileID,source:this.id,scope:this.scope,rawImageData:q,encoding:this.encoding,padding:j};w.actor&&w.state!=="expired"||(w.actor=this.dispatcher.getActor(),w.actor.send("loadDEMTile",K,S.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(w){const f=w.canonical,v=Math.pow(2,f.z),S=(f.x-1+v)%v,C=f.x===0?w.wrap-1:w.wrap,E=(f.x+1+v)%v,R=f.x+1===v?w.wrap+1:w.wrap,B={};return B[new o.ap(w.overscaledZ,C,f.z,S,f.y).key]={backfilled:!1},B[new o.ap(w.overscaledZ,R,f.z,E,f.y).key]={backfilled:!1},f.y>0&&(B[new o.ap(w.overscaledZ,C,f.z,S,f.y-1).key]={backfilled:!1},B[new o.ap(w.overscaledZ,w.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},B[new o.ap(w.overscaledZ,R,f.z,E,f.y-1).key]={backfilled:!1}),f.y+1<v&&(B[new o.ap(w.overscaledZ,C,f.z,S,f.y+1).key]={backfilled:!1},B[new o.ap(w.overscaledZ,w.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},B[new o.ap(w.overscaledZ,R,f.z,E,f.y+1).key]={backfilled:!1}),B}},"raster-array":Kt,geojson:class extends o.E{constructor(w,f,v,S){super(),this.id=w,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=v.getActor(),this.setEventedParent(S),this._data=f.data,this._options=o.e({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.minzoom!==void 0&&(this.minzoom=f.minzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId;const C=o.Y/this.tileSize;this.workerOptions=o.e({source:this.id,scope:this.scope,cluster:f.cluster||!1,geojsonVtOptions:{buffer:(f.buffer!==void 0?f.buffer:128)*C,tolerance:(f.tolerance!==void 0?f.tolerance:.375)*C,extent:o.Y,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:f.clusterMaxZoom!==void 0?f.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,f.clusterMinPoints||2),extent:o.Y,radius:(f.clusterRadius!==void 0?f.clusterRadius:50)*C,log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter,dynamic:f.dynamic},f.workerOptions)}onAdd(w){this.map=w,this.setData(this._data)}setData(w){return this._data=w,this._updateWorkerData(),this}updateData(w){return this._options.dynamic?(this._data=w,this._updateWorkerData(!0),this):this.fire(new o.a(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")))}getClusterExpansionZoom(w,f){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:w,source:this.id,scope:this.scope},f),this}getClusterChildren(w,f){return this.actor.send("geojson.getClusterChildren",{clusterId:w,source:this.id,scope:this.scope},f),this}getClusterLeaves(w,f,v,S){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:w,limit:f,offset:v},S),this}_updateWorkerData(w=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.b("dataloading",{dataType:"source"})),this._loaded=!1;const f=o.e({append:w},this.workerOptions);f.scope=this.scope;const v=this._data;typeof v=="string"?(f.request=this.map._requestManager.transformRequest(o.f.resolveURL(v),o.R.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(v),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(S,C)=>{if(this._loaded=!0,this._pendingLoad=null,S)this.fire(new o.a(S));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&C&&C.resourceTiming&&C.resourceTiming[this.id]&&(E.resourceTiming=C.resourceTiming[this.id]),this.fire(new o.b("data",E)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(w),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(w,f){const v=w.actor?"reloadTile":"loadTile";w.actor=this.actor;const S={type:this.type,uid:w.uid,tileID:w.tileID,tileZoom:w.tileZoom,zoom:w.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:o.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};w.request=this.actor.send(v,S,(C,E)=>(delete w.request,w.destroy(),w.aborted?f(null):C?f(C):(w.loadVectorData(E,this.map.painter,v==="reloadTile"),f(null))),void 0,v==="loadTile")}abortTile(w){w.request&&(w.request.cancel(),delete w.request),w.aborted=!0}unloadTile(w){this.actor.send("removeTile",{uid:w.uid,type:this.type,source:this.id,scope:this.scope}),w.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.as{constructor(w,f,v,S){super(w,f,v,S),this.roundZoom=!0,this.type="video",this.options=f}load(){this._loaded=!1;const w=this.options;this.urls=[];for(const f of w.urls)this.urls.push(this.map._requestManager.transformRequest(f,o.R.Source).url);o.at(this.urls,(f,v)=>{this._loaded=!0,f?this.fire(new o.a(f)):v&&(this.video=v,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(w){if(this.video){const f=this.video.seekable;w<f.start(0)||w>f.end(0)?this.fire(new o.a(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=w}}getVideo(){return this.video}onAdd(w){this.map||(this.map=w,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const w=this.map.painter.context,f=w.gl;this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(w,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(w)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.as,model:class extends o.E{constructor(w,f,v,S){super(),this.id=w,this.type="model",this.models=[],this._loaded=!1,this._options=f}load(){const w=[];for(const f in this._options.models){const v=this._options.models[f],S=o.l(this.map._requestManager.transformRequest(v.uri,o.R.Model).url).then(C=>{if(!C)return;const E=o.c(C),R=new o.M(f,v.position,v.orientation,E);R.computeBoundsAndApplyParent(),this.models.push(R)}).catch(C=>{this.fire(new o.a(new Error(`Could not load model ${f} from ${v.uri}: ${C.message}`)))});w.push(S)}return Promise.allSettled(w).then(()=>{this._loaded=!0,this.fire(new o.b("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(f=>{this.fire(new o.a(new Error(`Could not load models: ${f.message}`)))})}onAdd(w){this.map=w,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(w,f){}serialize(){return{type:"model"}}},"batched-model":class extends o.E{constructor(w,f,v,S){super(),this.type="batched-model",this.id=w,this.tileSize=512,this._options=f,this.tiles=this._options.tiles,this.maxzoom=f.maxzoom||19,this.minzoom=f.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=v,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(S)}onAdd(w){this.map=w,this.load()}load(w){this._loaded=!1,this.fire(new o.b("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map._worldview;this._tileJSONRequest=Qt(this._options,this.map._requestManager,f,v,(S,C)=>{this._tileJSONRequest=null,this._loaded=!0,S?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),v&&v.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new o.a(S))):C&&(o.e(this,C),C.bounds&&(this.tileBounds=new Xt(C.bounds,this.minzoom,this.maxzoom)),o.am(C.tiles,this.map._requestManager._customAccessToken),this.fire(new o.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.b("data",{dataType:"source",sourceDataType:"content"}))),w&&w(S)})}hasTransition(){return!1}hasTile(w){return!this.tileBounds||this.tileBounds.contains(w.canonical)}loaded(){return this._loaded}loadTile(w,f){const v=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(v,o.R.Tile),data:void 0,uid:w.uid,tileID:w.tileID,tileZoom:w.tileZoom,zoom:w.tileID.overscaledZ,tileSize:this.tileSize*w.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:w.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(w.actor&&w.state!=="expired")if(w.state==="loading")w.reloadCallback=f;else{if(w.buckets){const E=Object.values(w.buckets);for(const R of E)R.dirty=!0;return void(w.state="loaded")}w.request=w.actor.send("reloadTile",S,C.bind(this))}else w.actor=this.dispatcher.getActor(),w.request=w.actor.send("loadTile",S,C.bind(this),void 0,!0);function C(E,R){return w.aborted?f(null):E&&E.status!==404?f(E):(R&&(R.resourceTiming&&(w.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&w.setExpiryData(R),w.buckets={...w.buckets,...R.buckets},R.featureIndex&&(w.latestFeatureIndex=R.featureIndex)),w.state="loaded",void f(null))}}serialize(){return o.e({},this._options)}},canvas:class extends o.as{constructor(w,f,v,S){super(w,f,v,S),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some(C=>!Array.isArray(C)||C.length!==2||C.some(E=>typeof E!="number"))||this.fire(new o.a(new o.V(`sources.${w}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.a(new o.V(`sources.${w}`,null,'missing required property "coordinates"'))),f.animate&&typeof f.animate!="boolean"&&this.fire(new o.a(new o.V(`sources.${w}`,null,'optional "animate" property must be a boolean value'))),f.canvas?typeof f.canvas=="string"||f.canvas instanceof HTMLCanvasElement||this.fire(new o.a(new o.V(`sources.${w}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.a(new o.V(`sources.${w}`,null,'missing required property "canvas"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.a(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(w){this.map=w,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let w=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,w=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,w=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const f=this.map.painter.context;this.texture?!w&&!this._playing||this.texture instanceof o.au||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(f,this.canvas,f.gl.RGBA,{premultiply:!0}),this._prepareData(f)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const w of[this.canvas.width,this.canvas.height])if(isNaN(w)||w<=0)return!0;return!1}},custom:class extends o.E{constructor(w,f,v,S){super(),this.id=w,this.type="custom",this._dataType="raster",this._dispatcher=v,this._implementation=f,this.setEventedParent(S),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.a(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.a(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Xt(this._implementation.bounds,this.minzoom,this.maxzoom)),f.update=this._update.bind(this),f.clearTiles=this._clearTiles.bind(this),f.coveringTiles=this._coveringTiles.bind(this),o.e(this,o.af(f,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.af(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.b("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(w){this._map=w,this._loaded=!1,this.fire(new o.b("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(w),this.load()}onRemove(w){this._implementation.onRemove&&this._implementation.onRemove(w)}hasTile(w){if(this._implementation.hasTile){const{x:f,y:v,z:S}=w.canonical;return this._implementation.hasTile({x:f,y:v,z:S})}return!this.tileBounds||this.tileBounds.contains(w.canonical)}loadTile(w,f){const{x:v,y:S,z:C}=w.tileID.canonical,E=new AbortController;w.request=Promise.resolve(this._implementation.loadTile({x:v,y:S,z:C},{signal:E.signal})).then((function(R){return delete w.request,w.aborted?(w.state="unloaded",f(null)):R===void 0?(w.state="errored",f(null)):R===null?(this.loadTileData(w,{width:this.tileSize,height:this.tileSize,data:null}),w.state="loaded",f(null)):function(B){return B instanceof ImageData||B instanceof HTMLCanvasElement||B instanceof ImageBitmap||B instanceof HTMLImageElement}(R)?(this.loadTileData(w,R),w.state="loaded",void f(null)):(w.state="errored",f(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(R=>{R.code!==20&&(w.state="errored",f(R))}),w.request.cancel=()=>E.abort()}loadTileData(w,f){w.setTexture(f,this._map.painter)}unloadTile(w,f){if(w.texture&&w.texture instanceof o.T?(w.destroy(!0),w.texture&&w.texture instanceof o.T&&this._map.painter.saveTileTexture(w.texture)):w.destroy(),this._implementation.unloadTile){const{x:v,y:S,z:C}=w.tileID.canonical;this._implementation.unloadTile({x:v,y:S,z:C})}f()}abortTile(w,f){w.request&&w.request.cancel&&(w.request.cancel(),delete w.request),f()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(w=>({x:w.canonical.x,y:w.canonical.y,z:w.canonical.z}))}_clearTiles(){const w=o.aj(this.id,this.scope);this._map.style.clearSource(w)}_update(){this.fire(new o.b("data",{dataType:"source",sourceDataType:"content"}))}}},My=function(w,f,v,S){const C=new nr[f.type](w,f,v,S);if(C.id!==w)throw new Error(`Expected Source id to be ${w} instead of ${C.id}`);return o.a$(["load","abort","unload","serialize","prepare"],C),C};function Iy(w,f){const v=o.a9.identity([]);return o.a9.scale(v,v,[.5*w.width,.5*-w.height,1]),o.a9.translate(v,v,[1,-1,0]),o.a9.multiply(v,v,w.calculateProjMatrix(f.toUnwrapped())),Float32Array.from(v)}function On(w,f,v,S,C,E,R,B=!1){const G=w.tilesIn(S,R,B);G.sort(lw);const j=[];for(const K of G)j.push({wrappedTileID:K.tile.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(f,v,w._state,K,C,E,Iy(w.transform,K.tile.tileID),B)});const q=function(K){const te={},ne={};for(const le of K){const se=le.queryResults,ue=le.wrappedTileID,ce=ne[ue]=ne[ue]||{};for(const ye in se){const Ce=se[ye],Ae=ce[ye]=ce[ye]||{},De=te[ye]=te[ye]||[];for(const he of Ce)Ae[he.featureIndex]||(Ae[he.featureIndex]=!0,De.push(he))}}return te}(j);for(const K in q)q[K].forEach(te=>{const ne=te.feature,le=ne.layer;le&&le.type!=="background"&&le.type!=="sky"&&le.type!=="slot"&&(ne.source=le.source,le["source-layer"]&&(ne.sourceLayer=le["source-layer"]),ne.state=ne.id!==void 0?w.getFeatureState(le["source-layer"],ne.id):{})});return q}function mo(w,f){const v=w.getRenderableIds().map(E=>w.getTileByID(E)),S=[],C={};for(let E=0;E<v.length;E++){const R=v[E],B=R.tileID.canonical.key;C[B]||(C[B]=!0,R.querySourceFeatures(S,f))}return S}function lw(w,f){const v=w.tileID,S=f.tileID;return v.overscaledZ-S.overscaledZ||v.canonical.y-S.canonical.y||v.wrap-S.wrap||v.canonical.x-S.canonical.x}class Sv extends Ls{constructor(f,v,S,C,E){super(f,v,S,C,E),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(f,v){const S=v.context,C=S.gl;this.texture=this.texture||v.getTileTexture(f.width),this.texture&&this.texture instanceof o.T?this.texture.update(f,{useMipmap:!1,premultiply:!1}):this.texture=new o.T(S,f,C.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(f=16384,v){const S=this._mrt=new o.b0(30),C=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(f-1)}});return this.entireBuffer=null,this.request=o.b1(C,(E,R,B,G)=>{if(E)v(E);else try{const j=S.getHeaderLength(R);if(j>f)return void(this.request=this.fetchHeader(j,v));S.parseHeader(R),this._isHeaderLoaded=!0;let q=0;for(const K of Object.values(S.layers))q=Math.max(q,K.dataIndex[K.dataIndex.length-1].last_byte);R.byteLength>=q&&(this.entireBuffer=R),v(null,this.entireBuffer||R,B,G)}catch(j){v(j)}}),this.request}fetchBand(f,v,S){const C=this._mrt;if(!this._isHeaderLoaded||!C)return void S(new Error("Tile header is not ready"));const E=this.actor;if(!E)return void S(new Error("Can't fetch tile band without an actor"));let R;const B=(K,te)=>{R.complete(K,te),K?S(K):(this.updateTextureDescriptor(f,v),S(null,this.textureDescriptor&&this.textureDescriptor.img))},G=(K,te)=>{if(K)return S(K);const ne=E.send("decodeRasterArray",{buffer:te,task:R},B,void 0,!0);this._workQueue.push(()=>{ne&&ne.cancel(),R.cancel()})},j=C.getLayer(f);if(!j)return void S(new Error(`Unknown sourceLayer "${f}"`));if(j.hasDataForBand(v))return this.updateTextureDescriptor(f,v),void S(null,this.textureDescriptor?this.textureDescriptor.img:null);const q=j.getDataRange([v]);if(R=C.createDecodingTask(q),!R||R.tasks.length)if(this.flushQueues(),this.entireBuffer)G(null,this.entireBuffer.slice(q.firstByte,q.lastByte+1));else{const K=Object.assign({},this.requestParams,{headers:{Range:`bytes=${q.firstByte}-${q.lastByte}`}}),te=o.b1(K,G);this._fetchQueue.push(()=>{te.cancel(),R.cancel()})}else S(null)}updateNeeded(f,v){return(!this.textureDescriptor||this.textureDescriptor.band!==v||this.textureDescriptor.layer!==f)&&this.state!=="errored"}updateTextureDescriptor(f,v){if(!this._mrt)return;const S=this._mrt.getLayer(f);if(!S||!S.hasBand(v)||!S.hasDataForBand(v))return;const{bytes:C,tileSize:E,buffer:R,offset:B,scale:G}=S.getBandView(v),j=E+2*R,q={data:C,width:j,height:j},K=this.texture;K&&K instanceof o.T&&K.update(q,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:f,band:v,img:q,buffer:R,offset:B,tileSize:E,format:S.pixelFormat,mix:[G,256*G,65536*G,16777216*G]}}}class uw{constructor(f,v){this.max=f,this.onRemove=v,this.reset()}reset(){for(const f in this.data)for(const v of this.data[f])v.timeout&&clearTimeout(v.timeout),this.onRemove(v.value);return this.data={},this.order=[],this}add(f,v,S){const C=f.wrapped().key;this.data[C]===void 0&&(this.data[C]=[]);const E={value:v,timeout:void 0};if(S!==void 0&&(E.timeout=setTimeout(()=>{this.remove(f,E)},S)),this.data[C].push(E),this.order.push(C),this.order.length>this.max){const R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this}has(f){return f.wrapped().key in this.data}getAndRemove(f){return this.has(f)?this._getAndRemoveByKey(f.wrapped().key):null}_getAndRemoveByKey(f){const v=this.data[f].shift();return v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.order.splice(this.order.indexOf(f),1),v.value}getByKey(f){const v=this.data[f];return v?v[0].value:null}get(f){return this.has(f)?this.data[f.wrapped().key][0].value:null}remove(f,v){if(!this.has(f))return this;const S=f.wrapped().key,C=v===void 0?0:this.data[S].indexOf(v),E=this.data[S][C];return this.data[S].splice(C,1),E.timeout&&clearTimeout(E.timeout),this.data[S].length===0&&delete this.data[S],this.onRemove(E.value),this.order.splice(this.order.indexOf(S),1),this}setMaxSize(f){for(this.max=f;this.order.length>this.max;){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}filter(f){const v=[];for(const S in this.data)for(const C of this.data[S])f(C.value)||v.push(C);for(const S of v)this.remove(S.value.tileID,S)}}class Rs extends o.E{constructor(f,v,S){super(),this.id=f,this._onlySymbols=S,v.on("data",C=>{C.dataType==="source"&&C.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&C.dataType==="source"&&C.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),v.on("error",()=>{this._sourceErrored=!0}),this._source=v,this._tiles={},this._cache=new uw(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ae,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(f){this.map=f,this._minTileCacheSize=this._minTileCacheSize===void 0&&f?f._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&f?f._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const f in this._tiles){const v=this._tiles[f];if(v.state!=="errored"&&(v.state!=="loaded"||!v.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const f=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,f&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(f,v){return f.isSymbolTile=this._onlySymbols,f.isExtraShadowCaster=this._shadowCasterTiles[f.tileID.key],this._source.loadTile(f,v)}_unloadTile(f){if(this._source.unloadTile)return this._source.unloadTile(f,()=>{})}_abortTile(f){if(this._source.abortTile)return this._source.abortTile(f,()=>{})}serialize(){return this._source.serialize()}prepare(f){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const v in this._tiles){const S=this._tiles[v];S.upload(f),S.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return o.b2(this._tiles).map(f=>f.tileID).sort(wn).map(f=>f.key)}getRenderableIds(f,v){const S=[];for(const C in this._tiles)this._isIdRenderable(+C,f,v)&&S.push(this._tiles[C]);return f?S.sort((C,E)=>{const R=C.tileID,B=E.tileID,G=new o.P(R.canonical.x,R.canonical.y)._rotate(this.transform.angle),j=new o.P(B.canonical.x,B.canonical.y)._rotate(this.transform.angle);return R.overscaledZ-B.overscaledZ||j.y-G.y||j.x-G.x}).map(C=>C.tileID.key):S.map(C=>C.tileID).sort(wn).map(C=>C.key)}hasRenderableParent(f){const v=this.findLoadedParent(f,0);return!!v&&this._isIdRenderable(v.tileID.key)}_isIdRenderable(f,v,S){return this._tiles[f]&&this._tiles[f].hasData()&&!this._coveredTiles[f]&&(v||!this._tiles[f].holdingForFade())&&(S||!this._shadowCasterTiles[f])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const f in this._tiles)this._tiles[f].state!=="errored"&&this._reloadTile(+f,"reloading")}}_reloadTile(f,v){const S=this._tiles[f];S&&(S.state!=="loading"&&(S.state=v),this._loadTile(S,this._tileLoaded.bind(this,S,f,v)))}_tileLoaded(f,v,S,C){if(C)if(f.state="errored",C.status!==404)this._source.fire(new o.a(C,{tile:f}));else{if(!(f.tileID.key in this._loadedParentTiles))return void this._source.fire(new o.b("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const E=this.map.painter.terrain;this.update(this.transform,E.getScaledDemTileSize(),!0),E.resetTileLookupCache(this.id)}else this.update(this.transform)}else f.timeAdded=o.f.now(),S==="expired"&&(f.refreshedUponExpiration=!0),this._setTileReloadTimer(v,f),this._source.type==="raster-dem"&&f.dem&&this._backfillDEM(f),this._state.initializeTileState(f,this.map?this.map.painter:null),this._source.fire(new o.b("data",{dataType:"source",tile:f,coord:f.tileID,sourceCacheId:this.id}))}_backfillDEM(f){const v=this.getRenderableIds();for(let C=0;C<v.length;C++){const E=v[C];if(f.neighboringTiles&&f.neighboringTiles[E]){const R=this.getTileByID(E);S(f,R),S(R,f)}}function S(C,E){if(!C.dem||C.dem.borderReady)return;C.needsHillshadePrepare=!0,C.needsDEMTextureUpload=!0;let R=E.tileID.canonical.x-C.tileID.canonical.x;const B=E.tileID.canonical.y-C.tileID.canonical.y,G=Math.pow(2,C.tileID.canonical.z),j=E.tileID.key;R===0&&B===0||Math.abs(B)>1||(Math.abs(R)>1&&(Math.abs(R+G)===1?R+=G:Math.abs(R-G)===1&&(R-=G)),E.dem&&C.dem&&(C.dem.backfillBorder(E.dem,R,B),C.neighboringTiles&&C.neighboringTiles[j]&&(C.neighboringTiles[j].backfilled=!0)))}}getTile(f){return this.getTileByID(f.key)}getTileByID(f){return this._tiles[f]}_retainLoadedChildren(f,v,S,C){for(const E in this._tiles){let R=this._tiles[E];if(C[E]||!R.hasData()||R.tileID.overscaledZ<=v||R.tileID.overscaledZ>S)continue;let B=R.tileID;for(;R&&R.tileID.overscaledZ>v+1;){const j=R.tileID.scaledTo(R.tileID.overscaledZ-1);R=this._tiles[j.key],R&&R.hasData()&&(B=j)}let G=B;for(;G.overscaledZ>v;)if(G=G.scaledTo(G.overscaledZ-1),f[G.key]){C[B.key]=B;break}}}findLoadedParent(f,v){if(f.key in this._loadedParentTiles){const S=this._loadedParentTiles[f.key];return S&&S.tileID.overscaledZ>=v?S:null}for(let S=f.overscaledZ-1;S>=v;S--){const C=f.scaledTo(S),E=this._getLoadedTile(C);if(E)return E}}_getLoadedTile(f){const v=this._tiles[f.key];return v&&v.hasData()?v:this._cache.getByKey(this._source.reparseOverscaled?f.wrapped().key:f.canonical.key)}updateCacheSize(f,v){v=v||this._source.tileSize;const S=Math.ceil(f.width/v)+1,C=Math.ceil(f.height/v)+1,E=Math.floor(S*C*5),R=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,E):E,B=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,R):R;this._cache.setMaxSize(B)}handleWrapJump(f){const v=Math.round((f-(this._prevLng===void 0?f:this._prevLng))/360);if(this._prevLng=f,v){const S={};for(const C in this._tiles){const E=this._tiles[C];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+v),S[E.tileID.key]=E}this._tiles=S;for(const C in this._timers)clearTimeout(this._timers[C]),delete this._timers[C];for(const C in this._tiles)this._setTileReloadTimer(+C,this._tiles[C])}}update(f,v,S,C){if(this.transform=f,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!S)return;let E;if(this.updateCacheSize(f,v),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain)if(this._source.tileID)E=f.getVisibleUnwrappedCoordinates(this._source.tileID).map(G=>new o.ap(G.canonical.z,G.wrap,G.canonical.z,G.canonical.x,G.canonical.y));else if(this.tileCoverLift!==0){const G=f.clone();G.tileCoverLift=this.tileCoverLift,E=G.coveringTiles({tileSize:v||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!S,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&f.projection.name==="globe"&&(E.push(new o.ap(1,0,1,0,0)),E.push(new o.ap(1,0,1,1,0)),E.push(new o.ap(1,0,1,0,1)),E.push(new o.ap(1,0,1,1,1)))}else E=f.coveringTiles({tileSize:v||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!S,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(E=E.filter(G=>this._source.hasTile(G)));else E=[];if(E.length>0&&this.castsShadows&&C&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Pd(this._source.type)){const G=f.coveringZoomLevel({tileSize:v||this._source.tileSize,roundZoom:this._source.roundZoom&&!S}),j=Math.min(G,this._source.maxzoom),q=f.extendTileCoverForShadows(E,C,j);for(const K of q)this._shadowCasterTiles[K.key]=!0,E.push(K)}const R=this._updateRetainedTiles(E);if(Pd(this._source.type)&&E.length!==0){const G={},j={},q=Object.keys(R);for(const te of q){const ne=R[te],le=this._tiles[te];if(!le||le.fadeEndTime&&le.fadeEndTime<=o.f.now())continue;const se=this.findLoadedParent(ne,Math.max(ne.overscaledZ-Rs.maxOverzooming,this._source.minzoom));se&&(this._addTile(se.tileID),G[se.tileID.key]=se.tileID),j[te]=ne}const K=E[E.length-1].overscaledZ;for(const te in this._tiles){const ne=this._tiles[te];if(R[te]||!ne.hasData())continue;let le=ne.tileID;for(;le.overscaledZ>K;){le=le.scaledTo(le.overscaledZ-1);const se=this._tiles[le.key];if(se&&se.hasData()&&j[le.key]){R[te]=ne.tileID;break}}}for(const te in G)R[te]||(this._coveredTiles[te]=!0,R[te]=G[te])}for(const G in R)this._tiles[G].clearFadeHold();const B=o.b3(this._tiles,R);for(const G of B){const j=this._tiles[G];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(+G)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const f in this._tiles)this._tiles[f].holdingForFade()&&this._removeTile(+f)}_updateRetainedTiles(f){const v={};if(f.length===0)return v;const S={},C=f.reduce((j,q)=>Math.min(j,q.overscaledZ),1/0),E=f[0].overscaledZ,R=Math.max(E-Rs.maxOverzooming,this._source.minzoom),B=Math.max(E+Rs.maxUnderzooming,this._source.minzoom),G={};for(const j of f){const q=this._addTile(j);v[j.key]=j,q.hasData()||C<this._source.maxzoom&&(G[j.key]=j)}this._retainLoadedChildren(G,C,B,v);for(const j of f){let q=this._tiles[j.key];if(q.hasData())continue;if(j.canonical.z>=this._source.maxzoom){const te=j.children(this._source.maxzoom)[0],ne=this.getTile(te);if(ne&&ne.hasData()){v[te.key]=te;continue}}else{const te=j.children(this._source.maxzoom);if(v[te[0].key]&&v[te[1].key]&&v[te[2].key]&&v[te[3].key])continue}let K=q.wasRequested();for(let te=j.overscaledZ-1;te>=R;--te){const ne=j.scaledTo(te);if(S[ne.key]||(S[ne.key]=!0,q=this.getTile(ne),!q&&K&&(q=this._addTile(ne)),q&&(v[ne.key]=ne,K=q.wasRequested(),q.hasData())))break}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const f in this._tiles){const v=[];let S,C=this._tiles[f].tileID;for(;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){S=this._loadedParentTiles[C.key];break}v.push(C.key);const E=C.scaledTo(C.overscaledZ-1);if(S=this._getLoadedTile(E),S)break;C=E}for(const E of v)this._loadedParentTiles[E]=S}}_addTile(f){let v=this._tiles[f.key];if(v)return v.isExtraShadowCaster!==!0||this._shadowCasterTiles[f.key]||this._reloadTile(f.key,"reloading"),v;v=this._cache.getAndRemove(f),v&&(this._setTileReloadTimer(f.key,v),v.tileID=f,this._state.initializeTileState(v,this.map?this.map.painter:null),this._cacheTimers[f.key]&&(clearTimeout(this._cacheTimers[f.key]),delete this._cacheTimers[f.key],this._setTileReloadTimer(f.key,v)));const S=!!v;if(!S){const C=this.map?this.map.painter:null,E=this._source.tileSize*f.overscaleFactor();v=this._source.type==="raster-array"?new Sv(f,E,this.transform.tileZoom,C,this._isRaster):new Ls(f,E,this.transform.tileZoom,C,this._isRaster),this._loadTile(v,this._tileLoaded.bind(this,v,f.key,v.state))}return v?(v.uses++,this._tiles[f.key]=v,S||this._source.fire(new o.b("dataloading",{tile:v,coord:v.tileID,dataType:"source"})),v):null}_setTileReloadTimer(f,v){f in this._timers&&(clearTimeout(this._timers[f]),delete this._timers[f]);const S=v.getExpiryTimeout();S&&(this._timers[f]=setTimeout(()=>{this._reloadTile(f,"expired"),delete this._timers[f]},S))}_removeTile(f){const v=this._tiles[f];v&&(v.uses--,delete this._tiles[f],this._timers[f]&&(clearTimeout(this._timers[f]),delete this._timers[f]),v.uses>0||(v.hasData()&&v.state!=="reloading"||v.state==="empty"?this._cache.add(v.tileID,v,v.getExpiryTimeout()):(v.aborted=!0,this._abortTile(v),this._unloadTile(v))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const f in this._tiles)this._removeTile(+f);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(f,v,S){const C=[],E=this.transform;if(!E)return C;const R=E.projection.name==="globe",B=o.a8(E.center.lng);for(const G in this._tiles){const j=this._tiles[G];if(S&&j.clearQueryDebugViz(),j.holdingForFade())continue;let q;if(R){const K=j.tileID.canonical;if(K.z===0){const te=[Math.abs(o.ad(B,...Ul(K,-1))-B),Math.abs(o.ad(B,...Ul(K,1))-B)];q=[0,2*te.indexOf(Math.min(...te))-1]}else{const te=[Math.abs(o.ad(B,...Ul(K,-1))-B),Math.abs(o.ad(B,...Ul(K,0))-B),Math.abs(o.ad(B,...Ul(K,1))-B)];q=[te.indexOf(Math.min(...te))-1]}}else q=[0];for(const K of q){const te=f.containsTile(j,E,v,K);te&&C.push(te)}}return C}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(f){return this._getRenderableCoordinates(f)}_getRenderableCoordinates(f,v){const S=this.getRenderableIds(f,v).map(E=>this._tiles[E].tileID),C=this.transform.projection.name==="globe";for(const E of S)E.projMatrix=this.transform.calculateProjMatrix(E.toUnwrapped()),E.expandedProjMatrix=C?this.transform.calculateProjMatrix(E.toUnwrapped(),!1,!0):E.projMatrix;return S}sortCoordinatesByDistance(f){const v=f.slice(),S=this.transform._camera.position,C=this.transform._camera.forward(),E={};for(const R of v){const B=1/(1<<R.canonical.z);E[R.key]=((R.canonical.x+.5)*B+R.wrap-S[0])*C[0]+((R.canonical.y+.5)*B-S[1])*C[1]-S[2]*C[2]}return v.sort((R,B)=>E[R.key]-E[B.key]),v}hasTransition(){if(this._source.hasTransition())return!0;if(Pd(this._source.type))for(const f in this._tiles){const v=this._tiles[f];if(v.fadeEndTime!==void 0&&v.fadeEndTime>=o.f.now())return!0}return!1}setFeatureState(f,v,S){this._state.updateState(f=f||"_geojsonTileLayer",v,S)}removeFeatureState(f,v,S){this._state.removeFeatureState(f=f||"_geojsonTileLayer",v,S)}getFeatureState(f,v){return this._state.getState(f=f||"_geojsonTileLayer",v)}setDependencies(f,v,S){const C=this._tiles[f];C&&C.setDependencies(v,S)}reloadTilesForDependencies(f,v){for(const S in this._tiles)this._tiles[S].hasDependency(f,v)&&this._reloadTile(+S,"reloading");this._cache.filter(S=>!S.hasDependency(f,v))}_preloadTiles(f,v){if(!this._sourceLoaded){const G=()=>{this._sourceLoaded&&(this._source.off("data",G),this._preloadTiles(f,v))};return void this._source.on("data",G)}const S=new Map,C=Array.isArray(f)?f:[f],E=this.map.painter.terrain,R=this.usedForTerrain&&E?E.getScaledDemTileSize():this._source.tileSize;for(const G of C){const j=G.coveringTiles({tileSize:R,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const q of j)S.set(q.key,q);this.usedForTerrain&&G.updateElevation(!1)}const B=Array.from(S.values());o.b4(B,(G,j)=>{const q=new Ls(G,this._source.tileSize*G.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(q,K=>{this._source.type==="raster-dem"&&q.dem&&this._backfillDEM(q),j(K,q)})},v)}}function wn(w,f){const v=Math.abs(2*w.wrap)-+(w.wrap<0),S=Math.abs(2*f.wrap)-+(f.wrap<0);return w.overscaledZ-f.overscaledZ||S-v||f.canonical.y-w.canonical.y||f.canonical.x-w.canonical.x}function Pd(w){return w==="raster"||w==="image"||w==="video"||w==="custom"}function Ul(w,f){const v=1<<w.z;return[w.x/v+f,(w.x+1)/v+f]}Rs.maxOverzooming=10,Rs.maxUnderzooming=3;class Ey{constructor(f){this.style=f,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const f=!1,v=!1;for(const S in this.style._mergedLayers){const C=this.style._mergedLayers[S];if(C.type==="fill-extrusion")this.layers.push({layer:C,visible:f,visibilityChanged:v});else if(C.type==="model"){const E=this.style.getLayerSource(C);E&&E.type==="batched-model"&&this.layers.push({layer:C,visible:f,visibilityChanged:v})}}}onNewFrame(f){this.layersGotHidden=!1;for(const v of this.layers){const S=v.layer;let C=!1;S.type==="fill-extrusion"?C=!S.isHidden(f)&&S.paint.get("fill-extrusion-opacity")>0:S.type==="model"&&(C=!S.isHidden(f)&&S.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!C&&v.visible,v.visible=C}}updateZOffset(f,v){this.currentBuildingBuckets=[];for(const C of this.layers){const E=C.layer,R=this.style.getLayerSourceCache(E);let B=1;E.type==="fill-extrusion"&&(B=C.visible?E.paint.get("fill-extrusion-vertical-scale"):0);let G=R?R.getTile(v):null;if(!G&&R&&v.canonical.z>R.getSource().minzoom){let j=v.scaledTo(Math.min(R.getSource().maxzoom,v.overscaledZ-1));for(;j.overscaledZ>=R.getSource().minzoom&&(G=R.getTile(j),!G&&j.overscaledZ!==0);)j=j.scaledTo(j.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:G?G.getBucket(E):null,tileID:G?G.tileID:v,verticalScale:B})}f.hasAnyZOffset=!1;let S=!1;for(let C=0;C<f.symbolInstances.length;C++){const E=f.symbolInstances.get(C),R=E.zOffset,B=this._getHeightAtTileOffset(v,E.tileAnchorX,E.tileAnchorY);E.zOffset=B!==Number.NEGATIVE_INFINITY?B:R,S||R===E.zOffset||(S=!0),f.hasAnyZOffset||E.zOffset===0||(f.hasAnyZOffset=!0)}S&&(f.zOffsetBuffersNeedUpload=!0,f.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(f,v,S,C){let E=v,R=S;if(f.canonical.z!==C.canonical.z){const B=C.canonical,G=1/(1<<f.canonical.z-B.z);E=(v+f.canonical.x*o.Y)*G-B.x*o.Y|0,R=(S+f.canonical.y*o.Y)*G-B.y*o.Y|0}return{tileX:E,tileY:R}}_getHeightAtTileOffset(f,v,S){let C,E;for(let R=0;R<this.layers.length;++R){if(this.layers[R].layer.type!=="fill-extrusion")continue;const{bucket:B,tileID:G,verticalScale:j}=this.currentBuildingBuckets[R];if(!B)continue;const{tileX:q,tileY:K}=this._mapCoordToOverlappingTile(f,v,S,G),te=B.getHeightAtTileCoord(q,K);te&&te.height!==void 0&&(te.hidden?C=te.height:E=Math.max(te.height*j,E||0))}if(E!==void 0)return E;for(let R=0;R<this.layers.length;++R){const B=this.layers[R];if(B.layer.type!=="model"||!B.visible)continue;const{bucket:G,tileID:j}=this.currentBuildingBuckets[R];if(!G)continue;const{tileX:q,tileY:K}=this._mapCoordToOverlappingTile(f,v,S,j),te=G.getHeightAtTileCoord(q,K);if(te&&!te.hidden)return te.height===void 0&&C!==void 0?Math.min(te.maxHeight,C)*te.verticalScale:te.height?te.height*te.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function us(w,f){const v={};for(const S in w)S!=="ref"&&(v[S]=w[S]);return o.b5.forEach(S=>{S in f&&(v[S]=f[S])}),v}function cw(w){w=w.slice();const f=Object.create(null);for(let v=0;v<w.length;v++)f[w[v].id]=w[v];for(let v=0;v<w.length;v++)"ref"in w[v]&&(w[v]=us(w[v],f[w[v].ref]));return w}const Zn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Tv(w,f,v){v.push({command:Zn.addSource,args:[w,f[w]]})}function Dy(w,f,v){f.push({command:Zn.removeSource,args:[w]}),v[w]=!0}function hw(w,f,v,S){Dy(w,v,S),Tv(w,f,v)}function Py(w,f,v){let S;for(S in w[v])if(w[v].hasOwnProperty(S)&&S!=="data"&&!d(w[v][S],f[v][S]))return!1;for(S in f[v])if(f[v].hasOwnProperty(S)&&S!=="data"&&!d(w[v][S],f[v][S]))return!1;return!0}function Sc(w,f,v,S,C,E){let R;for(R in f=f||{},w=w||{})w.hasOwnProperty(R)&&(d(w[R],f[R])||v.push({command:E,args:[S,R,f[R],C]}));for(R in f)f.hasOwnProperty(R)&&!w.hasOwnProperty(R)&&(d(w[R],f[R])||v.push({command:E,args:[S,R,f[R],C]}))}function Ih(w){return w.id}function Ld(w,f){return w[f.id]=f,w}class $l{constructor(f,v){this.reset(f,v)}reset(f,v){this.points=f||[],this._distances=[0];for(let S=1;S<this.points.length;S++)this._distances[S]=this._distances[S-1]+this.points[S].dist(this.points[S-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(v||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(f){if(this.points.length===1)return this.points[0];f=o.ad(f,0,1);let v=1,S=this._distances[v];const C=f*this.paddedLength+this.padding;for(;S<C&&v<this._distances.length;)S=this._distances[++v];const E=v-1,R=this._distances[E],B=S-R,G=B>0?(C-R)/B:0;return this.points[E].mult(1-G).add(this.points[v].mult(G))}}class Ly{constructor(f,v,S){const C=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(f/S),this.yCellCount=Math.ceil(v/S);for(let R=0;R<this.xCellCount*this.yCellCount;R++)C.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=f,this.height=v,this.xScale=this.xCellCount/f,this.yScale=this.yCellCount/v,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(f,v,S,C,E){this._forEachCell(v,S,C,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(f),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(C),this.bboxes.push(E)}insertCircle(f,v,S,C){this._forEachCell(v-C,S-C,v+C,S+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(f),this.circles.push(v),this.circles.push(S),this.circles.push(C)}_insertBoxCell(f,v,S,C,E,R){this.boxCells[E].push(R)}_insertCircleCell(f,v,S,C,E,R){this.circleCells[E].push(R)}_query(f,v,S,C,E,R){if(S<0||f>this.width||C<0||v>this.height)return!E&&[];const B=[];if(f<=0&&v<=0&&this.width<=S&&this.height<=C){if(E)return!0;for(let G=0;G<this.boxKeys.length;G++)B.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const j=this.circles[3*G],q=this.circles[3*G+1],K=this.circles[3*G+2];B.push({key:this.circleKeys[G],x1:j-K,y1:q-K,x2:j+K,y2:q+K})}return R?B.filter(R):B}return this._forEachCell(f,v,S,C,this._queryCell,B,{hitTest:E,seenUids:{box:{},circle:{}}},R),E?B.length>0:B}_queryCircle(f,v,S,C,E){const R=f-S,B=f+S,G=v-S,j=v+S;if(B<0||R>this.width||j<0||G>this.height)return!C&&[];const q=[];return this._forEachCell(R,G,B,j,this._queryCellCircle,q,{hitTest:C,circle:{x:f,y:v,radius:S},seenUids:{box:{},circle:{}}},E),C?q.length>0:q}query(f,v,S,C,E){return this._query(f,v,S,C,!1,E)}hitTest(f,v,S,C,E){return this._query(f,v,S,C,!0,E)}hitTestCircle(f,v,S,C){return this._queryCircle(f,v,S,!0,C)}_queryCell(f,v,S,C,E,R,B,G){const j=B.seenUids,q=this.boxCells[E];if(q!==null){const te=this.bboxes;for(const ne of q)if(!j.box[ne]){j.box[ne]=!0;const le=4*ne;if(f<=te[le+2]&&v<=te[le+3]&&S>=te[le+0]&&C>=te[le+1]&&(!G||G(this.boxKeys[ne]))){if(B.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[ne],x1:te[le],y1:te[le+1],x2:te[le+2],y2:te[le+3]})}}}const K=this.circleCells[E];if(K!==null){const te=this.circles;for(const ne of K)if(!j.circle[ne]){j.circle[ne]=!0;const le=3*ne;if(this._circleAndRectCollide(te[le],te[le+1],te[le+2],f,v,S,C)&&(!G||G(this.circleKeys[ne]))){if(B.hitTest)return R.push(!0),!0;{const se=te[le],ue=te[le+1],ce=te[le+2];R.push({key:this.circleKeys[ne],x1:se-ce,y1:ue-ce,x2:se+ce,y2:ue+ce})}}}}}_queryCellCircle(f,v,S,C,E,R,B,G){const j=B.circle,q=B.seenUids,K=this.boxCells[E];if(K!==null){const ne=this.bboxes;for(const le of K)if(!q.box[le]){q.box[le]=!0;const se=4*le;if(this._circleAndRectCollide(j.x,j.y,j.radius,ne[se+0],ne[se+1],ne[se+2],ne[se+3])&&(!G||G(this.boxKeys[le])))return R.push(!0),!0}}const te=this.circleCells[E];if(te!==null){const ne=this.circles;for(const le of te)if(!q.circle[le]){q.circle[le]=!0;const se=3*le;if(this._circlesCollide(ne[se],ne[se+1],ne[se+2],j.x,j.y,j.radius)&&(!G||G(this.circleKeys[le])))return R.push(!0),!0}}}_forEachCell(f,v,S,C,E,R,B,G){const j=this._convertToXCellCoord(f),q=this._convertToYCellCoord(v),K=this._convertToXCellCoord(S),te=this._convertToYCellCoord(C);for(let ne=j;ne<=K;ne++)for(let le=q;le<=te;le++)if(E.call(this,f,v,S,C,this.xCellCount*le+ne,R,B,G))return}_convertToXCellCoord(f){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(f*this.xScale)))}_convertToYCellCoord(f){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(f*this.yScale)))}_circlesCollide(f,v,S,C,E,R){const B=C-f,G=E-v,j=S+R;return j*j>B*B+G*G}_circleAndRectCollide(f,v,S,C,E,R,B){const G=(R-C)/2,j=Math.abs(f-(C+G));if(j>G+S)return!1;const q=(B-E)/2,K=Math.abs(v-(E+q));if(K>q+S)return!1;if(j<=G||K<=q)return!0;const te=j-G,ne=K-q;return te*te+ne*ne<=S*S}}const Gi={unknown:0,flipRequired:1,flipNotRequired:2},Cu=Math.tan(85*Math.PI/180);function Rd(w,f,v,S,C,E,R){const B=o.a9.create();if(v)if(E.name==="globe"){const G=o.b6(C,f);o.a9.multiply(B,B,G)}else{const G=o.b7.invert([],R);B[0]=G[0],B[1]=G[1],B[4]=G[2],B[5]=G[3],S||o.a9.rotateZ(B,B,C.angle)}else o.a9.multiply(B,C.labelPlaneMatrix,w);return B}function kd(w,f,v,S,C,E,R){const B=Rd(w,f,v,S,C,E,R);return E.name==="globe"&&v||(B[2]=B[6]=B[10]=B[14]=0),B}function Hl(w,f,v,S,C,E,R){if(v){if(E.name==="globe"){const B=Rd(w,f,v,S,C,E,R);return o.a9.invert(B,B),o.a9.multiply(B,w,B),B}{const B=o.a9.clone(w),G=o.a9.identity([]);return G[0]=R[0],G[1]=R[1],G[4]=R[2],G[5]=R[3],o.a9.multiply(B,B,G),S||o.a9.rotateZ(B,B,-C.angle),B}}return C.glCoordMatrix}function $o(w,f,v,S){const C=[w,f,v,1];v?o.aa.transformMat4(C,C,S):ky(C,C,S);const E=C[3];return C[0]/=E,C[1]/=E,C[2]/=E,C}function Av(w,f){return Math.min(.5+w/f*.5,1.5)}function Cv(w,f){const v=w[0]/w[3],S=w[1]/w[3];return v>=-f[0]&&v<=f[0]&&S>=-f[1]&&S<=f[1]}function Mv(w,f,v,S,C,E,R,B,G,j){const q=v.transform,K=S?w.textSizeData:w.iconSizeData,te=o.b8(K,v.transform.zoom),ne=q.projection.name==="globe",le=[256/v.width*2+1,256/v.height*2+1],se=S?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;se.clear();let ue=null;ne&&(ue=S?w.text.globeExtVertexArray:w.icon.globeExtVertexArray);const ce=w.lineVertexArray,ye=S?w.text.placedSymbolArray:w.icon.placedSymbolArray,Ce=v.transform.width/v.transform.height;let Ae,De=!1;for(let he=0;he<ye.length;he++){const we=ye.get(he),{numGlyphs:Fe,writingMode:ze}=we;if(ze!==o.b9.vertical||De||Ae===o.b9.horizontal||(De=!0),Ae=ze,(we.hidden||ze===o.b9.vertical)&&!De){Ac(Fe,se);continue}De=!1;const je=new o.P(we.tileAnchorX,we.tileAnchorY);let{x:it,y:Ge,z:rt}=q.projection.projectTilePoint(je.x,je.y,j.canonical);if(G){const[lr,vr,Ar]=G(je);it+=lr,Ge+=vr,rt+=Ar}const st=[it,Ge,rt,1];if(o.aa.transformMat4(st,st,f),!Cv(st,le)){Ac(Fe,se);continue}const Ve=st[3],Qe=Av(v.transform.getCameraToCenterDistance(q.projection),Ve),kt=o.ba(K,te,we),Ze=R?kt/Qe:kt*Qe,nt=$o(it,Ge,rt,C);if(nt[3]<=0){Ac(Fe,se);continue}let ot={};const Me=R?null:G,Tt=Eh(we,Ze,!1,B,f,C,E,w.glyphOffsetArray,ce,se,ue,nt,je,ot,Ce,Me,q.projection,j,R);De=Tt.useVertical,Me&&Tt.needsFlipping&&(ot={}),(Tt.notEnoughRoom||De||Tt.needsFlipping&&Eh(we,Ze,!0,B,f,C,E,w.glyphOffsetArray,ce,se,ue,nt,je,ot,Ce,Me,q.projection,j,R).notEnoughRoom)&&Ac(Fe,se)}S?(w.text.dynamicLayoutVertexBuffer.updateData(se),ue&&w.text.globeExtVertexBuffer&&w.text.globeExtVertexBuffer.updateData(ue)):(w.icon.dynamicLayoutVertexBuffer.updateData(se),ue&&w.icon.globeExtVertexBuffer&&w.icon.globeExtVertexBuffer.updateData(ue))}function Od(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se){const{lineStartIndex:ue,glyphStartIndex:ce,segment:ye}=B,Ce=ce+B.numGlyphs,Ae=ue+B.lineLength,De=f.getoffsetX(ce),he=f.getoffsetX(Ce-1),we=Tc(w*De,v,S,C,E,R,ye,ue,Ae,G,j,q,K,te,!0,ne,le,se);if(!we)return null;const Fe=Tc(w*he,v,S,C,E,R,ye,ue,Ae,G,j,q,K,te,!0,ne,le,se);return Fe?{first:we,last:Fe}:null}function Mu(w,f,v,S){return w===o.b9.horizontal&&Math.abs(S)>Math.abs(v)?{useVertical:!0}:w===o.b9.vertical?S>0?{needsFlipping:!0}:null:f!==Gi.unknown&&function(C,E){return C===0||Math.abs(E/C)>Cu}(v,S)?f===Gi.flipRequired?{needsFlipping:!0}:null:v<0?{needsFlipping:!0}:null}function Eh(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue,ce,ye){const Ce=f/24,Ae=w.lineOffsetX*Ce,De=w.lineOffsetY*Ce,{lineStartIndex:he,glyphStartIndex:we,numGlyphs:Fe,segment:ze,writingMode:je,flipState:it}=w,Ge=he+w.lineLength,rt=st=>{if(q){const[Ze,nt,ot]=st.up,Me=j.length;o.bb(q,Me+0,Ze,nt,ot),o.bb(q,Me+1,Ze,nt,ot),o.bb(q,Me+2,Ze,nt,ot),o.bb(q,Me+3,Ze,nt,ot)}const[Ve,Qe,kt]=st.point;o.bc(j,Ve,Qe,kt,st.angle)};if(Fe>1){const st=Od(Ce,B,Ae,De,v,K,te,w,G,E,ne,se,!1,ue,ce,ye);if(!st)return{notEnoughRoom:!0};if(S&&!v){let[Ve,Qe,kt]=st.first.point,[Ze,nt,ot]=st.last.point;[Ve,Qe]=$o(Ve,Qe,kt,R),[Ze,nt]=$o(Ze,nt,ot,R);const Me=Mu(je,it,(Ze-Ve)*le,nt-Qe);if(w.flipState=Me&&Me.needsFlipping?Gi.flipRequired:Gi.flipNotRequired,Me)return Me}rt(st.first);for(let Ve=we+1;Ve<we+Fe-1;Ve++){const Qe=Tc(Ce*B.getoffsetX(Ve),Ae,De,v,K,te,ze,he,Ge,G,E,ne,se,!1,!1,ue,ce,ye);if(!Qe)return j.length-=4*(Ve-we),{notEnoughRoom:!0};rt(Qe)}rt(st.last)}else{if(S&&!v){const Ve=$o(te.x,te.y,0,C),Qe=he+ze+1,kt=new o.P(G.getx(Qe),G.gety(Qe)),Ze=$o(kt.x,kt.y,0,C),nt=Ze[3]>0?Ze:Ry(te,kt,Ve,1,C,void 0,ue,ce.canonical),ot=Mu(je,it,(nt[0]-Ve[0])*le,nt[1]-Ve[1]);if(w.flipState=ot&&ot.needsFlipping?Gi.flipRequired:Gi.flipNotRequired,ot)return ot}const st=Tc(Ce*B.getoffsetX(we),Ae,De,v,K,te,ze,he,Ge,G,E,ne,se,!1,!1,ue,ce,ye);if(!st)return{notEnoughRoom:!0};rt(st)}return{}}function Iv(w,f,v,S,C){const{x:E,y:R,z:B}=S.projectTilePoint(w.x,w.y,f);if(!C)return $o(E,R,B,v);const[G,j,q]=C(w);return $o(E+G,R+j,B+q,v)}function Ry(w,f,v,S,C,E,R,B){const G=Iv(w.sub(f)._unit()._add(w),B,C,R,E);return o.Q.sub(G,v,G),o.Q.normalize(G,G),o.Q.scaleAndAdd(G,v,G,S)}function Tc(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue,ce){const ye=S?w-f:w+f;let Ce=ye>0?1:-1,Ae=0;S&&(Ce*=-1,Ae=Math.PI),Ce<0&&(Ae+=Math.PI);let De=B+R+(Ce>0?0:1)|0,he=C,we=C,Fe=0,ze=0;const je=Math.abs(ye),it=[],Ge=[];let rt=E,st=rt;const Ve=()=>Ry(st,rt,we,je-Fe+1,q,te,se,ue.canonical);for(;Fe+ze<=je;){if(De+=Ce,De<B||De>=G)return null;if(we=he,st=rt,it.push(we),ne&&Ge.push(st),rt=new o.P(j.getx(De),j.gety(De)),he=K[De],!he){const vr=Iv(rt,ue.canonical,q,se,te);he=vr[3]>0?K[De]=vr:Ve()}Fe+=ze,ze=o.Q.distance(we,he)}le&&te&&(K[De]&&(he=Ve(),ze=o.Q.distance(we,he)),K[De]=he);const Qe=(je-Fe)/ze,kt=rt.sub(st)._mult(Qe)._add(st),Ze=o.Q.sub([],he,we),nt=o.Q.scaleAndAdd([],we,Ze,Qe);let ot=[0,0,1],Me=Ze[0],Tt=Ze[1];if(ce&&(ot=se.upVector(ue.canonical,kt.x,kt.y),ot[0]!==0||ot[1]!==0||ot[2]!==1)){const vr=[ot[2],0,-ot[0]],Ar=o.Q.cross([],ot,vr);o.Q.normalize(vr,vr),o.Q.normalize(Ar,Ar),Me=o.Q.dot(Ze,vr),Tt=o.Q.dot(Ze,Ar)}if(v){const vr=o.Q.cross([],ot,Ze);o.Q.normalize(vr,vr),o.Q.scaleAndAdd(nt,nt,vr,v*Ce)}const lr=Ae+Math.atan2(Tt,Me);return it.push(nt),ne&&Ge.push(kt),{point:nt,angle:lr,path:it,tilePath:Ge,up:ot}}function Ac(w,f){const v=f.length,S=v+4*w;f.resize(S),f.float32.fill(-1/0,4*v,4*S)}function ky(w,f,v){const S=f[0],C=f[1];return w[0]=v[0]*S+v[4]*C+v[12],w[1]=v[1]*S+v[5]*C+v[13],w[3]=v[3]*S+v[7]*C+v[15],w}const ks=100;class fw{constructor(f,v,S=new Ly(f.width+200,f.height+200,25),C=new Ly(f.width+200,f.height+200,25)){this.transform=f,this.grid=S,this.ignoredGrid=C,this.pitchfactor=Math.cos(f._pitch)*f.cameraToCenterDistance,this.screenRightBoundary=f.width+ks,this.screenBottomBoundary=f.height+ks,this.gridRightBoundary=f.width+200,this.gridBottomBoundary=f.height+200,this.fogState=v}placeCollisionBox(f,v,S,C,E,R,B,G){let j=S.projectedAnchorX,q=S.projectedAnchorY,K=S.projectedAnchorZ;const te=S.elevation,ne=S.tileID,le=f.getProjection();if(te&&ne){const[he,we,Fe]=le.upVector(ne.canonical,S.tileAnchorX,S.tileAnchorY),ze=le.upVectorScale(ne.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;j+=he*te*ze,q+=we*te*ze,K+=Fe*te*ze}const se=this.projectAndGetPerspectiveRatio(B,j,q,K,S.tileID,le.name==="globe"||!!te||this.transform.pitch>0,le),ue=R*se.perspectiveRatio,ce=(S.x1*v+C.x-S.padding)*ue+se.point.x,ye=(S.y1*v+C.y-S.padding)*ue+se.point.y,Ce=(S.x2*v+C.x+S.padding)*ue+se.point.x,Ae=(S.y2*v+C.y+S.padding)*ue+se.point.y,De=se.perspectiveRatio<=.55||se.occluded;return!this.isInsideGrid(ce,ye,Ce,Ae)||!E&&this.grid.hitTest(ce,ye,Ce,Ae,G)||De?{box:[],offscreen:!1,occluded:se.occluded}:{box:[ce,ye,Ce,Ae],offscreen:this.isOffscreen(ce,ye,Ce,Ae),occluded:!1}}placeCollisionCircles(f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se){const ue=[],ce=this.transform.elevation,ye=f.getProjection(),Ce=ce?ce.getAtTileOffsetFunc(se,this.transform.center.lat,this.transform.worldSize,ye):null,Ae=new o.P(S.tileAnchorX,S.tileAnchorY);let{x:De,y:he,z:we}=ye.projectTilePoint(Ae.x,Ae.y,se.canonical);if(Ce){const[kt,Ze,nt]=Ce(Ae);De+=kt,he+=Ze,we+=nt}const Fe=ye.name==="globe",ze=this.projectAndGetPerspectiveRatio(B,De,he,we,se,Fe||!!ce||this.transform.pitch>0,ye),{perspectiveRatio:je}=ze,it=(K?R/je:R*je)/o.bf,Ge=$o(De,he,we,G),rt=ze.signedDistanceFromCamera>0?Od(it,E,S.lineOffsetX*it,S.lineOffsetY*it,!1,Ge,Ae,S,C,G,{},ce&&!K?Ce:null,K&&!!ce,ye,se,K):null;let st=!1,Ve=!1,Qe=!0;if(rt&&!ze.occluded){const kt=.5*ne*je+le,Ze=new o.P(-100,-100),nt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),ot=new $l,{first:Me,last:Tt}=rt,lr=Me.path.length;let vr=[];for(let Dr=lr-1;Dr>=1;Dr--)vr.push(Me.path[Dr]);for(let Dr=1;Dr<Tt.path.length;Dr++)vr.push(Tt.path[Dr]);const Ar=2.5*kt;j&&(vr=vr.map(([Dr,Sn,Zr],Pn)=>(Ce&&!Fe&&(Zr=Ce(Pn<lr-1?Me.tilePath[lr-1-Pn]:Tt.tilePath[Pn-lr+2])[2]),$o(Dr,Sn,Zr,j))),vr.some(Dr=>Dr[3]<=0)&&(vr=[]));let xr=[];if(vr.length>0){let Dr=1/0,Sn=-1/0,Zr=1/0,Pn=-1/0;for(const Tn of vr)Dr=Math.min(Dr,Tn[0]),Zr=Math.min(Zr,Tn[1]),Sn=Math.max(Sn,Tn[0]),Pn=Math.max(Pn,Tn[1]);Sn>=Ze.x&&Dr<=nt.x&&Pn>=Ze.y&&Zr<=nt.y&&(xr=[vr.map(Tn=>new o.P(Tn[0],Tn[1]))],(Dr<Ze.x||Sn>nt.x||Zr<Ze.y||Pn>nt.y)&&(xr=o.bd(xr,Ze.x,Ze.y,nt.x,nt.y)))}for(const Dr of xr){ot.reset(Dr,.25*kt);let Sn=0;Sn=ot.length<=.5*kt?1:Math.ceil(ot.paddedLength/Ar)+1;for(let Zr=0;Zr<Sn;Zr++){const Pn=Zr/Math.max(Sn-1,1),Tn=ot.lerp(Pn),Di=Tn.x+ks,ei=Tn.y+ks;ue.push(Di,ei,kt,0);const ua=Di-kt,Ji=ei-kt,di=Di+kt,oi=ei+kt;if(Qe=Qe&&this.isOffscreen(ua,Ji,di,oi),Ve=Ve||this.isInsideGrid(ua,Ji,di,oi),!v&&this.grid.hitTestCircle(Di,ei,kt,te)&&(st=!0,!q))return{circles:[],offscreen:!1,collisionDetected:st,occluded:!1}}}}return{circles:!q&&st||!Ve?[]:ue,offscreen:Qe,collisionDetected:st,occluded:ze.occluded}}queryRenderedSymbols(f){if(f.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const v=[];let S=1/0,C=1/0,E=-1/0,R=-1/0;for(const q of f){const K=new o.P(q.x+ks,q.y+ks);S=Math.min(S,K.x),C=Math.min(C,K.y),E=Math.max(E,K.x),R=Math.max(R,K.y),v.push(K)}const B=this.grid.query(S,C,E,R).concat(this.ignoredGrid.query(S,C,E,R)),G={},j={};for(const q of B){const K=q.key;if(G[K.bucketInstanceId]===void 0&&(G[K.bucketInstanceId]={}),G[K.bucketInstanceId][K.featureIndex])continue;const te=[new o.P(q.x1,q.y1),new o.P(q.x2,q.y1),new o.P(q.x2,q.y2),new o.P(q.x1,q.y2)];o.be(v,te)&&(G[K.bucketInstanceId][K.featureIndex]=!0,j[K.bucketInstanceId]===void 0&&(j[K.bucketInstanceId]=[]),j[K.bucketInstanceId].push(K.featureIndex))}return j}insertCollisionBox(f,v,S,C,E){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:C,collisionGroupID:E},f[0],f[1],f[2],f[3])}insertCollisionCircles(f,v,S,C,E){const R=v?this.ignoredGrid:this.grid,B={bucketInstanceId:S,featureIndex:C,collisionGroupID:E};for(let G=0;G<f.length;G+=4)R.insertCircle(B,f[G],f[G+1],f[G+2])}projectAndGetPerspectiveRatio(f,v,S,C,E,R,B){const G=[v,S,C,1];let j=!1;C||this.transform.pitch>0?(o.aa.transformMat4(G,G,f),this.fogState&&E&&B.name!=="globe"&&(j=function(te,ne,le,se,ue,ce){const ye=ce.calculateFogTileMatrix(ue),Ce=[ne,le,se];return o.Q.transformMat4(Ce,Ce,ye),Wn(te,o.Q.length(Ce),ce.pitch,ce._fov)}(this.fogState,v,S,C,E.toUnwrapped(),this.transform)>.9)):ky(G,G,f);const q=G[3];return{point:new o.P((G[0]/q+1)/2*this.transform.width+ks,(-G[1]/q+1)/2*this.transform.height+ks),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(B)/q*.5,1.5),signedDistanceFromCamera:q,occluded:R&&G[2]>q||j}}isOffscreen(f,v,S,C){return S<ks||f>=this.screenRightBoundary||C<ks||v>this.screenBottomBoundary}isInsideGrid(f,v,S,C){return S>=0&&f<this.gridRightBoundary&&C>=0&&v<this.gridBottomBoundary}getViewportMatrix(){const f=o.a9.identity([]);return o.a9.translate(f,f,[-100,-100,0]),f}}function Ev(w,f,v){const S=f.createTileMatrix(w,w.worldSize,v.toUnwrapped());return o.a9.multiply(new Float32Array(16),w.projMatrix,S)}function nl(w,f,v){if(f.projection.name===v.projection.name)return w.projMatrix;const S=v.clone();return S.setProjection(f.projection),Ev(S,f.getProjection(),w)}function Dv(w,f,v){return f.name===v.projection.name?w.projMatrix:Ev(v,f,w)}class Pv{constructor(f,v,S,C){this.opacity=f?Math.max(0,Math.min(1,f.opacity+(f.placed?v:-v))):C&&S?1:0,this.placed=S}isHidden(){return this.opacity===0&&!this.placed}}class Dh{constructor(f,v,S,C,E,R=!1){this.text=new Pv(f?f.text:null,v,S,E),this.icon=new Pv(f?f.icon:null,v,C,E),this.clipped=R}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Lv{constructor(f,v,S,C=!1){this.text=f,this.icon=v,this.skipFade=S,this.clipped=C}}class dw{constructor(){this.invProjMatrix=o.a9.create(),this.viewportMatrix=o.a9.create(),this.circles=[]}}class jl{constructor(f,v,S,C,E){this.bucketInstanceId=f,this.featureIndex=v,this.sourceLayerIndex=S,this.bucketIndex=C,this.tileID=E}}class Rv{constructor(f){this.crossSourceCollisions=f,this.maxGroupID=0,this.collisionGroups={}}get(f){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[f]){const v=++this.maxGroupID;this.collisionGroups[f]={ID:v,predicate:S=>S.collisionGroupID===v}}return this.collisionGroups[f]}}function Oy(w,f,v,S,C){const{horizontalAlign:E,verticalAlign:R}=o.bi(w),B=-(E-.5)*f,G=-(R-.5)*v,j=o.bh(w,S);return new o.P(B+j[0]*C,G+j[1]*C)}function Ph(w,f,v,S,C){const E=new o.P(w,f);return v&&E._rotate(S?C:-C),E}class zy{constructor(f,v,S,C,E,R){this.transform=f.clone(),this.projection=f.projection.name,this.collisionIndex=new fw(this.transform,E),this.buildingIndex=R,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new Rv(S),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(f,v,S,C){const E=S.getBucket(v),R=S.latestFeatureIndex;if(!E||!R||v.fqid!==E.layerIds[0])return;const B=E.layers[0].layout,G=S.collisionBoxArray,j=Math.pow(2,this.transform.zoom-S.tileID.overscaledZ),q=S.tileSize/o.Y,K=S.tileID.toUnwrapped();this.transform.setProjection(E.projection);const te=(ne=S.tileID,le=E.getProjection(),se=this.transform,le.name===this.projection?se.calculateProjMatrix(ne.toUnwrapped()):Ev(se,le,ne));var ne,le,se;const ue=B.get("text-pitch-alignment")==="map",ce=B.get("text-rotation-alignment")==="map";v.compileFilter();const ye=v.dynamicFilter(),Ce=v.dynamicFilterNeedsFeature(),Ae=this.transform.calculatePixelsToTileUnitsMatrix(S),De=kd(te,S.tileID.canonical,ue,ce,this.transform,E.getProjection(),Ae);let he=null;if(ue){const ze=Hl(te,S.tileID.canonical,ue,ce,this.transform,E.getProjection(),Ae);he=o.a9.multiply([],this.transform.labelPlaneMatrix,ze)}let we=null;ye&&S.latestFeatureIndex&&(we={unwrappedTileID:K,dynamicFilter:ye,dynamicFilterNeedsFeature:Ce,featureIndex:S.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new jl(E.bucketInstanceId,R,E.sourceLayerIndex,E.index,S.tileID);const Fe={bucket:E,layout:B,posMatrix:te,textLabelPlaneMatrix:De,labelToScreenMatrix:he,clippingData:we,scale:j,textPixelRatio:q,holdingForFade:S.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:o.b8(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.b8(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(C)for(const ze of E.sortKeyRanges){const{sortKey:je,symbolInstanceStart:it,symbolInstanceEnd:Ge}=ze;f.push({sortKey:je,symbolInstanceStart:it,symbolInstanceEnd:Ge,parameters:Fe})}else f.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Fe})}attemptAnchorPlacement(f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue,ce,ye){const{textOffset0:Ce,textOffset1:Ae,crossTileID:De}=te,he=[Ce,Ae],we=Oy(f,S,C,he,E),Fe=this.collisionIndex.placeCollisionBox(le,E,v,Ph(we.x,we.y,R,B,this.transform.angle),K,G,j,q.predicate);if(ue){const ze=le.getSymbolInstanceIconSize(ye,this.transform.zoom,te.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(le,ze,ue,Ph(we.x,we.y,R,B,this.transform.angle),K,G,j,q.predicate).box.length===0)return}if(Fe.box.length>0){let ze;return this.prevPlacement&&this.prevPlacement.variableOffsets[De]&&this.prevPlacement.placements[De]&&this.prevPlacement.placements[De].text&&(ze=this.prevPlacement.variableOffsets[De].anchor),this.variableOffsets[De]={textOffset:he,width:S,height:C,anchor:f,textScale:E,prevAnchor:ze},this.markUsedJustification(le,f,te,se),le.allowVerticalPlacement&&(this.markUsedOrientation(le,se,te),this.placedOrientations[De]=se),{shift:we,placedGlyphBoxes:Fe}}}placeLayerBucketPart(f,v,S,C){const{bucket:E,layout:R,posMatrix:B,textLabelPlaneMatrix:G,labelToScreenMatrix:j,clippingData:q,textPixelRatio:K,holdingForFade:te,collisionBoxArray:ne,partiallyEvaluatedTextSize:le,partiallyEvaluatedIconSize:se,collisionGroup:ue}=f.parameters,ce=R.get("text-optional"),ye=R.get("icon-optional"),Ce=R.get("text-allow-overlap"),Ae=R.get("icon-allow-overlap"),De=R.get("text-rotation-alignment")==="map",he=R.get("text-pitch-alignment")==="map",we=R.get("symbol-z-order")==="viewport-y",Fe=R.get("symbol-z-elevate");this.transform.setProjection(E.projection);let ze=Ce&&(Ae||!E.hasIconData()||ye),je=Ae&&(Ce||!E.hasTextData()||ce);!E.collisionArrays&&ne&&E.deserializeCollisionBoxes(ne),S&&C&&E.updateCollisionDebugBuffers(this.transform.zoom,ne);const it=(Ge,rt,st)=>{const{crossTileID:Ve,numVerticalGlyphVertices:Qe}=Ge;if(q){const di={zoom:this.transform.zoom,pitch:this.transform.pitch};let oi=null;if(q.dynamicFilterNeedsFeature){const nn=this.retainedQueryData[E.bucketInstanceId];oi=q.featureIndex.loadFeature({featureIndex:Ge.featureIndex,bucketIndex:nn.bucketIndex,sourceLayerIndex:nn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,q.dynamicFilter)(di,oi,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new o.P(Ge.tileAnchorX,Ge.tileAnchorY),this.transform.calculateDistanceTileData(q.unwrappedTileID)))return this.placements[Ve]=new Lv(!1,!1,!1,!0),void v.add(Ve)}if(v.has(Ve))return;if(te)return void(this.placements[Ve]=new Lv(!1,!1,!1));let kt=!1,Ze=!1,nt=!0,ot=!1,Me=!1,Tt=null,lr={box:null,offscreen:null,occluded:null},vr={box:null,offscreen:null,occluded:null},Ar=null,xr=null,Dr=null,Sn=0,Zr=0,Pn=0;st.textFeatureIndex?Sn=st.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(Sn=Ge.featureIndex),st.verticalTextFeatureIndex&&(Zr=st.verticalTextFeatureIndex);const Tn=di=>{di.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const oi=this.transform.elevation;di.elevation=Ge.zOffset+(oi?oi.getAtTileOffset(di.tileID,di.tileAnchorX,di.tileAnchorY):0)},Di=st.textBox;if(Di){Tn(Di);const di=nn=>{let sn=o.b9.horizontal;if(E.allowVerticalPlacement&&!nn&&this.prevPlacement){const Ti=this.prevPlacement.placedOrientations[Ve];Ti&&(this.placedOrientations[Ve]=Ti,sn=Ti,this.markUsedOrientation(E,sn,Ge))}return sn},oi=(nn,sn)=>{if(E.allowVerticalPlacement&&Qe>0&&st.verticalTextBox){for(const Ti of E.writingModes)if(Ti===o.b9.vertical?(lr=sn(),vr=lr):lr=nn(),lr&&lr.box&&lr.box.length)break}else lr=nn()};if(R.get("text-variable-anchor")){let nn=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ve]){const pi=this.prevPlacement.variableOffsets[Ve];nn.indexOf(pi.anchor)>0&&(nn=nn.filter(vn=>vn!==pi.anchor),nn.unshift(pi.anchor))}const sn=(pi,vn,Kr)=>{const _o=E.getSymbolInstanceTextSize(le,Ge,this.transform.zoom,rt),Wa=(pi.x2-pi.x1)*_o+2*pi.padding,ya=(pi.y2-pi.y1)*_o+2*pi.padding,Za=Ge.hasIconTextFit&&!Ae?vn:null;Za&&Tn(Za);let yo={box:[],offscreen:!1,occluded:!1};const io=Ce?2*nn.length:nn.length;for(let xa=0;xa<io;++xa){const Pa=this.attemptAnchorPlacement(nn[xa%nn.length],pi,Wa,ya,_o,De,he,K,B,ue,xa>=nn.length,Ge,rt,E,Kr,Za,le,se);if(Pa&&(yo=Pa.placedGlyphBoxes,yo&&yo.box&&yo.box.length)){kt=!0,Tt=Pa.shift;break}}return yo};oi(()=>sn(Di,st.iconBox,o.b9.horizontal),()=>{const pi=st.verticalTextBox;return pi&&Tn(pi),E.allowVerticalPlacement&&!(lr&&lr.box&&lr.box.length)&&Qe>0&&pi?sn(pi,st.verticalIconBox,o.b9.vertical):{box:null,offscreen:null,occluded:null}}),lr&&(kt=lr.box,nt=lr.offscreen,ot=lr.occluded);const Ti=di(!(!lr||!lr.box));if(!kt&&this.prevPlacement){const pi=this.prevPlacement.variableOffsets[Ve];pi&&(this.variableOffsets[Ve]=pi,this.markUsedJustification(E,pi.anchor,Ge,Ti))}}else{const nn=(sn,Ti)=>{const pi=E.getSymbolInstanceTextSize(le,Ge,this.transform.zoom,rt),vn=this.collisionIndex.placeCollisionBox(E,pi,sn,new o.P(0,0),Ce,K,B,ue.predicate);return vn&&vn.box&&vn.box.length&&(this.markUsedOrientation(E,Ti,Ge),this.placedOrientations[Ve]=Ti),vn};oi(()=>nn(Di,o.b9.horizontal),()=>{const sn=st.verticalTextBox;return E.allowVerticalPlacement&&Qe>0&&sn?(Tn(sn),nn(sn,o.b9.vertical)):{box:null,offscreen:null,occluded:null}}),di(!!(lr&&lr.box&&lr.box.length))}}if(Ar=lr,kt=Ar&&Ar.box&&Ar.box.length>0,nt=Ar&&Ar.offscreen,ot=Ar&&Ar.occluded,Ge.useRuntimeCollisionCircles){const di=E.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex>=0?Ge.centerJustifiedTextSymbolIndex:Ge.verticalPlacedTextSymbolIndex),oi=o.ba(E.textSizeData,le,di),nn=R.get("text-padding");xr=this.collisionIndex.placeCollisionCircles(E,Ce,di,E.lineVertexArray,E.glyphOffsetArray,oi,B,G,j,S,he,ue.predicate,Ge.collisionCircleDiameter*oi/o.bf,nn,this.retainedQueryData[E.bucketInstanceId].tileID),kt=Ce||xr.circles.length>0&&!xr.collisionDetected,nt=nt&&xr.offscreen,ot=xr.occluded}if(st.iconFeatureIndex&&(Pn=st.iconFeatureIndex),st.iconBox){const di=oi=>{Tn(oi);const nn=Ge.hasIconTextFit&&Tt?Ph(Tt.x,Tt.y,De,he,this.transform.angle):new o.P(0,0),sn=E.getSymbolInstanceIconSize(se,this.transform.zoom,Ge.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,sn,oi,nn,Ae,K,B,ue.predicate)};vr&&vr.box&&vr.box.length&&st.verticalIconBox?(Dr=di(st.verticalIconBox),Ze=Dr.box.length>0):(Dr=di(st.iconBox),Ze=Dr.box.length>0),nt=nt&&Dr.offscreen,Me=Dr.occluded}const ei=ce||Ge.numHorizontalGlyphVertices===0&&Qe===0,ua=ye||Ge.numIconVertices===0;if(ei||ua?ua?ei||(Ze=Ze&&kt):kt=Ze&&kt:Ze=kt=Ze&&kt,kt&&Ar&&Ar.box&&this.collisionIndex.insertCollisionBox(Ar.box,R.get("text-ignore-placement"),E.bucketInstanceId,vr&&vr.box&&Zr?Zr:Sn,ue.ID),Ze&&Dr&&this.collisionIndex.insertCollisionBox(Dr.box,R.get("icon-ignore-placement"),E.bucketInstanceId,Pn,ue.ID),xr&&(kt&&this.collisionIndex.insertCollisionCircles(xr.circles,R.get("text-ignore-placement"),E.bucketInstanceId,Sn,ue.ID),S)){const di=E.bucketInstanceId;let oi=this.collisionCircleArrays[di];oi===void 0&&(oi=this.collisionCircleArrays[di]=new dw);for(let nn=0;nn<xr.circles.length;nn+=4)oi.circles.push(xr.circles[nn+0]),oi.circles.push(xr.circles[nn+1]),oi.circles.push(xr.circles[nn+2]),oi.circles.push(xr.collisionDetected?1:0)}const Ji=E.projection.name!=="globe";ze=ze&&(Ji||!ot),je=je&&(Ji||!Me),this.placements[Ve]=new Lv(kt||ze,Ze||je,nt||E.justReloaded),v.add(Ve)};if(Fe&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.updateZOffset()),we){const Ge=E.getSortedSymbolIndexes(this.transform.angle);for(let rt=Ge.length-1;rt>=0;--rt){const st=Ge[rt];it(E.symbolInstances.get(st),st,E.collisionArrays[st])}E.hasAnyZOffset&&o.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const Ge=E.getSortedIndexesByZOffset();for(let rt=0;rt<Ge.length;++rt){const st=Ge[rt];it(E.symbolInstances.get(st),st,E.collisionArrays[st])}}else for(let Ge=f.symbolInstanceStart;Ge<f.symbolInstanceEnd;Ge++)it(E.symbolInstances.get(Ge),Ge,E.collisionArrays[Ge]);if(S&&E.bucketInstanceId in this.collisionCircleArrays){const Ge=this.collisionCircleArrays[E.bucketInstanceId];o.a9.invert(Ge.invProjMatrix,B),Ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(f,v,S,C){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:G,crossTileID:j}=S,q=o.bg(v),K=C===o.b9.vertical?G:q==="left"?E:q==="center"?R:q==="right"?B:-1;E>=0&&(f.text.placedSymbolArray.get(E).crossTileID=K>=0&&E!==K?0:j),R>=0&&(f.text.placedSymbolArray.get(R).crossTileID=K>=0&&R!==K?0:j),B>=0&&(f.text.placedSymbolArray.get(B).crossTileID=K>=0&&B!==K?0:j),G>=0&&(f.text.placedSymbolArray.get(G).crossTileID=K>=0&&G!==K?0:j)}markUsedOrientation(f,v,S){const C=v===o.b9.horizontal||v===o.b9.horizontalOnly?v:0,E=v===o.b9.vertical?v:0,{leftJustifiedTextSymbolIndex:R,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:j}=S,q=f.text.placedSymbolArray;R>=0&&(q.get(R).placedOrientation=C),B>=0&&(q.get(B).placedOrientation=C),G>=0&&(q.get(G).placedOrientation=C),j>=0&&(q.get(j).placedOrientation=E)}commit(f){this.commitTime=f,this.zoomAtLastRecencyCheck=this.transform.zoom;const v=this.prevPlacement;let S=!1;this.prevZoomAdjustment=v?v.zoomAdjustment(this.transform.zoom):0;const C=v?v.symbolFadeChange(f):1,E=v?v.opacities:{},R=v?v.variableOffsets:{},B=v?v.placedOrientations:{};for(const G in this.placements){const j=this.placements[G],q=E[G];q?(this.opacities[G]=new Dh(q,C,j.text,j.icon,null,j.clipped),S=S||j.text!==q.text.placed||j.icon!==q.icon.placed):(this.opacities[G]=new Dh(null,C,j.text,j.icon,j.skipFade,j.clipped),S=S||j.text||j.icon)}for(const G in E){const j=E[G];if(!this.opacities[G]){const q=new Dh(j,C,!1,!1);q.isHidden()||(this.opacities[G]=q,S=S||j.text.placed||j.icon.placed)}}for(const G in R)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=R[G]);for(const G in B)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=B[G]);S?this.lastPlacementChangeTime=f:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=v?v.lastPlacementChangeTime:f)}updateLayerOpacities(f,v){const S=new Set;for(const C of v){const E=C.getBucket(f);E&&C.latestFeatureIndex&&f.fqid===E.layerIds[0]&&(this.updateBucketOpacities(E,S,C.collisionBoxArray),E.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,C.tileID),E.updateZOffset()))}}updateBucketOpacities(f,v,S){f.hasTextData()&&f.text.opacityVertexArray.clear(),f.hasIconData()&&f.icon.opacityVertexArray.clear(),f.hasIconCollisionBoxData()&&f.iconCollisionBox.collisionVertexArray.clear(),f.hasTextCollisionBoxData()&&f.textCollisionBox.collisionVertexArray.clear();const C=f.layers[0].layout,E=!!f.layers[0].dynamicFilter(),R=new Dh(null,0,!1,!1,!0),B=C.get("text-allow-overlap"),G=C.get("icon-allow-overlap"),j=C.get("text-variable-anchor"),q=C.get("text-rotation-alignment")==="map",K=C.get("text-pitch-alignment")==="map",te=new Dh(null,0,B&&(G||!f.hasIconData()||C.get("icon-optional")),G&&(B||!f.hasTextData()||C.get("text-optional")),!0);!f.collisionArrays&&S&&(f.hasIconCollisionBoxData()||f.hasTextCollisionBoxData())&&f.deserializeCollisionBoxes(S);const ne=(se,ue,ce)=>{for(let ye=0;ye<ue/4;ye++)se.opacityVertexArray.emplaceBack(ce)};let le=0;for(let se=0;se<f.symbolInstances.length;se++){const ue=f.symbolInstances.get(se),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:ye,crossTileID:Ce,numIconVertices:Ae}=ue,De=v.has(Ce);let he=this.opacities[Ce];De?he=R:he||(he=te,this.opacities[Ce]=he),v.add(Ce);const we=ce>0||ye>0,Fe=Ae>0,ze=this.placedOrientations[Ce],je=ze===o.b9.vertical,it=ze===o.b9.horizontal||ze===o.b9.horizontalOnly;if(!we&&!Fe||he.isHidden()||le++,we){const Ge=Ov(he.text);ne(f.text,ce,je?Rh:Ge),ne(f.text,ye,it?Rh:Ge);const rt=he.text.isHidden(),{leftJustifiedTextSymbolIndex:st,centerJustifiedTextSymbolIndex:Ve,rightJustifiedTextSymbolIndex:Qe,verticalPlacedTextSymbolIndex:kt}=ue,Ze=f.text.placedSymbolArray,nt=rt||je?1:0;st>=0&&(Ze.get(st).hidden=nt),Ve>=0&&(Ze.get(Ve).hidden=nt),Qe>=0&&(Ze.get(Qe).hidden=nt),kt>=0&&(Ze.get(kt).hidden=rt||it?1:0);const ot=this.variableOffsets[Ce];ot&&this.markUsedJustification(f,ot.anchor,ue,ze);const Me=this.placedOrientations[Ce];Me&&(this.markUsedJustification(f,"left",ue,Me),this.markUsedOrientation(f,Me,ue))}if(Fe){const Ge=Ov(he.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:st}=ue,Ve=f.icon.placedSymbolArray,Qe=he.icon.isHidden()?1:0;rt>=0&&(ne(f.icon,Ae,je?Rh:Ge),Ve.get(rt).hidden=Qe),st>=0&&(ne(f.icon,ue.numVerticalIconVertices,it?Rh:Ge),Ve.get(st).hidden=Qe)}if(f.hasIconCollisionBoxData()||f.hasTextCollisionBoxData()){const Ge=f.collisionArrays[se];if(Ge){let rt=new o.P(0,0),st=!0;if(Ge.textBox||Ge.verticalTextBox){if(j){const Qe=this.variableOffsets[Ce];Qe?(rt=Oy(Qe.anchor,Qe.width,Qe.height,Qe.textOffset,Qe.textScale),q&&rt._rotate(K?this.transform.angle:-this.transform.angle)):st=!1}E&&(st=!he.clipped),Ge.textBox&&Cc(f.textCollisionBox.collisionVertexArray,he.text.placed,!st||je,rt.x,rt.y),Ge.verticalTextBox&&Cc(f.textCollisionBox.collisionVertexArray,he.text.placed,!st||it,rt.x,rt.y)}const Ve=st&&!!(!it&&Ge.verticalIconBox);Ge.iconBox&&Cc(f.iconCollisionBox.collisionVertexArray,he.icon.placed,Ve,ue.hasIconTextFit?rt.x:0,ue.hasIconTextFit?rt.y:0),Ge.verticalIconBox&&Cc(f.iconCollisionBox.collisionVertexArray,he.icon.placed,!Ve,ue.hasIconTextFit?rt.x:0,ue.hasIconTextFit?rt.y:0)}}}if(f.fullyClipped=le===0,f.sortFeatures(this.transform.angle),this.retainedQueryData[f.bucketInstanceId]&&(this.retainedQueryData[f.bucketInstanceId].featureSortOrder=f.featureSortOrder),f.hasTextData()&&f.text.opacityVertexBuffer&&f.text.opacityVertexBuffer.updateData(f.text.opacityVertexArray),f.hasIconData()&&f.icon.opacityVertexBuffer&&f.icon.opacityVertexBuffer.updateData(f.icon.opacityVertexArray),f.hasIconCollisionBoxData()&&f.iconCollisionBox.collisionVertexBuffer&&f.iconCollisionBox.collisionVertexBuffer.updateData(f.iconCollisionBox.collisionVertexArray),f.hasTextCollisionBoxData()&&f.textCollisionBox.collisionVertexBuffer&&f.textCollisionBox.collisionVertexBuffer.updateData(f.textCollisionBox.collisionVertexArray),f.bucketInstanceId in this.collisionCircleArrays){const se=this.collisionCircleArrays[f.bucketInstanceId];f.placementInvProjMatrix=se.invProjMatrix,f.placementViewportMatrix=se.viewportMatrix,f.collisionCircleArray=se.circles,delete this.collisionCircleArrays[f.bucketInstanceId]}}symbolFadeChange(f){return this.fadeDuration===0?1:(f-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(f){return Math.max(0,(this.transform.zoom-f)/1.5)}hasTransitions(f){return this.stale||f-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(f,v){const S=this.zoomAtLastRecencyCheck===v?1-this.zoomAdjustment(v):1;return this.zoomAtLastRecencyCheck=v,this.commitTime+this.fadeDuration*S>f}setStale(){this.stale=!0}}function Cc(w,f,v,S,C){w.emplaceBack(f?1:0,v?1:0,S||0,C||0),w.emplaceBack(f?1:0,v?1:0,S||0,C||0),w.emplaceBack(f?1:0,v?1:0,S||0,C||0),w.emplaceBack(f?1:0,v?1:0,S||0,C||0)}const zd=Math.pow(2,25),Lh=Math.pow(2,24),By=Math.pow(2,17),pw=Math.pow(2,16),gw=Math.pow(2,9),vw=Math.pow(2,8),kv=Math.pow(2,1);function Ov(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const f=w.placed?1:0,v=Math.floor(127*w.opacity);return v*zd+f*Lh+v*By+f*pw+v*gw+f*vw+v*kv+f}const Rh=0;class Bd{constructor(f){this._sortAcrossTiles=f.layout.get("symbol-z-order")!=="viewport-y"&&f.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(f,v,S,C,E){const R=this._bucketParts;for(;this._currentTileIndex<f.length;)if(v.getBucketParts(R,C,f[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((B,G)=>B.sortKey-G.sortKey));this._currentPartIndex<R.length;){const B=R[this._currentPartIndex];if(v.placeLayerBucketPart(B,this._seenCrossTileIDs,S,B.symbolInstanceStart===0),this._currentPartIndex++,E())return!0}return!1}}class Fd{constructor(f,v,S,C,E,R,B,G,j){this.placement=new zy(f,E,R,B,G,j),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=C,this._done=!1}isDone(){return this._done}continuePlacement(f,v,S,C){const E=o.f.now(),R=()=>{const B=o.f.now()-E;return!this._forceFullPlacement&&B>2};for(;this._currentPlacementIndex>=0;){const B=v[f[this._currentPlacementIndex]],G=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=G)&&(!B.maxzoom||B.maxzoom>G)){const j=B,q=j.layout.get("symbol-z-elevate"),K=this._inProgressLayer=this._inProgressLayer||new Bd(j),te=o.aj(B.source,B.scope);if(K.continuePlacement(q?C[te]:S[te],this.placement,this._showCollisionBoxes,B,R))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(f){return this.placement.commit(f),this.placement}}const Fy=512/o.Y/2;class mw{constructor(f,v,S){this.tileID=f,this.bucketInstanceId=S,this.index=new o.bj(v.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const C=f.canonical.x*o.Y,E=f.canonical.y*o.Y;for(let R=0;R<v.length;R++){const{key:B,crossTileID:G,tileAnchorX:j,tileAnchorY:q}=v.get(R),K=Math.floor((C+j)*Fy),te=Math.floor((E+q)*Fy);this.index.add(K,te),this.keys.push(B),this.crossTileIDs.push(G)}this.index.finish()}findMatches(f,v,S){const C=this.tileID.canonical.z<v.canonical.z?1:Math.pow(2,this.tileID.canonical.z-v.canonical.z),E=Fy/Math.pow(2,v.canonical.z-this.tileID.canonical.z),R=v.canonical.x*o.Y,B=v.canonical.y*o.Y;for(let G=0;G<f.length;G++){const j=f.get(G);if(j.crossTileID)continue;const{key:q,tileAnchorX:K,tileAnchorY:te}=j,ne=Math.floor((R+K)*E),le=Math.floor((B+te)*E),se=this.index.range(ne-C,le-C,ne+C,le+C);for(const ue of se){const ce=this.crossTileIDs[ue];if(this.keys[ue]===q&&!S.has(ce)){S.add(ce),j.crossTileID=ce;break}}}}}class zv{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Nd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(f){const v=Math.round((f-this.lng)/360);if(v!==0)for(const S in this.indexes){const C=this.indexes[S],E={};for(const R in C){const B=C[R];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+v),E[B.tileID.key]=B}this.indexes[S]=E}this.lng=f}addBucket(f,v,S){if(this.indexes[f.overscaledZ]&&this.indexes[f.overscaledZ][f.key]){if(this.indexes[f.overscaledZ][f.key].bucketInstanceId===v.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(f.overscaledZ,this.indexes[f.overscaledZ][f.key])}for(let E=0;E<v.symbolInstances.length;E++)v.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[f.overscaledZ]||(this.usedCrossTileIDs[f.overscaledZ]=new Set);const C=this.usedCrossTileIDs[f.overscaledZ];for(const E in this.indexes){const R=this.indexes[E];if(Number(E)>f.overscaledZ)for(const B in R){const G=R[B];G.tileID.isChildOf(f)&&G.findMatches(v.symbolInstances,f,C)}else{const B=R[f.scaledTo(Number(E)).key];B&&B.findMatches(v.symbolInstances,f,C)}}for(let E=0;E<v.symbolInstances.length;E++){const R=v.symbolInstances.get(E);R.crossTileID||(R.crossTileID=S.generate(),C.add(R.crossTileID))}return this.indexes[f.overscaledZ]===void 0&&(this.indexes[f.overscaledZ]={}),this.indexes[f.overscaledZ][f.key]=new mw(f,v.symbolInstances,v.bucketInstanceId),!0}removeBucketCrossTileIDs(f,v){for(const S of v.crossTileIDs)this.usedCrossTileIDs[f].delete(S)}removeStaleBuckets(f){let v=!1;for(const S in this.indexes){const C=this.indexes[S];for(const E in C)f[C[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(S,C[E]),delete C[E],v=!0)}return v}}class Ny{constructor(){this.layerIndexes={},this.crossTileIDs=new zv,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(f,v,S,C){let E=this.layerIndexes[f.fqid];E===void 0&&(E=this.layerIndexes[f.fqid]=new Nd);let R=!1;const B={};C.name!=="globe"&&E.handleWrapJump(S);for(const G of v){const j=G.getBucket(f);j&&f.fqid===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(G.tileID,j,this.crossTileIDs)&&(R=!0),B[j.bucketInstanceId]=!0)}return E.removeStaleBuckets(B)&&(R=!0),R}pruneUnusedLayers(f){const v={};f.forEach(S=>{v[S]=!0});for(const S in this.layerIndexes)v[S]||delete this.layerIndexes[S]}}class Vd{constructor(f=0,v=0,S=0,C=0){if(isNaN(f)||f<0||isNaN(v)||v<0||isNaN(S)||S<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=f,this.bottom=v,this.left=S,this.right=C}interpolate(f,v,S){return v.top!=null&&f.top!=null&&(this.top=o.X(f.top,v.top,S)),v.bottom!=null&&f.bottom!=null&&(this.bottom=o.X(f.bottom,v.bottom,S)),v.left!=null&&f.left!=null&&(this.left=o.X(f.left,v.left,S)),v.right!=null&&f.right!=null&&(this.right=o.X(f.right,v.right,S)),this}getCenter(f,v){const S=o.ad((this.left+f-this.right)/2,0,f),C=o.ad((this.top+v-this.bottom)/2,0,v);return new o.P(S,C)}equals(f){return this.top===f.top&&this.bottom===f.bottom&&this.left===f.left&&this.right===f.right}clone(){return new Vd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Bv(w,f){const v=o.bn(w,3);o.a9.fromQuat(w,f),o.bp(w,3,v)}function Vy(w,f){const v=o.bl.identity([]);return o.bl.rotateZ(v,v,-f),o.bl.rotateX(v,v,-w),v}function Os(w,f){const v=[w[0],w[1],0],S=[f[0],f[1],0];if(o.Q.length(v)>=1e-15){const R=o.Q.normalize([],v);o.Q.scale(S,R,o.Q.dot(S,R)),f[0]=S[0],f[1]=S[1]}const C=o.Q.cross([],f,w);if(o.Q.len(C)<1e-15)return null;const E=Math.atan2(-C[1],C[0]);return Vy(Math.atan2(Math.sqrt(w[0]*w[0]+w[1]*w[1]),-w[2]),E)}class kh{constructor(f,v){this.position=f,this.orientation=v}get position(){return this._position}set position(f){if(f){const v=f instanceof o.O?f:new o.O(f[0],f[1],f[2]);this._renderWorldCopies&&(v.x=o.bk(v.x,0,1)),this._position=v}else this._position=null}lookAtPoint(f,v){if(this.orientation=null,!this.position)return;const S=this.position,C=this._elevation?this._elevation.getAtPointOrZero(o.O.fromLngLat(f)):0,E=o.O.fromLngLat(f,C),R=[E.x-S.x,E.y-S.y,E.z-S.z];v||(v=[0,0,1]),v[2]=Math.abs(v[2]),this.orientation=Os(R,v)}setPitchBearing(f,v){this.orientation=Vy(o.bm(f),o.bm(-v))}}class Gd{constructor(f,v){this._transform=o.a9.identity([]),this.orientation=v,this.position=f}get mercatorPosition(){const f=this.position;return new o.O(f[0],f[1],f[2])}get position(){const f=o.bn(this._transform,3);return[f[0],f[1],f[2]]}set position(f){var v;f&&o.bp(this._transform,3,[(v=f)[0],v[1],v[2],1])}get orientation(){return this._orientation}set orientation(f){this._orientation=f||o.bl.identity([]),f&&Bv(this._transform,this._orientation)}getPitchBearing(){const f=this.forward(),v=this.right();return{bearing:Math.atan2(-v[1],v[0]),pitch:Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2])}}setPitchBearing(f,v){this._orientation=Vy(f,v),Bv(this._transform,this._orientation)}forward(){const f=o.bn(this._transform,2);return[-f[0],-f[1],-f[2]]}up(){const f=o.bn(this._transform,1);return[-f[0],-f[1],-f[2]]}right(){const f=o.bn(this._transform,0);return[f[0],f[1],f[2]]}getCameraToWorld(f,v){const S=new Float64Array(16);return o.a9.invert(S,this.getWorldToCamera(f,v)),S}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(f,v,S){const C=this.position;o.Q.scale(C,C,-f);const E=new Float64Array(16);return o.a9.fromScaling(E,[S,S,S]),o.a9.translate(E,E,C),E[10]*=v,E}getWorldToCamera(f,v){const S=new Float64Array(16),C=new Float64Array(4),E=this.position;return o.bl.conjugate(C,this._orientation),o.Q.scale(E,E,-f),o.a9.fromQuat(S,C),o.a9.translate(S,S,E),S[1]*=-1,S[5]*=-1,S[9]*=-1,S[13]*=-1,S[8]*=v,S[9]*=v,S[10]*=v,S[11]*=v,S}getCameraToClipPerspective(f,v,S,C){const E=new Float64Array(16);return o.a9.perspective(E,f,v,S,C),E}getCameraToClipOrthographic(f,v,S,C,E,R){const B=new Float64Array(16);return o.a9.ortho(B,f,v,S,C,E,R),B}getDistanceToElevation(f,v=!1){const S=f===0?0:o.bo(f,v?o.ax(this.position[1]):this.position[1]),C=this.forward();return(S-this.position[2])/C[2]}clone(){return new Gd([...this.position],[...this.orientation])}}const Gy=(w,f,v)=>(1-v)*w+v*f,Oh=w=>w*w*w*w*w;class Fv{constructor(f,v,S,C,E,R,B){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=f||0,this._maxZoom=v||22,this._minPitch=S??0,this._maxPitch=C??60,this.setProjection(R),this.setMaxBounds(B),this.width=0,this.height=0,this._center=new o.bq(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Vd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Gd,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const f=new Fv(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return f._elevation=this._elevation,f._centerAltitude=this._centerAltitude,f._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,f.tileSize=this.tileSize,f.mercatorFromTransition=this.mercatorFromTransition,f.width=this.width,f.height=this.height,f.cameraElevationReference=this.cameraElevationReference,f._center=this._center,f._setZoom(this.zoom),f._seaLevelZoom=this._seaLevelZoom,f.angle=this.angle,f._fov=this._fov,f._pitch=this._pitch,f._nearZ=this._nearZ,f._farZ=this._farZ,f._averageElevation=this._averageElevation,f._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,f._unmodified=this._unmodified,f._edgeInsets=this._edgeInsets.clone(),f._camera=this._camera.clone(),f._calcMatrices(),f.freezeTileCoverage=this.freezeTileCoverage,f.frustumCorners=this.frustumCorners,f}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(f){this._elevation!==f&&(this._elevation=f,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(f,v=!1){const S=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||S)&&this._updateCameraOnTerrain(),(f||S)&&this._constrainCamera(v),this._calcMatrices()}getProjection(){return o.af(this.projection,["name","center","parallels"])}setProjection(f){this.projectionOptions=f||{name:"mercator"};const v=this.projection?this.getProjection():void 0;this.projection=o.br(this.projectionOptions);const S=!d(v,this.getProjection());return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(f){return this._orthographicProjectionAtLowPitch!==f&&(this._orthographicProjectionAtLowPitch=f,this._calcMatrices(),!0)}setMercatorFromTransition(){const f=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.br({name:"mercator"});const v=f!==this.projection.name;return v&&this._calcMatrices(),v}get minZoom(){return this._minZoom}set minZoom(f){this._minZoom!==f&&(this._minZoom=f,this.zoom=Math.max(this.zoom,f))}get maxZoom(){return this._maxZoom}set maxZoom(f){this._maxZoom!==f&&(this._maxZoom=f,this.zoom=Math.min(this.zoom,f))}get minPitch(){return this._minPitch}set minPitch(f){this._minPitch!==f&&(this._minPitch=f,this.pitch=Math.max(this.pitch,f))}get maxPitch(){return this._maxPitch}set maxPitch(f){this._maxPitch!==f&&(this._maxPitch=f,this.pitch=Math.min(this.pitch,f))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(f){f===void 0?f=!0:f===null&&(f=!1),this._renderWorldCopies=f}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const f=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(f))}get cameraWorldSize(){const f=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(f))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.bo(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bk(this.rotation,-180,180)}set bearing(f){this.rotation=f}get rotation(){return-this.angle/Math.PI*180}set rotation(f){const v=-f*Math.PI/180;this.angle!==v&&(this._unmodified=!1,this.angle=v,this._calcMatrices(),this.rotationMatrix=o.b7.create(),o.b7.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(f){const v=o.ad(f,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==v&&(this._unmodified=!1,this._pitch=v,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const f=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/f)}set fov(f){f=Math.max(.01,Math.min(60,f)),this._fov!==f&&(this._unmodified=!1,this._fov=o.bm(f),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(f){this._averageElevation=f,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(f){const v=Math.min(Math.max(f,this.minZoom),this.maxZoom);this._zoom!==v&&(this._unmodified=!1,this._setZoom(v),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(f){this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(f){this._tileCoverLift!==f&&(this._tileCoverLift=f)}_updateCameraOnTerrain(){const f=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,v=this.elevation&&f===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||f===Number.NEGATIVE_INFINITY&&(!v||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const S=this._elevation;v||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&S.exaggeration()&&this._centerAltitudeValidForExaggeration!==S.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*S.exaggeration(),this._centerAltitudeValidForExaggeration=S.exaggeration()):(this._centerAltitude=f||0,this._centerAltitudeValidForExaggeration=S.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const f=this._elevation,v=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],S=this.horizonLineFromTop();let C=0,E=0;for(let R=0;R<v.length;R++){const B=new o.P(v[R][0]*this.width,S+v[R][1]*(this.height-S)),G=f.pointCoordinate(B);if(!G)continue;const j=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);C+=G[3]*j,E+=j}return E===0?NaN:C/E}get center(){return this._center}set center(f){f.lat===this._center.lat&&f.lng===this._center.lng||(this._unmodified=!1,this._center=f,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const f=this._seaLevelZoom,v=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),S=this.pixelsPerMeter/this.worldSize*v,C=this._mercatorZfromZoom(f),E=this._mercatorZfromZoom(this._maxZoom),R=Math.max(C-S,E);this._setZoom(this._zoomFromMercatorZ(R))}get padding(){return this._edgeInsets.toJSON()}set padding(f){this._edgeInsets.equals(f)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,f,1),this._calcMatrices())}computeZoomRelativeTo(f){const v=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,f.toAltitude()));let S;S=f.z<this._camera.position[2]?[v.x,v.y,v.z]:[f.x,f.y,f.z];const C=o.Q.length(o.Q.sub([],this._camera.position,S));return o.ad(this._zoomFromMercatorZ(C),this._minZoom,this._maxZoom)}setFreeCameraOptions(f){if(!this.height||!f.position&&!f.orientation)return;this._updateCameraState();let v=!1;if(f.orientation&&!o.bl.exactEquals(f.orientation,this._camera.orientation)&&(v=this._setCameraOrientation(f.orientation)),f.position){const S=[f.position.x,f.position.y,f.position.z];o.Q.exactEquals(S,this._camera.position)||(this._setCameraPosition(S),v=!0)}v&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const f=this._camera.position,v=new kh;return v.position=new o.O(f[0],f[1],f[2]),v.orientation=this._camera.orientation,v._elevation=this.elevation,v._renderWorldCopies=this.renderWorldCopies,v}_setCameraOrientation(f){if(!o.bl.length(f))return!1;o.bl.normalize(f,f);const v=o.Q.transformQuat([],[0,0,-1],f),S=o.Q.transformQuat([],[0,-1,0],f);if(S[2]<0)return!1;const C=Os(v,S);return!!C&&(this._camera.orientation=C,!0)}_setCameraPosition(f){const v=this.zoomScale(this.minZoom)*this.tileSize,S=this.zoomScale(this.maxZoom)*this.tileSize,C=this.cameraToCenterDistance;f[2]=o.ad(f[2],C/S,C/v),this._camera.position=f}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(f){return this._edgeInsets.equals(f)}interpolatePadding(f,v,S){this._unmodified=!1,this._edgeInsets.interpolate(f,v,S),this._constrain(),this._calcMatrices()}coveringZoomLevel(f){const v=(f.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/f.tileSize));return Math.max(0,v)}getVisibleUnwrappedCoordinates(f){const v=[new o.bs(0,f)];if(this.renderWorldCopies){const S=this.pointCoordinate(new o.P(0,0)),C=this.pointCoordinate(new o.P(this.width,0)),E=this.pointCoordinate(new o.P(this.width,this.height)),R=this.pointCoordinate(new o.P(0,this.height)),B=Math.floor(Math.min(S.x,C.x,E.x,R.x)),G=Math.floor(Math.max(S.x,C.x,E.x,R.x)),j=1;for(let q=B-j;q<=G+j;q++)q!==0&&v.push(new o.bs(q,f))}return v}isLODDisabled(f){return(!f||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(f,v,S){let C=[];if(v[0]===0&&v[1]===0)return C;for(const R of f){const B=R.canonical,G=R.overscaledZ,j=R.wrap,q=1<<B.z,K=B.x+1<q,te=B.x>0,ne=B.y+1<q,le=B.y>0,se=R.wrap-(te?0:1),ue=R.wrap+(K?0:1),ce=te?B.x-1:q-1,ye=K?B.x+1:0;v[0]<0?(C.push(new o.ap(G,ue,B.z,ye,B.y)),v[1]<0&&ne&&(C.push(new o.ap(G,j,B.z,B.x,B.y+1)),C.push(new o.ap(G,ue,B.z,ye,B.y+1))),v[1]>0&&le&&(C.push(new o.ap(G,j,B.z,B.x,B.y-1)),C.push(new o.ap(G,ue,B.z,ye,B.y-1)))):v[0]>0?(C.push(new o.ap(G,se,B.z,ce,B.y)),v[1]<0&&ne&&(C.push(new o.ap(G,j,B.z,B.x,B.y+1)),C.push(new o.ap(G,se,B.z,ce,B.y+1))),v[1]>0&&le&&(C.push(new o.ap(G,j,B.z,B.x,B.y-1)),C.push(new o.ap(G,se,B.z,ce,B.y-1)))):v[1]<0&&ne?C.push(new o.ap(G,j,B.z,B.x,B.y+1)):le&&C.push(new o.ap(G,j,B.z,B.x,B.y-1))}if(C.length>1){C.sort((G,j)=>G.overscaledZ-j.overscaledZ||G.wrap-j.wrap||G.canonical.z-j.canonical.z||G.canonical.x-j.canonical.x||G.canonical.y-j.canonical.y);let R=0,B=0;for(;B<C.length;)C[B].equals(C[R])?++B:C[++R]=C[B++];C.length=R+1}const E=[];for(const R of C)C.some(B=>R.isChildOf(B))||E.push(R);return C=E.filter(R=>!f.some(B=>!!(R.overscaledZ<S&&B.isChildOf(R))||R.equals(B)||R.isChildOf(B))),C}coveringTiles(f){let v=this.coveringZoomLevel(f);const S=v,C=this.elevation&&this.elevation.exaggeration(),E=C&&!f.isTerrainDEM,R=this.projection.name==="mercator";if(f.minzoom!==void 0&&v<f.minzoom)return[];f.maxzoom!==void 0&&v>f.maxzoom&&(v=f.maxzoom);const B=this.locationCoordinate(this.center),G=this.center.lat,j=1<<v,q=[j*B.x,j*B.y,0],K=this.projection.name==="globe",te=!K,ne=o.bt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,v,te),le=K?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),se=j*o.bo(1,this.center.lat),ue=this._camera.position[2]/o.bo(1,this.center.lat),ce=[j*le.x,j*le.y,ue*(te?1:se)],ye=K||C,Ce=this.cameraToCenterDistance/f.tileSize*(f.roundZoom?1:.502),Ae=this.isLODDisabled(!0)?v:0;let De;if(this._elevation&&f.isTerrainDEM)De=1e4*this._elevation.exaggeration();else if(this._elevation){const Ze=this._elevation.getMinMaxForVisibleTiles();De=Ze?Ze.max:this._centerAltitude}else De=this._centerAltitude;const he=f.isTerrainDEM?-De:this._elevation?this._elevation.getMinElevationBelowMSL():0,we=this.projection.isReprojectedInTileSpace?o.bu(this):1,Fe=Ze=>{const ot=new o.O(Ze.x+25e-6,Ze.y,Ze.z),Me=new o.O(Ze.x,Ze.y+25e-6,Ze.z),Tt=Ze.toLngLat(),lr=ot.toLngLat(),vr=Me.toLngLat(),Ar=this.locationCoordinate(Tt),xr=this.locationCoordinate(lr),Dr=this.locationCoordinate(vr),Sn=Math.hypot(xr.x-Ar.x,xr.y-Ar.y),Zr=Math.hypot(Dr.x-Ar.x,Dr.y-Ar.y);return Math.sqrt(Sn*Zr)*we/25e-6},ze=Ze=>{const nt=De,ot=he;return{aabb:o.bx(this,j,0,0,0,Ze,ot,nt,this.projection),zoom:0,x:0,y:0,minZ:ot,maxZ:nt,wrap:Ze,fullyVisible:!1}},je=[];let it=[];const Ge=v,rt=f.reparseOverscaled?S:v,st=Ze=>Ze*Ze,Ve=st((ue-this._centerAltitude)*se),Qe=Ze=>{if(!this._elevation||!Ze.tileID||!R)return;const nt=this._elevation.getMinMaxForTile(Ze.tileID),ot=Ze.aabb;nt?(ot.min[2]=nt.min,ot.max[2]=nt.max,ot.center[2]=(ot.min[2]+ot.max[2])/2):(Ze.shouldSplit=kt(Ze),Ze.shouldSplit||(ot.min[2]=ot.max[2]=ot.center[2]=this._centerAltitude))},kt=Ze=>{if(Ze.zoom<Ae)return!0;if(Ze.zoom===Ge)return!1;if(Ze.shouldSplit!=null)return Ze.shouldSplit;const nt=Ze.aabb.distanceX(ce),ot=Ze.aabb.distanceY(ce);let Me=Ve,Tt=1;if(K){Me=st(Ze.aabb.distanceZ(ce));const Ar=Math.pow(2,Ze.zoom),xr=o.ax((Ze.y+1)/Ar),Dr=o.ax(Ze.y/Ar),Sn=Math.min(Math.max(G,xr),Dr),Zr=o.bM(Sn)/o.bM(G);if(Tt=Sn===G?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Zr/this._mercatorScaleRatio),this.zoom<=o.bJ&&Ze.zoom===Ge-1&&Zr>=.9)return!0}else if(E&&(Me=st(Ze.aabb.distanceZ(ce)*se)),this.projection.isReprojectedInTileSpace&&S<=5){const Ar=Math.pow(2,Ze.zoom),xr=Fe(new o.O((Ze.x+.5)/Ar,(Ze.y+.5)/Ar));Tt=xr>.85?1:xr}const lr=nt*nt+ot*ot+Me,vr=st((1<<Ge-Ze.zoom)*Ce*Tt*((Ar,xr)=>{if(xr*st(.707)<Ar)return 1;const Dr=Math.sqrt(xr/Ar);return Dr/(1.4144271570014144+(Math.pow(1.1,Dr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Me,Ve),lr));return lr<vr};if(this.renderWorldCopies)for(let Ze=1;Ze<=3;Ze++)je.push(ze(-Ze)),je.push(ze(Ze));for(je.push(ze(0));je.length>0;){const Ze=je.pop(),nt=Ze.x,ot=Ze.y;let Me=Ze.fullyVisible;const Tt=()=>this.projection.name==="globe"&&(Ze.y===0||Ze.y===(1<<Ze.zoom)-1);if(!Me){let lr=ye?Ze.aabb.intersects(ne):Ze.aabb.intersectsFlat(ne);if(lr===0&&Tt()){const vr=new o.bv(Ze.zoom,nt,ot);lr=o.bw(this,j,vr,!0).intersects(ne)}if(lr===0)continue;Me=lr===2}if(Ze.zoom!==Ge&&kt(Ze))for(let lr=0;lr<4;lr++){const vr=(nt<<1)+lr%2,Ar=(ot<<1)+(lr>>1),xr={aabb:R?Ze.aabb.quadrant(lr):o.bx(this,j,Ze.zoom+1,vr,Ar,Ze.wrap,Ze.minZ,Ze.maxZ,this.projection),zoom:Ze.zoom+1,x:vr,y:Ar,wrap:Ze.wrap,fullyVisible:Me,tileID:void 0,shouldSplit:void 0,minZ:Ze.minZ,maxZ:Ze.maxZ};E&&!K&&(xr.tileID=new o.ap(Ze.zoom+1===Ge?rt:Ze.zoom+1,Ze.wrap,Ze.zoom+1,vr,Ar),Qe(xr)),je.push(xr)}else{const lr=Ze.zoom===Ge?rt:Ze.zoom;if(f.minzoom&&f.minzoom>lr)continue;if(!Me){let Dr=ye?Ze.aabb.intersectsPrecise(ne):Ze.aabb.intersectsPreciseFlat(ne);if(Dr===0&&Tt()){const Sn=new o.bv(Ze.zoom,nt,ot);Dr=o.bw(this,j,Sn,!0).intersectsPrecise(ne)}if(Dr===0)continue}const vr=q[0]-(.5+nt+(Ze.wrap<<Ze.zoom))*(1<<v-Ze.zoom),Ar=q[1]-.5-ot,xr=Ze.tileID?Ze.tileID:new o.ap(lr,Ze.wrap,Ze.zoom,nt,ot);it.push({tileID:xr,distanceSq:vr*vr+Ar*Ar})}}if(this.fogCullDistSq){const Ze=this.fogCullDistSq,nt=this.horizonLineFromTop();it=it.filter(ot=>{const Me=[0,0,0,1],Tt=[o.Y,o.Y,0,1],lr=this.calculateFogTileMatrix(ot.tileID.toUnwrapped());o.aa.transformMat4(Me,Me,lr),o.aa.transformMat4(Tt,Tt,lr);const vr=o.aa.min([],Me,Tt),Ar=o.aa.max([],Me,Tt),xr=o.by(vr,Ar);if(xr===0)return!0;let Dr=!1;const Sn=this._elevation;if(Sn&&xr>Ze&&nt!==0){const Zr=this.calculateProjMatrix(ot.tileID.toUnwrapped());let Pn;f.isTerrainDEM||(Pn=Sn.getMinMaxForTile(ot.tileID)),Pn||(Pn={min:he,max:De});const Tn=o.bK(this.rotation),Di=[Tn[0]*o.Y,Tn[1]*o.Y,Pn.max];o.Q.transformMat4(Di,Di,Zr),Dr=(1-Di[1])*this.height*.5<nt}return xr<Ze||Dr})}return it.sort((Ze,nt)=>Ze.distanceSq-nt.distanceSq).map(Ze=>Ze.tileID)}resize(f,v){this.width=f,this.height=v,this.pixelsToGLUnits=[2/f,-2/v],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(f){return Math.pow(2,f)}scaleZoom(f){return Math.log(f)/Math.LN2}project(f){const v=o.ad(f.lat,-o.bz,o.bz),S=this.projection.project(f.lng,v);return new o.P(S.x*this.worldSize,S.y*this.worldSize)}unproject(f){return this.projection.unproject(f.x/this.worldSize,f.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.bo(1,this.center.lat)/this.worldSize}setLocationAtPoint(f,v){let S,C;const E=this.centerPoint;if(this.projection.name==="globe"){const B=this.worldSize;S=(v.x-E.x)/B,C=(v.y-E.y)/B}else{const B=this.pointCoordinate(v),G=this.pointCoordinate(E);S=B.x-G.x,C=B.y-G.y}const R=this.locationCoordinate(f);this.setLocation(new o.O(R.x-S,R.y-C))}setLocation(f){this.center=this.coordinateLocation(f),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(f){return this.projection.locationPoint(this,f)}locationPoint3D(f){return this.projection.locationPoint(this,f,!0)}pointLocation(f){return this.coordinateLocation(this.pointCoordinate(f))}pointLocation3D(f){return this.coordinateLocation(this.pointCoordinate3D(f))}locationCoordinate(f,v){const S=v?o.bo(v,f.lat):void 0,C=this.projection.project(f.lng,f.lat);return new o.O(C.x,C.y,S)}coordinateLocation(f){return this.projection.unproject(f.x,f.y)}pointRayIntersection(f,v){const S=v??this._centerAltitude,C=[f.x,f.y,0,1],E=[f.x,f.y,1,1];o.aa.transformMat4(C,C,this.pixelMatrixInverse),o.aa.transformMat4(E,E,this.pixelMatrixInverse);const R=E[3];o.aa.scale(C,C,1/C[3]),o.aa.scale(E,E,1/R);const B=C[2],G=E[2];return{p0:C,p1:E,t:B===G?0:(S-B)/(G-B)}}screenPointToMercatorRay(f){const v=[f.x,f.y,0,1],S=[f.x,f.y,1,1];return o.aa.transformMat4(v,v,this.pixelMatrixInverse),o.aa.transformMat4(S,S,this.pixelMatrixInverse),o.aa.scale(v,v,1/v[3]),o.aa.scale(S,S,1/S[3]),v[2]=o.bo(v[2],this._center.lat)*this.worldSize,S[2]=o.bo(S[2],this._center.lat)*this.worldSize,o.aa.scale(v,v,1/this.worldSize),o.aa.scale(S,S,1/this.worldSize),new o.a5([v[0],v[1],v[2]],o.Q.normalize([],o.Q.sub([],S,v)))}rayIntersectionCoordinate(f){const{p0:v,p1:S,t:C}=f,E=o.bo(v[2],this._center.lat),R=o.bo(S[2],this._center.lat);return new o.O(o.X(v[0],S[0],C)/this.worldSize,o.X(v[1],S[1],C)/this.worldSize,o.X(E,R,C))}pointCoordinate(f,v=this._centerAltitude){return this.projection.pointCoordinate(this,f.x,f.y,v)}pointCoordinate3D(f){if(!this.elevation)return this.pointCoordinate(f);let v=this.projection.pointCoordinate3D(this,f.x,f.y);if(v)return new o.O(v[0],v[1],v[2]);let S=0,C=this.horizonLineFromTop();if(f.y>C)return this.pointCoordinate(f);const E=.02*C,R=f.clone();for(let B=0;B<10&&C-S>E;B++){R.y=o.X(S,C,.66);const G=this.projection.pointCoordinate3D(this,R.x,R.y);G?(C=R.y,v=G):S=R.y}return v?new o.O(v[0],v[1],v[2]):this.pointCoordinate(f)}isPointAboveHorizon(f){return this.projection.isPointAboveHorizon(this,f)}isPointOnSurface(f){if(f.y<0||f.y>this.height||f.x<0||f.x>this.width)return!1;if(this.elevation||this.zoom>=o.bA)return!this.isPointAboveHorizon(f);const v=this.pointCoordinate(f);return v.y>=0&&v.y<=1}_coordinatePoint(f,v){const S=v&&this.elevation?this.elevation.getAtPointOrZero(f,this._centerAltitude):this._centerAltitude,C=[f.x*this.worldSize,f.y*this.worldSize,S+f.toAltitude(),1];return o.aa.transformMat4(C,C,this.pixelMatrix),C[3]>0?new o.P(C[0]/C[3],C[1]/C[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:f,left:v}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,E=this.pointLocation3D(new o.P(v,f)),R=this.pointLocation3D(new o.P(C,f)),B=this.pointLocation3D(new o.P(C,S)),G=this.pointLocation3D(new o.P(v,S));let j=Math.min(E.lng,R.lng,B.lng,G.lng),q=Math.max(E.lng,R.lng,B.lng,G.lng),K=Math.min(E.lat,R.lat,B.lat,G.lat),te=Math.max(E.lat,R.lat,B.lat,G.lat);const ne=Math.pow(2,-this.zoom)/16*270,le=this.projection.name==="globe"?1:4,se=(ue,ce,ye,Ce,Ae)=>{const De=(ue+ye)/2,he=(ce+Ce)/2,we=new o.P(De,he),{lng:Fe,lat:ze}=this.pointLocation3D(we),je=Math.max(0,j-Fe,K-ze,Fe-q,ze-te);j=Math.min(j,Fe),q=Math.max(q,Fe),K=Math.min(K,ze),te=Math.max(te,ze),(Ae<le||je>ne)&&(se(ue,ce,De,he,Ae+1),se(De,he,ye,Ce,Ae+1))};if(se(v,f,C,f,1),se(C,f,C,S,1),se(C,S,v,S,1),se(v,S,v,f,1),this.projection.name==="globe"){const[ue,ce]=o.bB(this);ue?(te=90,q=180,j=-180):ce&&(K=-90,q=180,j=-180)}return new o.ag(new o.bq(j,K),new o.bq(q,te))}_getBoundsRectangular(f,v){const{top:S,left:C}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,R=this.width-this._edgeInsets.right,B=new o.P(C,S),G=new o.P(R,S),j=new o.P(R,E),q=new o.P(C,E);let K=this.pointCoordinate(B,f),te=this.pointCoordinate(G,f);const ne=this.pointCoordinate(j,v),le=this.pointCoordinate(q,v),se=(ue,ce)=>(ce.y-ue.y)/(ce.x-ue.x);return K.y>1&&te.y>=0?K=new o.O((1-le.y)/se(le,K)+le.x,1):K.y<0&&te.y<=1&&(K=new o.O(-le.y/se(le,K)+le.x,0)),te.y>1&&K.y>=0?te=new o.O((1-ne.y)/se(ne,te)+ne.x,1):te.y<0&&K.y<=1&&(te=new o.O(-ne.y/se(ne,te)+ne.x,0)),new o.ag().extend(this.coordinateLocation(K)).extend(this.coordinateLocation(te)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(ne))}_getBoundsRectangularTerrain(){const f=this.elevation;if(!f.visibleDemTiles.length||f.isUsingMockSource())return this._getBoundsRectangular(0,0);const v=f.visibleDemTiles.reduce((S,C)=>{if(C.dem){const E=C.dem.tree;S.min=Math.min(S.min,E.minimums[0]),S.max=Math.max(S.max,E.maximums[0])}return S},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(v.min*f.exaggeration(),v.max*f.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(f=!0){const v=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,S=this.height/2-v*(1-this._horizonShift);return f?Math.max(0,S):S}getMaxBounds(){return this.maxBounds}setMaxBounds(f){this.maxBounds=f,this.minLat=-o.bz,this.maxLat=o.bz,this.minLng=-180,this.maxLng=180,f&&(this.minLat=f.getSouth(),this.maxLat=f.getNorth(),this.minLng=f.getWest(),this.maxLng=f.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.a8(this.minLng)*this.tileSize,this.worldMaxX=o.a8(this.maxLng)*this.tileSize,this.worldMinY=o.ah(this.maxLat)*this.tileSize,this.worldMaxY=o.ah(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(f,v){return this.projection.createTileMatrix(this,v,f)}calculateDistanceTileData(f){const v=f.key,S=this._distanceTileDataCache;if(S[v])return S[v];const C=f.canonical,E=1/this.height,R=this.cameraWorldSize,B=R/this.zoomScale(C.z),G=(C.x+Math.pow(2,C.z)*f.wrap)*B,j=C.y*B,q=this.point;q.x*=R/this.worldSize,q.y*=R/this.worldSize;const K=this.angle,te=Math.sin(-K),ne=-Math.cos(-K);return S[v]={bearing:[te,ne],center:[(q.x-G)*E,(q.y-j)*E],scale:B/o.Y*E},S[v]}calculateFogTileMatrix(f){const v=f.key,S=this._fogTileMatrixCache;if(S[v])return S[v];const C=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,f);return o.a9.multiply(C,this.worldToFogMatrix,C),S[v]=new Float32Array(C),S[v]}calculateProjMatrix(f,v=!1,S=!1){const C=f.key;let E;if(E=S?this._expandedProjMatrixCache:v?this._alignedProjMatrixCache:this._projMatrixCache,E[C])return E[C];const R=this.calculatePosMatrix(f,this.worldSize);let B;return B=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:S?this.expandedFarZProjMatrix:v?this.alignedProjMatrix:this.projMatrix,o.a9.multiply(R,B,R),E[C]=new Float32Array(R),E[C]}calculatePixelsToTileUnitsMatrix(f){const v=f.tileID.key,S=this._pixelsToTileUnitsCache;if(S[v])return S[v];const C=o.bC(f,this);return S[v]=C,S[v]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const f=1/this.worldSize,v=o.a9.fromScaling([],[f,f,f]);return o.a9.multiply(v,v,this.globeMatrix),v}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const f=this._elevation;this._updateCameraState();const v=o.bo(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(v),C=this._camera.forward(),E=o.bo(1,this._center.lat);S[2]/=E,C[2]/=E,o.Q.normalize(C,C);const R=f.raycast(S,C,f.exaggeration());if(R){const B=o.Q.scaleAndAdd([],S,C,R),G=new o.O(B[0],B[1],o.bo(B[2],o.ax(B[1]))),j=(G.z+o.Q.length([G.x-S[0],G.y-S[1],G.z-S[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(j),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(f=!1){if(!this._elevation)return;const v=this._elevation,S=o.bo(1,this._center.lat)*this.worldSize,C=this._computeCameraPosition(S),E=v.getAtPointOrZero(new o.O(...C)),R=this.pixelsPerMeter/this.worldSize*E,B=this._minimumHeightOverTerrain(),G=C[2]-R;if(G<=B)if(G<0||f){const j=this.locationCoordinate(this._center,this._centerAltitude),q=[C[0],C[1],j.z-C[2]],K=o.Q.length(q);q[2]-=(B-G)/this._pixelsPerMercatorPixel;const te=o.Q.length(q);if(te===0)return;o.Q.scale(q,q,K/te*this._pixelsPerMercatorPixel),this._camera.position=[C[0],C[1],j.z*this._pixelsPerMercatorPixel-q[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const f=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||f){const te=this.center;return te.lat=o.ad(te.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!f)&&(te.lng=o.ad(te.lng,this.minLng,this.maxLng)),this.center=te,void(this._constraining=!1)}const v=this._unmodified,{x:S,y:C}=this.point;let E=0,R=S,B=C;const G=this.width/2,j=this.height/2,q=this.worldMinY*this.scale,K=this.worldMaxY*this.scale;if(C-j<q&&(B=q+j),C+j>K&&(B=K-j),K-q<this.height&&(E=Math.max(E,this.height/(K-q)),B=(K+q)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const te=this.worldMinX*this.scale,ne=this.worldMaxX*this.scale,le=this.worldSize/2-(te+ne)/2;R=(S+le+this.worldSize)%this.worldSize-le,R-G<te&&(R=te+G),R+G>ne&&(R=ne-G),ne-te<this.width&&(E=Math.max(E,this.width/(ne-te)),R=(ne+te)/2)}R===S&&B===C||(this.center=this.unproject(new o.P(R,B))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=v,this._constraining=!1}_minZoomForBounds(){let f=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(f=Math.max(f,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),f}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const f=this.centerOffset,v=this.projection.name==="globe",S=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.bo(1,this.center.lat)/o.bo(1,o.bL));const C=o.bD(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,C),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this.projection.zAxisUnit==="meters"?S:1,R=this._camera.getWorldToCamera(this.worldSize,E);let B;const G=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(G[8]=2*-f.x/this.width,G[9]=2*f.y/this.height,this.isOrthographic){let ze=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),je=ze*this.aspect,it=-je,Ge=-ze;je-=f.x,it-=f.x,ze+=f.y,Ge+=f.y,B=this._camera.getCameraToClipOrthographic(it,je,Ge,ze,this._nearZ,this._farZ),((rt,st,Ve,Qe)=>{for(let kt=0;kt<16;kt++)rt[kt]=Gy(st[kt],Ve[kt],Qe)})(B,B,G,Oh(this.pitch>=15?1:this.pitch/15))}else B=G;const j=o.a9.mul([],G,R);let q=o.a9.mul([],B,R);if(this.projection.isReprojectedInTileSpace){const ze=this.locationCoordinate(this.center),je=o.a9.identity([]);o.a9.translate(je,je,[ze.x*this.worldSize,ze.y*this.worldSize,0]),o.a9.multiply(je,je,o.bE(this)),o.a9.translate(je,je,[-ze.x*this.worldSize,-ze.y*this.worldSize,0]),o.a9.multiply(q,q,je),o.a9.multiply(j,j,je),this.inverseAdjustmentMatrix=o.bF(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.a9.scale([],q,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=q,this.invProjMatrix=o.a9.invert(new Float64Array(16),this.projMatrix),v){const ze=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ze[8]=2*-f.x/this.width,ze[9]=2*f.y/this.height,this.expandedFarZProjMatrix=o.a9.mul([],ze,R)}else this.expandedFarZProjMatrix=this.projMatrix;const K=o.a9.invert([],B);this.frustumCorners=o.bG.fromInvProjectionMatrix(K,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.bt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!v);const te=new Float32Array(16);o.a9.identity(te),o.a9.scale(te,te,[1,-1,1]),o.a9.rotateX(te,te,this._pitch),o.a9.rotateZ(te,te,this.angle);const ne=o.a9.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.a9.clone(ne);const le=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ne[8]=2*-f.x/this.width,ne[9]=2*(f.y+le)/this.height,this.skyboxMatrix=o.a9.multiply(te,ne,te);const se=this.point,ue=se.x,ce=se.y,ye=this.width%2/2,Ce=this.height%2/2,Ae=Math.cos(this.angle),De=Math.sin(this.angle),he=ue-Math.round(ue)+Ae*ye+De*Ce,we=ce-Math.round(ce)+Ae*Ce+De*ye,Fe=new Float64Array(q);if(o.a9.translate(Fe,Fe,[he>.5?he-1:he,we>.5?we-1:we,0]),this.alignedProjMatrix=Fe,q=o.a9.create(),o.a9.scale(q,q,[this.width/2,-this.height/2,1]),o.a9.translate(q,q,[1,-1,0]),this.labelPlaneMatrix=q,q=o.a9.create(),o.a9.scale(q,q,[1,-1,1]),o.a9.translate(q,q,[-1,-1,0]),o.a9.scale(q,q,[2/this.width,2/this.height,1]),this.glCoordMatrix=q,this.pixelMatrix=o.a9.multiply(new Float64Array(16),this.labelPlaneMatrix,j),this._calcFogMatrices(),this._distanceTileDataCache={},q=o.a9.invert(new Float64Array(16),this.pixelMatrix),!q)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=q,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.bH(this);const ze=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.Q.transformMat4(ze,ze,R),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=q;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const f=this.cameraWorldSizeForFog,v=this.cameraPixelsPerMeter,S=this._camera.position,C=1/this.height/this._pixelsPerMercatorPixel,E=[f,f,v];o.Q.scale(E,E,C),o.Q.scale(S,S,-1),o.Q.multiply(S,S,E);const R=o.a9.create();o.a9.translate(R,R,S),o.a9.scale(R,R,E),this.mercatorFogMatrix=R,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(f,v,C)}_computeCameraPosition(f){const v=(f=f||this.pixelsPerMeter)/this.pixelsPerMeter,S=this._camera.forward(),C=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*v-f/this.worldSize*this._centerAltitude;return[C.x/this.worldSize-S[0]*E,C.y/this.worldSize-S[1]*E,f/this.worldSize*this._centerAltitude-S[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(f){const v=this._maxCameraBoundsDistance()*Math.cos(this._pitch),S=this._camera.position[2],C=f[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),C>0&&(E=Math.min((v-S)/C,1)),this._camera.position=o.Q.scaleAndAdd([],this._camera.position,f,E),this._updateStateFromCamera()}_updateStateFromCamera(){const f=this._camera.position,v=this._camera.forward(),{pitch:S,bearing:C}=this._camera.getPitchBearing(),E=o.bo(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,R=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.bm(this._maxPitch)),B=Math.max((f[2]-E)/Math.cos(S),R),G=this._zoomFromMercatorZ(B);o.Q.scaleAndAdd(f,f,v,B),this._pitch=o.ad(S,o.bm(this.minPitch),o.bm(this.maxPitch)),this.angle=o.bk(C,-Math.PI,Math.PI),this._setZoom(o.ad(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.O(f[0],f[1],f[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(f){return Math.pow(2,f)*this.tileSize}_mercatorZfromZoom(f){return this.cameraToCenterDistance/this._worldSizeFromZoom(f)}_minimumHeightOverTerrain(){const f=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(f)}_zoomFromMercatorZ(f){return this.scaleZoom(this.cameraToCenterDistance/(f*this.tileSize))}zoomFromMercatorZAdjusted(f){let v=0,S=o.bA,C=0,E=1/0;for(;S-v>1e-6&&S>v;){const R=v+.5*(S-v),B=this.tileSize*Math.pow(2,R),G=this.getCameraToCenterDistance(this.projection,R,B),j=this.scaleZoom(G/(f*this.tileSize)),q=Math.abs(R-j);q<E&&(E=q,C=R),R<j?v=R:S=R}return C}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(f,v){const S=Math.min(f.x,v.x),C=Math.max(f.x,v.x),E=Math.min(f.y,v.y),R=Math.max(f.y,v.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const B=[new o.P(S,E),new o.P(C,R),new o.P(S,R),new o.P(C,E)],G=this.renderWorldCopies?-3:0,j=this.renderWorldCopies?4:1;for(const q of B){const K=this.pointRayIntersection(q);if(K.t<0)return!0;const te=this.rayIntersectionCoordinate(K);if(te.x<G||te.y<0||te.x>j||te.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.bI(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(f,v){const S=o.Q.length(o.Q.sub([],this._camera.position,f)),C=this._zoomFromMercatorZ(S)+v;return S-this._mercatorZfromZoom(C)}getCameraPoint(){if(this.projection.name==="globe"){const f=function([v,S,C],E){const R=[v,S,C,1];o.aa.transformMat4(R,R,E);const B=R[3]=Math.max(R[3],1e-6);return R[0]/=B,R[1]/=B,R[2]/=B,R}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(f[0],f[1])}{const f=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,f))}}getCameraToCenterDistance(f,v=this.zoom,S=this.worldSize){const C=o.bD(f,v,this.width,this.height,1024),E=f.pixelSpaceConversion(this.center.lat,S,C);let R=.5/Math.tan(.5*this._fov)*this.height*E;return this.isOrthographic&&(R=Gy(1,R,Oh(this.pitch>=15?1:this.pitch/15))),R}getWorldToCameraMatrix(){const f=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.a9.multiply(f,f,this.globeMatrix),f}getFrustum(f){return o.bt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,this.projection.zAxisUnit==="meters")}}const Co={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Iu=(w,f)=>{if(f>0&&w.terrain&&o.w("Cutoff is currently disabled on terrain"),f<=0||w.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const v=w.transform,S=Math.max(Math.abs(v._zoom-(w.minCutoffZoom-1)),1),C=v.isLODDisabled(!1)?o.S(60,45,v.pitch):o.S(30,15,v.pitch),E=v._farZ-v._nearZ,R=f*v.height,B=((1-(G=C))*v.cameraToCenterDistance+G*(v._farZ+R))*S;var G;return{shouldRenderCutoff:C<1,uniformValues:{u_cutoff_params:[v._nearZ,v._farZ,(B-v._nearZ)/E,(B-R-v._nearZ)/E]}}},Mo={cascadeCount:2,shadowMapResolution:2048};class _w{constructor(f,v){this.aabb=f,this.lastCascade=v}}class qI{add(f,v){const S=this.receivers[f.key];S!==void 0?(S.aabb.min[0]=Math.min(S.aabb.min[0],v.min[0]),S.aabb.min[1]=Math.min(S.aabb.min[1],v.min[1]),S.aabb.min[2]=Math.min(S.aabb.min[2],v.min[2]),S.aabb.max[0]=Math.max(S.aabb.max[0],v.max[0]),S.aabb.max[1]=Math.max(S.aabb.max[1],v.max[1]),S.aabb.max[2]=Math.max(S.aabb.max[2],v.max[2])):this.receivers[f.key]=new _w(v,null)}clear(){this.receivers={}}get(f){return this.receivers[f.key]}computeRequiredCascades(f,v,S){const C=o.bV.fromPoints(f.points);let E=0;for(const R in this.receivers){const B=this.receivers[R];if(!B||!C.intersectsAabb(B.aabb))continue;B.aabb.min=C.closestPoint(B.aabb.min),B.aabb.max=C.closestPoint(B.aabb.max);const G=B.aabb.getCorners();for(let j=0;j<S.length;j++){let q=!0;for(const K of G){const te=[K[0]*v,K[1]*v,K[2]];if(o.Q.transformMat4(te,te,S[j].matrix),te[0]<-1||te[0]>1||te[1]<-1||te[1]>1){q=!1;break}}if(B.lastCascade=j,E=Math.max(E,j),q)break}}return E+1}}class yw{constructor(f){this.painter=f,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new qI,this._depthMode=new Pr(f.context.gl.LEQUAL,Pr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,f.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),f.tp.registerParameter(Mo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),f.tp.registerParameter(Mo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),f.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const f of this._cascades)f.texture.destroy(),f.framebuffer.destroy();this._cascades=[]}updateShadowParameters(f,v){const S=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!v||!v.properties)return;const C=v.properties.get("shadow-intensity");if(!v.shadowsEnabled()||C<=0||(this._shadowLayerCount=S.style.order.reduce((le,se)=>{const ue=S.style._mergedLayers[se];return le+(ue.hasShadowPass()&&!ue.isHidden(f.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const E=S.context,R=Mo.shadowMapResolution,B=Mo.shadowMapResolution;if(this._cascades.length===0||Mo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let le=0;le<Mo.cascadeCount;++le){const se=S._shadowMapDebug,ue=E.gl,ce=E.createFramebuffer(R,B,se,"texture"),ye=new o.T(E,{width:R,height:B,data:null},ue.DEPTH_COMPONENT);if(ce.depthAttachment.set(ye.texture),se){const Ce=new o.T(E,{width:R,height:B,data:null},ue.RGBA);ce.colorAttachment.set(Ce.texture)}this._cascades.push({framebuffer:ce,texture:ye,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.bt,scale:0})}}this.shadowDirection=Vv(v);let G=0;if(f.elevation){const le=f.elevation,se=[1e4,-1e4];le.visibleDemTiles.filter(ue=>ue.dem).forEach(ue=>{const ce=ue.dem.tree;se[0]=Math.min(se[0],ce.minimums[0]),se[1]=Math.max(se[1],ce.maximums[0])}),se[0]!==1e4&&(G=(se[1]-se[0])*le.exaggeration())}const j=1.5*f.cameraToCenterDistance,q=3*j,K=new Float64Array(16);for(let le=0;le<this._cascades.length;++le){const se=this._cascades[le];let ue=f.height/50,ce=1;Mo.cascadeCount===1?ce=q:le===0?ce=j:(ue=j,ce=q);const[ye,Ce]=Gv(f,this.shadowDirection,ue,ce,Mo.shadowMapResolution,G);se.scale=f.scale,se.matrix=ye,se.boundingSphereRadius=Ce,o.a9.invert(K,se.matrix),se.frustum=o.bt.fromInvProjectionMatrix(K,1,0,!0),se.far=ce}const te=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[te].far,this._cascades[te].far],this._uniformValues.u_shadow_intensity=C,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Mo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Mo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Co.ShadowMap0,this._uniformValues.u_shadowmap_1=Co.ShadowMap0+1,this._groundShadowTiles=S.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ne=S.transform.elevation;for(const le of this._groundShadowTiles){let se={min:0,max:0};if(ne){const ue=ne.getMinMaxForTile(le);ue&&(se=ue)}this.addShadowReceiver(le.toUnwrapped(),se.min,se.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(f){this._enabled=f}drawShadowPass(f,v){if(!this.enabled)return;const S=this.painter,C=S.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(S.transform.getFrustum(0),S.transform.worldSize,this._cascades),C.viewport.set([0,0,Mo.shadowMapResolution,Mo.shadowMapResolution]);for(let E=0;E<this._numCascadesToRender;++E){S.currentShadowCascade=E,C.bindFramebuffer.set(this._cascades[E].framebuffer.framebuffer),C.clear({color:o.aA.white,depth:1});for(const R of f.order){const B=f._mergedLayers[R];if(!B.hasShadowPass()||B.isHidden(S.transform.zoom))continue;const G=f.getLayerSourceCache(B),j=G?v[G.id]:void 0;(B.type==="model"||j&&j.length)&&S.renderLayer(S,G,B,j)}}S.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const f=this.painter,v=f.style,S=f.context,C=v.directionalLight,E=v.ambientLight;if(!C||!E)return;const R=[],B=Iu(f,f.longestCutoffRange);B.shouldRenderCutoff&&R.push("RENDER_CUTOFF");const G=Uy(C,E),j=new Pr(S.gl.LEQUAL,Pr.ReadOnly,f.depthRangeFor3D);for(const q of this._groundShadowTiles){const K=q.toUnwrapped(),te=f.isTileAffectedByFog(q),ne=f.getOrCreateProgram("groundShadow",{defines:R,overrideFog:te});this.setupShadows(K,ne),f.uploadCommonUniforms(S,ne,K,null,B);const le={u_matrix:f.transform.calculateProjMatrix(K),u_ground_shadow_factor:G};ne.draw(f,S.gl.TRIANGLES,j,qr.disabled,fn.multiply,Vr.disabled,le,"ground_shadow",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments,{},f.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?fn.unblended:fn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(f){const v=this.painter.transform,S=v.calculatePosMatrix(f,v.worldSize);return o.a9.multiply(S,this._cascades[this.painter.currentShadowCascade].matrix,S),Float32Array.from(S)}calculateShadowPassMatrixFromMatrix(f){return o.a9.multiply(f,this._cascades[this.painter.currentShadowCascade].matrix,f),Float32Array.from(f)}setupShadows(f,v,S,C=0){if(!this.enabled)return;const E=this.painter.transform,R=this.painter.context,B=R.gl,G=this._uniformValues,j=new Float64Array(16),q=E.calculatePosMatrix(f,E.worldSize);for(let K=0;K<this._cascades.length;K++)o.a9.multiply(j,this._cascades[K].matrix,q),G[K===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(j),R.activeTexture.set(B.TEXTURE0+Co.ShadowMap0+K),this._cascades[K].texture.bind(B.NEAREST,B.CLAMP_TO_EDGE);if(this.useNormalOffset=!!S,this.useNormalOffset){const K=o.bU(f.canonical),te=2/E.tileSize*o.Y/Mo.shadowMapResolution,ne=te*this._cascades[0].boundingSphereRadius,le=te*this._cascades[this._cascades.length-1].boundingSphereRadius,se=(S==="vector-tile"?1:3)/Math.pow(2,C-f.canonical.z-(1-E.zoom+Math.floor(E.zoom)));G.u_shadow_normal_offset=[K,ne*se,le*se],G.u_shadow_bias=[6e-5,.0012,.012]}else G.u_shadow_bias=[36e-5,.0012,.012];v.setShadowUniformValues(R,G)}setupShadowsFromMatrix(f,v,S=!1){if(!this.enabled)return;const C=this.painter.context,E=C.gl,R=this._uniformValues,B=new Float64Array(16);for(let G=0;G<Mo.cascadeCount;G++)o.a9.multiply(B,this._cascades[G].matrix,f),R[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(B),C.activeTexture.set(E.TEXTURE0+Co.ShadowMap0+G),this._cascades[G].texture.bind(E.NEAREST,E.CLAMP_TO_EDGE);this.useNormalOffset=S,S?(R.u_shadow_normal_offset=[1,5,5],R.u_shadow_bias=[6e-5,.0012,.012]):R.u_shadow_bias=[36e-5,.0012,.012],v.setShadowUniformValues(C,R)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(f,v,S,C){if(C[2]>=0)return{};const E=function(G,j,q){const K=q/(1<<G.canonical.z);return new o.bV([G.canonical.x*K+G.wrap*q,G.canonical.y*K+G.wrap*q,0],[(G.canonical.x+1)*K+G.wrap*q,(G.canonical.y+1)*K+G.wrap*q,j])}(f,v,S).getCorners(),R=v/-C[2];C[0]<0?(o.Q.add(E[0],E[0],[C[0]*R,0,0]),o.Q.add(E[3],E[3],[C[0]*R,0,0])):C[0]>0&&(o.Q.add(E[1],E[1],[C[0]*R,0,0]),o.Q.add(E[2],E[2],[C[0]*R,0,0])),C[1]<0?(o.Q.add(E[0],E[0],[0,C[1]*R,0]),o.Q.add(E[1],E[1],[0,C[1]*R,0])):C[1]>0&&(o.Q.add(E[2],E[2],[0,C[1]*R,0]),o.Q.add(E[3],E[3],[0,C[1]*R,0]));const B={};return B.vertices=E,B.planes=[Nv(E[1],E[0],E[4]),Nv(E[2],E[1],E[5]),Nv(E[3],E[2],E[6]),Nv(E[0],E[3],E[7])],B}addShadowReceiver(f,v,S){this._receivers.add(f,o.bV.fromTileIdAndHeight(f,v,S))}getMaxCascadeForTile(f){const v=this._receivers.get(f);return v&&v.lastCascade?v.lastCascade:0}}function Nv(w,f,v){const S=o.Q.sub([],v,f),C=o.Q.sub([],w,f),E=o.Q.cross([],S,C),R=o.Q.length(E);return R===0?[0,0,1,0]:(o.Q.scale(E,E,1/R),[E[0],E[1],E[2],-o.Q.dot(E,f)])}function Vv(w){const f=w.properties.get("direction"),v=o.bT(f.x,f.y,f.z);v[2]=o.ad(v[2],0,75);const S=o.bW([v[0],v[1],v[2]]);return o.Q.fromValues(S.x,S.y,S.z)}function Uy(w,f){const v=w.properties.get("color"),S=w.properties.get("intensity"),C=w.properties.get("direction"),E=[C.x,C.y,C.z],R=f.properties.get("color"),B=f.properties.get("intensity"),G=Math.max(o.Q.dot([0,0,1],E),0),j=[0,0,0];o.Q.scale(j,R.toArray01Linear().slice(0,3),B);const q=[0,0,0];return o.Q.scale(q,v.toArray01Linear().slice(0,3),G*S),o.bX([j[0]>0?j[0]/(j[0]+q[0]):0,j[1]>0?j[1]/(j[1]+q[1]):0,j[2]>0?j[2]/(j[2]+q[2]):0])}function Gv(w,f,v,S,C,E){const R=w.zoom,B=w.scale,G=w.worldSize,j=1/G,q=w.aspect,K=Math.sqrt(1+q*q)*Math.tan(.5*w.fovX),te=K*K,ne=S-v,le=S+v;let se,ue;te>ne/le?(se=S,ue=S*K):(se=.5*le*(1+te),ue=.5*Math.sqrt(ne*ne+2*(S*S+v*v)*te+le*le*te*te));const ce=w.projection.pixelsPerMeter(w.center.lat,G),ye=w._camera.getCameraToWorldMercator(),Ce=[0,0,-se*j];o.Q.transformMat4(Ce,Ce,ye);let Ae=ue*j;const De=w._edgeInsets;if(!(De.left===0&&De.top===0&&De.right===0&&De.bottom===0||De.left===De.right&&De.top===De.bottom)){const Me=w._camera.getWorldToCamera(w.worldSize,w.projection.zAxisUnit==="meters"?ce:1),Tt=w._camera.getCameraToClipPerspective(w._fov,w.width/w.height,v,S);Tt[8]=2*-w.centerOffset.x/w.width,Tt[9]=2*w.centerOffset.y/w.height;const lr=new Float64Array(16);o.a9.mul(lr,Tt,Me);const vr=new Float64Array(16);o.a9.invert(vr,lr);const Ar=o.bt.fromInvProjectionMatrix(vr,G,R,!0);for(const xr of Ar.points){const Dr=((he=xr)[0]/=B,he[1]/=B,he[2]=o.bo(he[2],w._center.lat),he);Ae=Math.max(Ae,o.Q.len(o.Q.subtract([],Ce,Dr)))}}var he;Ae*=C/(C-1);const we=Math.acos(f[2]),Fe=Math.atan2(-f[0],-f[1]),ze=new Gd;ze.position=Ce,ze.setPitchBearing(we,Fe);const je=ze.getWorldToCamera(G,ce),it=Ae*G,Ge=Math.min(w._mercatorZfromZoom(17)*G*-2,-2*it),rt=ze.getCameraToClipOrthographic(-it,it,-it,it,Ge,(it+E*ce)/f[2]),st=new Float64Array(16);o.a9.multiply(st,rt,je);const Ve=o.Q.fromValues(Math.floor(1e6*Ce[0])/1e6*G,Math.floor(1e6*Ce[1])/1e6*G,0),Qe=.5*C,kt=[0,0,0];o.Q.transformMat4(kt,Ve,st),o.Q.scale(kt,kt,Qe);const Ze=[Math.floor(kt[0]),Math.floor(kt[1]),Math.floor(kt[2])],nt=[0,0,0];o.Q.sub(nt,kt,Ze),o.Q.scale(nt,nt,-1/Qe);const ot=new Float64Array(16);return o.a9.identity(ot),o.a9.translate(ot,ot,nt),o.a9.multiply(st,ot,st),[st,it]}const il=(w,f)=>Dt(w,f&&f.filter(v=>v.identifier!=="source.canvas")),xw=o.af(Zn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),YI=o.af(Zn,["setCenter","setZoom","setBearing","setPitch"]),$y={version:8,layers:[],sources:{}},Hy={duration:300,delay:0};class zs extends o.E{constructor(f,v={}){super(),this.map=f,this.scope=v.scope||"",this.globalId=null,this.fragments=[],this.importDepth=v.importDepth||0,this.importsCache=v.importsCache||new Map,this.resolvedImports=v.resolvedImports||new Set,this.transition=o.e({},Hy),this._buildingIndex=new Ey(this),this.crossTileSymbolIndex=new Ny,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=v.styleChanges||new J,this.dispatcher=v.dispatcher?v.dispatcher:new o.bZ(o.b_(),this),v.imageManager?this.imageManager=v.imageManager:(this.imageManager=new de,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=v.glyphManager?v.glyphManager:new o.b$(f._requestManager,v.localFontFamily?o.c0.all:v.localIdeographFontFamily?o.c0.ideographs:o.c0.none,v.localFontFamily||v.localIdeographFontFamily),v.modelManager?this.modelManager=v.modelManager:(this.modelManager=new re(f._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=v.configOptions?v.configOptions:new Map,this._configDependentLayers=v.configDependentLayers?v.configDependentLayers:new Set,this._config=v.config,this._initialConfig=v.initialConfig,this.dispatcher.broadcast("setReferrer",o.c1());const S=this;this._rtlTextPluginCallback=zs.registerForPluginStateChange(C=>{S.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(E,R)=>{if(o.c2(E),R&&R.every(B=>B))for(const B in S._sourceCaches){const G=S._sourceCaches[B],j=G.getSource().type;j!=="vector"&&j!=="geojson"||G.reload()}})}),this.on("data",C=>{if(C.dataType!=="source"||C.sourceDataType!=="metadata")return;const E=this.getOwnSource(C.sourceId);if(E&&E.vectorLayerIds)for(const R in this._layers){const B=this._layers[R];B.source===E.id&&this._validateLayer(B)}})}load(f){return f?(typeof f=="string"?this.loadURL(f):this.loadJSON(f),this):this}_getGlobalId(f){if(!f)return null;if(typeof f=="string"){if(o.c3(f))return f;const v=o.c4(f);if(!v.startsWith("http"))try{return new URL(v,location.href).toString()}catch{return v}return v}return`json://${o.c5(JSON.stringify(f))}`}_diffStyle(f,v,S){this.globalId=this._getGlobalId(f);const C=(E,R)=>{try{R(null,this.setState(E,S))}catch(B){R(B,!1)}};if(typeof f=="string"){const E=this.map._requestManager.normalizeStyleURL(f),R=this.map._requestManager.transformRequest(E,o.R.Style);o.g(R,(B,G)=>{B?this.fire(new o.a(B)):G&&C(G,v)})}else typeof f=="object"&&C(f,v)}loadURL(f,v={}){this.fire(new o.b("dataloading",{dataType:"style"}));const S=typeof v.validate=="boolean"?v.validate:!o.c3(f);this.globalId=this._getGlobalId(f),f=this.map._requestManager.normalizeStyleURL(f,v.accessToken),this.resolvedImports.add(f);const C=this.importsCache.get(f);if(C)return this._load(C,S);const E=this.map._requestManager.transformRequest(f,o.R.Style);this._request=o.g(E,(R,B)=>{if(this._request=null,R)this.fire(new o.a(R));else if(B)return this.importsCache.set(f,B),this._load(B,S)})}loadJSON(f,v={}){this.fire(new o.b("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(f),this._request=o.f.frame(()=>{this._request=null,this._load(f,v.validate!==!1)})}loadEmpty(){this.fire(new o.b("dataloading",{dataType:"style"})),this._load($y,!1)}_loadImports(f,v,S){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const C=[];for(const E of f){const R=this._createFragmentStyle(E),B=new Promise(q=>{R.once("style.import.load",q),R.once("error",q)}).then(()=>this.mergeAll());if(C.push(B),this.resolvedImports.has(E.url)){R.loadEmpty();continue}const G=E.data||this.importsCache.get(E.url);G?(R.loadJSON(G,{validate:v}),this._isInternalStyle(G)&&(R.globalId=null)):E.url?R.loadURL(E.url,{validate:v}):R.loadEmpty();const j={style:R,id:E.id,config:E.config};if(S){const q=this.fragments.findIndex(({id:K})=>K===S);this.fragments=this.fragments.slice(0,q).concat(j).concat(this.fragments.slice(q))}else this.fragments.push(j)}return Promise.allSettled(C)}getImportGlobalIds(f=this,v=new Set){for(const S of f.fragments)S.style.globalId&&v.add(S.style.globalId),this.getImportGlobalIds(S.style,v);return[...v.values()]}_createFragmentStyle(f){const v=this.scope?o.aj(f.id,this.scope):f.id;let S;const C=this._initialConfig&&this._initialConfig[v];(f.config||C)&&(S=o.e({},f.config,C));const E=new zs(this.map,{scope:v,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:S,configOptions:this.options,configDependentLayers:this._configDependentLayers});return E.setEventedParent(this.map,{style:E}),E}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.isRootStyle()}_isInternalStyle(f){return this.isRootStyle()&&(f.fragment||!!f.schema&&f.fragment!==!1)}_load(f,v){const S=f.schema;if(this._isInternalStyle(f)){const B=o.e({},$y,{imports:[{id:"basemap",data:f,url:""}]});return void this._load(B,v)}if(this.updateConfig(this._config,S),v&&il(this,ht(f)))return;this._loaded=!0,this.stylesheet=o.c6(f);for(const B in f.sources)this.addSource(B,f.sources[B],{validate:!1,isInitialLoad:!0});f.sprite?this._loadSprite(f.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(f.glyphs,this.scope);const C=cw(this.stylesheet.layers);if(this._order=C.map(B=>B.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const B=this.stylesheet.lights[0];this.light=new jt(B.properties,B.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new jt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const B of C){const G=o.c7(B,this.scope,this.options);G.isConfigDependent&&this._configDependentLayers.add(G.fqid),G.setEventedParent(this,{layer:{id:G.id}}),this._layers[G.id]=G,this._serializedLayers[G.id]=G.serialize();const j=this.getOwnLayerSourceCache(G),q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();j&&G.canCastShadows()&&q&&(j.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const E=this.stylesheet.terrain;E&&(this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.f.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(E,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.b("data",{dataType:"style"}));const R=this.isRootStyle();f.imports?this._loadImports(f.imports,v).then(()=>{this._reloadImports(),this.fire(new o.b(R?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.b(R?"style.load":"style.import.load")))}isRootStyle(){return this.importDepth===0}mergeAll(){let f,v,S,C,E,R,B,G;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(j=>{if(j.stylesheet){if(j.light!=null&&(f=j.light),j.stylesheet.lights)for(const q of j.stylesheet.lights)q.type==="ambient"&&j.ambientLight!=null&&(v=j.ambientLight),q.type==="directional"&&j.directionalLight!=null&&(S=j.directionalLight);C=this._prioritizeTerrain(C,j.terrain,j.stylesheet.terrain),j.stylesheet.fog&&j.fog!=null&&(E=j.fog),j.stylesheet.camera!=null&&(G=j.stylesheet.camera),j.stylesheet.projection!=null&&(R=j.stylesheet.projection),j.stylesheet.transition!=null&&(B=j.stylesheet.transition)}}),this.light=f,this.ambientLight=v,this.directionalLight=S,this.fog=E,C===null?delete this.terrain:this.terrain=C,this.camera=G||{"camera-projection":"perspective"},this.projection=R||{name:"mercator"},this.transition=o.e({},Hy,B),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(f){const v=S=>{for(const C of S.fragments)v(C.style);f(S)};v(this)}_prioritizeTerrain(f,v,S){const C=f&&f.drapeRenderMode===0;return S===null?v&&v.drapeRenderMode===0?v:C?f:null:v!=null&&(!f||C||v&&v.drapeRenderMode===1)?v:f}mergeTerrain(){let f;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(v=>{f=this._prioritizeTerrain(f,v.terrain,v.stylesheet.terrain)}),f===null?delete this.terrain:this.terrain=f}mergeProjection(){let f;this.forEachFragmentStyle(v=>{v.stylesheet.projection!=null&&(f=v.stylesheet.projection)}),this.projection=f||{name:"mercator"}}mergeSources(){const f={},v={},S={};this.forEachFragmentStyle(C=>{for(const E in C._sourceCaches){const R=o.aj(E,C.scope);f[R]=C._sourceCaches[E]}for(const E in C._otherSourceCaches){const R=o.aj(E,C.scope);v[R]=C._otherSourceCaches[E]}for(const E in C._symbolSourceCaches){const R=o.aj(E,C.scope);S[R]=C._symbolSourceCaches[E]}}),this._mergedSourceCaches=f,this._mergedOtherSourceCaches=v,this._mergedSymbolSourceCaches=S}mergeLayers(){const f={},v=[],S={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(E=>{for(const R of E._order){const B=E._layers[R];if(B.type==="slot"){const G=o.c8(R);if(f[G])continue;f[G]=[]}B.slot&&f[B.slot]?f[B.slot].push(B):v.push(B)}}),this._mergedOrder=[];const C=(E=[])=>{for(const R of E)if(R.type==="slot"){const B=o.c8(R.id);f[B]&&C(f[B])}else{const B=o.aj(R.id,R.scope);this._mergedOrder.push(B),S[B]=R,R.is3D()&&(this._has3DLayers=!0),R.type==="circle"&&(this._hasCircleLayers=!0),R.type==="symbol"&&(this._hasSymbolLayers=!0)}};C(v),this._mergedLayers=S,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(f){return this.stylesheet.camera=o.e({},this.stylesheet.camera,f),this.camera=this.stylesheet.camera,this}setProjection(f){f?this.stylesheet.projection=f:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(f){this._spriteRequest=function(v,S,C){let E,R,B;const G=o.f.devicePixelRatio>1?"@2x":"";let j=o.g(S.transformRequest(S.normalizeSpriteURL(v,G,".json"),o.R.SpriteJSON),(te,ne)=>{j=null,B||(B=te,E=ne,K())}),q=o.d(S.transformRequest(S.normalizeSpriteURL(v,G,".png"),o.R.SpriteImage),(te,ne)=>{q=null,B||(B=te,R=ne,K())});function K(){if(B)C(B);else if(E&&R){const te=o.f.getImageData(R),ne={};for(const le in E){const{width:se,height:ue,x:ce,y:ye,sdf:Ce,pixelRatio:Ae,stretchX:De,stretchY:he,content:we}=E[le],Fe=new o.h({width:se,height:ue});o.h.copy(te,Fe,{x:ce,y:ye},{x:0,y:0},{width:se,height:ue}),ne[le]={data:Fe,pixelRatio:Ae,sdf:Ce,stretchX:De,stretchY:he,content:we}}C(null,ne)}}return{cancel(){j&&(j.cancel(),j=null),q&&(q.cancel(),q=null)}}}(f,this.map._requestManager,(v,S)=>{if(this._spriteRequest=null,v)this.fire(new o.a(v));else if(S)for(const C in S)this.imageManager.addImage(C,this.scope,S[C]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.b("data",{dataType:"style"}))})}_validateLayer(f){const v=this.getOwnSource(f.source);if(!v)return;const S=f.sourceLayer;S&&(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(S)===-1)&&this.fire(new o.a(new Error(`Source layer "${S}" does not exist on source "${v.id}" as specified by style layer "${f.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const f in this._sourceCaches)if(!this._sourceCaches[f].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:f}of this.fragments)if(!f.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((f,v)=>{const S=this.fragments[v];return S&&S.style&&(f.data=S.style.serialize()),f})}_serializeSources(){const f={};for(const v in this._sourceCaches){const S=this._sourceCaches[v].getSource();f[S.id]||(f[S.id]=S.serialize())}return f}_serializeLayers(f){const v=[];for(const S of f){const C=this._layers[S];C&&C.type!=="custom"&&v.push(C.serialize())}return v}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const f in this._sourceCaches)if(this._sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(f){return!!this.terrain&&f.isDraped(this.getLayerSourceCache(f))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(f){const v=this.getOwnLayer(f);if(v)return v;this.fire(new o.a(new Error(`The layer '${f}' does not exist in the map's style.`)))}_checkSource(f){const v=this.getOwnSource(f);if(v)return v;this.fire(new o.a(new Error(`The source '${f}' does not exist in the map's style.`)))}update(f){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(f),this.directionalLight&&this.directionalLight.recalculate(f);const v=this.calculateLightsBrightness();f.brightness=v||0,v!==this._brightness&&(this._brightness=v,this.dispatcher.broadcast("setBrightness",v));const S=this._changes.isDirty();if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const R in E){const{updatedIds:B,removedIds:G}=E[R];(B||G)&&this._updateWorkerLayers(R,B,G)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(f),this.light&&this.light.updateTransitions(f),this.ambientLight&&this.ambientLight.updateTransitions(f),this.directionalLight&&this.directionalLight.updateTransitions(f),this.fog&&this.fog.updateTransitions(f),this._changes.reset()}const C={};for(const E in this._mergedSourceCaches){const R=this._mergedSourceCaches[E];C[E]=R.used,R.used=!1,R.tileCoverLift=0}for(const E of this._mergedOrder){const R=this._mergedLayers[E];if(R.recalculate(f,this._availableImages),!R.isHidden(f.zoom)){const B=this.getLayerSourceCache(R);B&&(B.used=!0,B.tileCoverLift=Math.max(B.tileCoverLift,R.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let B=R.minzoom||0;B<(R.maxzoom||25.5);B++){const G=this.map.painter;if(G){const j=R.getProgramIds();if(!j)continue;for(const q of j){const K=R.getDefaultProgramParams(q,f.zoom);K&&(G.style=this,this.fog&&(G._fogVisible=!0,K.overrideFog=!0,G.getOrCreateProgram(q,K)),G._fogVisible=!1,K.overrideFog=!1,G.getOrCreateProgram(q,K),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(K.overrideRtt=!0,G.getOrCreateProgram(q,K)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const E in C){const R=this._mergedSourceCaches[E];C[E]!==R.used&&R.getSource().fire(new o.b("data",{sourceDataType:"visibility",dataType:"source",sourceId:R.getSource().id}))}this.light&&this.light.recalculate(f),this.terrain&&this.terrain.recalculate(f),this.fog&&this.fog.recalculate(f),this.z=f.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),S&&this.fire(new o.b("data",{dataType:"style"}))}_updateTilesForChangedImages(){const f=this._changes.getUpdatedImages();if(f.length){for(const v in this._sourceCaches)this._sourceCaches[v].reloadTilesForDependencies(["icons","patterns"],f);this._changes.resetUpdatedImages()}}_updateWorkerLayers(f,v,S){const C=this.getFragmentStyle(f);C&&this.dispatcher.broadcast("updateLayers",{layers:v?C._serializeLayers(v):[],scope:f,removedIds:S||[],options:C.options})}setState(f,v){if(this._checkLoaded(),il(this,ht(f)))return!1;(f=o.c6(f)).layers=cw(f.layers);const S=function(R,B){if(!R)return[{command:Zn.setStyle,args:[B]}];let G=[];try{if(!d(R.version,B.version))return[{command:Zn.setStyle,args:[B]}];d(R.center,B.center)||G.push({command:Zn.setCenter,args:[B.center]}),d(R.zoom,B.zoom)||G.push({command:Zn.setZoom,args:[B.zoom]}),d(R.bearing,B.bearing)||G.push({command:Zn.setBearing,args:[B.bearing]}),d(R.pitch,B.pitch)||G.push({command:Zn.setPitch,args:[B.pitch]}),d(R.sprite,B.sprite)||G.push({command:Zn.setSprite,args:[B.sprite]}),d(R.glyphs,B.glyphs)||G.push({command:Zn.setGlyphs,args:[B.glyphs]}),d(R.imports,B.imports)||function(ne=[],le=[],se){le=le||[];const ue=(ne=ne||[]).map(Ih),ce=le.map(Ih),ye=ne.reduce(Ld,{}),Ce=le.reduce(Ld,{}),Ae=ue.slice();let De,he,we,Fe;for(De=0,he=0;De<ue.length;De++)we=ue[De],Ce.hasOwnProperty(we)?he++:(se.push({command:Zn.removeImport,args:[we]}),Ae.splice(Ae.indexOf(we,he),1));for(De=0,he=0;De<ce.length;De++)we=ce[ce.length-1-De],Ae[Ae.length-1-De]!==we&&(ye.hasOwnProperty(we)?(se.push({command:Zn.removeImport,args:[we]}),Ae.splice(Ae.lastIndexOf(we,Ae.length-he),1)):he++,Fe=Ae[Ae.length-De],se.push({command:Zn.addImport,args:[Ce[we],Fe]}),Ae.splice(Ae.length-De,0,we));for(const ze of le){const je=ye[ze.id];je&&!d(je,ze)&&se.push({command:Zn.updateImport,args:[ze.id,ze]})}}(R.imports,B.imports,G),d(R.transition,B.transition)||G.push({command:Zn.setTransition,args:[B.transition]}),d(R.light,B.light)||G.push({command:Zn.setLight,args:[B.light]}),d(R.fog,B.fog)||G.push({command:Zn.setFog,args:[B.fog]}),d(R.projection,B.projection)||G.push({command:Zn.setProjection,args:[B.projection]}),d(R.lights,B.lights)||G.push({command:Zn.setLights,args:[B.lights]}),d(R.camera,B.camera)||G.push({command:Zn.setCamera,args:[B.camera]});const j={},q=[];(function(ne,le,se,ue){let ce;for(ce in le=le||{},ne=ne||{})ne.hasOwnProperty(ce)&&(le.hasOwnProperty(ce)||Dy(ce,se,ue));for(ce in le){if(!le.hasOwnProperty(ce))continue;const ye=le[ce];ne.hasOwnProperty(ce)?d(ne[ce],ye)||(ne[ce].type==="geojson"&&ye.type==="geojson"&&Py(ne,le,ce)?se.push({command:Zn.setGeoJSONSourceData,args:[ce,ye.data]}):hw(ce,le,se,ue)):Tv(ce,le,se)}})(R.sources,B.sources,q,j);const K=[];R.layers&&R.layers.forEach(ne=>{ne.source&&j[ne.source]?G.push({command:Zn.removeLayer,args:[ne.id]}):K.push(ne)});let te=R.terrain;te&&j[te.source]&&(G.push({command:Zn.setTerrain,args:[void 0]}),te=void 0),G=G.concat(q),d(te,B.terrain)||G.push({command:Zn.setTerrain,args:[B.terrain]}),function(ne,le,se){le=le||[];const ue=(ne=ne||[]).map(Ih),ce=le.map(Ih),ye=ne.reduce(Ld,{}),Ce=le.reduce(Ld,{}),Ae=ue.slice(),De=Object.create(null);let he,we,Fe,ze,je,it,Ge;for(he=0,we=0;he<ue.length;he++)Fe=ue[he],Ce.hasOwnProperty(Fe)?we++:(se.push({command:Zn.removeLayer,args:[Fe]}),Ae.splice(Ae.indexOf(Fe,we),1));for(he=0,we=0;he<ce.length;he++)Fe=ce[ce.length-1-he],Ae[Ae.length-1-he]!==Fe&&(ye.hasOwnProperty(Fe)?(se.push({command:Zn.removeLayer,args:[Fe]}),Ae.splice(Ae.lastIndexOf(Fe,Ae.length-we),1)):we++,it=Ae[Ae.length-he],se.push({command:Zn.addLayer,args:[Ce[Fe],it]}),Ae.splice(Ae.length-he,0,Fe),De[Fe]=!0);for(he=0;he<ce.length;he++)if(Fe=ce[he],ze=ye[Fe],je=Ce[Fe],!De[Fe]&&!d(ze,je))if(d(ze.source,je.source)&&d(ze["source-layer"],je["source-layer"])&&d(ze.type,je.type)){for(Ge in Sc(ze.layout,je.layout,se,Fe,null,Zn.setLayoutProperty),Sc(ze.paint,je.paint,se,Fe,null,Zn.setPaintProperty),d(ze.slot,je.slot)||se.push({command:Zn.setSlot,args:[Fe,je.slot]}),d(ze.filter,je.filter)||se.push({command:Zn.setFilter,args:[Fe,je.filter]}),d(ze.minzoom,je.minzoom)&&d(ze.maxzoom,je.maxzoom)||se.push({command:Zn.setLayerZoomRange,args:[Fe,je.minzoom,je.maxzoom]}),ze)ze.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&Ge!=="slot"&&(Ge.indexOf("paint.")===0?Sc(ze[Ge],je[Ge],se,Fe,Ge.slice(6),Zn.setPaintProperty):d(ze[Ge],je[Ge])||se.push({command:Zn.setLayerProperty,args:[Fe,Ge,je[Ge]]}));for(Ge in je)je.hasOwnProperty(Ge)&&!ze.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&Ge!=="slot"&&(Ge.indexOf("paint.")===0?Sc(ze[Ge],je[Ge],se,Fe,Ge.slice(6),Zn.setPaintProperty):d(ze[Ge],je[Ge])||se.push({command:Zn.setLayerProperty,args:[Fe,Ge,je[Ge]]}))}else se.push({command:Zn.removeLayer,args:[Fe]}),it=Ae[Ae.lastIndexOf(Fe)+1],se.push({command:Zn.addLayer,args:[je,it]})}(K,B.layers,G)}catch(j){console.warn("Unable to compute style diff:",j),G=[{command:Zn.setStyle,args:[B]}]}return G}(this.serialize(),f).filter(R=>!(R.command in YI));if(S.length===0)return!1;const C=S.filter(R=>!(R.command in xw));if(C.length>0)throw new Error(`Unimplemented: ${C.map(R=>R.command).join(", ")}.`);const E=[];return S.forEach(R=>{E.push(this[R.command].apply(this,R.args))}),v&&Promise.all(E).then(v),this.stylesheet=f,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(f,v){return this.getImage(f)?this.fire(new o.a(new Error("An image with this name already exists."))):(this.imageManager.addImage(f,this.scope,v),this._afterImageUpdated(f),this)}updateImage(f,v){this.imageManager.updateImage(f,this.scope,v)}getImage(f){return this.imageManager.getImage(f,this.scope)}removeImage(f){return this.getImage(f)?(this.imageManager.removeImage(f,this.scope),this._afterImageUpdated(f),this):this.fire(new o.a(new Error("No image with this name exists.")))}_afterImageUpdated(f){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(f),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new o.b("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(f,v,S={}){return this._checkLoaded(),this._validate(vt,`models.${f}`,v,null,S)||(this.modelManager.addModel(f,v,this.scope),this._changes.setDirty()),this}hasModel(f){return this.modelManager.hasModel(f,this.scope)}removeModel(f){return this.hasModel(f)?(this.modelManager.removeModel(f,this.scope),this):this.fire(new o.a(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(f,v,S={}){if(this._checkLoaded(),this.getOwnSource(f)!==void 0)throw new Error(`There is already a source with ID "${f}".`);if(!v.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(v).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(v.type)>=0&&this._validate(er,`sources.${f}`,v,null,S))return;this.map&&this.map._collectResourceTiming&&(v.collectResourceTiming=!0);const C=My(f,v,this.dispatcher,this);C.scope=this.scope,C.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(C.id),source:C.serialize(),sourceId:C.id}));const E=R=>{const B=(R?"symbol:":"other:")+C.id,G=o.aj(B,this.scope),j=this._sourceCaches[B]=new Rs(G,C,R);(R?this._symbolSourceCaches:this._otherSourceCaches)[C.id]=j,j.onAdd(this.map)};E(!1),v.type!=="vector"&&v.type!=="geojson"||E(!0),C.onAdd&&C.onAdd(this.map),S.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(f){this._checkLoaded();const v=this.getOwnSource(f);if(!v)throw new Error("There is no source with this ID");for(const C in this._layers)if(this._layers[C].source===f)return this.fire(new o.a(new Error(`Source "${f}" cannot be removed while layer "${C}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===f)return this.fire(new o.a(new Error(`Source "${f}" cannot be removed while terrain is using it.`)));const S=this.getOwnSourceCaches(f);for(const C of S){const E=o.c8(C.id);delete this._sourceCaches[E],this._changes.discardSourceCacheUpdate(C.id),C.fire(new o.b("data",{sourceDataType:"metadata",dataType:"source",sourceId:C.getSource().id})),C.setEventedParent(null),C.clearTiles()}return delete this._otherSourceCaches[f],delete this._symbolSourceCaches[f],this.mergeSources(),v.setEventedParent(null),v.onRemove&&v.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(f,v){this._checkLoaded(),this.getOwnSource(f).setData(v),this._changes.setDirty()}getOwnSource(f){const v=this.getOwnSourceCache(f);return v&&v.getSource()}getOwnSources(){const f=[];for(const v in this._otherSourceCaches){const S=this.getOwnSourceCache(v);S&&f.push(S.getSource())}return f}areTilesLoaded(){const f=this._mergedSourceCaches;for(const v in f){const S=f[v]._tiles;for(const C in S){const E=S[C];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}setLights(f){if(this._checkLoaded(),!f)return delete this.ambientLight,void delete this.directionalLight;const v=this._getTransitionParameters();for(const C of f){if(this._validate(qe,"lights",C))return;switch(C.type){case"ambient":if(this.ambientLight){const E=this.ambientLight;E.set(C),E.updateTransitions(v)}else this.ambientLight=new no(C,Ds,this.scope,this.options);break;case"directional":if(this.directionalLight){const E=this.directionalLight;E.set(C),E.updateTransitions(v)}else this.directionalLight=new no(C,sa,this.scope,this.options)}}const S=new o.N(this.z||0,v);this.ambientLight&&this.ambientLight.recalculate(S),this.directionalLight&&this.directionalLight.recalculate(S),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const f=this.directionalLight,v=this.ambientLight;if(!f||!v)return;const S=K=>.2126*(K[0]<=.03928?K[0]/12.92:Math.pow((K[0]+.055)/1.055,2.4))+.7152*(K[1]<=.03928?K[1]/12.92:Math.pow((K[1]+.055)/1.055,2.4))+.0722*(K[2]<=.03928?K[2]/12.92:Math.pow((K[2]+.055)/1.055,2.4)),C=f.properties.get("color").toArray01(),E=f.properties.get("intensity"),R=f.properties.get("direction"),B=1-o.bT(R.x,R.y,R.z)[2]/90,G=S(C)*E*B,j=v.properties.get("color").toArray01(),q=v.properties.get("intensity");return(G+S(j)*q)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const f=[];return this.directionalLight&&f.push(this.directionalLight.get()),this.ambientLight&&f.push(this.ambientLight.get()),f}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(f){if(!f)return this;if(o.c9(f)){const v=o.ca(f),S=this.fragments.find(({id:E})=>E===v);if(!S)throw new Error(`Style import not found: ${f}`);const C=o.c8(f);return S.style.getFragmentStyle(C)}{const v=this.fragments.find(({id:S})=>S===f);if(!v)throw new Error(`Style import not found: ${f}`);return v.style}}getConfigProperty(f,v){const S=this.getFragmentStyle(f);if(!S)return null;const C=o.aj(v,S.scope),E=S.options.get(C),R=E?E.value||E.default:null;return R?R.serialize():null}setConfigProperty(f,v,S){const C=this.getFragmentStyle(f);if(!C)return;const E=C.stylesheet.schema;if(!E||!E[v])return;const R=o.t(S);if(R.result!=="success")return void il(this,R.value);const B=R.value.expression,G=o.aj(v,C.scope),j=C.options.get(G);if(!j)return;let q;const{minValue:K,maxValue:te,stepValue:ne,type:le,values:se}=E[v],ue=o.t(E[v].default);ue.result==="success"&&(q=ue.value.expression),q?(this.options.set(G,{...j,value:B,default:q,minValue:K,maxValue:te,stepValue:ne,type:le,values:se}),this.updateConfigDependencies()):this.fire(new o.a(new Error(`No schema defined for the config option "${v}" in the "${f}" fragment.`)))}getConfig(f){const v=this.getFragmentStyle(f);if(!v)return null;const S=v.stylesheet.schema;if(!S)return null;const C={};for(const E in S){const R=o.aj(E,v.scope),B=v.options.get(R),G=B?B.value||B.default:null;C[E]=G?G.serialize():null}return C}setConfig(f,v){const S=this.getFragmentStyle(f);S&&(S.updateConfig(v,S.stylesheet.schema),this.updateConfigDependencies())}getSchema(f){const v=this.getFragmentStyle(f);return v?v.stylesheet.schema:null}setSchema(f,v){const S=this.getFragmentStyle(f);S&&(S.stylesheet.schema=v,S.updateConfig(S._config,v),this.updateConfigDependencies())}updateConfig(f,v){if(this._config=f,f||v)if(v)for(const S in v){let C,E;const R=o.t(v[S].default);if(R.result==="success"&&(C=R.value.expression),f&&f[S]!==void 0){const te=o.t(f[S]);te.result==="success"&&(E=te.value.expression)}const{minValue:B,maxValue:G,stepValue:j,type:q,values:K}=v[S];if(C){const te=o.aj(S,this.scope);this.options.set(te,{default:C,value:E,minValue:B,maxValue:G,stepValue:j,type:q,values:K})}else this.fire(new o.a(new Error(`No schema defined for config option "${S}".`)))}else this.fire(new o.a(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const f of this._configDependentLayers){const v=this.getLayer(f);v&&(v.possiblyEvaluateVisibility(),this._updateLayer(v))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this._changes.setDirty()}addLayer(f,v,S={}){this._checkLoaded();const C=f.id;if(this._layers[C])return void this.fire(new o.a(new Error(`Layer with id "${C}" already exists on this map`)));let E;if(f.type==="custom"){if(il(this,o.cb(f)))return;E=o.c7(f,this.scope,this.options)}else{if(typeof f.source=="object"&&(this.addSource(C,f.source),f=o.c6(f),f=o.e(f,{source:C})),this._validate(ke,`layers.${C}`,f,{arrayIndex:-1},S))return;E=o.c7(f,this.scope,this.options),this._validateLayer(E),E.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[E.id]=E.serialize()}E.isConfigDependent&&this._configDependentLayers.add(E.fqid);let R=this._order.length;if(v){const q=this._order.indexOf(v);if(q===-1)return void this.fire(new o.a(new Error(`Layer with id "${v}" does not exist on this map.`)));E.slot===this._layers[v].slot?R=q:o.w(`Layer with id "${v}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(R,0,C),this._layerOrderChanged=!0,this._layers[C]=E;const B=this.getOwnLayerSourceCache(E),G=!!this.directionalLight&&this.directionalLight.shadowsEnabled();B&&E.canCastShadows()&&G&&(B.castsShadows=!0);const j=this._changes.getRemovedLayer(E);if(j&&E.source&&B&&E.type!=="custom"){this._changes.discardLayerRemoval(E);const q=o.aj(E.source,E.scope);j.type!==E.type?this._changes.updateSourceCache(q,"clear"):(this._changes.updateSourceCache(q,"reload"),B.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),E.scope=this.scope,this.mergeLayers()}moveLayer(f,v){this._checkLoaded();const S=this._checkLayer(f);if(!S||f===v)return;const C=this._order.indexOf(f);this._order.splice(C,1);let E=this._order.length;if(v){const R=this._order.indexOf(v);if(R===-1)return void this.fire(new o.a(new Error(`Layer with id "${v}" does not exist on this map.`)));S.slot===this._layers[v].slot?E=R:o.w(`Layer with id "${v}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,f),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(f){this._checkLoaded();const v=this._checkLayer(f);if(!v)return;v.setEventedParent(null);const S=this._order.indexOf(f);this._order.splice(S,1),delete this._layers[f],delete this._serializedLayers[f],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(v.fqid),this._changes.removeLayer(v);const C=this.getOwnLayerSourceCache(v);if(C&&C.castsShadows){let E=!1;for(const R in this._layers)if(this._layers[R].source===v.source&&this._layers[R].canCastShadows()){E=!0;break}C.castsShadows=E}v.onRemove&&v.onRemove(this.map),this.mergeLayers()}getOwnLayer(f){return this._layers[f]}hasLayer(f){return f in this._mergedLayers}hasLayerType(f){for(const v in this._layers)if(this._layers[v].type===f)return!0;return!1}setLayerZoomRange(f,v,S){this._checkLoaded();const C=this._checkLayer(f);C&&(C.minzoom===v&&C.maxzoom===S||(v!=null&&(C.minzoom=v),S!=null&&(C.maxzoom=S),this._updateLayer(C)))}setSlot(f,v){this._checkLoaded();const S=this._checkLayer(f);S&&S.slot!==v&&(S.slot=v,this._updateLayer(S))}setFilter(f,v,S={}){this._checkLoaded();const C=this._checkLayer(f);if(C&&!d(C.filter,v))return v==null?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(tt,`layers.${C.id}.filter`,v,{layerType:C.type},S)||(C.filter=o.c6(v),this._updateLayer(C)))}getFilter(f){const v=this._checkLayer(f);if(v)return o.c6(v.filter)}setLayoutProperty(f,v,S,C={}){this._checkLoaded();const E=this._checkLayer(f);if(E&&!d(E.getLayoutProperty(v),S)){if(S!=null&&(!C||C.validate!==!1)&&il(E,St.call(ht,{key:`layers.${f}.layout.${v}`,layerType:E.type,objectKey:v,value:S,styleSpec:o.G,style:{glyphs:!0,sprite:!0}})))return;E.setLayoutProperty(v,S),E.isConfigDependent&&this._configDependentLayers.add(E.fqid),this._updateLayer(E)}}getLayoutProperty(f,v){const S=this._checkLayer(f);if(S)return S.getLayoutProperty(v)}setPaintProperty(f,v,S,C={}){this._checkLoaded();const E=this._checkLayer(f);if(!E||d(E.getPaintProperty(v),S)||S!=null&&(!C||C.validate!==!1)&&il(E,ut.call(ht,{key:`layers.${f}.paint.${v}`,layerType:E.type,objectKey:v,value:S,styleSpec:o.G})))return;const R=E.setPaintProperty(v,S);E.isConfigDependent&&this._configDependentLayers.add(E.fqid),R&&this._updateLayer(E),this._changes.updatePaintProperties(E)}getPaintProperty(f,v){const S=this._checkLayer(f);if(S)return S.getPaintProperty(v)}setFeatureState(f,v){this._checkLoaded();const S=f.source,C=f.sourceLayer,E=this._checkSource(S);if(!E)return;const R=E.type;if(R==="geojson"&&C)return void this.fire(new o.a(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(R==="vector"&&!C)return void this.fire(new o.a(new Error("The sourceLayer parameter must be provided for vector source types.")));f.id===void 0&&this.fire(new o.a(new Error("The feature id parameter must be provided.")));const B=this.getOwnSourceCaches(S);for(const G of B)G.setFeatureState(C,f.id,v)}removeFeatureState(f,v){this._checkLoaded();const S=f.source,C=this._checkSource(S);if(!C)return;const E=C.type,R=E==="vector"?f.sourceLayer:void 0;if(E==="vector"&&!R)return void this.fire(new o.a(new Error("The sourceLayer parameter must be provided for vector source types.")));if(v&&typeof f.id!="string"&&typeof f.id!="number")return void this.fire(new o.a(new Error("A feature id is required to remove its specific state property.")));const B=this.getOwnSourceCaches(S);for(const G of B)G.removeFeatureState(R,f.id,v)}getFeatureState(f){this._checkLoaded();const v=f.source,S=f.sourceLayer,C=this._checkSource(v);if(C){if(C.type!=="vector"||S)return f.id===void 0&&this.fire(new o.a(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(v)[0].getFeatureState(S,f.id);this.fire(new o.a(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(f){return this.stylesheet.transition=o.e({},this.stylesheet.transition,f),this.transition=this.stylesheet.transition,this}getTransition(){return o.e({},this.stylesheet.transition)}serialize(){this._checkLoaded();const f=this.getTerrain(),v=f&&this.terrain&&this.terrain.scope===this.scope?f:this.stylesheet.terrain;return o.cc({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:v,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},S=>S!==void 0)}_updateLayer(f){this._changes.updateLayer(f);const v=this.getLayerSourceCache(f),S=o.aj(f.source,f.scope),C=this._changes.getUpdatedSourceCaches();f.source&&!C[S]&&v&&v.getSource().type!=="raster"&&(this._changes.updateSourceCache(S,"reload"),v.pause()),f.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(f){const v=B=>this._mergedLayers[B].type==="fill-extrusion"||this._mergedLayers[B].type==="model",S=this.order,C={},E=[];for(let B=S.length-1;B>=0;B--){const G=S[B];if(v(G)){C[G]=B;for(const j of f){const q=j[G];if(q)for(const K of q)E.push(K)}}}E.sort((B,G)=>G.intersectionZ-B.intersectionZ);const R=[];for(let B=S.length-1;B>=0;B--){const G=S[B];if(v(G))for(let j=E.length-1;j>=0;j--){const q=E[j].feature;if(C[q.layer.id]<B)break;R.push(q),E.pop()}else for(const j of f){const q=j[G];if(q)for(const K of q)R.push(K.feature)}}return R}queryRenderedFeatures(f,v,S){v&&v.filter&&this._validate(tt,"queryRenderedFeatures.filter",v.filter,null,v),v.scope=this.scope,v.availableImages=this._availableImages,v.serializedLayers=this._serializedLayers;const C={};if(v&&v.layers){if(!Array.isArray(v.layers))return this.fire(new o.a(new Error("parameters.layers must be an Array."))),[];for(const j of v.layers){const q=this._mergedLayers[j];if(!q)return this.fire(new o.a(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];C[q.source]=!0}}const E=[],R=v.serializedLayers||{},B=v&&v.layers?v.layers.some(j=>{const q=this.getLayer(j);return q&&q.is3D()}):this.has3DLayers(),G=Ni.createFromScreenPoints(f,S);for(const j in this._mergedSourceCaches){const q=this._mergedSourceCaches[j].getSource();if(!q||q.scope!==v.scope)continue;const K=this._mergedSourceCaches[j].getSource().id;v.layers&&!C[K]||E.push(On(this._mergedSourceCaches[j],this._mergedLayers,R,G,v,S,B,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(j,q,K,te,ne,le,se){const ue={},ce=le.queryRenderedSymbols(te),ye=[];for(const Ce of Object.keys(ce).map(Number))ye.push(se[Ce]);ye.sort(lw);for(const Ce of ye){const Ae=Ce.featureIndex.lookupSymbolFeatures(ce[Ce.bucketInstanceId],q,Ce.bucketIndex,Ce.sourceLayerIndex,ne.filter,ne.layers,ne.availableImages,j);for(const De in Ae){const he=ue[De]=ue[De]||[],we=Ae[De];we.sort((Fe,ze)=>{const je=Ce.featureSortOrder;if(je){const it=je.indexOf(Fe.featureIndex);return je.indexOf(ze.featureIndex)-it}return ze.featureIndex-Fe.featureIndex});for(const Fe of we)he.push(Fe)}}for(const Ce in ue)ue[Ce].forEach(Ae=>{const De=Ae.feature,he=K(j[Ce]);if(!he)return;const we=he.getFeatureState(De.layer["source-layer"],De.id);De.source=De.layer.source,De.layer["source-layer"]&&(De.sourceLayer=De.layer["source-layer"]),De.state=we});return ue}(this._mergedLayers,R,this.getLayerSourceCache.bind(this),G.screenGeometry,v,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(f,v){v&&v.filter&&this._validate(tt,"querySourceFeatures.filter",v.filter,null,v);const S=this.getOwnSourceCaches(f);let C=[];for(const E of S)C=C.concat(mo(E,v));return C}addSourceType(f,v,S){return zs.getSourceType(f)?S(new Error(`A source type called "${f}" already exists.`)):(zs.setSourceType(f,v),v.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:f,url:v.workerSourceURL},S):S(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(f,v,S={}){this._checkLoaded();const C=this.light.getLight();let E=!1;for(const B in f)if(!d(f[B],C[B])){E=!0;break}if(!E)return;const R=this._getTransitionParameters();this.light.setLight(f,v,S),this.light.updateTransitions(R)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(f,v=1){if(this._checkLoaded(),!f)return this.terrainSetForDrapingOnly()&&v!==0||delete this.terrain,f===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let S=f;const C=f.source==null;if(v===1){if(typeof S.source=="object"){const B="terrain-dem-src";this.addSource(B,S.source),S=o.c6(S),S=o.e(S,{source:B})}const E=o.e({},S),R={};if(this.terrain&&C){E.source=this.terrain.get().source;const B=this.terrain?this.getFragmentStyle(this.terrain.scope):null;B&&(R.style=B.serialize())}if(this._validate(ge,"terrain",E,R))return}if(!this.terrain||this.terrain.scope!==this.scope&&!C||this.terrain&&v!==this.terrain.drapeRenderMode){if(!S)return;this._createTerrain(S,v),this.fire(new o.b("data",{dataType:"style"}))}else{const E=this.terrain,R=E.get();for(const B of Object.keys(o.G.terrain))!S.hasOwnProperty(B)&&o.G.terrain[B].default&&(S[B]=o.G.terrain[B].default);for(const B in f)if(!d(f[B],R[B])){E.set(f,this.options),this.stylesheet.terrain=f;const G=this._getTransitionParameters({duration:0});E.updateTransitions(G),this.fire(new o.b("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(f){const v=this.fog=new po(f,this.map.transform,this.scope,this.options);this.stylesheet.fog=v.get();const S=this._getTransitionParameters({duration:0});v.updateTransitions(S)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const f of this.map._markers)f._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(f){if(this._checkLoaded(),!f)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const v=this.fog;if(!d(v.get(),f)){v.set(f,this.options),this.stylesheet.fog=v.get();const S=this._getTransitionParameters({duration:0});v.updateTransitions(S)}}else this._createFog(f);this._markersNeedUpdate=!0}_getTransitionParameters(f){return{now:o.f.now(),transition:o.e(this.transition,f)}}updateDrapeFirstLayers(){if(!this.terrain)return;const f=[],v=[];for(const S in this._mergedLayers)this.isLayerDraped(this._mergedLayers[S])?f.push(S):v.push(S);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...f),this._drapedFirstOrder.push(...v)}_createTerrain(f,v){const S=this.terrain=new Nr(f,v,this.scope,this.options);v===1&&(this.stylesheet.terrain=f),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const C=this._getTransitionParameters({duration:0});S.updateTransitions(C)}_force3DLayerUpdate(){for(const f in this._layers){const v=this._layers[f];v.type==="fill-extrusion"&&this._updateLayer(v)}}_forceSymbolLayerUpdate(){for(const f in this._layers){const v=this._layers[f];v.type==="symbol"&&this._updateLayer(v)}}_validate(f,v,S,C,E={}){if(E&&E.validate===!1)return!1;const R=o.e({},this.serialize());return il(this,f.call(ht,o.e({key:v,style:R,value:S,styleSpec:o.G},C)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.cd.off("pluginStateChange",this._rtlTextPluginCallback);for(const f in this._mergedLayers)this._mergedLayers[f].setEventedParent(null);for(const f in this._mergedSourceCaches)this._mergedSourceCaches[f].clearTiles(),this._mergedSourceCaches[f].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(f){const v=this.getSourceCaches(f);for(const S of v)S.clearTiles()}clearSources(){for(const f in this._mergedSourceCaches)this._mergedSourceCaches[f].clearTiles()}reloadSource(f){const v=this.getSourceCaches(f);for(const S of v)S.resume(),S.reload()}reloadSources(){for(const f of this.getSources())f.reload&&f.reload()}updateSources(f){let v;this.directionalLight&&(v=Vv(this.directionalLight));for(const S in this._mergedSourceCaches)this._mergedSourceCaches[S].update(f,void 0,void 0,v)}_generateCollisionBoxes(){for(const f in this._sourceCaches){const v=this._sourceCaches[f];v.resume(),v.reload()}}_updatePlacement(f,v,S,C,E=!1){let R=!1,B=!1;const G={},j={};for(const q of this._mergedOrder){const K=this._mergedLayers[q];if(K.type!=="symbol")continue;const te=o.aj(K.source,K.scope);let ne=G[te];if(!ne){const se=this.getLayerSourceCache(K);if(!se)continue;const ue=se.getRenderableIds(!0).map(ce=>se.getTileByID(ce));j[te]=ue.slice(),ne=G[te]=ue.sort((ce,ye)=>ye.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(ye.tileID)?-1:1))}const le=this.crossTileSymbolIndex.addLayer(K,ne,f.center.lng,f.projection);R=R||le}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),E=E||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new o.b("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.f.now(),f.zoom))&&(this.pauseablePlacement=new Fd(f,this._mergedOrder,E,v,S,C,this.placement,this.fog&&f.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,G,j),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.f.now()),B=!0),R&&this.pauseablePlacement.placement.setStale()),B||R){this._buildingIndex.onNewFrame(f.zoom);for(const q of this._mergedOrder){const K=this._mergedLayers[q];K.type==="symbol"&&this.placement.updateLayerOpacities(K,G[o.aj(K.source,K.scope)])}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.f.now())}_releaseSymbolFadeTiles(){for(const f in this._sourceCaches)this._sourceCaches[f].releaseSymbolFadeTiles()}addImport(f,v){this._checkLoaded();const S=this.stylesheet.imports=this.stylesheet.imports||[];if(S.findIndex(({id:E})=>E===f.id)!==-1)return void this.fire(new o.a(new Error(`Import with id '${f.id}' already exists in the map's style.`)));if(!v)return S.push(f),this._loadImports([f],!0);const C=S.findIndex(({id:E})=>E===v);return C===-1&&this.fire(new o.a(new Error(`Import with id "${v}" does not exist on this map.`))),this.stylesheet.imports=S.slice(0,C).concat(f).concat(S.slice(C)),this._loadImports([f],!0,v)}updateImport(f,v){this._checkLoaded();const S=this.stylesheet.imports||[],C=this.getImportIndex(f);return C===-1?this:typeof v=="string"?(this.setImportUrl(f,v),this):(v.url&&v.url!==S[C].url&&this.setImportUrl(f,v.url),d(v.config,S[C].config)||this.setImportConfig(f,v.config),d(v.data,S[C].data)||this.setImportData(f,v.data),this)}moveImport(f,v){this._checkLoaded();let S=this.stylesheet.imports||[];const C=this.getImportIndex(f);if(C===-1)return this;const E=this.getImportIndex(v);if(E===-1)return this;const R=S[C],B=this.fragments[C];return S=S.filter(({id:G})=>G!==f),this.fragments=this.fragments.filter(({id:G})=>G!==f),this.stylesheet.imports=S.slice(0,E).concat(R).concat(S.slice(E)),this.fragments=this.fragments.slice(0,E).concat(B).concat(this.fragments.slice(E)),this.mergeLayers(),this}setImportUrl(f,v){this._checkLoaded();const S=this.stylesheet.imports||[],C=this.getImportIndex(f);if(C===-1)return this;S[C].url=v;const E=this.fragments[C];return E.style=this._createFragmentStyle(S[C]),E.style.on("style.import.load",()=>this.mergeAll()),E.style.loadURL(v),this}setImportData(f,v){this._checkLoaded();const S=this.getImportIndex(f),C=this.stylesheet.imports||[];return S===-1?this:v?(this.fragments[S].style.setState(v),this._reloadImports(),this):(delete C[S].data,this.setImportUrl(f,C[S].url))}setImportConfig(f,v){this._checkLoaded();const S=this.getImportIndex(f),C=this.stylesheet.imports||[];if(S===-1)return this;v?C[S].config=v:delete C[S].config;const E=this.fragments[S],R=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=v,E.style.updateConfig(v,R),this.updateConfigDependencies(),this}removeImport(f){this._checkLoaded();const v=this.stylesheet.imports||[],S=this.getImportIndex(f);S!==-1&&(v.splice(S,1),this.fragments[S].style._remove(),this.fragments.splice(S,1),this._reloadImports())}getImportIndex(f){const v=(this.stylesheet.imports||[]).findIndex(S=>S.id===f);return v===-1&&this.fire(new o.a(new Error(`Import '${f}' does not exist in the map's style and cannot be updated.`))),v}getLayer(f){return this._mergedLayers[f]}getSources(){const f=[];for(const v in this._mergedOtherSourceCaches){const S=this._mergedOtherSourceCaches[v];S&&f.push(S.getSource())}return f}getSource(f,v){const S=this.getSourceCache(f,v);return S&&S.getSource()}getLayerSource(f){const v=this.getLayerSourceCache(f);return v&&v.getSource()}getSourceCache(f,v){const S=o.aj(f,v);return this._mergedOtherSourceCaches[S]}getLayerSourceCache(f){const v=o.aj(f.source,f.scope);return f.type==="symbol"?this._mergedSymbolSourceCaches[v]:this._mergedOtherSourceCaches[v]}getSourceCaches(f){if(f==null)return Object.values(this._mergedSourceCaches);const v=[];return this._mergedOtherSourceCaches[f]&&v.push(this._mergedOtherSourceCaches[f]),this._mergedSymbolSourceCaches[f]&&v.push(this._mergedSymbolSourceCaches[f]),v}updateSourceCaches(){const f=this._changes.getUpdatedSourceCaches();for(const v in f){const S=f[v];S==="reload"?this.reloadSource(v):S==="clear"&&this.clearSource(v)}}updateLayers(f){const v=this._changes.getUpdatedPaintProperties();for(const S of v){const C=this.getLayer(S);C&&C.updateTransitions(f)}}getImages(f,v,S){this.imageManager.getImages(v.icons,v.scope,S),this._updateTilesForChangedImages();const C=E=>{E&&E.setDependencies(v.tileID.key,v.type,v.icons)};C(this._otherSourceCaches[v.source]),C(this._symbolSourceCaches[v.source])}getGlyphs(f,v,S){this.glyphManager.getGlyphs(v.stacks,v.scope,S)}getResource(f,v,S){return o.ce(v,S)}getOwnSourceCache(f){return this._otherSourceCaches[f]}getOwnLayerSourceCache(f){return f.type==="symbol"?this._symbolSourceCaches[f.source]:this._otherSourceCaches[f.source]}getOwnSourceCaches(f){const v=[];return this._otherSourceCaches[f]&&v.push(this._otherSourceCaches[f]),this._symbolSourceCaches[f]&&v.push(this._symbolSourceCaches[f]),v}_isSourceCacheLoaded(f){const v=this.getOwnSourceCaches(f);return v.length===0?(this.fire(new o.a(new Error(`There is no source with ID '${f}'`))),!1):v.every(S=>S.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(f=>{f.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}zs.getSourceType=function(w){return nr[w]},zs.setSourceType=function(w,f){nr[w]=f},zs.registerForPluginStateChange=o.bY;var Ud=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,jy=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}`,Uv=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Eu="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",$v=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Mc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Wy=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,$d=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Hv=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec4 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Hd=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,jv=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Jn=[];Du(Ud,Jn),Du(Uv,Jn),Du(jy,Jn);const cn={"_prelude_fog.vertex.glsl":Mc,"_prelude_terrain.vertex.glsl":$v,"_prelude_shadow.vertex.glsl":Hd,"_prelude_fog.fragment.glsl":Wy,"_prelude_shadow.fragment.glsl":jv,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":$d,"_prelude_raster_particle.glsl":Hv},jd={};dn("",$v),dn(Wy,Mc),dn(jv,Hd),dn($d,""),dn(Hv,"");const Wd=dn(jy,Uv),Wv=Ud;var Bs={background:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:dn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:dn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:dn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:dn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:dn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:dn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:dn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:dn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:dn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:dn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform mediump float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size.x/aspect;float segment_phase=pattern_len-mod((v_linesofar-v_pattern_data.x),pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in float a_linesofar;
#ifdef LINE_JOIN_NONE
in vec2 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform mediump float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width+=ANTIALIASING;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5/u_tile_units_to_pixels;v_linesofar+=line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:dn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:dn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:dn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp float speed=velocity==INVALID_VELOCITY ? 0.0 : length(velocity);highp float reset_rate_bump=speed*u_reset_rate;highp vec2 particle_pos_min=-u_particle_pos_offset;highp vec2 particle_pos_max=vec2(1.0)+u_particle_pos_offset;highp vec2 pos_drop_rate=vec2(1.0)-step(particle_pos_min,pos)+step(particle_pos_max,pos);highp float drop_rate=max(u_reset_rate+reset_rate_bump,length(pos_drop_rate));highp float drop=step(1.0-drop_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:dn(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
out_color*=alpha;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:dn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:dn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:dn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:dn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Eu),skyboxGradient:dn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Eu),skyboxCapture:dn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:dn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:dn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:dn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function Du(w,f){const v=w.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let S of v)if(S=S.trim(),S[0]==="#"&&S.includes("if")&&!S.includes("endif")){S=S.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const C=S.split(" ");for(const E of C)f.includes(E)||f.push(E)}}function dn(w,f){const v=/#include\s+"([^"]+)"/g,S=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let C=f.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);C&&(C=C.map(j=>{const q=j.split(" ");return q[q.length-1]}),C=[...new Set(C)]);const E={},R=[],B=[];if(w=w.replace(v,(j,q)=>(B.push(q),"")),(f=f.replace(v,(j,q)=>(R.push(q),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let G=[...Jn];Du(w,G),Du(f,G);for(const j of[...R,...B])cn[j]||console.error(`Undefined include: ${j}`),jd[j]||(jd[j]=[],Du(cn[j],jd[j])),G=[...G,...jd[j]];return{fragmentSource:w=w.replace(S,(j,q,K,te,ne)=>(E[ne]=!0,q==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
in ${K} ${te} ${ne};
#else
uniform ${K} ${te} u_${ne};
#endif
`:q==="initialize"?`
#ifdef HAS_UNIFORM_u_${ne}
    ${K} ${te} ${ne} = u_${ne};
#endif
`:q==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    in ${K} ${te} ${ne};
#endif
`:q==="initialize-attribute"?"":void 0)),vertexSource:f=f.replace(S,(j,q,K,te,ne)=>{const le=te==="float"?"vec2":te,se=ne.match(/color/)?"color":le;return q==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
in ${K} ${te} a_${ne};
#endif
`:E[ne]?q==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
in ${K} ${le} a_${ne};
out ${K} ${te} ${ne};
#else
uniform ${K} ${te} u_${ne};
#endif
`:q==="initialize"?se==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = a_${ne};
#else
    ${K} ${te} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = unpack_mix_${se}(a_${ne}, u_${ne}_t);
#else
    ${K} ${te} ${ne} = u_${ne};
#endif
`:q==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    in ${K} ${te} a_${ne};
    out ${K} ${te} ${ne};
#endif
`:q==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    ${ne} = a_${ne};
#endif
`:void 0:q==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
in ${K} ${le} a_${ne};
#else
uniform ${K} ${te} u_${ne};
#endif
`:q==="define-instanced"?se==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ne}0;
in vec4 a_${ne}1;
in vec4 a_${ne}2;
in vec4 a_${ne}3;
#else
uniform ${K} ${te} u_${ne};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${K} ${le} a_${ne};
#else
uniform ${K} ${te} u_${ne};
#endif
`:q==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    ${K} ${te} ${ne} = a_${ne};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${K} ${te} ${ne} = a_${ne};
#else
    ${K} ${te} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${K} ${te} ${ne} = unpack_mix_${se}(a_${ne}, u_${ne}_t);
#else
    ${K} ${te} ${ne} = u_${ne};
#endif
`}),staticAttributes:C,usedDefines:G,vertexIncludes:R,fragmentIncludes:B}}class pr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(f,v,S,C,E,R,B,G){this.context=f;let j=this.boundPaintVertexBuffers.length!==C.length;for(let K=0;!j&&K<C.length;K++)this.boundPaintVertexBuffers[K]!==C[K]&&(j=!0);let q=this.boundDynamicVertexBuffers.length!==B.length;for(let K=0;!q&&K<B.length;K++)this.boundDynamicVertexBuffers[K]!==B[K]&&(q=!0);if(!this.vao||this.boundProgram!==v||this.boundLayoutVertexBuffer!==S||j||q||this.boundIndexBuffer!==E||this.boundVertexOffset!==R)this.freshBind(v,S,C,E,R,B,G);else{f.bindVertexArrayOES.set(this.vao);for(const K of B)K&&(K.bind(),G&&K.instanceCount&&K.setVertexAttribDivisor(f.gl,v,G));E&&E.dynamicDraw&&E.bind()}}freshBind(f,v,S,C,E,R,B){const G=f.numAttributes,j=this.context,q=j.gl;this.vao&&this.destroy(),this.vao=j.gl.createVertexArray(),j.bindVertexArrayOES.set(this.vao),this.boundProgram=f,this.boundLayoutVertexBuffer=v,this.boundPaintVertexBuffers=S,this.boundIndexBuffer=C,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=R,v.enableAttributes(q,f),v.bind(),v.setVertexAttribPointers(q,f,E);for(const K of S)K.enableAttributes(q,f),K.bind(),K.setVertexAttribPointers(q,f,E);for(const K of R)K&&(K.enableAttributes(q,f),K.bind(),K.setVertexAttribPointers(q,f,E),B&&K.instanceCount&&K.setVertexAttribDivisor(q,f,B));C&&C.bind(),j.currentNumAttributes=G}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function qn(w,f){const v=Math.pow(2,f.canonical.z),S=f.canonical.y;return[new o.O(0,S/v).toLngLat().lat,new o.O(0,(S+1)/v).toLngLat().lat]}function Yn(w,f,v,S,C,E,R){const B=w.context,G=B.gl,j=v.hillshadeFBO;if(!j)return;w.prepareDrawTile();const q=w.isTileAffectedByFog(f),K=w.getOrCreateProgram("hillshade",{overrideFog:q});B.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,j.colorAttachment.get());const te=((ue,ce,ye,Ce)=>{const Ae=ye.paint.get("hillshade-shadow-color"),De=ye.paint.get("hillshade-highlight-color"),he=ye.paint.get("hillshade-accent-color"),we=ye.paint.get("hillshade-emissive-strength");let Fe=o.bm(ye.paint.get("hillshade-illumination-direction"));if(ye.paint.get("hillshade-illumination-anchor")==="viewport")Fe-=ue.transform.angle;else if(ue.style&&ue.style.enable3dLights()&&ue.style.directionalLight){const je=ue.style.directionalLight.properties.get("direction"),it=o.bT(je.x,je.y,je.z);Fe=o.bm(it[1])}const ze=!ue.options.moving;return{u_matrix:Ce||ue.transform.calculateProjMatrix(ce.tileID.toUnwrapped(),ze),u_image:0,u_latrange:qn(0,ce.tileID),u_light:[ye.paint.get("hillshade-exaggeration"),Fe],u_shadow:Ae,u_highlight:De,u_emissive_strength:we,u_accent:he}})(w,v,S,w.terrain?f.projMatrix:null);w.uploadCommonUniforms(B,K,f.toUnwrapped());const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:le,tileBoundsSegments:se}=w.getTileBoundsBuffers(v);K.draw(w,G.TRIANGLES,C,E,R,Vr.disabled,te,S.id,ne,le,se)}function Ho(w,f,v){if(!f.needsDEMTextureUpload)return;const S=w.context,C=S.gl;S.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||w.getTileTexture(v.stride);const E=v.getPixels();f.demTexture?f.demTexture.update(E,{premultiply:!1}):f.demTexture=new o.T(S,E,C.R32F,{premultiply:!1}),f.needsDEMTextureUpload=!1}function zh(w,f,v){const S=w.context,C=S.gl;if(!f.dem)return;const E=f.dem;if(S.activeTexture.set(C.TEXTURE1),Ho(w,f,E),!f.demTexture)return;f.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);const R=E.dim;S.activeTexture.set(C.TEXTURE0);let B=f.hillshadeFBO;if(!B){const te=new o.T(S,{width:R,height:R,data:null},C.RGBA);te.bind(C.LINEAR,C.CLAMP_TO_EDGE),B=f.hillshadeFBO=S.createFramebuffer(R,R,!0,"renderbuffer"),B.colorAttachment.set(te.texture)}S.bindFramebuffer.set(B.framebuffer),S.viewport.set([0,0,R,R]);const{tileBoundsBuffer:G,tileBoundsIndexBuffer:j,tileBoundsSegments:q}=w.getMercatorTileBoundsBuffers(),K=[];w.linearFloatFilteringSupported()&&K.push("TERRAIN_DEM_FLOAT_FORMAT"),w.getOrCreateProgram("hillshadePrepare",{defines:K}).draw(w,C.TRIANGLES,Pr.disabled,qr.disabled,fn.unblended,Vr.disabled,((te,ne)=>{const le=ne.stride,se=o.a9.create();return o.a9.ortho(se,0,o.Y,-o.Y,0,0,1),o.a9.translate(se,se,[0,-o.Y,0]),{u_matrix:se,u_image:1,u_dimension:[le,le],u_zoom:te.overscaledZ}})(f.tileID,E),v.id,G,j,q),f.needsHillshadePrepare=!1}const zn=w=>({u_matrix:new o.bN(w),u_image0:new o.bR(w),u_skirt_height:new o.bQ(w),u_ground_shadow_factor:new o.bP(w)}),Zd=(w,f,v)=>({u_matrix:w,u_image0:0,u_skirt_height:f,u_ground_shadow_factor:v}),Bh=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se)=>({u_proj_matrix:Float32Array.from(w),u_globe_matrix:f,u_normalize_matrix:Float32Array.from(S),u_merc_matrix:v,u_zoom_transition:C,u_merc_center:E,u_image0:0,u_frustum_tl:R,u_frustum_tr:B,u_frustum_br:G,u_frustum_bl:j,u_globe_pos:q,u_globe_radius:K,u_viewport:te,u_grid_matrix:se?Float32Array.from(se):new Float32Array(9),u_skirt_height:ne,u_far_z_cutoff:le});function Fh(w,f){return w!=null&&f!=null&&!(!w.hasData()||!f.hasData())&&w.demTexture!=null&&f.demTexture!=null&&w.tileID.key!==f.tileID.key}const Aa=new class{constructor(){this.operations={}}newMorphing(w,f,v,S,C){if(w in this.operations){const E=this.operations[w];E.to.tileID.key!==v.tileID.key&&(E.queued=v)}else this.operations[w]={startTime:S,phase:0,duration:C,from:f,to:v,queued:null}}getMorphValuesForProxy(w){if(!(w in this.operations))return null;const f=this.operations[w];return{from:f.from,to:f.to,phase:f.phase}}update(w){for(const f in this.operations){const v=this.operations[f];for(v.phase=(w-v.startTime)/v.duration;v.phase>=1||!this._validOp(v);)if(!this._nextOp(v,w)){delete this.operations[f];break}}}_nextOp(w,f){return!!w.queued&&(w.from=w.to,w.to=w.queued,w.queued=null,w.phase=0,w.startTime=f,!0)}_validOp(w){return w.from.hasData()&&w.to.hasData()}},Yi={0:null,1:"TERRAIN_VERTEX_MORPHING"};function bw(w,f,v){if(f===0)return 0;const S=f<1&&v===514?.25/f:1;return 6*Math.pow(1.5,22-w)*Math.max(f,1)*S}function qd(w,f){const v=1<<w.z;return!f&&(w.x===0||w.x===v-1)||w.y===0||w.y===v-1}const Yd=w=>({u_matrix:w});function Ic(w,f,v,S,C){if(C>0){const E=o.f.now(),R=(E-w.timeAdded)/C,B=f?(E-f.timeAdded)/C:-1,G=v.getSource(),j=S.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),q=!f||Math.abs(f.tileID.overscaledZ-j)>Math.abs(w.tileID.overscaledZ-j),K=q&&w.refreshedUponExpiration?1:o.ad(q?R:1-B,0,1);return w.refreshedUponExpiration&&R>=1&&(w.refreshedUponExpiration=!1),f?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}class Zy extends Rs{constructor(f){const v={type:"raster-dem",maxzoom:f.transform.maxZoom},S=new o.bZ(o.b_(),null),C=My("mock-dem",v,S,f.style);super("mock-dem",C,!1),C.setEventedParent(this),this._sourceLoaded=!0}_loadTile(f,v){f.state="loaded",v(null)}}class Zv extends Rs{constructor(f){const v=My("proxy",{type:"geojson",maxzoom:f.transform.maxZoom},new o.bZ(o.b_(),null),f.style);super("proxy",v,!1),v.setEventedParent(this),this.map=this.getSource().map=f,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(f,v,S){if(f.freezeTileCoverage)return;this.transform=f;const C=f.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,R)=>{if(E[R.key]="",!this._tiles[R.key]){const B=new Ls(R,this._source.tileSize*R.overscaleFactor(),f.tileZoom);B.state="loaded",this._tiles[R.key]=B}return E},{});for(const E in this._tiles)E in C||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(f){const v=this.proxyCachedFBO[f];if(v!==void 0){const S=Object.values(v);this.renderCachePool.push(...S),delete this.proxyCachedFBO[f]}}deallocRenderCache(){this.renderCache.forEach(f=>f.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ha extends o.ap{constructor(f,v,S){super(f.overscaledZ,f.wrap,f.canonical.z,f.canonical.x,f.canonical.y),this.proxyTileKey=v,this.projMatrix=S}}class jo extends o.cp{constructor(f,v){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},f.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),f.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),f.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=f,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[S,C,E]=function(G){const j=new o.aQ,q=new o.az,K=131;j.reserve(17161),q.reserve(33800);const te=o.Y/128,ne=o.Y+te/2,le=ne+te;for(let ue=-te;ue<le;ue+=te)for(let ce=-te;ce<le;ce+=te){const ye=ce<0||ce>ne||ue<0||ue>ne?24575:0,Ce=o.ad(Math.round(ce),0,o.Y),Ae=o.ad(Math.round(ue),0,o.Y);j.emplaceBack(Ce+ye,Ae)}const se=(ue,ce)=>{const ye=ce*K+ue;q.emplaceBack(ye+1,ye,ye+K),q.emplaceBack(ye+K,ye+K+1,ye+1)};for(let ue=1;ue<129;ue++)for(let ce=1;ce<129;ce++)se(ce,ue);return[0,129].forEach(ue=>{for(let ce=0;ce<130;ce++)se(ce,ue),se(ue,ce)}),[j,q,32768]}(),R=f.context;this.gridBuffer=R.createVertexBuffer(S,o.aS.members),this.gridIndexBuffer=R.createIndexBuffer(C),this.gridSegments=o.aE.simpleSegment(0,0,S.length,C.length),this.gridNoSkirtSegments=o.aE.simpleSegment(0,0,S.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Zv(v.map),this.orthoMatrix=o.a9.create(),o.a9.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.Y,0,o.Y,0,1);const B=R.gl;this._overlapStencilMode=new qr({func:B.GEQUAL,mask:255},0,255,B.KEEP,B.KEEP,B.REPLACE),this._previousZoom=f.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=v,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Zy(v.map),this._pendingGroundEffectLayers=[]}set style(f){f.on("data",this._onStyleDataEvent.bind(this)),this._style=f,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(f,v,S){if(f&&f.terrain){this._style!==f&&(this.style=f,this._evaluationZoom=void 0);const C=f.terrain.properties,E=f.terrain.drapeRenderMode===0,R=f.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.f.now();const B=f.terrain&&f.terrain.scope,G=C.get("source"),j=E?this._mockSourceCache:f.getSourceCache(G,B);if(!j)return void o.w(`Couldn't find terrain source "${G}".`);if(this.sourceCache=j,this._exaggeration=R?this.calculateExaggeration(v):C.get("exaggeration"),!v.projection.requiresDraping&&R&&this._exaggeration===0)return void this._disable();this.enabled=!0;const q=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const K=this.getScaledDemTileSize();this.sourceCache.update(v,K,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,q(),this._initializing=!0),q(),v.updateElevation(!0,S),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(v),this._emptyDEMTextureDirty=!0,this._previousZoom=v.zoom}else this._disable()}calculateExaggeration(f){const v=this._previousCameraAltitude,S=f.getFreeCameraOptions().position.z/f.pixelsPerMeter*f.worldSize;this._previousCameraAltitude=S;const C=v!=null?S-v:Number.MAX_VALUE;if(Math.abs(C)<2)return this._exaggeration;const E=f.zoom,R=this._style.terrain;if(!this._previousUpdateTimestamp)return R.getExaggeration(E);let B=E-this._previousZoom;const G=this._previousUpdateTimestamp;let j=E;this._evaluationZoom!=null&&(j=this._evaluationZoom,Math.abs(E-j)>.5&&(B=.5*(E-j+B)),B*C<0&&(j+=B)),this._evaluationZoom=j;const q=R.getExaggeration(j),K=q===R.getExaggeration(Math.max(0,j-.1));if(K&&Math.abs(q-this._exaggeration)<.01)return q;let te=Math.min(.1,.00375*(this._updateTimestamp-G));return(K||q<.1||Math.abs(B)<1e-4)&&(te=Math.min(.2,4*te)),o.X(this._exaggeration,q,te)}resetTileLookupCache(f){this._findCoveringTileCache[f]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(f){f.coord&&f.dataType==="source"?this._clearRenderCacheForTile(f.sourceCacheId,f.coord):f.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const f in this._style._mergedSourceCaches)this._style._mergedSourceCaches[f].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(f=>f.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const f=2*this.proxySourceCache.getSource().tileSize;return[f,f]}set useVertexMorphing(f){this._useVertexMorphing=f}updateTileBinding(f){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const v=this.proxySourceCache,S=this.painter.transform;this._initializing&&(this._initializing=S._centerAltitude===0&&this.getAtPointOrZero(o.O.fromLngLat(S.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const C=this.proxyCoords=v.getIds().map(G=>{const j=v.getTileByID(G).tileID;return j.projMatrix=S.calculateProjMatrix(j.toUnwrapped()),j});(function(G,j){const q=j.transform.pointCoordinate(j.transform.getCameraPoint()),K=new o.P(q.x,q.y);G.sort((te,ne)=>{if(ne.overscaledZ-te.overscaledZ)return ne.overscaledZ-te.overscaledZ;const le=new o.P(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),se=new o.P(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),ue=K.mult(1<<te.canonical.z);return ue.x-=.5,ue.y-=.5,ue.distSqr(le)-ue.distSqr(se)})})(C,this.painter);const E=this.proxyToSource||{};this.proxyToSource={},C.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const R=this._style._mergedSourceCaches;for(const G in R){const j=R[G];if(!j.used||(j!==this.sourceCache&&this.resetTileLookupCache(j.id),this._setupProxiedCoordsForOrtho(j,f[G],E),j.usedForTerrain))continue;const q=f[G];j.getSource().reparseOverscaled&&this._assignTerrainTiles(q)}this.proxiedCoords[v.id]=C.map(G=>new Ha(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(C),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1;const B={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const j=this.terrainTileForTile[G.key];if(!j)continue;const q=j.tileID.key;q in B||(this._visibleDemTiles.push(j),B[q]=q)}}_assignTerrainTiles(f){this._initializing||f.forEach(v=>{if(this.terrainTileForTile[v.key])return;const S=this._findTileCoveringTileID(v,this.sourceCache);S&&(this.terrainTileForTile[v.key]=S)})}_prepareDEMTextures(){const f=this.painter.context,v=f.gl;for(const S in this.terrainTileForTile){const C=this.terrainTileForTile[S],E=C.dem;!E||C.demTexture&&!C.needsDEMTextureUpload||(f.activeTexture.set(v.TEXTURE1),Ho(this.painter,C,E))}}_prepareDemTileUniforms(f,v,S,C){if(!v||v.demTexture==null)return!1;const E=f.tileID.canonical,R=Math.pow(2,v.tileID.canonical.z-E.z),B=C||"";return S[`u_dem_tl${B}`]=[E.x*R%1,E.y*R%1],S[`u_dem_scale${B}`]=R,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const f=this.painter.context,v=f.gl;if(!this._emptyDepthBufferTexture){const S=new o.h({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.T(f,S,v.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let f=0;const v=this._visibleDemTiles.reduce((S,C)=>{if(!C.dem)return S;const E=C.dem.tree.minimums[0];return E>0&&f++,S+E},0);return f?v/f:0}_updateEmptyDEMTexture(){const f=this.painter.context,v=f.gl;f.activeTexture.set(v.TEXTURE2);const S=this._getLoadedAreaMinimum(),[C,E]=(()=>{const B=new o.cr({width:1,height:1},new Float32Array([S]));return[v.R32F,B]})();this._emptyDEMTextureDirty=!1;let R=this._emptyDEMTexture;return R?R.update(E,{premultiply:!1}):R=this._emptyDEMTexture=new o.T(f,E,C,{premultiply:!1}),R}setupElevationDraw(f,v,S){const C=this.painter.context,E=C.gl,R={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};R.u_exaggeration=this.exaggeration();let B=null,G=null,j=1;if(S&&S.morphing&&this._useVertexMorphing){const te=S.morphing.srcDemTile,ne=S.morphing.dstDemTile;j=S.morphing.phase,te&&ne&&(this._prepareDemTileUniforms(f,te,R,"_prev")&&(G=te),this._prepareDemTileUniforms(f,ne,R)&&(B=ne))}const q=te=>te&&te.demTexture&&this.painter.linearFloatFilteringSupported()?E.LINEAR:E.NEAREST,K=te=>{R.u_dem_size=te.size[0]===1?1:te.size[0]-2};if(G&&B)C.activeTexture.set(E.TEXTURE2),B.demTexture.bind(q(B),E.CLAMP_TO_EDGE),C.activeTexture.set(E.TEXTURE4),G.demTexture.bind(q(G),E.CLAMP_TO_EDGE),B.demTexture&&K(B.demTexture),R.u_dem_lerp=j;else{B=this.terrainTileForTile[f.tileID.key],C.activeTexture.set(E.TEXTURE2);const te=this._prepareDemTileUniforms(f,B,R)?B.demTexture:this.emptyDEMTexture;te.bind(q(B),E.CLAMP_TO_EDGE),K(te)}if(C.activeTexture.set(E.TEXTURE3),S&&S.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(R.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),R.u_depth_size_inv=[1,1]),S&&S.useMeterToDem&&B){const te=(1<<B.tileID.canonical.z)*o.bo(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;R.u_meter_to_dem=te}if(S&&S.labelPlaneMatrixInv&&(R.u_label_plane_matrix_inv=S.labelPlaneMatrixInv),v.setTerrainUniformValues(C,R),this.painter.transform.projection.name==="globe"){const te=this.globeUniformValues(this.painter.transform,f.tileID.canonical,S&&S.useDenormalizedUpVectorScale);v.setGlobeUniformValues(C,te)}}globeUniformValues(f,v,S){const C=f.projection;return{u_tile_tl_up:C.upVector(v,0,0),u_tile_tr_up:C.upVector(v,o.Y,0),u_tile_br_up:C.upVector(v,o.Y,o.Y),u_tile_bl_up:C.upVector(v,0,o.Y),u_tile_up_scale:S?o.cq(1):C.upVectorScale(v,f.center.lat,f.worldSize).metersToTile}}renderToBackBuffer(f){const v=this.painter,S=this.painter.context;f.length!==0&&(S.bindFramebuffer.set(null),S.viewport.set([0,0,v.width,v.height]),v.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(C,E,R,B,G){if(C.transform.projection.name==="globe")(function(j,q,K,te,ne){const le=j.context,se=le.gl;let ue,ce;const ye=j.transform,Ce=o.ci(j,le,ye),Ae=(rt,st)=>{if(ce===st)return;const Ve=[Yi[st],"PROJECTION_GLOBE_VIEW"];Ce&&Ve.push("CUSTOM_ANTIALIASING");const Qe=j.isTileAffectedByFog(rt);ue=j.getOrCreateProgram("globeRaster",{defines:Ve,overrideFog:Qe}),ce=st},De=j.colorModeForRenderPass(),he=new Pr(se.LEQUAL,Pr.ReadWrite,j.depthRangeFor3D);Aa.update(ne);const we=o.cj(ye),Fe=[o.a8(ye.center.lng),o.ah(ye.center.lat)],ze=j.globeSharedBuffers,je=[ye.width*o.f.devicePixelRatio,ye.height*o.f.devicePixelRatio],it=Float32Array.from(ye.globeMatrix),Ge={useDenormalizedUpVectorScale:!0};{const rt=j.transform,st=bw(rt.zoom,q.exaggeration(),q.sourceCache._source.tileSize);ce=-1;const Ve=se.TRIANGLES;for(const Qe of te){const kt=K.getTile(Qe),Ze=qr.disabled,nt=q.prevTerrainTileForTile[Qe.key],ot=q.terrainTileForTile[Qe.key];Fh(nt,ot)&&Aa.newMorphing(Qe.key,nt,ot,ne,250),le.activeTexture.set(se.TEXTURE0),kt.texture&&kt.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Me=Aa.getMorphValuesForProxy(Qe.key),Tt=Me?1:0;Me&&o.k(Ge,{morphing:{srcDemTile:Me.from,dstDemTile:Me.to,phase:o.ch(Me.phase)}});const lr=o.ck(Qe.canonical),vr=o.cl(lr.getCenter().lat),Ar=o.cm(Qe.canonical,lr,vr,rt.worldSize/rt._pixelsPerMercatorPixel),xr=o.aW(o.cn(Qe.canonical)),Dr=Bh(rt.expandedFarZProjMatrix,it,we,xr,o.W(rt.zoom),Fe,rt.frustumCorners.TL,rt.frustumCorners.TR,rt.frustumCorners.BR,rt.frustumCorners.BL,rt.globeCenterInViewSpace,rt.globeRadius,je,st,rt._farZ,Ar);if(Ae(Qe,Tt),ue&&(q.setupElevationDraw(kt,ue,Ge),j.uploadCommonUniforms(le,ue,Qe.toUnwrapped()),ze)){const[Sn,Zr,Pn]=ze.getGridBuffers(vr,st!==0);ue.draw(j,Ve,he,Ze,De,Vr.backCCW,Dr,"globe_raster",Sn,Zr,Pn)}}}if(ze&&(j.renderDefaultNorthPole||j.renderDefaultSouthPole)){const rt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ce&&rt.push("CUSTOM_ANTIALIASING"),ue=j.getOrCreateProgram("globeRaster",{defines:rt});for(const st of te){const{x:Ve,y:Qe,z:kt}=st.canonical,Ze=Qe===0,nt=Qe===(1<<kt)-1,[ot,Me,Tt,lr]=ze.getPoleBuffers(kt,!1);if(lr&&(Ze||nt)){const vr=K.getTile(st);le.activeTexture.set(se.TEXTURE0),vr.texture&&vr.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);let Ar=o.co(kt,Ve,ye);const xr=o.aW(o.cn(st.canonical)),Dr=(Sn,Zr)=>Sn.draw(j,se.TRIANGLES,he,qr.disabled,De,Vr.disabled,Bh(ye.expandedFarZProjMatrix,Ar,Ar,xr,0,Fe,ye.frustumCorners.TL,ye.frustumCorners.TR,ye.frustumCorners.BR,ye.frustumCorners.BL,ye.globeCenterInViewSpace,ye.globeRadius,je,0,ye._farZ),"globe_pole_raster",Zr,Tt,lr);q.setupElevationDraw(vr,ue,Ge),j.uploadCommonUniforms(le,ue,st.toUnwrapped()),Ze&&j.renderDefaultNorthPole&&Dr(ue,ot),nt&&j.renderDefaultSouthPole&&(Ar=o.a9.scale(o.a9.create(),Ar,[1,-1,1]),Dr(ue,Me))}}}})(C,E,R,B,G);else{const j=C.context,q=j.gl;let K,te;const ne=C.shadowRenderer,le=Iu(C,C.longestCutoffRange),se=De=>{if(te===De)return;const he=[];he.push(Yi[De]),le.shouldRenderCutoff&&he.push("RENDER_CUTOFF"),K=C.getOrCreateProgram("terrainRaster",{defines:he}),te=De},ue=C.colorModeForRenderPass(),ce=new Pr(q.LEQUAL,Pr.ReadWrite,C.depthRangeFor3D);Aa.update(G);const ye=C.transform,Ce=bw(ye.zoom,E.exaggeration(),E.sourceCache._source.tileSize);let Ae=[0,0,0];if(ne){const De=C.style.directionalLight,he=C.style.ambientLight;De&&he&&(Ae=Uy(De,he))}{te=-1;const De=q.TRIANGLES,[he,we]=[E.gridIndexBuffer,E.gridSegments];for(const Fe of B){const ze=R.getTile(Fe),je=qr.disabled,it=E.prevTerrainTileForTile[Fe.key],Ge=E.terrainTileForTile[Fe.key];Fh(it,Ge)&&Aa.newMorphing(Fe.key,it,Ge,G,250),j.activeTexture.set(q.TEXTURE0),ze.texture&&ze.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE);const rt=Aa.getMorphValuesForProxy(Fe.key),st=rt?1:0;let Ve;rt&&(Ve={morphing:{srcDemTile:rt.from,dstDemTile:rt.to,phase:o.ch(rt.phase)}});const Qe=Zd(Fe.projMatrix,qd(Fe.canonical,ye.renderWorldCopies)?Ce/10:Ce,Ae);if(se(st),!K)continue;E.setupElevationDraw(ze,K,Ve);const kt=Fe.toUnwrapped();ne&&ne.setupShadows(kt,K),C.uploadCommonUniforms(j,K,kt,null,le),K.draw(C,De,ce,je,ue,Vr.backCCW,Qe,"terrain_raster",E.gridBuffer,he,we)}}}}(v,this,this.proxySourceCache,f,this._updateTimestamp),this.renderingToTexture=!0,v.gpuTimingDeferredRenderEnd(),f.splice(0,f.length))}renderBatch(f){if(this._drapedRenderBatches.length===0)return f+1;this.renderingToTexture=!0;const v=this.painter,S=this.painter.context,C=this.proxySourceCache,E=this.proxiedCoords[C.id],R=this._drapedRenderBatches.shift(),B=v.style.order,G=[];let j=0;for(const q of E){const K=C.getTileByID(q.proxyTileKey),te=C.proxyCachedFBO[q.key]?C.proxyCachedFBO[q.key][f]:void 0,ne=te!==void 0?C.renderCache[te]:this.pool[j++],le=te!==void 0;if(K.texture=ne.tex,le&&!ne.dirty){G.push(K.tileID);continue}let se;S.bindFramebuffer.set(ne.fb.framebuffer),this.renderedToTile=!1,ne.dirty&&(S.clear({color:o.aA.transparent,stencil:0}),ne.dirty=!1);for(let ue=R.start;ue<=R.end;++ue){const ce=v.style._mergedLayers[B[ue]];if(ce.isHidden(v.transform.zoom))continue;const ye=v.style.getLayerSourceCache(ce),Ce=ye?this.proxyToSource[q.key][ye.id]:[q];if(!Ce)continue;const Ae=Ce;S.viewport.set([0,0,ne.fb.width,ne.fb.height]),se!==(ye?ye.id:null)&&(this._setupStencil(ne,Ce,ce,ye),se=ye?ye.id:null),v.renderLayer(v,ye,ce,Ae)}if(this._drapedRenderBatches.length===0)for(const ue of this._pendingGroundEffectLayers){const ce=v.style._mergedLayers[B[ue]];if(ce.isHidden(v.transform.zoom))continue;const ye=v.style.getLayerSourceCache(ce),Ce=ye?this.proxyToSource[q.key][ye.id]:[q];if(!Ce)continue;const Ae=Ce;S.viewport.set([0,0,ne.fb.width,ne.fb.height]),se!==(ye?ye.id:null)&&(this._setupStencil(ne,Ce,ce,ye),se=ye?ye.id:null),v.renderLayer(v,ye,ce,Ae)}this.renderedToTile?(ne.dirty=!0,G.push(K.tileID)):le||--j,j===5&&(j=0,this.renderToBackBuffer(G))}return this.renderToBackBuffer(G),this.renderingToTexture=!1,S.bindFramebuffer.set(null),S.viewport.set([0,0,v.width,v.height]),R.end+1}postRender(){}isLayerOrderingCorrect(f){const v=f.order.length;let S=-1,C=v;for(let E=0;E<v;++E)this._style.isLayerDraped(f._mergedLayers[f.order[E]])?S=Math.max(S,E):C=Math.min(C,E);return C>S}getMinElevationBelowMSL(){let f=0;return this._visibleDemTiles.filter(v=>v.dem).forEach(v=>{f=Math.min(f,v.dem.tree.minimums[0])}),f===0?f:(f-30)*this._exaggeration}raycast(f,v,S){if(!this._visibleDemTiles)return null;const C=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const R=E.tileID,B=1<<R.overscaledZ,{x:G,y:j}=R.canonical,q=G/B,K=(G+1)/B,te=j/B,ne=(j+1)/B;return{minx:q,miny:te,maxx:K,maxy:ne,t:E.dem.tree.raycastRoot(q,te,K,ne,f,v,S),tile:E}});C.sort((E,R)=>(E.t!==null?E.t:Number.MAX_VALUE)-(R.t!==null?R.t:Number.MAX_VALUE));for(const E of C){if(E.t==null)return null;const R=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,f,v,S);if(R!=null)return R}return null}_createFBO(){const f=this.painter.context,v=f.gl,S=this.drapeBufferSize;f.activeTexture.set(v.TEXTURE0);const C=new o.T(f,{width:S[0],height:S[1],data:null},v.RGBA);C.bind(v.LINEAR,v.CLAMP_TO_EDGE);const E=f.createFramebuffer(S[0],S[1],!0,null);return E.colorAttachment.set(C.texture),E.depthAttachment=new jI(f,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=f.createRenderbuffer(f.gl.DEPTH_STENCIL,S[0],S[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),f.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),f.extTextureFilterAnisotropic&&v.texParameterf(v.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax),{fb:E,tex:C,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const f in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[f].hasTransition())return!0;return this._style.order.some(f=>{const v=this._style._mergedLayers[f],S=v.isHidden(this.painter.transform.zoom);return v.type==="custom"?!S&&v.shouldRedrape():!S&&v.hasTransition()})}_clearLineLayersFromRenderCache(){let f=!1;for(const S of this._style.getSources())if(S instanceof or){f=!0;break}if(!f)return;const v={};for(let S=0;S<this._style.order.length;++S){const C=this._style._mergedLayers[this._style.order[S]],E=this._style.getLayerSourceCache(C);if(E&&!v[E.id]&&!C.isHidden(this.painter.transform.zoom)&&C.type==="line"&&C.widthExpression()instanceof o.Z){v[E.id]=!0;for(const R of this.proxyCoords){const B=this.proxyToSource[R.key][E.id];if(B)for(const G of B)this._clearRenderCacheForTile(E.id,G)}}}}_clearRasterLayersFromRenderCache(){let f=!1;for(const S in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[S]._source instanceof sr){f=!0;break}if(!f)return;const v={};for(let S=0;S<this._style.order.length;++S){const C=this._style._mergedLayers[this._style.order[S]],E=this._style.getLayerSourceCache(C);if(!E||v[E.id]||C.isHidden(this.painter.transform.zoom)||C.type!=="raster")continue;const R=C.paint.get("raster-fade-duration");for(const B of this.proxyCoords){const G=this.proxyToSource[B.key][E.id];if(G)for(const j of G){const q=Ic(E.getTile(j),E.findLoadedParent(j,0),E,this.painter.transform,R);(q.opacity!==1||q.mix!==0)&&this._clearRenderCacheForTile(E.id,j)}}}}_setupDrapedRenderBatches(){const f=this._style.order,v=f.length;if(v===0)return;const S=[];this._pendingGroundEffectLayers=[];let C,E=0,R=this._style._mergedLayers[f[E]];for(;!this._style.isLayerDraped(R)&&R.isHidden(this.painter.transform.zoom)&&++E<v;)R=this._style._mergedLayers[f[E]];for(;E<v;++E){const B=this._style._mergedLayers[f[E]];B.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(B)?C===void 0&&(C=E):(B.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(E),C!==void 0&&(S.push({start:C,end:E-1}),C=void 0)))}if(C!==void 0&&S.push({start:C,end:E-1}),S.length!==0){const B=S[S.length-1];this._pendingGroundEffectLayers.every(G=>G>B.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=S}_setupRenderCache(f){const v=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,v.renderCache.length>v.renderCachePool.length){const R=Object.values(v.proxyCachedFBO);v.proxyCachedFBO={};for(let B=0;B<R.length;++B){const G=Object.values(R[B]);v.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const S=this.proxyCoords,C=this._tilesDirty;for(let R=S.length-1;R>=0;R--){const B=S[R];if(v.getTileByID(B.key),v.proxyCachedFBO[B.key]!==void 0){const G=f[B.key],j=this.proxyToSource[B.key];let q=0;for(const K in j){const te=j[K],ne=G[K];if(!ne||ne.length!==te.length||te.some((le,se)=>le!==ne[se]||C[K]&&C[K].hasOwnProperty(le.key))){q=-1;break}++q}for(const K in v.proxyCachedFBO[B.key])v.renderCache[v.proxyCachedFBO[B.key][K]].dirty=q<0||q!==Object.values(G).length}}const E=[...this._drapedRenderBatches];E.sort((R,B)=>B.end-B.start-(R.end-R.start));for(const R of E)for(const B of S){if(v.proxyCachedFBO[B.key])continue;let G=v.renderCachePool.pop();G===void 0&&v.renderCache.length<50&&(G=v.renderCache.length,v.renderCache.push(this._createFBO())),G!==void 0&&(v.proxyCachedFBO[B.key]={},v.proxyCachedFBO[B.key][R.start]=G,v.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(f,v,S,C){if(!C||!this._sourceTilesOverlap[C.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,R=E.gl;if(v.length<=1)return void(this._overlapStencilType=!1);let B;if(S.isTileClipped())B=v.length,this._overlapStencilMode.test={func:R.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(v[0].overscaledZ>v[v.length-1].overscaledZ))return void(this._overlapStencilType=!1);B=1,this._overlapStencilMode.test={func:R.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+B>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=B,this._overlapStencilMode.ref=this._stencilRef,S.isTileClipped()&&this._renderTileClippingMasks(v,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(f){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[f.key]),this._overlapStencilMode):qr.disabled}_renderTileClippingMasks(f,v){const S=this.painter,C=this.painter.context,E=C.gl;S._tileClippingMaskIDs={},C.setColorMode(fn.disabled),C.setDepthMode(Pr.disabled);const R=S.getOrCreateProgram("clippingMask");for(const B of f){const G=S._tileClippingMaskIDs[B.key]=--v;R.draw(S,E.TRIANGLES,Pr.disabled,new qr({func:E.ALWAYS,mask:0},G,255,E.KEEP,E.KEEP,E.REPLACE),fn.disabled,Vr.disabled,Yd(B.projMatrix),"$clipping",S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}}pointCoordinate(f){const v=this.painter.transform;if(f.x<0||f.x>v.width||f.y<0||f.y>v.height)return null;const S=[f.x,f.y,1,1];o.aa.transformMat4(S,S,v.pixelMatrixInverse),o.aa.scale(S,S,1/S[3]),S[0]/=v.worldSize,S[1]/=v.worldSize;const C=v._camera.position,E=o.bo(1,v.center.lat),R=[C[0],C[1],C[2]/E,0],B=o.Q.subtract([],S.slice(0,3),R);o.Q.normalize(B,B);const G=this.raycast(R,B,this._exaggeration);return G!==null&&G?(o.Q.scaleAndAdd(R,R,B,G),R[3]=R[2],R[2]*=E,R):null}drawDepth(){const f=this.painter,v=f.context,S=this.proxySourceCache,C=Math.ceil(f.width),E=Math.ceil(f.height);if(!this._depthFBO||this._depthFBO.width===C&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const R=v.gl,B=v.createFramebuffer(C,E,!0,"renderbuffer");v.activeTexture.set(R.TEXTURE0);const G=new o.T(v,{width:C,height:E,data:null},R.RGBA);G.bind(R.NEAREST,R.CLAMP_TO_EDGE),B.colorAttachment.set(G.texture);const j=v.createRenderbuffer(v.gl.DEPTH_COMPONENT16,C,E);B.depthAttachment.set(j),this._depthFBO=B,this._depthTexture=G}v.bindFramebuffer.set(this._depthFBO.framebuffer),v.viewport.set([0,0,C,E]),function(R,B,G,j){if(R.transform.projection.name==="globe")return;const q=R.context,K=q.gl;q.clear({depth:1});const te=R.getOrCreateProgram("terrainDepth"),ne=new Pr(K.LESS,Pr.ReadWrite,R.depthRangeFor3D);for(const le of j){const se=G.getTile(le),ue=Zd(le.projMatrix,0,[0,0,0]);B.setupElevationDraw(se,te),te.draw(R,K.TRIANGLES,ne,qr.disabled,fn.unblended,Vr.backCCW,ue,"terrain_depth",B.gridBuffer,B.gridIndexBuffer,B.gridNoSkirtSegments)}}(f,this,S,this.proxyCoords)}_setupProxiedCoordsForOrtho(f,v,S){if(f.getSource()instanceof o.as)return this._setupProxiedCoordsForImageSource(f,v,S);this._findCoveringTileCache[f.id]=this._findCoveringTileCache[f.id]||{};const C=this.proxiedCoords[f.id]=[],E=this.proxyCoords;for(let G=0;G<E.length;G++){const j=E[G],q=this._findTileCoveringTileID(j,f);if(q){const K=this._createProxiedId(j,q,S[j.key]&&S[j.key][f.id]);C.push(K),this.proxyToSource[j.key][f.id]=[K]}}let R=!1;const B=new Set;for(let G=0;G<v.length;G++){const j=f.getTile(v[G]);if(!j||!j.hasData())continue;const q=this._findTileCoveringTileID(j.tileID,this.proxySourceCache);if(q&&q.tileID.canonical.z!==j.tileID.canonical.z){const K=this.proxyToSource[q.tileID.key][f.id],te=this._createProxiedId(q.tileID,j,S[q.tileID.key]&&S[q.tileID.key][f.id]);K?K.splice(K.length-1,0,te):this.proxyToSource[q.tileID.key][f.id]=[te];const ne=this.proxyToSource[q.tileID.key][f.id];B.has(ne)||B.add(ne),C.push(te),R=!0}}if(this._sourceTilesOverlap[f.id]=R,R&&this._debugParams.sortTilesHiZFirst)for(const G of B)G.sort((j,q)=>q.overscaledZ-j.overscaledZ)}_setupProxiedCoordsForImageSource(f,v,S){if(!f.getSource().loaded())return;const C=this.proxiedCoords[f.id]=[],E=this.proxyCoords,R=f.getSource(),B=R.tileID;if(!B)return;const G=new o.P(B.x,B.y)._div(1<<B.z),j=R.coordinates.map(o.O.fromLngLat).reduce((K,te)=>(K.min.x=Math.min(K.min.x,te.x-G.x),K.min.y=Math.min(K.min.y,te.y-G.y),K.max.x=Math.max(K.max.x,te.x-G.x),K.max.y=Math.max(K.max.y,te.y-G.y),K),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),q=(K,te)=>{const ne=K.wrap+K.canonical.x/(1<<K.canonical.z),le=K.canonical.y/(1<<K.canonical.z),se=o.Y/(1<<K.canonical.z),ue=te.wrap+te.canonical.x/(1<<te.canonical.z),ce=te.canonical.y/(1<<te.canonical.z);return ne+se<ue+j.min.x||ne>ue+j.max.x||le+se<ce+j.min.y||le>ce+j.max.y};for(let K=0;K<E.length;K++){const te=E[K];for(let ne=0;ne<v.length;ne++){const le=f.getTile(v[ne]);if(!le||!le.hasData()||q(te,le.tileID))continue;const se=this._createProxiedId(te,le,S[te.key]&&S[te.key][f.id]),ue=this.proxyToSource[te.key][f.id];ue?ue.push(se):this.proxyToSource[te.key][f.id]=[se],C.push(se)}}}_createProxiedId(f,v,S){let C=this.orthoMatrix;if(S){const E=S.find(R=>R.key===v.tileID.key);if(E)return E}if(v.tileID.key!==f.key){const E=f.canonical.z-v.tileID.canonical.z;let R,B,G;C=o.a9.create();const j=v.tileID.wrap-f.wrap<<f.overscaledZ;E>0?(R=o.Y>>E,B=R*((v.tileID.canonical.x<<E)-f.canonical.x+j),G=R*((v.tileID.canonical.y<<E)-f.canonical.y)):(R=o.Y<<-E,B=o.Y*(v.tileID.canonical.x-(f.canonical.x+j<<-E)),G=o.Y*(v.tileID.canonical.y-(f.canonical.y<<-E))),o.a9.ortho(C,0,R,0,R,0,1),o.a9.translate(C,C,[B,G,0])}return new Ha(v.tileID,f.key,C)}_findTileCoveringTileID(f,v){let S=v.getTile(f);if(S&&S.hasData())return S;const C=this._findCoveringTileCache[v.id],E=C[f.key];if(S=E?v.getTileByID(E):null,S&&S.hasData()||E===null)return S;let R=S?S.tileID:f,B=R.overscaledZ;const G=v.getSource().minzoom,j=[];if(!E){const K=v.getSource().maxzoom;if(f.canonical.z>=K){const te=f.canonical.z-K;v.getSource().reparseOverscaled?(B=Math.max(f.canonical.z+2,v.transform.tileZoom),R=new o.ap(B,f.wrap,K,f.canonical.x>>te,f.canonical.y>>te)):te!==0&&(B=K,R=new o.ap(B,f.wrap,K,f.canonical.x>>te,f.canonical.y>>te))}R.key!==f.key&&(j.push(R.key),S=v.getTile(R))}const q=K=>{j.forEach(te=>{C[te]=K}),j.length=0};for(B-=1;B>=G&&(!S||!S.hasData());B--){S&&q(S.tileID.key);const K=R.calculateScaledKey(B);if(S=v.getTileByID(K),S&&S.hasData())break;const te=C[K];if(te===null)break;te===void 0?j.push(K):S=v.getTileByID(te)}return q(S?S.tileID.key:null),S&&S.hasData()?S:null}findDEMTileFor(f){return this.enabled?this._findTileCoveringTileID(f,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(f,v){let S=this._tilesDirty[f];S||(S=this._tilesDirty[f]={}),S[v.key]=!0}}function ww(w,f,v){const S=function(B,G,j){const q=o.Q.dot(G,B),K=o.Q.dot(j,[.2126,.7152,.0722]),te=(le,se,ue)=>(1-ue)*le+ue*se,ne=te(1-.3*Math.min(K,1),1,Math.min(q+1,1));return te(.92,1,Math.asin(o.ad(G[2],-1,1))/Math.PI+.5)*ne}(w,[0,0,1],f),C=[0,0,0];o.Q.scale(C,v.slice(0,3),S);const E=[0,0,0];o.Q.scale(E,f.slice(0,3),w[2]);const R=[0,0,0];return o.Q.add(R,C,E),o.bX(R)}const Nh=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],la=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class cs{static cacheKey(f,v,S,C){let E=`${v}${C?C.cacheKey:""}`;for(const R of S)f.usedDefines.includes(R)&&(E+=`/${R}`);return E}constructor(f,v,S,C,E,R){const B=f.gl;this.program=B.createProgram(),this.configuration=C,this.name=v,this.fixedDefines=[...R];const G=C?C.getBinderAttributes():[],j=(S.staticAttributes||[]).concat(G);let q=C?C.defines():[];q=q.concat(R.map(ue=>`#define ${ue}`));const K=`#version 300 es
`;let te=K+q.concat("precision mediump float;",Wv,Wd.fragmentSource).join(`
`);for(const ue of S.fragmentIncludes)te+=`
${cn[ue]}`;te+=`
${S.fragmentSource}`;let ne=K+q.concat("precision highp float;",Wv,Wd.vertexSource).join(`
`);for(const ue of S.vertexIncludes)ne+=`
${cn[ue]}`;ne+=`
${S.vertexSource}`;const le=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);B.shaderSource(le,te),B.compileShader(le),B.attachShader(this.program,le);const se=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(se,ne),B.compileShader(se),B.attachShader(this.program,se),this.attributes={},this.numAttributes=j.length;for(let ue=0;ue<this.numAttributes;ue++)if(j[ue]){const ce=j[ue].startsWith("a_")?j[ue]:`a_${j[ue]}`;B.bindAttribLocation(this.program,ue,ce),this.attributes[ce]=ue}B.linkProgram(this.program),B.deleteShader(se),B.deleteShader(le),this.fixedUniforms=E(f),this.binderUniforms=C?C.getUniforms(f):[],R.includes("TERRAIN")&&(this.terrainUniforms=(ue=>({u_dem:new o.bR(ue),u_dem_prev:new o.bR(ue),u_dem_tl:new o.bO(ue),u_dem_scale:new o.bQ(ue),u_dem_tl_prev:new o.bO(ue),u_dem_scale_prev:new o.bQ(ue),u_dem_size:new o.bQ(ue),u_dem_lerp:new o.bQ(ue),u_exaggeration:new o.bQ(ue),u_depth:new o.bR(ue),u_depth_size_inv:new o.bO(ue),u_meter_to_dem:new o.bQ(ue),u_label_plane_matrix_inv:new o.bN(ue)}))(f)),R.includes("GLOBE")&&(this.globeUniforms=(ue=>({u_tile_tl_up:new o.bP(ue),u_tile_tr_up:new o.bP(ue),u_tile_br_up:new o.bP(ue),u_tile_bl_up:new o.bP(ue),u_tile_up_scale:new o.bQ(ue)}))(f)),R.includes("FOG")&&(this.fogUniforms=(ue=>({u_fog_matrix:new o.bN(ue),u_fog_range:new o.bO(ue),u_fog_color:new o.bS(ue),u_fog_horizon_blend:new o.bQ(ue),u_fog_vertical_limit:new o.bO(ue),u_fog_temporal_offset:new o.bQ(ue),u_frustum_tl:new o.bP(ue),u_frustum_tr:new o.bP(ue),u_frustum_br:new o.bP(ue),u_frustum_bl:new o.bP(ue),u_globe_pos:new o.bP(ue),u_globe_radius:new o.bQ(ue),u_globe_transition:new o.bQ(ue),u_is_globe:new o.bR(ue),u_viewport:new o.bO(ue)}))(f)),R.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ue=>({u_cutoff_params:new o.bS(ue)}))(f)),R.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ue=>({u_lighting_ambient_color:new o.bP(ue),u_lighting_directional_dir:new o.bP(ue),u_lighting_directional_color:new o.bP(ue),u_ground_radiance:new o.bP(ue)}))(f)),R.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ue=>({u_light_matrix_0:new o.bN(ue),u_light_matrix_1:new o.bN(ue),u_fade_range:new o.bO(ue),u_shadow_normal_offset:new o.bP(ue),u_shadow_intensity:new o.bQ(ue),u_shadow_texel_size:new o.bQ(ue),u_shadow_map_resolution:new o.bQ(ue),u_shadow_direction:new o.bP(ue),u_shadow_bias:new o.bP(ue),u_shadowmap_0:new o.bR(ue),u_shadowmap_1:new o.bR(ue)}))(f))}}setTerrainUniformValues(f,v){if(!this.terrainUniforms)return;const S=this.terrainUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const C in v)S[C]&&S[C].set(this.program,C,v[C])}}setGlobeUniformValues(f,v){if(!this.globeUniforms)return;const S=this.globeUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const C in v)S[C]&&S[C].set(this.program,C,v[C])}}setFogUniformValues(f,v){if(!this.fogUniforms)return;const S=this.fogUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const C in v)S[C].set(this.program,C,v[C])}}setCutoffUniformValues(f,v){if(!this.cutoffUniforms)return;const S=this.cutoffUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const C in v)S[C].set(this.program,C,v[C])}}setLightsUniformValues(f,v){if(!this.lightsUniforms)return;const S=this.lightsUniforms;if(!this.failedToCreate){f.program.set(this.program);for(const C in v)S[C].set(this.program,C,v[C])}}setShadowUniformValues(f,v){if(this.failedToCreate||!this.shadowUniforms)return;const S=this.shadowUniforms;f.program.set(this.program);for(const C in v)S[C].set(this.program,C,v[C])}_drawDebugWireframe(f,v,S,C,E,R,B,G,j,q){const K=f.options.wireframe;if(K.terrain===!1&&K.layers2D===!1&&K.layers3D===!1)return;const te=f.context;if(!(!(!K.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!K.layers2D||f._terrain&&f._terrain.renderingToTexture||!Nh.includes(this.name))||!(!K.layers3D||!la.includes(this.name))))return;const ne=te.gl,le=f.wireframeDebugCache.getLinesFromTrianglesBuffer(f.frameCounter,E,te);if(!le)return;const se=[...this.fixedDefines];se.push("DEBUG_WIREFRAME");const ue=f.getOrCreateProgram(this.name,{config:this.configuration,defines:se});te.program.set(ue.program);const ce=(Ae,De,he)=>{if(De[Ae]&&he[Ae])for(const we in De[Ae])he[Ae][we]&&he[Ae][we].set(he.program,we,De[Ae][we].current)};j&&j.setUniforms(ue.program,te,ue.binderUniforms,B,{zoom:G}),ce("fixedUniforms",this,ue),ce("terrainUniforms",this,ue),ce("globeUniforms",this,ue),ce("fogUniforms",this,ue),ce("lightsUniforms",this,ue),ce("shadowUniforms",this,ue),le.bind(),te.setColorMode(new fn([ne.ONE,ne.ONE_MINUS_SRC_ALPHA,ne.ZERO,ne.ONE],o.aA.transparent,[!0,!0,!0,!1])),te.setDepthMode(new Pr(v.func===ne.LESS?ne.LEQUAL:v.func,Pr.ReadOnly,v.range)),te.setStencilMode(qr.disabled);const ye=3*R.primitiveLength*2,Ce=3*R.primitiveOffset*2*2;q&&q>1?ne.drawElementsInstanced(ne.LINES,ye,ne.UNSIGNED_SHORT,Ce,q):ne.drawElements(ne.LINES,ye,ne.UNSIGNED_SHORT,Ce),E.bind(),te.program.set(this.program),te.setDepthMode(v),te.setStencilMode(S),te.setColorMode(C)}draw(f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue){const ce=f.context,ye=ce.gl;if(this.failedToCreate)return;ce.program.set(this.program),ce.setDepthMode(S),ce.setStencilMode(C),ce.setColorMode(E),ce.setCullFace(R);for(const De of Object.keys(this.fixedUniforms))this.fixedUniforms[De].set(this.program,De,B[De]);le&&le.setUniforms(this.program,ce,this.binderUniforms,te,{zoom:ne});const Ce={[ye.POINTS]:1,[ye.LINES]:2,[ye.TRIANGLES]:3,[ye.LINE_STRIP]:1}[v],Ae=ue&&ue>0?1:void 0;for(const De of K.get()){const he=De.vaos||(De.vaos={});(he[G]||(he[G]=new pr)).bind(ce,this,j,le?le.getPaintVertexBuffers():[],q,De.vertexOffset,se||[],Ae),ue&&ue>1?ye.drawElementsInstanced(v,De.primitiveLength*Ce,ye.UNSIGNED_SHORT,De.primitiveOffset*Ce*2,ue):q?ye.drawElements(v,De.primitiveLength*Ce,ye.UNSIGNED_SHORT,De.primitiveOffset*Ce*2):ye.drawArrays(v,De.vertexOffset,De.vertexLength),v===ye.TRIANGLES&&q&&this._drawDebugWireframe(f,S,C,E,q,De,te,ne,le,ue)}}}function al(w,f){const v=Math.pow(2,f.tileID.overscaledZ),S=f.tileSize*Math.pow(2,w.transform.tileZoom)/v,C=S*(f.tileID.canonical.x+f.tileID.wrap*v),E=S*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture?f.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.a6(f,1,w.transform.tileZoom),u_pixel_coord_upper:[C>>16,E>>16],u_pixel_coord_lower:[65535&C,65535&E]}}const _a=o.a9.create(),qv=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se)=>{const ue=f.style.light,ce=ue.properties.get("position"),ye=[ce.x,ce.y,ce.z],Ce=o.ct.create();ue.properties.get("anchor")==="viewport"&&(o.ct.fromRotation(Ce,-f.transform.angle),o.Q.transformMat3(ye,ye,Ce));const Ae=ue.properties.get("color"),De=f.transform,he={u_matrix:w,u_lightpos:ye,u_lightintensity:ue.properties.get("intensity"),u_lightcolor:[Ae.r,Ae.g,Ae.b],u_vertical_gradient:+v,u_opacity:S,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:_a,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:C,u_edge_radius:E,u_flood_light_color:K,u_vertical_scale:te,u_flood_light_intensity:ne,u_ground_shadow_factor:le,u_emissive_strength:se};return De.projection.name==="globe"&&(he.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],he.u_zoom_transition=G,he.u_inv_rot_matrix=q,he.u_merc_center=j,he.u_up_dir=De.projection.upVector(new o.bv(0,0,0),j[0]*o.Y,j[1]*o.Y),he.u_height_lift=B),he},Fs=(w,f,v)=>({u_matrix:w,u_edge_radius:f,u_vertical_scale:v}),Xd=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne)=>{const le=qv(w,f,v,S,C,E,R,G,j,q,K,te,ne,1,[0,0,0],0),se={u_height_factor:-Math.pow(2,R.overscaledZ)/B.tileSize/8};return o.e(le,al(f,B),se)},Vh=(w,f)=>({u_matrix:w,u_emissive_strength:f}),Pu=(w,f,v,S)=>o.e(Vh(w,f),al(v,S)),XI=(w,f,v)=>({u_matrix:w,u_world:v,u_emissive_strength:f}),Wl=(w,f,v,S,C)=>o.e(Pu(w,f,v,S),{u_world:C}),QI=(w,f,v,S)=>{const C=o.Y/v.tileSize;return{u_matrix:w,u_camera_to_center_distance:f.getCameraToCenterDistance(S),u_extrude_scale:[f.pixelsToGLUnits[0]/C,f.pixelsToGLUnits[1]/C]}},qy=(w,f,v=1)=>({u_matrix:w,u_color:f,u_overlay:0,u_overlay_scale:v}),Io=o.a9.create(),KI=(w,f,v,S,C,E,R)=>{const B=w.transform,G=B.projection.name==="globe",j=G?o.cu(B.zoom,f.canonical)*B._pixelsPerMercatorPixel:o.a6(v,1,E),q={u_matrix:f.projMatrix,u_extrude_scale:j,u_intensity:R,u_inv_rot_matrix:Io,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){q.u_inv_rot_matrix=S,q.u_merc_center=C,q.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],q.u_zoom_transition=o.W(B.zoom);const K=C[0]*o.Y,te=C[1]*o.Y;q.u_up_dir=B.projection.upVector(new o.bv(0,0,0),K,te)}return q};function Qd(w,[f,v,S,C],[E,R]){if(E===R)return[0,0,0,0];const B=255*(w-1)/(w*(R-E));return[f*B,v*B,S*B,C*B]}function Yy(w,f,[v,S]){return v===S?0:.5/w+(f-v)*(w-1)/(w*(S-v))}const Sw=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue,ce,ye,Ce,Ae)=>({u_matrix:w,u_normalize_matrix:f,u_globe_matrix:v,u_merc_matrix:S,u_grid_matrix:C,u_tl_parent:E,u_scale_parent:j,u_fade_t:q.mix,u_opacity:q.opacity*K.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:K.paint.get("raster-brightness-min"),u_brightness_high:K.paint.get("raster-brightness-max"),u_saturation_factor:o.cv(K.paint.get("raster-saturation")),u_contrast_factor:o.cw(K.paint.get("raster-contrast")),u_spin_weights:JI(K.paint.get("raster-hue-rotate")),u_perspective_transform:te,u_raster_elevation:ne,u_zoom_transition:R,u_merc_center:B,u_cutoff_params:G,u_colorization_mix:Qd(o.cx,se,ce),u_colorization_offset:Yy(o.cx,ue,ce),u_color_ramp:le,u_texture_offset:[Ce/(ye+2*Ce),ye/(ye+2*Ce)],u_texture_res:[ye+2*Ce,ye+2*Ce],u_emissive_strength:Ae});function JI(w){w*=Math.PI/180;const f=Math.sin(w),v=Math.cos(w);return[(2*v+1)/3,(-Math.sqrt(3)*f-v+1)/3,(Math.sqrt(3)*f-v+1)/3]}const Kd=(w,f,v,S,C,E,R,B,G,j,q,K)=>({u_matrix:w,u_normalize_matrix:f,u_globe_matrix:v,u_merc_matrix:S,u_grid_matrix:C,u_tl_parent:E,u_scale_parent:j,u_fade_t:q.mix,u_opacity:q.opacity,u_image0:0,u_image1:1,u_raster_elevation:K,u_zoom_transition:R,u_merc_center:B,u_cutoff_params:G}),Jd=(w,f,v,S,C,E,R,B,G,j)=>({u_particle_texture:w,u_particle_texture_side_len:f,u_tile_offset:v,u_velocity:S,u_color_ramp:E,u_velocity_res:C,u_max_speed:R,u_uv_offset:B,u_data_scale:G,u_data_offset:j,u_particle_pos_scale:1.3,u_particle_pos_offset:[wc,wc]}),eE=(w,f,v,S,C,E,R,B,G,j)=>({u_particle_texture:w,u_particle_texture_side_len:f,u_velocity:v,u_velocity_res:S,u_max_speed:C,u_speed_factor:E,u_reset_rate:R,u_rand_seed:Math.random(),u_uv_offset:B,u_data_scale:G,u_data_offset:j,u_particle_pos_scale:1.3,u_particle_pos_offset:[wc,wc]}),Ec=o.a9.create(),Xy=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue,ce)=>{const ye=C.transform,Ce={u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:ye.getCameraToCenterDistance(se),u_rotate_symbol:+v,u_aspect_ratio:ye.width/ye.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:R,u_coord_matrix:B,u_is_text:+G,u_pitch_with_map:+S,u_texsize:j,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ec,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ec,u_up_vector:[0,-1,0],u_color_adj_mat:ue,u_icon_transition:ce||0};return se.name==="globe"&&(Ce.u_tile_id=[q.canonical.x,q.canonical.y,1<<q.canonical.z],Ce.u_zoom_transition=K,Ce.u_inv_rot_matrix=ne,Ce.u_merc_center=te,Ce.u_camera_forward=ye._camera.forward(),Ce.u_ecef_origin=o.cy(ye.globeMatrix,q.toUnwrapped()),Ce.u_tile_matrix=Float32Array.from(ye.globeMatrix),Ce.u_up_vector=le),Ce},Gh=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue)=>o.e(Xy(w,f,v,S,C,E,R,B,G,j,K,te,ne,le,se,ue),{u_gamma_scale:S?C.transform.getCameraToCenterDistance(ue)*Math.cos(C.terrain?0:C.transform._pitch):1,u_device_pixel_ratio:o.f.devicePixelRatio,u_is_halo:+q,undefined:void 0}),Lu=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se)=>o.e(Gh(w,f,v,S,C,E,R,B,!0,G,!0,q,K,te,ne,le,se),{u_texsize_icon:j,u_texture_icon:1}),tE=(w,f,v,S)=>({u_matrix:w,u_emissive_strength:f,u_opacity:v,u_color:S}),rE=(w,f,v,S,C,E,R)=>o.e(function(B,G,j,q){const K=j.imageManager.getPattern(B.toString(),G),{width:te,height:ne}=j.imageManager.getPixelSize(G),le=Math.pow(2,q.tileID.overscaledZ),se=q.tileSize*Math.pow(2,j.transform.tileZoom)/le,ue=se*(q.tileID.canonical.x+q.tileID.wrap*le),ce=se*q.tileID.canonical.y;return{u_image:0,u_pattern_tl:K.tl,u_pattern_br:K.br,u_texsize:[te,ne],u_pattern_size:K.displaySize,u_tile_units_to_pixels:1/o.a6(q,1,j.transform.tileZoom),u_pixel_coord_upper:[ue>>16,ce>>16],u_pixel_coord_lower:[65535&ue,65535&ce]}}(C,E,S,R),{u_matrix:w,u_emissive_strength:f,u_opacity:v}),Qy=new Float32Array(o.a9.identity([])),Yv=(w,f,v,S,C,E,R,B,G,j,q,K,te,ne=[0,0,0],le)=>{const se=C.style.light,ue=se.properties.get("position"),ce=[-ue.x,-ue.y,ue.z],ye=o.ct.create();se.properties.get("anchor")==="viewport"&&(o.ct.fromRotation(ye,-C.transform.angle),o.Q.transformMat3(ce,ce,ye));const Ce=q.alphaMode==="MASK",Ae=se.properties.get("color"),De=te.paint.get("model-ambient-occlusion-intensity"),he=te.paint.get("model-color").constantOr(o.aA.white),we=te.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:w,u_lighting_matrix:f,u_normal_matrix:v,u_node_matrix:S||Qy,u_lightpos:ce,u_lightintensity:se.properties.get("intensity"),u_lightcolor:[Ae.r,Ae.g,Ae.b],u_camera_pos:ne,u_opacity:E,u_baseTextureIsAlpha:0,u_alphaMask:+Ce,u_alphaCutoff:q.alphaCutoff,u_baseColorFactor:[R.r,R.g,R.b,R.a],u_emissiveFactor:[B[0],B[1],B[2],1],u_metallicFactor:G,u_roughnessFactor:j,u_baseColorTexture:Co.BaseColor,u_metallicRoughnessTexture:Co.MetallicRoughness,u_normalTexture:Co.Normal,u_occlusionTexture:Co.Occlusion,u_emissionTexture:Co.Emission,u_color_mix:[he.r,he.g,he.b,we],u_aoIntensity:De,u_emissive_strength:K,u_occlusionTextureTransform:le||[0,0,0,0]}},Tw=(w,f=Qy,v=Qy)=>({u_matrix:w,u_instance:f,u_node_matrix:v}),Ky={fillExtrusion:w=>({u_matrix:new o.bN(w),u_lightpos:new o.bP(w),u_lightintensity:new o.bQ(w),u_lightcolor:new o.bP(w),u_vertical_gradient:new o.bQ(w),u_opacity:new o.bQ(w),u_edge_radius:new o.bQ(w),u_ao:new o.bO(w),u_tile_id:new o.bP(w),u_zoom_transition:new o.bQ(w),u_inv_rot_matrix:new o.bN(w),u_merc_center:new o.bO(w),u_up_dir:new o.bP(w),u_height_lift:new o.bQ(w),u_flood_light_color:new o.bP(w),u_vertical_scale:new o.bQ(w),u_flood_light_intensity:new o.bQ(w),u_ground_shadow_factor:new o.bP(w),u_emissive_strength:new o.bQ(w)}),fillExtrusionDepth:w=>({u_matrix:new o.bN(w),u_edge_radius:new o.bQ(w),u_vertical_scale:new o.bQ(w)}),fillExtrusionPattern:w=>({u_matrix:new o.bN(w),u_lightpos:new o.bP(w),u_lightintensity:new o.bQ(w),u_lightcolor:new o.bP(w),u_vertical_gradient:new o.bQ(w),u_height_factor:new o.bQ(w),u_edge_radius:new o.bQ(w),u_ao:new o.bO(w),u_tile_id:new o.bP(w),u_zoom_transition:new o.bQ(w),u_inv_rot_matrix:new o.bN(w),u_merc_center:new o.bO(w),u_up_dir:new o.bP(w),u_height_lift:new o.bQ(w),u_image:new o.bR(w),u_texsize:new o.bO(w),u_pixel_coord_upper:new o.bO(w),u_pixel_coord_lower:new o.bO(w),u_tile_units_to_pixels:new o.bQ(w),u_opacity:new o.bQ(w)}),fillExtrusionGroundEffect:w=>({u_matrix:new o.bN(w),u_opacity:new o.bQ(w),u_ao_pass:new o.bQ(w),u_meter_to_tile:new o.bQ(w),u_ao:new o.bO(w),u_flood_light_intensity:new o.bQ(w),u_flood_light_color:new o.bP(w),u_attenuation:new o.bQ(w),u_edge_radius:new o.bQ(w),u_fb:new o.bR(w),u_fb_size:new o.bQ(w)}),fill:w=>({u_matrix:new o.bN(w),u_emissive_strength:new o.bQ(w)}),fillPattern:w=>({u_matrix:new o.bN(w),u_emissive_strength:new o.bQ(w),u_image:new o.bR(w),u_texsize:new o.bO(w),u_pixel_coord_upper:new o.bO(w),u_pixel_coord_lower:new o.bO(w),u_tile_units_to_pixels:new o.bQ(w)}),fillOutline:w=>({u_matrix:new o.bN(w),u_emissive_strength:new o.bQ(w),u_world:new o.bO(w)}),fillOutlinePattern:w=>({u_matrix:new o.bN(w),u_emissive_strength:new o.bQ(w),u_world:new o.bO(w),u_image:new o.bR(w),u_texsize:new o.bO(w),u_pixel_coord_upper:new o.bO(w),u_pixel_coord_lower:new o.bO(w),u_tile_units_to_pixels:new o.bQ(w)}),circle:o.cz,collisionBox:w=>({u_matrix:new o.bN(w),u_camera_to_center_distance:new o.bQ(w),u_extrude_scale:new o.bO(w)}),collisionCircle:w=>({u_matrix:new o.bN(w),u_inv_matrix:new o.bN(w),u_camera_to_center_distance:new o.bQ(w),u_viewport_size:new o.bO(w)}),debug:w=>({u_color:new o.cf(w),u_matrix:new o.bN(w),u_overlay:new o.bR(w),u_overlay_scale:new o.bQ(w)}),clippingMask:w=>({u_matrix:new o.bN(w)}),heatmap:w=>({u_extrude_scale:new o.bQ(w),u_intensity:new o.bQ(w),u_matrix:new o.bN(w),u_inv_rot_matrix:new o.bN(w),u_merc_center:new o.bO(w),u_tile_id:new o.bP(w),u_zoom_transition:new o.bQ(w),u_up_dir:new o.bP(w)}),heatmapTexture:w=>({u_image:new o.bR(w),u_color_ramp:new o.bR(w),u_opacity:new o.bQ(w)}),hillshade:w=>({u_matrix:new o.bN(w),u_image:new o.bR(w),u_latrange:new o.bO(w),u_light:new o.bO(w),u_shadow:new o.cf(w),u_highlight:new o.cf(w),u_emissive_strength:new o.bQ(w),u_accent:new o.cf(w)}),hillshadePrepare:w=>({u_matrix:new o.bN(w),u_image:new o.bR(w),u_dimension:new o.bO(w),u_zoom:new o.bQ(w)}),line:o.cA,linePattern:o.cB,raster:w=>({u_matrix:new o.bN(w),u_normalize_matrix:new o.bN(w),u_globe_matrix:new o.bN(w),u_merc_matrix:new o.bN(w),u_grid_matrix:new o.cg(w),u_tl_parent:new o.bO(w),u_scale_parent:new o.bQ(w),u_fade_t:new o.bQ(w),u_opacity:new o.bQ(w),u_image0:new o.bR(w),u_image1:new o.bR(w),u_brightness_low:new o.bQ(w),u_brightness_high:new o.bQ(w),u_saturation_factor:new o.bQ(w),u_contrast_factor:new o.bQ(w),u_spin_weights:new o.bP(w),u_perspective_transform:new o.bO(w),u_raster_elevation:new o.bQ(w),u_zoom_transition:new o.bQ(w),u_merc_center:new o.bO(w),u_cutoff_params:new o.bS(w),u_colorization_mix:new o.bS(w),u_colorization_offset:new o.bQ(w),u_color_ramp:new o.bR(w),u_texture_offset:new o.bO(w),u_texture_res:new o.bO(w),u_emissive_strength:new o.bQ(w)}),rasterParticle:w=>({u_matrix:new o.bN(w),u_normalize_matrix:new o.bN(w),u_globe_matrix:new o.bN(w),u_merc_matrix:new o.bN(w),u_grid_matrix:new o.cg(w),u_tl_parent:new o.bO(w),u_scale_parent:new o.bQ(w),u_fade_t:new o.bQ(w),u_opacity:new o.bQ(w),u_image0:new o.bR(w),u_image1:new o.bR(w),u_raster_elevation:new o.bQ(w),u_zoom_transition:new o.bQ(w),u_merc_center:new o.bO(w),u_cutoff_params:new o.bS(w)}),rasterParticleTexture:w=>({u_texture:new o.bR(w),u_opacity:new o.bQ(w)}),rasterParticleDraw:w=>({u_particle_texture:new o.bR(w),u_particle_texture_side_len:new o.bQ(w),u_tile_offset:new o.bO(w),u_velocity:new o.bR(w),u_color_ramp:new o.bR(w),u_velocity_res:new o.bO(w),u_max_speed:new o.bQ(w),u_uv_offset:new o.bO(w),u_data_scale:new o.bS(w),u_data_offset:new o.bQ(w),u_particle_pos_scale:new o.bQ(w),u_particle_pos_offset:new o.bO(w)}),rasterParticleUpdate:w=>({u_particle_texture:new o.bR(w),u_particle_texture_side_len:new o.bQ(w),u_velocity:new o.bR(w),u_velocity_res:new o.bO(w),u_max_speed:new o.bQ(w),u_speed_factor:new o.bQ(w),u_reset_rate:new o.bQ(w),u_rand_seed:new o.bQ(w),u_uv_offset:new o.bO(w),u_data_scale:new o.bS(w),u_data_offset:new o.bQ(w),u_particle_pos_scale:new o.bQ(w),u_particle_pos_offset:new o.bO(w)}),symbolIcon:w=>({u_is_size_zoom_constant:new o.bR(w),u_is_size_feature_constant:new o.bR(w),u_size_t:new o.bQ(w),u_size:new o.bQ(w),u_camera_to_center_distance:new o.bQ(w),u_rotate_symbol:new o.bR(w),u_aspect_ratio:new o.bQ(w),u_fade_change:new o.bQ(w),u_matrix:new o.bN(w),u_label_plane_matrix:new o.bN(w),u_coord_matrix:new o.bN(w),u_is_text:new o.bR(w),u_pitch_with_map:new o.bR(w),u_texsize:new o.bO(w),u_tile_id:new o.bP(w),u_zoom_transition:new o.bQ(w),u_inv_rot_matrix:new o.bN(w),u_merc_center:new o.bO(w),u_camera_forward:new o.bP(w),u_tile_matrix:new o.bN(w),u_up_vector:new o.bP(w),u_ecef_origin:new o.bP(w),u_texture:new o.bR(w),u_icon_transition:new o.bQ(w),u_color_adj_mat:new o.bN(w)}),symbolSDF:w=>({u_is_size_zoom_constant:new o.bR(w),u_is_size_feature_constant:new o.bR(w),u_size_t:new o.bQ(w),u_size:new o.bQ(w),u_camera_to_center_distance:new o.bQ(w),u_rotate_symbol:new o.bR(w),u_aspect_ratio:new o.bQ(w),u_fade_change:new o.bQ(w),u_matrix:new o.bN(w),u_label_plane_matrix:new o.bN(w),u_coord_matrix:new o.bN(w),u_is_text:new o.bR(w),u_pitch_with_map:new o.bR(w),u_texsize:new o.bO(w),u_texture:new o.bR(w),u_gamma_scale:new o.bQ(w),u_device_pixel_ratio:new o.bQ(w),u_tile_id:new o.bP(w),u_zoom_transition:new o.bQ(w),u_inv_rot_matrix:new o.bN(w),u_merc_center:new o.bO(w),u_camera_forward:new o.bP(w),u_tile_matrix:new o.bN(w),u_up_vector:new o.bP(w),u_ecef_origin:new o.bP(w),u_is_halo:new o.bR(w)}),symbolTextAndIcon:w=>({u_is_size_zoom_constant:new o.bR(w),u_is_size_feature_constant:new o.bR(w),u_size_t:new o.bQ(w),u_size:new o.bQ(w),u_camera_to_center_distance:new o.bQ(w),u_rotate_symbol:new o.bR(w),u_aspect_ratio:new o.bQ(w),u_fade_change:new o.bQ(w),u_matrix:new o.bN(w),u_label_plane_matrix:new o.bN(w),u_coord_matrix:new o.bN(w),u_is_text:new o.bR(w),u_pitch_with_map:new o.bR(w),u_texsize:new o.bO(w),u_texsize_icon:new o.bO(w),u_texture:new o.bR(w),u_texture_icon:new o.bR(w),u_gamma_scale:new o.bQ(w),u_device_pixel_ratio:new o.bQ(w),u_is_halo:new o.bR(w)}),background:w=>({u_matrix:new o.bN(w),u_emissive_strength:new o.bQ(w),u_opacity:new o.bQ(w),u_color:new o.cf(w)}),backgroundPattern:w=>({u_matrix:new o.bN(w),u_emissive_strength:new o.bQ(w),u_opacity:new o.bQ(w),u_image:new o.bR(w),u_pattern_tl:new o.bO(w),u_pattern_br:new o.bO(w),u_texsize:new o.bO(w),u_pattern_size:new o.bO(w),u_pixel_coord_upper:new o.bO(w),u_pixel_coord_lower:new o.bO(w),u_tile_units_to_pixels:new o.bQ(w)}),terrainRaster:zn,terrainDepth:zn,skybox:w=>({u_matrix:new o.bN(w),u_sun_direction:new o.bP(w),u_cubemap:new o.bR(w),u_opacity:new o.bQ(w),u_temporal_offset:new o.bQ(w)}),skyboxGradient:w=>({u_matrix:new o.bN(w),u_color_ramp:new o.bR(w),u_center_direction:new o.bP(w),u_radius:new o.bQ(w),u_opacity:new o.bQ(w),u_temporal_offset:new o.bQ(w)}),skyboxCapture:w=>({u_matrix_3f:new o.cg(w),u_sun_direction:new o.bP(w),u_sun_intensity:new o.bQ(w),u_color_tint_r:new o.bS(w),u_color_tint_m:new o.bS(w),u_luminance:new o.bQ(w)}),globeRaster:w=>({u_proj_matrix:new o.bN(w),u_globe_matrix:new o.bN(w),u_normalize_matrix:new o.bN(w),u_merc_matrix:new o.bN(w),u_zoom_transition:new o.bQ(w),u_merc_center:new o.bO(w),u_image0:new o.bR(w),u_grid_matrix:new o.cg(w),u_skirt_height:new o.bQ(w),u_far_z_cutoff:new o.bQ(w),u_frustum_tl:new o.bP(w),u_frustum_tr:new o.bP(w),u_frustum_br:new o.bP(w),u_frustum_bl:new o.bP(w),u_globe_pos:new o.bP(w),u_globe_radius:new o.bQ(w),u_viewport:new o.bO(w)}),globeAtmosphere:w=>({u_frustum_tl:new o.bP(w),u_frustum_tr:new o.bP(w),u_frustum_br:new o.bP(w),u_frustum_bl:new o.bP(w),u_horizon:new o.bQ(w),u_transition:new o.bQ(w),u_fadeout_range:new o.bQ(w),u_color:new o.bS(w),u_high_color:new o.bS(w),u_space_color:new o.bS(w),u_temporal_offset:new o.bQ(w),u_horizon_angle:new o.bQ(w)}),model:w=>({u_matrix:new o.bN(w),u_lighting_matrix:new o.bN(w),u_normal_matrix:new o.bN(w),u_node_matrix:new o.bN(w),u_lightpos:new o.bP(w),u_lightintensity:new o.bQ(w),u_lightcolor:new o.bP(w),u_camera_pos:new o.bP(w),u_opacity:new o.bQ(w),u_baseColorFactor:new o.bS(w),u_emissiveFactor:new o.bS(w),u_metallicFactor:new o.bQ(w),u_roughnessFactor:new o.bQ(w),u_baseTextureIsAlpha:new o.bR(w),u_alphaMask:new o.bR(w),u_alphaCutoff:new o.bQ(w),u_baseColorTexture:new o.bR(w),u_metallicRoughnessTexture:new o.bR(w),u_normalTexture:new o.bR(w),u_occlusionTexture:new o.bR(w),u_emissionTexture:new o.bR(w),u_color_mix:new o.bS(w),u_aoIntensity:new o.bQ(w),u_emissive_strength:new o.bQ(w),u_occlusionTextureTransform:new o.bS(w)}),modelDepth:w=>({u_matrix:new o.bN(w),u_instance:new o.bN(w),u_node_matrix:new o.bN(w)}),groundShadow:w=>({u_matrix:new o.bN(w),u_ground_shadow_factor:new o.bP(w)}),stars:w=>({u_matrix:new o.bN(w),u_up:new o.bP(w),u_right:new o.bP(w),u_intensity_multiplier:new o.bQ(w)})};let ep;function Jy(w,f,v,S,C,E,R){const B=w.context,G=B.gl,j=w.transform,q=w.getOrCreateProgram("collisionBox"),K=[];let te=0,ne=0;for(let Ae=0;Ae<S.length;Ae++){const De=S[Ae],he=f.getTile(De),we=he.getBucket(v);if(!we)continue;const Fe=nl(De,we,j);let ze=Fe;C[0]===0&&C[1]===0||(ze=w.translatePosMatrix(Fe,he,C,E));const je=R?we.textCollisionBox:we.iconCollisionBox,it=we.collisionCircleArray;if(it.length>0){const Ge=o.a9.create(),rt=ze;o.a9.mul(Ge,we.placementInvProjMatrix,j.glCoordMatrix),o.a9.mul(Ge,Ge,we.placementViewportMatrix),K.push({circleArray:it,circleOffset:ne,transform:rt,invTransform:Ge,projection:we.getProjection()}),te+=it.length/4,ne=te}je&&(w.terrain&&w.terrain.setupElevationDraw(he,q),q.draw(w,G.LINES,Pr.disabled,qr.disabled,w.colorModeForRenderPass(),Vr.disabled,QI(ze,j,he,we.getProjection()),v.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,j.zoom,null,[je.collisionVertexBuffer,je.collisionVertexBufferExt]))}if(!R||!K.length)return;const le=w.getOrCreateProgram("collisionCircle"),se=new o.cC;se.resize(4*te),se._trim();let ue=0;for(const Ae of K)for(let De=0;De<Ae.circleArray.length/4;De++){const he=4*De,we=Ae.circleArray[he+0],Fe=Ae.circleArray[he+1],ze=Ae.circleArray[he+2],je=Ae.circleArray[he+3];se.emplace(ue++,we,Fe,ze,je,0),se.emplace(ue++,we,Fe,ze,je,1),se.emplace(ue++,we,Fe,ze,je,2),se.emplace(ue++,we,Fe,ze,je,3)}(!ep||ep.length<2*te)&&(ep=function(Ae){const De=2*Ae,he=new o.az;he.resize(De),he._trim();for(let we=0;we<De;we++){const Fe=6*we;he.uint16[Fe+0]=4*we+0,he.uint16[Fe+1]=4*we+1,he.uint16[Fe+2]=4*we+2,he.uint16[Fe+3]=4*we+2,he.uint16[Fe+4]=4*we+3,he.uint16[Fe+5]=4*we+0}return he}(te));const ce=B.createIndexBuffer(ep,!0),ye=B.createVertexBuffer(se,o.cD.members,!0);for(const Ae of K){const De={u_matrix:Ae.transform,u_inv_matrix:Ae.invTransform,u_camera_to_center_distance:(Ce=j).getCameraToCenterDistance(Ae.projection),u_viewport_size:[Ce.width,Ce.height]};le.draw(w,G.TRIANGLES,Pr.disabled,qr.disabled,w.colorModeForRenderPass(),Vr.disabled,De,v.id,ye,ce,o.aE.simpleSegment(0,2*Ae.circleOffset,Ae.circleArray.length,Ae.circleArray.length/2),null,j.zoom)}var Ce;ye.destroy(),ce.destroy()}const tp=o.a9.create();function e0(w){const f=w._camera.getWorldToCamera(w.worldSize,1),v=o.a9.multiply([],f,w.globeMatrix);o.a9.invert(v,v);const S=[0,0,0],C=[0,1,0,0];return o.aa.transformMat4(C,C,v),S[0]=C[0],S[1]=C[1],S[2]=C[2],o.Q.normalize(S,S),S}function Dc({width:w,height:f,anchor:v,textOffset:S,textScale:C},E){const{horizontalAlign:R,verticalAlign:B}=o.bi(v),G=-(R-.5)*w,j=-(B-.5)*f,q=o.bh(v,S);return new o.P((G/C+q[0])*E,(j/C+q[1])*E)}function Aw(w,f,v,S,C,E,R,B,G,j,q){const K=w.text.placedSymbolArray,te=w.text.dynamicLayoutVertexArray,ne=w.icon.dynamicLayoutVertexArray,le={},se=w.getProjection(),ue=Dv(B,se,E),ce=E.elevation,ye=se.upVectorScale(B.canonical,E.center.lat,E.worldSize).metersToTile;te.clear();for(let Ce=0;Ce<K.length;Ce++){const Ae=K.get(Ce),{tileAnchorX:De,tileAnchorY:he,numGlyphs:we}=Ae,Fe=Ae.hidden||!Ae.crossTileID||w.allowVerticalPlacement&&!Ae.placedOrientation?null:S[Ae.crossTileID];if(Fe){let ze=0,je=0,it=0;if(ce){const ot=ce?ce.getAtTileOffset(B,De,he):0,[Me,Tt,lr]=se.upVector(B.canonical,De,he);ze=ot*Me*ye,je=ot*Tt*ye,it=ot*lr*ye}let[Ge,rt,st,Ve]=$o(Ae.projectedAnchorX+ze,Ae.projectedAnchorY+je,Ae.projectedAnchorZ+it,v?ue:R);const Qe=Av(E.getCameraToCenterDistance(se),Ve);let kt=C.evaluateSizeForFeature(w.textSizeData,j,Ae)*Qe/o.bf;v&&(kt*=w.tilePixelRatio/G);const Ze=Dc(Fe,kt);v?({x:Ge,y:rt,z:st}=se.projectTilePoint(De+Ze.x,he+Ze.y,B.canonical),[Ge,rt,st]=$o(Ge+ze,rt+je,st+it,R)):(f&&Ze._rotate(-E.angle),Ge+=Ze.x,rt+=Ze.y,st=0);const nt=w.allowVerticalPlacement&&Ae.placedOrientation===o.b9.vertical?Math.PI/2:0;for(let ot=0;ot<we;ot++)o.bc(te,Ge,rt,st,nt);q&&Ae.associatedIconIndex>=0&&(le[Ae.associatedIconIndex]={x:Ge,y:rt,z:st,angle:nt})}else Ac(we,te)}if(q){ne.clear();const Ce=w.icon.placedSymbolArray;for(let Ae=0;Ae<Ce.length;Ae++){const De=Ce.get(Ae),{numGlyphs:he}=De,we=le[Ae];if(De.hidden||!we)Ac(he,ne);else{const{x:Fe,y:ze,z:je,angle:it}=we;for(let Ge=0;Ge<he;Ge++)o.bc(ne,Fe,ze,je,it)}}w.icon.dynamicLayoutVertexBuffer.updateData(ne)}w.text.dynamicLayoutVertexBuffer.updateData(te)}function rp(w,f,v,S,C,E,R={}){const B=v.paint.get("icon-translate"),G=v.paint.get("text-translate"),j=v.paint.get("icon-translate-anchor"),q=v.paint.get("text-translate-anchor"),K=v.layout.get("icon-rotation-alignment"),te=v.layout.get("text-rotation-alignment"),ne=v.layout.get("icon-pitch-alignment"),le=v.layout.get("text-pitch-alignment"),se=v.layout.get("icon-keep-upright"),ue=v.layout.get("text-keep-upright"),ce=v.paint.get("icon-color-saturation"),ye=v.paint.get("icon-color-contrast"),Ce=v.paint.get("icon-color-brightness-min"),Ae=v.paint.get("icon-color-brightness-max"),De=w.context,he=De.gl,we=w.transform,Fe=K==="map",ze=te==="map",je=ne==="map",it=le==="map",Ge=v.layout.get("symbol-sort-key").constantOr(1)!==void 0;let rt=!1;const st=w.depthModeForSublayer(0,Pr.ReadOnly),Ve=[o.a8(we.center.lng),o.ah(we.center.lat)],Qe=v.layout.get("text-variable-anchor"),kt=we.projection.name==="globe",Ze=[],nt=[0,-1,0];for(const ot of S){const Me=f.getTile(ot),Tt=Me.getBucket(v);if(!Tt||Tt.projection.name==="mercator"&&kt||Tt.fullyClipped)continue;const lr=Tt.projection.name==="globe",vr=lr?o.W(we.zoom):0,Ar=Dv(ot,Tt.getProjection(),we),xr=we.calculatePixelsToTileUnitsMatrix(Me),Dr=Qe&&Tt.hasTextData(),Sn=Tt.hasIconTextFit()&&Dr&&Tt.hasIconData(),Zr=Tt.getProjection().createInversionMatrix(we,ot.canonical),Pn=()=>{const nn=Fe&&v.layout.get("symbol-placement")!=="point",sn=[],Ti=nn||Sn,pi=v.paint.get("icon-image-cross-fade").constantOr(0);w.terrainRenderModeElevated()&&je&&sn.push("PITCH_WITH_MAP_TERRAIN"),lr&&(sn.push("PROJECTION_GLOBE_VIEW"),Ti&&sn.push("PROJECTED_POS_ON_VIEWPORT")),pi>0&&sn.push("ICON_TRANSITION"),Tt.icon.zOffsetVertexBuffer&&sn.push("Z_OFFSET"),ce===0&&ye===0&&Ce===0&&Ae===1||sn.push("COLOR_ADJUSTMENT");const vn=Tt.icon.programConfigurations.get(v.id),Kr=w.getOrCreateProgram(Tt.sdfIcons?"symbolSDF":"symbolIcon",{config:vn,defines:sn});let _o;const Wa=Me.imageAtlasTexture?Me.imageAtlasTexture.size:[0,0],ya=Tt.iconSizeData,Za=o.b8(ya,we.zoom),yo=je||we.pitch!==0,io=Rd(Ar,Me.tileID.canonical,je,Fe,we,Tt.getProjection(),xr),xa=Hl(Ar,Me.tileID.canonical,je,Fe,we,Tt.getProjection(),xr),Pa=w.translatePosMatrix(xa,Me,B,j,!0),La=w.translatePosMatrix(Ar,Me,B,j),sl=Ti?tp:io,Vs=Fe&&!je&&!nn;let ll=nt;!kt&&!we.mercatorFromTransition||Fe||(ll=e0(we));const ul=lr?ll:nt;if(Tt.sdfIcons&&!Tt.iconsInText)_o=Gh(ya.kind,Za,Vs,je,w,La,sl,Pa,!1,Wa,!0,ot,vr,Ve,Zr,ul,Tt.getProjection());else{const Yl=v.getColorAdjustmentMatrix(ce,ye,Ce,Ae);_o=Xy(ya.kind,Za,Vs,je,w,La,sl,Pa,!1,Wa,ot,vr,Ve,Zr,ul,Tt.getProjection(),Yl,pi)}const Bu=Me.imageAtlasTexture?Me.imageAtlasTexture:null,hs=v.layout.get("icon-size").constantOr(0)!==1||Tt.iconsNeedLinear,vp=Tt.sdfIcons||w.options.rotating||w.options.zooming||hs||yo?he.LINEAR:he.NEAREST,Qh=Tt.sdfIcons&&v.paint.get("icon-halo-width").constantOr(1)!==0,mp=w.terrain&&je&&nn?o.a9.invert(o.a9.create(),io):tp;if(nn&&Tt.icon){const Yl=we.elevation,ba=Yl?Yl.getAtTileOffsetFunc(ot,we.center.lat,we.worldSize,Tt.getProjection()):null,_p=kd(Ar,Me.tileID.canonical,je,Fe,we,Tt.getProjection(),xr);Mv(Tt,Ar,w,!1,_p,xa,je,se,ba,ot)}return{program:Kr,buffers:Tt.icon,uniformValues:_o,atlasTexture:Bu,atlasTextureIcon:null,atlasInterpolation:vp,atlasInterpolationIcon:null,isSDF:Tt.sdfIcons,hasHalo:Qh,tile:Me,labelPlaneMatrixInv:mp}},Tn=()=>{const nn=ze&&v.layout.get("symbol-placement")!=="point",sn=[],Ti=nn||Qe||Sn;w.terrainRenderModeElevated()&&it&&sn.push("PITCH_WITH_MAP_TERRAIN"),lr&&(sn.push("PROJECTION_GLOBE_VIEW"),Ti&&sn.push("PROJECTED_POS_ON_VIEWPORT")),Tt.text.zOffsetVertexBuffer&&sn.push("Z_OFFSET");const pi=Tt.text.programConfigurations.get(v.id),vn=w.getOrCreateProgram(Tt.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:pi,defines:sn});let Kr,_o=[0,0],Wa=null;const ya=Tt.textSizeData;Tt.iconsInText&&(_o=Me.imageAtlasTexture?Me.imageAtlasTexture.size:[0,0],Wa=Me.imageAtlasTexture?Me.imageAtlasTexture:null,Kr=it||we.pitch!==0||w.options.rotating||w.options.zooming||ya.kind==="composite"||ya.kind==="camera"?he.LINEAR:he.NEAREST);const Za=Me.glyphAtlasTexture?Me.glyphAtlasTexture.size:[0,0],yo=o.b8(ya,we.zoom),io=Rd(Ar,Me.tileID.canonical,it,ze,we,Tt.getProjection(),xr),xa=Hl(Ar,Me.tileID.canonical,it,ze,we,Tt.getProjection(),xr),Pa=w.translatePosMatrix(xa,Me,G,q,!0),La=w.translatePosMatrix(Ar,Me,G,q),sl=Ti?tp:io,Vs=ze&&!it&&!nn;let ll=nt;!kt&&!we.mercatorFromTransition||ze||(ll=e0(we));const ul=lr?ll:nt;let Bu;Bu=Tt.iconsInText?Lu(ya.kind,yo,Vs,it,w,La,sl,Pa,Za,_o,ot,vr,Ve,Zr,ul,Tt.getProjection()):Gh(ya.kind,yo,Vs,it,w,La,sl,Pa,!0,Za,!0,ot,vr,Ve,Zr,ul,Tt.getProjection());const hs=Me.glyphAtlasTexture?Me.glyphAtlasTexture:null,vp=he.LINEAR,Qh=v.paint.get("text-halo-width").constantOr(1)!==0,mp=w.terrain&&it&&nn?o.a9.invert(o.a9.create(),io):tp;if(nn&&Tt.text){const Yl=we.elevation,ba=Yl?Yl.getAtTileOffsetFunc(ot,we.center.lat,we.worldSize,Tt.getProjection()):null,_p=kd(Ar,Me.tileID.canonical,it,ze,we,Tt.getProjection(),xr);Mv(Tt,Ar,w,!0,_p,xa,it,ue,ba,ot)}return{program:vn,buffers:Tt.text,uniformValues:Bu,atlasTexture:hs,atlasTextureIcon:Wa,atlasInterpolation:vp,atlasInterpolationIcon:Kr,isSDF:!0,hasHalo:Qh,tile:Me,labelPlaneMatrixInv:mp}},Di=Tt.icon.segments.get().length,ei=Tt.text.segments.get().length,ua=Di&&!R.onlyText?Pn():null,Ji=ei&&!R.onlyIcons?Tn():null,di=v.paint.get("icon-opacity").constantOr(1),oi=v.paint.get("text-opacity").constantOr(1);if(Ge&&Tt.canOverlap){rt=!0;const nn=di&&!R.onlyText?Tt.icon.segments.get():[],sn=oi&&!R.onlyIcons?Tt.text.segments.get():[];for(const Ti of nn)Ze.push({segments:new o.aE([Ti]),sortKey:Ti.sortKey,state:ua});for(const Ti of sn)Ze.push({segments:new o.aE([Ti]),sortKey:Ti.sortKey,state:Ji})}else R.onlyText||Ze.push({segments:di?Tt.icon.segments:new o.aE([]),sortKey:0,state:ua}),R.onlyIcons||Ze.push({segments:oi?Tt.text.segments:new o.aE([]),sortKey:0,state:Ji})}rt&&Ze.sort((ot,Me)=>ot.sortKey-Me.sortKey);for(const ot of Ze){const Me=ot.state;if(Me)if(w.terrain&&w.terrain.setupElevationDraw(Me.tile,Me.program,{useDepthForOcclusion:we.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Me.labelPlaneMatrixInv}),De.activeTexture.set(he.TEXTURE0),Me.atlasTexture&&Me.atlasTexture.bind(Me.atlasInterpolation,he.CLAMP_TO_EDGE,!0),Me.atlasTextureIcon&&(De.activeTexture.set(he.TEXTURE1),Me.atlasTextureIcon&&Me.atlasTextureIcon.bind(Me.atlasInterpolationIcon,he.CLAMP_TO_EDGE,!0)),w.uploadCommonLightUniforms(w.context,Me.program),Me.hasHalo){const Tt=Me.uniformValues;Tt.u_is_halo=1,Xv(Me.buffers,ot.segments,v,w,Me.program,st,C,E,Tt,2),Tt.u_is_halo=0}else{if(Me.isSDF){const Tt=Me.uniformValues;Me.hasHalo&&(Tt.u_is_halo=1,Xv(Me.buffers,ot.segments,v,w,Me.program,st,C,E,Tt,1)),Tt.u_is_halo=0}Xv(Me.buffers,ot.segments,v,w,Me.program,st,C,E,Me.uniformValues,1)}}}function Xv(w,f,v,S,C,E,R,B,G,j){const q=[w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer,w.iconTransitioningVertexBuffer,w.globeExtVertexBuffer,w.zOffsetVertexBuffer];C.draw(S,S.context.gl.TRIANGLES,E,R,B,Vr.disabled,G,v.id,w.layoutVertexBuffer,w.indexBuffer,f,v.paint,S.transform.zoom,w.programConfigurations.get(v.id),q,j)}function Qv(w,f,v,S,C,E,R){const B=w.context.gl,G=v.paint.get("fill-pattern"),j=G&&G.constantOr(1);let q,K,te,ne,le;R?(K=j&&!v.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=B.LINES):(K=j?"fillPattern":"fill",q=B.TRIANGLES);for(const se of S){const ue=f.getTile(se);if(j&&!ue.patternsLoaded())continue;const ce=ue.getBucket(v);if(!ce)continue;w.prepareDrawTile();const ye=ce.programConfigurations.get(v.id),Ce=w.isTileAffectedByFog(se),Ae=w.getOrCreateProgram(K,{config:ye,overrideFog:Ce});j&&(w.context.activeTexture.set(B.TEXTURE0),ue.imageAtlasTexture&&ue.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),ye.updatePaintBuffers());const De=G.constantOr(null);if(De&&ue.imageAtlas){const Fe=ue.imageAtlas.patternPositions[De.toString()];Fe&&ye.setConstantPatternPositions(Fe)}const he=w.translatePosMatrix(se.projMatrix,ue,v.paint.get("fill-translate"),v.paint.get("fill-translate-anchor")),we=v.paint.get("fill-emissive-strength");if(R){ne=ce.indexBuffer2,le=ce.segments2;const Fe=w.terrain&&w.terrain.renderingToTexture?w.terrain.drapeBufferSize:[B.drawingBufferWidth,B.drawingBufferHeight];te=K==="fillOutlinePattern"&&j?Wl(he,we,w,ue,Fe):XI(he,we,Fe)}else ne=ce.indexBuffer,le=ce.segments,te=j?Pu(he,we,w,ue):Vh(he,we);w.uploadCommonUniforms(w.context,Ae,se.toUnwrapped()),Ae.draw(w,q,C,w.stencilModeForClipping(se),E,Vr.disabled,te,v.id,ce.layoutVertexBuffer,ne,le,v.paint,w.transform.zoom,ye,void 0)}}function ir(w,f,v,S,C,E,R,B){v.resetLayerRenderingStats(w);const G=w.context,j=G.gl,q=w.transform,K=v.paint.get("fill-extrusion-pattern"),te=K.constantOr(1),ne=v.paint.get("fill-extrusion-opacity"),le=w.style.enable3dLights(),se=v.paint.get(le&&!te?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ue=[v.paint.get("fill-extrusion-ambient-occlusion-intensity"),se],ce=v.layout.get("fill-extrusion-edge-radius"),ye=ce>0&&!v.paint.get("fill-extrusion-rounded-roof"),Ce=ye?0:ce,Ae=q.projection.name==="globe"?o.cM():0,De=q.projection.name==="globe",he=De?o.W(q.zoom):0,we=[o.a8(q.center.lng),o.ah(q.center.lat)],Fe=v.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ze=v.paint.get("fill-extrusion-flood-light-intensity"),je=v.paint.get("fill-extrusion-vertical-scale"),it=Iu(w,v.paint.get("fill-extrusion-cutoff-fade-range")),Ge=v.paint.get("fill-extrusion-emissive-strength"),rt=[];let st;De&&rt.push("PROJECTION_GLOBE_VIEW"),ue[0]>0&&rt.push("FAUX_AO"),ye&&rt.push("ZERO_ROOF_RADIUS"),B&&rt.push("HAS_CENTROID"),ze>0&&rt.push("FLOOD_LIGHT"),it.shouldRenderCutoff&&rt.push("RENDER_CUTOFF");const Ve=w.renderPass==="shadow",Qe=w.shadowRenderer,kt=Ve&&!!Qe;w.shadowRenderer&&(w.shadowRenderer.useNormalOffset=!0);let Ze=[0,0,0];if(Qe){const Me=w.style.directionalLight,Tt=w.style.ambientLight;Me&&Tt&&(Ze=Uy(Me,Tt)),st=rt.concat(["SHADOWS_SINGLE_CASCADE"])}const nt=kt?"fillExtrusionDepth":te?"fillExtrusionPattern":"fillExtrusion",ot=v.getLayerRenderingStats();for(const Me of S){const Tt=f.getTile(Me),lr=Tt.getBucket(v);if(!lr||lr.projection.name!==q.projection.name)continue;let vr=!1;Qe&&(vr=Qe.getMaxCascadeForTile(Me.toUnwrapped())===0);const Ar=w.isTileAffectedByFog(Me),xr=lr.programConfigurations.get(v.id),Dr=w.getOrCreateProgram(nt,{config:xr,defines:vr?st:rt,overrideFog:Ar});if(w.terrain&&w.terrain.setupElevationDraw(Tt,Dr,{useMeterToDem:!0}),!lr.centroidVertexBuffer){const ei=Dr.attributes.a_centroid_pos;ei!==void 0&&j.vertexAttrib2f(ei,0,0)}!Ve&&Qe&&Qe.setupShadows(Tt.tileID.toUnwrapped(),Dr,"vector-tile",Tt.tileID.overscaledZ),te&&(w.context.activeTexture.set(j.TEXTURE0),Tt.imageAtlasTexture&&Tt.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),xr.updatePaintBuffers());const Sn=K.constantOr(null);if(Sn&&Tt.imageAtlas){const ei=Tt.imageAtlas.patternPositions[Sn.toString()];ei&&xr.setConstantPatternPositions(ei)}const Zr=v.paint.get("fill-extrusion-vertical-gradient");let Pn;if(Ve&&Qe){if(Zl(Tt.tileID,lr,w))continue;const ei=Qe.calculateShadowPassMatrixFromTile(Tt.tileID.toUnwrapped());Pn=Fs(ei,Ce,je)}else{const ei=w.translatePosMatrix(Me.expandedProjMatrix,Tt,v.paint.get("fill-extrusion-translate"),v.paint.get("fill-extrusion-translate-anchor")),ua=q.projection.createInversionMatrix(q,Me.canonical);Pn=te?Xd(ei,w,Zr,ne,ue,Ce,Me,Tt,Ae,he,we,ua,Fe,je):qv(ei,w,Zr,ne,ue,Ce,Me,Ae,he,we,ua,Fe,je,ze,Ze,Ge)}w.uploadCommonUniforms(G,Dr,Me.toUnwrapped(),null,it);let Tn=lr.segments;if(q.projection.name==="mercator"&&!Ve&&(Tn=lr.getVisibleSegments(Tt.tileID,w.terrain,w.transform.getFrustum(0)),!Tn.get().length))continue;if(ot)if(Ve)for(const ei of Tn.get())ot.numRenderedVerticesInShadowPass+=ei.primitiveLength;else for(const ei of Tn.get())ot.numRenderedVerticesInTransparentPass+=ei.primitiveLength;const Di=[];(w.terrain||B)&&Di.push(lr.centroidVertexBuffer),De&&Di.push(lr.layoutVertexExtBuffer),Dr.draw(w,G.gl.TRIANGLES,C,E,R,Vr.backCCW,Pn,v.id,lr.layoutVertexBuffer,lr.indexBuffer,Tn,v.paint,w.transform.zoom,xr,Di)}w.shadowRenderer&&(w.shadowRenderer.useNormalOffset=!1)}function Pc(w,f,v,S,C,E,R,B,G,j,q,K,te,ne,le,se,ue,ce,ye){const Ce=w.context,Ae=Ce.gl,De=w.transform,he=w.transform.zoom,we=[],Fe=Iu(w,v.paint.get("fill-extrusion-cutoff-fade-range"));j==="clear"?(we.push("CLEAR_SUBPASS"),ye&&(we.push("CLEAR_FROM_TEXTURE"),Ce.activeTexture.set(Ae.TEXTURE0),ye.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE))):j==="sdf"&&we.push("SDF_SUBPASS"),ue&&we.push("HAS_CENTROID"),Fe.shouldRenderCutoff&&we.push("RENDER_CUTOFF");const ze=v.layout.get("fill-extrusion-edge-radius"),je=(it,Ge,rt,st,Ve)=>{const Qe=Ge.programConfigurations.get(v.id),kt=w.isTileAffectedByFog(it),Ze=w.getOrCreateProgram("fillExtrusionGroundEffect",{config:Qe,defines:we,overrideFog:kt}),nt=((Me,Tt,lr,vr,Ar,xr,Dr,Sn,Zr,Pn,Tn)=>({u_matrix:Tt,u_opacity:lr,u_ao_pass:vr?1:0,u_meter_to_tile:Ar,u_ao:xr,u_flood_light_intensity:Dr,u_flood_light_color:Sn,u_attenuation:Zr,u_edge_radius:Pn,u_fb:0,u_fb_size:Tn}))(0,st,q,G,Ve,[K,te*Ve],ne,le,se,he>=17?0:ze*Ve,ye?ye.size[0]:0),ot=[];ue&&ot.push(Ge.hiddenByLandmarkVertexBuffer),w.uploadCommonUniforms(Ce,Ze,it.toUnwrapped(),null,Fe),Ze.draw(w,Ce.gl.TRIANGLES,C,E,R,B,nt,v.id,Ge.vertexBuffer,Ge.indexBuffer,rt,v.paint,he,Qe,ot)};for(const it of S){const Ge=f.getTile(it),rt=Ge.getBucket(v);if(!rt||rt.projection.name!==De.projection.name||!rt.groundEffect||rt.groundEffect&&!rt.groundEffect.hasData())continue;const st=rt.groundEffect,Ve=1/rt.tileToMeter;{const Qe=w.translatePosMatrix(it.projMatrix,Ge,v.paint.get("fill-extrusion-translate"),v.paint.get("fill-extrusion-translate-anchor")),kt=st.getDefaultSegment();je(it,st,kt,Qe,Ve)}if(ce)for(let Qe=0;Qe<4;Qe++){const kt=o.cN[Qe](it),Ze=f.getTile(kt);if(!Ze)continue;const nt=Ze.getBucket(v);if(!nt||nt.projection.name!==De.projection.name||!nt.groundEffect||nt.groundEffect&&!nt.groundEffect.hasData())continue;const ot=nt.groundEffect;let Me,Tt;Qe===0?(Me=[-o.Y,0,0],Tt=1):Qe===1?(Me=[o.Y,0,0],Tt=0):Qe===2?(Me=[0,-o.Y,0],Tt=3):(Me=[0,o.Y,0],Tt=2);const lr=ot.regionSegments[Tt];if(!lr)continue;const vr=new Float32Array(16);o.a9.translate(vr,it.projMatrix,Me),je(it,ot,lr,w.translatePosMatrix(vr,Ge,v.paint.get("fill-extrusion-translate"),v.paint.get("fill-extrusion-translate-anchor")),Ve)}}}function t0(w,f,v,S,C,E,R){S.centroidVertexArray.length===0&&S.createCentroidsBuffer();const B=E?E.findDEMTileFor(v):null;if(!(B&&B.dem||R))return;const G=ce=>new o.P(Math.ceil((ce+o.cQ)*o.cR),0),j=ce=>{const ye=f.getSource().minzoom,Ce=De=>{const he=f.getTileByID(De);if(he&&he.hasData())return he.getBucket(C)},Ae=[0,-1,1];for(const De of Ae){if(ce.overscaledZ+De<ye)continue;const he=Ce(ce.calculateScaledKey(ce.overscaledZ+De));if(he)return he}},q=[0,0,0],K=(ce,ye)=>(q[0]=Math.min(ce.min.y,ye.min.y),q[1]=Math.max(ce.max.y,ye.max.y),q[2]=o.Y-ye.min.x>ce.max.x?ye.min.x-o.Y:ce.max.x,q),te=(ce,ye)=>(q[0]=Math.min(ce.min.x,ye.min.x),q[1]=Math.max(ce.max.x,ye.max.x),q[2]=o.Y-ye.min.y>ce.max.y?ye.min.y-o.Y:ce.max.y,q),ne=[(ce,ye)=>K(ce,ye),(ce,ye)=>K(ye,ce),(ce,ye)=>te(ce,ye),(ce,ye)=>te(ye,ce)],le=(ce,ye,Ce,Ae,De,he,we)=>{if(!E)return 0;const Fe=[[he?Ce:ce,he?ce:Ce,0],[he?Ce:ye,he?ye:Ce,0]],ze=we<0?o.Y+we:we,je=[he?ze:(ce+ye)/2,he?(ce+ye)/2:ze,0];return Ce===0&&we<0||Ce!==0&&we>0?E.getForTilePoints(De,[je],!0,Ae):Fe.push(je),E.getForTilePoints(v,Fe,!0,B),Math.max(Fe[0][2],Fe[1][2],je[2])/E.exaggeration()};for(let ce=0;ce<4;ce++){const ye=S.borderFeatureIndices[ce];if(ye.length===0)continue;const Ce=o.cN[ce](v),Ae=j(Ce);if(!(Ae&&Ae instanceof o.cO)||S.borderDoneWithNeighborZ[ce]===Ae.canonical.z)continue;Ae.centroidVertexArray.length===0&&Ae.createCentroidsBuffer();const De=E?E.findDEMTileFor(Ce):null;if(!(De&&De.dem||R))continue;const he=(ce<2?1:5)-ce,we=Ae.borderDoneWithNeighborZ[he]!==S.canonical.z,Fe=Ae.borderFeatureIndices[he];let ze=0;if(S.canonical.z!==Ae.canonical.z){for(const je of ye)S.showCentroid(S.featuresOnBorder[je]);if(we)for(const je of Fe)Ae.showCentroid(Ae.featuresOnBorder[je]);S.borderDoneWithNeighborZ[ce]=Ae.canonical.z,Ae.borderDoneWithNeighborZ[he]=S.canonical.z}for(const je of ye){const it=S.featuresOnBorder[je],Ge=S.centroidData[it.centroidDataIndex],rt=it.borders[ce];let st;for(;ze<Fe.length;){st=Ae.featuresOnBorder[Fe[ze]];const Ve=st.borders[he];if(Ve[1]>rt[0]+3||Ve[0]>rt[0]-3)break;Ae.showCentroid(st),ze++}if(st&&ze<Fe.length){const Ve=ze;let Qe=0;for(;!(st.borders[he][0]>rt[1]-3)&&(Qe++,++ze!==Fe.length);)st=Ae.featuresOnBorder[Fe[ze]];if(st=Ae.featuresOnBorder[Fe[Ve]],Qe>1){const nt=st.borders[he];Math.abs(rt[0]-nt[0])<3&&Math.abs(rt[1]-nt[1])<3&&(Qe=1,ze=Ve+1)}else if(Qe===0){S.showCentroid(it);continue}const kt=Ae.centroidData[st.centroidDataIndex];R&&Qe===1&&(((se=Ge).flags|(ue=kt).flags)&o.cP?(se.flags|=o.cP,ue.flags|=o.cP):(se.flags&=~o.cP,ue.flags&=~o.cP));const Ze=it.intersectsCount()>1||st.intersectsCount()>1;if(Qe>1)ze=Ve,Ge.centroidXY=kt.centroidXY=new o.P(0,0);else if(De&&De.dem&&!Ze){const nt=ne[ce](Ge,kt),ot=ce%2?o.Y-1:0,Me=le(nt[0],Math.min(o.Y-1,nt[1]),ot,De,Ce,ce<2,nt[2]);Ge.centroidXY=kt.centroidXY=G(Me)}else Ze?Ge.centroidXY=kt.centroidXY=new o.P(0,0):(Ge.centroidXY=S.encodeBorderCentroid(it),kt.centroidXY=Ae.encodeBorderCentroid(st));S.writeCentroidToBuffer(Ge),Ae.writeCentroidToBuffer(kt)}else S.showCentroid(it)}S.borderDoneWithNeighborZ[ce]=Ae.canonical.z,Ae.borderDoneWithNeighborZ[he]=S.canonical.z}var se,ue;(S.needsCentroidUpdate||!S.centroidVertexBuffer&&S.centroidVertexArray.length!==0)&&S.uploadCentroid(w)}const r0=[1,0,0],Cw=[0,1,0],Kv=[0,0,1];function Zl(w,f,v){const S=v.transform,C=v.shadowRenderer;if(!C)return!0;const E=w.toUnwrapped(),R=S.tileSize*C._cascades[v.currentShadowCascade].scale;let B=f.maxHeight;if(S.elevation){const se=S.elevation.getMinMaxForTile(w);se&&(B+=se.max)}const G=[...C.shadowDirection];G[2]=-G[2];const j=C.computeSimplifiedTileShadowVolume(E,B,R,G);if(!j)return!1;const q=[r0,Cw,Kv,G,[G[0],0,G[2]],[0,G[1],G[2]]],K=S.projection.name==="globe",te=S.scaleZoom(R),ne=o.bt.fromInvProjectionMatrix(S.invProjMatrix,S.worldSize,te,!K),le=C.getCurrentCascadeFrustum();return ne.intersectsPrecise(j.vertices,j.planes,q)===0||le.intersectsPrecise(j.vertices,j.planes,q)===0}function Jv(w){return[w[0]*o.cS,w[1]*o.cS,w[2]*o.cS,0]}function ql(w,f,v,S,C,E,R,B,G){const j=S.getSource(),q=v.globeSharedBuffers;if(!q)return;let K,te,ne;if(f&&(K=S.getTile(f)),j instanceof o.as?(te=j.texture,ne=o.co(0,0,v.transform)):K&&f&&(te=K.texture,ne=o.co(f.canonical.z,f.canonical.x,v.transform)),!te||!ne)return;w||(ne=o.a9.scale(o.a9.create(),ne,[1,-1,1]));const le=v.context,se=le.gl,ue=C.paint.get("raster-resampling")==="nearest"?se.NEAREST:se.LINEAR,ce=v.colorModeForDrapableLayerRenderPass(E),ye=R.defines;ye.push("GLOBE_POLES");const Ce=new Pr(se.LEQUAL,Pr.ReadWrite,v.depthRangeFor3D),Ae=Float32Array.from(v.transform.expandedFarZProjMatrix),De=Float32Array.from(o.aW(o.cn(new o.bv(0,0,0))));v.terrain&&v.terrain.prepareDrawTile(),le.activeTexture.set(se.TEXTURE0),te.bind(ue,se.CLAMP_TO_EDGE),le.activeTexture.set(se.TEXTURE1),te.bind(ue,se.CLAMP_TO_EDGE),te.useMipmap&&le.extTextureFilterAnisotropic&&v.transform.pitch>20&&se.texParameterf(se.TEXTURE_2D,le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,le.extTextureFilterAnisotropicMax);const[he,we,Fe,ze]=f?q.getPoleBuffers(f.canonical.z,!1):q.getPoleBuffers(0,!0),je=C.paint.get("raster-elevation");let it;w?(it=he,v.renderDefaultNorthPole=je!==0):(it=we,v.renderDefaultSouthPole=je!==0);const Ge=Jv(R.mix),rt=((Ve,Qe,kt,Ze,nt,ot,Me,Tt,lr,vr,Ar,xr,Dr)=>Sw(Ve,Qe,kt,new Float32Array(16),new Float32Array(9),[0,0],Ze,[0,0],[0,0,0,0],1,{opacity:1,mix:0},ot,[0,0],Tt,2,vr,Ar,xr,1,0,Dr))(Ae,De,ne,o.W(v.transform.zoom),0,C,0,je,0,Ge,R.offset,R.range,E),st=v.getOrCreateProgram("raster",{defines:ye});v.uploadCommonUniforms(le,st,null),st.draw(v,se.TRIANGLES,Ce,G,ce,B,rt,C.id,it,Fe,ze)}function em(w){const f=w._nearZ,v=w.projection.farthestPixelDistance(w),S=v-f,C=.2*w.height,E=f+C;return[f,v,(E-C-f)/S,(E-f)/S]}function Uh(w,f,v,S){if(w)return f instanceof Kt&&w instanceof Sv?f.getTextureDescriptor(w,v,!0):{texture:w.texture,mix:Jv(S.mix),offset:S.offset,buffer:0,tileSize:1}}function nE(w,f,v){if(!w)return null;const S=f.getTextureDescriptor(w,v,!0);if(!S)return null;let{texture:C,mix:E,offset:R,tileSize:B,buffer:G,format:j}=S;if(!C||!j)return null;let q=!1;return j==="uint32"&&(q=!0,E[3]=0,E=Qd(o.cT,E,[0,v.paint.get("raster-particle-max-speed")]),R=Yy(o.cT,R,[0,v.paint.get("raster-particle-max-speed")])),{texture:C,textureOffset:[G/(B+2*G),B/(B+2*G)],tileSize:B,scalarData:q,scale:E,offset:R,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[j]]}}function iE(w){const f=w._nearZ,v=w.projection.farthestPixelDistance(w),S=v-f,C=.2*w.height,E=f+C;return[f,v,(E-C-f)/S,(E-f)/S]}const n0=new o.aA(1,0,0,1),aE=new o.aA(0,1,0,1),Mw=new o.aA(0,0,1,1),Iw=new o.aA(1,0,1,1),i0=new o.aA(0,1,1,1);function $h(w,f,v,S,C,E,R){const B=w.context,G=w.transform,j=B.gl,q=G.projection.name==="globe",K=q?["PROJECTION_GLOBE_VIEW"]:[];let te=o.a9.clone(v.projMatrix);if(q&&o.W(G.zoom)>0){const Ge=o.aV(v.canonical,G),rt=o.cU(Ge);te=o.a9.multiply(new Float32Array(16),G.globeMatrix,rt),o.a9.multiply(te,G.projMatrix,te)}const ne=o.a9.create();ne[12]+=2*C/(o.f.devicePixelRatio*G.width),ne[13]+=2*E/(o.f.devicePixelRatio*G.height),o.a9.multiply(te,ne,te);const le=w.getOrCreateProgram("debug",{defines:K}),se=f.getTileByID(v.key);w.terrain&&w.terrain.setupElevationDraw(se,le);const ue=Pr.disabled,ce=qr.disabled,ye=w.colorModeForRenderPass(),Ce="$debug";B.activeTexture.set(j.TEXTURE0),w.emptyTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),q?se._makeGlobeTileDebugBuffers(w.context,G):se._makeDebugTileBoundsBuffers(w.context,G.projection);const Ae=se._tileDebugBuffer||w.debugBuffer,De=se._tileDebugIndexBuffer||w.debugIndexBuffer,he=se._tileDebugSegments||w.debugSegments;if(le.draw(w,j.LINE_STRIP,ue,ce,ye,Vr.disabled,qy(te,S),Ce,Ae,De,he,null,null,null,[se._globeTileDebugBorderBuffer]),R){const Ge=se.latestRawTileData,rt=Math.floor((Ge&&Ge.byteLength||0)/1024);let st=v.canonical.toString();v.overscaledZ!==v.canonical.z&&(st+=` => ${v.overscaledZ}`),st+=` ${se.state}`,st+=` ${rt}kb`,function(Ve,Qe){Ve.initDebugOverlayCanvas();const kt=Ve.debugOverlayCanvas,Ze=Ve.context.gl,nt=Ve.debugOverlayCanvas.getContext("2d");nt.clearRect(0,0,kt.width,kt.height),nt.shadowColor="white",nt.shadowBlur=2,nt.lineWidth=1.5,nt.strokeStyle="white",nt.textBaseline="top",nt.font="bold 36px Open Sans, sans-serif",nt.fillText(Qe,5,5),nt.strokeText(Qe,5,5),Ve.debugOverlayTexture.update(kt),Ve.debugOverlayTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE)}(w,st)}const we=f.getTile(v).tileSize,Fe=512/Math.min(we,512)*(v.overscaledZ/G.zoom)*.5,ze=se._tileDebugTextBuffer||w.debugBuffer,je=se._tileDebugTextIndexBuffer||w.quadTriangleIndexBuffer,it=se._tileDebugTextSegments||w.debugSegments;le.draw(w,j.TRIANGLES,ue,ce,fn.alphaBlended,Vr.disabled,qy(te,o.aA.transparent,Fe),Ce,ze,je,it,null,null,null,[se._globeTileDebugTextBuffer])}function Ew(w,f,v,S){tm(w,0,f+v/2,w.transform.width,v,S)}function Dw(w,f,v,S){tm(w,f-v/2,0,v,w.transform.height,S)}function tm(w,f,v,S,C,E){const R=w.context,B=R.gl;B.enable(B.SCISSOR_TEST),B.scissor(f*o.f.devicePixelRatio,v*o.f.devicePixelRatio,S*o.f.devicePixelRatio,C*o.f.devicePixelRatio),R.clear({color:E}),B.disable(B.SCISSOR_TEST)}const Pw=o.aB([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:oE}=Pw;function Ns(w,f,v,S){w.emplaceBack(f,v,S)}class Lw{constructor(f){this.vertexArray=new o.cV,this.indices=new o.az,Ns(this.vertexArray,-1,-1,1),Ns(this.vertexArray,1,-1,1),Ns(this.vertexArray,-1,1,1),Ns(this.vertexArray,1,1,1),Ns(this.vertexArray,-1,-1,-1),Ns(this.vertexArray,1,-1,-1),Ns(this.vertexArray,-1,1,-1),Ns(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=f.createVertexBuffer(this.vertexArray,oE),this.indexBuffer=f.createIndexBuffer(this.indices),this.segment=o.aE.simpleSegment(0,0,36,12)}}function Lc(w,f,v,S,C,E){const R=w.context.gl,B=f.paint.get("sky-atmosphere-color"),G=f.paint.get("sky-atmosphere-halo-color"),j=f.paint.get("sky-atmosphere-sun-intensity"),q=((K,te,ne,le,se)=>({u_matrix_3f:K,u_sun_direction:te,u_sun_intensity:ne,u_color_tint_r:[le.r,le.g,le.b,le.a],u_color_tint_m:[se.r,se.g,se.b,se.a],u_luminance:5e-5}))(o.ct.fromMat4(o.ct.create(),S),C,j,B,G);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+E,f.skyboxTexture,0),v.draw(w,R.TRIANGLES,Pr.disabled,qr.disabled,fn.unblended,Vr.frontCW,q,"skyboxCapture",f.skyboxGeometry.vertexBuffer,f.skyboxGeometry.indexBuffer,f.skyboxGeometry.segment)}const a0=o.aB([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class rm{constructor(f){const v=new o.cW;v.emplaceBack(-1,1,1,0,0),v.emplaceBack(1,1,1,1,0),v.emplaceBack(1,-1,1,1,1),v.emplaceBack(-1,-1,1,0,1);const S=new o.az;S.emplaceBack(0,1,2),S.emplaceBack(2,3,0),this.vertexBuffer=f.createVertexBuffer(v,a0.members),this.indexBuffer=f.createIndexBuffer(S),this.segments=o.aE.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const o0=o.aB([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Rc{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class s0{constructor(f){this.colorModeAlphaBlendedWriteRGB=new fn([1,bv,1,bv],o.aA.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new fn([1,0,1,0],o.aA.transparent,[!1,!1,!1,!0]),this.params=new Rc,this.updateNeeded=!0,f.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),f.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),f.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),f.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(f){const v=f.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new rm(v);const S=this.params.sizeRange,C=this.params.intensityRange,E=function(q){const K=o.aC(30),te=[];for(let ne=0;ne<q;++ne){const le=2*Math.PI*K(),se=Math.acos(1-2*K())-.5*Math.PI;te.push(o.Q.fromValues(Math.cos(se)*Math.cos(le),Math.cos(se)*Math.sin(le),Math.sin(se)))}return te}(this.params.starsCount),R=o.aC(300),B=new o.cX,G=new o.az;let j=0;for(let q=0;q<E.length;++q){const K=o.Q.scale([],E[q],200),te=Math.max(0,1+.01*S*(1*R()-.5)),ne=Math.max(0,1+.01*C*(1*R()-.5));B.emplaceBack(K[0],K[1],K[2],-1,-1,te,ne),B.emplaceBack(K[0],K[1],K[2],1,-1,te,ne),B.emplaceBack(K[0],K[1],K[2],1,1,te,ne),B.emplaceBack(K[0],K[1],K[2],-1,1,te,ne),G.emplaceBack(j+0,j+1,j+2),G.emplaceBack(j+0,j+2,j+3),j+=4}this.starsVx=v.createVertexBuffer(B,o0.members),this.starsIdx=v.createIndexBuffer(G),this.starsSegments=o.aE.simpleSegment(0,0,B.length,G.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(f,v){const S=f.context,C=S.gl,E=f.transform,R=new Pr(C.LEQUAL,Pr.ReadOnly,[0,1]),B=o.W(E.zoom),G=v.properties.get("color").toArray01(),j=v.properties.get("high-color").toArray01(),q=v.properties.get("space-color").toArray01PremultipliedAlpha(),K=5e-4,te=o.cY(v.properties.get("horizon-blend"),0,1,K,.25),ne=o.ci(f,S,E)&&te===K?E.worldSize/(2*Math.PI*1.025)-1:E.globeRadius,le=f.frameCounter/1e3%1,se=o.Q.length(E.globeCenterInViewSpace),ue=Math.sqrt(Math.pow(se,2)-Math.pow(ne,2)),ce=Math.acos(ue/se),ye=Ce=>{const Ae=E.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ce&&Ae.push("ALPHA_PASS");const De=f.getOrCreateProgram("globeAtmosphere",{defines:Ae}),he=((Fe,ze,je,it,Ge,rt,st,Ve,Qe,kt,Ze,nt)=>({u_frustum_tl:Fe,u_frustum_tr:ze,u_frustum_br:je,u_frustum_bl:it,u_horizon:Ge,u_transition:rt,u_fadeout_range:st,u_color:Ve,u_high_color:Qe,u_space_color:kt,u_temporal_offset:Ze,u_horizon_angle:nt}))(E.frustumCorners.TL,E.frustumCorners.TR,E.frustumCorners.BR,E.frustumCorners.BL,E.frustumCorners.horizon,B,te,G,j,q,le,ce);f.uploadCommonUniforms(S,De);const we=this.atmosphereBuffer;we&&De.draw(f,C.TRIANGLES,R,qr.disabled,Ce?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Vr.backCW,he,Ce?"atmosphere_glow_alpha":"atmosphere_glow",we.vertexBuffer,we.indexBuffer,we.segments)};ye(!1),ye(!0)}drawStars(f,v){const S=o.ad(v.properties.get("star-intensity"),0,1);if(S===0)return;const C=f.context,E=C.gl,R=f.transform,B=f.getOrCreateProgram("stars"),G=o.bl.identity([]);o.bl.rotateX(G,G,-R._pitch),o.bl.rotateZ(G,G,-R.angle),o.bl.rotateX(G,G,o.bm(R._center.lat)),o.bl.rotateY(G,G,-o.bm(R._center.lng));const j=o.a9.fromQuat(new Float32Array(16),G),q=o.a9.multiply([],R.starsProjMatrix,j),K=o.ct.fromMat4([],j),te=o.ct.invert([],K),ne=[0,1,0];o.Q.transformMat3(ne,ne,te),o.Q.scale(ne,ne,this.params.sizeMultiplier);const le=[1,0,0];o.Q.transformMat3(le,le,te),o.Q.scale(le,le,this.params.sizeMultiplier);const se=(ue=ne,ce=le,ye=S,{u_matrix:Float32Array.from(q),u_up:ue,u_right:ce,u_intensity_multiplier:ye});var ue,ce,ye;f.uploadCommonUniforms(C,B),this.starsVx&&this.starsIdx&&B.draw(f,E.TRIANGLES,Pr.disabled,qr.disabled,this.colorModeAlphaBlendedWriteRGB,Vr.disabled,se,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function l0(w,f){const v=[...w],S=f.cameraWorldSizeForFog/f.worldSize,C=o.a9.identity([]);return o.a9.scale(C,C,[S,S,1]),o.a9.multiply(v,C,v),o.a9.multiply(v,f.worldToFogMatrix,v),v}function Ru(w,f,v,S){const C=v.material,E=S.context,{baseColorTexture:R,metallicRoughnessTexture:B}=C.pbrMetallicRoughness,{normalTexture:G,occlusionTexture:j,emissionTexture:q}=C;function K(te,ne,le){if(te&&(w.push(ne),E.activeTexture.set(E.gl.TEXTURE0+le),te.gfxTexture)){const{minFilter:se,magFilter:ue,wrapS:ce,wrapT:ye}=te.sampler;te.gfxTexture.bindExtraParam(se,ue,ce,ye)}}K(R,"HAS_TEXTURE_u_baseColorTexture",Co.BaseColor),K(B,"HAS_TEXTURE_u_metallicRoughnessTexture",Co.MetallicRoughness),K(G,"HAS_TEXTURE_u_normalTexture",Co.Normal),K(j,"HAS_TEXTURE_u_occlusionTexture",Co.Occlusion),K(q,"HAS_TEXTURE_u_emissionTexture",Co.Emission),v.texcoordBuffer&&(w.push("HAS_ATTRIBUTE_a_uv_2f"),f.push(v.texcoordBuffer)),v.colorBuffer&&(w.push(v.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),f.push(v.colorBuffer)),v.normalBuffer&&(w.push("HAS_ATTRIBUTE_a_normal_3f"),f.push(v.normalBuffer)),v.pbrBuffer&&(w.push("HAS_ATTRIBUTE_a_pbr"),w.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),f.push(v.pbrBuffer)),C.alphaMode!=="OPAQUE"&&C.alphaMode!=="MASK"||w.push("UNPREMULT_TEXTURE_IN_SHADER"),C.defined||w.push("DIFFUSE_SHADED"),w.push("USE_STANDARD_DERIVATIVES")}function ku(w,f,v,S,C,E){const R=v.paint.get("model-opacity"),B=f.context,G=new Pr(f.context.gl.LEQUAL,Pr.ReadWrite,f.depthRangeFor3D),j=f.transform,q=w.mesh,K=q.material,te=K.pbrMetallicRoughness,ne=f.style.fog;let le;le=f.transform.projection.zAxisUnit==="pixels"?[...w.nodeModelMatrix]:o.a9.multiply([],S.zScaleMatrix,w.nodeModelMatrix),o.a9.multiply(le,S.negCameraPosMatrix,le);const se=o.a9.invert([],le);o.a9.transpose(se,se);const ue=v.paint.get("model-emissive-strength").constantOr(0),ce=Yv(new Float32Array(w.worldViewProjection),new Float32Array(le),new Float32Array(se),null,f,R,te.baseColorFactor,K.emissiveFactor,te.metallicFactor,te.roughnessFactor,K,ue,v),ye={defines:[]},Ce=[];Ru(ye.defines,Ce,q,f);const Ae=f.shadowRenderer;Ae&&(Ae.useNormalOffset=!1);let De=null;if(ne){const Fe=l0(w.nodeModelMatrix,f.transform);if(De=new Float32Array(Fe),j.projection.name!=="globe"){const ze=q.aabb.min,je=q.aabb.max,[it,Ge]=ne.getOpacityForBounds(Fe,ze[0],ze[1],je[0],je[1]);ye.overrideFog=it>=jn||Ge>=jn}}const he=Iu(f,v.paint.get("model-cutoff-fade-range"));he.shouldRenderCutoff&&ye.defines.push("RENDER_CUTOFF");const we=f.getOrCreateProgram("model",ye);f.uploadCommonUniforms(B,we,null,De,he),f.renderPass!=="shadow"&&Ae&&Ae.setupShadowsFromMatrix(w.nodeModelMatrix,we),we.draw(f,B.gl.TRIANGLES,G,C,E,q.material.doubleSided?Vr.disabled:Vr.backCCW,ce,v.id,q.vertexBuffer,q.indexBuffer,q.segments,v.paint,f.transform.zoom,void 0,Ce)}function np(w,f,v,S,C,E,R){let B;B=w.projection.name==="globe"?o.c_(v,w):[...v],o.a9.multiply(B,B,f.matrix);const G=o.a9.multiply([],S,B);if(f.meshes)for(const j of f.meshes){if(j.material.alphaMode!=="BLEND"){R.push({mesh:j,depth:0,modelIndex:C,worldViewProjection:G,nodeModelMatrix:B});continue}const q=o.Q.transformMat4([],j.centroid,G);q[2]>0&&E.push({mesh:j,depth:q[2],modelIndex:C,worldViewProjection:G,nodeModelMatrix:B})}if(f.children)for(const j of f.children)np(w,j,v,S,C,E,R)}function ip(w,f,v,S){const C=v.shadowRenderer;if(!C)return;const E=C.getShadowPassDepthMode(),R=C.getShadowPassColorMode(),B=C.calculateShadowPassMatrixFromMatrix(f),G=Tw(B);v.getOrCreateProgram("modelDepth",{defines:v._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(v,v.context.gl.TRIANGLES,E,qr.disabled,R,Vr.backCCW,G,S.id,w.vertexBuffer,w.indexBuffer,w.segments,S.paint,v.transform.zoom,void 0,void 0)}function ap(w,f,v){const S=f.updateZoomBasedPaintProperties(),C=function(E,R,B){let G,j,q,K=E.terrain?E.terrain.exaggeration():0;if(E.terrain&&K>0){const te=E.terrain,ne=te.findDEMTileFor(B);ne&&ne.dem?G=o.d0.create(te,B,ne):K=0}if(K===0&&(R.terrainElevationMin=0,R.terrainElevationMax=0),K===R.validForExaggeration&&(K===0||G&&G._demTile&&G._demTile.tileID===R.validForDEMTile.id&&G._dem._timestamp===R.validForDEMTile.timestamp))return!1;for(const te in R.instancesPerModel){const ne=R.instancesPerModel[te];for(let le=0;le<ne.instancedDataArray.length;++le){const se=(G?K*G.getElevationAt(0|ne.instancedDataArray.float32[16*le],0|ne.instancedDataArray.float32[16*le+1],!0,!0):0)+ne.instancesEvaluatedElevation[le];ne.instancedDataArray.float32[16*le+6]=se,j=j?Math.min(R.terrainElevationMin,se):se,q=q?Math.max(R.terrainElevationMax,se):se}}return R.terrainElevationMin=j||0,R.terrainElevationMax=q||0,R.validForExaggeration=K,R.validForDEMTile=G&&G._demTile?{id:G._demTile.tileID,timestamp:G._dem._timestamp}:{id:void 0,timestamp:0},!0}(w,f,v);(S||C)&&(f.uploaded=!1,f.upload(w.context))}const Wo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.bV([0,0,0],[o.Y,o.Y,0])};function nm(w,f){const v=1<<w.canonical.z,S=f.getFreeCameraOptions().position,C=f.elevation,E=w.canonical.x/v,R=(w.canonical.x+1)/v,B=w.canonical.y/v,G=(w.canonical.y+1)/v;let j=f._centerAltitude;if(C){const ne=C.getMinMaxForTile(w);ne&&ne.max>j&&(j=ne.max)}const q=o.ad(S.x,E,R)-S.x,K=o.ad(S.y,B,G)-S.y,te=o.bo(j,f.center.lat)-S.z;return f._zoomFromMercatorZ(Math.sqrt(q*q+K*K+te*te))}function im(w,f,v,S,C,E,R){const B=w.context,G=w.renderPass==="shadow",j=w.shadowRenderer,q=G&&j?j.getShadowPassDepthMode():new Pr(B.gl.LEQUAL,Pr.ReadWrite,w.depthRangeFor3D),K=w.isTileAffectedByFog(E);if(v.meshes)for(const te of v.meshes){const ne=["MODEL_POSITION_ON_GPU"],le=[];let se,ue,ce;S.instancedDataArray.length>20&&ne.push("INSTANCED_ARRAYS");const ye=Iu(w,f.paint.get("model-cutoff-fade-range"));if(ye.shouldRenderCutoff&&ne.push("RENDER_CUTOFF"),G&&j)se=w.getOrCreateProgram("modelDepth",{defines:ne}),ue=Tw(R.shadowTileMatrix,R.shadowTileMatrix,Float32Array.from(v.matrix)),ce=j.getShadowPassColorMode();else{Ru(ne,le,te,w),se=w.getOrCreateProgram("model",{defines:ne,overrideFog:K});const Ae=te.material,De=Ae.pbrMetallicRoughness,he=f.paint.get("model-opacity"),we=f.paint.get("model-emissive-strength").constantOr(0);ue=Yv(E.expandedProjMatrix,Float32Array.from(v.matrix),new Float32Array(16),null,w,he,De.baseColorFactor,Ae.emissiveFactor,De.metallicFactor,De.roughnessFactor,Ae,we,f,C),j&&(R.shadowUniformsInitialized?se.setShadowUniformValues(B,j.getShadowUniformValues()):(j.setupShadows(E.toUnwrapped(),se,"model-tile",E.overscaledZ),R.shadowUniformsInitialized=!0)),ce=ye.shouldRenderCutoff||he<1||Ae.alphaMode!=="OPAQUE"?fn.alphaBlended:fn.unblended}w.uploadCommonUniforms(B,se,E.toUnwrapped(),null,ye);const Ce=te.material.doubleSided?Vr.disabled:Vr.backCCW;if(S.instancedDataArray.length>20)le.push(S.instancedDataBuffer),se.draw(w,B.gl.TRIANGLES,q,qr.disabled,ce,Ce,ue,f.id,te.vertexBuffer,te.indexBuffer,te.segments,f.paint,w.transform.zoom,void 0,le,S.instancedDataArray.length);else{const Ae=G?"u_instance":"u_normal_matrix";for(let De=0;De<S.instancedDataArray.length;++De)ue[Ae]=new Float32Array(S.instancedDataArray.arrayBuffer,64*De,16),se.draw(w,B.gl.TRIANGLES,q,qr.disabled,ce,Ce,ue,f.id,te.vertexBuffer,te.indexBuffer,te.segments,f.paint,w.transform.zoom,void 0,le)}}if(v.children)for(const te of v.children)im(w,f,te,S,C,E,R)}const am=[1,-1,1];function op(w,f,v,S){if(!v.modelManager)return!0;const C=v.modelManager;if(!v.shadowRenderer)return!0;const E=v.shadowRenderer,R=f.aabb;let B=!0,G=w.maxHeight;if(G===0){let q=0;for(const K in w.instancesPerModel){const te=C.getModel(K,S);te?q=Math.max(q,Math.max(Math.max(te.aabb.max[0],te.aabb.max[1]),te.aabb.max[2])):B=!1}G=w.maxScale*q*1.41+w.maxVerticalOffset,B&&(w.maxHeight=G)}R.max[2]=G,R.min[2]+=w.terrainElevationMin,R.max[2]+=w.terrainElevationMax,o.Q.transformMat4(R.min,R.min,f.tileMatrix),o.Q.transformMat4(R.max,R.max,f.tileMatrix);const j=R.intersects(E.getCurrentCascadeFrustum());return v.currentShadowCascade===0&&(w.isInsideFirstShadowMapFrustum=j===2),j===0}class Rw{}class kw{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(f,v,S){{const K=this._storage.get(v.id);if(K)return K.lastUsedFrameIdx=f,K.buf}const C=S.gl,E=C.getBufferParameter(C.ELEMENT_ARRAY_BUFFER,C.BUFFER_SIZE),R=new ArrayBuffer(E),B=new Int16Array(R);C.getBufferSubData(C.ELEMENT_ARRAY_BUFFER,0,new Int16Array(R));const G=new o.d2;for(let K=0;K<E/2;K+=3){const te=B[K],ne=B[K+1],le=B[K+2];G.emplaceBack(te,ne),G.emplaceBack(ne,le),G.emplaceBack(le,te)}const j=S.bindVertexArrayOES.current,q=new Rw;return q.buf=new yi(S,G),q.lastUsedFrameIdx=f,this._storage.set(v.id,q),S.bindVertexArrayOES.set(j),q.buf}update(f){for(const[v,S]of this._storage)f-S.lastUsedFrameIdx>30&&(S.buf.destroy(),this._storage.delete(v))}destroy(){for(const[f,v]of this._storage)v.buf.destroy(),this._storage.delete(f)}}const om={symbol:function(w,f,v,S,C){if(w.renderPass!=="translucent")return;const E=qr.disabled,R=w.colorModeForRenderPass();v.layout.get("text-variable-anchor")&&function(j,q,K,te,ne,le,se){const ue=q.transform,ce=ne==="map",ye=le==="map";for(const Ce of j){const Ae=te.getTile(Ce),De=Ae.getBucket(K);if(!De||!De.text||!De.text.segments.get().length)continue;const he=o.b8(De.textSizeData,ue.zoom),we=Dv(Ce,De.getProjection(),ue),Fe=ue.calculatePixelsToTileUnitsMatrix(Ae),ze=Rd(we,Ae.tileID.canonical,ye,ce,ue,De.getProjection(),Fe),je=De.hasIconTextFit()&&De.hasIconData();if(he){const it=Math.pow(2,ue.zoom-Ae.tileID.overscaledZ);Aw(De,ce,ye,se,o.cE,ue,ze,Ce,it,he,je)}}}(S,w,v,f,v.layout.get("text-rotation-alignment"),v.layout.get("text-pitch-alignment"),C);const B=v.paint.get("icon-opacity").constantOr(1)!==0,G=v.paint.get("text-opacity").constantOr(1)!==0;v.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(B||G)?rp(w,f,v,S,E,R):(B&&rp(w,f,v,S,E,R,{onlyIcons:!0}),G&&rp(w,f,v,S,E,R,{onlyText:!0})),f.map.showCollisionBoxes&&(Jy(w,f,v,S,v.paint.get("text-translate"),v.paint.get("text-translate-anchor"),!0),Jy(w,f,v,S,v.paint.get("icon-translate"),v.paint.get("icon-translate-anchor"),!1))},circle:function(w,f,v,S){if(w.renderPass!=="translucent")return;const C=v.paint.get("circle-opacity"),E=v.paint.get("circle-stroke-width"),R=v.paint.get("circle-stroke-opacity"),B=v.layout.get("circle-sort-key").constantOr(1)!==void 0,G=v.paint.get("circle-emissive-strength");if(C.constantOr(1)===0&&(E.constantOr(1)===0||R.constantOr(1)===0))return;const j=w.context,q=j.gl,K=w.transform,te=w.depthModeForSublayer(0,Pr.ReadOnly),ne=qr.disabled,le=w.colorModeForDrapableLayerRenderPass(G),se=K.projection.name==="globe",ue=[o.a8(K.center.lng),o.ah(K.center.lat)],ce=[];for(let Ce=0;Ce<S.length;Ce++){const Ae=S[Ce],De=f.getTile(Ae),he=De.getBucket(v);if(!he||he.projection.name!==K.projection.name)continue;const we=he.programConfigurations.get(v.id),Fe=o.cF(v),ze=w.isTileAffectedByFog(Ae);se&&Fe.push("PROJECTION_GLOBE_VIEW");const je=w.getOrCreateProgram("circle",{config:we,defines:Fe,overrideFog:ze}),it=he.layoutVertexBuffer,Ge=he.globeExtVertexBuffer,rt=he.indexBuffer,st=K.projection.createInversionMatrix(K,Ae.canonical),Ve={programConfiguration:we,program:je,layoutVertexBuffer:it,globeExtVertexBuffer:Ge,indexBuffer:rt,uniformValues:o.cG(w,Ae,De,st,ue,v),tile:De};if(B){const Qe=he.segments.get();for(const kt of Qe)ce.push({segments:new o.aE([kt]),sortKey:kt.sortKey,state:Ve})}else ce.push({segments:he.segments,sortKey:0,state:Ve})}B&&ce.sort((Ce,Ae)=>Ce.sortKey-Ae.sortKey);const ye={useDepthForOcclusion:K.depthOcclusionForSymbolsAndCircles};for(const Ce of ce){const{programConfiguration:Ae,program:De,layoutVertexBuffer:he,globeExtVertexBuffer:we,indexBuffer:Fe,uniformValues:ze,tile:je}=Ce.state,it=Ce.segments;w.terrain&&w.terrain.setupElevationDraw(je,De,ye),w.uploadCommonUniforms(j,De,je.tileID.toUnwrapped()),De.draw(w,q.TRIANGLES,te,ne,le,Vr.disabled,ze,v.id,he,Fe,it,v.paint,K.zoom,Ae,[we])}},heatmap:function(w,f,v,S){if(v.paint.get("heatmap-opacity")!==0)if(w.renderPass==="offscreen"){const C=w.context,E=C.gl,R=qr.disabled,B=new fn([E.ONE,E.ONE,E.ONE,E.ONE],o.aA.transparent,[!0,!0,!0,!0]);(function(ne,le,se,ue){const ce=ne.gl,ye=le.width*ue,Ce=le.height*ue;ne.activeTexture.set(ce.TEXTURE1),ne.viewport.set([0,0,ye,Ce]);let Ae=se.heatmapFbo;if(!Ae||Ae&&(Ae.width!==ye||Ae.height!==Ce)){Ae&&Ae.destroy();const De=ce.createTexture();ce.bindTexture(ce.TEXTURE_2D,De),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MAG_FILTER,ce.LINEAR),Ae=se.heatmapFbo=ne.createFramebuffer(ye,Ce,!0,null),function(he,we,Fe,ze,je,it){const Ge=he.gl;Ge.texImage2D(Ge.TEXTURE_2D,0,he.extRenderToTextureHalfFloat?Ge.RGBA16F:Ge.RGBA,je,it,0,Ge.RGBA,he.extRenderToTextureHalfFloat?Ge.HALF_FLOAT:Ge.UNSIGNED_BYTE,null),ze.colorAttachment.set(Fe)}(ne,0,De,Ae,ye,Ce)}else ce.bindTexture(ce.TEXTURE_2D,Ae.colorAttachment.get()),ne.bindFramebuffer.set(Ae.framebuffer)})(C,w,v,w.transform.projection.name==="globe"?.5:.25),C.clear({color:o.aA.transparent});const G=w.transform,j=G.projection.name==="globe",q=j?["PROJECTION_GLOBE_VIEW"]:[],K=j?Vr.frontCCW:Vr.disabled,te=[o.a8(G.center.lng),o.ah(G.center.lat)];for(let ne=0;ne<S.length;ne++){const le=S[ne];if(f.hasRenderableParent(le))continue;const se=f.getTile(le),ue=se.getBucket(v);if(!ue||ue.projection.name!==G.projection.name)continue;const ce=w.isTileAffectedByFog(le),ye=ue.programConfigurations.get(v.id),Ce=w.getOrCreateProgram("heatmap",{config:ye,defines:q,overrideFog:ce}),{zoom:Ae}=w.transform;w.terrain&&w.terrain.setupElevationDraw(se,Ce),w.uploadCommonUniforms(C,Ce,le.toUnwrapped());const De=G.projection.createInversionMatrix(G,le.canonical);Ce.draw(w,E.TRIANGLES,Pr.disabled,R,B,K,KI(w,le,se,De,te,Ae,v.paint.get("heatmap-intensity")),v.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,v.paint,w.transform.zoom,ye,j?[ue.globeExtVertexBuffer]:null)}C.viewport.set([0,0,w.width,w.height])}else w.renderPass==="translucent"&&(w.context.setColorMode(w.colorModeForRenderPass()),function(C,E){const R=C.context,B=R.gl,G=E.heatmapFbo;if(!G)return;R.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,G.colorAttachment.get()),R.activeTexture.set(B.TEXTURE1);let j=E.colorRampTexture;j||(j=E.colorRampTexture=new o.T(R,E.colorRamp,B.RGBA)),j.bind(B.LINEAR,B.CLAMP_TO_EDGE),C.getOrCreateProgram("heatmapTexture").draw(C,B.TRIANGLES,Pr.disabled,qr.disabled,C.colorModeForRenderPass(),Vr.disabled,((q,K,te,ne)=>({u_image:0,u_color_ramp:1,u_opacity:K.paint.get("heatmap-opacity")}))(0,E),E.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,E.paint,C.transform.zoom)}(w,v))},line:function(w,f,v,S){if(w.renderPass!=="translucent")return;const C=v.paint.get("line-opacity"),E=v.paint.get("line-width");if(C.constantOr(1)===0||E.constantOr(1)===0)return;const R=v.paint.get("line-emissive-strength"),B=w.depthModeForSublayer(0,Pr.ReadOnly),G=w.colorModeForDrapableLayerRenderPass(R),j=w.terrain&&w.terrain.renderingToTexture?1:o.f.devicePixelRatio,q=v.paint.get("line-dasharray"),K=q.constantOr(1),te=v.layout.get("line-cap"),ne=v.paint.get("line-pattern"),le=ne.constantOr(1),se=v.paint.get("line-opacity").constantOr(1)!==1;let ue=!le&&se;const ce=v.paint.get("line-gradient"),ye=le?"linePattern":"line",Ce=w.context,Ae=Ce.gl,De=o.cH(v);w.terrain&&w.terrain.clipOrMaskOverlapStencilType()&&(ue=!1);for(const he of S){const we=f.getTile(he);if(le&&!we.patternsLoaded())continue;const Fe=we.getBucket(v);if(!Fe)continue;w.prepareDrawTile();const ze=Fe.programConfigurations.get(v.id),je=w.isTileAffectedByFog(he),it=w.getOrCreateProgram(ye,{config:ze,defines:De,overrideFog:je}),Ge=ne.constantOr(null);if(Ge&&we.imageAtlas){const ot=we.imageAtlas.patternPositions[Ge.toString()];ot&&ze.setConstantPatternPositions(ot)}const rt=q.constantOr(null),st=te.constantOr(null);if(!le&&rt&&st&&we.lineAtlas){const ot=we.lineAtlas.getDash(rt,st);ot&&ze.setConstantPatternPositions(ot)}let[Ve,Qe]=v.paint.get("line-trim-offset");(st==="round"||st==="square")&&Ve!==Qe&&(Ve===0&&(Ve-=1),Qe===1&&(Qe+=1));const kt=w.terrain?he.projMatrix:null,Ze=le?o.cI(w,we,v,kt,j,[Ve,Qe]):o.cJ(w,we,v,kt,Fe.lineClipsArray.length,j,[Ve,Qe]);if(ce){const ot=Fe.gradients[v.id];let Me=ot.texture;if(v.gradientVersion!==ot.version){let Tt=256;if(v.stepInterpolant){const lr=f.getSource().maxzoom,vr=he.canonical.z===lr?Math.ceil(1<<w.transform.maxZoom-he.canonical.z):1;Tt=o.ad(o.cK(Fe.maxLineLength/o.Y*1024*vr),256,Ce.maxTextureSize)}ot.gradient=o.cL({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:Tt,image:ot.gradient||void 0,clips:Fe.lineClipsArray}),ot.texture?ot.texture.update(ot.gradient):ot.texture=new o.T(Ce,ot.gradient,Ae.RGBA),ot.version=v.gradientVersion,Me=ot.texture}Ce.activeTexture.set(Ae.TEXTURE1),Me.bind(v.stepInterpolant?Ae.NEAREST:Ae.LINEAR,Ae.CLAMP_TO_EDGE)}K&&(Ce.activeTexture.set(Ae.TEXTURE0),we.lineAtlasTexture&&we.lineAtlasTexture.bind(Ae.LINEAR,Ae.REPEAT),ze.updatePaintBuffers()),le&&(Ce.activeTexture.set(Ae.TEXTURE0),we.imageAtlasTexture&&we.imageAtlasTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),ze.updatePaintBuffers()),w.uploadCommonUniforms(Ce,it,he.toUnwrapped());const nt=ot=>{it.draw(w,Ae.TRIANGLES,B,ot,G,Vr.disabled,Ze,v.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,v.paint,w.transform.zoom,ze,[Fe.layoutVertexBuffer2,Fe.patternVertexBuffer])};if(ue){const ot=w.stencilModeForClipping(he).ref;ot===0&&w.terrain&&Ce.clear({stencil:0});const Me={func:Ae.EQUAL,mask:255};Ze.u_alpha_discard_threshold=.8,nt(new qr(Me,ot,255,Ae.KEEP,Ae.KEEP,Ae.INVERT)),Ze.u_alpha_discard_threshold=0,nt(new qr(Me,ot,255,Ae.KEEP,Ae.KEEP,Ae.KEEP))}else nt(w.stencilModeForClipping(he))}ue&&(w.resetStencilClippingMasks(),w.terrain&&Ce.clear({stencil:0}))},fill:function(w,f,v,S){const C=v.paint.get("fill-color"),E=v.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const R=v.paint.get("fill-emissive-strength"),B=w.colorModeForDrapableLayerRenderPass(R),G=v.paint.get("fill-pattern"),j=w.opaquePassEnabledForLayer()&&!G.constantOr(1)&&C.constantOr(o.aA.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(w.renderPass===j){const q=w.depthModeForSublayer(1,w.renderPass==="opaque"?Pr.ReadWrite:Pr.ReadOnly);Qv(w,f,v,S,q,B,!1)}if(w.renderPass==="translucent"&&v.paint.get("fill-antialias")){const q=w.depthModeForSublayer(v.getPaintProperty("fill-outline-color")?2:0,Pr.ReadOnly);Qv(w,f,v,S,q,B,!0)}},"fill-extrusion":function(w,f,v,S){const C=v.paint.get("fill-extrusion-opacity"),E=w.context,R=E.gl,B=w.terrain,G=B&&B.renderingToTexture;if(C===0)return;const j=w.conflationActive&&w.layerUsedInConflation(v,f.getSource());if(j&&function(q,K,te,ne){for(const le of ne){const se=K.getTile(le).getBucket(te);se&&(se.updateReplacement(le,q.replacementSource),se.uploadCentroid(q.context))}}(w,f,v,S),B||j)for(const q of S){const K=f.getTile(q).getBucket(v);K&&t0(w.context,f,q,K,v,B,j)}if(w.renderPass==="shadow"&&w.shadowRenderer){const q=w.shadowRenderer;if(B&&C<.65&&v._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.Z)return;const K=q.getShadowPassDepthMode(),te=q.getShadowPassColorMode();ir(w,f,v,S,K,qr.disabled,te,j)}else if(w.renderPass==="translucent"){const q=!v.paint.get("fill-extrusion-pattern").constantOr(1),K=v.paint.get("fill-extrusion-color").constantOr(o.aA.white);if(!G&&K.a!==0){const te=new Pr(w.context.gl.LEQUAL,Pr.ReadWrite,w.depthRangeFor3D);C===1&&q?ir(w,f,v,S,te,qr.disabled,fn.unblended,j):(ir(w,f,v,S,te,qr.disabled,fn.disabled,j),ir(w,f,v,S,te,w.stencilModeFor3D(),w.colorModeForRenderPass(),j),w.resetStencilClippingMasks())}if(w.style.enable3dLights()&&q&&(!B&&w.transform.projection.name!=="globe"||G)){const te=v.paint.get("fill-extrusion-opacity"),ne=v.paint.get("fill-extrusion-ambient-occlusion-intensity"),le=v.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),se=v.paint.get("fill-extrusion-flood-light-intensity"),ue=v.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ce=ne>0&&le>0,ye=se>0,Ce=(De,he,we)=>(1-we)*De+we*he,Ae=De=>{const he=w.depthModeForSublayer(1,Pr.ReadOnly,R.LEQUAL,!0),we=v.paint.get(De?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Fe=Ce(.1,3,we),ze=w._showOverdrawInspector;if(!ze){const je=new qr({func:R.ALWAYS,mask:255},255,255,R.KEEP,R.KEEP,R.REPLACE),it=new fn([R.ONE,R.ONE,R.ONE,R.ONE],o.aA.transparent,[!1,!1,!1,!0],R.MIN);Pc(w,f,v,S,he,je,it,Vr.disabled,De,"sdf",te,ne,le,se,ue,Fe,j,!1)}{const je=ze?qr.disabled:new qr({func:R.EQUAL,mask:255},255,255,R.KEEP,R.DECR,R.DECR),it=ze?w.colorModeForRenderPass():new fn([R.ONE_MINUS_DST_ALPHA,R.DST_ALPHA,R.ONE,R.ONE],o.aA.transparent,[!0,!0,!0,!0]);Pc(w,f,v,S,he,je,it,Vr.disabled,De,"color",te,ne,le,se,ue,Fe,j,!1)}};if(G){const De=(he,we,Fe)=>{const ze=w.depthModeForSublayer(1,Pr.ReadOnly,R.LEQUAL,!1),je=v.paint.get(he?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),it=Ce(.1,3,je);{const Ge=new fn([R.ONE,R.ONE,R.ONE,R.ONE],o.aA.transparent,[!1,!1,!1,!0]);Pc(w,f,v,S,ze,qr.disabled,Ge,Vr.disabled,he,"clear",te,ne,le,se,ue,it,j,we)}{const Ge=new qr({func:R.ALWAYS,mask:255},255,255,R.KEEP,R.KEEP,R.REPLACE),rt=new fn([R.ONE,R.ONE,R.ONE,R.ONE],o.aA.transparent,[!1,!1,!1,!0],R.MIN);Pc(w,f,v,S,ze,Ge,rt,Vr.disabled,he,"sdf",te,ne,le,se,ue,it,j,we)}{const Ge=he?R.ZERO:R.ONE_MINUS_DST_ALPHA,rt=new qr({func:R.EQUAL,mask:255},255,255,R.KEEP,R.DECR,R.DECR),st=new fn([Ge,R.DST_ALPHA,R.ONE_MINUS_DST_ALPHA,R.ZERO],o.aA.transparent,[!0,!0,!0,!0]);Pc(w,f,v,S,ze,rt,st,Vr.disabled,he,"color",te,ne,le,se,ue,it,j,we)}{const Ge=new fn([R.ONE,R.ONE,R.ONE,he?R.ZERO:R.ONE],o.aA.transparent,[!1,!1,!1,!0],he?R.FUNC_ADD:R.MAX);Pc(w,f,v,S,ze,qr.disabled,Ge,Vr.disabled,he,"clear",te,ne,le,se,ue,it,j,we,Fe)}};if(ce||ye){let he;if(w.prepareDrawTile(),B){const we=B.drapeBufferSize[0],Fe=B.drapeBufferSize[1];he=B.framebufferCopyTexture,he&&(!he||he.size[0]===we&&he.size[1]===Fe)||(he&&he.destroy(),he=B.framebufferCopyTexture=new o.T(E,new o.h({width:we,height:Fe}),R.RGBA)),he.bind(R.LINEAR,R.CLAMP_TO_EDGE),R.copyTexImage2D(R.TEXTURE_2D,0,R.RGBA,0,0,we,Fe,0)}ce&&De(!0,!1,he),ye&&De(!1,!0,he)}}else ce&&Ae(!0),ye&&Ae(!1)}}},hillshade:function(w,f,v,S){if(w.renderPass!=="offscreen"&&w.renderPass!=="translucent"||w.style.disableElevatedTerrain)return;const C=w.context,E=w.terrain&&w.terrain.renderingToTexture,[R,B]=w.renderPass!=="translucent"||E?[{},S]:w.stencilConfigForOverlap(S);for(const G of B){const j=f.getTile(G);if(j.needsHillshadePrepare&&w.renderPass==="offscreen")zh(w,j,v);else if(w.renderPass==="translucent"){const q=w.depthModeForSublayer(0,Pr.ReadOnly),K=v.paint.get("hillshade-emissive-strength"),te=w.colorModeForDrapableLayerRenderPass(K),ne=E&&w.terrain?w.terrain.stencilModeForRTTOverlap(G):R[G.overscaledZ];Yn(w,G,j,v,q,ne,te)}}C.viewport.set([0,0,w.width,w.height]),w.resetStencilClippingMasks()},raster:function(w,f,v,S,C,E){if(w.renderPass!=="translucent"||v.paint.get("raster-opacity")===0)return;const R=w.transform.projection.name==="globe",B=v.paint.get("raster-elevation")!==0,G=B&&R;if(w.renderElevatedRasterBackface&&!G)return;const j=w.context,q=j.gl,K=f.getSource(),te=function(he,we,Fe,ze){const je=we.paint.get("raster-color"),it=he.type==="raster-array",Ge=[],rt=we.paint.get("raster-resampling"),st=we.paint.get("raster-color-mix");let Ve=we.paint.get("raster-color-range");const Qe=[st[0],st[1],st[2],0],kt=st[3];let Ze=rt==="nearest"?ze.NEAREST:ze.LINEAR;if(it&&(Ge.push("RASTER_ARRAY"),je||Ge.push("RASTER_COLOR"),rt==="linear"&&Ge.push("RASTER_ARRAY_LINEAR"),Ze=ze.NEAREST,!Ve&&he.rasterLayers)){const nt=he.rasterLayers.find(({id:ot})=>ot===we.sourceLayer);nt&&nt.fields&&nt.fields.range&&(Ve=nt.fields.range)}if(Ve=Ve||[0,1],je){Ge.push("RASTER_COLOR"),Fe.activeTexture.set(ze.TEXTURE2),we.updateColorRamp(Ve);let nt=we.colorRampTexture;nt||(nt=we.colorRampTexture=new o.T(Fe,we.colorRamp,ze.RGBA)),nt.bind(ze.LINEAR,ze.CLAMP_TO_EDGE)}return{mix:Qe,range:Ve,offset:kt,defines:Ge,resampling:Ze}}(K,v,j,q);if(K instanceof o.as&&!S.length&&!R)return;const ne=v.paint.get("raster-emissive-strength"),le=w.colorModeForDrapableLayerRenderPass(ne),se=w.terrain&&w.terrain.renderingToTexture,ue=!w.options.moving,ce=v.paint.get("raster-resampling")==="nearest"?q.NEAREST:q.LINEAR;if(K instanceof o.as&&!S.length&&(K.onNorthPole||K.onSouthPole)){const he=B?w.stencilModeFor3D():qr.disabled;return void ql(!!K.onNorthPole,null,w,f,v,ne,te,Vr.disabled,he)}if(!S.length)return;const[ye,Ce]=K instanceof o.as||se?[{},S]:w.stencilConfigForOverlap(S),Ae=Ce[Ce.length-1].overscaledZ;G&&te.defines.push("PROJECTION_GLOBE_VIEW"),B&&te.defines.push("RENDER_CUTOFF");const De=(he,we,Fe)=>{for(const ze of he){const je=ze.toUnwrapped(),it=f.getTile(ze);if(se&&(!it||!it.hasData()))continue;j.activeTexture.set(q.TEXTURE0);const Ge=Uh(it,K,v,te);if(!Ge||!Ge.texture)continue;const{texture:rt,mix:st,offset:Ve,tileSize:Qe,buffer:kt}=Ge;let Ze,nt;se?(Ze=Pr.disabled,nt=ze.projMatrix):B?(Ze=new Pr(q.LEQUAL,Pr.ReadWrite,w.depthRangeFor3D),nt=R?Float32Array.from(w.transform.expandedFarZProjMatrix):w.transform.calculateProjMatrix(je,ue)):(Ze=w.depthModeForSublayer(ze.overscaledZ-Ae,v.paint.get("raster-opacity")===1?Pr.ReadWrite:Pr.ReadOnly,q.LESS),nt=w.transform.calculateProjMatrix(je,ue));const ot=w.terrain&&se?w.terrain.stencilModeForRTTOverlap(ze):ye[ze.overscaledZ],Me=E?0:v.paint.get("raster-fade-duration");it.registerFadeDuration(Me);const Tt=f.findLoadedParent(ze,0),lr=Ic(it,Tt,f,w.transform,Me);let vr,Ar;w.terrain&&w.terrain.prepareDrawTile(),j.activeTexture.set(q.TEXTURE0),rt.bind(ce,q.CLAMP_TO_EDGE),j.activeTexture.set(q.TEXTURE1),Tt?(Tt.texture&&Tt.texture.bind(ce,q.CLAMP_TO_EDGE),vr=Math.pow(2,Tt.tileID.overscaledZ-it.tileID.overscaledZ),Ar=[it.tileID.canonical.x*vr%1,it.tileID.canonical.y*vr%1]):rt.bind(ce,q.CLAMP_TO_EDGE),rt.useMipmap&&j.extTextureFilterAnisotropic&&w.transform.pitch>20&&q.texParameterf(q.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const xr=w.transform;let Dr;const Sn=B?em(xr):[0,0,0,0];let Zr,Pn,Tn,Di,ei,ua=0;if(G&&K instanceof o.as&&K.coordinates.length>3)Zr=Float32Array.from(o.aW(o.cn(new o.bv(0,0,0)))),Pn=Float32Array.from(xr.globeMatrix),Tn=Float32Array.from(o.cj(xr)),Di=[o.a8(xr.center.lng),o.ah(xr.center.lat)],Dr=K.elevatedGlobePerspectiveTransform,ei=K.elevatedGlobeGridMatrix||new Float32Array(9);else if(G){const nn=o.ck(ze.canonical);ua=o.cl(nn.getCenter().lat),Zr=Float32Array.from(o.aW(o.cn(ze.canonical))),Pn=Float32Array.from(xr.globeMatrix),Tn=Float32Array.from(o.cj(xr)),Di=[o.a8(xr.center.lng),o.ah(xr.center.lat)],Dr=[0,0],ei=Float32Array.from(o.cm(ze.canonical,nn,ua,xr.worldSize/xr._pixelsPerMercatorPixel))}else Dr=K instanceof o.as?K.perspectiveTransform:[0,0],Zr=new Float32Array(16),Pn=new Float32Array(9),Tn=new Float32Array(16),Di=[0,0],ei=new Float32Array(9);const Ji=Sw(nt,Zr,Pn,Tn,ei,Ar||[0,0],o.W(w.transform.zoom),Di,Sn,vr||1,lr,v,Dr,B?v.paint.get("raster-elevation"):0,2,st,Ve,te.range,Qe,kt,ne),di=w.isTileAffectedByFog(ze),oi=w.getOrCreateProgram("raster",{defines:te.defines,overrideFog:di});if(w.uploadCommonUniforms(j,oi,je),K instanceof o.as){const nn=K.elevatedGlobeVertexBuffer,sn=K.elevatedGlobeIndexBuffer;if(se||!R)K.boundsBuffer&&K.boundsSegments&&oi.draw(w,q.TRIANGLES,Ze,qr.disabled,le,Vr.disabled,Ji,v.id,K.boundsBuffer,w.quadTriangleIndexBuffer,K.boundsSegments);else if(nn&&sn){const Ti=xr.zoom<=o.bJ?K.elevatedGlobeSegments:K.getSegmentsForLongitude(xr.center.lng);Ti&&oi.draw(w,q.TRIANGLES,Ze,qr.disabled,le,we,Ji,v.id,nn,sn,Ti)}}else if(G){Ze=new Pr(q.LEQUAL,Pr.ReadOnly,w.depthRangeFor3D);const nn=w.globeSharedBuffers;if(nn){const[sn,Ti,pi]=nn.getGridBuffers(ua,!1);oi.draw(w,q.TRIANGLES,Ze,Fe||ot,w.colorModeForRenderPass(),we,Ji,v.id,sn,Ti,pi)}}else{const{tileBoundsBuffer:nn,tileBoundsIndexBuffer:sn,tileBoundsSegments:Ti}=w.getTileBoundsBuffers(it);oi.draw(w,q.TRIANGLES,Ze,ot,le,Vr.disabled,Ji,v.id,nn,sn,Ti)}}if(!(K instanceof o.as)&&G)for(const ze of he){const je=ze.canonical.y===(1<<ze.canonical.z)-1;ze.canonical.y===0&&ql(!0,ze,w,f,v,ne,te,we,Fe||qr.disabled),je&&ql(!1,ze,w,f,v,ne,te,we===Vr.frontCW?Vr.backCW:Vr.frontCW,Fe||qr.disabled)}};G?De(Ce,w.renderElevatedRasterBackface?Vr.backCW:Vr.frontCW,w.stencilModeFor3D()):De(Ce,Vr.disabled,void 0),w.resetStencilClippingMasks()},"raster-particle":function(w,f,v,S,C,E){w.renderPass==="offscreen"&&function(R,B,G,j){if(!j.length)return;const q=R.context,K=q.gl,te=B.getSource();if(!(te instanceof Kt))return;const ne=Math.ceil(Math.sqrt(G.paint.get("raster-particle-count")));let le=G.particleFramebuffer;le?le.width!==ne&&(le.destroy(),le=G.particleFramebuffer=q.createFramebuffer(ne,ne,!0,null)):le=G.particleFramebuffer=q.createFramebuffer(ne,ne,!0,null);const se=[];for(const ye of j){const Ce=B.getTile(ye);if(!(Ce instanceof Sv))continue;const Ae=nE(Ce,te,G);if(!Ae)continue;const De=[Ce.tileSize,Ce.tileSize];let he=G.tileFramebuffer;he||(he=G.tileFramebuffer=q.createFramebuffer(De[0],De[1],!0,null));let we=Ce.rasterParticleState;we||(we=Ce.rasterParticleState=new sw(q,ye,De,ne));const Fe=we.update(G.lastInvalidatedAt);we.particleTextureDimension!==ne&&we.setParticleTextureDimension(ye,ne);const ze=we.targetColorTexture;we.targetColorTexture=we.backgroundColorTexture,we.backgroundColorTexture=ze;const je=we.particleTexture0;we.particleTexture0=we.particleTexture1,we.particleTexture1=je,se.push([ye,Ae,we,Fe])}if(se.length===0)return;const ue=o.f.now(),ce=G.previousDrawTimestamp?.001*(ue-G.previousDrawTimestamp):.0167;if(G.previousDrawTimestamp=ue,G.hasColorMap()){q.activeTexture.set(K.TEXTURE0+2);let ye=G.colorRampTexture;ye||(ye=G.colorRampTexture=new o.T(q,G.colorRamp,K.RGBA)),ye.bind(K.LINEAR,K.CLAMP_TO_EDGE)}q.bindFramebuffer.set(G.tileFramebuffer.framebuffer),function(ye,Ce,Ae){const De=ye.context,he=De.gl,we=Ce.tileFramebuffer;De.activeTexture.set(he.TEXTURE0);const Fe={u_texture:0,u_opacity:1.05*(je=Ce.paint.get("raster-particle-fade-opacity-factor"))/(je+.05)},ze=ye.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var je;for(const it of Ae){const[,,Ge,rt]=it;we.colorAttachment.set(Ge.targetColorTexture.texture),De.viewport.set([0,0,we.width,we.height]),De.clear({color:o.aA.transparent}),rt&&(Ge.backgroundColorTexture.bind(he.NEAREST,he.CLAMP_TO_EDGE),ze.draw(ye,he.TRIANGLES,Pr.disabled,qr.disabled,fn.alphaBlended,Vr.disabled,Fe,Ce.id,ye.viewportBuffer,ye.quadTriangleIndexBuffer,ye.viewportSegments))}}(R,G,se),function(ye,Ce,Ae,De){const he=ye.context,we=he.gl,Fe=Ae.tileFramebuffer,ze=ye.transform.projection.name==="globe",je=Ae.paint.get("raster-particle-max-speed");for(const it of De){const[Ge,rt,st]=it;he.activeTexture.set(we.TEXTURE0+0),rt.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE),Fe.colorAttachment.set(st.targetColorTexture.texture);const Ve=ye.getOrCreateProgram("rasterParticleDraw",{defines:rt.defines,overrideFog:!1});he.activeTexture.set(we.TEXTURE0+1);const Qe=rt.scalarData?[]:[0,1,2,3].map(nt=>o.cN[nt](Ge));Qe.push(Ge);const kt=Ge.canonical.x,Ze=Ge.canonical.y;for(const nt of Qe){const ot=Ce.getTile(ze?nt.wrapped():nt);if(!ot)continue;const Me=ot.rasterParticleState;if(!Me)continue;const Tt=nt.canonical.x+(1<<nt.canonical.z)*(nt.wrap-Ge.wrap),lr=nt.canonical.y;Me.particleTexture0.bind(we.NEAREST,we.CLAMP_TO_EDGE);const vr=Jd(1,Me.particleTexture0.size[0],[Tt-kt,lr-Ze],0,rt.texture.size,2,je,rt.textureOffset,rt.scale,rt.offset);Ve.draw(ye,we.POINTS,Pr.disabled,qr.disabled,fn.alphaBlended,Vr.disabled,vr,Ae.id,Me.particleIndexBuffer,void 0,Me.particleSegment)}}}(R,B,G,se),q.bindFramebuffer.set(G.particleFramebuffer.framebuffer),function(ye,Ce,Ae,De){const he=ye.context,we=he.gl,Fe=Ce.paint.get("raster-particle-max-speed"),ze=De*Ce.paint.get("raster-particle-speed-factor")*.3,je=function(Ge){return Math.pow(Ge,6)}(.01+1*Ce.paint.get("raster-particle-reset-rate-factor")),it=Ce.particleFramebuffer;he.viewport.set([0,0,it.width,it.height]);for(const Ge of Ae){const[,rt,st]=Ge;he.activeTexture.set(we.TEXTURE0+0),rt.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE),he.activeTexture.set(we.TEXTURE0+1);const Ve=st.particleTexture0;Ve.bind(we.NEAREST,we.CLAMP_TO_EDGE);const Qe=eE(1,Ve.size[0],0,rt.texture.size,Fe,ze,je,rt.textureOffset,rt.scale,rt.offset);it.colorAttachment.set(st.particleTexture1.texture),he.clear({color:o.aA.transparent}),ye.getOrCreateProgram("rasterParticleUpdate",{defines:rt.defines}).draw(ye,we.TRIANGLES,Pr.disabled,qr.disabled,fn.unblended,Vr.disabled,Qe,Ce.id,ye.viewportBuffer,ye.quadTriangleIndexBuffer,ye.viewportSegments)}}(R,G,se,ce)}(w,f,v,S),w.renderPass==="translucent"&&(function(R,B,G,j,q){const K=R.context,te=K.gl,ne=!R.options.moving,le=R.transform.projection.name==="globe";if(!j.length)return;const[se,ue]=R.stencilConfigForOverlap(j),ce=[];le&&ce.push("PROJECTION_GLOBE_VIEW");const ye=R.stencilModeFor3D();for(const Ce of ue){const Ae=Ce.toUnwrapped(),De=B.getTile(Ce);if(!De.rasterParticleState)continue;const he=De.rasterParticleState,we=100;De.registerFadeDuration(we);const Fe=B.findLoadedParent(Ce,0),ze=Ic(De,Fe,B,R.transform,we);let je,it;R.terrain&&R.terrain.prepareDrawTile(),K.activeTexture.set(te.TEXTURE0),he.targetColorTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),K.activeTexture.set(te.TEXTURE1),Fe&&Fe.rasterParticleState?(Fe.rasterParticleState.targetColorTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),je=Math.pow(2,Fe.tileID.overscaledZ-De.tileID.overscaledZ),it=[De.tileID.canonical.x*je%1,De.tileID.canonical.y*je%1]):he.targetColorTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Ge=le?Float32Array.from(R.transform.expandedFarZProjMatrix):R.transform.calculateProjMatrix(Ae,ne),rt=R.transform,st=iE(rt),Ve=o.ck(Ce.canonical),Qe=o.cl(Ve.getCenter().lat);let kt,Ze,nt,ot,Me;le?(kt=Float32Array.from(o.aW(o.cn(Ce.canonical))),Ze=Float32Array.from(rt.globeMatrix),nt=Float32Array.from(o.cj(rt)),ot=[o.a8(rt.center.lng),o.ah(rt.center.lat)],Me=Float32Array.from(o.cm(Ce.canonical,Ve,Qe,rt.worldSize/rt._pixelsPerMercatorPixel))):(kt=new Float32Array(16),Ze=new Float32Array(9),nt=new Float32Array(16),ot=[0,0],Me=new Float32Array(9));const Tt=Kd(Ge,kt,Ze,nt,Me,it||[0,0],o.W(R.transform.zoom),ot,st,je||1,ze,250),lr=R.isTileAffectedByFog(Ce),vr=R.getOrCreateProgram("rasterParticle",{defines:ce,overrideFog:lr});if(R.uploadCommonUniforms(K,vr,Ae),le){const Ar=new Pr(te.LEQUAL,Pr.ReadWrite,R.depthRangeFor3D),xr=0,Dr=R.globeSharedBuffers;if(Dr){const[Sn,Zr,Pn]=Dr.getGridBuffers(Qe,xr!==0);vr.draw(R,te.TRIANGLES,Ar,ye,fn.alphaBlended,Vr.backCCW,Tt,G.id,Sn,Zr,Pn)}}else{const Ar=R.depthModeForSublayer(0,Pr.ReadOnly),xr=se[Ce.overscaledZ],{tileBoundsBuffer:Dr,tileBoundsIndexBuffer:Sn,tileBoundsSegments:Zr}=R.getTileBoundsBuffers(De);vr.draw(R,te.TRIANGLES,Ar,xr,fn.alphaBlended,Vr.disabled,Tt,G.id,Dr,Sn,Zr)}}R.resetStencilClippingMasks()}(w,f,v,S),w.style.map.triggerRepaint())},background:function(w,f,v,S){const C=v.paint.get("background-color"),E=v.paint.get("background-opacity"),R=v.paint.get("background-emissive-strength");if(E===0)return;const B=w.context,G=B.gl,j=w.transform,q=j.tileSize,K=v.paint.get("background-pattern");if(w.isPatternMissing(K,v.scope))return;const te=!K&&C.a===1&&E===1&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass!==te)return;const ne=qr.disabled,le=w.depthModeForSublayer(0,te==="opaque"?Pr.ReadWrite:Pr.ReadOnly),se=w.colorModeForDrapableLayerRenderPass(R),ue=K?"backgroundPattern":"background";let ce,ye=S;ye||(ce=w.getBackgroundTiles(),ye=Object.values(ce).map(Ce=>Ce.tileID)),K&&(B.activeTexture.set(G.TEXTURE0),w.imageManager.bind(w.context,v.scope));for(const Ce of ye){const Ae=w.isTileAffectedByFog(Ce),De=w.getOrCreateProgram(ue,{overrideFog:Ae}),he=Ce.toUnwrapped(),we=S?Ce.projMatrix:w.transform.calculateProjMatrix(he);w.prepareDrawTile();const Fe=f?f.getTile(Ce):ce?ce[Ce.key]:new Ls(Ce,q,j.zoom,w),ze=K?rE(we,R,E,w,K,v.scope,{tileID:Ce,tileSize:q}):tE(we,R,E,C);w.uploadCommonUniforms(B,De,he);const{tileBoundsBuffer:je,tileBoundsIndexBuffer:it,tileBoundsSegments:Ge}=w.getTileBoundsBuffers(Fe);De.draw(w,G.TRIANGLES,le,ne,se,Vr.disabled,ze,v.id,je,it,Ge)}},sky:function(w,f,v){const S=w._atmosphere?o.W(w.transform.zoom):1,C=v.paint.get("sky-opacity")*S;if(C===0)return;const E=w.context,R=v.paint.get("sky-type"),B=new Pr(E.gl.LEQUAL,Pr.ReadOnly,[0,1]),G=w.frameCounter/1e3%1;R==="atmosphere"?w.renderPass==="offscreen"?v.needsSkyboxCapture(w)&&(function(j,q,K,te){const ne=j.context,le=ne.gl;let se=q.skyboxFbo;if(!se){se=q.skyboxFbo=ne.createFramebuffer(32,32,!0,null),q.skyboxGeometry=new Lw(ne),q.skyboxTexture=ne.gl.createTexture(),le.bindTexture(le.TEXTURE_CUBE_MAP,q.skyboxTexture),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MAG_FILTER,le.LINEAR);for(let Ce=0;Ce<6;++Ce)le.texImage2D(le.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,le.RGBA,32,32,0,le.RGBA,le.UNSIGNED_BYTE,null)}ne.bindFramebuffer.set(se.framebuffer),ne.viewport.set([0,0,32,32]);const ue=q.getCenter(j,!0),ce=j.getOrCreateProgram("skyboxCapture"),ye=new Float64Array(16);o.a9.identity(ye),o.a9.rotateY(ye,ye,.5*-Math.PI),Lc(j,q,ce,ye,ue,0),o.a9.identity(ye),o.a9.rotateY(ye,ye,.5*Math.PI),Lc(j,q,ce,ye,ue,1),o.a9.identity(ye),o.a9.rotateX(ye,ye,.5*-Math.PI),Lc(j,q,ce,ye,ue,2),o.a9.identity(ye),o.a9.rotateX(ye,ye,.5*Math.PI),Lc(j,q,ce,ye,ue,3),o.a9.identity(ye),Lc(j,q,ce,ye,ue,4),o.a9.identity(ye),o.a9.rotateY(ye,ye,Math.PI),Lc(j,q,ce,ye,ue,5),ne.viewport.set([0,0,j.width,j.height])}(w,v),v.markSkyboxValid(w)):w.renderPass==="sky"&&function(j,q,K,te,ne){const le=j.context,se=le.gl,ue=j.transform,ce=j.getOrCreateProgram("skybox");le.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,q.skyboxTexture);const ye=((Ce,Ae,De,he,we)=>({u_matrix:Ce,u_sun_direction:Ae,u_cubemap:0,u_opacity:he,u_temporal_offset:we}))(ue.skyboxMatrix,q.getCenter(j,!1),0,te,ne);j.uploadCommonUniforms(le,ce),ce.draw(j,se.TRIANGLES,K,qr.disabled,j.colorModeForRenderPass(),Vr.backCW,ye,"skybox",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(w,v,B,C,G):R==="gradient"&&w.renderPass==="sky"&&function(j,q,K,te,ne){const le=j.context,se=le.gl,ue=j.transform,ce=j.getOrCreateProgram("skyboxGradient");q.skyboxGeometry||(q.skyboxGeometry=new Lw(le)),le.activeTexture.set(se.TEXTURE0);let ye=q.colorRampTexture;ye||(ye=q.colorRampTexture=new o.T(le,q.colorRamp,se.RGBA)),ye.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Ce=((Ae,De,he,we,Fe)=>({u_matrix:Ae,u_color_ramp:0,u_center_direction:De,u_radius:o.bm(he),u_opacity:we,u_temporal_offset:Fe}))(ue.skyboxMatrix,q.getCenter(j,!1),q.paint.get("sky-gradient-radius"),te,ne);j.uploadCommonUniforms(le,ce),ce.draw(j,se.TRIANGLES,K,qr.disabled,j.colorModeForRenderPass(),Vr.backCW,Ce,"skyboxGradient",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(w,v,B,C,G)},debug:function(w,f,v,S,C,E){for(let R=0;R<v.length;R++)if(C){const j=new o.aA(S.r*.8,S.g*.8,S.b*.8,1);$h(w,f,v[R],S,-1,-1,E),$h(w,f,v[R],S,-1,1,E),$h(w,f,v[R],S,1,1,E),$h(w,f,v[R],S,1,-1,E),$h(w,f,v[R],j,0,0,E)}else $h(w,f,v[R],S,0,0,E)},custom:function(w,f,v,S){const C=w.context,E=v.implementation;if(!w.transform.projection.unsupportedLayers||!w.transform.projection.unsupportedLayers.includes("custom")||w.terrain&&(w.terrain.renderingToTexture||w.renderPass==="offscreen")&&v.isDraped(f)){if(w.renderPass==="offscreen"){const R=E.prerender;if(R){if(w.setCustomLayerDefaults(),C.setColorMode(w.colorModeForRenderPass()),w.transform.projection.name==="globe"){const B=w.transform.pointMerc;R.call(E,C.gl,w.transform.customLayerMatrix(),w.transform.getProjection(),w.transform.globeToMercatorMatrix(),o.W(w.transform.zoom),[B.x,B.y],w.transform.pixelsPerMeterRatio)}else R.call(E,C.gl,w.transform.customLayerMatrix());C.setDirty(),w.setBaseState()}}else if(w.renderPass==="translucent"){if(w.terrain&&w.terrain.renderingToTexture){const B=E.renderToTile;if(B){const G=S[0].canonical,j=new o.O(G.x+S[0].wrap*(1<<G.z),G.y,G.z);C.setDepthMode(Pr.disabled),C.setStencilMode(qr.disabled),C.setColorMode(w.colorModeForRenderPass()),w.setCustomLayerDefaults(),B.call(E,C.gl,j),C.setDirty(),w.setBaseState()}return}w.setCustomLayerDefaults(),C.setColorMode(w.colorModeForRenderPass()),C.setStencilMode(qr.disabled);const R=E.renderingMode==="3d"?new Pr(w.context.gl.LEQUAL,Pr.ReadWrite,w.depthRangeFor3D):w.depthModeForSublayer(0,Pr.ReadOnly);if(C.setDepthMode(R),w.transform.projection.name==="globe"){const B=w.transform.pointMerc;E.render(C.gl,w.transform.customLayerMatrix(),w.transform.getProjection(),w.transform.globeToMercatorMatrix(),o.W(w.transform.zoom),[B.x,B.y],w.transform.pixelsPerMeterRatio)}else E.render(C.gl,w.transform.customLayerMatrix());C.setDirty(),w.setBaseState(),C.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(w,f,v,S){if(w.renderPass==="opaque")return;const C=v.paint.get("model-opacity");if(C===0)return;const E=v.paint.get("model-cast-shadows");if(w.renderPass==="shadow"&&(!E||w.terrain&&C<.65&&v._transitionablePaint._values["model-opacity"].value.expression instanceof o.Z))return;const R=w.shadowRenderer,B=v.paint.get("model-receive-shadows");R&&(R.useNormalOffset=!0,B||(R.enabled=!1));const G=()=>{R&&(R.useNormalOffset=!0,B||(R.enabled=!0))},j=f.getSource();if(w.renderPass==="light-beam"&&j.type!=="batched-model")return;if(j.type==="vector"||j.type==="geojson")return function(ce,ye,Ce,Ae,De){const he=ce.transform;if(he.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${he.projection.name} projection is not yet implemented`);const we=he.getFreeCameraOptions().position;if(!ce.modelManager)return;const Fe=ce.modelManager;Ce.modelManager=Fe;const ze=ce.shadowRenderer;if(!Ce._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const je=Ce._unevaluatedLayout._values["model-id"],it={...Ce.layout.get("model-id").parameters};for(const Ge of Ae){const rt=ye.getTile(Ge).getBucket(Ce);if(!rt||rt.projection.name!==he.projection.name)continue;const st=rt.getModelUris();st&&!rt.modelsRequested&&(Fe.addModelsFromBucket(st,De),rt.modelsRequested=!0);const Ve=nm(Ge,he);it.zoom=Ve;const Qe=je.possiblyEvaluate(it);if(ap(ce,rt,Ge),Wo.shadowUniformsInitialized=!1,Wo.useSingleShadowCascade=!!ze&&ze.getMaxCascadeForTile(Ge.toUnwrapped())===0,ce.renderPass==="shadow"&&ze){if(ce.currentShadowCascade===1&&rt.isInsideFirstShadowMapFrustum)continue;const nt=he.calculatePosMatrix(Ge.toUnwrapped(),he.worldSize);if(Wo.tileMatrix.set(nt),Wo.shadowTileMatrix=Float32Array.from(ze.calculateShadowPassMatrixFromMatrix(nt)),Wo.aabb.min.fill(0),Wo.aabb.max[0]=Wo.aabb.max[1]=o.Y,Wo.aabb.max[2]=0,op(rt,Wo,ce,Ce.scope))continue}const kt=1<<Ge.canonical.z,Ze=[((we.x-Ge.wrap)*kt-Ge.canonical.x)*o.Y,(we.y*kt-Ge.canonical.y)*o.Y,we.z*kt*o.Y];for(let nt in rt.instancesPerModel){const ot=rt.instancesPerModel[nt];ot.features.length>0&&(nt=Qe.evaluate(ot.features[0].feature,{}));const Me=Fe.getModel(nt,De);if(Me&&Me.uploaded)for(const Tt of Me.nodes)im(ce,Ce,Tt,ot,Ze,Ge,Wo)}}}(w,f,v,S,j.type==="vector"?v.scope:""),void G();if(!j.loaded())return;if(j.type==="batched-model")return function(ce,ye,Ce,Ae){Ce.resetLayerRenderingStats(ce);const De=ce.context,he=ce.transform,we=ce.style.fog,Fe=ce.shadowRenderer;if(he.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${he.projection.name} projection is not yet implemented`);const ze=ce.transform.getFreeCameraOptions().position,je=o.Q.scale([],[ze.x,ze.y,ze.z],ce.transform.worldSize);o.Q.negate(je,je);const it=o.a9.identity([]),Ge=o.cZ(he.center.lat,he.zoom),rt=o.a9.fromScaling([],[1,1,1/Ge]);o.a9.translate(it,it,je);const st=Ce.paint.get("model-opacity"),Ve=new Pr(De.gl.LEQUAL,Pr.ReadWrite,ce.depthRangeFor3D),Qe=new Pr(De.gl.LEQUAL,Pr.ReadOnly,ce.depthRangeFor3D),kt=new o.bV([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Ze=ce.renderPass==="shadow",nt=Ze&&Fe?Fe.getCurrentCascadeFrustum():he.getFrustum(he.scaleZoom(he.worldSize)),ot=Ce.getLayerRenderingStats(),Me=function(Tt,lr){for(const vr of Ae){const Ar=ye.getTile(vr).getBucket(Ce);if(!Ar||!Ar.uploaded)continue;let xr=!1;Fe&&(xr=Fe.getMaxCascadeForTile(vr.toUnwrapped())===0);const Dr=he.calculatePosMatrix(vr.toUnwrapped(),he.worldSize),Sn=Ar.modelTraits;for(const Zr of Ar.getNodesInfo()){if(Zr.hiddenByReplacement||!Zr.node.meshes)continue;const Pn=Zr.evaluatedScale,Tn=Zr.node;let Di=0;if(ce.terrain&&Tn.elevation&&(Di=Tn.elevation*ce.terrain.exaggeration()),Pn[0]<=1&&Pn[1]<=1&&Pn[2]<=1&&(()=>{const vn=Zr.getLocalBounds();return kt.min=[...vn.min],kt.max=[...vn.max],kt.min[2]+=Di,kt.max[2]+=Di,o.Q.transformMat4(kt.min,kt.min,Dr),o.Q.transformMat4(kt.max,kt.max,Dr),kt})().intersects(nt)===0)continue;const ei=[...Dr];o.a9.translate(ei,ei,[(Tn.anchor?Tn.anchor[0]:0)*(Pn[0]-1),(Tn.anchor?Tn.anchor[1]:0)*(Pn[1]-1),Di]),o.Q.exactEquals(Pn,o.c$)||o.a9.scale(ei,ei,Pn);const ua=o.a9.multiply([],ei,Tn.matrix);let Ji=o.a9.multiply([],rt,ei);o.a9.multiply(Ji,it,Ji);const di=o.a9.invert([],Ji);o.a9.transpose(di,di),o.a9.scale(di,di,am),Ji=o.a9.multiply(Ji,Ji,Tn.matrix);const oi=ce.renderPass==="light-beam",nn=o.a9.multiply([],he.expandedFarZProjMatrix,ua),sn=o.a9.multiply([],he.expandedFarZProjMatrix,ei),Ti=Sn&o.d1.HasMapboxMeshFeatures,pi=Ti?0:Zr.evaluatedRMEA[0][2];for(let vn=0;vn<Tn.meshes.length;++vn){const Kr=Tn.meshes[vn],_o=vn===Tn.lightMeshIndex;let Wa=nn;if(_o){if(!oi&&!ce.terrain&&ce.shadowRenderer){ce.currentLayer<ce.firstLightBeamLayer&&(ce.firstLightBeamLayer=ce.currentLayer);continue}Wa=sn}else if(oi)continue;const ya={defines:[]},Za=[];if(Ru(ya.defines,Za,Kr,ce),Ti||ya.defines.push("DIFFUSE_SHADED"),xr&&ya.defines.push("SHADOWS_SINGLE_CASCADE"),ot&&(Ze?ot.numRenderedVerticesInShadowPass+=Kr.vertexArray.length:ot.numRenderedVerticesInTransparentPass+=Kr.vertexArray.length),Ze){ip(Kr,ua,ce,Ce);continue}let yo=null;if(we){const Vs=l0(ua,ce.transform);if(yo=new Float32Array(Vs),he.projection.name!=="globe"){const ll=Kr.aabb.min,ul=Kr.aabb.max,[Bu,hs]=we.getOpacityForBounds(Vs,ll[0],ll[1],ul[0],ul[1]);ya.overrideFog=Bu>=jn||hs>=jn}}const io=Kr.material;let xa;io.occlusionTexture&&io.occlusionTexture.offsetScale&&(xa=io.occlusionTexture.offsetScale,ya.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!Ze&&Fe&&(Fe.useNormalOffset=!!Kr.normalBuffer);const Pa=ce.getOrCreateProgram("model",ya);!Ze&&Fe&&Fe.setupShadowsFromMatrix(ei,Pa,Fe.useNormalOffset),ce.uploadCommonUniforms(De,Pa,null,yo);const La=io.pbrMetallicRoughness;La.metallicFactor=.9,La.roughnessFactor=.5;const sl=Yv(new Float32Array(Wa),new Float32Array(Ji),new Float32Array(di),new Float32Array(Tn.matrix),ce,st,La.baseColorFactor,io.emissiveFactor,La.metallicFactor,La.roughnessFactor,io,pi,Ce,[0,0,0],xa);Pa.draw(ce,De.gl.TRIANGLES,lr&&!_o?Ve:Qe,qr.disabled,Tt?_o||st<1||Zr.hasTranslucentParts?fn.alphaBlended:fn.unblended:fn.disabled,Vr.backCCW,sl,Ce.id,Kr.vertexBuffer,Kr.indexBuffer,Kr.segments,Ce.paint,ce.transform.zoom,void 0,Za)}}}};(function(Tt,lr,vr,Ar){const xr=Tt.terrain?Tt.terrain.exaggeration():0,Dr=Tt.transform.zoom;for(const Sn of Ar){const Zr=lr.getTile(Sn).getBucket(vr);Zr&&(Tt.conflationActive&&Zr.updateReplacement(Sn,Tt.replacementSource),Zr.evaluateScale(Tt,vr),Tt.terrain&&xr>0&&Zr.elevationUpdate(Tt.terrain,xr,Sn,vr.source),Zr.needsReEvaluation(Tt,Dr,vr)&&Zr.evaluate(vr))}})(ce,ye,Ce,Ae),st===1?Me(!0,!0):(Me(!1,!0),Me(!0,!1))}(w,f,v,S),void G();const q=j.getModels(),K=[],te=w.transform.getFreeCameraOptions().position,ne=o.Q.scale([],[te.x,te.y,te.z],w.transform.worldSize);o.Q.negate(ne,ne);const le=[],se=[];let ue=0;for(const ce of q){const ye=v.paint.get("model-rotation").constantOr(null),Ce=v.paint.get("model-scale").constantOr(null),Ae=v.paint.get("model-translation").constantOr(null);ce.computeModelMatrix(w,ye,Ce,Ae,!0,!0,!1);const De=o.a9.identity([]),he=o.cZ(ce.position.lat,w.transform.zoom),we=o.a9.fromScaling([],[1,1,1/he]);o.a9.translate(De,De,ne),K.push({zScaleMatrix:we,negCameraPosMatrix:De});for(const Fe of ce.nodes)np(w.transform,Fe,ce.matrix,w.transform.expandedFarZProjMatrix,ue,le,se);ue++}if(le.sort((ce,ye)=>ye.depth-ce.depth),w.renderPass!=="shadow"){if(C===1)for(const ce of se)ku(ce,w,v,K[ce.modelIndex],qr.disabled,w.colorModeForRenderPass());else{for(const ce of se)ku(ce,w,v,K[ce.modelIndex],qr.disabled,fn.disabled);for(const ce of se)ku(ce,w,v,K[ce.modelIndex],w.stencilModeFor3D(),w.colorModeForRenderPass());w.resetStencilClippingMasks()}for(const ce of le)ku(ce,w,v,K[ce.modelIndex],qr.disabled,w.colorModeForRenderPass());G()}else{for(const ce of se)ip(ce.mesh,ce.nodeModelMatrix,w,v);for(const ce of le)ip(ce.mesh,ce.nodeModelMatrix,w,v);G()}}},kc={model:function(w,f,v){const S=f.getSource();if(!S.loaded())return;if(S.type==="vector"||S.type==="geojson")return void(v.modelManager&&v.modelManager.upload(v,S.type==="vector"?w.scope:""));if(S.type==="batched-model")return;const C=S.getModels();for(const E of C)E.upload(v.context)},raster:function(w,f,v){const S=f.getSource();if(!(S instanceof Kt&&S.loaded()))return;const C=w.sourceLayer||S.rasterLayerIds&&S.rasterLayerIds[0];if(!C)return;const E=w.paint.get("raster-array-band")||S.getInitialBand(C);if(E==null)return;const R=f.getIds().map(B=>f.getTileByID(B));for(const B of R)B.updateNeeded(C,E)&&S.prepareTile(B,C,E)},"raster-particle":function(w,f,v){const S=f.getSource();if(!(S instanceof Kt&&S.loaded()))return;const C=w.sourceLayer||S.rasterLayerIds&&S.rasterLayerIds[0];if(!C)return;const E=w.paint.get("raster-particle-array-band")||S.getInitialBand(C);if(E==null)return;const R=f.getIds().map(B=>f.getTileByID(B));for(const B of R)B.updateNeeded(C,E)&&S.prepareTile(B,C,E)}};class Ow{constructor(f,v,S,C){this.context=new rl(f,v),this.transform=S,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=C,this._timeStamp=new Date().getTime(),this._averageFPS=0,this._fpsHistory=[],this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const R of E)this._debugParams.enabledLayers[R]=!0;C.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),C.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),C.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),C.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),C.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const R of E)C.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],R);this.setup(),this.numSublayers=Rs.maxUnderzooming+Rs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.d3,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new yw(this),this._wireframeDebugCache=new kw,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(f,v){const S=!!f&&!!f.terrain&&this.transform.projection.supportsTerrain;if(!(S||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new jo(this,f));const C=this._terrain;this.transform.elevation=S?C:null,C.update(f,this.transform,v),this.transform.elevation&&!C.enabled&&(this.transform.elevation=null)}_updateFog(f){const v=f.fog;if(!v||this.transform.projection.name==="globe"||v.getOpacity(this.transform.pitch)<1||v.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[S,C]=v.getFovAdjustedRange(this.transform._fov);if(S>C)return void(this.transform.fogCullDistSq=null);const E=S+.78*(C-S);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(f,v){if(this.width=f*o.f.devicePixelRatio,this.height=v*o.f.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const S of this.style.order)this.style._mergedLayers[S].resize()}setup(){const f=this.context,v=new o.aQ;v.emplaceBack(0,0),v.emplaceBack(o.Y,0),v.emplaceBack(0,o.Y),v.emplaceBack(o.Y,o.Y),this.tileExtentBuffer=f.createVertexBuffer(v,o.aS.members),this.tileExtentSegments=o.aE.simpleSegment(0,0,4,2);const S=new o.aQ;S.emplaceBack(0,0),S.emplaceBack(o.Y,0),S.emplaceBack(0,o.Y),S.emplaceBack(o.Y,o.Y),this.debugBuffer=f.createVertexBuffer(S,o.aS.members),this.debugSegments=o.aE.simpleSegment(0,0,4,5);const C=new o.aQ;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(-1,1),C.emplaceBack(1,1),this.viewportBuffer=f.createVertexBuffer(C,o.aS.members),this.viewportSegments=o.aE.simpleSegment(0,0,4,2);const E=new o.ay;E.emplaceBack(0,0,0,0),E.emplaceBack(o.Y,0,o.Y,0),E.emplaceBack(0,o.Y,0,o.Y),E.emplaceBack(o.Y,o.Y,o.Y,o.Y),this.mercatorBoundsBuffer=f.createVertexBuffer(E,o.aU.members),this.mercatorBoundsSegments=o.aE.simpleSegment(0,0,4,2);const R=new o.az;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=f.createIndexBuffer(R);const B=new o.aR;for(const j of[0,1,3,2,0])B.emplaceBack(j);this.debugIndexBuffer=f.createIndexBuffer(B),this.emptyTexture=new o.T(f,new o.h({width:1,height:1},Uint8Array.of(0,0,0,0)),f.gl.RGBA),this.identityMat=o.a9.create();const G=this.context.gl;this.stencilClearMode=new qr({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(f){return f._makeTileBoundsBuffers(this.context,this.transform.projection),f._tileBoundsBuffer?{tileBoundsBuffer:f._tileBoundsBuffer,tileBoundsIndexBuffer:f._tileBoundsIndexBuffer,tileBoundsSegments:f._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const f=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,f.TRIANGLES,Pr.disabled,this.stencilClearMode,fn.disabled,Vr.disabled,Yd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(f,v,S){if(!v||this.currentStencilSource===v.id||!f.isTileClipped()||!S||S.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let B=!1;for(const G of S)if(this._tileClippingMaskIDs[G.key]===void 0){B=!0;break}if(!B)return}this.currentStencilSource=v.id;const C=this.context,E=C.gl;this.nextStencilID+S.length>256&&this.clearStencil(),C.setColorMode(fn.disabled),C.setDepthMode(Pr.disabled);const R=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const B of S){const G=v.getTile(B),j=this._tileClippingMaskIDs[B.key]=this.nextStencilID++,{tileBoundsBuffer:q,tileBoundsIndexBuffer:K,tileBoundsSegments:te}=this.getTileBoundsBuffers(G);R.draw(this,E.TRIANGLES,Pr.disabled,new qr({func:E.ALWAYS,mask:0},j,255,E.KEEP,E.KEEP,E.REPLACE),fn.disabled,Vr.disabled,Yd(B.projMatrix),"$clipping",q,K,te)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const f=this.nextStencilID++,v=this.context.gl;return new qr({func:v.NOTEQUAL,mask:255},f,255,v.KEEP,v.KEEP,v.REPLACE)}stencilModeForClipping(f){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(f);const v=this.context.gl;return new qr({func:v.EQUAL,mask:255},this._tileClippingMaskIDs[f.key],0,v.KEEP,v.KEEP,v.REPLACE)}stencilConfigForOverlap(f){const v=this.context.gl,S=f.sort((R,B)=>B.overscaledZ-R.overscaledZ),C=S[S.length-1].overscaledZ,E=S[0].overscaledZ-C+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const R={};for(let B=0;B<E;B++)R[B+C]=new qr({func:v.GEQUAL,mask:255},B+this.nextStencilID,255,v.KEEP,v.KEEP,v.REPLACE);return this.nextStencilID+=E,[R,S]}return[{[C]:qr.disabled},S]}colorModeForRenderPass(){const f=this.context.gl;return this._showOverdrawInspector?new fn([f.CONSTANT_COLOR,f.ONE,f.CONSTANT_COLOR,f.ONE],new o.aA(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fn.unblended:fn.alphaBlended}colorModeForDrapableLayerRenderPass(f){const v=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new fn([v.ONE,v.ONE_MINUS_SRC_ALPHA,v.CONSTANT_ALPHA,v.ONE_MINUS_SRC_ALPHA],new o.aA(0,0,0,f===void 0?0:f),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(f,v,S,C=!1){if(!this.opaquePassEnabledForLayer()&&!C)return Pr.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+f)*this.depthEpsilon;return new Pr(S||this.context.gl.LEQUAL,v,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}updateAverageFPS(){const f=new Date().getTime(),v=f-this._timeStamp;this._timeStamp=f,this._fpsHistory.push(v===0?0:1e3/v),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((S,C)=>S+C/this._fpsHistory.length,0))}render(f,v){this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=f.map.repaint,this.style=f,this.options=v;const S=this.style._mergedLayers,C=this.style.order.filter(he=>{const we=S[he];return!(we.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[we.type]}),E=C.map(he=>S[he]),R=this.style._mergedSourceCaches;this.imageManager=f.imageManager,this.modelManager=f.modelManager,this.symbolFadeChange=f.placement.symbolFadeChange(o.f.now()),this.imageManager.beginFrame();let B=0,G=!1;for(const he in R){const we=R[he];we.used&&(we.prepare(this.context),we.getSource().usedInConflation&&++B)}for(const he of E)he.isHidden(this.transform.zoom)||this.prepareLayer(he);const j={},q={},K={},te={},ne={};for(const he in R){const we=R[he];j[he]=we.getVisibleCoordinates(),q[he]=j[he].slice().reverse(),K[he]=we.getVisibleCoordinates(!0).reverse(),te[he]=we.getShadowCasterCoordinates(),ne[he]=we.sortCoordinatesByDistance(j[he])}const le=he=>{const we=this.style.getLayerSourceCache(he);return we&&we.used?we.getSource():null};if(B){const he=[];for(const we of E)this.layerUsedInConflation(we,le(we))&&he.push(we);if(he&&he.length>1){const we=[];for(const Fe of he){const ze=this.style.getLayerSourceCache(Fe);ze&&ze.used&&ze.getSource().usedInConflation&&we.push({layer:Fe.fqid,cache:ze})}this.replacementSource.setSources(we),G=!0}}G||this.replacementSource.clear(),this.conflationActive=G,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const he of E){const we=he.cutoffRange();if(this.longestCutoffRange=Math.max(we,this.longestCutoffRange),we>0){const Fe=le(he);Fe&&(this.minCutoffZoom=Math.max(Fe.minzoom,this.minCutoffZoom)),he.minzoom&&(this.minCutoffZoom=Math.max(he.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let he=0;he<E.length;he++)if(E[he].is3D()){this.opaquePassCutoff=he;break}const se=this.style&&this.style.fog;se?(this._fogVisible=se.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=se.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(K),this.opaquePassCutoff=0);const ue=this._shadowRenderer;if(ue){ue.updateShadowParameters(this.transform,this.style.directionalLight);for(const he in R)for(const we of j[he]){let Fe={min:0,max:0};this.terrain&&(Fe=this.terrain.getMinMaxForTile(we)||Fe),ue.addShadowReceiver(we.toUnwrapped(),Fe.min,Fe.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.d4(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new s0(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!o.d5(this.context.gl))return;this.renderPass="offscreen";for(const he of E){const we=f.getLayerSourceCache(he);if(!he.hasOffscreenPass()||he.isHidden(this.transform.zoom))continue;const Fe=we?q[we.id]:void 0;(he.type==="custom"||he.type==="raster"||he.type==="raster-particle"||he.isSky()||Fe&&Fe.length)&&this.renderLayer(this,we,he,Fe)}this.depthRangeFor3D=[0,1-(E.length+2)*this.numSublayers*this.depthEpsilon];const ce=this.terrain;ce&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&ce.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const ye=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ce=(()=>{if(v.showOverdrawInspector)return o.aA.black;if(this.style.fog&&this.transform.projection.supportsFog&&!ye){const he=this.style.fog.properties.get("color").toArray01();return new o.aA(...he)}if(this.style.fog&&this.transform.projection.supportsFog&&ye){const he=this.style.fog.properties.get("space-color").toArray01();return new o.aA(...he)}return o.aA.transparent})();if(this.context.clear({color:Ce,depth:1}),this.clearStencil(),this._showOverdrawInspector=v.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ye&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){const he=E[this.currentLayer],we=f.getLayerSourceCache(he);if(he.isSky())continue;const Fe=we?(he.is3D()?ne:q)[we.id]:void 0;this._renderTileClippingMasks(he,we,Fe),this.renderLayer(this,we,he,Fe)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ye&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.W(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){const he=E[this.currentLayer],we=f.getLayerSourceCache(he);he.isSky()&&this.renderLayer(this,we,he,we?q[we.id]:void 0)}function Ae(he,we){let Fe;return we&&(Fe=(he.type==="symbol"?K:he.is3D()?ne:q)[we.id]),Fe}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<C.length;){const he=E[this.currentLayer];if(he.type==="raster"){const we=f.getLayerSourceCache(he);this.renderLayer(this,we,he,Ae(he,we))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let De=0;for(ue&&(De=ue.getShadowCastingLayerCount());this.currentLayer<C.length;){const he=E[this.currentLayer],we=f.getLayerSourceCache(he);if(he.isSky())++this.currentLayer;else if(ce&&this.style.isLayerDraped(he)){if(he.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=ce.renderBatch(this.currentLayer)}else{if(this._renderTileClippingMasks(he,we,we?j[we.id]:void 0),this.renderLayer(this,we,he,Ae(he,we)),!ce&&ue&&De>0&&he.hasShadowPass()&&--De==0&&(ue.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Fe=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Fe;this.currentLayer++){const ze=E[this.currentLayer];if(!ze.hasLightBeamPass())continue;const je=f.getLayerSourceCache(ze);this.renderLayer(this,je,ze,je?q[je.id]:void 0)}this.currentLayer=Fe,this.renderPass="translucent"}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let he=null;E.forEach(we=>{const Fe=f.getLayerSourceCache(we);Fe&&!we.isHidden(this.transform.zoom)&&Fe.getVisibleCoordinates().length&&(!he||he.getSource().maxzoom<Fe.getSource().maxzoom)&&(he=Fe)}),he&&this.options.showTileBoundaries&&om.debug(this,he,he.getVisibleCoordinates(),o.aA.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&om.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.aA(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(he){const we=he.transform.padding;Ew(he,he.transform.height-(we.top||0),3,n0),Ew(he,we.bottom||0,3,aE),Dw(he,we.left||0,3,Mw),Dw(he,he.transform.width-(we.right||0),3,Iw);const Fe=he.transform.centerPoint;(function(ze,je,it,Ge){tm(ze,je-1,it-10,2,20,Ge),tm(ze,je-10,it-1,20,2,Ge)})(he,Fe.x,he.transform.height-Fe.y,i0)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),G||(this.conflationActive=!1)}prepareLayer(f){this.gpuTimingStart(f);const{unsupportedLayers:v}=this.transform.projection,S=!v||!v.includes(f.type);if(kc[f.type]&&(S||this.terrain&&f.type==="custom")){const C=this.style.getLayerSourceCache(f);kc[f.type](f,C,this)}this.gpuTimingEnd()}renderLayer(f,v,S,C){S.isHidden(this.transform.zoom)||(S.type==="background"||S.type==="sky"||S.type==="custom"||S.type==="model"||S.type==="raster"||S.type==="raster-particle"||C&&C.length)&&(this.id=S.id,this.gpuTimingStart(S),(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes(S.type)||f.terrain&&S.type==="custom")&&om[S.type](f,v,S,C,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(f){if(!this.options.gpuTiming)return;const v=this.context.extTimerQuery,S=this.context.gl;let C=this.gpuTimers[f.id];C||(C=this.gpuTimers[f.id]={calls:0,cpuTime:0,query:S.createQuery()}),C.calls++,S.beginQuery(v.TIME_ELAPSED_EXT,C.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const f=this.context.extTimerQuery,v=this.context.gl,S=v.createQuery();this.deferredRenderGpuTimeQueries.push(S),v.beginQuery(f.TIME_ELAPSED_EXT,S)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const f=this.gpuTimers;return this.gpuTimers={},f}collectDeferredRenderGpuQueries(){const f=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],f}queryGpuTimers(f){const v={};for(const S in f){const C=f[S],E=this.context.extTimerQuery,R=E.getQueryParameter(C.query,this.context.gl.QUERY_RESULT)/1e6;E.deleteQueryEXT(C.query),v[S]=R}return v}queryGpuTimeDeferredRender(f){if(!this.options.gpuTimingDeferredRender)return 0;const v=this.context.extTimerQuery,S=this.context.gl;let C=0;for(const E of f)C+=v.getQueryParameter(E,S.QUERY_RESULT)/1e6,v.deleteQueryEXT(E);return C}translatePosMatrix(f,v,S,C,E){if(!S[0]&&!S[1])return f;const R=E?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(R){const j=Math.sin(R),q=Math.cos(R);S=[S[0]*q-S[1]*j,S[0]*j+S[1]*q]}const B=[E?S[0]:o.a6(v,S[0],this.transform.zoom),E?S[1]:o.a6(v,S[1],this.transform.zoom),0],G=new Float32Array(16);return o.a9.translate(G,f,B),G}saveTileTexture(f){const v=f.size[0],S=this._tileTextures[v];S?S.push(f):this._tileTextures[v]=[f]}getTileTexture(f){const v=this._tileTextures[f];return v&&v.length>0?v.pop():null}isPatternMissing(f,v){return f===null||f!==void 0&&!this.imageManager.getPattern(f.toString(),v)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(f,v,S){const C=S===void 0?this.terrain&&this.terrain.renderingToTexture:S,E=this.terrain&&this.terrain.exaggeration()===0,R=[];return this.style&&this.style.enable3dLights()&&(f==="globeRaster"||f==="terrainRaster"?(R.push("LIGHTING_3D_MODE"),R.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):C||R.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||R.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?R.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):R.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(R.push("TERRAIN"),this.linearFloatFilteringSupported()&&R.push("TERRAIN_DEM_FLOAT_FORMAT"),E&&R.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&R.push("GLOBE"),!this._fogVisible||C||v!==void 0&&!v||R.push("FOG","FOG_DITHERING"),C&&R.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&R.push("OVERDRAW_INSPECTOR"),R}getOrCreateProgram(f,v){this.cache=this.cache||{};const S=v&&v.defines||[],C=v&&v.config,E=this.currentGlobalDefines(f,v&&v.overrideFog,v&&v.overrideRtt).concat(S),R=cs.cacheKey(Bs[f],f,E,C);return this.cache[R]||(this.cache[R]=new cs(this.context,f,Bs[f],C,Ky[f],E)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const f=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(f.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(f,v){if(this.style.enable3dLights()){const S=this.style.directionalLight,C=this.style.ambientLight;if(S&&C){const E=((R,B)=>{const G=R.properties.get("direction"),j=R.properties.get("color").toArray01(),q=R.properties.get("intensity"),K=B.properties.get("color").toArray01(),te=B.properties.get("intensity"),ne=[G.x,G.y,G.z],le=o.cs(K,te),se=o.cs(j,q);return{u_lighting_ambient_color:le,u_lighting_directional_dir:ne,u_lighting_directional_color:se,u_ground_radiance:ww(ne,se,le)}})(S,C);v.setLightsUniformValues(f,E)}}}uploadCommonUniforms(f,v,S,C,E){if(this.uploadCommonLightUniforms(f,v),this.terrain&&this.terrain.renderingToTexture)return;const R=this.style.fog;if(R){const B=R.getOpacity(this.transform.pitch),G=((j,q,K,te,ne,le,se,ue,ce,ye,Ce,Ae)=>{const De=j.transform,he=q.properties.get("color").toArray01();he[3]=te;const we=j.frameCounter/1e3%1,[Fe,ze]=q.properties.get("vertical-range");return{u_fog_matrix:K?De.calculateFogTileMatrix(K):Ae||j.identityMat,u_fog_range:q.getFovAdjustedRange(De._fov),u_fog_color:he,u_fog_horizon_blend:q.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Fe,ze),ze],u_fog_temporal_offset:we,u_frustum_tl:ne,u_frustum_tr:le,u_frustum_br:se,u_frustum_bl:ue,u_globe_pos:ce,u_globe_radius:ye,u_viewport:Ce,u_globe_transition:o.W(De.zoom),u_is_globe:+(De.projection.name==="globe")}})(this,R,S,B,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.f.devicePixelRatio,this.transform.height*o.f.devicePixelRatio],C);v.setFogUniformValues(f,G)}E&&v.setCutoffUniformValues(f,E.uniformValues)}setTileLoadedFlag(f){this.tileLoaded=f}saveCanvasCopy(){const f=this.canvasCopy();f&&(this.frameCopies.push(f),this.tileLoaded=!1)}canvasCopy(){const f=this.context.gl,v=f.createTexture();return f.bindTexture(f.TEXTURE_2D,v),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,0,0,f.drawingBufferWidth,f.drawingBufferHeight,0),v}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const f=this.style&&this.style.fog;return!!f&&f.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const f=this._backgroundTiles,v=this._backgroundTiles={},S=this.transform.coveringTiles({tileSize:512});for(const C of S)v[C.key]=f[C.key]||new Ls(C,512,this.transform.tileZoom,this);return v}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(f,v){return!(!f.is3D()||f.minzoom&&f.minzoom>this.transform.zoom||f.sourceLayer!=="building"&&(!v||v.type!=="batched-model"))}isTileAffectedByFog(f){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let v=this._cachedTileFogOpacities[f.key];return v||(this._cachedTileFogOpacities[f.key]=v=this.style.fog.getOpacityForTile(f)),v[0]>=jn||v[1]>=jn}}function zw(w,f){let v=!1,S=null;const C=()=>{S=null,v&&(w(),S=setTimeout(C,f),v=!1)};return()=>(v=!0,S||C(),S)}class sE{constructor(f){this._hashName=f&&encodeURIComponent(f),o.a$(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=zw(this._updateHashUnthrottled.bind(this),300)}addTo(f){return this._map=f,window.addEventListener("hashchange",this._onHashChange,!1),f.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const f=this._map;if(!f)return"";const v=Bw(f);if(this._hashName){const S=this._hashName;let C=!1;const E=location.hash.slice(1).split("&").map(R=>{const B=R.split("=")[0];return B===S?(C=!0,`${B}=${v}`):R}).filter(R=>R);return C||E.push(`${S}=${v}`),`#${E.join("&")}`}return`#${v}`}_getCurrentHash(){const f=location.hash.replace("#","");if(this._hashName){let v;return f.split("&").map(S=>S.split("=")).forEach(S=>{S[0]===this._hashName&&(v=S)}),(v&&v[1]||"").split("/")}return f.split("/")}_onHashChange(){const f=this._map;if(!f)return!1;const v=this._getCurrentHash();if(v.length>=3&&!v.some(S=>isNaN(S))){const S=f.dragRotate.isEnabled()&&f.touchZoomRotate.isEnabled()?+(v[3]||0):f.getBearing();return f.jumpTo({center:[+v[2],+v[1]],zoom:+v[0],bearing:S,pitch:+(v[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Bw(w,f){const v=w.getCenter(),S=Math.round(100*w.getZoom())/100,C=Math.ceil((S*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,C),R=Math.round(v.lng*E)/E,B=Math.round(v.lat*E)/E,G=w.getBearing(),j=w.getPitch();let q=f?`/${R}/${B}/${S}`:`${S}/${B}/${R}`;return(G||j)&&(q+="/"+Math.round(10*G)/10),j&&(q+=`/${Math.round(j)}`),q}const Hh={linearity:.3,easing:o.d6(0,0,.3,1)},u0=o.e({deceleration:2500,maxSpeed:1400},Hh),c0=o.e({deceleration:20,maxSpeed:1400},Hh),h0=o.e({deceleration:1e3,maxSpeed:360},Hh),Fw=o.e({deceleration:1e3,maxSpeed:90},Hh);class Nw{constructor(f){this._map=f,this.clear()}clear(){this._inertiaBuffer=[]}record(f){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.f.now(),settings:f})}_drainInertiaBuffer(){const f=this._inertiaBuffer,v=o.f.now();for(;f.length>0&&v-f[0].time>160;)f.shift()}_onMoveEnd(f){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const v={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)v.zoom+=E.zoomDelta||0,v.bearing+=E.bearingDelta||0,v.pitch+=E.pitchDelta||0,E.panDelta&&v.pan._add(E.panDelta),E.around&&(v.around=E.around),E.pinchAround&&(v.pinchAround=E.pinchAround);const S=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(v.pan.mag()){const E=Ou(v.pan.mag(),S,o.e({},u0,f||{}));C.offset=v.pan.mult(E.amount/v.pan.mag()),C.center=this._map.transform.center,sm(C,E)}if(v.zoom){const E=Ou(v.zoom,S,c0);C.zoom=this._map.transform.zoom+E.amount,sm(C,E)}if(v.bearing){const E=Ou(v.bearing,S,h0);C.bearing=this._map.transform.bearing+o.ad(E.amount,-179,179),sm(C,E)}if(v.pitch){const E=Ou(v.pitch,S,Fw);C.pitch=this._map.transform.pitch+E.amount,sm(C,E)}if(C.zoom||C.bearing){const E=v.pinchAround===void 0?v.around:v.pinchAround;C.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),C.noMoveStart=!0,C}}function sm(w,f){(!w.duration||w.duration<f.duration)&&(w.duration=f.duration,w.easing=f.easing)}function Ou(w,f,v){const{maxSpeed:S,linearity:C,deceleration:E}=v,R=o.ad(w*C/(f/1e3),-S,S),B=Math.abs(R)/(E*C);return{easing:v.easing,duration:1e3*B,amount:R*(B/2)}}class ja extends o.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,v,S,C={}){const E=$(v.getCanvasContainer(),S),R=v.unproject(E);super(f,o.e({point:E,lngLat:R,originalEvent:S},C)),this._defaultPrevented=!1,this.target=v}}class sp extends o.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,v,S){const C=f==="touchend"?S.changedTouches:S.touches,E=X(v.getCanvasContainer(),C),R=E.map(G=>v.unproject(G)),B=E.reduce((G,j,q,K)=>G.add(j.div(K.length)),new o.P(0,0));super(f,{points:E,point:B,lngLats:R,lngLat:v.unproject(B),originalEvent:S}),this._defaultPrevented=!1}}class Zo extends o.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(f,v,S){super(f,{originalEvent:S}),this._defaultPrevented=!1}}class f0{constructor(f,v){this._map=f,this._clickTolerance=v.clickTolerance}reset(){this._mousedownPos=void 0}wheel(f){return this._firePreventable(new Zo(f.type,this._map,f))}mousedown(f,v){return this._mousedownPos=v,this._firePreventable(new ja(f.type,this._map,f))}mouseup(f){this._map.fire(new ja(f.type,this._map,f))}preclick(f){const v=o.e({},f);v.type="preclick",this._map.fire(new ja(v.type,this._map,v))}click(f,v){this._mousedownPos&&this._mousedownPos.dist(v)>=this._clickTolerance||(this.preclick(f),this._map.fire(new ja(f.type,this._map,f)))}dblclick(f){return this._firePreventable(new ja(f.type,this._map,f))}mouseover(f){this._map.fire(new ja(f.type,this._map,f))}mouseout(f){this._map.fire(new ja(f.type,this._map,f))}touchstart(f){return this._firePreventable(new sp(f.type,this._map,f))}touchmove(f){this._map.fire(new sp(f.type,this._map,f))}touchend(f){this._map.fire(new sp(f.type,this._map,f))}touchcancel(f){this._map.fire(new sp(f.type,this._map,f))}_firePreventable(f){if(this._map.fire(f),f.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lm{constructor(f){this._map=f}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(f){this._map.fire(new ja(f.type,this._map,f))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ja("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(f){this._delayContextMenu?this._contextMenuEvent=f:this._map.fire(new ja(f.type,this._map,f)),this._map.listens("contextmenu")&&f.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class um{constructor(f,v){this._map=f,this._el=f.getCanvasContainer(),this._container=f.getContainer(),this._clickTolerance=v.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(f,v){this.isEnabled()&&f.shiftKey&&f.button===0&&(O(),this._startPos=this._lastPos=v,this._active=!0)}mousemoveWindow(f,v){if(!this._active)return;const S=v,C=this._startPos,E=this._lastPos;if(!C||!E||E.equals(S)||!this._box&&S.dist(C)<this._clickTolerance)return;this._lastPos=S,this._box||(this._box=x("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",f));const R=Math.min(C.x,S.x),B=Math.max(C.x,S.x),G=Math.min(C.y,S.y),j=Math.max(C.y,S.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${R}px,${G}px)`,this._box.style.width=B-R+"px",this._box.style.height=j-G+"px")})}mouseupWindow(f,v){if(!this._active)return;const S=this._startPos,C=v;if(S&&f.button===0){if(this.reset(),H(),S.x!==C.x||S.y!==C.y)return this._map.fire(new o.b("boxzoomend",{originalEvent:f})),{cameraAnimation:E=>E.fitScreenCoordinates(S,C,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",f)}}keydown(f){this._active&&f.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",f))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),z(),delete this._startPos,delete this._lastPos}_fireEvent(f,v){return this._map.fire(new o.b(f,{originalEvent:v}))}}function lp(w,f){const v={};for(let S=0;S<w.length;S++)v[w[S].identifier]=f[S];return v}class d0{constructor(f){this.reset(),this.numTouches=f.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(f,v,S){(this.centroid||S.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=f.timeStamp),S.length===this.numTouches&&(this.centroid=function(C){const E=new o.P(0,0);for(const R of C)E._add(R);return E.div(C.length)}(v),this.touches=lp(S,v)))}touchmove(f,v,S){if(this.aborted||!this.centroid)return;const C=lp(S,v);for(const E in this.touches){const R=C[E];(!R||R.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(f,v,S){if((!this.centroid||f.timeStamp-this.startTime>500)&&(this.aborted=!0),S.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class jh{constructor(f){this.singleTap=new d0(f),this.numTaps=f.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(f,v,S){this.singleTap.touchstart(f,v,S)}touchmove(f,v,S){this.singleTap.touchmove(f,v,S)}touchend(f,v,S){const C=this.singleTap.touchend(f,v,S);if(C){const E=f.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(C)<30;if(E&&R||this.reset(),this.count++,this.lastTime=f.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class p0{constructor(){this._zoomIn=new jh({numTouches:1,numTaps:2}),this._zoomOut=new jh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(f,v,S){this._zoomIn.touchstart(f,v,S),this._zoomOut.touchstart(f,v,S)}touchmove(f,v,S){this._zoomIn.touchmove(f,v,S),this._zoomOut.touchmove(f,v,S)}touchend(f,v,S){const C=this._zoomIn.touchend(f,v,S),E=this._zoomOut.touchend(f,v,S);return C?(this._active=!0,f.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(C)},{originalEvent:f})}):E?(this._active=!0,f.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(E)},{originalEvent:f})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const g0={0:1,2:2};class Wh{constructor(f){this.reset(),this._clickTolerance=f.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(f,v){return!1}_move(f,v){return{}}mousedown(f,v){if(this._lastPoint)return;const S=W(f);this._correctButton(f,S)&&(this._lastPoint=v,this._eventButton=S)}mousemoveWindow(f,v){const S=this._lastPoint;if(S){if(f.preventDefault(),this._eventButton!=null&&function(C,E){const R=g0[E];return C.buttons===void 0||(C.buttons&R)!==R}(f,this._eventButton))this.reset();else if(this._moved||!(v.dist(S)<this._clickTolerance))return this._moved=!0,this._lastPoint=v,this._move(S,v)}}mouseupWindow(f){this._lastPoint&&W(f)===this._eventButton&&(this._moved&&H(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vw extends Wh{mousedown(f,v){super.mousedown(f,v),this._lastPoint&&(this._active=!0)}_correctButton(f,v){return v===0&&!f.ctrlKey}_move(f,v){return{around:v,panDelta:v.sub(f)}}}class v0 extends Wh{_correctButton(f,v){return v===0&&f.ctrlKey||v===2}_move(f,v){const S=.8*(v.x-f.x);if(S)return this._active=!0,{bearingDelta:S}}contextmenu(f){f.preventDefault()}}class Oc extends Wh{_correctButton(f,v){return v===0&&f.ctrlKey||v===2}_move(f,v){const S=-.5*(v.y-f.y);if(S)return this._active=!0,{pitchDelta:S}}contextmenu(f){f.preventDefault()}}class lE{constructor(f,v){this._map=f,this._el=f.getCanvasContainer(),this._minTouches=1,this._clickTolerance=v.clickTolerance||1,this.reset(),o.a$(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(f,v,S){return this._calculateTransform(f,v,S)}touchmove(f,v,S){if(this._active&&!(S.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(S.length===1&&!o.d7())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return f.cancelable&&f.preventDefault(),this._calculateTransform(f,v,S)}}touchend(f,v,S){this._calculateTransform(f,v,S),this._active&&S.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(f,v,S){S.length>0&&(this._active=!0);const C=lp(S,v),E=new o.P(0,0),R=new o.P(0,0);let B=0;for(const j in C){const q=C[j],K=this._touches[j];K&&(E._add(q),R._add(q.sub(K)),B++,C[j]=q)}if(this._touches=C,B<this._minTouches||!R.mag())return;const G=R.div(B);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(B),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=x("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class m0{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(f){}_move(f,v,S){return{}}touchstart(f,v,S){this._firstTwoTouches||S.length<2||(this._firstTwoTouches=[S[0].identifier,S[1].identifier],this._start([v[0],v[1]]))}touchmove(f,v,S){const C=this._firstTwoTouches;if(!C)return;f.preventDefault();const[E,R]=C,B=cm(S,v,E),G=cm(S,v,R);if(!B||!G)return;const j=this._aroundCenter?null:B.add(G).div(2);return this._move([B,G],j,f)}touchend(f,v,S){if(!this._firstTwoTouches)return;const[C,E]=this._firstTwoTouches,R=cm(S,v,C),B=cm(S,v,E);R&&B||(this._active&&H(),this.reset())}touchcancel(){this.reset()}enable(f){this._enabled=!0,this._aroundCenter=!!f&&f.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function cm(w,f,v){for(let S=0;S<w.length;S++)if(w[S].identifier===v)return f[S]}function Gw(w,f){return Math.log(w/f)/Math.LN2}class uE extends m0{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(f){this._startDistance=this._distance=f[0].dist(f[1])}_move(f,v){const S=this._distance;if(this._distance=f[0].dist(f[1]),this._active||!(Math.abs(Gw(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gw(this._distance,S),pinchAround:v}}}function Uw(w,f){return 180*w.angleWith(f)/Math.PI}class _0 extends m0{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(f){this._startVector=this._vector=f[0].sub(f[1]),this._minDiameter=f[0].dist(f[1])}_move(f,v){const S=this._vector;if(this._vector=f[0].sub(f[1]),S&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Uw(this._vector,S),pinchAround:v}}_isBelowThreshold(f){this._minDiameter=Math.min(this._minDiameter,f.mag());const v=25/(Math.PI*this._minDiameter)*360,S=this._startVector;if(!S)return!1;const C=Uw(f,S);return Math.abs(C)<v}}function up(w){return Math.abs(w.y)>Math.abs(w.x)}class $w extends m0{constructor(f){super(),this._map=f}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(f){this._lastPoints=f,up(f[0].sub(f[1]))&&(this._valid=!1)}_move(f,v,S){const C=this._lastPoints;if(!C)return;const E=f[0].sub(C[0]),R=f[1].sub(C[1]);return this._map._cooperativeGestures&&!o.d7()&&S.touches.length<3||(this._valid=this.gestureBeginsVertically(E,R,S.timeStamp),!this._valid)?void 0:(this._lastPoints=f,this._active=!0,{pitchDelta:(E.y+R.y)/2*-.5})}gestureBeginsVertically(f,v,S){if(this._valid!==void 0)return this._valid;const C=f.mag()>=2,E=v.mag()>=2;if(!C&&!E)return;if(!C||!E)return this._firstMove==null&&(this._firstMove=S),S-this._firstMove<100&&void 0;const R=f.y>0==v.y>0;return up(f)&&up(v)&&R}}const Zh={panStep:100,bearingStep:15,pitchStep:10};class Hw{constructor(){const f=Zh;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(f){if(f.altKey||f.ctrlKey||f.metaKey)return;let v=0,S=0,C=0,E=0,R=0;switch(f.keyCode){case 61:case 107:case 171:case 187:v=1;break;case 189:case 109:case 173:v=-1;break;case 37:f.shiftKey?S=-1:(f.preventDefault(),E=-1);break;case 39:f.shiftKey?S=1:(f.preventDefault(),E=1);break;case 38:f.shiftKey?C=1:(f.preventDefault(),R=-1);break;case 40:f.shiftKey?C=-1:(f.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(S=0,C=0),{cameraAnimation:B=>{const G=B.getZoom();B.easeTo({duration:300,easeId:"keyboardHandler",easing:jw,zoom:v?Math.round(G)+v*(f.shiftKey?2:1):G,bearing:B.getBearing()+S*this._bearingStep,pitch:B.getPitch()+C*this._pitchStep,offset:[-E*this._panStep,-R*this._panStep],center:B.getCenter()},{originalEvent:f})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function jw(w){return w*(2-w)}const y0=4.000244140625,x0=1/450;class zc{constructor(f,v){this._map=f,this._el=f.getCanvasContainer(),this._handler=v,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=x0,o.a$(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(f){this._defaultZoomRate=f}setWheelZoomRate(f){this._wheelZoomRate=f}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(f){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!f&&f.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(f){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(f.ctrlKey||f.metaKey||this.isZooming()||o.d7()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let v=f.deltaMode===WheelEvent.DOM_DELTA_LINE?40*f.deltaY:f.deltaY;const S=o.f.now(),C=S-(this._lastWheelEventTime||0);this._lastWheelEventTime=S,v!==0&&v%y0==0?this._type="wheel":v!==0&&Math.abs(v)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=v,this._timeout=setTimeout(this._onTimeout,40,f)):this._type||(this._type=Math.abs(C*v)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,v+=this._lastValue)),f.shiftKey&&v&&(v/=4),this._type&&(this._lastWheelEvent=f,this._delta-=v,this._active||this._start(f)),f.preventDefault()}_onTimeout(f){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)}_start(f){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const v=$(this._el,f);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:v,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const f=this._map.transform;this._type==="wheel"&&f.projection.wrap&&(f._center.lng>=180||f._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const v=()=>f._terrainEnabled()&&this._aroundCoord?f.computeZoomRelativeTo(this._aroundCoord):f.zoom;if(this._delta!==0){const j=this._type==="wheel"&&Math.abs(this._delta)>y0?this._wheelZoomRate:this._defaultZoomRate;let q=2/(1+Math.exp(-Math.abs(this._delta*j)));this._delta<0&&q!==0&&(q=1/q);const K=v(),te=Math.pow(2,K),ne=typeof this._targetZoom=="number"?f.zoomScale(this._targetZoom):te;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(ne*q))),this._type==="wheel"&&(this._startZoom=K,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const S=typeof this._targetZoom=="number"?this._targetZoom:v(),C=this._startZoom,E=this._easing;let R,B=!1;if(this._type==="wheel"&&C&&E){const j=Math.min((o.f.now()-this._lastWheelEventTime)/200,1),q=E(j);R=o.X(C,S,q),j<1?this._frameId||(this._frameId=!0):B=!0}else R=S,B=!0;this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let G=R-v();return G*this._lastDelta<0&&(G=0),{noInertia:!0,needsRenderFrame:!B,zoomDelta:G,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(f){let v=o.d8;if(this._prevEase){const S=this._prevEase,C=(o.f.now()-S.start)/S.duration,E=S.easing(C+.01)-S.easing(C),R=.27/Math.sqrt(E*E+1e-4)*.01,B=Math.sqrt(.0729-R*R);v=o.d6(R,B,.25,1)}return this._prevEase={start:o.f.now(),duration:f,easing:v},v}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=x("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Ww{constructor(f,v){this._clickZoom=f,this._tapZoom=v}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Bc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(f,v){return f.preventDefault(),{cameraAnimation:S=>{S.easeTo({duration:300,zoom:S.getZoom()+(f.shiftKey?-1:1),around:S.unproject(v)},{originalEvent:f})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zw{constructor(){this._tap=new jh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(f,v,S){this._swipePoint||(this._tapTime&&f.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?S.length>0&&(this._swipePoint=v[0],this._swipeTouch=S[0].identifier):this._tap.touchstart(f,v,S))}touchmove(f,v,S){if(this._tapTime){if(this._swipePoint){if(S[0].identifier!==this._swipeTouch)return;const C=v[0],E=C.y-this._swipePoint.y;return this._swipePoint=C,f.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(f,v,S)}touchend(f,v,S){this._tapTime?this._swipePoint&&S.length===0&&this.reset():this._tap.touchend(f,v,S)&&(this._tapTime=f.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hm{constructor(f,v,S){this._el=f,this._mousePan=v,this._touchPan=S}enable(f){this._inertiaOptions=f||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qw{constructor(f,v,S){this._pitchWithRotate=f.pitchWithRotate,this._mouseRotate=v,this._mousePitch=S}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Yw{constructor(f,v,S,C){this._el=f,this._touchZoom=v,this._touchRotate=S,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(f){this._touchZoom.enable(f),this._rotationDisabled||this._touchRotate.enable(f),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const qh=w=>w.zoom||w.drag||w.pitch||w.rotate;class b0 extends o.b{}class cE{constructor(){this.constants=[1,1,.01],this.radius=0}setup(f,v){const S=o.Q.sub([],v,f);this.radius=o.Q.length(S[2]<0?o.Q.div([],S,this.constants):[S[0],S[1],0])}projectRay(f){o.Q.div(f,f,this.constants),o.Q.normalize(f,f),o.Q.mul(f,f,this.constants);const v=o.Q.scale([],f,this.radius);if(v[2]>0){const S=o.Q.scale([],[0,0,1],o.Q.dot(v,[0,0,1])),C=o.Q.scale([],o.Q.normalize([],[v[0],v[1],0]),this.radius),E=o.Q.add([],v,o.Q.scale([],o.Q.sub([],o.Q.add([],C,S),v),2));v[0]=E[0],v[1]=E[1]}return v}}function cp(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}class hp{constructor(f,v){this._map=f,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Nw(f),this._bearingSnap=v.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new cE,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(v),o.a$(["handleEvent","handleWindowEvent"],this);const S=this._el;this._listeners=[[S,"touchstart",{passive:!0}],[S,"touchmove",{passive:!1}],[S,"touchend",void 0],[S,"touchcancel",void 0],[S,"mousedown",void 0],[S,"mousemove",void 0],[S,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[S,"mouseover",void 0],[S,"mouseout",void 0],[S,"dblclick",void 0],[S,"click",void 0],[S,"keydown",{capture:!1}],[S,"keyup",void 0],[S,"wheel",{passive:!1}],[S,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,E,R]of this._listeners){const B=C===document?this.handleWindowEvent:this.handleEvent;C.addEventListener(E,B,R)}}destroy(){for(const[f,v,S]of this._listeners){const C=f===document?this.handleWindowEvent:this.handleEvent;f.removeEventListener(v,C,S)}}_addDefaultHandlers(f){const v=this._map,S=v.getCanvasContainer();this._add("mapEvent",new f0(v,f));const C=v.boxZoom=new um(v,f);this._add("boxZoom",C);const E=new p0,R=new Bc;v.doubleClickZoom=new Ww(R,E),this._add("tapZoom",E),this._add("clickZoom",R);const B=new Zw;this._add("tapDragZoom",B);const G=v.touchPitch=new $w(v);this._add("touchPitch",G);const j=new v0(f),q=new Oc(f);v.dragRotate=new qw(f,j,q),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);const K=new Vw(f),te=new lE(v,f);v.dragPan=new hm(S,K,te),this._add("mousePan",K),this._add("touchPan",te,["touchZoom","touchRotate"]);const ne=new _0,le=new uE;v.touchZoomRotate=new Yw(S,le,ne,B),this._add("touchRotate",ne,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new lm(v));const se=v.scrollZoom=new zc(v,this);this._add("scrollZoom",se,["mousePan"]);const ue=v.keyboard=new Hw;this._add("keyboard",ue);for(const ce of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])f.interactive&&f[ce]&&v[ce].enable(f[ce])}_add(f,v,S){this._handlers.push({handlerName:f,handler:v,allowed:S}),this._handlersById[f]=v}stop(f){if(!this._updatingCamera){for(const{handler:v}of this._handlers)v.reset();this._inertia.clear(),this._fireEvents({},{},f),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:f}of this._handlers)if(f.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qh(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(f,v,S){for(const C in f)if(C!==S&&(!v||v.indexOf(C)<0))return!0;return!1}handleWindowEvent(f){this.handleEvent(f,`${f.type}Window`)}_getMapTouches(f){const v=[];for(const S of f)this._el.contains(S.target)&&v.push(S);return v}handleEvent(f,v){this._updatingCamera=!0;const S=f.type==="renderFrame",C=S?void 0:f,E={needsRenderFrame:!1},R={},B={},G=f.touches?this._getMapTouches(f.touches):void 0,j=G?X(this._el,G):S?void 0:$(this._el,f);for(const{handlerName:te,handler:ne,allowed:le}of this._handlers){if(!ne.isEnabled())continue;let se;this._blockedByActive(B,le,te)?ne.reset():ne[v||f.type]&&(se=ne[v||f.type](f,j,G),this.mergeHandlerResult(E,R,se,te,C),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||ne.isActive())&&(B[te]=ne)}const q={};for(const te in this._previousActiveHandlers)B[te]||(q[te]=C);this._previousActiveHandlers=B,(Object.keys(q).length||cp(E))&&(this._changes.push([E,R,q]),this._triggerRenderFrame()),(Object.keys(B).length||cp(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=E;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}mergeHandlerResult(f,v,S,C,E){if(!S)return;o.e(f,S);const R={handlerName:C,originalEvent:S.originalEvent||E};S.zoomDelta!==void 0&&(v.zoom=R),S.panDelta!==void 0&&(v.drag=R),S.pitchDelta!==void 0&&(v.pitch=R),S.bearingDelta!==void 0&&(v.rotate=R)}_applyChanges(){const f={},v={},S={};for(const[C,E,R]of this._changes)C.panDelta&&(f.panDelta=(f.panDelta||new o.P(0,0))._add(C.panDelta)),C.zoomDelta&&(f.zoomDelta=(f.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(f.bearingDelta=(f.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(f.pitchDelta=(f.pitchDelta||0)+C.pitchDelta),C.around!==void 0&&(f.around=C.around),C.aroundCoord!==void 0&&(f.aroundCoord=C.aroundCoord),C.pinchAround!==void 0&&(f.pinchAround=C.pinchAround),C.noInertia&&(f.noInertia=C.noInertia),o.e(v,E),o.e(S,R);this._updateMapTransform(f,v,S),this._changes=[]}_updateMapTransform(f,v,S){const C=this._map,E=C.transform,R=ye=>[ye.x,ye.y,ye.z];if((ye=>{const Ce=this._eventsInProgress.drag;return Ce&&!this._handlersById[Ce.handlerName].isActive()})()&&!cp(f)){const ye=E.zoom;E.cameraElevationReference="sea",this._originalZoom!=null&&E._orthographicProjectionAtLowPitch&&E.projection.name!=="globe"&&E.pitch===0?(E.cameraElevationReference="ground",E.zoom=this._originalZoom):(E.recenterOnTerrain(),E.cameraElevationReference="ground"),ye!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&C._stop(!0),!cp(f))return void this._fireEvents(v,S,!0);let{panDelta:B,zoomDelta:G,bearingDelta:j,pitchDelta:q,around:K,aroundCoord:te,pinchAround:ne}=f;E._isCameraConstrained&&(G>0&&(G=0),E._isCameraConstrained=!1),ne!==void 0&&(K=ne),(G||(ye=>v[ye]&&!this._eventsInProgress[ye])("drag"))&&K&&(this._dragOrigin=R(E.pointCoordinate3D(K)),this._originalZoom=E.zoom,this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",C._stop(!0),K=K||C.transform.centerPoint,j&&(E.bearing+=j),q&&(E.pitch+=q),E._updateCameraState();const le=[0,0,0];if(B)if(E.projection.name==="mercator"){const ye=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(K).dir),Ce=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(K.sub(B)).dir);le[0]=Ce[0]-ye[0],le[1]=Ce[1]-ye[1]}else{const ye=E.pointCoordinate(K);if(E.projection.name==="globe"){B=B.rotate(-E.angle);const Ce=E._pixelsPerMercatorPixel/E.worldSize;le[0]=-B.x*o.d9(o.ax(ye.y))*Ce,le[1]=-B.y*o.d9(E.center.lat)*Ce}else{const Ce=E.pointCoordinate(K.sub(B));ye&&Ce&&(le[0]=Ce.x-ye.x,le[1]=Ce.y-ye.y)}}const se=E.zoom,ue=[0,0,0];if(G){const ye=R(te||E.pointCoordinate3D(K)),Ce={dir:o.Q.normalize([],o.Q.sub([],ye,E._camera.position))};if(Ce.dir[2]<0){const Ae=E.zoomDeltaToMovement(ye,G);o.Q.scale(ue,Ce.dir,Ae)}}const ce=o.Q.add(le,le,ue);E._translateCameraConstrained(ce),G&&Math.abs(E.zoom-se)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),f.noInertia||this._inertia.record(f),this._fireEvents(v,S,!0)}_fireEvents(f,v,S){const C=qh(this._eventsInProgress),E=qh(f),R={};for(const q in f){const{originalEvent:K}=f[q];this._eventsInProgress[q]||(R[`${q}start`]=K),this._eventsInProgress[q]=f[q]}!C&&E&&this._fireEvent("movestart",E.originalEvent);for(const q in R)this._fireEvent(q,R[q]);E&&this._fireEvent("move",E.originalEvent);for(const q in f){const{originalEvent:K}=f[q];this._fireEvent(q,K)}const B={};let G;for(const q in this._eventsInProgress){const{handlerName:K,originalEvent:te}=this._eventsInProgress[q];this._handlersById[K].isActive()||(delete this._eventsInProgress[q],G=v[K]||te,B[`${q}end`]=G)}for(const q in B)this._fireEvent(q,B[q]);const j=qh(this._eventsInProgress);if(S&&(C||E)&&!j){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=te=>te!==0&&-this._bearingSnap<te&&te<this._bearingSnap;q?(K(q.bearing||this._map.getBearing())&&(q.bearing=0),this._map.easeTo(q,{originalEvent:G})):(this._map.fire(new o.b("moveend",{originalEvent:G})),K(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(f,v){this._map.fire(new o.b(f,v?{originalEvent:v}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(f=>{this._frameId=void 0,this.handleEvent(new b0("renderFrame",{timeStamp:f})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Xw="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class hE extends o.E{constructor(f,v){super(),this._moving=!1,this._zooming=!1,this.transform=f,this._bearingSnap=v.bearingSnap,this._respectPrefersReducedMotion=v.respectPrefersReducedMotion!==!1,o.a$(["_renderFrameCallback"],this)}getCenter(){return new o.bq(this.transform.center.lng,this.transform.center.lat)}setCenter(f,v){return this.jumpTo({center:f},v)}panBy(f,v,S){return f=o.P.convert(f).mult(-1),this.panTo(this.transform.center,o.e({offset:f},v),S)}panTo(f,v,S){return this.easeTo(o.e({center:f},v),S)}getZoom(){return this.transform.zoom}setZoom(f,v){return this.jumpTo({zoom:f},v),this}zoomTo(f,v,S){return this.easeTo(o.e({zoom:f},v),S)}zoomIn(f,v){return this.zoomTo(this.getZoom()+1,f,v),this}zoomOut(f,v){return this.zoomTo(this.getZoom()-1,f,v),this}getBearing(){return this.transform.bearing}setBearing(f,v){return this.jumpTo({bearing:f},v),this}getPadding(){return this.transform.padding}setPadding(f,v){return this.jumpTo({padding:f},v),this}rotateTo(f,v,S){return this.easeTo(o.e({bearing:f},v),S)}resetNorth(f,v){return this.rotateTo(0,o.e({duration:1e3},f),v),this}resetNorthPitch(f,v){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},f),v),this}snapToNorth(f,v){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(f,v):this}getPitch(){return this.transform.pitch}setPitch(f,v){return this.jumpTo({pitch:f},v),this}cameraForBounds(f,v){f=o.ag.convert(f);const S=v&&v.bearing||0,C=v&&v.pitch||0,E=f.getNorthWest(),R=f.getSouthEast();return this._cameraForBounds(this.transform,E,R,S,C,v)}_extendPadding(f){const v={top:0,right:0,bottom:0,left:0};return f==null?o.e({},v,this.transform.padding):typeof f=="number"?{top:f,bottom:f,right:f,left:f}:o.e({},v,f)}_extendCameraOptions(f){return(f=o.e({offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=this._extendPadding(f.padding),f}_minimumAABBFrustumDistance(f,v){const S=v.max[0]-v.min[0],C=v.max[1]-v.min[1];return S/C>f.aspect?S/(2*Math.tan(.5*f.fovX)*f.aspect):C/(2*Math.tan(.5*f.fovY)*f.aspect)}_cameraForBoundsOnGlobe(f,v,S,C,E,R){const B=f.clone(),G=this._extendCameraOptions(R);B.bearing=C,B.pitch=E;const j=o.bq.convert(v),q=o.bq.convert(S),K=.5*(j.lat+q.lat),te=.5*(j.lng+q.lng),ne=o.da(K,te),le=o.Q.normalize([],ne),se=o.Q.normalize([],o.Q.cross([],le,[0,1,0])),ue=o.Q.cross([],se,le),ce=[se[0],se[1],se[2],0,ue[0],ue[1],ue[2],0,le[0],le[1],le[2],0,0,0,0,1],ye=[ne,o.da(j.lat,j.lng),o.da(q.lat,j.lng),o.da(q.lat,q.lng),o.da(j.lat,q.lng),o.da(K,j.lng),o.da(K,q.lng),o.da(j.lat,te),o.da(q.lat,te)];let Ce=o.bV.fromPoints(ye.map(ot=>[o.Q.dot(se,ot),o.Q.dot(ue,ot),o.Q.dot(le,ot)]));const Ae=o.Q.transformMat4([],Ce.center,ce);o.Q.squaredLength(Ae)===0&&o.Q.set(Ae,0,0,1),o.Q.normalize(Ae,Ae),o.Q.scale(Ae,Ae,o.ae),B.center=o.db(Ae);const De=B.getWorldToCameraMatrix(),he=o.a9.invert(new Float64Array(16),De);Ce=o.bV.applyTransform(Ce,o.a9.multiply([],De,ce));const we=this._extendAABB(Ce,B,G,C);if(!we)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ce=we,o.Q.transformMat4(Ae,Ae,De);const Fe=.5*(Ce.max[2]-Ce.min[2]),ze=this._minimumAABBFrustumDistance(B,Ce),je=o.Q.scale([],[0,0,1],Fe),it=o.Q.add(je,Ae,je),Ge=ze+(B.pitch===0?0:o.Q.distance(Ae,it)),rt=B.globeCenterInViewSpace,st=o.Q.sub([],Ae,[rt[0],rt[1],rt[2]]);o.Q.normalize(st,st),o.Q.scale(st,st,Ge);const Ve=o.Q.add([],Ae,st);o.Q.transformMat4(Ve,Ve,he);const Qe=o.dc/o.ae,kt=o.Q.length(Ve),Ze=o.bo(Math.max(kt*Qe-o.dc,Number.EPSILON),0),nt=Math.min(B.zoomFromMercatorZAdjusted(Ze),G.maxZoom);return nt>.5*(o.bJ+o.bA)?(B.setProjection({name:"mercator"}),B.zoom=nt,this._cameraForBounds(B,v,S,C,E,R)):{center:B.center,zoom:nt,bearing:C,pitch:E}}_extendAABB(f,v,S,C){const E=.5*((S.padding.left||0)+(S.padding.right||0)),R=.5*((S.padding.top||0)+(S.padding.bottom||0)),B=R,G=E,j=E,q=R,K=v.width-(G+j),te=v.height-(B+q),ne=o.Q.sub([],f.max,f.min),le=Math.min(K/ne[0],te/ne[1]),se=Math.min(v.scaleZoom(v.scale*le),S.maxZoom);if(isNaN(se))return null;const ue=v.scale/v.zoomScale(se),ce=new o.bV([f.min[0]-G*ue,f.min[1]-q*ue,f.min[2]],[f.max[0]+j*ue,f.max[1]+B*ue,f.max[2]]),ye=(typeof S.offset.x=="number"&&typeof S.offset.y=="number"?new o.P(S.offset.x,S.offset.y):o.P.convert(S.offset)).rotate(-o.bm(C));return ce.center[0]-=ye.x*ue,ce.center[1]+=ye.y*ue,ce}queryTerrainElevation(f,v){const S=this.transform.elevation;return S?(v=o.e({},{exaggerated:!0},v),S.getAtPoint(o.O.fromLngLat(f),null,v.exaggerated)):null}_cameraForBounds(f,v,S,C,E,R){if(f.projection.name==="globe")return this._cameraForBoundsOnGlobe(f,v,S,C,E,R);const B=f.clone(),G=this._extendCameraOptions(R);B.bearing=C,B.pitch=E;const j=o.bq.convert(v),q=o.bq.convert(S),K=new o.bq(j.lng,q.lat),te=new o.bq(q.lng,j.lat),ne=B.project(j),le=B.project(q),se=this.queryTerrainElevation(j),ue=this.queryTerrainElevation(q),ce=this.queryTerrainElevation(K),ye=this.queryTerrainElevation(te),Ce=[[ne.x,ne.y,Math.min(se||0,ue||0,ce||0,ye||0)],[le.x,le.y,Math.max(se||0,ue||0,ce||0,ye||0)]];let Ae=o.bV.fromPoints(Ce);const De=B.getWorldToCameraMatrix(),he=o.a9.invert(new Float64Array(16),De);Ae=o.bV.applyTransform(Ae,De);const we=this._extendAABB(Ae,B,G,C);if(!we)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ae=we;const Fe=.5*o.Q.sub([],Ae.max,Ae.min)[2],ze=this._minimumAABBFrustumDistance(B,Ae),je=[0,0,1,0];o.aa.transformMat4(je,je,De),o.aa.normalize(je,je);const it=o.Q.scale([],je,ze+Fe),Ge=o.Q.add([],Ae.center,it);o.Q.transformMat4(Ae.center,Ae.center,he),o.Q.transformMat4(Ge,Ge,he);const rt=[Ae.center[0],Ae.center[1],Ge[2]*B.pixelsPerMeter];o.Q.scale(rt,rt,1/B.worldSize);const st=o.aw(rt[0]),Ve=o.ax(rt[1]),Qe=Math.min(B._zoomFromMercatorZ(rt[2]),G.maxZoom),kt=new o.bq(st,Ve);return B.mercatorFromTransition&&Qe<.5*(o.bJ+o.bA)?(B.setProjection({name:"globe"}),B.zoom=Qe,this._cameraForBounds(B,v,S,C,E,R)):{center:kt,zoom:Qe,bearing:C,pitch:E}}fitBounds(f,v,S){const C=this.cameraForBounds(f,v);return this._fitInternal(C,v,S)}fitScreenCoordinates(f,v,S,C,E){const R=o.P.convert(f),B=o.P.convert(v),G=new o.P(Math.min(R.x,B.x),Math.min(R.y,B.y)),j=new o.P(Math.max(R.x,B.x),Math.max(R.y,B.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(R,B))return this;const q=this.transform.pointLocation3D(G),K=this.transform.pointLocation3D(j),te=this.transform.pointLocation3D(new o.P(G.x,j.y)),ne=this.transform.pointLocation3D(new o.P(j.x,G.y)),le=[Math.min(q.lng,K.lng,te.lng,ne.lng),Math.min(q.lat,K.lat,te.lat,ne.lat)],se=[Math.max(q.lng,K.lng,te.lng,ne.lng),Math.max(q.lat,K.lat,te.lat,ne.lat)],ue=C&&C.pitch?C.pitch:this.getPitch(),ce=this._cameraForBounds(this.transform,le,se,S,ue,C);return this._fitInternal(ce,C,E)}_fitInternal(f,v,S){return f?(v=o.e(f,v)).linear?this.easeTo(v,S):this.flyTo(v,S):this}jumpTo(f,v){this.stop();const S=f.preloadOnly?this.transform.clone():this.transform;let C=!1,E=!1,R=!1;return"zoom"in f&&S.zoom!==+f.zoom&&(C=!0,S.zoom=+f.zoom),f.center!==void 0&&(S.center=o.bq.convert(f.center)),"bearing"in f&&S.bearing!==+f.bearing&&(E=!0,S.bearing=+f.bearing),"pitch"in f&&S.pitch!==+f.pitch&&(R=!0,S.pitch=+f.pitch),f.padding==null||S.isPaddingEqual(f.padding)||(S.padding=f.padding),f.preloadOnly?(this._preloadTiles(S),this):(this.fire(new o.b("movestart",v)).fire(new o.b("move",v)),C&&this.fire(new o.b("zoomstart",v)).fire(new o.b("zoom",v)).fire(new o.b("zoomend",v)),E&&this.fire(new o.b("rotatestart",v)).fire(new o.b("rotate",v)).fire(new o.b("rotateend",v)),R&&this.fire(new o.b("pitchstart",v)).fire(new o.b("pitch",v)).fire(new o.b("pitchend",v)),this.fire(new o.b("moveend",v)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(Xw),this.transform.getFreeCameraOptions()}setFreeCameraOptions(f,v){const S=this.transform;if(!S.projection.supportsFreeCamera)return o.w(Xw),this;this.stop();const C=S.zoom,E=S.pitch,R=S.bearing;S.setFreeCameraOptions(f);const B=C!==S.zoom,G=E!==S.pitch,j=R!==S.bearing;return this.fire(new o.b("movestart",v)).fire(new o.b("move",v)),B&&this.fire(new o.b("zoomstart",v)).fire(new o.b("zoom",v)).fire(new o.b("zoomend",v)),j&&this.fire(new o.b("rotatestart",v)).fire(new o.b("rotate",v)).fire(new o.b("rotateend",v)),G&&this.fire(new o.b("pitchstart",v)).fire(new o.b("pitch",v)).fire(new o.b("pitchend",v)),this.fire(new o.b("moveend",v)),this}easeTo(f,v){this._stop(!1,f.easeId),((f=o.e({offset:[0,0],duration:500,easing:o.d8},f)).animate===!1||this._prefersReducedMotion(f))&&(f.duration=0);const S=this.transform,C=this.getZoom(),E=this.getBearing(),R=this.getPitch(),B=this.getPadding(),G="zoom"in f?+f.zoom:C,j="bearing"in f?this._normalizeBearing(f.bearing,E):E,q="pitch"in f?+f.pitch:R,K=this._extendPadding(f.padding),te=o.P.convert(f.offset);let ne,le,se;if(S.projection.name==="globe"){const ze=o.O.fromLngLat(S.center),je=te.rotate(-S.angle);ze.x+=je.x/S.worldSize,ze.y+=je.y/S.worldSize;const it=ze.toLngLat(),Ge=o.bq.convert(f.center||it);this._normalizeCenter(Ge),ne=S.centerPoint.add(je),le=new o.P(ze.x,ze.y).mult(S.worldSize),se=new o.P(o.a8(Ge.lng),o.ah(Ge.lat)).mult(S.worldSize).sub(le)}else{ne=S.centerPoint.add(te);const ze=S.pointLocation(ne),je=o.bq.convert(f.center||ze);this._normalizeCenter(je),le=S.project(ze),se=S.project(je).sub(le)}const ue=S.zoomScale(G-C);let ce,ye;f.around&&(ce=o.bq.convert(f.around),ye=S.locationPoint(ce));const Ce=this._zooming||G!==C,Ae=this._rotating||E!==j,De=this._pitching||q!==R,he=!S.isPaddingEqual(K),we=ze=>je=>{if(Ce&&(ze.zoom=o.X(C,G,je)),Ae&&(ze.bearing=o.X(E,j,je)),De&&(ze.pitch=o.X(R,q,je)),he&&(ze.interpolatePadding(B,K,je),ne=ze.centerPoint.add(te)),ce)ze.setLocationAtPoint(ce,ye);else{const it=ze.zoomScale(ze.zoom-C),Ge=G>C?Math.min(2,ue):Math.max(.5,ue),rt=Math.pow(Ge,1-je),st=ze.unproject(le.add(se.mult(je*rt)).mult(it));ze.setLocationAtPoint(ze.renderWorldCopies?st.wrap():st,ne)}return f.preloadOnly||this._fireMoveEvents(v),ze};if(f.preloadOnly){const ze=this._emulate(we,f.duration,S);return this._preloadTiles(ze),this}const Fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ce,this._rotating=Ae,this._pitching=De,this._padding=he,this._easeId=f.easeId,this._prepareEase(v,f.noMoveStart,Fe),this._ease(we(S),ze=>{S.cameraElevationReference==="sea"&&S.recenterOnTerrain(),this._afterEase(v,ze)},f),this}_prepareEase(f,v,S={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),v||S.moving||this.fire(new o.b("movestart",f)),this._zooming&&!S.zooming&&this.fire(new o.b("zoomstart",f)),this._rotating&&!S.rotating&&this.fire(new o.b("rotatestart",f)),this._pitching&&!S.pitching&&this.fire(new o.b("pitchstart",f))}_fireMoveEvents(f){this.fire(new o.b("move",f)),this._zooming&&this.fire(new o.b("zoom",f)),this._rotating&&this.fire(new o.b("rotate",f)),this._pitching&&this.fire(new o.b("pitch",f))}_afterEase(f,v){if(this._easeId&&v&&this._easeId===v)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const S=this._zooming,C=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,S&&this.fire(new o.b("zoomend",f)),C&&this.fire(new o.b("rotateend",f)),E&&this.fire(new o.b("pitchend",f)),this.fire(new o.b("moveend",f))}flyTo(f,v){if(this._prefersReducedMotion(f)){const nt=o.af(f,["center","zoom","bearing","pitch","around"]);return this.jumpTo(nt,v)}this.stop(),f=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.d8},f);const S=this.transform,C=this.getZoom(),E=this.getBearing(),R=this.getPitch(),B=this.getPadding(),G="zoom"in f?o.ad(+f.zoom,S.minZoom,S.maxZoom):C,j="bearing"in f?this._normalizeBearing(f.bearing,E):E,q="pitch"in f?+f.pitch:R,K=this._extendPadding(f.padding),te=S.zoomScale(G-C),ne=o.P.convert(f.offset);let le=S.centerPoint.add(ne);const se=S.pointLocation(le),ue=o.bq.convert(f.center||se);this._normalizeCenter(ue);const ce=S.project(se),ye=S.project(ue).sub(ce);let Ce=f.curve;const Ae=Math.max(S.width,S.height),De=Ae/te,he=ye.mag();if("minZoom"in f){const nt=o.ad(Math.min(f.minZoom,C,G),S.minZoom,S.maxZoom),ot=Ae/S.zoomScale(nt-C);Ce=Math.sqrt(ot/he*2)}const we=Ce*Ce;function Fe(nt){const ot=(De*De-Ae*Ae+(nt?-1:1)*we*we*he*he)/(2*(nt?De:Ae)*we*he);return Math.log(Math.sqrt(ot*ot+1)-ot)}function ze(nt){return(Math.exp(nt)-Math.exp(-nt))/2}function je(nt){return(Math.exp(nt)+Math.exp(-nt))/2}const it=Fe(0);let Ge=function(nt){return je(it)/je(it+Ce*nt)},rt=function(nt){return Ae*((je(it)*(ze(ot=it+Ce*nt)/je(ot))-ze(it))/we)/he;var ot},st=(Fe(1)-it)/Ce;if(Math.abs(he)<1e-6||!isFinite(st)){if(Math.abs(Ae-De)<1e-6)return this.easeTo(f,v);const nt=De<Ae?-1:1;st=Math.abs(Math.log(De/Ae))/Ce,rt=function(){return 0},Ge=function(ot){return Math.exp(nt*Ce*ot)}}f.duration="duration"in f?+f.duration:1e3*st/("screenSpeed"in f?+f.screenSpeed/Ce:+f.speed),f.maxDuration&&f.duration>f.maxDuration&&(f.duration=0);const Ve=E!==j,Qe=q!==R,kt=!S.isPaddingEqual(K),Ze=nt=>ot=>{const Me=ot*st,Tt=1/Ge(Me);nt.zoom=ot===1?G:C+nt.scaleZoom(Tt),Ve&&(nt.bearing=o.X(E,j,ot)),Qe&&(nt.pitch=o.X(R,q,ot)),kt&&(nt.interpolatePadding(B,K,ot),le=nt.centerPoint.add(ne));const lr=ot===1?ue:nt.unproject(ce.add(ye.mult(rt(Me))).mult(Tt));return nt.setLocationAtPoint(nt.renderWorldCopies?lr.wrap():lr,le),nt._updateCameraOnTerrain(),f.preloadOnly||this._fireMoveEvents(v),nt};if(f.preloadOnly){const nt=this._emulate(Ze,f.duration,S);return this._preloadTiles(nt),this}return this._zooming=!0,this._rotating=Ve,this._pitching=Qe,this._padding=kt,this._prepareEase(v,!1),this._ease(Ze(S),()=>this._afterEase(v),f),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(f){}_cancelRenderFrame(f){}_stop(f,v){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const S=this._onEaseEnd;this._onEaseEnd=void 0,S.call(this,v)}if(!f){const S=this.handlers;S&&S.stop(!1)}return this}_ease(f,v,S){S.animate===!1||S.duration===0?(f(1),v()):(this._easeStart=o.f.now(),this._easeOptions=S,this._onEaseFrame=f,this._onEaseEnd=v,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const f=Math.min((o.f.now()-this._easeStart)/this._easeOptions.duration,1),v=this._onEaseFrame;v&&v(this._easeOptions.easing(f)),f<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(f,v){f=o.bk(f,-180,180);const S=Math.abs(f-v);return Math.abs(f-360-v)<S&&(f-=360),Math.abs(f+360-v)<S&&(f+=360),f}_normalizeCenter(f){const v=this.transform;if(v.maxBounds||v.projection.name!=="globe"&&!v.renderWorldCopies)return;const S=f.lng-v.center.lng;f.lng+=S>180?-360:S<-180?360:0}_prefersReducedMotion(f){return this._respectPrefersReducedMotion&&o.f.prefersReducedMotion&&!(f&&f.essential)}_emulate(f,v,S){const C=Math.ceil(15*v/1e3),E=[],R=f(S.clone());for(let B=0;B<=C;B++){const G=R(B/C);E.push(G.clone())}return E}_preloadTiles(f,v){}}class w0{constructor(f={}){this.options=f,o.a$(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(f){const v=this.options&&this.options.compact;return this._map=f,this._container=x("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=x("button","mapboxgl-ctrl-attrib-button",this._container),x("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=x("div","mapboxgl-ctrl-attrib-inner",this._container),v&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),v===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(f,v){const S=this._map._getUIString(`AttributionControl.${v}`);f.removeAttribute("title"),f.firstElementChild&&f.firstElementChild.setAttribute("title",S)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let f=this._editLink;f||(f=this._editLink=this._container.querySelector(".mapbox-improve-map"));const v=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.dd.ACCESS_TOKEN}];if(f){const S=v.reduce((C,E,R)=>(E.value&&(C+=`${E.key}=${E.value}${R<v.length-1?"&":""}`),C),"?");f.href=`${o.dd.FEEDBACK_URL}/${S}#${Bw(this._map,!0)}`,f.rel="noopener nofollow",this._setElementTitle(f,"MapFeedback")}}_updateData(f){!f||f.sourceDataType!=="metadata"&&f.sourceDataType!=="visibility"&&f.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let f=[];if(this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const v=this._map.style._mergedSourceCaches;for(const C in v){const E=v[C];if(E.used){const R=E.getSource();R.attribution&&f.indexOf(R.attribution)<0&&f.push(R.attribution)}}f.sort((C,E)=>C.length-E.length),f=f.filter((C,E)=>{for(let R=E+1;R<f.length;R++)if(f[R].indexOf(C)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?f=[...this.options.customAttribution,...f]:f.unshift(this.options.customAttribution));const S=f.join(" | ");S!==this._attribHTML&&(this._attribHTML=S,f.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Qw{constructor(){o.a$(["_updateLogo","_updateCompact"],this)}onAdd(f){this._map=f,this._container=x("div","mapboxgl-ctrl");const v=x("a","mapboxgl-ctrl-logo");return v.target="_blank",v.rel="noopener nofollow",v.href="https://www.mapbox.com/",v.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),v.setAttribute("rel","noopener nofollow"),this._container.appendChild(v),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(f){f&&f.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const f=this._map.style._sourceCaches;if(Object.entries(f).length===0)return!0;for(const v in f){const S=f[v].getSource();if(S.hasOwnProperty("mapbox_logo")&&!S.mapbox_logo)return!1}return!0}_updateCompact(){const f=this._container.children;if(f.length){const v=f[0];this._map.getCanvasContainer().offsetWidth<250?v.classList.add("mapboxgl-compact"):v.classList.remove("mapboxgl-compact")}}}class fm{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(f){const v=++this._id;return this._queue.push({callback:f,id:v,cancelled:!1}),v}remove(f){const v=this._currentlyRunning,S=v?this._queue.concat(v):this._queue;for(const C of S)if(C.id===f)return void(C.cancelled=!0)}run(f=0){const v=this._currentlyRunning=this._queue;this._queue=[];for(const S of v)if(!S.cancelled&&(S.callback(f),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function dm(w,f,v){if(w=new o.bq(w.lng,w.lat),f){const S=new o.bq(w.lng-360,w.lat),C=new o.bq(w.lng+360,w.lat),E=360*Math.ceil(Math.abs(w.lng-v.center.lng)/360),R=v.locationPoint(w).distSqr(f),B=f.x<0||f.y<0||f.x>v.width||f.y>v.height;v.locationPoint(S).distSqr(f)<R&&(B||Math.abs(S.lng-v.center.lng)<E)?w=S:v.locationPoint(C).distSqr(f)<R&&(B||Math.abs(C.lng-v.center.lng)<E)&&(w=C)}for(;Math.abs(w.lng-v.center.lng)>180;){const S=v.locationPoint(w);if(S.x>=0&&S.y>=0&&S.x<=v.width&&S.y<=v.height)break;w.lng>v.center.lng?w.lng-=360:w.lng+=360}return w}const Yh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class fp extends o.E{constructor(f,v){if(super(),(f instanceof HTMLElement||v)&&(f=o.e({element:f},v)),o.a$(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=f&&f.anchor||"center",this._color=f&&f.color||"#3FB1CE",this._scale=f&&f.scale||1,this._draggable=f&&f.draggable||!1,this._clickTolerance=f&&f.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=f&&f.rotation||0,this._rotationAlignment=f&&f.rotationAlignment||"auto",this._pitchAlignment=f&&f.pitchAlignment&&f.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=f&&f.occludedOpacity||.2,f&&f.element)this._element=f.element,this._offset=o.P.convert(f&&f.offset||[0,0]);else{this._defaultMarker=!0,this._element=x("div");const E=41,R=27,B=A("svg",{display:"block",height:E*this._scale+"px",width:R*this._scale+"px",viewBox:`0 0 ${R} ${E}`},this._element),G=A("radialGradient",{id:"shadowGradient"},A("defs",{},B));A("stop",{offset:"10%","stop-opacity":.4},G),A("stop",{offset:"100%","stop-opacity":.05},G),A("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},B),A("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},B),A("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},B),A("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},B),this._offset=o.P.convert(f&&f.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()});const S=this._element.classList;for(const E in Yh)S.remove(`mapboxgl-marker-anchor-${E}`);S.add(`mapboxgl-marker-anchor-${this._anchor}`);const C=f&&f.className?f.className.trim().split(/\s+/):[];S.add(...C),this._popup=null}addTo(f){return f===this._map||(this.remove(),this._map=f,f.getCanvasContainer().appendChild(this._element),f.on("move",this._updateMoving),f.on("moveend",this._update),f.on("remove",this._clearFadeTimer),f._addMarker(this),this.setDraggable(this._draggable),this._update(),f.on("click",this._onMapClick)),this}remove(){const f=this._map;return f&&(f.off("click",this._onMapClick),f.off("move",this._updateMoving),f.off("moveend",this._update),f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler),f.off("mouseup",this._onUp),f.off("touchend",this._onUp),f.off("mousemove",this._onMove),f.off("touchmove",this._onMove),f.off("remove",this._clearFadeTimer),f._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=o.bq.convert(f),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(f){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),f){if(!("offset"in f.options)){const C=Math.sqrt(Math.pow(13.5,2)/2);f.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=f,f._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(f){const v=f.code,S=f.charCode||f.keyCode;v!=="Space"&&v!=="Enter"&&S!==32&&S!==13||this.togglePopup()}_onMapClick(f){const v=f.originalEvent.target,S=this._element;this._popup&&(v===S||S.contains(v))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const f=this._popup;return f?(f.isOpen()?(f.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(f.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const f=this._map,v=this._pos;if(!f||!v)return!1;const S=f.unproject(v),C=f.getFreeCameraOptions();if(!C.position)return!1;const E=C.position.toLngLat();return E.distanceTo(S)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const f=this._map;if(!f)return;const v=this._pos;if(!v||v.x<0||v.x>f.transform.width||v.y<0||v.y>f.transform.height)return void this._clearFadeTimer();const S=f.unproject(v);let C;f._showingGlobe()&&o.de(f.transform,this._lngLat)?C=0:(C=1-f._queryFogOpacity(S),f.transform._terrainEnabled()&&f.getTerrain()&&this._behindTerrain()&&(C*=this._occludedOpacity)),this._element.style.opacity=`${C}`,this._element.style.pointerEvents=C>0?"auto":"none",this._popup&&this._popup._setOpacity(C),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const f=this._pos;if(!f||!this._map)return;const v=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${f.x}px,${f.y}px)
            ${Yh[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${v.x}px,${v.y}px)
        `}_calculateXYTransform(){const f=this._pos,v=this._map,S=this.getPitchAlignment();if(!v||!f||S!=="map")return"";if(!v._showingGlobe()){const G=v.getPitch();return G?`rotateX(${G}deg)`:""}const C=o.bI(o.df(v.transform,this._lngLat)),E=f.sub(o.dg(v.transform)),R=Math.abs(E.x)+Math.abs(E.y);if(R===0)return"";const B=C/R;return`rotateX(${-E.y*B}deg) rotateY(${E.x*B}deg)`}_calculateZTransform(){const f=this._pos,v=this._map;if(!v||!f)return"";let S=0;const C=this.getRotationAlignment();if(C==="map")if(v._showingGlobe()){const E=v.project(new o.bq(this._lngLat.lng,this._lngLat.lat+.001)),R=v.project(new o.bq(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);S=o.bI(Math.atan2(R.y,R.x))-90}else S=-v.getBearing();else if(C==="horizon"){const E=o.S(4,6,v.getZoom()),R=o.dg(v.transform);R.y+=E*v.transform.height;const B=f.sub(R),G=o.bI(Math.atan2(B.y,B.x));S=(G>90?G-270:G+90)*(1-E)}return S+=this._rotation,S?`rotateZ(${S}deg)`:""}_update(f){cancelAnimationFrame(this._updateFrameId);const v=this._map;v&&(v.transform.renderWorldCopies&&(this._lngLat=dm(this._lngLat,this._pos,v.transform)),this._pos=v.project(this._lngLat),f===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),v._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(v._showingGlobe()||v.getTerrain()||v.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(f){return this._offset=o.P.convert(f),this._update(),this}addClassName(f){return this._element.classList.add(f),this}removeClassName(f){return this._element.classList.remove(f),this}toggleClassName(f){return this._element.classList.toggle(f)}_onMove(f){const v=this._map;if(!v)return;const S=this._pointerdownPos,C=this._positionDelta;if(S&&C){if(!this._isDragging){const E=this._clickTolerance||v._clickTolerance;if(f.point.dist(S)<E)return;this._isDragging=!0}this._pos=f.point.sub(C),this._lngLat=v.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.b("dragstart"))),this.fire(new o.b("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const f=this._map;f&&(f.off("mousemove",this._onMove),f.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.b("dragend")),this._state="inactive"}_addDragHandler(f){const v=this._map,S=this._pos;v&&S&&this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(S),this._pointerdownPos=f.point,this._state="pending",v.on("mousemove",this._onMove),v.on("touchmove",this._onMove),v.once("mouseup",this._onUp),v.once("touchend",this._onUp))}setDraggable(f){this._draggable=!!f;const v=this._map;return v&&(f?(v.on("mousedown",this._addDragHandler),v.on("touchstart",this._addDragHandler)):(v.off("mousedown",this._addDragHandler),v.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(f){return this._rotation=f||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(f){return this._rotationAlignment=f||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(f){return this._pitchAlignment=f||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(f){return this._occludedOpacity=f||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const dp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Kw=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function pp(w=new o.P(0,0),f="bottom"){if(typeof w=="number"){const v=Math.round(Math.sqrt(.5*Math.pow(w,2)));switch(f){case"top":return new o.P(0,w);case"top-left":return new o.P(v,v);case"top-right":return new o.P(-v,v);case"bottom":return new o.P(0,-w);case"bottom-left":return new o.P(v,-v);case"bottom-right":return new o.P(-v,-v);case"left":return new o.P(w,0);case"right":return new o.P(-w,0)}return new o.P(0,0)}return w instanceof o.P||Array.isArray(w)?o.P.convert(w):o.P.convert(w[f]||[0,0])}class pm{constructor(f){this.jumpTo(f)}getValue(f){if(f<=this._startTime)return this._start;if(f>=this._endTime)return this._end;const v=o.ch((f-this._startTime)/(this._endTime-this._startTime));return this._start*(1-v)+this._end*v}isEasing(f){return f>=this._startTime&&f<=this._endTime}jumpTo(f){this._startTime=-1/0,this._endTime=-1/0,this._start=f,this._end=f}easeTo(f,v,S){this._start=this.getValue(v),this._end=f,this._startTime=v,this._endTime=v+S}}class Jw{registerParameter(f,v,S,C,E){}registerButton(f,v,S){}registerBinding(f,v,S,C){}refreshUI(){}}const zu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ol={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},Xh={showCompass:!0,showZoom:!0,visualizePitch:!1};class gm{constructor(f,v,S=!1){this._clickTolerance=10,this.element=v,this.mouseRotate=new v0({clickTolerance:f.dragRotate._mouseRotate._clickTolerance}),this.map=f,S&&(this.mousePitch=new Oc({clickTolerance:f.dragRotate._mousePitch._clickTolerance})),o.a$(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),v.addEventListener("mousedown",this.mousedown),v.addEventListener("touchstart",this.touchstart,{passive:!1}),v.addEventListener("touchmove",this.touchmove),v.addEventListener("touchend",this.touchend),v.addEventListener("touchcancel",this.reset)}down(f,v){this.mouseRotate.mousedown(f,v),this.mousePitch&&this.mousePitch.mousedown(f,v),O()}move(f,v){const S=this.map,C=this.mouseRotate.mousemoveWindow(f,v),E=C&&C.bearingDelta;if(E&&S.setBearing(S.getBearing()+E),this.mousePitch){const R=this.mousePitch.mousemoveWindow(f,v),B=R&&R.pitchDelta;B&&S.setPitch(S.getPitch()+B)}}off(){const f=this.element;f.removeEventListener("mousedown",this.mousedown),f.removeEventListener("touchstart",this.touchstart,{passive:!1}),f.removeEventListener("touchmove",this.touchmove),f.removeEventListener("touchend",this.touchend),f.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(f){this.down(o.e({},f,{ctrlKey:!0,preventDefault:()=>f.preventDefault()}),$(this.element,f)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(f){this.move(f,$(this.element,f))}mouseup(f){this.mouseRotate.mouseupWindow(f),this.mousePitch&&this.mousePitch.mouseupWindow(f),this.offTemp()}touchstart(f){f.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=X(this.element,f.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>f.preventDefault()},this._startPos))}touchmove(f){f.targetTouches.length!==1?this.reset():(this._lastPos=X(this.element,f.targetTouches)[0],this.move({preventDefault:()=>f.preventDefault()},this._lastPos))}touchend(f){f.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const gr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},eS={maxWidth:100,unit:"metric"},tS={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:o.du,supported:g,setRTLTextPlugin:o.dw,getRTLTextPluginStatus:o.dx,Map:class extends hE{constructor(w){const f=w;if((w=o.e({},ol,w)).minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(w.antialias&&o.dh(window)&&(w.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Fv(w.minZoom,w.maxZoom,w.minPitch,w.maxPitch,w.renderWorldCopies),w),this._repaint=!!w.repaint,this._interactive=w.interactive,this._minTileCacheSize=w.minTileCacheSize,this._maxTileCacheSize=w.maxTileCacheSize,this._failIfMajorPerformanceCaveat=w.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=w.preserveDrawingBuffer,this._antialias=w.antialias,this._trackResize=w.trackResize,this._bearingSnap=w.bearingSnap,this._refreshExpiredTiles=w.refreshExpiredTiles,this._fadeDuration=w.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=w.crossSourceCollisions,this._collectResourceTiming=w.collectResourceTiming,this._language=this._parseLanguage(w.language),this._worldview=w.worldview,this._renderTaskQueue=new fm,this._domRenderTaskQueue=new fm,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.aF(),this._locale=o.e({},zu,w.locale),this._clickTolerance=w.clickTolerance,this._cooperativeGestures=w.cooperativeGestures,this._performanceMetricsCollection=w.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new pm(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.di(w.transformRequest,w.accessToken,w.testMode),this._silenceAuthErrors=!!w.testMode,this._contextCreateOptions=w.contextCreateOptions?{...w.contextCreateOptions}:{},typeof w.container=="string"){const v=document.getElementById(w.container);if(!v)throw new Error(`Container '${w.container.toString()}' not found.`);this._container=v}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),w.maxBounds&&this.setMaxBounds(w.maxBounds),o.a$(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp=w.devtools?new Jw(this):new Jw,this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new hp(this,w),this._localFontFamily=w.localFontFamily,this._localIdeographFontFamily=w.localIdeographFontFamily,(w.style||!w.testMode)&&this.setStyle(w.style||o.dd.DEFAULT_STYLE,{config:w.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),w.projection&&this.setProjection(w.projection),w.hash&&(this._hash=new sE(typeof w.hash=="string"&&w.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){f.center==null&&f.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:w.center,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch});const v=w.bounds;v&&(this.resize(),this.fitBounds(v,o.e({},w.fitBoundsOptions,{duration:0})))}this.resize(),w.attributionControl&&this.addControl(new w0({customAttribution:w.customAttribution})),this._logoControl=new Qw,this.addControl(this._logoControl,w.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",v=>{this._update(v.dataType==="style"),this.fire(new o.b(`${v.dataType}data`,v))}),this.on("dataloading",v=>{this.fire(new o.b(`${v.dataType}dataloading`,v))})}_getMapId(){return this._mapId}addControl(w,f){if(f===void 0&&(f=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new o.a(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const v=w.onAdd(this);this._controls.push(w);const S=this._controlPositions[f];return f.indexOf("bottom")!==-1?S.insertBefore(v,S.firstChild):S.appendChild(v),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new o.a(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const f=this._controls.indexOf(w);return f>-1&&this._controls.splice(f,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(w){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const f=!this._moving;return f&&this.fire(new o.b("movestart",w)).fire(new o.b("move",w)),this.fire(new o.b("resize",w)),f&&this.fire(new o.b("moveend",w)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(w){return this.transform.setMaxBounds(o.ag.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom)return this.transform.minZoom=w,this._update(),this.getZoom()<w?this.setZoom(w):this.fire(new o.b("zoomstart")).fire(new o.b("zoom")).fire(new o.b("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom)return this.transform.maxZoom=w,this._update(),this.getZoom()>w?this.setZoom(w):this.fire(new o.b("zoomstart")).fire(new o.b("zoom")).fire(new o.b("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.minPitch=w,this._update(),this.getPitch()<w?this.setPitch(w):this.fire(new o.b("pitchstart")).fire(new o.b("pitch")).fire(new o.b("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(w>=this.transform.minPitch)return this.transform.maxPitch=w,this._update(),this.getPitch()>w?this.setPitch(w):this.fire(new o.b("pitchstart")).fire(new o.b("pitch")).fire(new o.b("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.renderWorldCopies=w,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(w){return w==="auto"?navigator.language:Array.isArray(w)?w.length===0?void 0:w.map(f=>f==="auto"?navigator.language:f):w}setLanguage(w){const f=this._parseLanguage(w);if(!this.style||f===this._language)return this;this._language=f,this.style.reloadSources();for(const v of this._controls)v._setLanguage&&v._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(w){return this.style&&w!==this._worldview?(this._worldview=w,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(w){return this._lazyInitEmptyStyle(),w?typeof w=="string"&&(w={name:w}):w=null,this._useExplicitProjection=!!w,this._prioritizeAndUpdateProjection(w,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const w=this.transform,f=w.projection.name;let v;f==="globe"&&w.zoom>=o.bA?(w.setMercatorFromTransition(),v=!0):f==="mercator"&&w.zoom<o.bA&&(w.setProjection({name:"globe"}),v=!0),v&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(w,f){return this._updateProjection(w||f||{name:"mercator"})}_updateProjection(w){let f;return f=w.name==="globe"&&this.transform.zoom>=o.bA?this.transform.setMercatorFromTransition():this.transform.setProjection(w),this.style.applyProjectionUpdate(),f&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(w){return this.transform.locationPoint3D(o.bq.convert(w))}unproject(w){return this.transform.pointLocation3D(o.P.convert(w))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(w,f,v){if(w==="mouseenter"||w==="mouseover"){let S=!1;const C=R=>{const B=f.filter(j=>this.getLayer(j)),G=B.length?this.queryRenderedFeatures(R.point,{layers:B}):[];G.length?S||(S=!0,v.call(this,new ja(w,this,R.originalEvent,{features:G}))):S=!1},E=()=>{S=!1};return{layers:new Set(f),listener:v,delegates:{mousemove:C,mouseout:E}}}if(w==="mouseleave"||w==="mouseout"){let S=!1;const C=R=>{const B=f.filter(G=>this.getLayer(G));(B.length?this.queryRenderedFeatures(R.point,{layers:B}):[]).length?S=!0:S&&(S=!1,v.call(this,new ja(w,this,R.originalEvent)))},E=R=>{S&&(S=!1,v.call(this,new ja(w,this,R.originalEvent)))};return{layers:new Set(f),listener:v,delegates:{mousemove:C,mouseout:E}}}{const S=C=>{const E=f.filter(B=>this.getLayer(B)),R=E.length?this.queryRenderedFeatures(C.point,{layers:E}):[];R.length&&(C.features=R,v.call(this,C),delete C.features)};return{layers:new Set(f),listener:v,delegates:{[w]:S}}}}on(w,f,v){if(v===void 0)return super.on(w,f);if(Array.isArray(f)||(f=[f]),f){for(const C of f)if(!this._isValidId(C))return this}const S=this._createDelegatedListener(w,f,v);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(S);for(const C in S.delegates)this.on(C,S.delegates[C]);return this}once(w,f,v){if(v===void 0)return super.once(w,f);if(Array.isArray(f)||(f=[f]),f){for(const C of f)if(!this._isValidId(C))return this}const S=this._createDelegatedListener(w,f,v);for(const C in S.delegates)this.once(C,S.delegates[C]);return this}off(w,f,v){if(v===void 0)return super.off(w,f);f=new Set(Array.isArray(f)?f:[f]);for(const E of f)if(!this._isValidId(E))return this;const S=(E,R)=>{if(E.size!==R.size)return!1;for(const B of E)if(!R.has(B))return!1;return!0},C=this._delegatedListeners?this._delegatedListeners[w]:void 0;return C&&(E=>{for(let R=0;R<E.length;R++){const B=E[R];if(B.listener===v&&S(B.layers,f)){for(const G in B.delegates)this.off(G,B.delegates[G]);return E.splice(R,1),this}}})(C),this}queryRenderedFeatures(w,f){if(!this.style)return[];if(f!==void 0||w===void 0||w instanceof o.P||Array.isArray(w)||(f=w,w=void 0),w=w||[[0,0],[this.transform.width,this.transform.height]],(f=f||{}).layers&&Array.isArray(f.layers)){for(const v of f.layers)if(!this._isValidId(v))return[]}return this.style.queryRenderedFeatures(w,f,this.transform)}querySourceFeatures(w,f){return this._isValidId(w)?this.style.querySourceFeatures(w,f):[]}isPointOnSurface(w){const{name:f}=this.transform.projection;return f!=="globe"&&f!=="mercator"&&o.w(`${f} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(w))}setStyle(w,f){return f=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},f),this.style&&w&&f.diff!==!1&&f.localFontFamily===this._localFontFamily&&f.localIdeographFontFamily===this._localIdeographFontFamily&&!f.config?(this.style._diffStyle(w,(v,S)=>{v?(o.w(`Unable to perform style diff: ${String(v.message||v.error||v)}. Rebuilding the style from scratch.`),this._updateStyle(w,f)):S&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=f.localIdeographFontFamily,this._localFontFamily=f.localFontFamily,this._updateStyle(w,f))}_getUIString(w){const f=this._locale[w];if(f==null)throw new Error(`Missing UI string '${w}'`);return f}_updateStyle(w,f){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),w){const v=o.e({},f);f&&f.config&&(v.initialConfig=f.config,delete v.config),this.style=new zs(this,v).setEventedParent(this,{style:this.style}).load(w)}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new zs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(w){return w==null?(this.fire(new o.a(new Error("IDs can't be empty."))),!1):!o.c9(w)||(this.fire(new o.a(new Error(`IDs can't contain special symbols: "${w}".`))),!1)}addSource(w,f){return this._isValidId(w)?(this._lazyInitEmptyStyle(),this.style.addSource(w,f),this._update(!0)):this}isSourceLoaded(w){return!!this._isValidId(w)&&!!this.style&&this.style._isSourceCacheLoaded(w)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(w,f,v){this._lazyInitEmptyStyle(),this.style.addSourceType(w,f,v)}removeSource(w){return this._isValidId(w)?(this.style.removeSource(w),this._updateTerrain(),this._update(!0)):this}getSource(w){return this._isValidId(w)?this.style.getOwnSource(w):null}addImage(w,f,{pixelRatio:v=1,sdf:S=!1,stretchX:C,stretchY:E,content:R}={}){if(this._lazyInitEmptyStyle(),f instanceof HTMLImageElement||ImageBitmap&&f instanceof ImageBitmap){const{width:B,height:G,data:j}=o.f.getImageData(f);this.style.addImage(w,{data:new o.h({width:B,height:G},j),pixelRatio:v,stretchX:C,stretchY:E,content:R,sdf:S,version:0})}else if(f.width===void 0||f.height===void 0)this.fire(new o.a(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:B,height:G}=f,j=f;this.style.addImage(w,{data:new o.h({width:B,height:G},new Uint8Array(j.data)),pixelRatio:v,stretchX:C,stretchY:E,content:R,sdf:S,version:0,userImage:j}),j.onAdd&&j.onAdd(this,w)}}updateImage(w,f){this._lazyInitEmptyStyle();const v=this.style.getImage(w);if(!v)return void this.fire(new o.a(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=f instanceof HTMLImageElement||ImageBitmap&&f instanceof ImageBitmap?o.f.getImageData(f):f,{width:C,height:E}=S,R=S.data;if(C===void 0||E===void 0)return void this.fire(new o.a(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==v.data.width||E!==v.data.height)return void this.fire(new o.a(new Error(`The width and height of the updated image (${C}, ${E})
                must be that same as the previous version of the image
                (${v.data.width}, ${v.data.height})`)));const B=!(f instanceof HTMLImageElement||ImageBitmap&&f instanceof ImageBitmap);v.data.replace(R,B),this.style.updateImage(w,v)}hasImage(w){return w?!!this.style&&!!this.style.getImage(w):(this.fire(new o.a(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w,f){o.d(this._requestManager.transformRequest(w,o.R.Image),(v,S)=>{f(v,S instanceof HTMLImageElement?o.f.getImageData(S):S)})}listImages(){return this.style.listImages()}addModel(w,f){this._lazyInitEmptyStyle(),this.style.addModel(w,f)}hasModel(w){return w?this.style.hasModel(w):(this.fire(new o.a(new Error("Missing required model id"))),!1)}removeModel(w){this.style.removeModel(w)}listModels(){return this.style.listModels()}addLayer(w,f){return this._isValidId(w.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(w,f),this._update(!0)):this}getSlot(w){const f=this.getLayer(w);return f&&f.slot||null}setSlot(w,f){return this.style.setSlot(w,f),this.style.mergeLayers(),this._update(!0)}addImport(w,f){return this.style.addImport(w,f),this}updateImport(w,f){return typeof f!="string"&&f.id!==w?(this.removeImport(w),this.addImport(f)):(this.style.updateImport(w,f),this._update(!0))}removeImport(w){return this.style.removeImport(w),this}moveImport(w,f){return this.style.moveImport(w,f),this._update(!0)}moveLayer(w,f){return this._isValidId(w)?(this.style.moveLayer(w,f),this._update(!0)):this}removeLayer(w){return this._isValidId(w)?(this.style.removeLayer(w),this._update(!0)):this}getLayer(w){return this._isValidId(w)?this.style.getOwnLayer(w):null}setLayerZoomRange(w,f,v){return this._isValidId(w)?(this.style.setLayerZoomRange(w,f,v),this._update(!0)):this}setFilter(w,f,v={}){return this._isValidId(w)?(this.style.setFilter(w,f,v),this._update(!0)):this}getFilter(w){return this._isValidId(w)?this.style.getFilter(w):null}setPaintProperty(w,f,v,S={}){return this._isValidId(w)?(this.style.setPaintProperty(w,f,v,S),this._update(!0)):this}getPaintProperty(w,f){return this._isValidId(w)?this.style.getPaintProperty(w,f):null}setLayoutProperty(w,f,v,S={}){return this._isValidId(w)?(this.style.setLayoutProperty(w,f,v,S),this._update(!0)):this}getLayoutProperty(w,f){return this._isValidId(w)?this.style.getLayoutProperty(w,f):null}getSchema(w){return this.style.getSchema(w)}setSchema(w,f){return this.style.setSchema(w,f),this._update(!0)}getConfig(w){return this.style.getConfig(w)}setConfig(w,f){return this.style.setConfig(w,f),this._update(!0)}getConfigProperty(w,f){return this.style.getConfigProperty(w,f)}setConfigProperty(w,f,v){return this.style.setConfigProperty(w,f,v),this._update(!0)}setLights(w){if(this._lazyInitEmptyStyle(),w&&w.length===1&&w[0].type==="flat"){const f=w[0];f.properties?this.style.setFlatLight(f.properties,f.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(w),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const w=this.style.getLights()||[];return w.length===0&&w.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),w}setLight(w,f={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:w}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(w){return this._lazyInitEmptyStyle(),!w&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(w),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(w){return this._lazyInitEmptyStyle(),this.style.setFog(w),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(w){return this.style.setCamera(w),this._triggerCameraUpdate(w)}_triggerCameraUpdate(w){return this._update(this.transform.setOrthographicProjectionAtLowPitch(w["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(w){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.bq.convert(w),this.transform):0}setFeatureState(w,f){return this._isValidId(w.source)?(this.style.setFeatureState(w,f),this._update()):this}removeFeatureState(w,f){return this._isValidId(w.source)?(this.style.removeFeatureState(w,f),this._update()):this}getFeatureState(w){return this._isValidId(w.source)?this.style.getFeatureState(w):null}_updateContainerDimensions(){if(!this._container)return;const w=this._container.getBoundingClientRect().width||400,f=this._container.getBoundingClientRect().height||300;let v,S,C,E=this._container;for(;E&&(!S||!C);){const R=window.getComputedStyle(E).transform;R&&R!=="none"&&(v=R.match(/matrix.*\((.+)\)/)[1].split(", "),v[0]&&v[0]!=="0"&&v[0]!=="1"&&(S=v[0]),v[3]&&v[3]!=="0"&&v[3]!=="1"&&(C=v[3])),E=E.parentElement}this._containerWidth=S?Math.abs(w/S):w,this._containerHeight=C?Math.abs(f/C):f}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const w=this._container;w.classList.add("mapboxgl-map"),(this._missingCSSCanary=x("div","mapboxgl-canary",w)).style.visibility="hidden",this._detectMissingCSS();const f=this._canvasContainer=x("div","mapboxgl-canvas-container",w);this._canvas=x("canvas","mapboxgl-canvas",f),this._interactive&&(f.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const v=this._controlContainer=x("div","mapboxgl-control-container",w),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(C=>{S[C]=x("div",`mapboxgl-ctrl-${C}`,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,f){const v=o.f.devicePixelRatio||1;this._canvas.width=v*Math.ceil(w),this._canvas.height=v*Math.ceil(f),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${f}px`}_addMarker(w){this._markers.push(w)}_removeMarker(w){const f=this._markers.indexOf(w);f!==-1&&this._markers.splice(f,1)}_addPopup(w){this._popups.push(w)}_removePopup(w){const f=this._popups.indexOf(w);f!==-1&&this._popups.splice(f,1)}_setupPainter(){const w=o.e({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),f=this._canvas.getContext("webgl2",w);f?(o.dj(f,!0),this.painter=new Ow(f,this._contextCreateOptions,this.transform,this._tp),this.on("data",v=>{v.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.dk.testSupport(f)):this.fire(new o.a(new Error("Failed to initialize WebGL")))}_contextLost(w){w.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.b("webglcontextlost",{originalEvent:w}))}_contextRestored(w){this._setupPainter(),this.resize(),this._update(),this.fire(new o.b("webglcontextrestored",{originalEvent:w}))}_onMapScroll(w){if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_requestDomTask(w){!this.loaded()||this.loaded()&&!this.isMoving()?w():this._domRenderTaskQueue.add(w)}_render(w){let f;this.fire(new o.b("renderstart"));const v=this.painter.context.extTimerQuery,S=o.f.now(),C=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(f=C.createQuery(),C.beginQuery(v.TIME_ELAPSED_EXT,f)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(w),this._domRenderTaskQueue.run(w),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,j=this.transform.pitch,q=o.f.now(),K=new o.N(G,{now:q,fadeDuration:E,pitch:j,transition:this.style.transition});this.style.update(K)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let R=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),R=this._updateAverageElevation(S),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):R=this._updateAverageElevation(S),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.b("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.b("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),f){const G=o.f.now()-S;C.endQuery(v.TIME_ELAPSED_EXT),setTimeout(()=>{const j=C.getQueryParameter(f,C.QUERY_RESULT)/1e6;C.deleteQuery(f),this.fire(new o.b("gpu-timing-frame",{cpuTime:G,gpuTime:j}))},50)}if(this.listens("gpu-timing-layer")){const G=this.painter.collectGpuTimers();setTimeout(()=>{const j=this.painter.queryGpuTimers(G);this.fire(new o.b("gpu-timing-layer",{layerTimes:j}))},50)}if(this.listens("gpu-timing-deferred-render")){const G=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const j=this.painter.queryGpuTimeDeferredRender(G);this.fire(new o.b("gpu-timing-deferred-render",{gpuTime:j}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||R;if(B||this._repaint)this.triggerRepaint();else{const G=!this.isMoving()&&this.loaded();if(G&&(R=this._updateAverageElevation(S,!0)),R)this.triggerRepaint();else if(this._triggerFrame(!1),G&&(this.fire(new o.b("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const j=this._calculateSpeedIndex();this.fire(new o.b("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,this._performanceMetricsCollection&&o.dl(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(w){for(const f of this._markers)w&&!this.getRenderWorldCopies()&&(f._lngLat=f._lngLat.wrap()),f._update();for(const f of this._popups)!w||this.getRenderWorldCopies()||f._trackPointer||(f._lngLat=f._lngLat.wrap()),f._update()}_updateAverageElevation(w,f=!1){const v=C=>(this.transform.averageElevation=C,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&v(0);const S=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(S||(f||w-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(w)){const C=this.transform.averageElevation;let E=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=w;const R=Math.abs(C-E);if(R>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(E),v(E);this._averageElevation.easeTo(E,w,300)}else if(R>1e-4)return this._averageElevation.jumpTo(E),v(E)}return!!this._averageElevation.isEasing(w)&&v(this._averageElevation.getValue(w))}_authenticate(){o.dm(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,w=>{if(w&&(w.message===o.dn||w.status===401)){const f=this.painter.context.gl;o.dj(f,!1),this._logoControl instanceof Qw&&this._logoControl._updateLogo(),f&&f.clear(f.DEPTH_BUFFER_BIT|f.COLOR_BUFFER_BIT|f.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.a(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.dp(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&o.dq(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const w=this._isDragging();this.painter.updateTerrain(this.style,w)}_calculateSpeedIndex(){const w=this.painter.canvasCopy(),f=this.painter.getCanvasCopiesAndTimestamps();f.timeStamps.push(performance.now());const v=this.painter.context.gl,S=v.createFramebuffer();function C(E){v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,E,0);const R=new Uint8Array(v.drawingBufferWidth*v.drawingBufferHeight*4);return v.readPixels(0,0,v.drawingBufferWidth,v.drawingBufferHeight,v.RGBA,v.UNSIGNED_BYTE,R),R}return v.bindFramebuffer(v.FRAMEBUFFER,S),this._canvasPixelComparison(C(w),f.canvasCopies.map(C),f.timeStamps)}_canvasPixelComparison(w,f,v){let S=v[1]-v[0];const C=w.length/4;for(let E=0;E<f.length;E++){const R=f[E];let B=0;for(let G=0;G<R.length;G+=4)R[G]===w[G]&&R[G+1]===w[G+1]&&R[G+2]===w[G+2]&&R[G+3]===w[G+3]&&(B+=1);S+=(v[E+2]-v[E+1])*(1-B/C)}return S}remove(){this._hash&&this._hash.remove();for(const f of this._controls)f.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const w=this.painter.context.gl.getExtension("WEBGL_lose_context");w&&w.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.dr(this.painter.context.gl),o.ds.remove(),o.dt.remove(),this._removed=!0,this.fire(new o.b("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(w){this._renderNextFrame=this._renderNextFrame||w,this.style&&!this._frame&&(this._frame=o.f.frame(f=>{const v=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,v&&this._render(f)}))}_preloadTiles(w){const f=this.style?this.style.getSourceCaches():[];return o.b4(f,(v,S)=>v._preloadTiles(w,S),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(w){this._trackResize&&this.resize({originalEvent:w})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(w){this._showParseStatus!==w&&(this._showParseStatus=w,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(w){this._showTerrainWireframe!==w&&(this._showTerrainWireframe=w,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(w){this._showLayers2DWireframe!==w&&(this._showLayers2DWireframe=w,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(w){this._showLayers3DWireframe!==w&&(this._showLayers3DWireframe=w,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(w){this._speedIndexTiming!==w&&(this._speedIndexTiming=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,this._tp.refreshUI(),w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(w){this._showTileAABBs!==w&&(this._showTileAABBs=w,this._tp.refreshUI(),w&&this._update())}_setCacheLimits(w,f){o.dv(w,f)}get version(){return o.du}},NavigationControl:class{constructor(w){this.options=o.e({},Xh,w),this._container=x("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",f=>f.preventDefault()),this.options.showZoom&&(o.a$(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",f=>{this._map&&this._map.zoomIn({},{originalEvent:f})}),x("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",f=>{this._map&&this._map.zoomOut({},{originalEvent:f})}),x("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.a$(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",f=>{const v=this._map;v&&(this.options.visualizePitch?v.resetNorthPitch({},{originalEvent:f}):v.resetNorth({},{originalEvent:f}))}),this._compassIcon=x("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const w=this._map;if(!w)return;const f=w.getZoom(),v=f===w.getMaxZoom(),S=f===w.getMinZoom();this._zoomInButton.disabled=v,this._zoomOutButton.disabled=S,this._zoomInButton.setAttribute("aria-disabled",v.toString()),this._zoomOutButton.setAttribute("aria-disabled",S.toString())}_rotateCompassArrow(){const w=this._map;if(!w)return;const f=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(w.transform.pitch*(Math.PI/180)),.5)}) rotateX(${w.transform.pitch}deg) rotateZ(${w.transform.angle*(180/Math.PI)}deg)`:`rotate(${w.transform.angle*(180/Math.PI)}deg)`;w._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=f)})}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),w.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&w.on("pitch",this._rotateCompassArrow),w.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gm(w,this._compass,this.options.visualizePitch)),this._container}onRemove(){const w=this._map;w&&(this._container.remove(),this.options.showZoom&&w.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&w.off("pitch",this._rotateCompassArrow),w.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(w,f){const v=x("button",w,this._container);return v.type="button",v.addEventListener("click",f),v}_setButtonTitle(w,f){if(!this._map)return;const v=this._map._getUIString(`NavigationControl.${f}`);w.setAttribute("aria-label",v),w.firstElementChild&&w.firstElementChild.setAttribute("title",v)}},GeolocateControl:class extends o.E{constructor(w){super();const f=navigator.geolocation;this.options=o.e({geolocation:f},gr,w),o.a$(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=zw(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(w){return this._map=w,this._container=x("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(w){const f=(v=!!this.options.geolocation)=>{this._supportsGeolocation=v,w(v)};this._supportsGeolocation!==void 0?w(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(v=>f(v.state!=="denied")).catch(()=>f()):f()}_isOutOfMapMaxBounds(w){const f=this._map.getMaxBounds(),v=w.coords;return!!f&&(v.longitude<f.getWest()||v.longitude>f.getEast()||v.latitude<f.getSouth()||v.latitude>f.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(w){if(this._map){if(this._isOutOfMapMaxBounds(w))return this._setErrorState(),this.fire(new o.b("outofmaxbounds",w)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=w,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(w),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(w),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.b("geolocate",w)),this._finish()}}_updateCamera(w){const f=new o.bq(w.coords.longitude,w.coords.latitude),v=w.coords.accuracy,S=this._map.getBearing(),C=o.e({bearing:S},this.options.fitBoundsOptions);this._map.fitBounds(f.toBounds(v),C,{geolocateSource:!0})}_updateMarker(w){if(w){const f=new o.bq(w.coords.longitude,w.coords.latitude);this._accuracyCircleMarker.setLngLat(f).addTo(this._map),this._userLocationDotMarker.setLngLat(f).addTo(this._map),this._accuracy=w.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const w=this._map.transform,f=o.bo(1,w._center.lat)*w.worldSize,v=Math.ceil(2*this._accuracy*f);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(w){if(this._map){if(this.options.trackUserLocation)if(w.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(w.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.b("error",w)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(w){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",f=>f.preventDefault()),this._geolocateButton=x("button","mapboxgl-ctrl-geolocate",this._container),x("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",w===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f)}else{const f=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",f),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=x("div","mapboxgl-user-location"),this._dotElement.appendChild(x("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(x("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new fp({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=x("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new fp({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",f=>{f.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f.originalEvent&&f.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.b("trackuserlocationend")))})}}_onDeviceOrientation(w){this._userLocationDotMarker&&(w.webkitCompassHeading?this._heading=w.webkitCompassHeading:w.absolute===!0&&(this._heading=-1*w.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.b("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.b("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.b("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(w={maximumAge:6e5,timeout:0},this._noTimeout=!0):(w=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,w),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const w=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(f=>{f==="granted"&&w()}).catch(console.error):w()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:w0,ScaleControl:class{constructor(w){this.options=o.e({},eS,w),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.a$(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const w=this.options.maxWidth||100,f=this._map,v=f._containerHeight/2,S=f._containerWidth/2-w/2,C=f.unproject([S,v]),E=f.unproject([S+w,v]),R=C.distanceTo(E);if(this.options.unit==="imperial"){const B=3.2808*R;B>5280?this._setScale(w,B/5280,"mile"):this._setScale(w,B,"foot")}else this.options.unit==="nautical"?this._setScale(w,R/1852,"nautical-mile"):R>=1e3?this._setScale(w,R/1e3,"kilometer"):this._setScale(w,R,"meter")}_setScale(w,f,v){this._map._requestDomTask(()=>{const S=function(E){const R=Math.pow(10,`${Math.floor(E)}`.length-1);let B=E/R;return B=B>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(G){const j=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*j)/j}(B),R*B}(f),C=S/f;this._container.innerHTML=this._isNumberFormatSupported&&v!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:v}).format(S):`${S}&nbsp;${tS[v]}`,this._container.style.width=w*C+"px"})}onAdd(w){return this._map=w,this._language=w.getLanguage(),this._container=x("div","mapboxgl-ctrl mapboxgl-ctrl-scale",w.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(w){this._language=w,this._update()}setUnit(w){this.options.unit=w,this._update()}},FullscreenControl:class{constructor(w){this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:o.w("Full screen control 'container' must be a DOM element.")),o.a$(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=x("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const w=this._fullscreenButton=x("button","mapboxgl-ctrl-fullscreen",this._controlContainer);x("span","mapboxgl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",w)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(w){super(),this.options=o.e(Object.create(dp),w),o.a$(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(w&&w.className?w.className.trim().split(/\s+/):[])}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&w.on("preclick",this._onClose),this.options.closeOnMove&&w.on("move",this._onClose),w.on("remove",this.remove),this._update(),w._addPopup(this),this._focusFirstElement(),this._trackPointer?(w.on("mousemove",this._onMouseEvent),w.on("mouseup",this._onMouseEvent),w._canvasContainer.classList.add("mapboxgl-track-pointer")):w.on("move",this._update),this.fire(new o.b("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const w=this._map;return w&&(w.off("move",this._update),w.off("move",this._onClose),w.off("preclick",this._onClose),w.off("click",this._onClose),w.off("remove",this.remove),w.off("mousemove",this._onMouseEvent),w.off("mouseup",this._onMouseEvent),w.off("drag",this._onMouseEvent),w._canvasContainer&&w._canvasContainer.classList.remove("mapboxgl-track-pointer"),w._removePopup(this),this._map=void 0),this.fire(new o.b("close")),this}getLngLat(){return this._lngLat}setLngLat(w){this._lngLat=o.bq.convert(w),this._pos=null,this._trackPointer=!1,this._update();const f=this._map;return f&&(f.on("move",this._update),f.off("mousemove",this._onMouseEvent),f._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const w=this._map;return w&&(w.off("move",this._update),w.on("mousemove",this._onMouseEvent),w.on("drag",this._onMouseEvent),w._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const f=document.createDocumentFragment(),v=document.createElement("body");let S;for(v.innerHTML=w;S=v.firstChild,S;)f.appendChild(S);return this.setDOMContent(f)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){let f=this._content;if(f)for(;f.hasChildNodes();)f.firstChild&&f.removeChild(f.firstChild);else f=this._content=x("div","mapboxgl-popup-content",this._container||void 0);if(f.appendChild(w),this.options.closeButton){const v=this._closeButton=x("button","mapboxgl-popup-close-button",f);v.type="button",v.setAttribute("aria-label","Close popup"),v.setAttribute("aria-hidden","true"),v.innerHTML="&#215;",v.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(w){return this._classList.add(w),this._updateClassList(),this}removeClassName(w){return this._classList.delete(w),this._updateClassList(),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){let f;return this._classList.delete(w)?f=!1:(this._classList.add(w),f=!0),this._updateClassList(),f}_onMouseEvent(w){this._update(w.point)}_getAnchor(w){if(this.options.anchor)return this.options.anchor;const f=this._map,v=this._container,S=this._pos;if(!f||!v||!S)return"bottom";const C=v.offsetWidth,E=v.offsetHeight,R=S.x<C/2,B=S.x>f.transform.width-C/2;if(S.y+w<E)return R?"top-left":B?"top-right":"top";if(S.y>f.transform.height-E){if(R)return"bottom-left";if(B)return"bottom-right"}return R?"left":B?"right":"bottom"}_updateClassList(){const w=this._container;if(!w)return;const f=[...this._classList];f.push("mapboxgl-popup"),this._anchor&&f.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&f.push("mapboxgl-popup-track-pointer"),w.className=f.join(" ")}_update(w){const f=this._map,v=this._content;if(!f||!this._lngLat&&!this._trackPointer||!v)return;let S=this._container;if(S||(S=this._container=x("div","mapboxgl-popup",f.getContainer()),this._tip=x("div","mapboxgl-popup-tip",S),S.appendChild(v)),this.options.maxWidth&&S.style.maxWidth!==this.options.maxWidth&&(S.style.maxWidth=this.options.maxWidth),f.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=dm(this._lngLat,this._pos,f.transform)),!this._trackPointer||w){const C=this._pos=this._trackPointer&&w?w:f.project(this._lngLat),E=pp(this.options.offset),R=this._anchor=this._getAnchor(E.y),B=pp(this.options.offset,R),G=C.add(B).round();f._requestDomTask(()=>{this._container&&R&&(this._container.style.transform=`${Yh[R]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&f._showingGlobe()){const C=o.de(f.transform,this._lngLat)?0:1;this._setOpacity(C)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Kw);w&&w.focus()}_onClose(){this.remove()}_setOpacity(w){this._container&&(this._container.style.opacity=`${w}`),this._content&&(this._content.style.pointerEvents=w?"auto":"none")}},Marker:fp,Style:zs,LngLat:o.bq,LngLatBounds:o.ag,Point:o.P,MercatorCoordinate:o.O,FreeCameraOptions:kh,Evented:o.E,config:o.dd,prewarm:o.dy,clearPrewarmedResources:o.dz,get accessToken(){return o.dd.ACCESS_TOKEN},set accessToken(w){o.dd.ACCESS_TOKEN=w},get baseApiUrl(){return o.dd.API_URL},set baseApiUrl(w){o.dd.API_URL=w},get workerCount(){return o.dA.workerCount},set workerCount(w){o.dA.workerCount=w},get maxParallelImageRequests(){return o.dd.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(w){o.dd.MAX_PARALLEL_IMAGE_REQUESTS=w},clearStorage(w){o.dB(w)},get workerUrl(){return o.dC.workerUrl},set workerUrl(w){o.dC.workerUrl=w},get workerClass(){return o.dC.workerClass},set workerClass(w){o.dC.workerClass=w},get workerParams(){return o.dC.workerParams},set workerParams(w){o.dC.workerParams=w},get dracoUrl(){return o.dD()},set dracoUrl(w){o.dE(w)},get meshoptUrl(){return o.dF()},set meshoptUrl(w){o.dG(w)},setNow:o.f.setNow,restoreNow:o.f.restoreNow}});var c=a;return c})})(Wq);var $ye=Wq.exports;const kA=eve($ye),qq=""+new URL("arsenal-DF5VtIQv.png",import.meta.url).href,Yq=""+new URL("astonvilla-CyBZixO_.png",import.meta.url).href,Xq=""+new URL("bournemouth-D_NWOTIE.png",import.meta.url).href,Qq=""+new URL("Brentford-DSaz31WK.png",import.meta.url).href,Kq=""+new URL("Brighton-C49fb6pC.png",import.meta.url).href,Jq=""+new URL("burnley-ezNGKQ73.png",import.meta.url).href,e2=""+new URL("chelsea-BDyIJ4uC.png",import.meta.url).href,t2=""+new URL("crystalpalace-Cyq-EGZa.png",import.meta.url).href,r2=""+new URL("everton-B9xV_HT-.png",import.meta.url).href,n2=""+new URL("fulham-CZccCsMD.png",import.meta.url).href,i2=""+new URL("liverpool-CuDT7xdk.png",import.meta.url).href,a2=""+new URL("luton-BlHwSO08.png",import.meta.url).href,o2=""+new URL("mancity-D8FQMnrq.png",import.meta.url).href,s2=""+new URL("manunited-BBbkumwk.png",import.meta.url).href,l2=""+new URL("newcastle-CB4bYsRR.png",import.meta.url).href,u2=""+new URL("nottingham-BWreLSyP.png",import.meta.url).href,c2=""+new URL("sheffield-Dh_Sf1eF.png",import.meta.url).href,h2=""+new URL("hotspur-Dhky2C21.png",import.meta.url).href,f2=""+new URL("westham-DA_nankW.png",import.meta.url).href,d2=""+new URL("wolve-DQLGIdf7.png",import.meta.url).href,gz=Y7("mapStore",()=>{const t=at(null);return{map:t,initializeMap:(a,l=[-1.1743,52.9],c=6)=>{t.value=new kA.Map({container:a,style:"mapbox://styles/mapbox/streets-v12",center:l,zoom:c})},addMarkers:a=>{a.forEach(l=>{const c=document.createElement("div");c.className="marker",c.style.backgroundImage=`url(${l.logo})`,c.style.width="50px",c.style.height="50px",c.style.backgroundSize="cover",c.style.borderRadius="50%",new kA.Marker(c).setLngLat(l.coords).setPopup(new kA.Popup({offset:25}).setText(l.name)).addTo(t.value)})},flyToStadium:a=>{t.value&&t.value.flyTo({center:a,zoom:16,essential:!0})},flyToOverview:()=>{t.value&&t.value.flyTo({center:[-1.1743,52.9],zoom:6,essential:!0})}}}),na=(t,e)=>{const r=t.__vccOpts||t;for(const[n,i]of e)r[n]=i;return r},Hye={__name:"Mapbox",setup(t){kA.accessToken="pk.eyJ1IjoiamltaW5qaSIsImEiOiJjbHhscXI1N2IwMHFkMmhzZHdxMTg4ODQyIn0.aLsuiW6bBO37JH-ZYtZHwg";const e=at(null),r=[{name:"Emirates Stadium",coords:[-.108611,51.555],logo:qq},{name:"Villa Park",coords:[-1.884722,52.509167],logo:Yq},{name:"Vitality Stadium",coords:[-1.8386,50.7353],logo:Xq},{name:"Brentford Community Stadium",coords:[-.289048,51.490715],logo:Qq},{name:"American Express Community Stadium",coords:[-.083278,50.861822],logo:Kq},{name:"Turf Moor",coords:[-2.230278,53.789167],logo:Jq},{name:"Stamford Bridge",coords:[-.191111,51.481667],logo:e2},{name:"Selhurst Park",coords:[-.085556,51.398333],logo:t2},{name:"Goodison Park",coords:[-2.966389,53.438889],logo:r2},{name:"Craven Cottage",coords:[-.221667,51.475],logo:n2},{name:"Anfield",coords:[-2.96,53.430819],logo:i2},{name:"Kenilworth Road",coords:[-.430573,51.883479],logo:a2},{name:"Etihad Stadium",coords:[-2.200292,53.482989],logo:o2},{name:"Old Trafford",coords:[-2.291389,53.463056],logo:s2},{name:"St James Park",coords:[-1.621667,54.975],logo:l2},{name:"City Ground",coords:[-1.132778,52.94],logo:u2},{name:"Bramall Lane",coords:[-1.469697,53.370348],logo:c2},{name:"Tottenham Hotspur Stadium",coords:[-.067007,51.604252],logo:h2},{name:"London Stadium",coords:[-.017136,51.538811],logo:f2},{name:"Molineux Stadium",coords:[-2.130278,52.590278],logo:d2}],n=gz();return Vn(()=>{n.initializeMap(e.value),n.addMarkers(r)}),Td(()=>{n.map&&n.map.remove()}),(i,a)=>(Nt(),Gr("div",{ref_key:"mapContainer",ref:e,class:"map-container"},null,512))}},jye=na(Hye,[["__scopeId","data-v-79d40e3e"]]),Wye=""+new URL("pl-main-logo-futb1LAZ.png",import.meta.url).href;var Zye={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(r,n){t.exports=n()})(uq,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,l={},c=0,o={parse:function(W,Y){var J=(Y=Y||{}).dynamicTyping||!1;if(X(J)&&(Y.dynamicTypingFunction=J,J={}),Y.dynamicTyping=J,Y.transform=!!X(Y.transform)&&Y.transform,Y.worker&&o.WORKERS_SUPPORTED){var re=function(){if(!o.WORKERS_SUPPORTED)return!1;var pe=(ve=n.URL||n.webkitURL||null,me=r.toString(),o.BLOB_URL||(o.BLOB_URL=ve.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",me,")();"],{type:"text/javascript"})))),de=new n.Worker(pe),ve,me;return de.onmessage=O,de.id=c++,l[de.id]=de}();return re.userStep=Y.step,re.userChunk=Y.chunk,re.userComplete=Y.complete,re.userError=Y.error,Y.step=X(Y.step),Y.chunk=X(Y.chunk),Y.complete=X(Y.complete),Y.error=X(Y.error),delete Y.worker,void re.postMessage({input:W,config:Y,workerId:re.id})}var ae=null;return o.NODE_STREAM_INPUT,typeof W=="string"?(W=function(pe){return pe.charCodeAt(0)===65279?pe.slice(1):pe}(W),ae=Y.download?new m(Y):new x(Y)):W.readable===!0&&X(W.read)&&X(W.on)?ae=new A(Y):(n.File&&W instanceof File||W instanceof Object)&&(ae=new y(Y)),ae.stream(W)},unparse:function(W,Y){var J=!1,re=!0,ae=",",pe=`\r
`,de='"',ve=de+de,me=!1,Ie=null,Le=!1;(function(){if(typeof Y=="object"){if(typeof Y.delimiter!="string"||o.BAD_DELIMITERS.filter(function(We){return Y.delimiter.indexOf(We)!==-1}).length||(ae=Y.delimiter),(typeof Y.quotes=="boolean"||typeof Y.quotes=="function"||Array.isArray(Y.quotes))&&(J=Y.quotes),typeof Y.skipEmptyLines!="boolean"&&typeof Y.skipEmptyLines!="string"||(me=Y.skipEmptyLines),typeof Y.newline=="string"&&(pe=Y.newline),typeof Y.quoteChar=="string"&&(de=Y.quoteChar),typeof Y.header=="boolean"&&(re=Y.header),Array.isArray(Y.columns)){if(Y.columns.length===0)throw new Error("Option columns is empty");Ie=Y.columns}Y.escapeChar!==void 0&&(ve=Y.escapeChar+de),(typeof Y.escapeFormulae=="boolean"||Y.escapeFormulae instanceof RegExp)&&(Le=Y.escapeFormulae instanceof RegExp?Y.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Ee=new RegExp(D(de),"g");if(typeof W=="string"&&(W=JSON.parse(W)),Array.isArray(W)){if(!W.length||Array.isArray(W[0]))return Ue(null,W,me);if(typeof W[0]=="object")return Ue(Ie||Object.keys(W[0]),W,me)}else if(typeof W=="object")return typeof W.data=="string"&&(W.data=JSON.parse(W.data)),Array.isArray(W.data)&&(W.fields||(W.fields=W.meta&&W.meta.fields||Ie),W.fields||(W.fields=Array.isArray(W.data[0])?W.fields:typeof W.data[0]=="object"?Object.keys(W.data[0]):[]),Array.isArray(W.data[0])||typeof W.data[0]=="object"||(W.data=[W.data])),Ue(W.fields||[],W.data||[],me);throw new Error("Unable to serialize unrecognized input");function Ue(We,Rt,Et){var ar="";typeof We=="string"&&(We=JSON.parse(We)),typeof Rt=="string"&&(Rt=JSON.parse(Rt));var ur=Array.isArray(We)&&0<We.length,cr=!Array.isArray(Rt[0]);if(ur&&re){for(var lt=0;lt<We.length;lt++)0<lt&&(ar+=ae),ar+=Ke(We[lt],lt);0<Rt.length&&(ar+=pe)}for(var qt=0;qt<Rt.length;qt++){var Ut=ur?We.length:Rt[qt].length,rr=!1,br=ur?Object.keys(Rt[qt]).length===0:Rt[qt].length===0;if(Et&&!ur&&(rr=Et==="greedy"?Rt[qt].join("").trim()==="":Rt[qt].length===1&&Rt[qt][0].length===0),Et==="greedy"&&ur){for(var Oe=[],$e=0;$e<Ut;$e++){var ct=cr?We[$e]:$e;Oe.push(Rt[qt][ct])}rr=Oe.join("").trim()===""}if(!rr){for(var bt=0;bt<Ut;bt++){0<bt&&!br&&(ar+=ae);var At=ur&&cr?We[bt]:bt;ar+=Ke(Rt[qt][At],bt)}qt<Rt.length-1&&(!Et||0<Ut&&!br)&&(ar+=pe)}}return ar}function Ke(We,Rt){if(We==null)return"";if(We.constructor===Date)return JSON.stringify(We).slice(1,25);var Et=!1;Le&&typeof We=="string"&&Le.test(We)&&(We="'"+We,Et=!0);var ar=We.toString().replace(Ee,ve);return(Et=Et||J===!0||typeof J=="function"&&J(We,Rt)||Array.isArray(J)&&J[Rt]||function(ur,cr){for(var lt=0;lt<cr.length;lt++)if(-1<ur.indexOf(cr[lt]))return!0;return!1}(ar,o.BAD_DELIMITERS)||-1<ar.indexOf(ae)||ar.charAt(0)===" "||ar.charAt(ar.length-1)===" ")?de+ar+de:ar}}};if(o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!i&&!!n.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=P,o.ParserHandle=M,o.NetworkStreamer=m,o.FileStreamer=y,o.StringStreamer=x,o.ReadableStreamStreamer=A,n.jQuery){var d=n.jQuery;d.fn.parse=function(W){var Y=W.config||{},J=[];return this.each(function(pe){if(!(d(this).prop("tagName").toUpperCase()==="INPUT"&&d(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var de=0;de<this.files.length;de++)J.push({file:this.files[de],inputElem:this,instanceConfig:d.extend({},Y)})}),re(),this;function re(){if(J.length!==0){var pe,de,ve,me,Ie=J[0];if(X(W.before)){var Le=W.before(Ie.file,Ie.inputElem);if(typeof Le=="object"){if(Le.action==="abort")return pe="AbortError",de=Ie.file,ve=Ie.inputElem,me=Le.reason,void(X(W.error)&&W.error({name:pe},de,ve,me));if(Le.action==="skip")return void ae();typeof Le.config=="object"&&(Ie.instanceConfig=d.extend(Ie.instanceConfig,Le.config))}else if(Le==="skip")return void ae()}var Ee=Ie.instanceConfig.complete;Ie.instanceConfig.complete=function(Ue){X(Ee)&&Ee(Ue,Ie.file,Ie.inputElem),ae()},o.parse(Ie.file,Ie.instanceConfig)}else X(W.complete)&&W.complete()}function ae(){J.splice(0,1),re()}}}function g(W){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(Y){var J=H(Y);J.chunkSize=parseInt(J.chunkSize),Y.step||Y.chunk||(J.chunkSize=null),this._handle=new M(J),(this._handle.streamer=this)._config=J}).call(this,W),this.parseChunk=function(Y,J){if(this.isFirstChunk&&X(this._config.beforeFirstChunk)){var re=this._config.beforeFirstChunk(Y);re!==void 0&&(Y=re)}this.isFirstChunk=!1,this._halted=!1;var ae=this._partialLine+Y;this._partialLine="";var pe=this._handle.parse(ae,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var de=pe.meta.cursor;this._finished||(this._partialLine=ae.substring(de-this._baseIndex),this._baseIndex=de),pe&&pe.data&&(this._rowCount+=pe.data.length);var ve=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(a)n.postMessage({results:pe,workerId:o.WORKER_ID,finished:ve});else if(X(this._config.chunk)&&!J){if(this._config.chunk(pe,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);pe=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(pe.data),this._completeResults.errors=this._completeResults.errors.concat(pe.errors),this._completeResults.meta=pe.meta),this._completed||!ve||!X(this._config.complete)||pe&&pe.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),ve||pe&&pe.meta.paused||this._nextChunk(),pe}this._halted=!0},this._sendError=function(Y){X(this._config.error)?this._config.error(Y):a&&this._config.error&&n.postMessage({workerId:o.WORKER_ID,error:Y,finished:!1})}}function m(W){var Y;(W=W||{}).chunkSize||(W.chunkSize=o.RemoteChunkSize),g.call(this,W),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(J){this._input=J,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(Y=new XMLHttpRequest,this._config.withCredentials&&(Y.withCredentials=this._config.withCredentials),i||(Y.onload=$(this._chunkLoaded,this),Y.onerror=$(this._chunkError,this)),Y.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var J=this._config.downloadRequestHeaders;for(var re in J)Y.setRequestHeader(re,J[re])}if(this._config.chunkSize){var ae=this._start+this._config.chunkSize-1;Y.setRequestHeader("Range","bytes="+this._start+"-"+ae)}try{Y.send(this._config.downloadRequestBody)}catch(pe){this._chunkError(pe.message)}i&&Y.status===0&&this._chunkError()}},this._chunkLoaded=function(){Y.readyState===4&&(Y.status<200||400<=Y.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:Y.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(J){var re=J.getResponseHeader("Content-Range");return re===null?-1:parseInt(re.substring(re.lastIndexOf("/")+1))}(Y),this.parseChunk(Y.responseText)))},this._chunkError=function(J){var re=Y.statusText||J;this._sendError(new Error(re))}}function y(W){var Y,J;(W=W||{}).chunkSize||(W.chunkSize=o.LocalChunkSize),g.call(this,W);var re=typeof FileReader<"u";this.stream=function(ae){this._input=ae,J=ae.slice||ae.webkitSlice||ae.mozSlice,re?((Y=new FileReader).onload=$(this._chunkLoaded,this),Y.onerror=$(this._chunkError,this)):Y=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var ae=this._input;if(this._config.chunkSize){var pe=Math.min(this._start+this._config.chunkSize,this._input.size);ae=J.call(ae,this._start,pe)}var de=Y.readAsText(ae,this._config.encoding);re||this._chunkLoaded({target:{result:de}})},this._chunkLoaded=function(ae){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(ae.target.result)},this._chunkError=function(){this._sendError(Y.error)}}function x(W){var Y;g.call(this,W=W||{}),this.stream=function(J){return Y=J,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var J,re=this._config.chunkSize;return re?(J=Y.substring(0,re),Y=Y.substring(re)):(J=Y,Y=""),this._finished=!Y,this.parseChunk(J)}}}function A(W){g.call(this,W=W||{});var Y=[],J=!0,re=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(ae){this._input=ae,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){re&&Y.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),Y.length?this.parseChunk(Y.shift()):J=!0},this._streamData=$(function(ae){try{Y.push(typeof ae=="string"?ae:ae.toString(this._config.encoding)),J&&(J=!1,this._checkIsFinished(),this.parseChunk(Y.shift()))}catch(pe){this._streamError(pe)}},this),this._streamError=$(function(ae){this._streamCleanUp(),this._sendError(ae)},this),this._streamEnd=$(function(){this._streamCleanUp(),re=!0,this._streamData("")},this),this._streamCleanUp=$(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function M(W){var Y,J,re,ae=Math.pow(2,53),pe=-ae,de=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ve=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,me=this,Ie=0,Le=0,Ee=!1,Ue=!1,Ke=[],We={data:[],errors:[],meta:{}};if(X(W.step)){var Rt=W.step;W.step=function(qt){if(We=qt,ur())ar();else{if(ar(),We.data.length===0)return;Ie+=qt.data.length,W.preview&&Ie>W.preview?J.abort():(We.data=We.data[0],Rt(We,me))}}}function Et(qt){return W.skipEmptyLines==="greedy"?qt.join("").trim()==="":qt.length===1&&qt[0].length===0}function ar(){return We&&re&&(lt("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),re=!1),W.skipEmptyLines&&(We.data=We.data.filter(function(qt){return!Et(qt)})),ur()&&function(){if(!We)return;function qt(rr,br){X(W.transformHeader)&&(rr=W.transformHeader(rr,br)),Ke.push(rr)}if(Array.isArray(We.data[0])){for(var Ut=0;ur()&&Ut<We.data.length;Ut++)We.data[Ut].forEach(qt);We.data.splice(0,1)}else We.data.forEach(qt)}(),function(){if(!We||!W.header&&!W.dynamicTyping&&!W.transform)return We;function qt(rr,br){var Oe,$e=W.header?{}:[];for(Oe=0;Oe<rr.length;Oe++){var ct=Oe,bt=rr[Oe];W.header&&(ct=Oe>=Ke.length?"__parsed_extra":Ke[Oe]),W.transform&&(bt=W.transform(bt,ct)),bt=cr(ct,bt),ct==="__parsed_extra"?($e[ct]=$e[ct]||[],$e[ct].push(bt)):$e[ct]=bt}return W.header&&(Oe>Ke.length?lt("FieldMismatch","TooManyFields","Too many fields: expected "+Ke.length+" fields but parsed "+Oe,Le+br):Oe<Ke.length&&lt("FieldMismatch","TooFewFields","Too few fields: expected "+Ke.length+" fields but parsed "+Oe,Le+br)),$e}var Ut=1;return!We.data.length||Array.isArray(We.data[0])?(We.data=We.data.map(qt),Ut=We.data.length):We.data=qt(We.data,0),W.header&&We.meta&&(We.meta.fields=Ke),Le+=Ut,We}()}function ur(){return W.header&&Ke.length===0}function cr(qt,Ut){return rr=qt,W.dynamicTypingFunction&&W.dynamicTyping[rr]===void 0&&(W.dynamicTyping[rr]=W.dynamicTypingFunction(rr)),(W.dynamicTyping[rr]||W.dynamicTyping)===!0?Ut==="true"||Ut==="TRUE"||Ut!=="false"&&Ut!=="FALSE"&&(function(br){if(de.test(br)){var Oe=parseFloat(br);if(pe<Oe&&Oe<ae)return!0}return!1}(Ut)?parseFloat(Ut):ve.test(Ut)?new Date(Ut):Ut===""?null:Ut):Ut;var rr}function lt(qt,Ut,rr,br){var Oe={type:qt,code:Ut,message:rr};br!==void 0&&(Oe.row=br),We.errors.push(Oe)}this.parse=function(qt,Ut,rr){var br=W.quoteChar||'"';if(W.newline||(W.newline=function(ct,bt){ct=ct.substring(0,1048576);var At=new RegExp(D(bt)+"([^]*?)"+D(bt),"gm"),Jt=(ct=ct.replace(At,"")).split("\r"),mt=ct.split(`
`),ht=1<mt.length&&mt[0].length<Jt[0].length;if(Jt.length===1||ht)return`
`;for(var er=0,Bt=0;Bt<Jt.length;Bt++)Jt[Bt][0]===`
`&&er++;return er>=Jt.length/2?`\r
`:"\r"}(qt,br)),re=!1,W.delimiter)X(W.delimiter)&&(W.delimiter=W.delimiter(qt),We.meta.delimiter=W.delimiter);else{var Oe=function(ct,bt,At,Jt,mt){var ht,er,Bt,qe;mt=mt||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var ge=0;ge<mt.length;ge++){var be=mt[ge],ke=0,tt=0,ut=0;Bt=void 0;for(var St=new P({comments:Jt,delimiter:be,newline:bt,preview:10}).parse(ct),vt=0;vt<St.data.length;vt++)if(At&&Et(St.data[vt]))ut++;else{var Ye=St.data[vt].length;tt+=Ye,Bt!==void 0?0<Ye&&(ke+=Math.abs(Ye-Bt),Bt=Ye):Bt=Ye}0<St.data.length&&(tt/=St.data.length-ut),(er===void 0||ke<=er)&&(qe===void 0||qe<tt)&&1.99<tt&&(er=ke,ht=be,qe=tt)}return{successful:!!(W.delimiter=ht),bestDelimiter:ht}}(qt,W.newline,W.skipEmptyLines,W.comments,W.delimitersToGuess);Oe.successful?W.delimiter=Oe.bestDelimiter:(re=!0,W.delimiter=o.DefaultDelimiter),We.meta.delimiter=W.delimiter}var $e=H(W);return W.preview&&W.header&&$e.preview++,Y=qt,J=new P($e),We=J.parse(Y,Ut,rr),ar(),Ee?{meta:{paused:!0}}:We||{meta:{paused:!1}}},this.paused=function(){return Ee},this.pause=function(){Ee=!0,J.abort(),Y=X(W.chunk)?"":Y.substring(J.getCharIndex())},this.resume=function(){me.streamer._halted?(Ee=!1,me.streamer.parseChunk(Y,!0)):setTimeout(me.resume,3)},this.aborted=function(){return Ue},this.abort=function(){Ue=!0,J.abort(),We.meta.aborted=!0,X(W.complete)&&W.complete(We),Y=""}}function D(W){return W.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function P(W){var Y,J=(W=W||{}).delimiter,re=W.newline,ae=W.comments,pe=W.step,de=W.preview,ve=W.fastMode,me=Y=W.quoteChar===void 0||W.quoteChar===null?'"':W.quoteChar;if(W.escapeChar!==void 0&&(me=W.escapeChar),(typeof J!="string"||-1<o.BAD_DELIMITERS.indexOf(J))&&(J=","),ae===J)throw new Error("Comment character same as delimiter");ae===!0?ae="#":(typeof ae!="string"||-1<o.BAD_DELIMITERS.indexOf(ae))&&(ae=!1),re!==`
`&&re!=="\r"&&re!==`\r
`&&(re=`
`);var Ie=0,Le=!1;this.parse=function(Ee,Ue,Ke){if(typeof Ee!="string")throw new Error("Input must be a string");var We=Ee.length,Rt=J.length,Et=re.length,ar=ae.length,ur=X(pe),cr=[],lt=[],qt=[],Ut=Ie=0;if(!Ee)return Dt();if(W.header&&!Ue){var rr=Ee.split(re)[0].split(J),br=[],Oe={},$e=!1;for(var ct in rr){var bt=rr[ct];X(W.transformHeader)&&(bt=W.transformHeader(bt,ct));var At=bt,Jt=Oe[bt]||0;for(0<Jt&&($e=!0,At=bt+"_"+Jt),Oe[bt]=Jt+1;br.includes(At);)At=At+"_"+Jt;br.push(At)}if($e){var mt=Ee.split(re);mt[0]=br.join(J),Ee=mt.join(re)}}if(ve||ve!==!1&&Ee.indexOf(Y)===-1){for(var ht=Ee.split(re),er=0;er<ht.length;er++){if(qt=ht[er],Ie+=qt.length,er!==ht.length-1)Ie+=re.length;else if(Ke)return Dt();if(!ae||qt.substring(0,ar)!==ae){if(ur){if(cr=[],ut(qt.split(J)),Vt(),Le)return Dt()}else ut(qt.split(J));if(de&&de<=er)return cr=cr.slice(0,de),Dt(!0)}}return Dt()}for(var Bt=Ee.indexOf(J,Ie),qe=Ee.indexOf(re,Ie),ge=new RegExp(D(me)+D(Y),"g"),be=Ee.indexOf(Y,Ie);;)if(Ee[Ie]!==Y)if(ae&&qt.length===0&&Ee.substring(Ie,Ie+ar)===ae){if(qe===-1)return Dt();Ie=qe+Et,qe=Ee.indexOf(re,Ie),Bt=Ee.indexOf(J,Ie)}else if(Bt!==-1&&(Bt<qe||qe===-1))qt.push(Ee.substring(Ie,Bt)),Ie=Bt+Rt,Bt=Ee.indexOf(J,Ie);else{if(qe===-1)break;if(qt.push(Ee.substring(Ie,qe)),Ye(qe+Et),ur&&(Vt(),Le))return Dt();if(de&&cr.length>=de)return Dt(!0)}else for(be=Ie,Ie++;;){if((be=Ee.indexOf(Y,be+1))===-1)return Ke||lt.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:cr.length,index:Ie}),vt();if(be===We-1)return vt(Ee.substring(Ie,be).replace(ge,Y));if(Y!==me||Ee[be+1]!==me){if(Y===me||be===0||Ee[be-1]!==me){Bt!==-1&&Bt<be+1&&(Bt=Ee.indexOf(J,be+1)),qe!==-1&&qe<be+1&&(qe=Ee.indexOf(re,be+1));var ke=St(qe===-1?Bt:Math.min(Bt,qe));if(Ee.substr(be+1+ke,Rt)===J){qt.push(Ee.substring(Ie,be).replace(ge,Y)),Ee[Ie=be+1+ke+Rt]!==Y&&(be=Ee.indexOf(Y,Ie)),Bt=Ee.indexOf(J,Ie),qe=Ee.indexOf(re,Ie);break}var tt=St(qe);if(Ee.substring(be+1+tt,be+1+tt+Et)===re){if(qt.push(Ee.substring(Ie,be).replace(ge,Y)),Ye(be+1+tt+Et),Bt=Ee.indexOf(J,Ie),be=Ee.indexOf(Y,Ie),ur&&(Vt(),Le))return Dt();if(de&&cr.length>=de)return Dt(!0);break}lt.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:cr.length,index:Ie}),be++}}else be++}return vt();function ut(jt){cr.push(jt),Ut=Ie}function St(jt){var Yt=0;if(jt!==-1){var Nr=Ee.substring(be+1,jt);Nr&&Nr.trim()===""&&(Yt=Nr.length)}return Yt}function vt(jt){return Ke||(jt===void 0&&(jt=Ee.substring(Ie)),qt.push(jt),Ie=We,ut(qt),ur&&Vt()),Dt()}function Ye(jt){Ie=jt,ut(qt),qt=[],qe=Ee.indexOf(re,Ie)}function Dt(jt){return{data:cr,errors:lt,meta:{delimiter:J,linebreak:re,aborted:Le,truncated:!!jt,cursor:Ut+(Ue||0)}}}function Vt(){pe(Dt()),cr=[],lt=[]}},this.abort=function(){Le=!0},this.getCharIndex=function(){return Ie}}function O(W){var Y=W.data,J=l[Y.workerId],re=!1;if(Y.error)J.userError(Y.error,Y.file);else if(Y.results&&Y.results.data){var ae={abort:function(){re=!0,z(Y.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:V,resume:V};if(X(J.userStep)){for(var pe=0;pe<Y.results.data.length&&(J.userStep({data:Y.results.data[pe],errors:Y.results.errors,meta:Y.results.meta},ae),!re);pe++);delete Y.results}else X(J.userChunk)&&(J.userChunk(Y.results,ae,Y.file),delete Y.results)}Y.finished&&!re&&z(Y.workerId,Y.results)}function z(W,Y){var J=l[W];X(J.userComplete)&&J.userComplete(Y),J.terminate(),delete l[W]}function V(){throw new Error("Not implemented.")}function H(W){if(typeof W!="object"||W===null)return W;var Y=Array.isArray(W)?[]:{};for(var J in W)Y[J]=H(W[J]);return Y}function $(W,Y){return function(){W.apply(Y,arguments)}}function X(W){return typeof W=="function"}return a&&(n.onmessage=function(W){var Y=W.data;if(o.WORKER_ID===void 0&&Y&&(o.WORKER_ID=Y.workerId),typeof Y.input=="string")n.postMessage({workerId:o.WORKER_ID,results:o.parse(Y.input,Y.config),finished:!0});else if(n.File&&Y.input instanceof File||Y.input instanceof Object){var J=o.parse(Y.input,Y.config);J&&n.postMessage({workerId:o.WORKER_ID,results:J,finished:!0})}}),(m.prototype=Object.create(g.prototype)).constructor=m,(y.prototype=Object.create(g.prototype)).constructor=y,(x.prototype=Object.create(x.prototype)).constructor=x,(A.prototype=Object.create(g.prototype)).constructor=A,o})})(Zye);const Ta=Y7("eplstate",()=>({selectedClub:at(null)}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var mk=function(t,e){return mk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},mk(t,e)};function et(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var qye=function(){function t(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return t}(),Yye=function(){function t(){this.browser=new qye,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return t}(),Nn=new Yye;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(Nn.wxa=!0,Nn.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?Nn.worker=!0:typeof navigator>"u"||navigator.userAgent.indexOf("Node.js")===0?(Nn.node=!0,Nn.svgSupported=!0):Xye(navigator.userAgent,Nn);function Xye(t,e){var r=e.browser,n=t.match(/Firefox\/([\d.]+)/),i=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),a=t.match(/Edge?\/([\d.]+)/),l=/micromessenger/i.test(t);n&&(r.firefox=!0,r.version=n[1]),i&&(r.ie=!0,r.version=i[1]),a&&(r.edge=!0,r.version=a[1],r.newEdge=+a[1].split(".")[0]>18),l&&(r.weChat=!0),e.svgSupported=typeof SVGRect<"u",e.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,e.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),e.domSupported=typeof document<"u";var c=document.documentElement.style;e.transform3dSupported=(r.ie&&"transition"in c||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in c)&&!("OTransition"in c),e.transformSupported=e.transform3dSupported||r.ie&&+r.version>=9}var vz=12,p2="sans-serif",pd=vz+"px "+p2,Qye=20,Kye=100,Jye="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function e0e(t){var e={};if(typeof JSON>"u")return e;for(var r=0;r<t.length;r++){var n=String.fromCharCode(r+32),i=(t.charCodeAt(r)-Qye)/Kye;e[n]=i}return e}var t0e=e0e(Jye),gd={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var t,e;return function(r,n){if(!t){var i=gd.createCanvas();t=i&&i.getContext("2d")}if(t)return e!==n&&(e=t.font=n||pd),t.measureText(r);r=r||"",n=n||pd;var a=/(\d+)px/.exec(n),l=a&&+a[1]||vz,c=0;if(n.indexOf("mono")>=0)c=l*r.length;else for(var o=0;o<r.length;o++){var d=t0e[r[o]];c+=d==null?l:d*l}return{width:c}}}(),loadImage:function(t,e,r){var n=new Image;return n.onload=e,n.onerror=r,n.src=t,n}},g2=cc(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(t,e){return t["[object "+e+"]"]=!0,t},{}),v2=cc(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(t,e){return t["[object "+e+"Array]"]=!0,t},{}),ny=Object.prototype.toString,QM=Array.prototype,r0e=QM.forEach,n0e=QM.filter,mz=QM.slice,i0e=QM.map,vG=(function(){}).constructor,mT=vG?vG.prototype:null,_z="__proto__",a0e=2311;function m2(){return a0e++}function yz(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];typeof console<"u"&&console.error.apply(console,t)}function $r(t){if(t==null||typeof t!="object")return t;var e=t,r=ny.call(t);if(r==="[object Array]"){if(!l1(t)){e=[];for(var n=0,i=t.length;n<i;n++)e[n]=$r(t[n])}}else if(v2[r]){if(!l1(t)){var a=t.constructor;if(a.from)e=a.from(t);else{e=new a(t.length);for(var n=0,i=t.length;n<i;n++)e[n]=t[n]}}}else if(!g2[r]&&!l1(t)&&!G_(t)){e={};for(var l in t)t.hasOwnProperty(l)&&l!==_z&&(e[l]=$r(t[l]))}return e}function pn(t,e,r){if(!Ur(e)||!Ur(t))return r?$r(e):t;for(var n in e)if(e.hasOwnProperty(n)&&n!==_z){var i=t[n],a=e[n];Ur(a)&&Ur(i)&&!Ht(a)&&!Ht(i)&&!G_(a)&&!G_(i)&&!mG(a)&&!mG(i)&&!l1(a)&&!l1(i)?pn(i,a,r):(r||!(n in t))&&(t[n]=$r(e[n]))}return t}function xz(t,e){for(var r=t[0],n=1,i=t.length;n<i;n++)r=pn(r,t[n],e);return r}function Lt(t,e){if(Object.assign)Object.assign(t,e);else for(var r in e)e.hasOwnProperty(r)&&r!==_z&&(t[r]=e[r]);return t}function Fr(t,e,r){for(var n=Hn(e),i=0;i<n.length;i++){var a=n[i];(r?e[a]!=null:t[a]==null)&&(t[a]=e[a])}return t}function An(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r}return-1}function o0e(t,e){var r=t.prototype;function n(){}n.prototype=e.prototype,t.prototype=new n;for(var i in r)r.hasOwnProperty(i)&&(t.prototype[i]=r[i]);t.prototype.constructor=t,t.superClass=e}function Ea(t,e,r){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(e),i=0;i<n.length;i++){var a=n[i];a!=="constructor"&&(r?e[a]!=null:t[a]==null)&&(t[a]=e[a])}else Fr(t,e,r)}function Vo(t){return!t||typeof t=="string"?!1:typeof t.length=="number"}function fe(t,e,r){if(t&&e)if(t.forEach&&t.forEach===r0e)t.forEach(e,r);else if(t.length===+t.length)for(var n=0,i=t.length;n<i;n++)e.call(r,t[n],n,t);else for(var a in t)t.hasOwnProperty(a)&&e.call(r,t[a],a,t)}function Zt(t,e,r){if(!t)return[];if(!e)return bz(t);if(t.map&&t.map===i0e)return t.map(e,r);for(var n=[],i=0,a=t.length;i<a;i++)n.push(e.call(r,t[i],i,t));return n}function cc(t,e,r,n){if(t&&e){for(var i=0,a=t.length;i<a;i++)r=e.call(n,r,t[i],i,t);return r}}function Ei(t,e,r){if(!t)return[];if(!e)return bz(t);if(t.filter&&t.filter===n0e)return t.filter(e,r);for(var n=[],i=0,a=t.length;i<a;i++)e.call(r,t[i],i,t)&&n.push(t[i]);return n}function s0e(t,e,r){if(t&&e){for(var n=0,i=t.length;n<i;n++)if(e.call(r,t[n],n,t))return t[n]}}function Hn(t){if(!t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e}function l0e(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){return t.apply(e,r.concat(mz.call(arguments)))}}var wr=mT&&zr(mT.bind)?mT.call.bind(mT.bind):l0e;function on(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return function(){return t.apply(this,e.concat(mz.call(arguments)))}}function Ht(t){return Array.isArray?Array.isArray(t):ny.call(t)==="[object Array]"}function zr(t){return typeof t=="function"}function yr(t){return typeof t=="string"}function _k(t){return ny.call(t)==="[object String]"}function ii(t){return typeof t=="number"}function Ur(t){var e=typeof t;return e==="function"||!!t&&e==="object"}function mG(t){return!!g2[ny.call(t)]}function Is(t){return!!v2[ny.call(t)]}function G_(t){return typeof t=="object"&&typeof t.nodeType=="number"&&typeof t.ownerDocument=="object"}function KM(t){return t.colorStops!=null}function u0e(t){return t.image!=null}function c0e(t){return ny.call(t)==="[object RegExp]"}function F1(t){return t!==t}function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=t.length;r<n;r++)if(t[r]!=null)return t[r]}function tn(t,e){return t??e}function ac(t,e,r){return t??e??r}function bz(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return mz.apply(t,e)}function wz(t){if(typeof t=="number")return[t,t,t,t];var e=t.length;return e===2?[t[0],t[1],t[0],t[1]]:e===3?[t[0],t[1],t[2],t[1]]:t}function ns(t,e){if(!t)throw new Error(e)}function fu(t){return t==null?null:typeof t.trim=="function"?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var _2="__ec_primitive__";function bC(t){t[_2]=!0}function l1(t){return t[_2]}var h0e=function(){function t(){this.data={}}return t.prototype.delete=function(e){var r=this.has(e);return r&&delete this.data[e],r},t.prototype.has=function(e){return this.data.hasOwnProperty(e)},t.prototype.get=function(e){return this.data[e]},t.prototype.set=function(e,r){return this.data[e]=r,this},t.prototype.keys=function(){return Hn(this.data)},t.prototype.forEach=function(e){var r=this.data;for(var n in r)r.hasOwnProperty(n)&&e(r[n],n)},t}(),y2=typeof Map=="function";function f0e(){return y2?new Map:new h0e}var d0e=function(){function t(e){var r=Ht(e);this.data=f0e();var n=this;e instanceof t?e.each(i):e&&fe(e,i);function i(a,l){r?n.set(a,l):n.set(l,a)}}return t.prototype.hasKey=function(e){return this.data.has(e)},t.prototype.get=function(e){return this.data.get(e)},t.prototype.set=function(e,r){return this.data.set(e,r),r},t.prototype.each=function(e,r){this.data.forEach(function(n,i){e.call(r,n,i)})},t.prototype.keys=function(){var e=this.data.keys();return y2?Array.from(e):e},t.prototype.removeKey=function(e){this.data.delete(e)},t}();function Ir(t){return new d0e(t)}function wC(t,e){for(var r=new t.constructor(t.length+e.length),n=0;n<t.length;n++)r[n]=t[n];for(var i=t.length,n=0;n<e.length;n++)r[n+i]=e[n];return r}function JM(t,e){var r;if(Object.create)r=Object.create(t);else{var n=function(){};n.prototype=t,r=new n}return e&&Lt(r,e),r}function x2(t){var e=t.style;e.webkitUserSelect="none",e.userSelect="none",e.webkitTapHighlightColor="rgba(0,0,0,0)",e["-webkit-touch-callout"]="none"}function Cr(t,e){return t.hasOwnProperty(e)}function Sa(){}var OA=180/Math.PI;function cv(t,e){return t==null&&(t=0),e==null&&(e=0),[t,e]}function Qo(t,e){return t[0]=e[0],t[1]=e[1],t}function ah(t){return[t[0],t[1]]}function p0e(t,e,r){return t[0]=e,t[1]=r,t}function _G(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function yk(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function Tg(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function xk(t){return Math.sqrt(g0e(t))}function g0e(t){return t[0]*t[0]+t[1]*t[1]}function zA(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function iy(t,e){var r=xk(e);return r===0?(t[0]=0,t[1]=0):(t[0]=e[0]/r,t[1]=e[1]/r),t}function bk(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var Yf=bk;function v0e(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}var Bg=v0e;function BA(t,e,r,n){return t[0]=e[0]+n*(r[0]-e[0]),t[1]=e[1]+n*(r[1]-e[1]),t}function So(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function Xf(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function Qf(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}var $m=function(){function t(e,r){this.target=e,this.topTarget=r&&r.topTarget}return t}(),m0e=function(){function t(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return t.prototype._dragStart=function(e){for(var r=e.target;r&&!r.draggable;)r=r.parent||r.__hostTarget;r&&(this._draggingTarget=r,r.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new $m(r,e),"dragstart",e.event))},t.prototype._drag=function(e){var r=this._draggingTarget;if(r){var n=e.offsetX,i=e.offsetY,a=n-this._x,l=i-this._y;this._x=n,this._y=i,r.drift(a,l,e),this.handler.dispatchToElement(new $m(r,e),"drag",e.event);var c=this.handler.findHover(n,i,r).target,o=this._dropTarget;this._dropTarget=c,r!==c&&(o&&c!==o&&this.handler.dispatchToElement(new $m(o,e),"dragleave",e.event),c&&c!==o&&this.handler.dispatchToElement(new $m(c,e),"dragenter",e.event))}},t.prototype._dragEnd=function(e){var r=this._draggingTarget;r&&(r.dragging=!1),this.handler.dispatchToElement(new $m(r,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new $m(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},t}(),Fl=function(){function t(e){e&&(this._$eventProcessor=e)}return t.prototype.on=function(e,r,n,i){this._$handlers||(this._$handlers={});var a=this._$handlers;if(typeof r=="function"&&(i=n,n=r,r=null),!n||!e)return this;var l=this._$eventProcessor;r!=null&&l&&l.normalizeQuery&&(r=l.normalizeQuery(r)),a[e]||(a[e]=[]);for(var c=0;c<a[e].length;c++)if(a[e][c].h===n)return this;var o={h:n,query:r,ctx:i||this,callAtLast:n.zrEventfulCallAtLast},d=a[e].length-1,g=a[e][d];return g&&g.callAtLast?a[e].splice(d,0,o):a[e].push(o),this},t.prototype.isSilent=function(e){var r=this._$handlers;return!r||!r[e]||!r[e].length},t.prototype.off=function(e,r){var n=this._$handlers;if(!n)return this;if(!e)return this._$handlers={},this;if(r){if(n[e]){for(var i=[],a=0,l=n[e].length;a<l;a++)n[e][a].h!==r&&i.push(n[e][a]);n[e]=i}n[e]&&n[e].length===0&&delete n[e]}else delete n[e];return this},t.prototype.trigger=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[e],a=this._$eventProcessor;if(i)for(var l=r.length,c=i.length,o=0;o<c;o++){var d=i[o];if(!(a&&a.filter&&d.query!=null&&!a.filter(e,d.query)))switch(l){case 0:d.h.call(d.ctx);break;case 1:d.h.call(d.ctx,r[0]);break;case 2:d.h.call(d.ctx,r[0],r[1]);break;default:d.h.apply(d.ctx,r);break}}return a&&a.afterTrigger&&a.afterTrigger(e),this},t.prototype.triggerWithContext=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[e],a=this._$eventProcessor;if(i)for(var l=r.length,c=r[l-1],o=i.length,d=0;d<o;d++){var g=i[d];if(!(a&&a.filter&&g.query!=null&&!a.filter(e,g.query)))switch(l){case 0:g.h.call(c);break;case 1:g.h.call(c,r[0]);break;case 2:g.h.call(c,r[0],r[1]);break;default:g.h.apply(c,r.slice(1,l-1));break}}return a&&a.afterTrigger&&a.afterTrigger(e),this},t}(),_0e=Math.log(2);function wk(t,e,r,n,i,a){var l=n+"-"+i,c=t.length;if(a.hasOwnProperty(l))return a[l];if(e===1){var o=Math.round(Math.log((1<<c)-1&~i)/_0e);return t[r][o]}for(var d=n|1<<r,g=r+1;n&1<<g;)g++;for(var m=0,y=0,x=0;y<c;y++){var A=1<<y;A&i||(m+=(x%2?-1:1)*t[r][y]*wk(t,e-1,g,d,i|A,a),x++)}return a[l]=m,m}function yG(t,e){var r=[[t[0],t[1],1,0,0,0,-e[0]*t[0],-e[0]*t[1]],[0,0,0,t[0],t[1],1,-e[1]*t[0],-e[1]*t[1]],[t[2],t[3],1,0,0,0,-e[2]*t[2],-e[2]*t[3]],[0,0,0,t[2],t[3],1,-e[3]*t[2],-e[3]*t[3]],[t[4],t[5],1,0,0,0,-e[4]*t[4],-e[4]*t[5]],[0,0,0,t[4],t[5],1,-e[5]*t[4],-e[5]*t[5]],[t[6],t[7],1,0,0,0,-e[6]*t[6],-e[6]*t[7]],[0,0,0,t[6],t[7],1,-e[7]*t[6],-e[7]*t[7]]],n={},i=wk(r,8,0,0,0,n);if(i!==0){for(var a=[],l=0;l<8;l++)for(var c=0;c<8;c++)a[c]==null&&(a[c]=0),a[c]+=((l+c)%2?-1:1)*wk(r,7,l===0?1:0,1<<l,1<<c,n)/i*e[l];return function(o,d,g){var m=d*a[6]+g*a[7]+1;o[0]=(d*a[0]+g*a[1]+a[2])/m,o[1]=(d*a[3]+g*a[4]+a[5])/m}}}var xG="___zrEVENTSAVED",uP=[];function y0e(t,e,r,n,i){return Sk(uP,e,n,i,!0)&&Sk(t,r,uP[0],uP[1])}function Sk(t,e,r,n,i){if(e.getBoundingClientRect&&Nn.domSupported&&!b2(e)){var a=e[xG]||(e[xG]={}),l=x0e(e,a),c=b0e(l,a,i);if(c)return c(t,r,n),!0}return!1}function x0e(t,e){var r=e.markers;if(r)return r;r=e.markers=[];for(var n=["left","right"],i=["top","bottom"],a=0;a<4;a++){var l=document.createElement("div"),c=l.style,o=a%2,d=(a>>1)%2;c.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[o]+":0",i[d]+":0",n[1-o]+":auto",i[1-d]+":auto",""].join("!important;"),t.appendChild(l),r.push(l)}return r}function b0e(t,e,r){for(var n=r?"invTrans":"trans",i=e[n],a=e.srcCoords,l=[],c=[],o=!0,d=0;d<4;d++){var g=t[d].getBoundingClientRect(),m=2*d,y=g.left,x=g.top;l.push(y,x),o=o&&a&&y===a[m]&&x===a[m+1],c.push(t[d].offsetLeft,t[d].offsetTop)}return o&&i?i:(e.srcCoords=l,e[n]=r?yG(c,l):yG(l,c))}function b2(t){return t.nodeName.toUpperCase()==="CANVAS"}var w0e=/([&<>"'])/g,S0e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function qs(t){return t==null?"":(t+"").replace(w0e,function(e,r){return S0e[r]})}var T0e=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,cP=[],A0e=Nn.browser.firefox&&+Nn.browser.version.split(".")[0]<39;function Tk(t,e,r,n){return r=r||{},n?bG(t,e,r):A0e&&e.layerX!=null&&e.layerX!==e.offsetX?(r.zrX=e.layerX,r.zrY=e.layerY):e.offsetX!=null?(r.zrX=e.offsetX,r.zrY=e.offsetY):bG(t,e,r),r}function bG(t,e,r){if(Nn.domSupported&&t.getBoundingClientRect){var n=e.clientX,i=e.clientY;if(b2(t)){var a=t.getBoundingClientRect();r.zrX=n-a.left,r.zrY=i-a.top;return}else if(Sk(cP,t,n,i)){r.zrX=cP[0],r.zrY=cP[1];return}}r.zrX=r.zrY=0}function Sz(t){return t||window.event}function xl(t,e,r){if(e=Sz(e),e.zrX!=null)return e;var n=e.type,i=n&&n.indexOf("touch")>=0;if(i){var l=n!=="touchend"?e.targetTouches[0]:e.changedTouches[0];l&&Tk(t,l,e,r)}else{Tk(t,e,e,r);var a=C0e(e);e.zrDelta=a?a/120:-(e.detail||0)/3}var c=e.button;return e.which==null&&c!==void 0&&T0e.test(e.type)&&(e.which=c&1?1:c&2?3:c&4?2:0),e}function C0e(t){var e=t.wheelDelta;if(e)return e;var r=t.deltaX,n=t.deltaY;if(r==null||n==null)return e;var i=Math.abs(n!==0?n:r),a=n>0?-1:n<0?1:r>0?-1:1;return 3*i*a}function Ak(t,e,r,n){t.addEventListener(e,r,n)}function M0e(t,e,r,n){t.removeEventListener(e,r,n)}var dh=function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0};function wG(t){return t.which===2||t.which===3}var I0e=function(){function t(){this._track=[]}return t.prototype.recognize=function(e,r,n){return this._doTrack(e,r,n),this._recognize(e)},t.prototype.clear=function(){return this._track.length=0,this},t.prototype._doTrack=function(e,r,n){var i=e.touches;if(i){for(var a={points:[],touches:[],target:r,event:e},l=0,c=i.length;l<c;l++){var o=i[l],d=Tk(n,o,{});a.points.push([d.zrX,d.zrY]),a.touches.push(o)}this._track.push(a)}},t.prototype._recognize=function(e){for(var r in hP)if(hP.hasOwnProperty(r)){var n=hP[r](this._track,e);if(n)return n}},t}();function SG(t){var e=t[1][0]-t[0][0],r=t[1][1]-t[0][1];return Math.sqrt(e*e+r*r)}function E0e(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]}var hP={pinch:function(t,e){var r=t.length;if(r){var n=(t[r-1]||{}).points,i=(t[r-2]||{}).points||n;if(i&&i.length>1&&n&&n.length>1){var a=SG(n)/SG(i);!isFinite(a)&&(a=1),e.pinchScale=a;var l=E0e(n);return e.pinchX=l[0],e.pinchY=l[1],{type:"pinch",target:t[0].target,event:e}}}}};function Qs(){return[1,0,0,1,0,0]}function eI(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Tz(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function oh(t,e,r){var n=e[0]*r[0]+e[2]*r[1],i=e[1]*r[0]+e[3]*r[1],a=e[0]*r[2]+e[2]*r[3],l=e[1]*r[2]+e[3]*r[3],c=e[0]*r[4]+e[2]*r[5]+e[4],o=e[1]*r[4]+e[3]*r[5]+e[5];return t[0]=n,t[1]=i,t[2]=a,t[3]=l,t[4]=c,t[5]=o,t}function hc(t,e,r){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+r[0],t[5]=e[5]+r[1],t}function hv(t,e,r,n){n===void 0&&(n=[0,0]);var i=e[0],a=e[2],l=e[4],c=e[1],o=e[3],d=e[5],g=Math.sin(r),m=Math.cos(r);return t[0]=i*m+c*g,t[1]=-i*g+c*m,t[2]=a*m+o*g,t[3]=-a*g+m*o,t[4]=m*(l-n[0])+g*(d-n[1])+n[0],t[5]=m*(d-n[1])-g*(l-n[0])+n[1],t}function Az(t,e,r){var n=r[0],i=r[1];return t[0]=e[0]*n,t[1]=e[1]*i,t[2]=e[2]*n,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*i,t}function ay(t,e){var r=e[0],n=e[2],i=e[4],a=e[1],l=e[3],c=e[5],o=r*l-a*n;return o?(o=1/o,t[0]=l*o,t[1]=-a*o,t[2]=-n*o,t[3]=r*o,t[4]=(n*c-l*i)*o,t[5]=(a*i-r*c)*o,t):null}function D0e(t){var e=Qs();return Tz(e,t),e}var hn=function(){function t(e,r){this.x=e||0,this.y=r||0}return t.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.set=function(e,r){return this.x=e,this.y=r,this},t.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},t.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},t.prototype.scale=function(e){this.x*=e,this.y*=e},t.prototype.scaleAndAdd=function(e,r){this.x+=e.x*r,this.y+=e.y*r},t.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},t.prototype.dot=function(e){return this.x*e.x+this.y*e.y},t.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},t.prototype.distance=function(e){var r=this.x-e.x,n=this.y-e.y;return Math.sqrt(r*r+n*n)},t.prototype.distanceSquare=function(e){var r=this.x-e.x,n=this.y-e.y;return r*r+n*n},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.transform=function(e){if(e){var r=this.x,n=this.y;return this.x=e[0]*r+e[2]*n+e[4],this.y=e[1]*r+e[3]*n+e[5],this}},t.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},t.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},t.set=function(e,r,n){e.x=r,e.y=n},t.copy=function(e,r){e.x=r.x,e.y=r.y},t.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},t.lenSquare=function(e){return e.x*e.x+e.y*e.y},t.dot=function(e,r){return e.x*r.x+e.y*r.y},t.add=function(e,r,n){e.x=r.x+n.x,e.y=r.y+n.y},t.sub=function(e,r,n){e.x=r.x-n.x,e.y=r.y-n.y},t.scale=function(e,r,n){e.x=r.x*n,e.y=r.y*n},t.scaleAndAdd=function(e,r,n,i){e.x=r.x+n.x*i,e.y=r.y+n.y*i},t.lerp=function(e,r,n,i){var a=1-i;e.x=a*r.x+i*n.x,e.y=a*r.y+i*n.y},t}(),_T=Math.min,yT=Math.max,Fp=new hn,Np=new hn,Vp=new hn,Gp=new hn,ox=new hn,sx=new hn,gn=function(){function t(e,r,n,i){n<0&&(e=e+n,n=-n),i<0&&(r=r+i,i=-i),this.x=e,this.y=r,this.width=n,this.height=i}return t.prototype.union=function(e){var r=_T(e.x,this.x),n=_T(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=yT(e.x+e.width,this.x+this.width)-r:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=yT(e.y+e.height,this.y+this.height)-n:this.height=e.height,this.x=r,this.y=n},t.prototype.applyTransform=function(e){t.applyTransform(this,this,e)},t.prototype.calculateTransform=function(e){var r=this,n=e.width/r.width,i=e.height/r.height,a=Qs();return hc(a,a,[-r.x,-r.y]),Az(a,a,[n,i]),hc(a,a,[e.x,e.y]),a},t.prototype.intersect=function(e,r){if(!e)return!1;e instanceof t||(e=t.create(e));var n=this,i=n.x,a=n.x+n.width,l=n.y,c=n.y+n.height,o=e.x,d=e.x+e.width,g=e.y,m=e.y+e.height,y=!(a<o||d<i||c<g||m<l);if(r){var x=1/0,A=0,M=Math.abs(a-o),D=Math.abs(d-i),P=Math.abs(c-g),O=Math.abs(m-l),z=Math.min(M,D),V=Math.min(P,O);a<o||d<i?z>A&&(A=z,M<D?hn.set(sx,-M,0):hn.set(sx,D,0)):z<x&&(x=z,M<D?hn.set(ox,M,0):hn.set(ox,-D,0)),c<g||m<l?V>A&&(A=V,P<O?hn.set(sx,0,-P):hn.set(sx,0,O)):z<x&&(x=z,P<O?hn.set(ox,0,P):hn.set(ox,0,-O))}return r&&hn.copy(r,y?ox:sx),y},t.prototype.contain=function(e,r){var n=this;return e>=n.x&&e<=n.x+n.width&&r>=n.y&&r<=n.y+n.height},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(e){t.copy(this,e)},t.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},t.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},t.prototype.isZero=function(){return this.width===0||this.height===0},t.create=function(e){return new t(e.x,e.y,e.width,e.height)},t.copy=function(e,r){e.x=r.x,e.y=r.y,e.width=r.width,e.height=r.height},t.applyTransform=function(e,r,n){if(!n){e!==r&&t.copy(e,r);return}if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var i=n[0],a=n[3],l=n[4],c=n[5];e.x=r.x*i+l,e.y=r.y*a+c,e.width=r.width*i,e.height=r.height*a,e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height);return}Fp.x=Vp.x=r.x,Fp.y=Gp.y=r.y,Np.x=Gp.x=r.x+r.width,Np.y=Vp.y=r.y+r.height,Fp.transform(n),Gp.transform(n),Np.transform(n),Vp.transform(n),e.x=_T(Fp.x,Np.x,Vp.x,Gp.x),e.y=_T(Fp.y,Np.y,Vp.y,Gp.y);var o=yT(Fp.x,Np.x,Vp.x,Gp.x),d=yT(Fp.y,Np.y,Vp.y,Gp.y);e.width=o-e.x,e.height=d-e.y},t}(),w2="silent";function P0e(t,e,r){return{type:t,event:r,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:L0e}}function L0e(){dh(this.event)}var R0e=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.handler=null,r}return e.prototype.dispose=function(){},e.prototype.setCursor=function(){},e}(Fl),lx=function(){function t(e,r){this.x=e,this.y=r}return t}(),k0e=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],fP=new gn(0,0,0,0),S2=function(t){et(e,t);function e(r,n,i,a,l){var c=t.call(this)||this;return c._hovered=new lx(0,0),c.storage=r,c.painter=n,c.painterRoot=a,c._pointerSize=l,i=i||new R0e,c.proxy=null,c.setHandlerProxy(i),c._draggingMgr=new m0e(c),c}return e.prototype.setHandlerProxy=function(r){this.proxy&&this.proxy.dispose(),r&&(fe(k0e,function(n){r.on&&r.on(n,this[n],this)},this),r.handler=this),this.proxy=r},e.prototype.mousemove=function(r){var n=r.zrX,i=r.zrY,a=T2(this,n,i),l=this._hovered,c=l.target;c&&!c.__zr&&(l=this.findHover(l.x,l.y),c=l.target);var o=this._hovered=a?new lx(n,i):this.findHover(n,i),d=o.target,g=this.proxy;g.setCursor&&g.setCursor(d?d.cursor:"default"),c&&d!==c&&this.dispatchToElement(l,"mouseout",r),this.dispatchToElement(o,"mousemove",r),d&&d!==c&&this.dispatchToElement(o,"mouseover",r)},e.prototype.mouseout=function(r){var n=r.zrEventControl;n!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",r),n!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:r})},e.prototype.resize=function(){this._hovered=new lx(0,0)},e.prototype.dispatch=function(r,n){var i=this[r];i&&i.call(this,n)},e.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},e.prototype.setCursorStyle=function(r){var n=this.proxy;n.setCursor&&n.setCursor(r)},e.prototype.dispatchToElement=function(r,n,i){r=r||{};var a=r.target;if(!(a&&a.silent)){for(var l="on"+n,c=P0e(n,r,i);a&&(a[l]&&(c.cancelBubble=!!a[l].call(a,c)),a.trigger(n,c),a=a.__hostTarget?a.__hostTarget:a.parent,!c.cancelBubble););c.cancelBubble||(this.trigger(n,c),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(o){typeof o[l]=="function"&&o[l].call(o,c),o.trigger&&o.trigger(n,c)}))}},e.prototype.findHover=function(r,n,i){var a=this.storage.getDisplayList(),l=new lx(r,n);if(TG(a,l,r,n,i),this._pointerSize&&!l.target){for(var c=[],o=this._pointerSize,d=o/2,g=new gn(r-d,n-d,o,o),m=a.length-1;m>=0;m--){var y=a[m];y!==i&&!y.ignore&&!y.ignoreCoarsePointer&&(!y.parent||!y.parent.ignoreCoarsePointer)&&(fP.copy(y.getBoundingRect()),y.transform&&fP.applyTransform(y.transform),fP.intersect(g)&&c.push(y))}if(c.length)for(var x=4,A=Math.PI/12,M=Math.PI*2,D=0;D<d;D+=x)for(var P=0;P<M;P+=A){var O=r+D*Math.cos(P),z=n+D*Math.sin(P);if(TG(c,l,O,z,i),l.target)return l}}return l},e.prototype.processGesture=function(r,n){this._gestureMgr||(this._gestureMgr=new I0e);var i=this._gestureMgr;n==="start"&&i.clear();var a=i.recognize(r,this.findHover(r.zrX,r.zrY,null).target,this.proxy.dom);if(n==="end"&&i.clear(),a){var l=a.type;r.gestureEvent=l;var c=new lx;c.target=a.target,this.dispatchToElement(c,l,a.event)}},e}(Fl);fe(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){S2.prototype[t]=function(e){var r=e.zrX,n=e.zrY,i=T2(this,r,n),a,l;if((t!=="mouseup"||!i)&&(a=this.findHover(r,n),l=a.target),t==="mousedown")this._downEl=l,this._downPoint=[e.zrX,e.zrY],this._upEl=l;else if(t==="mouseup")this._upEl=l;else if(t==="click"){if(this._downEl!==this._upEl||!this._downPoint||Yf(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,t,e)}});function O0e(t,e,r){if(t[t.rectHover?"rectContain":"contain"](e,r)){for(var n=t,i=void 0,a=!1;n;){if(n.ignoreClip&&(a=!0),!a){var l=n.getClipPath();if(l&&!l.contain(e,r))return!1}n.silent&&(i=!0);var c=n.__hostTarget;n=c||n.parent}return i?w2:!0}return!1}function TG(t,e,r,n,i){for(var a=t.length-1;a>=0;a--){var l=t[a],c=void 0;if(l!==i&&!l.ignore&&(c=O0e(l,r,n))&&(!e.topTarget&&(e.topTarget=l),c!==w2)){e.target=l;break}}}function T2(t,e,r){var n=t.painter;return e<0||e>n.getWidth()||r<0||r>n.getHeight()}var A2=32,ux=7;function z0e(t){for(var e=0;t>=A2;)e|=t&1,t>>=1;return t+e}function AG(t,e,r,n){var i=e+1;if(i===r)return 1;if(n(t[i++],t[e])<0){for(;i<r&&n(t[i],t[i-1])<0;)i++;B0e(t,e,i)}else for(;i<r&&n(t[i],t[i-1])>=0;)i++;return i-e}function B0e(t,e,r){for(r--;e<r;){var n=t[e];t[e++]=t[r],t[r--]=n}}function CG(t,e,r,n,i){for(n===e&&n++;n<r;n++){for(var a=t[n],l=e,c=n,o;l<c;)o=l+c>>>1,i(a,t[o])<0?c=o:l=o+1;var d=n-l;switch(d){case 3:t[l+3]=t[l+2];case 2:t[l+2]=t[l+1];case 1:t[l+1]=t[l];break;default:for(;d>0;)t[l+d]=t[l+d-1],d--}t[l]=a}}function dP(t,e,r,n,i,a){var l=0,c=0,o=1;if(a(t,e[r+i])>0){for(c=n-i;o<c&&a(t,e[r+i+o])>0;)l=o,o=(o<<1)+1,o<=0&&(o=c);o>c&&(o=c),l+=i,o+=i}else{for(c=i+1;o<c&&a(t,e[r+i-o])<=0;)l=o,o=(o<<1)+1,o<=0&&(o=c);o>c&&(o=c);var d=l;l=i-o,o=i-d}for(l++;l<o;){var g=l+(o-l>>>1);a(t,e[r+g])>0?l=g+1:o=g}return o}function pP(t,e,r,n,i,a){var l=0,c=0,o=1;if(a(t,e[r+i])<0){for(c=i+1;o<c&&a(t,e[r+i-o])<0;)l=o,o=(o<<1)+1,o<=0&&(o=c);o>c&&(o=c);var d=l;l=i-o,o=i-d}else{for(c=n-i;o<c&&a(t,e[r+i+o])>=0;)l=o,o=(o<<1)+1,o<=0&&(o=c);o>c&&(o=c),l+=i,o+=i}for(l++;l<o;){var g=l+(o-l>>>1);a(t,e[r+g])<0?o=g:l=g+1}return o}function F0e(t,e){var r=ux,n,i,a=0,l=[];n=[],i=[];function c(x,A){n[a]=x,i[a]=A,a+=1}function o(){for(;a>1;){var x=a-2;if(x>=1&&i[x-1]<=i[x]+i[x+1]||x>=2&&i[x-2]<=i[x]+i[x-1])i[x-1]<i[x+1]&&x--;else if(i[x]>i[x+1])break;g(x)}}function d(){for(;a>1;){var x=a-2;x>0&&i[x-1]<i[x+1]&&x--,g(x)}}function g(x){var A=n[x],M=i[x],D=n[x+1],P=i[x+1];i[x]=M+P,x===a-3&&(n[x+1]=n[x+2],i[x+1]=i[x+2]),a--;var O=pP(t[D],t,A,M,0,e);A+=O,M-=O,M!==0&&(P=dP(t[A+M-1],t,D,P,P-1,e),P!==0&&(M<=P?m(A,M,D,P):y(A,M,D,P)))}function m(x,A,M,D){var P=0;for(P=0;P<A;P++)l[P]=t[x+P];var O=0,z=M,V=x;if(t[V++]=t[z++],--D===0){for(P=0;P<A;P++)t[V+P]=l[O+P];return}if(A===1){for(P=0;P<D;P++)t[V+P]=t[z+P];t[V+D]=l[O];return}for(var H=r,$,X,W;;){$=0,X=0,W=!1;do if(e(t[z],l[O])<0){if(t[V++]=t[z++],X++,$=0,--D===0){W=!0;break}}else if(t[V++]=l[O++],$++,X=0,--A===1){W=!0;break}while(($|X)<H);if(W)break;do{if($=pP(t[z],l,O,A,0,e),$!==0){for(P=0;P<$;P++)t[V+P]=l[O+P];if(V+=$,O+=$,A-=$,A<=1){W=!0;break}}if(t[V++]=t[z++],--D===0){W=!0;break}if(X=dP(l[O],t,z,D,0,e),X!==0){for(P=0;P<X;P++)t[V+P]=t[z+P];if(V+=X,z+=X,D-=X,D===0){W=!0;break}}if(t[V++]=l[O++],--A===1){W=!0;break}H--}while($>=ux||X>=ux);if(W)break;H<0&&(H=0),H+=2}if(r=H,r<1&&(r=1),A===1){for(P=0;P<D;P++)t[V+P]=t[z+P];t[V+D]=l[O]}else{if(A===0)throw new Error;for(P=0;P<A;P++)t[V+P]=l[O+P]}}function y(x,A,M,D){var P=0;for(P=0;P<D;P++)l[P]=t[M+P];var O=x+A-1,z=D-1,V=M+D-1,H=0,$=0;if(t[V--]=t[O--],--A===0){for(H=V-(D-1),P=0;P<D;P++)t[H+P]=l[P];return}if(D===1){for(V-=A,O-=A,$=V+1,H=O+1,P=A-1;P>=0;P--)t[$+P]=t[H+P];t[V]=l[z];return}for(var X=r;;){var W=0,Y=0,J=!1;do if(e(l[z],t[O])<0){if(t[V--]=t[O--],W++,Y=0,--A===0){J=!0;break}}else if(t[V--]=l[z--],Y++,W=0,--D===1){J=!0;break}while((W|Y)<X);if(J)break;do{if(W=A-pP(l[z],t,x,A,A-1,e),W!==0){for(V-=W,O-=W,A-=W,$=V+1,H=O+1,P=W-1;P>=0;P--)t[$+P]=t[H+P];if(A===0){J=!0;break}}if(t[V--]=l[z--],--D===1){J=!0;break}if(Y=D-dP(t[O],l,0,D,D-1,e),Y!==0){for(V-=Y,z-=Y,D-=Y,$=V+1,H=z+1,P=0;P<Y;P++)t[$+P]=l[H+P];if(D<=1){J=!0;break}}if(t[V--]=t[O--],--A===0){J=!0;break}X--}while(W>=ux||Y>=ux);if(J)break;X<0&&(X=0),X+=2}if(r=X,r<1&&(r=1),D===1){for(V-=A,O-=A,$=V+1,H=O+1,P=A-1;P>=0;P--)t[$+P]=t[H+P];t[V]=l[z]}else{if(D===0)throw new Error;for(H=V-(D-1),P=0;P<D;P++)t[H+P]=l[P]}}return{mergeRuns:o,forceMergeRuns:d,pushRun:c}}function FA(t,e,r,n){r||(r=0),n||(n=t.length);var i=n-r;if(!(i<2)){var a=0;if(i<A2){a=AG(t,r,n,e),CG(t,r,n,r+a,e);return}var l=F0e(t,e),c=z0e(i);do{if(a=AG(t,r,n,e),a<c){var o=i;o>c&&(o=c),CG(t,r,r+o,r+a,e),a=o}l.pushRun(r,a),l.mergeRuns(),i-=a,r+=a}while(i!==0);l.forceMergeRuns()}}var Ys=1,Fx=2,h_=4,MG=!1;function gP(){MG||(MG=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function IG(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}var N0e=function(){function t(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=IG}return t.prototype.traverse=function(e,r){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(e,r)},t.prototype.getDisplayList=function(e,r){r=r||!1;var n=this._displayList;return(e||!n.length)&&this.updateDisplayList(r),n},t.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var r=this._roots,n=this._displayList,i=0,a=r.length;i<a;i++)this._updateAndAddDisplayable(r[i],null,e);n.length=this._displayListLen,FA(n,IG)},t.prototype._updateAndAddDisplayable=function(e,r,n){if(!(e.ignore&&!n)){e.beforeUpdate(),e.update(),e.afterUpdate();var i=e.getClipPath();if(e.ignoreClip)r=null;else if(i){r?r=r.slice():r=[];for(var a=i,l=e;a;)a.parent=l,a.updateTransform(),r.push(a),l=a,a=a.getClipPath()}if(e.childrenRef){for(var c=e.childrenRef(),o=0;o<c.length;o++){var d=c[o];e.__dirty&&(d.__dirty|=Ys),this._updateAndAddDisplayable(d,r,n)}e.__dirty=0}else{var g=e;r&&r.length?g.__clipPaths=r:g.__clipPaths&&g.__clipPaths.length>0&&(g.__clipPaths=[]),isNaN(g.z)&&(gP(),g.z=0),isNaN(g.z2)&&(gP(),g.z2=0),isNaN(g.zlevel)&&(gP(),g.zlevel=0),this._displayList[this._displayListLen++]=g}var m=e.getDecalElement&&e.getDecalElement();m&&this._updateAndAddDisplayable(m,r,n);var y=e.getTextGuideLine();y&&this._updateAndAddDisplayable(y,r,n);var x=e.getTextContent();x&&this._updateAndAddDisplayable(x,r,n)}},t.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},t.prototype.delRoot=function(e){if(e instanceof Array){for(var r=0,n=e.length;r<n;r++)this.delRoot(e[r]);return}var i=An(this._roots,e);i>=0&&this._roots.splice(i,1)},t.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},t.prototype.getRoots=function(){return this._roots},t.prototype.dispose=function(){this._displayList=null,this._roots=null},t}(),SC;SC=Nn.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){return setTimeout(t,16)};var u1={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return .5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return t===0?0:Math.pow(1024,t-1)},exponentialOut:function(t){return t===1?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,r=.1,n=.4;return t===0?0:t===1?1:(!r||r<1?(r=1,e=n/4):e=n*Math.asin(1/r)/(2*Math.PI),-(r*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)))},elasticOut:function(t){var e,r=.1,n=.4;return t===0?0:t===1?1:(!r||r<1?(r=1,e=n/4):e=n*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1)},elasticInOut:function(t){var e,r=.1,n=.4;return t===0?0:t===1?1:(!r||r<1?(r=1,e=n/4):e=n*Math.asin(1/r)/(2*Math.PI),(t*=2)<1?-.5*(r*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)):r*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-u1.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?u1.bounceIn(t*2)*.5:u1.bounceOut(t*2-1)*.5+.5}},xT=Math.pow,ld=Math.sqrt,TC=1e-8,C2=1e-4,EG=ld(3),bT=1/3,Qu=cv(),Tl=cv(),T_=cv();function Kf(t){return t>-TC&&t<TC}function M2(t){return t>TC||t<-TC}function Xa(t,e,r,n,i){var a=1-i;return a*a*(a*t+3*i*e)+i*i*(i*n+3*a*r)}function DG(t,e,r,n,i){var a=1-i;return 3*(((e-t)*a+2*(r-e)*i)*a+(n-r)*i*i)}function AC(t,e,r,n,i,a){var l=n+3*(e-r)-t,c=3*(r-e*2+t),o=3*(e-t),d=t-i,g=c*c-3*l*o,m=c*o-9*l*d,y=o*o-3*c*d,x=0;if(Kf(g)&&Kf(m))if(Kf(c))a[0]=0;else{var A=-o/c;A>=0&&A<=1&&(a[x++]=A)}else{var M=m*m-4*g*y;if(Kf(M)){var D=m/g,A=-c/l+D,P=-D/2;A>=0&&A<=1&&(a[x++]=A),P>=0&&P<=1&&(a[x++]=P)}else if(M>0){var O=ld(M),z=g*c+1.5*l*(-m+O),V=g*c+1.5*l*(-m-O);z<0?z=-xT(-z,bT):z=xT(z,bT),V<0?V=-xT(-V,bT):V=xT(V,bT);var A=(-c-(z+V))/(3*l);A>=0&&A<=1&&(a[x++]=A)}else{var H=(2*g*c-3*l*m)/(2*ld(g*g*g)),$=Math.acos(H)/3,X=ld(g),W=Math.cos($),A=(-c-2*X*W)/(3*l),P=(-c+X*(W+EG*Math.sin($)))/(3*l),Y=(-c+X*(W-EG*Math.sin($)))/(3*l);A>=0&&A<=1&&(a[x++]=A),P>=0&&P<=1&&(a[x++]=P),Y>=0&&Y<=1&&(a[x++]=Y)}}return x}function I2(t,e,r,n,i){var a=6*r-12*e+6*t,l=9*e+3*n-3*t-9*r,c=3*e-3*t,o=0;if(Kf(l)){if(M2(a)){var d=-c/a;d>=0&&d<=1&&(i[o++]=d)}}else{var g=a*a-4*l*c;if(Kf(g))i[0]=-a/(2*l);else if(g>0){var m=ld(g),d=(-a+m)/(2*l),y=(-a-m)/(2*l);d>=0&&d<=1&&(i[o++]=d),y>=0&&y<=1&&(i[o++]=y)}}return o}function vd(t,e,r,n,i,a){var l=(e-t)*i+t,c=(r-e)*i+e,o=(n-r)*i+r,d=(c-l)*i+l,g=(o-c)*i+c,m=(g-d)*i+d;a[0]=t,a[1]=l,a[2]=d,a[3]=m,a[4]=m,a[5]=g,a[6]=o,a[7]=n}function E2(t,e,r,n,i,a,l,c,o,d,g){var m,y=.005,x=1/0,A,M,D,P;Qu[0]=o,Qu[1]=d;for(var O=0;O<1;O+=.05)Tl[0]=Xa(t,r,i,l,O),Tl[1]=Xa(e,n,a,c,O),D=Bg(Qu,Tl),D<x&&(m=O,x=D);x=1/0;for(var z=0;z<32&&!(y<C2);z++)A=m-y,M=m+y,Tl[0]=Xa(t,r,i,l,A),Tl[1]=Xa(e,n,a,c,A),D=Bg(Tl,Qu),A>=0&&D<x?(m=A,x=D):(T_[0]=Xa(t,r,i,l,M),T_[1]=Xa(e,n,a,c,M),P=Bg(T_,Qu),M<=1&&P<x?(m=M,x=P):y*=.5);return g&&(g[0]=Xa(t,r,i,l,m),g[1]=Xa(e,n,a,c,m)),ld(x)}function V0e(t,e,r,n,i,a,l,c,o){for(var d=t,g=e,m=0,y=1/o,x=1;x<=o;x++){var A=x*y,M=Xa(t,r,i,l,A),D=Xa(e,n,a,c,A),P=M-d,O=D-g;m+=Math.sqrt(P*P+O*O),d=M,g=D}return m}function lo(t,e,r,n){var i=1-n;return i*(i*t+2*n*e)+n*n*r}function Ck(t,e,r,n){return 2*((1-n)*(e-t)+n*(r-e))}function G0e(t,e,r,n,i){var a=t-2*e+r,l=2*(e-t),c=t-n,o=0;if(Kf(a)){if(M2(l)){var d=-c/l;d>=0&&d<=1&&(i[o++]=d)}}else{var g=l*l-4*a*c;if(Kf(g)){var d=-l/(2*a);d>=0&&d<=1&&(i[o++]=d)}else if(g>0){var m=ld(g),d=(-l+m)/(2*a),y=(-l-m)/(2*a);d>=0&&d<=1&&(i[o++]=d),y>=0&&y<=1&&(i[o++]=y)}}return o}function D2(t,e,r){var n=t+r-2*e;return n===0?.5:(t-e)/n}function N1(t,e,r,n,i){var a=(e-t)*n+t,l=(r-e)*n+e,c=(l-a)*n+a;i[0]=t,i[1]=a,i[2]=c,i[3]=c,i[4]=l,i[5]=r}function P2(t,e,r,n,i,a,l,c,o){var d,g=.005,m=1/0;Qu[0]=l,Qu[1]=c;for(var y=0;y<1;y+=.05){Tl[0]=lo(t,r,i,y),Tl[1]=lo(e,n,a,y);var x=Bg(Qu,Tl);x<m&&(d=y,m=x)}m=1/0;for(var A=0;A<32&&!(g<C2);A++){var M=d-g,D=d+g;Tl[0]=lo(t,r,i,M),Tl[1]=lo(e,n,a,M);var x=Bg(Tl,Qu);if(M>=0&&x<m)d=M,m=x;else{T_[0]=lo(t,r,i,D),T_[1]=lo(e,n,a,D);var P=Bg(T_,Qu);D<=1&&P<m?(d=D,m=P):g*=.5}}return o&&(o[0]=lo(t,r,i,d),o[1]=lo(e,n,a,d)),ld(m)}function U0e(t,e,r,n,i,a,l){for(var c=t,o=e,d=0,g=1/l,m=1;m<=l;m++){var y=m*g,x=lo(t,r,i,y),A=lo(e,n,a,y),M=x-c,D=A-o;d+=Math.sqrt(M*M+D*D),c=x,o=A}return d}var $0e=/cubic-bezier\(([0-9,\.e ]+)\)/;function Cz(t){var e=t&&$0e.exec(t);if(e){var r=e[1].split(","),n=+fu(r[0]),i=+fu(r[1]),a=+fu(r[2]),l=+fu(r[3]);if(isNaN(n+i+a+l))return;var c=[];return function(o){return o<=0?0:o>=1?1:AC(0,n,a,1,o,c)&&Xa(0,i,l,1,c[0])}}}var H0e=function(){function t(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||Sa,this.ondestroy=e.ondestroy||Sa,this.onrestart=e.onrestart||Sa,e.easing&&this.setEasing(e.easing)}return t.prototype.step=function(e,r){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),this._paused){this._pausedTime+=r;return}var n=this._life,i=e-this._startTime-this._pausedTime,a=i/n;a<0&&(a=0),a=Math.min(a,1);var l=this.easingFunc,c=l?l(a):a;if(this.onframe(c),a===1)if(this.loop){var o=i%n;this._startTime=e-o,this._pausedTime=0,this.onrestart()}else return!0;return!1},t.prototype.pause=function(){this._paused=!0},t.prototype.resume=function(){this._paused=!1},t.prototype.setEasing=function(e){this.easing=e,this.easingFunc=zr(e)?e:u1[e]||Cz(e)},t}(),L2=function(){function t(e){this.value=e}return t}(),j0e=function(){function t(){this._len=0}return t.prototype.insert=function(e){var r=new L2(e);return this.insertEntry(r),r},t.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},t.prototype.remove=function(e){var r=e.prev,n=e.next;r?r.next=n:this.head=n,n?n.prev=r:this.tail=r,e.next=e.prev=null,this._len--},t.prototype.len=function(){return this._len},t.prototype.clear=function(){this.head=this.tail=null,this._len=0},t}(),wb=function(){function t(e){this._list=new j0e,this._maxSize=10,this._map={},this._maxSize=e}return t.prototype.put=function(e,r){var n=this._list,i=this._map,a=null;if(i[e]==null){var l=n.len(),c=this._lastRemovedEntry;if(l>=this._maxSize&&l>0){var o=n.head;n.remove(o),delete i[o.key],a=o.value,this._lastRemovedEntry=o}c?c.value=r:c=new L2(r),c.key=e,n.insertEntry(c),i[e]=c}return a},t.prototype.get=function(e){var r=this._map[e],n=this._list;if(r!=null)return r!==n.tail&&(n.remove(r),n.insertEntry(r)),r.value},t.prototype.clear=function(){this._list.clear(),this._map={}},t.prototype.len=function(){return this._list.len()},t}(),PG={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function gu(t){return t=Math.round(t),t<0?0:t>255?255:t}function W0e(t){return t=Math.round(t),t<0?0:t>360?360:t}function V1(t){return t<0?0:t>1?1:t}function vP(t){var e=t;return e.length&&e.charAt(e.length-1)==="%"?gu(parseFloat(e)/100*255):gu(parseInt(e,10))}function Fg(t){var e=t;return e.length&&e.charAt(e.length-1)==="%"?V1(parseFloat(e)/100):V1(parseFloat(e))}function mP(t,e,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?t+(e-t)*r*6:r*2<1?e:r*3<2?t+(e-t)*(2/3-r)*6:t}function Jf(t,e,r){return t+(e-t)*r}function yl(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function Mk(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}var R2=new wb(20),wT=null;function Hm(t,e){wT&&Mk(wT,e),wT=R2.put(t,wT||e.slice())}function Ks(t,e){if(t){e=e||[];var r=R2.get(t);if(r)return Mk(e,r);t=t+"";var n=t.replace(/ /g,"").toLowerCase();if(n in PG)return Mk(e,PG[n]),Hm(t,e),e;var i=n.length;if(n.charAt(0)==="#"){if(i===4||i===5){var a=parseInt(n.slice(1,4),16);if(!(a>=0&&a<=4095)){yl(e,0,0,0,1);return}return yl(e,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,i===5?parseInt(n.slice(4),16)/15:1),Hm(t,e),e}else if(i===7||i===9){var a=parseInt(n.slice(1,7),16);if(!(a>=0&&a<=16777215)){yl(e,0,0,0,1);return}return yl(e,(a&16711680)>>16,(a&65280)>>8,a&255,i===9?parseInt(n.slice(7),16)/255:1),Hm(t,e),e}return}var l=n.indexOf("("),c=n.indexOf(")");if(l!==-1&&c+1===i){var o=n.substr(0,l),d=n.substr(l+1,c-(l+1)).split(","),g=1;switch(o){case"rgba":if(d.length!==4)return d.length===3?yl(e,+d[0],+d[1],+d[2],1):yl(e,0,0,0,1);g=Fg(d.pop());case"rgb":if(d.length>=3)return yl(e,vP(d[0]),vP(d[1]),vP(d[2]),d.length===3?g:Fg(d[3])),Hm(t,e),e;yl(e,0,0,0,1);return;case"hsla":if(d.length!==4){yl(e,0,0,0,1);return}return d[3]=Fg(d[3]),Ik(d,e),Hm(t,e),e;case"hsl":if(d.length!==3){yl(e,0,0,0,1);return}return Ik(d,e),Hm(t,e),e;default:return}}yl(e,0,0,0,1)}}function Ik(t,e){var r=(parseFloat(t[0])%360+360)%360/360,n=Fg(t[1]),i=Fg(t[2]),a=i<=.5?i*(n+1):i+n-i*n,l=i*2-a;return e=e||[],yl(e,gu(mP(l,a,r+1/3)*255),gu(mP(l,a,r)*255),gu(mP(l,a,r-1/3)*255),1),t.length===4&&(e[3]=t[3]),e}function Z0e(t){if(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.min(e,r,n),a=Math.max(e,r,n),l=a-i,c=(a+i)/2,o,d;if(l===0)o=0,d=0;else{c<.5?d=l/(a+i):d=l/(2-a-i);var g=((a-e)/6+l/2)/l,m=((a-r)/6+l/2)/l,y=((a-n)/6+l/2)/l;e===a?o=y-m:r===a?o=1/3+g-y:n===a&&(o=2/3+m-g),o<0&&(o+=1),o>1&&(o-=1)}var x=[o*360,d,c];return t[3]!=null&&x.push(t[3]),x}}function Ek(t,e){var r=Ks(t);if(r){for(var n=0;n<3;n++)e<0?r[n]=r[n]*(1-e)|0:r[n]=(255-r[n])*e+r[n]|0,r[n]>255?r[n]=255:r[n]<0&&(r[n]=0);return sh(r,r.length===4?"rgba":"rgb")}}function _P(t,e,r){if(!(!(e&&e.length)||!(t>=0&&t<=1))){r=r||[];var n=t*(e.length-1),i=Math.floor(n),a=Math.ceil(n),l=e[i],c=e[a],o=n-i;return r[0]=gu(Jf(l[0],c[0],o)),r[1]=gu(Jf(l[1],c[1],o)),r[2]=gu(Jf(l[2],c[2],o)),r[3]=V1(Jf(l[3],c[3],o)),r}}function q0e(t,e,r){if(!(!(e&&e.length)||!(t>=0&&t<=1))){var n=t*(e.length-1),i=Math.floor(n),a=Math.ceil(n),l=Ks(e[i]),c=Ks(e[a]),o=n-i,d=sh([gu(Jf(l[0],c[0],o)),gu(Jf(l[1],c[1],o)),gu(Jf(l[2],c[2],o)),V1(Jf(l[3],c[3],o))],"rgba");return r?{color:d,leftIndex:i,rightIndex:a,value:n}:d}}function c1(t,e,r,n){var i=Ks(t);if(t)return i=Z0e(i),e!=null&&(i[0]=W0e(e)),r!=null&&(i[1]=Fg(r)),n!=null&&(i[2]=Fg(n)),sh(Ik(i),"rgba")}function CC(t,e){var r=Ks(t);if(r&&e!=null)return r[3]=V1(e),sh(r,"rgba")}function sh(t,e){if(!(!t||!t.length)){var r=t[0]+","+t[1]+","+t[2];return(e==="rgba"||e==="hsva"||e==="hsla")&&(r+=","+t[3]),e+"("+r+")"}}function MC(t,e){var r=Ks(t);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*e:0}var LG=new wb(100);function Dk(t){if(yr(t)){var e=LG.get(t);return e||(e=Ek(t,-.1),LG.put(t,e)),e}else if(KM(t)){var r=Lt({},t);return r.colorStops=Zt(t.colorStops,function(n){return{offset:n.offset,color:Ek(n.color,-.1)}}),r}return t}var IC=Math.round;function G1(t){var e;if(!t||t==="transparent")t="none";else if(typeof t=="string"&&t.indexOf("rgba")>-1){var r=Ks(t);r&&(t="rgb("+r[0]+","+r[1]+","+r[2]+")",e=r[3])}return{color:t,opacity:e??1}}var RG=1e-4;function ed(t){return t<RG&&t>-RG}function ST(t){return IC(t*1e3)/1e3}function Pk(t){return IC(t*1e4)/1e4}function Y0e(t){return"matrix("+ST(t[0])+","+ST(t[1])+","+ST(t[2])+","+ST(t[3])+","+Pk(t[4])+","+Pk(t[5])+")"}var X0e={left:"start",right:"end",center:"middle",middle:"middle"};function Q0e(t,e,r){return r==="top"?t+=e/2:r==="bottom"&&(t-=e/2),t}function K0e(t){return t&&(t.shadowBlur||t.shadowOffsetX||t.shadowOffsetY)}function J0e(t){var e=t.style,r=t.getGlobalScale();return[e.shadowColor,(e.shadowBlur||0).toFixed(2),(e.shadowOffsetX||0).toFixed(2),(e.shadowOffsetY||0).toFixed(2),r[0],r[1]].join(",")}function k2(t){return t&&!!t.image}function exe(t){return t&&!!t.svgElement}function Mz(t){return k2(t)||exe(t)}function O2(t){return t.type==="linear"}function z2(t){return t.type==="radial"}function B2(t){return t&&(t.type==="linear"||t.type==="radial")}function tI(t){return"url(#"+t+")"}function F2(t){var e=t.getGlobalScale(),r=Math.max(e[0],e[1]);return Math.max(Math.ceil(Math.log(r)/Math.log(10)),1)}function N2(t){var e=t.x||0,r=t.y||0,n=(t.rotation||0)*OA,i=tn(t.scaleX,1),a=tn(t.scaleY,1),l=t.skewX||0,c=t.skewY||0,o=[];return(e||r)&&o.push("translate("+e+"px,"+r+"px)"),n&&o.push("rotate("+n+")"),(i!==1||a!==1)&&o.push("scale("+i+","+a+")"),(l||c)&&o.push("skew("+IC(l*OA)+"deg, "+IC(c*OA)+"deg)"),o.join(" ")}var txe=function(){return Nn.hasGlobalWindow&&zr(window.btoa)?function(t){return window.btoa(unescape(encodeURIComponent(t)))}:typeof Buffer<"u"?function(t){return Buffer.from(t).toString("base64")}:function(t){return null}}(),Lk=Array.prototype.slice;function Kc(t,e,r){return(e-t)*r+t}function yP(t,e,r,n){for(var i=e.length,a=0;a<i;a++)t[a]=Kc(e[a],r[a],n);return t}function rxe(t,e,r,n){for(var i=e.length,a=i&&e[0].length,l=0;l<i;l++){t[l]||(t[l]=[]);for(var c=0;c<a;c++)t[l][c]=Kc(e[l][c],r[l][c],n)}return t}function TT(t,e,r,n){for(var i=e.length,a=0;a<i;a++)t[a]=e[a]+r[a]*n;return t}function kG(t,e,r,n){for(var i=e.length,a=i&&e[0].length,l=0;l<i;l++){t[l]||(t[l]=[]);for(var c=0;c<a;c++)t[l][c]=e[l][c]+r[l][c]*n}return t}function nxe(t,e){for(var r=t.length,n=e.length,i=r>n?e:t,a=Math.min(r,n),l=i[a-1]||{color:[0,0,0,0],offset:0},c=a;c<Math.max(r,n);c++)i.push({offset:l.offset,color:l.color.slice()})}function ixe(t,e,r){var n=t,i=e;if(!(!n.push||!i.push)){var a=n.length,l=i.length;if(a!==l){var c=a>l;if(c)n.length=l;else for(var o=a;o<l;o++)n.push(r===1?i[o]:Lk.call(i[o]))}for(var d=n[0]&&n[0].length,o=0;o<n.length;o++)if(r===1)isNaN(n[o])&&(n[o]=i[o]);else for(var g=0;g<d;g++)isNaN(n[o][g])&&(n[o][g]=i[o][g])}}function h1(t){if(Vo(t)){var e=t.length;if(Vo(t[0])){for(var r=[],n=0;n<e;n++)r.push(Lk.call(t[n]));return r}return Lk.call(t)}return t}function NA(t){return t[0]=Math.floor(t[0])||0,t[1]=Math.floor(t[1])||0,t[2]=Math.floor(t[2])||0,t[3]=t[3]==null?1:t[3],"rgba("+t.join(",")+")"}function axe(t){return Vo(t&&t[0])?2:1}var AT=0,VA=1,V2=2,Nx=3,Rk=4,kk=5,OG=6;function zG(t){return t===Rk||t===kk}function CT(t){return t===VA||t===V2}var cx=[0,0,0,0],oxe=function(){function t(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return t.prototype.isFinished=function(){return this._finished},t.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},t.prototype.needsAnimate=function(){return this.keyframes.length>=1},t.prototype.getAdditiveTrack=function(){return this._additiveTrack},t.prototype.addKeyframe=function(e,r,n){this._needsSort=!0;var i=this.keyframes,a=i.length,l=!1,c=OG,o=r;if(Vo(r)){var d=axe(r);c=d,(d===1&&!ii(r[0])||d===2&&!ii(r[0][0]))&&(l=!0)}else if(ii(r)&&!F1(r))c=AT;else if(yr(r))if(!isNaN(+r))c=AT;else{var g=Ks(r);g&&(o=g,c=Nx)}else if(KM(r)){var m=Lt({},o);m.colorStops=Zt(r.colorStops,function(x){return{offset:x.offset,color:Ks(x.color)}}),O2(r)?c=Rk:z2(r)&&(c=kk),o=m}a===0?this.valType=c:(c!==this.valType||c===OG)&&(l=!0),this.discrete=this.discrete||l;var y={time:e,value:o,rawValue:r,percent:0};return n&&(y.easing=n,y.easingFunc=zr(n)?n:u1[n]||Cz(n)),i.push(y),y},t.prototype.prepare=function(e,r){var n=this.keyframes;this._needsSort&&n.sort(function(M,D){return M.time-D.time});for(var i=this.valType,a=n.length,l=n[a-1],c=this.discrete,o=CT(i),d=zG(i),g=0;g<a;g++){var m=n[g],y=m.value,x=l.value;m.percent=m.time/e,c||(o&&g!==a-1?ixe(y,x,i):d&&nxe(y.colorStops,x.colorStops))}if(!c&&i!==kk&&r&&this.needsAnimate()&&r.needsAnimate()&&i===r.valType&&!r._finished){this._additiveTrack=r;for(var A=n[0].value,g=0;g<a;g++)i===AT?n[g].additiveValue=n[g].value-A:i===Nx?n[g].additiveValue=TT([],n[g].value,A,-1):CT(i)&&(n[g].additiveValue=i===VA?TT([],n[g].value,A,-1):kG([],n[g].value,A,-1))}},t.prototype.step=function(e,r){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var n=this._additiveTrack!=null,i=n?"additiveValue":"value",a=this.valType,l=this.keyframes,c=l.length,o=this.propName,d=a===Nx,g,m=this._lastFr,y=Math.min,x,A;if(c===1)x=A=l[0];else{if(r<0)g=0;else if(r<this._lastFrP){var M=y(m+1,c-1);for(g=M;g>=0&&!(l[g].percent<=r);g--);g=y(g,c-2)}else{for(g=m;g<c&&!(l[g].percent>r);g++);g=y(g-1,c-2)}A=l[g+1],x=l[g]}if(x&&A){this._lastFr=g,this._lastFrP=r;var D=A.percent-x.percent,P=D===0?1:y((r-x.percent)/D,1);A.easingFunc&&(P=A.easingFunc(P));var O=n?this._additiveValue:d?cx:e[o];if((CT(a)||d)&&!O&&(O=this._additiveValue=[]),this.discrete)e[o]=P<1?x.rawValue:A.rawValue;else if(CT(a))a===VA?yP(O,x[i],A[i],P):rxe(O,x[i],A[i],P);else if(zG(a)){var z=x[i],V=A[i],H=a===Rk;e[o]={type:H?"linear":"radial",x:Kc(z.x,V.x,P),y:Kc(z.y,V.y,P),colorStops:Zt(z.colorStops,function(X,W){var Y=V.colorStops[W];return{offset:Kc(X.offset,Y.offset,P),color:NA(yP([],X.color,Y.color,P))}}),global:V.global},H?(e[o].x2=Kc(z.x2,V.x2,P),e[o].y2=Kc(z.y2,V.y2,P)):e[o].r=Kc(z.r,V.r,P)}else if(d)yP(O,x[i],A[i],P),n||(e[o]=NA(O));else{var $=Kc(x[i],A[i],P);n?this._additiveValue=$:e[o]=$}n&&this._addToTarget(e)}}},t.prototype._addToTarget=function(e){var r=this.valType,n=this.propName,i=this._additiveValue;r===AT?e[n]=e[n]+i:r===Nx?(Ks(e[n],cx),TT(cx,cx,i,1),e[n]=NA(cx)):r===VA?TT(e[n],e[n],i,1):r===V2&&kG(e[n],e[n],i,1)},t}(),Iz=function(){function t(e,r,n,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=r,r&&i){yz("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=n}return t.prototype.getMaxTime=function(){return this._maxTime},t.prototype.getDelay=function(){return this._delay},t.prototype.getLoop=function(){return this._loop},t.prototype.getTarget=function(){return this._target},t.prototype.changeTarget=function(e){this._target=e},t.prototype.when=function(e,r,n){return this.whenWithKeys(e,r,Hn(r),n)},t.prototype.whenWithKeys=function(e,r,n,i){for(var a=this._tracks,l=0;l<n.length;l++){var c=n[l],o=a[c];if(!o){o=a[c]=new oxe(c);var d=void 0,g=this._getAdditiveTrack(c);if(g){var m=g.keyframes,y=m[m.length-1];d=y&&y.value,g.valType===Nx&&d&&(d=NA(d))}else d=this._target[c];if(d==null)continue;e>0&&o.addKeyframe(0,h1(d),i),this._trackKeys.push(c)}o.addKeyframe(e,h1(r[c]),i)}return this._maxTime=Math.max(this._maxTime,e),this},t.prototype.pause=function(){this._clip.pause(),this._paused=!0},t.prototype.resume=function(){this._clip.resume(),this._paused=!1},t.prototype.isPaused=function(){return!!this._paused},t.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},t.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var r=e.length,n=0;n<r;n++)e[n].call(this)},t.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,r=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,r)for(var n=0;n<r.length;n++)r[n].call(this)},t.prototype._setTracksFinished=function(){for(var e=this._tracks,r=this._trackKeys,n=0;n<r.length;n++)e[r[n]].setFinished()},t.prototype._getAdditiveTrack=function(e){var r,n=this._additiveAnimators;if(n)for(var i=0;i<n.length;i++){var a=n[i].getTrack(e);a&&(r=a)}return r},t.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var r=this,n=[],i=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var l=this._trackKeys[a],c=this._tracks[l],o=this._getAdditiveTrack(l),d=c.keyframes,g=d.length;if(c.prepare(i,o),c.needsAnimate())if(!this._allowDiscrete&&c.discrete){var m=d[g-1];m&&(r._target[c.propName]=m.rawValue),c.setFinished()}else n.push(c)}if(n.length||this._force){var y=new H0e({life:i,loop:this._loop,delay:this._delay||0,onframe:function(x){r._started=2;var A=r._additiveAnimators;if(A){for(var M=!1,D=0;D<A.length;D++)if(A[D]._clip){M=!0;break}M||(r._additiveAnimators=null)}for(var D=0;D<n.length;D++)n[D].step(r._target,x);var P=r._onframeCbs;if(P)for(var D=0;D<P.length;D++)P[D](r._target,x)},ondestroy:function(){r._doneCallback()}});this._clip=y,this.animation&&this.animation.addClip(y),e&&y.setEasing(e)}else this._doneCallback();return this}},t.prototype.stop=function(e){if(this._clip){var r=this._clip;e&&r.onframe(1),this._abortedCallback()}},t.prototype.delay=function(e){return this._delay=e,this},t.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},t.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},t.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},t.prototype.getClip=function(){return this._clip},t.prototype.getTrack=function(e){return this._tracks[e]},t.prototype.getTracks=function(){var e=this;return Zt(this._trackKeys,function(r){return e._tracks[r]})},t.prototype.stopTracks=function(e,r){if(!e.length||!this._clip)return!0;for(var n=this._tracks,i=this._trackKeys,a=0;a<e.length;a++){var l=n[e[a]];l&&!l.isFinished()&&(r?l.step(this._target,1):this._started===1&&l.step(this._target,0),l.setFinished())}for(var c=!0,a=0;a<i.length;a++)if(!n[i[a]].isFinished()){c=!1;break}return c&&this._abortedCallback(),c},t.prototype.saveTo=function(e,r,n){if(e){r=r||this._trackKeys;for(var i=0;i<r.length;i++){var a=r[i],l=this._tracks[a];if(!(!l||l.isFinished())){var c=l.keyframes,o=c[n?0:c.length-1];o&&(e[a]=h1(o.rawValue))}}}},t.prototype.__changeFinalValue=function(e,r){r=r||Hn(e);for(var n=0;n<r.length;n++){var i=r[n],a=this._tracks[i];if(a){var l=a.keyframes;if(l.length>1){var c=l.pop();a.addKeyframe(c.time,e[i]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},t}();function v_(){return new Date().getTime()}var sxe=function(t){et(e,t);function e(r){var n=t.call(this)||this;return n._running=!1,n._time=0,n._pausedTime=0,n._pauseStart=0,n._paused=!1,r=r||{},n.stage=r.stage||{},n}return e.prototype.addClip=function(r){r.animation&&this.removeClip(r),this._head?(this._tail.next=r,r.prev=this._tail,r.next=null,this._tail=r):this._head=this._tail=r,r.animation=this},e.prototype.addAnimator=function(r){r.animation=this;var n=r.getClip();n&&this.addClip(n)},e.prototype.removeClip=function(r){if(r.animation){var n=r.prev,i=r.next;n?n.next=i:this._head=i,i?i.prev=n:this._tail=n,r.next=r.prev=r.animation=null}},e.prototype.removeAnimator=function(r){var n=r.getClip();n&&this.removeClip(n),r.animation=null},e.prototype.update=function(r){for(var n=v_()-this._pausedTime,i=n-this._time,a=this._head;a;){var l=a.next,c=a.step(n,i);c&&(a.ondestroy(),this.removeClip(a)),a=l}this._time=n,r||(this.trigger("frame",i),this.stage.update&&this.stage.update())},e.prototype._startLoop=function(){var r=this;this._running=!0;function n(){r._running&&(SC(n),!r._paused&&r.update())}SC(n)},e.prototype.start=function(){this._running||(this._time=v_(),this._pausedTime=0,this._startLoop())},e.prototype.stop=function(){this._running=!1},e.prototype.pause=function(){this._paused||(this._pauseStart=v_(),this._paused=!0)},e.prototype.resume=function(){this._paused&&(this._pausedTime+=v_()-this._pauseStart,this._paused=!1)},e.prototype.clear=function(){for(var r=this._head;r;){var n=r.next;r.prev=r.next=r.animation=null,r=n}this._head=this._tail=null},e.prototype.isFinished=function(){return this._head==null},e.prototype.animate=function(r,n){n=n||{},this.start();var i=new Iz(r,n.loop);return this.addAnimator(i),i},e}(Fl),lxe=300,xP=Nn.domSupported,bP=function(){var t=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],e=["touchstart","touchend","touchmove"],r={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},n=Zt(t,function(i){var a=i.replace("mouse","pointer");return r.hasOwnProperty(a)?a:i});return{mouse:t,touch:e,pointer:n}}(),BG={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},FG=!1;function Ok(t){var e=t.pointerType;return e==="pen"||e==="touch"}function uxe(t){t.touching=!0,t.touchTimer!=null&&(clearTimeout(t.touchTimer),t.touchTimer=null),t.touchTimer=setTimeout(function(){t.touching=!1,t.touchTimer=null},700)}function wP(t){t&&(t.zrByTouch=!0)}function cxe(t,e){return xl(t.dom,new hxe(t,e),!0)}function G2(t,e){for(var r=e,n=!1;r&&r.nodeType!==9&&!(n=r.domBelongToZr||r!==e&&r===t.painterRoot);)r=r.parentNode;return n}var hxe=function(){function t(e,r){this.stopPropagation=Sa,this.stopImmediatePropagation=Sa,this.preventDefault=Sa,this.type=r.type,this.target=this.currentTarget=e.dom,this.pointerType=r.pointerType,this.clientX=r.clientX,this.clientY=r.clientY}return t}(),lu={mousedown:function(t){t=xl(this.dom,t),this.__mayPointerCapture=[t.zrX,t.zrY],this.trigger("mousedown",t)},mousemove:function(t){t=xl(this.dom,t);var e=this.__mayPointerCapture;e&&(t.zrX!==e[0]||t.zrY!==e[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",t)},mouseup:function(t){t=xl(this.dom,t),this.__togglePointerCapture(!1),this.trigger("mouseup",t)},mouseout:function(t){t=xl(this.dom,t);var e=t.toElement||t.relatedTarget;G2(this,e)||(this.__pointerCapturing&&(t.zrEventControl="no_globalout"),this.trigger("mouseout",t))},wheel:function(t){FG=!0,t=xl(this.dom,t),this.trigger("mousewheel",t)},mousewheel:function(t){FG||(t=xl(this.dom,t),this.trigger("mousewheel",t))},touchstart:function(t){t=xl(this.dom,t),wP(t),this.__lastTouchMoment=new Date,this.handler.processGesture(t,"start"),lu.mousemove.call(this,t),lu.mousedown.call(this,t)},touchmove:function(t){t=xl(this.dom,t),wP(t),this.handler.processGesture(t,"change"),lu.mousemove.call(this,t)},touchend:function(t){t=xl(this.dom,t),wP(t),this.handler.processGesture(t,"end"),lu.mouseup.call(this,t),+new Date-+this.__lastTouchMoment<lxe&&lu.click.call(this,t)},pointerdown:function(t){lu.mousedown.call(this,t)},pointermove:function(t){Ok(t)||lu.mousemove.call(this,t)},pointerup:function(t){lu.mouseup.call(this,t)},pointerout:function(t){Ok(t)||lu.mouseout.call(this,t)}};fe(["click","dblclick","contextmenu"],function(t){lu[t]=function(e){e=xl(this.dom,e),this.trigger(t,e)}});var zk={pointermove:function(t){Ok(t)||zk.mousemove.call(this,t)},pointerup:function(t){zk.mouseup.call(this,t)},mousemove:function(t){this.trigger("mousemove",t)},mouseup:function(t){var e=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",t),e&&(t.zrEventControl="only_globalout",this.trigger("mouseout",t))}};function fxe(t,e){var r=e.domHandlers;Nn.pointerEventsSupported?fe(bP.pointer,function(n){GA(e,n,function(i){r[n].call(t,i)})}):(Nn.touchEventsSupported&&fe(bP.touch,function(n){GA(e,n,function(i){r[n].call(t,i),uxe(e)})}),fe(bP.mouse,function(n){GA(e,n,function(i){i=Sz(i),e.touching||r[n].call(t,i)})}))}function dxe(t,e){Nn.pointerEventsSupported?fe(BG.pointer,r):Nn.touchEventsSupported||fe(BG.mouse,r);function r(n){function i(a){a=Sz(a),G2(t,a.target)||(a=cxe(t,a),e.domHandlers[n].call(t,a))}GA(e,n,i,{capture:!0})}}function GA(t,e,r,n){t.mounted[e]=r,t.listenerOpts[e]=n,Ak(t.domTarget,e,r,n)}function SP(t){var e=t.mounted;for(var r in e)e.hasOwnProperty(r)&&M0e(t.domTarget,r,e[r],t.listenerOpts[r]);t.mounted={}}var NG=function(){function t(e,r){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=r}return t}(),pxe=function(t){et(e,t);function e(r,n){var i=t.call(this)||this;return i.__pointerCapturing=!1,i.dom=r,i.painterRoot=n,i._localHandlerScope=new NG(r,lu),xP&&(i._globalHandlerScope=new NG(document,zk)),fxe(i,i._localHandlerScope),i}return e.prototype.dispose=function(){SP(this._localHandlerScope),xP&&SP(this._globalHandlerScope)},e.prototype.setCursor=function(r){this.dom.style&&(this.dom.style.cursor=r||"default")},e.prototype.__togglePointerCapture=function(r){if(this.__mayPointerCapture=null,xP&&+this.__pointerCapturing^+r){this.__pointerCapturing=r;var n=this._globalHandlerScope;r?dxe(this,n):SP(n)}},e}(Fl),U2=1;Nn.hasGlobalWindow&&(U2=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var EC=U2,Bk=.4,Fk="#333",Nk="#ccc",gxe="#eee",VG=eI,GG=5e-5;function Up(t){return t>GG||t<-GG}var $p=[],jm=[],TP=Qs(),AP=Math.abs,th=function(){function t(){}return t.prototype.getLocalTransform=function(e){return t.getLocalTransform(this,e)},t.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},t.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},t.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},t.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},t.prototype.needLocalTransform=function(){return Up(this.rotation)||Up(this.x)||Up(this.y)||Up(this.scaleX-1)||Up(this.scaleY-1)||Up(this.skewX)||Up(this.skewY)},t.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,r=this.needLocalTransform(),n=this.transform;if(!(r||e)){n&&(VG(n),this.invTransform=null);return}n=n||Qs(),r?this.getLocalTransform(n):VG(n),e&&(r?oh(n,e,n):Tz(n,e)),this.transform=n,this._resolveGlobalScaleRatio(n)},t.prototype._resolveGlobalScaleRatio=function(e){var r=this.globalScaleRatio;if(r!=null&&r!==1){this.getGlobalScale($p);var n=$p[0]<0?-1:1,i=$p[1]<0?-1:1,a=(($p[0]-n)*r+n)/$p[0]||0,l=(($p[1]-i)*r+i)/$p[1]||0;e[0]*=a,e[1]*=a,e[2]*=l,e[3]*=l}this.invTransform=this.invTransform||Qs(),ay(this.invTransform,e)},t.prototype.getComputedTransform=function(){for(var e=this,r=[];e;)r.push(e),e=e.parent;for(;e=r.pop();)e.updateTransform();return this.transform},t.prototype.setLocalTransform=function(e){if(e){var r=e[0]*e[0]+e[1]*e[1],n=e[2]*e[2]+e[3]*e[3],i=Math.atan2(e[1],e[0]),a=Math.PI/2+i-Math.atan2(e[3],e[2]);n=Math.sqrt(n)*Math.cos(a),r=Math.sqrt(r),this.skewX=a,this.skewY=0,this.rotation=-i,this.x=+e[4],this.y=+e[5],this.scaleX=r,this.scaleY=n,this.originX=0,this.originY=0}},t.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,r=this.transform;e&&e.transform&&(e.invTransform=e.invTransform||Qs(),oh(jm,e.invTransform,r),r=jm);var n=this.originX,i=this.originY;(n||i)&&(TP[4]=n,TP[5]=i,oh(jm,r,TP),jm[4]-=n,jm[5]-=i,r=jm),this.setLocalTransform(r)}},t.prototype.getGlobalScale=function(e){var r=this.transform;return e=e||[],r?(e[0]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),e[1]=Math.sqrt(r[2]*r[2]+r[3]*r[3]),r[0]<0&&(e[0]=-e[0]),r[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},t.prototype.transformCoordToLocal=function(e,r){var n=[e,r],i=this.invTransform;return i&&So(n,n,i),n},t.prototype.transformCoordToGlobal=function(e,r){var n=[e,r],i=this.transform;return i&&So(n,n,i),n},t.prototype.getLineScale=function(){var e=this.transform;return e&&AP(e[0]-1)>1e-10&&AP(e[3]-1)>1e-10?Math.sqrt(AP(e[0]*e[3]-e[2]*e[1])):1},t.prototype.copyTransform=function(e){$2(this,e)},t.getLocalTransform=function(e,r){r=r||[];var n=e.originX||0,i=e.originY||0,a=e.scaleX,l=e.scaleY,c=e.anchorX,o=e.anchorY,d=e.rotation||0,g=e.x,m=e.y,y=e.skewX?Math.tan(e.skewX):0,x=e.skewY?Math.tan(-e.skewY):0;if(n||i||c||o){var A=n+c,M=i+o;r[4]=-A*a-y*M*l,r[5]=-M*l-x*A*a}else r[4]=r[5]=0;return r[0]=a,r[3]=l,r[1]=x*a,r[2]=y*l,d&&hv(r,r,d),r[4]+=n+g,r[5]+=i+m,r},t.initDefaultProps=function(){var e=t.prototype;e.scaleX=e.scaleY=e.globalScaleRatio=1,e.x=e.y=e.originX=e.originY=e.skewX=e.skewY=e.rotation=e.anchorX=e.anchorY=0}(),t}(),fc=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function $2(t,e){for(var r=0;r<fc.length;r++){var n=fc[r];t[n]=e[n]}}var UG={};function Js(t,e){e=e||pd;var r=UG[e];r||(r=UG[e]=new wb(500));var n=r.get(t);return n==null&&(n=gd.measureText(t,e).width,r.put(t,n)),n}function $G(t,e,r,n){var i=Js(t,e),a=rI(e),l=Vx(0,i,r),c=f_(0,a,n),o=new gn(l,c,i,a);return o}function Sb(t,e,r,n){var i=((t||"")+"").split(`
`),a=i.length;if(a===1)return $G(i[0],e,r,n);for(var l=new gn(0,0,0,0),c=0;c<i.length;c++){var o=$G(i[c],e,r,n);c===0?l.copy(o):l.union(o)}return l}function Vx(t,e,r){return r==="right"?t-=e:r==="center"&&(t-=e/2),t}function f_(t,e,r){return r==="middle"?t-=e/2:r==="bottom"&&(t-=e),t}function rI(t){return Js("",t)}function yu(t,e){return typeof t=="string"?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t}function DC(t,e,r){var n=e.position||"inside",i=e.distance!=null?e.distance:5,a=r.height,l=r.width,c=a/2,o=r.x,d=r.y,g="left",m="top";if(n instanceof Array)o+=yu(n[0],r.width),d+=yu(n[1],r.height),g=null,m=null;else switch(n){case"left":o-=i,d+=c,g="right",m="middle";break;case"right":o+=i+l,d+=c,m="middle";break;case"top":o+=l/2,d-=i,g="center",m="bottom";break;case"bottom":o+=l/2,d+=a+i,g="center";break;case"inside":o+=l/2,d+=c,g="center",m="middle";break;case"insideLeft":o+=i,d+=c,m="middle";break;case"insideRight":o+=l-i,d+=c,g="right",m="middle";break;case"insideTop":o+=l/2,d+=i,g="center";break;case"insideBottom":o+=l/2,d+=a-i,g="center",m="bottom";break;case"insideTopLeft":o+=i,d+=i;break;case"insideTopRight":o+=l-i,d+=i,g="right";break;case"insideBottomLeft":o+=i,d+=a-i,m="bottom";break;case"insideBottomRight":o+=l-i,d+=a-i,g="right",m="bottom";break}return t=t||{},t.x=o,t.y=d,t.align=g,t.verticalAlign=m,t}var CP="__zr_normal__",MP=fc.concat(["ignore"]),vxe=cc(fc,function(t,e){return t[e]=!0,t},{ignore:!1}),Wm={},mxe=new gn(0,0,0,0),nI=function(){function t(e){this.id=m2(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return t.prototype._init=function(e){this.attr(e)},t.prototype.drift=function(e,r,n){switch(this.draggable){case"horizontal":r=0;break;case"vertical":e=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=e,i[5]+=r,this.decomposeTransform(),this.markRedraw()},t.prototype.beforeUpdate=function(){},t.prototype.afterUpdate=function(){},t.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},t.prototype.updateInnerText=function(e){var r=this._textContent;if(r&&(!r.ignore||e)){this.textConfig||(this.textConfig={});var n=this.textConfig,i=n.local,a=r.innerTransformable,l=void 0,c=void 0,o=!1;a.parent=i?this:null;var d=!1;if(a.copyTransform(r),n.position!=null){var g=mxe;n.layoutRect?g.copy(n.layoutRect):g.copy(this.getBoundingRect()),i||g.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(Wm,n,g):DC(Wm,n,g),a.x=Wm.x,a.y=Wm.y,l=Wm.align,c=Wm.verticalAlign;var m=n.origin;if(m&&n.rotation!=null){var y=void 0,x=void 0;m==="center"?(y=g.width*.5,x=g.height*.5):(y=yu(m[0],g.width),x=yu(m[1],g.height)),d=!0,a.originX=-a.x+y+(i?0:g.x),a.originY=-a.y+x+(i?0:g.y)}}n.rotation!=null&&(a.rotation=n.rotation);var A=n.offset;A&&(a.x+=A[0],a.y+=A[1],d||(a.originX=-A[0],a.originY=-A[1]));var M=n.inside==null?typeof n.position=="string"&&n.position.indexOf("inside")>=0:n.inside,D=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),P=void 0,O=void 0,z=void 0;M&&this.canBeInsideText()?(P=n.insideFill,O=n.insideStroke,(P==null||P==="auto")&&(P=this.getInsideTextFill()),(O==null||O==="auto")&&(O=this.getInsideTextStroke(P),z=!0)):(P=n.outsideFill,O=n.outsideStroke,(P==null||P==="auto")&&(P=this.getOutsideFill()),(O==null||O==="auto")&&(O=this.getOutsideStroke(P),z=!0)),P=P||"#000",(P!==D.fill||O!==D.stroke||z!==D.autoStroke||l!==D.align||c!==D.verticalAlign)&&(o=!0,D.fill=P,D.stroke=O,D.autoStroke=z,D.align=l,D.verticalAlign=c,r.setDefaultTextStyle(D)),r.__dirty|=Ys,o&&r.dirtyStyle(!0)}},t.prototype.canBeInsideText=function(){return!0},t.prototype.getInsideTextFill=function(){return"#fff"},t.prototype.getInsideTextStroke=function(e){return"#000"},t.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?Nk:Fk},t.prototype.getOutsideStroke=function(e){var r=this.__zr&&this.__zr.getBackgroundColor(),n=typeof r=="string"&&Ks(r);n||(n=[255,255,255,1]);for(var i=n[3],a=this.__zr.isDarkMode(),l=0;l<3;l++)n[l]=n[l]*i+(a?0:255)*(1-i);return n[3]=1,sh(n,"rgba")},t.prototype.traverse=function(e,r){},t.prototype.attrKV=function(e,r){e==="textConfig"?this.setTextConfig(r):e==="textContent"?this.setTextContent(r):e==="clipPath"?this.setClipPath(r):e==="extra"?(this.extra=this.extra||{},Lt(this.extra,r)):this[e]=r},t.prototype.hide=function(){this.ignore=!0,this.markRedraw()},t.prototype.show=function(){this.ignore=!1,this.markRedraw()},t.prototype.attr=function(e,r){if(typeof e=="string")this.attrKV(e,r);else if(Ur(e))for(var n=e,i=Hn(n),a=0;a<i.length;a++){var l=i[a];this.attrKV(l,e[l])}return this.markRedraw(),this},t.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var r=this._normalState,n=0;n<this.animators.length;n++){var i=this.animators[n],a=i.__fromStateTransition;if(!(i.getLoop()||a&&a!==CP)){var l=i.targetName,c=l?r[l]:r;i.saveTo(c)}}},t.prototype._innerSaveToNormal=function(e){var r=this._normalState;r||(r=this._normalState={}),e.textConfig&&!r.textConfig&&(r.textConfig=this.textConfig),this._savePrimaryToNormal(e,r,MP)},t.prototype._savePrimaryToNormal=function(e,r,n){for(var i=0;i<n.length;i++){var a=n[i];e[a]!=null&&!(a in r)&&(r[a]=this[a])}},t.prototype.hasState=function(){return this.currentStates.length>0},t.prototype.getState=function(e){return this.states[e]},t.prototype.ensureState=function(e){var r=this.states;return r[e]||(r[e]={}),r[e]},t.prototype.clearStates=function(e){this.useState(CP,!1,e)},t.prototype.useState=function(e,r,n,i){var a=e===CP,l=this.hasState();if(!(!l&&a)){var c=this.currentStates,o=this.stateTransition;if(!(An(c,e)>=0&&(r||c.length===1))){var d;if(this.stateProxy&&!a&&(d=this.stateProxy(e)),d||(d=this.states&&this.states[e]),!d&&!a){yz("State "+e+" not exists.");return}a||this.saveCurrentToNormalState(d);var g=!!(d&&d.hoverLayer||i);g&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,d,this._normalState,r,!n&&!this.__inHover&&o&&o.duration>0,o);var m=this._textContent,y=this._textGuide;return m&&m.useState(e,r,n,g),y&&y.useState(e,r,n,g),a?(this.currentStates=[],this._normalState={}):r?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!g&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Ys),d}}},t.prototype.useStates=function(e,r,n){if(!e.length)this.clearStates();else{var i=[],a=this.currentStates,l=e.length,c=l===a.length;if(c){for(var o=0;o<l;o++)if(e[o]!==a[o]){c=!1;break}}if(c)return;for(var o=0;o<l;o++){var d=e[o],g=void 0;this.stateProxy&&(g=this.stateProxy(d,e)),g||(g=this.states[d]),g&&i.push(g)}var m=i[l-1],y=!!(m&&m.hoverLayer||n);y&&this._toggleHoverLayerFlag(!0);var x=this._mergeStates(i),A=this.stateTransition;this.saveCurrentToNormalState(x),this._applyStateObj(e.join(","),x,this._normalState,!1,!r&&!this.__inHover&&A&&A.duration>0,A);var M=this._textContent,D=this._textGuide;M&&M.useStates(e,r,y),D&&D.useStates(e,r,y),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!y&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Ys)}},t.prototype.isSilent=function(){for(var e=this.silent,r=this.parent;!e&&r;){if(r.silent){e=!0;break}r=r.parent}return e},t.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var r=this.animators[e];r.targetName&&r.changeTarget(this[r.targetName])}},t.prototype.removeState=function(e){var r=An(this.currentStates,e);if(r>=0){var n=this.currentStates.slice();n.splice(r,1),this.useStates(n)}},t.prototype.replaceState=function(e,r,n){var i=this.currentStates.slice(),a=An(i,e),l=An(i,r)>=0;a>=0?l?i.splice(a,1):i[a]=r:n&&!l&&i.push(r),this.useStates(i)},t.prototype.toggleState=function(e,r){r?this.useState(e,!0):this.removeState(e)},t.prototype._mergeStates=function(e){for(var r={},n,i=0;i<e.length;i++){var a=e[i];Lt(r,a),a.textConfig&&(n=n||{},Lt(n,a.textConfig))}return n&&(r.textConfig=n),r},t.prototype._applyStateObj=function(e,r,n,i,a,l){var c=!(r&&i);r&&r.textConfig?(this.textConfig=Lt({},i?this.textConfig:n.textConfig),Lt(this.textConfig,r.textConfig)):c&&n.textConfig&&(this.textConfig=n.textConfig);for(var o={},d=!1,g=0;g<MP.length;g++){var m=MP[g],y=a&&vxe[m];r&&r[m]!=null?y?(d=!0,o[m]=r[m]):this[m]=r[m]:c&&n[m]!=null&&(y?(d=!0,o[m]=n[m]):this[m]=n[m])}if(!a)for(var g=0;g<this.animators.length;g++){var x=this.animators[g],A=x.targetName;x.getLoop()||x.__changeFinalValue(A?(r||n)[A]:r||n)}d&&this._transitionState(e,o,l)},t.prototype._attachComponent=function(e){if(!(e.__zr&&!e.__hostTarget)&&e!==this){var r=this.__zr;r&&e.addSelfToZr(r),e.__zr=r,e.__hostTarget=this}},t.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},t.prototype.getClipPath=function(){return this._clipPath},t.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},t.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},t.prototype.getTextContent=function(){return this._textContent},t.prototype.setTextContent=function(e){var r=this._textContent;r!==e&&(r&&r!==e&&this.removeTextContent(),e.innerTransformable=new th,this._attachComponent(e),this._textContent=e,this.markRedraw())},t.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),Lt(this.textConfig,e),this.markRedraw()},t.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},t.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},t.prototype.getTextGuideLine=function(){return this._textGuide},t.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},t.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},t.prototype.markRedraw=function(){this.__dirty|=Ys;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},t.prototype.dirty=function(){this.markRedraw()},t.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var r=this._textContent,n=this._textGuide;r&&(r.__inHover=e),n&&(n.__inHover=e)},t.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var r=this.animators;if(r)for(var n=0;n<r.length;n++)e.animation.addAnimator(r[n]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},t.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var r=this.animators;if(r)for(var n=0;n<r.length;n++)e.animation.removeAnimator(r[n]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},t.prototype.animate=function(e,r,n){var i=e?this[e]:this,a=new Iz(i,r,n);return e&&(a.targetName=e),this.addAnimator(a,e),a},t.prototype.addAnimator=function(e,r){var n=this.__zr,i=this;e.during(function(){i.updateDuringAnimation(r)}).done(function(){var a=i.animators,l=An(a,e);l>=0&&a.splice(l,1)}),this.animators.push(e),n&&n.animation.addAnimator(e),n&&n.wakeUp()},t.prototype.updateDuringAnimation=function(e){this.markRedraw()},t.prototype.stopAnimation=function(e,r){for(var n=this.animators,i=n.length,a=[],l=0;l<i;l++){var c=n[l];!e||e===c.scope?c.stop(r):a.push(c)}return this.animators=a,this},t.prototype.animateTo=function(e,r,n){IP(this,e,r,n)},t.prototype.animateFrom=function(e,r,n){IP(this,e,r,n,!0)},t.prototype._transitionState=function(e,r,n,i){for(var a=IP(this,r,n,i),l=0;l<a.length;l++)a[l].__fromStateTransition=e},t.prototype.getBoundingRect=function(){return null},t.prototype.getPaintRect=function(){return null},t.initDefaultProps=function(){var e=t.prototype;e.type="element",e.name="",e.ignore=e.silent=e.isGroup=e.draggable=e.dragging=e.ignoreClip=e.__inHover=!1,e.__dirty=Ys;function r(n,i,a,l){Object.defineProperty(e,n,{get:function(){if(!this[i]){var o=this[i]=[];c(this,o)}return this[i]},set:function(o){this[a]=o[0],this[l]=o[1],this[i]=o,c(this,o)}});function c(o,d){Object.defineProperty(d,0,{get:function(){return o[a]},set:function(g){o[a]=g}}),Object.defineProperty(d,1,{get:function(){return o[l]},set:function(g){o[l]=g}})}}Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),t}();Ea(nI,Fl);Ea(nI,th);function IP(t,e,r,n,i){r=r||{};var a=[];H2(t,"",t,e,r,n,a,i);var l=a.length,c=!1,o=r.done,d=r.aborted,g=function(){c=!0,l--,l<=0&&(c?o&&o():d&&d())},m=function(){l--,l<=0&&(c?o&&o():d&&d())};l||o&&o(),a.length>0&&r.during&&a[0].during(function(A,M){r.during(M)});for(var y=0;y<a.length;y++){var x=a[y];g&&x.done(g),m&&x.aborted(m),r.force&&x.duration(r.duration),x.start(r.easing)}return a}function EP(t,e,r){for(var n=0;n<r;n++)t[n]=e[n]}function _xe(t){return Vo(t[0])}function yxe(t,e,r){if(Vo(e[r]))if(Vo(t[r])||(t[r]=[]),Is(e[r])){var n=e[r].length;t[r].length!==n&&(t[r]=new e[r].constructor(n),EP(t[r],e[r],n))}else{var i=e[r],a=t[r],l=i.length;if(_xe(i))for(var c=i[0].length,o=0;o<l;o++)a[o]?EP(a[o],i[o],c):a[o]=Array.prototype.slice.call(i[o]);else EP(a,i,l);a.length=i.length}else t[r]=e[r]}function xxe(t,e){return t===e||Vo(t)&&Vo(e)&&bxe(t,e)}function bxe(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function H2(t,e,r,n,i,a,l,c){for(var o=Hn(n),d=i.duration,g=i.delay,m=i.additive,y=i.setToFinal,x=!Ur(a),A=t.animators,M=[],D=0;D<o.length;D++){var P=o[D],O=n[P];if(O!=null&&r[P]!=null&&(x||a[P]))if(Ur(O)&&!Vo(O)&&!KM(O)){if(e){c||(r[P]=O,t.updateDuringAnimation(e));continue}H2(t,P,r[P],O,i,a&&a[P],l,c)}else M.push(P);else c||(r[P]=O,t.updateDuringAnimation(e),M.push(P))}var z=M.length;if(!m&&z)for(var V=0;V<A.length;V++){var H=A[V];if(H.targetName===e){var $=H.stopTracks(M);if($){var X=An(A,H);A.splice(X,1)}}}if(i.force||(M=Ei(M,function(re){return!xxe(n[re],r[re])}),z=M.length),z>0||i.force&&!l.length){var W=void 0,Y=void 0,J=void 0;if(c){Y={},y&&(W={});for(var V=0;V<z;V++){var P=M[V];Y[P]=r[P],y?W[P]=n[P]:r[P]=n[P]}}else if(y){J={};for(var V=0;V<z;V++){var P=M[V];J[P]=h1(r[P]),yxe(r,n,P)}}var H=new Iz(r,!1,!1,m?Ei(A,function(ae){return ae.targetName===e}):null);H.targetName=e,i.scope&&(H.scope=i.scope),y&&W&&H.whenWithKeys(0,W,M),J&&H.whenWithKeys(0,J,M),H.whenWithKeys(d??500,c?Y:n,M).delay(g||0),t.addAnimator(H,e),l.push(H)}}var jr=function(t){et(e,t);function e(r){var n=t.call(this)||this;return n.isGroup=!0,n._children=[],n.attr(r),n}return e.prototype.childrenRef=function(){return this._children},e.prototype.children=function(){return this._children.slice()},e.prototype.childAt=function(r){return this._children[r]},e.prototype.childOfName=function(r){for(var n=this._children,i=0;i<n.length;i++)if(n[i].name===r)return n[i]},e.prototype.childCount=function(){return this._children.length},e.prototype.add=function(r){return r&&r!==this&&r.parent!==this&&(this._children.push(r),this._doAdd(r)),this},e.prototype.addBefore=function(r,n){if(r&&r!==this&&r.parent!==this&&n&&n.parent===this){var i=this._children,a=i.indexOf(n);a>=0&&(i.splice(a,0,r),this._doAdd(r))}return this},e.prototype.replace=function(r,n){var i=An(this._children,r);return i>=0&&this.replaceAt(n,i),this},e.prototype.replaceAt=function(r,n){var i=this._children,a=i[n];if(r&&r!==this&&r.parent!==this&&r!==a){i[n]=r,a.parent=null;var l=this.__zr;l&&a.removeSelfFromZr(l),this._doAdd(r)}return this},e.prototype._doAdd=function(r){r.parent&&r.parent.remove(r),r.parent=this;var n=this.__zr;n&&n!==r.__zr&&r.addSelfToZr(n),n&&n.refresh()},e.prototype.remove=function(r){var n=this.__zr,i=this._children,a=An(i,r);return a<0?this:(i.splice(a,1),r.parent=null,n&&r.removeSelfFromZr(n),n&&n.refresh(),this)},e.prototype.removeAll=function(){for(var r=this._children,n=this.__zr,i=0;i<r.length;i++){var a=r[i];n&&a.removeSelfFromZr(n),a.parent=null}return r.length=0,this},e.prototype.eachChild=function(r,n){for(var i=this._children,a=0;a<i.length;a++){var l=i[a];r.call(n,l,a)}return this},e.prototype.traverse=function(r,n){for(var i=0;i<this._children.length;i++){var a=this._children[i],l=r.call(n,a);a.isGroup&&!l&&a.traverse(r,n)}return this},e.prototype.addSelfToZr=function(r){t.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.addSelfToZr(r)}},e.prototype.removeSelfFromZr=function(r){t.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.removeSelfFromZr(r)}},e.prototype.getBoundingRect=function(r){for(var n=new gn(0,0,0,0),i=r||this._children,a=[],l=null,c=0;c<i.length;c++){var o=i[c];if(!(o.ignore||o.invisible)){var d=o.getBoundingRect(),g=o.getLocalTransform(a);g?(gn.applyTransform(n,d,g),l=l||n.clone(),l.union(n)):(l=l||d.clone(),l.union(d))}}return l||n},e}(nI);jr.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var UA={},j2={};function wxe(t){delete j2[t]}function Sxe(t){if(!t)return!1;if(typeof t=="string")return MC(t,1)<Bk;if(t.colorStops){for(var e=t.colorStops,r=0,n=e.length,i=0;i<n;i++)r+=MC(e[i].color,1);return r/=n,r<Bk}return!1}var Txe=function(){function t(e,r,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=r,this.id=e;var a=new N0e,l=n.renderer||"canvas";UA[l]||(l=Hn(UA)[0]),n.useDirtyRect=n.useDirtyRect==null?!1:n.useDirtyRect;var c=new UA[l](r,a,n,e),o=n.ssr||c.ssrOnly;this.storage=a,this.painter=c;var d=!Nn.node&&!Nn.worker&&!o?new pxe(c.getViewportRoot(),c.root):null,g=n.useCoarsePointer,m=g==null||g==="auto"?Nn.touchEventsSupported:!!g,y=44,x;m&&(x=tn(n.pointerSize,y)),this.handler=new S2(a,c,d,c.root,x),this.animation=new sxe({stage:{update:o?null:function(){return i._flush(!0)}}}),o||this.animation.start()}return t.prototype.add=function(e){this._disposed||!e||(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},t.prototype.remove=function(e){this._disposed||!e||(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},t.prototype.configLayer=function(e,r){this._disposed||(this.painter.configLayer&&this.painter.configLayer(e,r),this.refresh())},t.prototype.setBackgroundColor=function(e){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=Sxe(e))},t.prototype.getBackgroundColor=function(){return this._backgroundColor},t.prototype.setDarkMode=function(e){this._darkMode=e},t.prototype.isDarkMode=function(){return this._darkMode},t.prototype.refreshImmediately=function(e){this._disposed||(e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},t.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},t.prototype.flush=function(){this._disposed||this._flush(!1)},t.prototype._flush=function(e){var r,n=v_();this._needsRefresh&&(r=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var i=v_();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},t.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},t.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},t.prototype.refreshHover=function(){this._needsRefreshHover=!0},t.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},t.prototype.resize=function(e){this._disposed||(e=e||{},this.painter.resize(e.width,e.height),this.handler.resize())},t.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},t.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},t.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},t.prototype.setCursorStyle=function(e){this._disposed||this.handler.setCursorStyle(e)},t.prototype.findHover=function(e,r){if(!this._disposed)return this.handler.findHover(e,r)},t.prototype.on=function(e,r,n){return this._disposed||this.handler.on(e,r,n),this},t.prototype.off=function(e,r){this._disposed||this.handler.off(e,r)},t.prototype.trigger=function(e,r){this._disposed||this.handler.trigger(e,r)},t.prototype.clear=function(){if(!this._disposed){for(var e=this.storage.getRoots(),r=0;r<e.length;r++)e[r]instanceof jr&&e[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},t.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,wxe(this.id))},t}();function HG(t,e){var r=new Txe(m2(),t,e);return j2[r.id]=r,r}function Axe(t,e){UA[t]=e}var Vk;function Cxe(t){if(typeof Vk=="function")return Vk(t)}function Mxe(t){Vk=t}var jG=1e-4,W2=20;function Ixe(t){return t.replace(/^\s+|\s+$/g,"")}function Ci(t,e,r,n){var i=e[0],a=e[1],l=r[0],c=r[1],o=a-i,d=c-l;if(o===0)return d===0?l:(l+c)/2;if(n)if(o>0){if(t<=i)return l;if(t>=a)return c}else{if(t>=i)return l;if(t<=a)return c}else{if(t===i)return l;if(t===a)return c}return(t-i)/o*d+l}function dr(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%";break}return yr(t)?Ixe(t).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):t==null?NaN:+t}function ma(t,e,r){return e==null&&(e=10),e=Math.min(Math.max(0,e),W2),t=(+t).toFixed(e),r?t:+t}function El(t){return t.sort(function(e,r){return e-r}),t}function Ju(t){if(t=+t,isNaN(t))return 0;if(t>1e-14){for(var e=1,r=0;r<15;r++,e*=10)if(Math.round(t*e)/e===t)return r}return Exe(t)}function Exe(t){var e=t.toString().toLowerCase(),r=e.indexOf("e"),n=r>0?+e.slice(r+1):0,i=r>0?r:e.length,a=e.indexOf("."),l=a<0?0:i-1-a;return Math.max(0,l-n)}function Z2(t,e){var r=Math.log,n=Math.LN10,i=Math.floor(r(t[1]-t[0])/n),a=Math.round(r(Math.abs(e[1]-e[0]))/n),l=Math.min(Math.max(-i+a,0),20);return isFinite(l)?l:20}function Dxe(t,e){var r=cc(t,function(x,A){return x+(isNaN(A)?0:A)},0);if(r===0)return[];for(var n=Math.pow(10,e),i=Zt(t,function(x){return(isNaN(x)?0:x)/r*n*100}),a=n*100,l=Zt(i,function(x){return Math.floor(x)}),c=cc(l,function(x,A){return x+A},0),o=Zt(i,function(x,A){return x-l[A]});c<a;){for(var d=Number.NEGATIVE_INFINITY,g=null,m=0,y=o.length;m<y;++m)o[m]>d&&(d=o[m],g=m);++l[g],o[g]=0,++c}return Zt(l,function(x){return x/n})}function Pxe(t,e){var r=Math.max(Ju(t),Ju(e)),n=t+e;return r>W2?n:ma(n,r)}var WG=9007199254740991;function q2(t){var e=Math.PI*2;return(t%e+e)%e}function U1(t){return t>-jG&&t<jG}var Lxe=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function dc(t){if(t instanceof Date)return t;if(yr(t)){var e=Lxe.exec(t);if(!e)return new Date(NaN);if(e[8]){var r=+e[4]||0;return e[8].toUpperCase()!=="Z"&&(r-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,r,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}else return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}else if(t==null)return new Date(NaN);return new Date(Math.round(t))}function Rxe(t){return Math.pow(10,Ez(t))}function Ez(t){if(t===0)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return t/Math.pow(10,e)>=10&&e++,e}function Y2(t,e){var r=Ez(t),n=Math.pow(10,r),i=t/n,a;return i<1.5?a=1:i<2.5?a=2:i<4?a=3:i<7?a=5:a=10,t=a*n,r>=-20?+t.toFixed(r<0?-r:0):t}function DP(t,e){var r=(t.length-1)*e+1,n=Math.floor(r),i=+t[n-1],a=r-n;return a?i+a*(t[n]-i):i}function ZG(t){t.sort(function(o,d){return c(o,d,0)?-1:1});for(var e=-1/0,r=1,n=0;n<t.length;){for(var i=t[n].interval,a=t[n].close,l=0;l<2;l++)i[l]<=e&&(i[l]=e,a[l]=l?1:1-r),e=i[l],r=a[l];i[0]===i[1]&&a[0]*a[1]!==1?t.splice(n,1):n++}return t;function c(o,d,g){return o.interval[g]<d.interval[g]||o.interval[g]===d.interval[g]&&(o.close[g]-d.close[g]===(g?-1:1)||!g&&c(o,d,1))}}function ph(t){var e=parseFloat(t);return e==t&&(e!==0||!yr(t)||t.indexOf("x")<=0)?e:NaN}function X2(t){return!isNaN(ph(t))}function Q2(){return Math.round(Math.random()*9)}function K2(t,e){return e===0?t:K2(e,t%e)}function qG(t,e){return t==null?e:e==null?t:t*e/K2(t,e)}function vi(t){throw new Error(t)}function YG(t,e,r){return(e-t)*r+t}var J2="series\0",eY="\0_ec_\0";function Pi(t){return t instanceof Array?t:t==null?[]:[t]}function Jg(t,e,r){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var n=0,i=r.length;n<i;n++){var a=r[n];!t.emphasis[e].hasOwnProperty(a)&&t[e].hasOwnProperty(a)&&(t.emphasis[e][a]=t[e][a])}}}var XG=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function oy(t){return Ur(t)&&!Ht(t)&&!(t instanceof Date)?t.value:t}function kxe(t){return Ur(t)&&!(t instanceof Array)}function tY(t,e,r){var n=r==="normalMerge",i=r==="replaceMerge",a=r==="replaceAll";t=t||[],e=(e||[]).slice();var l=Ir();fe(e,function(o,d){if(!Ur(o)){e[d]=null;return}});var c=Oxe(t,l,r);return(n||i)&&zxe(c,t,l,e),n&&Bxe(c,e),n||i?Fxe(c,e,i):a&&Nxe(c,e),Vxe(c),c}function Oxe(t,e,r){var n=[];if(r==="replaceAll")return n;for(var i=0;i<t.length;i++){var a=t[i];a&&a.id!=null&&e.set(a.id,i),n.push({existing:r==="replaceMerge"||$1(a)?null:a,newOption:null,keyInfo:null,brandNew:null})}return n}function zxe(t,e,r,n){fe(n,function(i,a){if(!(!i||i.id==null)){var l=f1(i.id),c=r.get(l);if(c!=null){var o=t[c];ns(!o.newOption,'Duplicated option on id "'+l+'".'),o.newOption=i,o.existing=e[c],n[a]=null}}})}function Bxe(t,e){fe(e,function(r,n){if(!(!r||r.name==null))for(var i=0;i<t.length;i++){var a=t[i].existing;if(!t[i].newOption&&a&&(a.id==null||r.id==null)&&!$1(r)&&!$1(a)&&rY("name",a,r)){t[i].newOption=r,e[n]=null;return}}})}function Fxe(t,e,r){fe(e,function(n){if(n){for(var i,a=0;(i=t[a])&&(i.newOption||$1(i.existing)||i.existing&&n.id!=null&&!rY("id",n,i.existing));)a++;i?(i.newOption=n,i.brandNew=r):t.push({newOption:n,brandNew:r,existing:null,keyInfo:null}),a++}})}function Nxe(t,e){fe(e,function(r){t.push({newOption:r,brandNew:!0,existing:null,keyInfo:null})})}function Vxe(t){var e=Ir();fe(t,function(r){var n=r.existing;n&&e.set(n.id,r)}),fe(t,function(r){var n=r.newOption;ns(!n||n.id==null||!e.get(n.id)||e.get(n.id)===r,"id duplicates: "+(n&&n.id)),n&&n.id!=null&&e.set(n.id,r),!r.keyInfo&&(r.keyInfo={})}),fe(t,function(r,n){var i=r.existing,a=r.newOption,l=r.keyInfo;if(Ur(a)){if(l.name=a.name!=null?f1(a.name):i?i.name:J2+n,i)l.id=f1(i.id);else if(a.id!=null)l.id=f1(a.id);else{var c=0;do l.id="\0"+l.name+"\0"+c++;while(e.get(l.id))}e.set(l.id,r)}})}function rY(t,e,r){var n=za(e[t],null),i=za(r[t],null);return n!=null&&i!=null&&n===i}function f1(t){return za(t,"")}function za(t,e){return t==null?e:yr(t)?t:ii(t)||_k(t)?t+"":e}function Dz(t){var e=t.name;return!!(e&&e.indexOf(J2))}function $1(t){return t&&t.id!=null&&f1(t.id).indexOf(eY)===0}function Gxe(t){return eY+t}function Uxe(t,e,r){fe(t,function(n){var i=n.newOption;Ur(i)&&(n.keyInfo.mainType=e,n.keyInfo.subType=$xe(e,i,n.existing,r))})}function $xe(t,e,r,n){var i=e.type?e.type:r?r.subType:n.determineSubType(t,e);return i}function Hxe(t,e){var r={},n={};return i(t||[],r),i(e||[],n,r),[a(r),a(n)];function i(l,c,o){for(var d=0,g=l.length;d<g;d++){var m=za(l[d].seriesId,null);if(m==null)return;for(var y=Pi(l[d].dataIndex),x=o&&o[m],A=0,M=y.length;A<M;A++){var D=y[A];x&&x[D]?x[D]=null:(c[m]||(c[m]={}))[D]=1}}}function a(l,c){var o=[];for(var d in l)if(l.hasOwnProperty(d)&&l[d]!=null)if(c)o.push(+d);else{var g=a(l[d],!0);g.length&&o.push({seriesId:d,dataIndex:g})}return o}}function ev(t,e){if(e.dataIndexInside!=null)return e.dataIndexInside;if(e.dataIndex!=null)return Ht(e.dataIndex)?Zt(e.dataIndex,function(r){return t.indexOfRawIndex(r)}):t.indexOfRawIndex(e.dataIndex);if(e.name!=null)return Ht(e.name)?Zt(e.name,function(r){return t.indexOfName(r)}):t.indexOfName(e.name)}function ri(){var t="__ec_inner_"+jxe++;return function(e){return e[t]||(e[t]={})}}var jxe=Q2();function d1(t,e,r){var n=Pz(e,r),i=n.mainTypeSpecified,a=n.queryOptionMap,l=n.others,c=l,o=r?r.defaultMainType:null;return!i&&o&&a.set(o,{}),a.each(function(d,g){var m=Tb(t,g,d,{useDefault:o===g,enableAll:r&&r.enableAll!=null?r.enableAll:!0,enableNone:r&&r.enableNone!=null?r.enableNone:!0});c[g+"Models"]=m.models,c[g+"Model"]=m.models[0]}),c}function Pz(t,e){var r;if(yr(t)){var n={};n[t+"Index"]=0,r=n}else r=t;var i=Ir(),a={},l=!1;return fe(r,function(c,o){if(o==="dataIndex"||o==="dataIndexInside"){a[o]=c;return}var d=o.match(/^(\w+)(Index|Id|Name)$/)||[],g=d[1],m=(d[2]||"").toLowerCase();if(!(!g||!m||e&&e.includeMainTypes&&An(e.includeMainTypes,g)<0)){l=l||!!g;var y=i.get(g)||i.set(g,{});y[m]=c}}),{mainTypeSpecified:l,queryOptionMap:i,others:a}}var Ma={useDefault:!0,enableAll:!1,enableNone:!1},Wxe={useDefault:!1,enableAll:!0,enableNone:!0};function Tb(t,e,r,n){n=n||Ma;var i=r.index,a=r.id,l=r.name,c={models:null,specified:i!=null||a!=null||l!=null};if(!c.specified){var o=void 0;return c.models=n.useDefault&&(o=t.getComponent(e))?[o]:[],c}return i==="none"||i===!1?(ns(n.enableNone,'`"none"` or `false` is not a valid value on index option.'),c.models=[],c):(i==="all"&&(ns(n.enableAll,'`"all"` is not a valid value on index option.'),i=a=l=null),c.models=t.queryComponents({mainType:e,index:i,id:a,name:l}),c)}function nY(t,e,r){t.setAttribute?t.setAttribute(e,r):t[e]=r}function Zxe(t,e){return t.getAttribute?t.getAttribute(e):t[e]}function qxe(t){return t==="auto"?Nn.domSupported?"html":"richText":t||"html"}function Gk(t,e){var r=Ir(),n=[];return fe(t,function(i){var a=e(i);(r.get(a)||(n.push(a),r.set(a,[]))).push(i)}),{keys:n,buckets:r}}function iY(t,e,r,n,i){var a=e==null||e==="auto";if(n==null)return n;if(ii(n)){var l=YG(r||0,n,i);return ma(l,a?Math.max(Ju(r||0),Ju(n)):e)}else{if(yr(n))return i<1?r:n;for(var c=[],o=r,d=n,g=Math.max(o?o.length:0,d.length),m=0;m<g;++m){var y=t.getDimensionInfo(m);if(y&&y.type==="ordinal")c[m]=(i<1&&o?o:d)[m];else{var x=o&&o[m]?o[m]:0,A=d[m],l=YG(x,A,i);c[m]=ma(l,a?Math.max(Ju(x),Ju(A)):e)}}return c}}var Yxe=".",Hp="___EC__COMPONENT__CONTAINER___",aY="___EC__EXTENDED_CLASS___";function ec(t){var e={main:"",sub:""};if(t){var r=t.split(Yxe);e.main=r[0]||"",e.sub=r[1]||""}return e}function Xxe(t){ns(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(t),'componentType "'+t+'" illegal')}function Qxe(t){return!!(t&&t[aY])}function Lz(t,e){t.$constructor=t,t.extend=function(r){var n=this,i;return Kxe(n)?i=function(a){et(l,a);function l(){return a.apply(this,arguments)||this}return l}(n):(i=function(){(r.$constructor||n).apply(this,arguments)},o0e(i,this)),Lt(i.prototype,r),i[aY]=!0,i.extend=this.extend,i.superCall=t1e,i.superApply=r1e,i.superClass=n,i}}function Kxe(t){return zr(t)&&/^class\s/.test(Function.prototype.toString.call(t))}function oY(t,e){t.extend=e.extend}var Jxe=Math.round(Math.random()*10);function e1e(t){var e=["__\0is_clz",Jxe++].join("_");t.prototype[e]=!0,t.isInstance=function(r){return!!(r&&r[e])}}function t1e(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.superClass.prototype[e].apply(t,r)}function r1e(t,e,r){return this.superClass.prototype[e].apply(t,r)}function iI(t){var e={};t.registerClass=function(n){var i=n.type||n.prototype.type;if(i){Xxe(i),n.prototype.type=i;var a=ec(i);if(!a.sub)e[a.main]=n;else if(a.sub!==Hp){var l=r(a);l[a.sub]=n}}return n},t.getClass=function(n,i,a){var l=e[n];if(l&&l[Hp]&&(l=i?l[i]:null),a&&!l)throw new Error(i?"Component "+n+"."+(i||"")+" is used but not imported.":n+".type should be specified.");return l},t.getClassesByMainType=function(n){var i=ec(n),a=[],l=e[i.main];return l&&l[Hp]?fe(l,function(c,o){o!==Hp&&a.push(c)}):a.push(l),a},t.hasClass=function(n){var i=ec(n);return!!e[i.main]},t.getAllClassMainTypes=function(){var n=[];return fe(e,function(i,a){n.push(a)}),n},t.hasSubTypes=function(n){var i=ec(n),a=e[i.main];return a&&a[Hp]};function r(n){var i=e[n.main];return(!i||!i[Hp])&&(i=e[n.main]={},i[Hp]=!0),i}}function tv(t,e){for(var r=0;r<t.length;r++)t[r][1]||(t[r][1]=t[r][0]);return e=e||!1,function(n,i,a){for(var l={},c=0;c<t.length;c++){var o=t[c][1];if(!(i&&An(i,o)>=0||a&&An(a,o)<0)){var d=n.getShallow(o,e);d!=null&&(l[t[c][0]]=d)}}return l}}var n1e=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],i1e=tv(n1e),a1e=function(){function t(){}return t.prototype.getAreaStyle=function(e,r){return i1e(this,e,r)},t}(),Uk=new wb(50);function o1e(t){if(typeof t=="string"){var e=Uk.get(t);return e&&e.image}else return t}function Rz(t,e,r,n,i){if(t)if(typeof t=="string"){if(e&&e.__zrImageSrc===t||!r)return e;var a=Uk.get(t),l={hostEl:r,cb:n,cbPayload:i};return a?(e=a.image,!aI(e)&&a.pending.push(l)):(e=gd.loadImage(t,QG,QG),e.__zrImageSrc=t,Uk.put(t,e.__cachedImgObj={image:e,pending:[l]})),e}else return t;else return e}function QG(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var r=t.pending[e],n=r.cb;n&&n(this,r.cbPayload),r.hostEl.dirty()}t.pending.length=0}function aI(t){return t&&t.width&&t.height}var PP=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function s1e(t,e,r,n,i){if(!e)return"";var a=(t+"").split(`
`);i=sY(e,r,n,i);for(var l=0,c=a.length;l<c;l++)a[l]=lY(a[l],i);return a.join(`
`)}function sY(t,e,r,n){n=n||{};var i=Lt({},n);i.font=e,r=tn(r,"..."),i.maxIterations=tn(n.maxIterations,2);var a=i.minChar=tn(n.minChar,0);i.cnCharWidth=Js("",e);var l=i.ascCharWidth=Js("a",e);i.placeholder=tn(n.placeholder,"");for(var c=t=Math.max(0,t-1),o=0;o<a&&c>=l;o++)c-=l;var d=Js(r,e);return d>c&&(r="",d=0),c=t-d,i.ellipsis=r,i.ellipsisWidth=d,i.contentWidth=c,i.containerWidth=t,i}function lY(t,e){var r=e.containerWidth,n=e.font,i=e.contentWidth;if(!r)return"";var a=Js(t,n);if(a<=r)return t;for(var l=0;;l++){if(a<=i||l>=e.maxIterations){t+=e.ellipsis;break}var c=l===0?l1e(t,i,e.ascCharWidth,e.cnCharWidth):a>0?Math.floor(t.length*i/a):0;t=t.substr(0,c),a=Js(t,n)}return t===""&&(t=e.placeholder),t}function l1e(t,e,r,n){for(var i=0,a=0,l=t.length;a<l&&i<e;a++){var c=t.charCodeAt(a);i+=0<=c&&c<=127?r:n}return a}function u1e(t,e){t!=null&&(t+="");var r=e.overflow,n=e.padding,i=e.font,a=r==="truncate",l=rI(i),c=tn(e.lineHeight,l),o=!!e.backgroundColor,d=e.lineOverflow==="truncate",g=e.width,m;g!=null&&(r==="break"||r==="breakAll")?m=t?uY(t,e.font,g,r==="breakAll",0).lines:[]:m=t?t.split(`
`):[];var y=m.length*c,x=tn(e.height,y);if(y>x&&d){var A=Math.floor(x/c);m=m.slice(0,A)}if(t&&a&&g!=null)for(var M=sY(g,i,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),D=0;D<m.length;D++)m[D]=lY(m[D],M);for(var P=x,O=0,D=0;D<m.length;D++)O=Math.max(Js(m[D],i),O);g==null&&(g=O);var z=O;return n&&(P+=n[0]+n[2],z+=n[1]+n[3],g+=n[1]+n[3]),o&&(z=g),{lines:m,height:x,outerWidth:z,outerHeight:P,lineHeight:c,calculatedLineHeight:l,contentWidth:O,contentHeight:y,width:g}}var c1e=function(){function t(){}return t}(),KG=function(){function t(e){this.tokens=[],e&&(this.tokens=e)}return t}(),h1e=function(){function t(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return t}();function f1e(t,e){var r=new h1e;if(t!=null&&(t+=""),!t)return r;for(var n=e.width,i=e.height,a=e.overflow,l=(a==="break"||a==="breakAll")&&n!=null?{width:n,accumWidth:0,breakAll:a==="breakAll"}:null,c=PP.lastIndex=0,o;(o=PP.exec(t))!=null;){var d=o.index;d>c&&LP(r,t.substring(c,d),e,l),LP(r,o[2],e,l,o[1]),c=PP.lastIndex}c<t.length&&LP(r,t.substring(c,t.length),e,l);var g=[],m=0,y=0,x=e.padding,A=a==="truncate",M=e.lineOverflow==="truncate";function D(Le,Ee,Ue){Le.width=Ee,Le.lineHeight=Ue,m+=Ue,y=Math.max(y,Ee)}e:for(var P=0;P<r.lines.length;P++){for(var O=r.lines[P],z=0,V=0,H=0;H<O.tokens.length;H++){var $=O.tokens[H],X=$.styleName&&e.rich[$.styleName]||{},W=$.textPadding=X.padding,Y=W?W[1]+W[3]:0,J=$.font=X.font||e.font;$.contentHeight=rI(J);var re=tn(X.height,$.contentHeight);if($.innerHeight=re,W&&(re+=W[0]+W[2]),$.height=re,$.lineHeight=ac(X.lineHeight,e.lineHeight,re),$.align=X&&X.align||e.align,$.verticalAlign=X&&X.verticalAlign||"middle",M&&i!=null&&m+$.lineHeight>i){H>0?(O.tokens=O.tokens.slice(0,H),D(O,V,z),r.lines=r.lines.slice(0,P+1)):r.lines=r.lines.slice(0,P);break e}var ae=X.width,pe=ae==null||ae==="auto";if(typeof ae=="string"&&ae.charAt(ae.length-1)==="%")$.percentWidth=ae,g.push($),$.contentWidth=Js($.text,J);else{if(pe){var de=X.backgroundColor,ve=de&&de.image;ve&&(ve=o1e(ve),aI(ve)&&($.width=Math.max($.width,ve.width*re/ve.height)))}var me=A&&n!=null?n-V:null;me!=null&&me<$.width?!pe||me<Y?($.text="",$.width=$.contentWidth=0):($.text=s1e($.text,me-Y,J,e.ellipsis,{minChar:e.truncateMinChar}),$.width=$.contentWidth=Js($.text,J)):$.contentWidth=Js($.text,J)}$.width+=Y,V+=$.width,X&&(z=Math.max(z,$.lineHeight))}D(O,V,z)}r.outerWidth=r.width=tn(n,y),r.outerHeight=r.height=tn(i,m),r.contentHeight=m,r.contentWidth=y,x&&(r.outerWidth+=x[1]+x[3],r.outerHeight+=x[0]+x[2]);for(var P=0;P<g.length;P++){var $=g[P],Ie=$.percentWidth;$.width=parseInt(Ie,10)/100*r.width}return r}function LP(t,e,r,n,i){var a=e==="",l=i&&r.rich[i]||{},c=t.lines,o=l.font||r.font,d=!1,g,m;if(n){var y=l.padding,x=y?y[1]+y[3]:0;if(l.width!=null&&l.width!=="auto"){var A=yu(l.width,n.width)+x;c.length>0&&A+n.accumWidth>n.width&&(g=e.split(`
`),d=!0),n.accumWidth=A}else{var M=uY(e,o,n.width,n.breakAll,n.accumWidth);n.accumWidth=M.accumWidth+x,m=M.linesWidths,g=M.lines}}else g=e.split(`
`);for(var D=0;D<g.length;D++){var P=g[D],O=new c1e;if(O.styleName=i,O.text=P,O.isLineHolder=!P&&!a,typeof l.width=="number"?O.width=l.width:O.width=m?m[D]:Js(P,o),!D&&!d){var z=(c[c.length-1]||(c[0]=new KG)).tokens,V=z.length;V===1&&z[0].isLineHolder?z[0]=O:(P||!V||a)&&z.push(O)}else c.push(new KG([O]))}}function d1e(t){var e=t.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}var p1e=cc(",&?/;] ".split(""),function(t,e){return t[e]=!0,t},{});function g1e(t){return d1e(t)?!!p1e[t]:!0}function uY(t,e,r,n,i){for(var a=[],l=[],c="",o="",d=0,g=0,m=0;m<t.length;m++){var y=t.charAt(m);if(y===`
`){o&&(c+=o,g+=d),a.push(c),l.push(g),c="",o="",d=0,g=0;continue}var x=Js(y,e),A=n?!1:!g1e(y);if(a.length?g+x>r:i+g+x>r){g?(c||o)&&(A?(c||(c=o,o="",d=0,g=d),a.push(c),l.push(g-d),o+=y,d+=x,c="",g=d):(o&&(c+=o,o="",d=0),a.push(c),l.push(g),c=y,g=x)):A?(a.push(o),l.push(d),o=y,d=x):(a.push(y),l.push(x));continue}g+=x,A?(o+=y,d+=x):(o&&(c+=o,o="",d=0),c+=y)}return!a.length&&!c&&(c=t,o="",d=0),o&&(c+=o),c&&(a.push(c),l.push(g)),a.length===1&&(g+=i),{accumWidth:g,lines:a,linesWidths:l}}var $k="__zr_style_"+Math.round(Math.random()*10),Ng={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},oI={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};Ng[$k]=!0;var JG=["z","z2","invisible"],v1e=["invisible"],zl=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype._init=function(r){for(var n=Hn(r),i=0;i<n.length;i++){var a=n[i];a==="style"?this.useStyle(r[a]):t.prototype.attrKV.call(this,a,r[a])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(r,n,i,a){var l=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&m1e(this,r,n)||l&&!l[0]&&!l[3])return!1;if(i&&this.__clipPaths){for(var c=0;c<this.__clipPaths.length;++c)if(this.__clipPaths[c].isZeroArea())return!1}if(a&&this.parent)for(var o=this.parent;o;){if(o.ignore)return!1;o=o.parent}return!0},e.prototype.contain=function(r,n){return this.rectContain(r,n)},e.prototype.traverse=function(r,n){r.call(n,this)},e.prototype.rectContain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();return a.contain(i[0],i[1])},e.prototype.getPaintRect=function(){var r=this._paintRect;if(!this._paintRect||this.__dirty){var n=this.transform,i=this.getBoundingRect(),a=this.style,l=a.shadowBlur||0,c=a.shadowOffsetX||0,o=a.shadowOffsetY||0;r=this._paintRect||(this._paintRect=new gn(0,0,0,0)),n?gn.applyTransform(r,i,n):r.copy(i),(l||c||o)&&(r.width+=l*2+Math.abs(c),r.height+=l*2+Math.abs(o),r.x=Math.min(r.x,r.x+c-l),r.y=Math.min(r.y,r.y+o-l));var d=this.dirtyRectTolerance;r.isZero()||(r.x=Math.floor(r.x-d),r.y=Math.floor(r.y-d),r.width=Math.ceil(r.width+1+d*2),r.height=Math.ceil(r.height+1+d*2))}return r},e.prototype.setPrevPaintRect=function(r){r?(this._prevPaintRect=this._prevPaintRect||new gn(0,0,0,0),this._prevPaintRect.copy(r)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(r){return this.animate("style",r)},e.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(r,n){r!=="style"?t.prototype.attrKV.call(this,r,n):this.style?this.setStyle(n):this.useStyle(n)},e.prototype.setStyle=function(r,n){return typeof r=="string"?this.style[r]=n:Lt(this.style,r),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(r){r||this.markRedraw(),this.__dirty|=Fx,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(this.__dirty&Fx)},e.prototype.styleUpdated=function(){this.__dirty&=~Fx},e.prototype.createStyle=function(r){return JM(Ng,r)},e.prototype.useStyle=function(r){r[$k]||(r=this.createStyle(r)),this.__inHover?this.__hoverStyle=r:this.style=r,this.dirtyStyle()},e.prototype.isStyleObject=function(r){return r[$k]},e.prototype._innerSaveToNormal=function(r){t.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(r,n,JG)},e.prototype._applyStateObj=function(r,n,i,a,l,c){t.prototype._applyStateObj.call(this,r,n,i,a,l,c);var o=!(n&&a),d;if(n&&n.style?l?a?d=n.style:(d=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(d,n.style)):(d=this._mergeStyle(this.createStyle(),a?this.style:i.style),this._mergeStyle(d,n.style)):o&&(d=i.style),d)if(l){var g=this.style;if(this.style=this.createStyle(o?{}:g),o)for(var m=Hn(g),y=0;y<m.length;y++){var x=m[y];x in d&&(d[x]=d[x],this.style[x]=g[x])}for(var A=Hn(d),y=0;y<A.length;y++){var x=A[y];this.style[x]=this.style[x]}this._transitionState(r,{style:d},c,this.getAnimationStyleProps())}else this.useStyle(d);for(var M=this.__inHover?v1e:JG,y=0;y<M.length;y++){var x=M[y];n&&n[x]!=null?this[x]=n[x]:o&&i[x]!=null&&(this[x]=i[x])}},e.prototype._mergeStates=function(r){for(var n=t.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var l=r[a];l.style&&(i=i||{},this._mergeStyle(i,l.style))}return i&&(n.style=i),n},e.prototype._mergeStyle=function(r,n){return Lt(r,n),r},e.prototype.getAnimationStyleProps=function(){return oI},e.initDefaultProps=function(){var r=e.prototype;r.type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,r.__dirty=Ys|Fx}(),e}(nI),RP=new gn(0,0,0,0),kP=new gn(0,0,0,0);function m1e(t,e,r){return RP.copy(t.getBoundingRect()),t.transform&&RP.applyTransform(t.transform),kP.width=e,kP.height=r,!RP.intersect(kP)}var xs=Math.min,bs=Math.max,OP=Math.sin,zP=Math.cos,jp=Math.PI*2,MT=cv(),IT=cv(),ET=cv();function sI(t,e,r){if(t.length!==0){for(var n=t[0],i=n[0],a=n[0],l=n[1],c=n[1],o=1;o<t.length;o++)n=t[o],i=xs(i,n[0]),a=bs(a,n[0]),l=xs(l,n[1]),c=bs(c,n[1]);e[0]=i,e[1]=l,r[0]=a,r[1]=c}}function eU(t,e,r,n,i,a){i[0]=xs(t,r),i[1]=xs(e,n),a[0]=bs(t,r),a[1]=bs(e,n)}var tU=[],rU=[];function _1e(t,e,r,n,i,a,l,c,o,d){var g=I2,m=Xa,y=g(t,r,i,l,tU);o[0]=1/0,o[1]=1/0,d[0]=-1/0,d[1]=-1/0;for(var x=0;x<y;x++){var A=m(t,r,i,l,tU[x]);o[0]=xs(A,o[0]),d[0]=bs(A,d[0])}y=g(e,n,a,c,rU);for(var x=0;x<y;x++){var M=m(e,n,a,c,rU[x]);o[1]=xs(M,o[1]),d[1]=bs(M,d[1])}o[0]=xs(t,o[0]),d[0]=bs(t,d[0]),o[0]=xs(l,o[0]),d[0]=bs(l,d[0]),o[1]=xs(e,o[1]),d[1]=bs(e,d[1]),o[1]=xs(c,o[1]),d[1]=bs(c,d[1])}function y1e(t,e,r,n,i,a,l,c){var o=D2,d=lo,g=bs(xs(o(t,r,i),1),0),m=bs(xs(o(e,n,a),1),0),y=d(t,r,i,g),x=d(e,n,a,m);l[0]=xs(t,i,y),l[1]=xs(e,a,x),c[0]=bs(t,i,y),c[1]=bs(e,a,x)}function x1e(t,e,r,n,i,a,l,c,o){var d=Xf,g=Qf,m=Math.abs(i-a);if(m%jp<1e-4&&m>1e-4){c[0]=t-r,c[1]=e-n,o[0]=t+r,o[1]=e+n;return}if(MT[0]=zP(i)*r+t,MT[1]=OP(i)*n+e,IT[0]=zP(a)*r+t,IT[1]=OP(a)*n+e,d(c,MT,IT),g(o,MT,IT),i=i%jp,i<0&&(i=i+jp),a=a%jp,a<0&&(a=a+jp),i>a&&!l?a+=jp:i<a&&l&&(i+=jp),l){var y=a;a=i,i=y}for(var x=0;x<a;x+=Math.PI/2)x>i&&(ET[0]=zP(x)*r+t,ET[1]=OP(x)*n+e,d(c,ET,c),g(o,ET,o))}var Fi={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},Wp=[],Zp=[],Gu=[],wf=[],Uu=[],$u=[],BP=Math.min,FP=Math.max,qp=Math.cos,Yp=Math.sin,Zc=Math.abs,Hk=Math.PI,Of=Hk*2,NP=typeof Float32Array<"u",hx=[];function VP(t){var e=Math.round(t/Hk*1e8)/1e8;return e%2*Hk}function kz(t,e){var r=VP(t[0]);r<0&&(r+=Of);var n=r-t[0],i=t[1];i+=n,!e&&i-r>=Of?i=r+Of:e&&r-i>=Of?i=r-Of:!e&&r>i?i=r+(Of-VP(r-i)):e&&r<i&&(i=r-(Of-VP(i-r))),t[0]=r,t[1]=i}var pc=function(){function t(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}return t.prototype.increaseVersion=function(){this._version++},t.prototype.getVersion=function(){return this._version},t.prototype.setScale=function(e,r,n){n=n||0,n>0&&(this._ux=Zc(n/EC/e)||0,this._uy=Zc(n/EC/r)||0)},t.prototype.setDPR=function(e){this.dpr=e},t.prototype.setContext=function(e){this._ctx=e},t.prototype.getContext=function(){return this._ctx},t.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},t.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},t.prototype.moveTo=function(e,r){return this._drawPendingPt(),this.addData(Fi.M,e,r),this._ctx&&this._ctx.moveTo(e,r),this._x0=e,this._y0=r,this._xi=e,this._yi=r,this},t.prototype.lineTo=function(e,r){var n=Zc(e-this._xi),i=Zc(r-this._yi),a=n>this._ux||i>this._uy;if(this.addData(Fi.L,e,r),this._ctx&&a&&this._ctx.lineTo(e,r),a)this._xi=e,this._yi=r,this._pendingPtDist=0;else{var l=n*n+i*i;l>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=r,this._pendingPtDist=l)}return this},t.prototype.bezierCurveTo=function(e,r,n,i,a,l){return this._drawPendingPt(),this.addData(Fi.C,e,r,n,i,a,l),this._ctx&&this._ctx.bezierCurveTo(e,r,n,i,a,l),this._xi=a,this._yi=l,this},t.prototype.quadraticCurveTo=function(e,r,n,i){return this._drawPendingPt(),this.addData(Fi.Q,e,r,n,i),this._ctx&&this._ctx.quadraticCurveTo(e,r,n,i),this._xi=n,this._yi=i,this},t.prototype.arc=function(e,r,n,i,a,l){this._drawPendingPt(),hx[0]=i,hx[1]=a,kz(hx,l),i=hx[0],a=hx[1];var c=a-i;return this.addData(Fi.A,e,r,n,n,i,c,0,l?0:1),this._ctx&&this._ctx.arc(e,r,n,i,a,l),this._xi=qp(a)*n+e,this._yi=Yp(a)*n+r,this},t.prototype.arcTo=function(e,r,n,i,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,r,n,i,a),this},t.prototype.rect=function(e,r,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,r,n,i),this.addData(Fi.R,e,r,n,i),this},t.prototype.closePath=function(){this._drawPendingPt(),this.addData(Fi.Z);var e=this._ctx,r=this._x0,n=this._y0;return e&&e.closePath(),this._xi=r,this._yi=n,this},t.prototype.fill=function(e){e&&e.fill(),this.toStatic()},t.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},t.prototype.len=function(){return this._len},t.prototype.setData=function(e){var r=e.length;!(this.data&&this.data.length===r)&&NP&&(this.data=new Float32Array(r));for(var n=0;n<r;n++)this.data[n]=e[n];this._len=r},t.prototype.appendPath=function(e){e instanceof Array||(e=[e]);for(var r=e.length,n=0,i=this._len,a=0;a<r;a++)n+=e[a].len();NP&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(var a=0;a<r;a++)for(var l=e[a].data,c=0;c<l.length;c++)this.data[i++]=l[c];this._len=i},t.prototype.addData=function(e,r,n,i,a,l,c,o,d){if(this._saveData){var g=this.data;this._len+arguments.length>g.length&&(this._expandData(),g=this.data);for(var m=0;m<arguments.length;m++)g[this._len++]=arguments[m]}},t.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},t.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],r=0;r<this._len;r++)e[r]=this.data[r];this.data=e}},t.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,NP&&this._len>11&&(this.data=new Float32Array(e)))}},t.prototype.getBoundingRect=function(){Gu[0]=Gu[1]=Uu[0]=Uu[1]=Number.MAX_VALUE,wf[0]=wf[1]=$u[0]=$u[1]=-Number.MAX_VALUE;var e=this.data,r=0,n=0,i=0,a=0,l;for(l=0;l<this._len;){var c=e[l++],o=l===1;switch(o&&(r=e[l],n=e[l+1],i=r,a=n),c){case Fi.M:r=i=e[l++],n=a=e[l++],Uu[0]=i,Uu[1]=a,$u[0]=i,$u[1]=a;break;case Fi.L:eU(r,n,e[l],e[l+1],Uu,$u),r=e[l++],n=e[l++];break;case Fi.C:_1e(r,n,e[l++],e[l++],e[l++],e[l++],e[l],e[l+1],Uu,$u),r=e[l++],n=e[l++];break;case Fi.Q:y1e(r,n,e[l++],e[l++],e[l],e[l+1],Uu,$u),r=e[l++],n=e[l++];break;case Fi.A:var d=e[l++],g=e[l++],m=e[l++],y=e[l++],x=e[l++],A=e[l++]+x;l+=1;var M=!e[l++];o&&(i=qp(x)*m+d,a=Yp(x)*y+g),x1e(d,g,m,y,x,A,M,Uu,$u),r=qp(A)*m+d,n=Yp(A)*y+g;break;case Fi.R:i=r=e[l++],a=n=e[l++];var D=e[l++],P=e[l++];eU(i,a,i+D,a+P,Uu,$u);break;case Fi.Z:r=i,n=a;break}Xf(Gu,Gu,Uu),Qf(wf,wf,$u)}return l===0&&(Gu[0]=Gu[1]=wf[0]=wf[1]=0),new gn(Gu[0],Gu[1],wf[0]-Gu[0],wf[1]-Gu[1])},t.prototype._calculateLength=function(){var e=this.data,r=this._len,n=this._ux,i=this._uy,a=0,l=0,c=0,o=0;this._pathSegLen||(this._pathSegLen=[]);for(var d=this._pathSegLen,g=0,m=0,y=0;y<r;){var x=e[y++],A=y===1;A&&(a=e[y],l=e[y+1],c=a,o=l);var M=-1;switch(x){case Fi.M:a=c=e[y++],l=o=e[y++];break;case Fi.L:{var D=e[y++],P=e[y++],O=D-a,z=P-l;(Zc(O)>n||Zc(z)>i||y===r-1)&&(M=Math.sqrt(O*O+z*z),a=D,l=P);break}case Fi.C:{var V=e[y++],H=e[y++],D=e[y++],P=e[y++],$=e[y++],X=e[y++];M=V0e(a,l,V,H,D,P,$,X,10),a=$,l=X;break}case Fi.Q:{var V=e[y++],H=e[y++],D=e[y++],P=e[y++];M=U0e(a,l,V,H,D,P,10),a=D,l=P;break}case Fi.A:var W=e[y++],Y=e[y++],J=e[y++],re=e[y++],ae=e[y++],pe=e[y++],de=pe+ae;y+=1,A&&(c=qp(ae)*J+W,o=Yp(ae)*re+Y),M=FP(J,re)*BP(Of,Math.abs(pe)),a=qp(de)*J+W,l=Yp(de)*re+Y;break;case Fi.R:{c=a=e[y++],o=l=e[y++];var ve=e[y++],me=e[y++];M=ve*2+me*2;break}case Fi.Z:{var O=c-a,z=o-l;M=Math.sqrt(O*O+z*z),a=c,l=o;break}}M>=0&&(d[m++]=M,g+=M)}return this._pathLen=g,g},t.prototype.rebuildPath=function(e,r){var n=this.data,i=this._ux,a=this._uy,l=this._len,c,o,d,g,m,y,x=r<1,A,M,D=0,P=0,O,z=0,V,H;if(!(x&&(this._pathSegLen||this._calculateLength(),A=this._pathSegLen,M=this._pathLen,O=r*M,!O)))e:for(var $=0;$<l;){var X=n[$++],W=$===1;switch(W&&(d=n[$],g=n[$+1],c=d,o=g),X!==Fi.L&&z>0&&(e.lineTo(V,H),z=0),X){case Fi.M:c=d=n[$++],o=g=n[$++],e.moveTo(d,g);break;case Fi.L:{m=n[$++],y=n[$++];var Y=Zc(m-d),J=Zc(y-g);if(Y>i||J>a){if(x){var re=A[P++];if(D+re>O){var ae=(O-D)/re;e.lineTo(d*(1-ae)+m*ae,g*(1-ae)+y*ae);break e}D+=re}e.lineTo(m,y),d=m,g=y,z=0}else{var pe=Y*Y+J*J;pe>z&&(V=m,H=y,z=pe)}break}case Fi.C:{var de=n[$++],ve=n[$++],me=n[$++],Ie=n[$++],Le=n[$++],Ee=n[$++];if(x){var re=A[P++];if(D+re>O){var ae=(O-D)/re;vd(d,de,me,Le,ae,Wp),vd(g,ve,Ie,Ee,ae,Zp),e.bezierCurveTo(Wp[1],Zp[1],Wp[2],Zp[2],Wp[3],Zp[3]);break e}D+=re}e.bezierCurveTo(de,ve,me,Ie,Le,Ee),d=Le,g=Ee;break}case Fi.Q:{var de=n[$++],ve=n[$++],me=n[$++],Ie=n[$++];if(x){var re=A[P++];if(D+re>O){var ae=(O-D)/re;N1(d,de,me,ae,Wp),N1(g,ve,Ie,ae,Zp),e.quadraticCurveTo(Wp[1],Zp[1],Wp[2],Zp[2]);break e}D+=re}e.quadraticCurveTo(de,ve,me,Ie),d=me,g=Ie;break}case Fi.A:var Ue=n[$++],Ke=n[$++],We=n[$++],Rt=n[$++],Et=n[$++],ar=n[$++],ur=n[$++],cr=!n[$++],lt=We>Rt?We:Rt,qt=Zc(We-Rt)>.001,Ut=Et+ar,rr=!1;if(x){var re=A[P++];D+re>O&&(Ut=Et+ar*(O-D)/re,rr=!0),D+=re}if(qt&&e.ellipse?e.ellipse(Ue,Ke,We,Rt,ur,Et,Ut,cr):e.arc(Ue,Ke,lt,Et,Ut,cr),rr)break e;W&&(c=qp(Et)*We+Ue,o=Yp(Et)*Rt+Ke),d=qp(Ut)*We+Ue,g=Yp(Ut)*Rt+Ke;break;case Fi.R:c=d=n[$],o=g=n[$+1],m=n[$++],y=n[$++];var br=n[$++],Oe=n[$++];if(x){var re=A[P++];if(D+re>O){var $e=O-D;e.moveTo(m,y),e.lineTo(m+BP($e,br),y),$e-=br,$e>0&&e.lineTo(m+br,y+BP($e,Oe)),$e-=Oe,$e>0&&e.lineTo(m+FP(br-$e,0),y+Oe),$e-=br,$e>0&&e.lineTo(m,y+FP(Oe-$e,0));break e}D+=re}e.rect(m,y,br,Oe);break;case Fi.Z:if(x){var re=A[P++];if(D+re>O){var ae=(O-D)/re;e.lineTo(d*(1-ae)+c*ae,g*(1-ae)+o*ae);break e}D+=re}e.closePath(),d=c,g=o}}},t.prototype.clone=function(){var e=new t,r=this.data;return e.data=r.slice?r.slice():Array.prototype.slice.call(r),e._len=this._len,e},t.CMD=Fi,t.initDefaultProps=function(){var e=t.prototype;e._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,e._version=0}(),t}();function Gf(t,e,r,n,i,a,l){if(i===0)return!1;var c=i,o=0,d=t;if(l>e+c&&l>n+c||l<e-c&&l<n-c||a>t+c&&a>r+c||a<t-c&&a<r-c)return!1;if(t!==r)o=(e-n)/(t-r),d=(t*n-r*e)/(t-r);else return Math.abs(a-t)<=c/2;var g=o*a-l+d,m=g*g/(o*o+1);return m<=c/2*c/2}function b1e(t,e,r,n,i,a,l,c,o,d,g){if(o===0)return!1;var m=o;if(g>e+m&&g>n+m&&g>a+m&&g>c+m||g<e-m&&g<n-m&&g<a-m&&g<c-m||d>t+m&&d>r+m&&d>i+m&&d>l+m||d<t-m&&d<r-m&&d<i-m&&d<l-m)return!1;var y=E2(t,e,r,n,i,a,l,c,d,g,null);return y<=m/2}function cY(t,e,r,n,i,a,l,c,o){if(l===0)return!1;var d=l;if(o>e+d&&o>n+d&&o>a+d||o<e-d&&o<n-d&&o<a-d||c>t+d&&c>r+d&&c>i+d||c<t-d&&c<r-d&&c<i-d)return!1;var g=P2(t,e,r,n,i,a,c,o,null);return g<=d/2}var nU=Math.PI*2;function Xs(t){return t%=nU,t<0&&(t+=nU),t}var fx=Math.PI*2;function w1e(t,e,r,n,i,a,l,c,o){if(l===0)return!1;var d=l;c-=t,o-=e;var g=Math.sqrt(c*c+o*o);if(g-d>r||g+d<r)return!1;if(Math.abs(n-i)%fx<1e-4)return!0;if(a){var m=n;n=Xs(i),i=Xs(m)}else n=Xs(n),i=Xs(i);n>i&&(i+=fx);var y=Math.atan2(o,c);return y<0&&(y+=fx),y>=n&&y<=i||y+fx>=n&&y+fx<=i}function Jc(t,e,r,n,i,a){if(a>e&&a>n||a<e&&a<n||n===e)return 0;var l=(a-e)/(n-e),c=n<e?1:-1;(l===1||l===0)&&(c=n<e?.5:-.5);var o=l*(r-t)+t;return o===i?1/0:o>i?c:0}var Sf=pc.CMD,Xp=Math.PI*2,S1e=1e-4;function T1e(t,e){return Math.abs(t-e)<S1e}var Ko=[-1,-1,-1],wl=[-1,-1];function A1e(){var t=wl[0];wl[0]=wl[1],wl[1]=t}function C1e(t,e,r,n,i,a,l,c,o,d){if(d>e&&d>n&&d>a&&d>c||d<e&&d<n&&d<a&&d<c)return 0;var g=AC(e,n,a,c,d,Ko);if(g===0)return 0;for(var m=0,y=-1,x=void 0,A=void 0,M=0;M<g;M++){var D=Ko[M],P=D===0||D===1?.5:1,O=Xa(t,r,i,l,D);O<o||(y<0&&(y=I2(e,n,a,c,wl),wl[1]<wl[0]&&y>1&&A1e(),x=Xa(e,n,a,c,wl[0]),y>1&&(A=Xa(e,n,a,c,wl[1]))),y===2?D<wl[0]?m+=x<e?P:-P:D<wl[1]?m+=A<x?P:-P:m+=c<A?P:-P:D<wl[0]?m+=x<e?P:-P:m+=c<x?P:-P)}return m}function M1e(t,e,r,n,i,a,l,c){if(c>e&&c>n&&c>a||c<e&&c<n&&c<a)return 0;var o=G0e(e,n,a,c,Ko);if(o===0)return 0;var d=D2(e,n,a);if(d>=0&&d<=1){for(var g=0,m=lo(e,n,a,d),y=0;y<o;y++){var x=Ko[y]===0||Ko[y]===1?.5:1,A=lo(t,r,i,Ko[y]);A<l||(Ko[y]<d?g+=m<e?x:-x:g+=a<m?x:-x)}return g}else{var x=Ko[0]===0||Ko[0]===1?.5:1,A=lo(t,r,i,Ko[0]);return A<l?0:a<e?x:-x}}function I1e(t,e,r,n,i,a,l,c){if(c-=e,c>r||c<-r)return 0;var o=Math.sqrt(r*r-c*c);Ko[0]=-o,Ko[1]=o;var d=Math.abs(n-i);if(d<1e-4)return 0;if(d>=Xp-1e-4){n=0,i=Xp;var g=a?1:-1;return l>=Ko[0]+t&&l<=Ko[1]+t?g:0}if(n>i){var m=n;n=i,i=m}n<0&&(n+=Xp,i+=Xp);for(var y=0,x=0;x<2;x++){var A=Ko[x];if(A+t>l){var M=Math.atan2(c,A),g=a?1:-1;M<0&&(M=Xp+M),(M>=n&&M<=i||M+Xp>=n&&M+Xp<=i)&&(M>Math.PI/2&&M<Math.PI*1.5&&(g=-g),y+=g)}}return y}function hY(t,e,r,n,i){for(var a=t.data,l=t.len(),c=0,o=0,d=0,g=0,m=0,y,x,A=0;A<l;){var M=a[A++],D=A===1;switch(M===Sf.M&&A>1&&(r||(c+=Jc(o,d,g,m,n,i))),D&&(o=a[A],d=a[A+1],g=o,m=d),M){case Sf.M:g=a[A++],m=a[A++],o=g,d=m;break;case Sf.L:if(r){if(Gf(o,d,a[A],a[A+1],e,n,i))return!0}else c+=Jc(o,d,a[A],a[A+1],n,i)||0;o=a[A++],d=a[A++];break;case Sf.C:if(r){if(b1e(o,d,a[A++],a[A++],a[A++],a[A++],a[A],a[A+1],e,n,i))return!0}else c+=C1e(o,d,a[A++],a[A++],a[A++],a[A++],a[A],a[A+1],n,i)||0;o=a[A++],d=a[A++];break;case Sf.Q:if(r){if(cY(o,d,a[A++],a[A++],a[A],a[A+1],e,n,i))return!0}else c+=M1e(o,d,a[A++],a[A++],a[A],a[A+1],n,i)||0;o=a[A++],d=a[A++];break;case Sf.A:var P=a[A++],O=a[A++],z=a[A++],V=a[A++],H=a[A++],$=a[A++];A+=1;var X=!!(1-a[A++]);y=Math.cos(H)*z+P,x=Math.sin(H)*V+O,D?(g=y,m=x):c+=Jc(o,d,y,x,n,i);var W=(n-P)*V/z+P;if(r){if(w1e(P,O,V,H,H+$,X,e,W,i))return!0}else c+=I1e(P,O,V,H,H+$,X,W,i);o=Math.cos(H+$)*z+P,d=Math.sin(H+$)*V+O;break;case Sf.R:g=o=a[A++],m=d=a[A++];var Y=a[A++],J=a[A++];if(y=g+Y,x=m+J,r){if(Gf(g,m,y,m,e,n,i)||Gf(y,m,y,x,e,n,i)||Gf(y,x,g,x,e,n,i)||Gf(g,x,g,m,e,n,i))return!0}else c+=Jc(y,m,y,x,n,i),c+=Jc(g,x,g,m,n,i);break;case Sf.Z:if(r){if(Gf(o,d,g,m,e,n,i))return!0}else c+=Jc(o,d,g,m,n,i);o=g,d=m;break}}return!r&&!T1e(d,m)&&(c+=Jc(o,d,g,m,n,i)||0),c!==0}function E1e(t,e,r){return hY(t,0,!1,e,r)}function D1e(t,e,r,n){return hY(t,e,!0,r,n)}var PC=Fr({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},Ng),P1e={style:Fr({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},oI.style)},GP=fc.concat(["invisible","culling","z","z2","zlevel","parent"]),kn=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.update=function(){var r=this;t.prototype.update.call(this);var n=this.style;if(n.decal){var i=this._decalEl=this._decalEl||new e;i.buildPath===e.prototype.buildPath&&(i.buildPath=function(o){r.buildPath(o,r.shape)}),i.silent=!0;var a=i.style;for(var l in n)a[l]!==n[l]&&(a[l]=n[l]);a.fill=n.fill?n.decal:null,a.decal=null,a.shadowColor=null,n.strokeFirst&&(a.stroke=null);for(var c=0;c<GP.length;++c)i[GP[c]]=this[GP[c]];i.__dirty|=Ys}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(r){var n=Hn(r);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var a=0;a<n.length;a++){var l=n[a],c=r[l];l==="style"?this.style?Lt(this.style,c):this.useStyle(c):l==="shape"?Lt(this.shape,c):t.prototype.attrKV.call(this,l,c)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var r=this.style.fill;if(r!=="none"){if(yr(r)){var n=MC(r,0);return n>.5?Fk:n>.2?gxe:Nk}else if(r)return Nk}return Fk},e.prototype.getInsideTextStroke=function(r){var n=this.style.fill;if(yr(n)){var i=this.__zr,a=!!(i&&i.isDarkMode()),l=MC(r,0)<Bk;if(a===l)return n}},e.prototype.buildPath=function(r,n,i){},e.prototype.pathUpdated=function(){this.__dirty&=~h_},e.prototype.getUpdatedPathProxy=function(r){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,r),this.path},e.prototype.createPathProxy=function(){this.path=new pc(!1)},e.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return!(n==null||n==="none"||!(r.lineWidth>0))},e.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},e.prototype.getBoundingRect=function(){var r=this._rect,n=this.style,i=!r;if(i){var a=!1;this.path||(a=!0,this.createPathProxy());var l=this.path;(a||this.__dirty&h_)&&(l.beginPath(),this.buildPath(l,this.shape,!1),this.pathUpdated()),r=l.getBoundingRect()}if(this._rect=r,this.hasStroke()&&this.path&&this.path.len()>0){var c=this._rectStroke||(this._rectStroke=r.clone());if(this.__dirty||i){c.copy(r);var o=n.strokeNoScale?this.getLineScale():1,d=n.lineWidth;if(!this.hasFill()){var g=this.strokeContainThreshold;d=Math.max(d,g??4)}o>1e-10&&(c.width+=d/o,c.height+=d/o,c.x-=d/o/2,c.y-=d/o/2)}return c}return r},e.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect(),l=this.style;if(r=i[0],n=i[1],a.contain(r,n)){var c=this.path;if(this.hasStroke()){var o=l.lineWidth,d=l.strokeNoScale?this.getLineScale():1;if(d>1e-10&&(this.hasFill()||(o=Math.max(o,this.strokeContainThreshold)),D1e(c,o/d,r,n)))return!0}if(this.hasFill())return E1e(c,r,n)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=h_,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(r){return this.animate("shape",r)},e.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():r==="shape"?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(r,n){r==="shape"?this.setShape(n):t.prototype.attrKV.call(this,r,n)},e.prototype.setShape=function(r,n){var i=this.shape;return i||(i=this.shape={}),typeof r=="string"?i[r]=n:Lt(i,r),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(this.__dirty&h_)},e.prototype.createStyle=function(r){return JM(PC,r)},e.prototype._innerSaveToNormal=function(r){t.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.shape&&!n.shape&&(n.shape=Lt({},this.shape))},e.prototype._applyStateObj=function(r,n,i,a,l,c){t.prototype._applyStateObj.call(this,r,n,i,a,l,c);var o=!(n&&a),d;if(n&&n.shape?l?a?d=n.shape:(d=Lt({},i.shape),Lt(d,n.shape)):(d=Lt({},a?this.shape:i.shape),Lt(d,n.shape)):o&&(d=i.shape),d)if(l){this.shape=Lt({},this.shape);for(var g={},m=Hn(d),y=0;y<m.length;y++){var x=m[y];typeof d[x]=="object"?this.shape[x]=d[x]:g[x]=d[x]}this._transitionState(r,{shape:g},c)}else this.shape=d,this.dirtyShape()},e.prototype._mergeStates=function(r){for(var n=t.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var l=r[a];l.shape&&(i=i||{},this._mergeStyle(i,l.shape))}return i&&(n.shape=i),n},e.prototype.getAnimationStyleProps=function(){return P1e},e.prototype.isZeroArea=function(){return!1},e.extend=function(r){var n=function(a){et(l,a);function l(c){var o=a.call(this,c)||this;return r.init&&r.init.call(o,c),o}return l.prototype.getDefaultStyle=function(){return $r(r.style)},l.prototype.getDefaultShape=function(){return $r(r.shape)},l}(e);for(var i in r)typeof r[i]=="function"&&(n.prototype[i]=r[i]);return n},e.initDefaultProps=function(){var r=e.prototype;r.type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,r.__dirty=Ys|Fx|h_}(),e}(zl),L1e=Fr({strokeFirst:!0,font:pd,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},PC),U_=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return n!=null&&n!=="none"&&r.lineWidth>0},e.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},e.prototype.createStyle=function(r){return JM(L1e,r)},e.prototype.setBoundingRect=function(r){this._rect=r},e.prototype.getBoundingRect=function(){var r=this.style;if(!this._rect){var n=r.text;n!=null?n+="":n="";var i=Sb(n,r.font,r.textAlign,r.textBaseline);if(i.x+=r.x||0,i.y+=r.y||0,this.hasStroke()){var a=r.lineWidth;i.x-=a/2,i.y-=a/2,i.width+=a,i.height+=a}this._rect=i}return this._rect},e.initDefaultProps=function(){var r=e.prototype;r.dirtyRectTolerance=10}(),e}(zl);U_.prototype.type="tspan";var R1e=Fr({x:0,y:0},Ng),k1e={style:Fr({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},oI.style)};function O1e(t){return!!(t&&typeof t!="string"&&t.width&&t.height)}var fo=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.createStyle=function(r){return JM(R1e,r)},e.prototype._getSize=function(r){var n=this.style,i=n[r];if(i!=null)return i;var a=O1e(n.image)?n.image:this.__image;if(!a)return 0;var l=r==="width"?"height":"width",c=n[l];return c==null?a[r]:a[r]/a[l]*c},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return k1e},e.prototype.getBoundingRect=function(){var r=this.style;return this._rect||(this._rect=new gn(r.x||0,r.y||0,this.getWidth(),this.getHeight())),this._rect},e}(zl);fo.prototype.type="image";function z1e(t,e){var r=e.x,n=e.y,i=e.width,a=e.height,l=e.r,c,o,d,g;i<0&&(r=r+i,i=-i),a<0&&(n=n+a,a=-a),typeof l=="number"?c=o=d=g=l:l instanceof Array?l.length===1?c=o=d=g=l[0]:l.length===2?(c=d=l[0],o=g=l[1]):l.length===3?(c=l[0],o=g=l[1],d=l[2]):(c=l[0],o=l[1],d=l[2],g=l[3]):c=o=d=g=0;var m;c+o>i&&(m=c+o,c*=i/m,o*=i/m),d+g>i&&(m=d+g,d*=i/m,g*=i/m),o+d>a&&(m=o+d,o*=a/m,d*=a/m),c+g>a&&(m=c+g,c*=a/m,g*=a/m),t.moveTo(r+c,n),t.lineTo(r+i-o,n),o!==0&&t.arc(r+i-o,n+o,o,-Math.PI/2,0),t.lineTo(r+i,n+a-d),d!==0&&t.arc(r+i-d,n+a-d,d,0,Math.PI/2),t.lineTo(r+g,n+a),g!==0&&t.arc(r+g,n+a-g,g,Math.PI/2,Math.PI),t.lineTo(r,n+c),c!==0&&t.arc(r+c,n+c,c,Math.PI,Math.PI*1.5)}var m_=Math.round;function fY(t,e,r){if(e){var n=e.x1,i=e.x2,a=e.y1,l=e.y2;t.x1=n,t.x2=i,t.y1=a,t.y2=l;var c=r&&r.lineWidth;return c&&(m_(n*2)===m_(i*2)&&(t.x1=t.x2=Ag(n,c,!0)),m_(a*2)===m_(l*2)&&(t.y1=t.y2=Ag(a,c,!0))),t}}function dY(t,e,r){if(e){var n=e.x,i=e.y,a=e.width,l=e.height;t.x=n,t.y=i,t.width=a,t.height=l;var c=r&&r.lineWidth;return c&&(t.x=Ag(n,c,!0),t.y=Ag(i,c,!0),t.width=Math.max(Ag(n+a,c,!1)-t.x,a===0?0:1),t.height=Math.max(Ag(i+l,c,!1)-t.y,l===0?0:1)),t}}function Ag(t,e,r){if(!e)return t;var n=m_(t*2);return(n+m_(e))%2===0?n/2:(n+(r?1:-1))/2}var B1e=function(){function t(){this.x=0,this.y=0,this.width=0,this.height=0}return t}(),F1e={},Kn=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultShape=function(){return new B1e},e.prototype.buildPath=function(r,n){var i,a,l,c;if(this.subPixelOptimize){var o=dY(F1e,n,this.style);i=o.x,a=o.y,l=o.width,c=o.height,o.r=n.r,n=o}else i=n.x,a=n.y,l=n.width,c=n.height;n.r?z1e(r,n):r.rect(i,a,l,c)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(kn);Kn.prototype.type="rect";var iU={fill:"#000"},aU=2,N1e={style:Fr({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},oI.style)},ti=function(t){et(e,t);function e(r){var n=t.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=iU,n.attr(r),n}return e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){t.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var r=0;r<this._children.length;r++){var n=this._children[r];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},e.prototype.updateTransform=function(){var r=this.innerTransformable;r?(r.updateTransform(),r.transform&&(this.transform=r.transform)):t.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(r){var n=this.innerTransformable;return n?n.getLocalTransform(r):t.prototype.getLocalTransform.call(this,r)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),t.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){this._childCursor=0,U1e(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(r){t.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=r},e.prototype.removeSelfFromZr=function(r){t.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var r=new gn(0,0,0,0),n=this._children,i=[],a=null,l=0;l<n.length;l++){var c=n[l],o=c.getBoundingRect(),d=c.getLocalTransform(i);d?(r.copy(o),r.applyTransform(d),a=a||r.clone(),a.union(r)):(a=a||o.clone(),a.union(o))}this._rect=a||r}return this._rect},e.prototype.setDefaultTextStyle=function(r){this._defaultStyle=r||iU},e.prototype.setTextContent=function(r){},e.prototype._mergeStyle=function(r,n){if(!n)return r;var i=n.rich,a=r.rich||i&&{};return Lt(r,n),i&&a?(this._mergeRich(a,i),r.rich=a):a&&(r.rich=a),r},e.prototype._mergeRich=function(r,n){for(var i=Hn(n),a=0;a<i.length;a++){var l=i[a];r[l]=r[l]||{},Lt(r[l],n[l])}},e.prototype.getAnimationStyleProps=function(){return N1e},e.prototype._getOrCreateChild=function(r){var n=this._children[this._childCursor];return(!n||!(n instanceof r))&&(n=new r),this._children[this._childCursor++]=n,n.__zr=this.__zr,n.parent=this,n},e.prototype._updatePlainTexts=function(){var r=this.style,n=r.font||pd,i=r.padding,a=fU(r),l=u1e(a,r),c=UP(r),o=!!r.backgroundColor,d=l.outerHeight,g=l.outerWidth,m=l.contentWidth,y=l.lines,x=l.lineHeight,A=this._defaultStyle,M=r.x||0,D=r.y||0,P=r.align||A.align||"left",O=r.verticalAlign||A.verticalAlign||"top",z=M,V=f_(D,l.contentHeight,O);if(c||i){var H=Vx(M,g,P),$=f_(D,d,O);c&&this._renderBackground(r,r,H,$,g,d)}V+=x/2,i&&(z=hU(M,P,i),O==="top"?V+=i[0]:O==="bottom"&&(V-=i[2]));for(var X=0,W=!1,Y=cU("fill"in r?r.fill:(W=!0,A.fill)),J=uU("stroke"in r?r.stroke:!o&&(!A.autoStroke||W)?(X=aU,A.stroke):null),re=r.textShadowBlur>0,ae=r.width!=null&&(r.overflow==="truncate"||r.overflow==="break"||r.overflow==="breakAll"),pe=l.calculatedLineHeight,de=0;de<y.length;de++){var ve=this._getOrCreateChild(U_),me=ve.createStyle();ve.useStyle(me),me.text=y[de],me.x=z,me.y=V,P&&(me.textAlign=P),me.textBaseline="middle",me.opacity=r.opacity,me.strokeFirst=!0,re&&(me.shadowBlur=r.textShadowBlur||0,me.shadowColor=r.textShadowColor||"transparent",me.shadowOffsetX=r.textShadowOffsetX||0,me.shadowOffsetY=r.textShadowOffsetY||0),me.stroke=J,me.fill=Y,J&&(me.lineWidth=r.lineWidth||X,me.lineDash=r.lineDash,me.lineDashOffset=r.lineDashOffset||0),me.font=n,sU(me,r),V+=x,ae&&ve.setBoundingRect(new gn(Vx(me.x,r.width,me.textAlign),f_(me.y,pe,me.textBaseline),m,pe))}},e.prototype._updateRichTexts=function(){var r=this.style,n=fU(r),i=f1e(n,r),a=i.width,l=i.outerWidth,c=i.outerHeight,o=r.padding,d=r.x||0,g=r.y||0,m=this._defaultStyle,y=r.align||m.align,x=r.verticalAlign||m.verticalAlign,A=Vx(d,l,y),M=f_(g,c,x),D=A,P=M;o&&(D+=o[3],P+=o[0]);var O=D+a;UP(r)&&this._renderBackground(r,r,A,M,l,c);for(var z=!!r.backgroundColor,V=0;V<i.lines.length;V++){for(var H=i.lines[V],$=H.tokens,X=$.length,W=H.lineHeight,Y=H.width,J=0,re=D,ae=O,pe=X-1,de=void 0;J<X&&(de=$[J],!de.align||de.align==="left");)this._placeToken(de,r,W,P,re,"left",z),Y-=de.width,re+=de.width,J++;for(;pe>=0&&(de=$[pe],de.align==="right");)this._placeToken(de,r,W,P,ae,"right",z),Y-=de.width,ae-=de.width,pe--;for(re+=(a-(re-D)-(O-ae)-Y)/2;J<=pe;)de=$[J],this._placeToken(de,r,W,P,re+de.width/2,"center",z),re+=de.width,J++;P+=W}},e.prototype._placeToken=function(r,n,i,a,l,c,o){var d=n.rich[r.styleName]||{};d.text=r.text;var g=r.verticalAlign,m=a+i/2;g==="top"?m=a+r.height/2:g==="bottom"&&(m=a+i-r.height/2);var y=!r.isLineHolder&&UP(d);y&&this._renderBackground(d,n,c==="right"?l-r.width:c==="center"?l-r.width/2:l,m-r.height/2,r.width,r.height);var x=!!d.backgroundColor,A=r.textPadding;A&&(l=hU(l,c,A),m-=r.height/2-A[0]-r.innerHeight/2);var M=this._getOrCreateChild(U_),D=M.createStyle();M.useStyle(D);var P=this._defaultStyle,O=!1,z=0,V=cU("fill"in d?d.fill:"fill"in n?n.fill:(O=!0,P.fill)),H=uU("stroke"in d?d.stroke:"stroke"in n?n.stroke:!x&&!o&&(!P.autoStroke||O)?(z=aU,P.stroke):null),$=d.textShadowBlur>0||n.textShadowBlur>0;D.text=r.text,D.x=l,D.y=m,$&&(D.shadowBlur=d.textShadowBlur||n.textShadowBlur||0,D.shadowColor=d.textShadowColor||n.textShadowColor||"transparent",D.shadowOffsetX=d.textShadowOffsetX||n.textShadowOffsetX||0,D.shadowOffsetY=d.textShadowOffsetY||n.textShadowOffsetY||0),D.textAlign=c,D.textBaseline="middle",D.font=r.font||pd,D.opacity=ac(d.opacity,n.opacity,1),sU(D,d),H&&(D.lineWidth=ac(d.lineWidth,n.lineWidth,z),D.lineDash=tn(d.lineDash,n.lineDash),D.lineDashOffset=n.lineDashOffset||0,D.stroke=H),V&&(D.fill=V);var X=r.contentWidth,W=r.contentHeight;M.setBoundingRect(new gn(Vx(D.x,X,D.textAlign),f_(D.y,W,D.textBaseline),X,W))},e.prototype._renderBackground=function(r,n,i,a,l,c){var o=r.backgroundColor,d=r.borderWidth,g=r.borderColor,m=o&&o.image,y=o&&!m,x=r.borderRadius,A=this,M,D;if(y||r.lineHeight||d&&g){M=this._getOrCreateChild(Kn),M.useStyle(M.createStyle()),M.style.fill=null;var P=M.shape;P.x=i,P.y=a,P.width=l,P.height=c,P.r=x,M.dirtyShape()}if(y){var O=M.style;O.fill=o||null,O.fillOpacity=tn(r.fillOpacity,1)}else if(m){D=this._getOrCreateChild(fo),D.onload=function(){A.dirtyStyle()};var z=D.style;z.image=o.image,z.x=i,z.y=a,z.width=l,z.height=c}if(d&&g){var O=M.style;O.lineWidth=d,O.stroke=g,O.strokeOpacity=tn(r.strokeOpacity,1),O.lineDash=r.borderDash,O.lineDashOffset=r.borderDashOffset||0,M.strokeContainThreshold=0,M.hasFill()&&M.hasStroke()&&(O.strokeFirst=!0,O.lineWidth*=2)}var V=(M||D).style;V.shadowBlur=r.shadowBlur||0,V.shadowColor=r.shadowColor||"transparent",V.shadowOffsetX=r.shadowOffsetX||0,V.shadowOffsetY=r.shadowOffsetY||0,V.opacity=ac(r.opacity,n.opacity,1)},e.makeFont=function(r){var n="";return gY(r)&&(n=[r.fontStyle,r.fontWeight,pY(r.fontSize),r.fontFamily||"sans-serif"].join(" ")),n&&fu(n)||r.textFont||r.font},e}(zl),V1e={left:!0,right:1,center:1},G1e={top:1,bottom:1,middle:1},oU=["fontStyle","fontWeight","fontSize","fontFamily"];function pY(t){return typeof t=="string"&&(t.indexOf("px")!==-1||t.indexOf("rem")!==-1||t.indexOf("em")!==-1)?t:isNaN(+t)?vz+"px":t+"px"}function sU(t,e){for(var r=0;r<oU.length;r++){var n=oU[r],i=e[n];i!=null&&(t[n]=i)}}function gY(t){return t.fontSize!=null||t.fontFamily||t.fontWeight}function U1e(t){return lU(t),fe(t.rich,lU),t}function lU(t){if(t){t.font=ti.makeFont(t);var e=t.align;e==="middle"&&(e="center"),t.align=e==null||V1e[e]?e:"left";var r=t.verticalAlign;r==="center"&&(r="middle"),t.verticalAlign=r==null||G1e[r]?r:"top";var n=t.padding;n&&(t.padding=wz(t.padding))}}function uU(t,e){return t==null||e<=0||t==="transparent"||t==="none"?null:t.image||t.colorStops?"#000":t}function cU(t){return t==null||t==="none"?null:t.image||t.colorStops?"#000":t}function hU(t,e,r){return e==="right"?t-r[1]:e==="center"?t+r[3]/2-r[1]/2:t+r[3]}function fU(t){var e=t.text;return e!=null&&(e+=""),e}function UP(t){return!!(t.backgroundColor||t.lineHeight||t.borderWidth&&t.borderColor)}var Yr=ri(),jk=function(t,e,r,n){if(n){var i=Yr(n);i.dataIndex=r,i.dataType=e,i.seriesIndex=t,i.ssrType="chart",n.type==="group"&&n.traverse(function(a){var l=Yr(a);l.seriesIndex=t,l.dataIndex=r,l.dataType=e,l.ssrType="chart"})}},dU=1,pU={},vY=ri(),Oz=ri(),zz=0,Ab=1,lI=2,is=["emphasis","blur","select"],H1=["normal","emphasis","blur","select"],sy=10,$1e=9,Vg="highlight",$A="downplay",p1="select",HA="unselect",g1="toggleSelect";function Zm(t){return t!=null&&t!=="none"}function uI(t,e,r){t.onHoverStateChange&&(t.hoverState||0)!==r&&t.onHoverStateChange(e),t.hoverState=r}function mY(t){uI(t,"emphasis",lI)}function _Y(t){t.hoverState===lI&&uI(t,"normal",zz)}function Bz(t){uI(t,"blur",Ab)}function yY(t){t.hoverState===Ab&&uI(t,"normal",zz)}function H1e(t){t.selected=!0}function j1e(t){t.selected=!1}function gU(t,e,r){e(t,r)}function Ah(t,e,r){gU(t,e,r),t.isGroup&&t.traverse(function(n){gU(n,e,r)})}function LC(t,e){switch(e){case"emphasis":t.hoverState=lI;break;case"normal":t.hoverState=zz;break;case"blur":t.hoverState=Ab;break;case"select":t.selected=!0}}function W1e(t,e,r,n){for(var i=t.style,a={},l=0;l<e.length;l++){var c=e[l],o=i[c];a[c]=o??(n&&n[c])}for(var l=0;l<t.animators.length;l++){var d=t.animators[l];d.__fromStateTransition&&d.__fromStateTransition.indexOf(r)<0&&d.targetName==="style"&&d.saveTo(a,e)}return a}function Z1e(t,e,r,n){var i=r&&An(r,"select")>=0,a=!1;if(t instanceof kn){var l=vY(t),c=i&&l.selectFill||l.normalFill,o=i&&l.selectStroke||l.normalStroke;if(Zm(c)||Zm(o)){n=n||{};var d=n.style||{};d.fill==="inherit"?(a=!0,n=Lt({},n),d=Lt({},d),d.fill=c):!Zm(d.fill)&&Zm(c)?(a=!0,n=Lt({},n),d=Lt({},d),d.fill=Dk(c)):!Zm(d.stroke)&&Zm(o)&&(a||(n=Lt({},n),d=Lt({},d)),d.stroke=Dk(o)),n.style=d}}if(n&&n.z2==null){a||(n=Lt({},n));var g=t.z2EmphasisLift;n.z2=t.z2+(g??sy)}return n}function q1e(t,e,r){if(r&&r.z2==null){r=Lt({},r);var n=t.z2SelectLift;r.z2=t.z2+(n??$1e)}return r}function Y1e(t,e,r){var n=An(t.currentStates,e)>=0,i=t.style.opacity,a=n?null:W1e(t,["opacity"],e,{opacity:1});r=r||{};var l=r.style||{};return l.opacity==null&&(r=Lt({},r),l=Lt({opacity:n?i:a.opacity*.1},l),r.style=l),r}function $P(t,e){var r=this.states[t];if(this.style){if(t==="emphasis")return Z1e(this,t,e,r);if(t==="blur")return Y1e(this,t,r);if(t==="select")return q1e(this,t,r)}return r}function rv(t){t.stateProxy=$P;var e=t.getTextContent(),r=t.getTextGuideLine();e&&(e.stateProxy=$P),r&&(r.stateProxy=$P)}function vU(t,e){!SY(t,e)&&!t.__highByOuter&&Ah(t,mY)}function mU(t,e){!SY(t,e)&&!t.__highByOuter&&Ah(t,_Y)}function gh(t,e){t.__highByOuter|=1<<(e||0),Ah(t,mY)}function vh(t,e){!(t.__highByOuter&=~(1<<(e||0)))&&Ah(t,_Y)}function xY(t){Ah(t,Bz)}function Fz(t){Ah(t,yY)}function bY(t){Ah(t,H1e)}function wY(t){Ah(t,j1e)}function SY(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}function TY(t){var e=t.getModel(),r=[],n=[];e.eachComponent(function(i,a){var l=Oz(a),c=i==="series",o=c?t.getViewOfSeriesModel(a):t.getViewOfComponentModel(a);!c&&n.push(o),l.isBlured&&(o.group.traverse(function(d){yY(d)}),c&&r.push(a)),l.isBlured=!1}),fe(n,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(r,!1,e)})}function Wk(t,e,r,n){var i=n.getModel();r=r||"coordinateSystem";function a(d,g){for(var m=0;m<g.length;m++){var y=d.getItemGraphicEl(g[m]);y&&Fz(y)}}if(t!=null&&!(!e||e==="none")){var l=i.getSeriesByIndex(t),c=l.coordinateSystem;c&&c.master&&(c=c.master);var o=[];i.eachSeries(function(d){var g=l===d,m=d.coordinateSystem;m&&m.master&&(m=m.master);var y=m&&c?m===c:g;if(!(r==="series"&&!g||r==="coordinateSystem"&&!y||e==="series"&&g)){var x=n.getViewOfSeriesModel(d);if(x.group.traverse(function(D){D.__highByOuter&&g&&e==="self"||Bz(D)}),Vo(e))a(d.getData(),e);else if(Ur(e))for(var A=Hn(e),M=0;M<A.length;M++)a(d.getData(A[M]),e[A[M]]);o.push(d),Oz(d).isBlured=!0}}),i.eachComponent(function(d,g){if(d!=="series"){var m=n.getViewOfComponentModel(g);m&&m.toggleBlurSeries&&m.toggleBlurSeries(o,!0,i)}})}}function Zk(t,e,r){if(!(t==null||e==null)){var n=r.getModel().getComponent(t,e);if(n){Oz(n).isBlured=!0;var i=r.getViewOfComponentModel(n);!i||!i.focusBlurEnabled||i.group.traverse(function(a){Bz(a)})}}}function X1e(t,e,r){var n=t.seriesIndex,i=t.getData(e.dataType);if(i){var a=ev(i,e);a=(Ht(a)?a[0]:a)||0;var l=i.getItemGraphicEl(a);if(!l)for(var c=i.count(),o=0;!l&&o<c;)l=i.getItemGraphicEl(o++);if(l){var d=Yr(l);Wk(n,d.focus,d.blurScope,r)}else{var g=t.get(["emphasis","focus"]),m=t.get(["emphasis","blurScope"]);g!=null&&Wk(n,g,m,r)}}}function Nz(t,e,r,n){var i={focusSelf:!1,dispatchers:null};if(t==null||t==="series"||e==null||r==null)return i;var a=n.getModel().getComponent(t,e);if(!a)return i;var l=n.getViewOfComponentModel(a);if(!l||!l.findHighDownDispatchers)return i;for(var c=l.findHighDownDispatchers(r),o,d=0;d<c.length;d++)if(Yr(c[d]).focus==="self"){o=!0;break}return{focusSelf:o,dispatchers:c}}function Q1e(t,e,r){var n=Yr(t),i=Nz(n.componentMainType,n.componentIndex,n.componentHighDownName,r),a=i.dispatchers,l=i.focusSelf;a?(l&&Zk(n.componentMainType,n.componentIndex,r),fe(a,function(c){return vU(c,e)})):(Wk(n.seriesIndex,n.focus,n.blurScope,r),n.focus==="self"&&Zk(n.componentMainType,n.componentIndex,r),vU(t,e))}function K1e(t,e,r){TY(r);var n=Yr(t),i=Nz(n.componentMainType,n.componentIndex,n.componentHighDownName,r).dispatchers;i?fe(i,function(a){return mU(a,e)}):mU(t,e)}function J1e(t,e,r){if(Yk(e)){var n=e.dataType,i=t.getData(n),a=ev(i,e);Ht(a)||(a=[a]),t[e.type===g1?"toggleSelect":e.type===p1?"select":"unselect"](a,n)}}function _U(t){var e=t.getAllData();fe(e,function(r){var n=r.data,i=r.type;n.eachItemGraphicEl(function(a,l){t.isSelected(l,i)?bY(a):wY(a)})})}function ebe(t){var e=[];return t.eachSeries(function(r){var n=r.getAllData();fe(n,function(i){i.data;var a=i.type,l=r.getSelectedDataIndices();if(l.length>0){var c={dataIndex:l,seriesIndex:r.seriesIndex};a!=null&&(c.dataType=a),e.push(c)}})}),e}function Gg(t,e,r){Cg(t,!0),Ah(t,rv),qk(t,e,r)}function tbe(t){Cg(t,!1)}function da(t,e,r,n){n?tbe(t):Gg(t,e,r)}function qk(t,e,r){var n=Yr(t);e!=null?(n.focus=e,n.blurScope=r):n.focus&&(n.focus=null)}var yU=["emphasis","blur","select"],rbe={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function To(t,e,r,n){r=r||"itemStyle";for(var i=0;i<yU.length;i++){var a=yU[i],l=e.getModel([a,r]),c=t.ensureState(a);c.style=n?n(l):l[rbe[r]]()}}function Cg(t,e){var r=e===!1,n=t;t.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=t.highDownSilentOnTouch),(!r||n.__highDownDispatcher)&&(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!r)}function j1(t){return!!(t&&t.__highDownDispatcher)}function nbe(t,e,r){var n=Yr(t);n.componentMainType=e.mainType,n.componentIndex=e.componentIndex,n.componentHighDownName=r}function ibe(t){var e=pU[t];return e==null&&dU<=32&&(e=pU[t]=dU++),e}function Yk(t){var e=t.type;return e===p1||e===HA||e===g1}function xU(t){var e=t.type;return e===Vg||e===$A}function abe(t){var e=vY(t);e.normalFill=t.style.fill,e.normalStroke=t.style.stroke;var r=t.states.select||{};e.selectFill=r.style&&r.style.fill||null,e.selectStroke=r.style&&r.style.stroke||null}var qm=pc.CMD,obe=[[],[],[]],bU=Math.sqrt,sbe=Math.atan2;function AY(t,e){if(e){var r=t.data,n=t.len(),i,a,l,c,o,d,g=qm.M,m=qm.C,y=qm.L,x=qm.R,A=qm.A,M=qm.Q;for(l=0,c=0;l<n;){switch(i=r[l++],c=l,a=0,i){case g:a=1;break;case y:a=1;break;case m:a=3;break;case M:a=2;break;case A:var D=e[4],P=e[5],O=bU(e[0]*e[0]+e[1]*e[1]),z=bU(e[2]*e[2]+e[3]*e[3]),V=sbe(-e[1]/z,e[0]/O);r[l]*=O,r[l++]+=D,r[l]*=z,r[l++]+=P,r[l++]*=O,r[l++]*=z,r[l++]+=V,r[l++]+=V,l+=2,c=l;break;case x:d[0]=r[l++],d[1]=r[l++],So(d,d,e),r[c++]=d[0],r[c++]=d[1],d[0]+=r[l++],d[1]+=r[l++],So(d,d,e),r[c++]=d[0],r[c++]=d[1]}for(o=0;o<a;o++){var H=obe[o];H[0]=r[l++],H[1]=r[l++],So(H,H,e),r[c++]=H[0],r[c++]=H[1]}}t.increaseVersion()}}var HP=Math.sqrt,DT=Math.sin,PT=Math.cos,dx=Math.PI;function wU(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Xk(t,e){return(t[0]*e[0]+t[1]*e[1])/(wU(t)*wU(e))}function SU(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Xk(t,e))}function TU(t,e,r,n,i,a,l,c,o,d,g){var m=o*(dx/180),y=PT(m)*(t-r)/2+DT(m)*(e-n)/2,x=-1*DT(m)*(t-r)/2+PT(m)*(e-n)/2,A=y*y/(l*l)+x*x/(c*c);A>1&&(l*=HP(A),c*=HP(A));var M=(i===a?-1:1)*HP((l*l*(c*c)-l*l*(x*x)-c*c*(y*y))/(l*l*(x*x)+c*c*(y*y)))||0,D=M*l*x/c,P=M*-c*y/l,O=(t+r)/2+PT(m)*D-DT(m)*P,z=(e+n)/2+DT(m)*D+PT(m)*P,V=SU([1,0],[(y-D)/l,(x-P)/c]),H=[(y-D)/l,(x-P)/c],$=[(-1*y-D)/l,(-1*x-P)/c],X=SU(H,$);if(Xk(H,$)<=-1&&(X=dx),Xk(H,$)>=1&&(X=0),X<0){var W=Math.round(X/dx*1e6)/1e6;X=dx*2+W%2*dx}g.addData(d,O,z,l,c,V,X,m,a)}var lbe=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,ube=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function cbe(t){var e=new pc;if(!t)return e;var r=0,n=0,i=r,a=n,l,c=pc.CMD,o=t.match(lbe);if(!o)return e;for(var d=0;d<o.length;d++){for(var g=o[d],m=g.charAt(0),y=void 0,x=g.match(ube)||[],A=x.length,M=0;M<A;M++)x[M]=parseFloat(x[M]);for(var D=0;D<A;){var P=void 0,O=void 0,z=void 0,V=void 0,H=void 0,$=void 0,X=void 0,W=r,Y=n,J=void 0,re=void 0;switch(m){case"l":r+=x[D++],n+=x[D++],y=c.L,e.addData(y,r,n);break;case"L":r=x[D++],n=x[D++],y=c.L,e.addData(y,r,n);break;case"m":r+=x[D++],n+=x[D++],y=c.M,e.addData(y,r,n),i=r,a=n,m="l";break;case"M":r=x[D++],n=x[D++],y=c.M,e.addData(y,r,n),i=r,a=n,m="L";break;case"h":r+=x[D++],y=c.L,e.addData(y,r,n);break;case"H":r=x[D++],y=c.L,e.addData(y,r,n);break;case"v":n+=x[D++],y=c.L,e.addData(y,r,n);break;case"V":n=x[D++],y=c.L,e.addData(y,r,n);break;case"C":y=c.C,e.addData(y,x[D++],x[D++],x[D++],x[D++],x[D++],x[D++]),r=x[D-2],n=x[D-1];break;case"c":y=c.C,e.addData(y,x[D++]+r,x[D++]+n,x[D++]+r,x[D++]+n,x[D++]+r,x[D++]+n),r+=x[D-2],n+=x[D-1];break;case"S":P=r,O=n,J=e.len(),re=e.data,l===c.C&&(P+=r-re[J-4],O+=n-re[J-3]),y=c.C,W=x[D++],Y=x[D++],r=x[D++],n=x[D++],e.addData(y,P,O,W,Y,r,n);break;case"s":P=r,O=n,J=e.len(),re=e.data,l===c.C&&(P+=r-re[J-4],O+=n-re[J-3]),y=c.C,W=r+x[D++],Y=n+x[D++],r+=x[D++],n+=x[D++],e.addData(y,P,O,W,Y,r,n);break;case"Q":W=x[D++],Y=x[D++],r=x[D++],n=x[D++],y=c.Q,e.addData(y,W,Y,r,n);break;case"q":W=x[D++]+r,Y=x[D++]+n,r+=x[D++],n+=x[D++],y=c.Q,e.addData(y,W,Y,r,n);break;case"T":P=r,O=n,J=e.len(),re=e.data,l===c.Q&&(P+=r-re[J-4],O+=n-re[J-3]),r=x[D++],n=x[D++],y=c.Q,e.addData(y,P,O,r,n);break;case"t":P=r,O=n,J=e.len(),re=e.data,l===c.Q&&(P+=r-re[J-4],O+=n-re[J-3]),r+=x[D++],n+=x[D++],y=c.Q,e.addData(y,P,O,r,n);break;case"A":z=x[D++],V=x[D++],H=x[D++],$=x[D++],X=x[D++],W=r,Y=n,r=x[D++],n=x[D++],y=c.A,TU(W,Y,r,n,$,X,z,V,H,y,e);break;case"a":z=x[D++],V=x[D++],H=x[D++],$=x[D++],X=x[D++],W=r,Y=n,r+=x[D++],n+=x[D++],y=c.A,TU(W,Y,r,n,$,X,z,V,H,y,e);break}}(m==="z"||m==="Z")&&(y=c.Z,e.addData(y),r=i,n=a),l=y}return e.toStatic(),e}var CY=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.applyTransform=function(r){},e}(kn);function MY(t){return t.setData!=null}function IY(t,e){var r=cbe(t),n=Lt({},e);return n.buildPath=function(i){if(MY(i)){i.setData(r.data);var a=i.getContext();a&&i.rebuildPath(a,1)}else{var a=i;r.rebuildPath(a,1)}},n.applyTransform=function(i){AY(r,i),this.dirtyShape()},n}function EY(t,e){return new CY(IY(t,e))}function hbe(t,e){var r=IY(t,e),n=function(i){et(a,i);function a(l){var c=i.call(this,l)||this;return c.applyTransform=r.applyTransform,c.buildPath=r.buildPath,c}return a}(CY);return n}function fbe(t,e){for(var r=[],n=t.length,i=0;i<n;i++){var a=t[i];r.push(a.getUpdatedPathProxy(!0))}var l=new kn(e);return l.createPathProxy(),l.buildPath=function(c){if(MY(c)){c.appendPath(r);var o=c.getContext();o&&c.rebuildPath(o,1)}},l}function Vz(t,e){e=e||{};var r=new kn;return t.shape&&r.setShape(t.shape),r.setStyle(t.style),e.bakeTransform?AY(r.path,t.getComputedTransform()):e.toLocal?r.setLocalTransform(t.getComputedTransform()):r.copyTransform(t),r.buildPath=t.buildPath,r.applyTransform=r.applyTransform,r.z=t.z,r.z2=t.z2,r.zlevel=t.zlevel,r}var dbe=function(){function t(){this.cx=0,this.cy=0,this.r=0}return t}(),Ch=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultShape=function(){return new dbe},e.prototype.buildPath=function(r,n){r.moveTo(n.cx+n.r,n.cy),r.arc(n.cx,n.cy,n.r,0,Math.PI*2)},e}(kn);Ch.prototype.type="circle";var pbe=function(){function t(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return t}(),DY=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultShape=function(){return new pbe},e.prototype.buildPath=function(r,n){var i=.5522848,a=n.cx,l=n.cy,c=n.rx,o=n.ry,d=c*i,g=o*i;r.moveTo(a-c,l),r.bezierCurveTo(a-c,l-g,a-d,l-o,a,l-o),r.bezierCurveTo(a+d,l-o,a+c,l-g,a+c,l),r.bezierCurveTo(a+c,l+g,a+d,l+o,a,l+o),r.bezierCurveTo(a-d,l+o,a-c,l+g,a-c,l),r.closePath()},e}(kn);DY.prototype.type="ellipse";const Gz=DY;var PY=Math.PI,jP=PY*2,Qp=Math.sin,Ym=Math.cos,gbe=Math.acos,Ro=Math.atan2,AU=Math.abs,v1=Math.sqrt,Gx=Math.max,Hu=Math.min,su=1e-4;function vbe(t,e,r,n,i,a,l,c){var o=r-t,d=n-e,g=l-i,m=c-a,y=m*o-g*d;if(!(y*y<su))return y=(g*(e-a)-m*(t-i))/y,[t+y*o,e+y*d]}function LT(t,e,r,n,i,a,l){var c=t-r,o=e-n,d=(l?a:-a)/v1(c*c+o*o),g=d*o,m=-d*c,y=t+g,x=e+m,A=r+g,M=n+m,D=(y+A)/2,P=(x+M)/2,O=A-y,z=M-x,V=O*O+z*z,H=i-a,$=y*M-A*x,X=(z<0?-1:1)*v1(Gx(0,H*H*V-$*$)),W=($*z-O*X)/V,Y=(-$*O-z*X)/V,J=($*z+O*X)/V,re=(-$*O+z*X)/V,ae=W-D,pe=Y-P,de=J-D,ve=re-P;return ae*ae+pe*pe>de*de+ve*ve&&(W=J,Y=re),{cx:W,cy:Y,x0:-g,y0:-m,x1:W*(i/H-1),y1:Y*(i/H-1)}}function mbe(t){var e;if(Ht(t)){var r=t.length;if(!r)return t;r===1?e=[t[0],t[0],0,0]:r===2?e=[t[0],t[0],t[1],t[1]]:r===3?e=t.concat(t[2]):e=t}else e=[t,t,t,t];return e}function _be(t,e){var r,n=Gx(e.r,0),i=Gx(e.r0||0,0),a=n>0,l=i>0;if(!(!a&&!l)){if(a||(n=i,i=0),i>n){var c=n;n=i,i=c}var o=e.startAngle,d=e.endAngle;if(!(isNaN(o)||isNaN(d))){var g=e.cx,m=e.cy,y=!!e.clockwise,x=AU(d-o),A=x>jP&&x%jP;if(A>su&&(x=A),!(n>su))t.moveTo(g,m);else if(x>jP-su)t.moveTo(g+n*Ym(o),m+n*Qp(o)),t.arc(g,m,n,o,d,!y),i>su&&(t.moveTo(g+i*Ym(d),m+i*Qp(d)),t.arc(g,m,i,d,o,y));else{var M=void 0,D=void 0,P=void 0,O=void 0,z=void 0,V=void 0,H=void 0,$=void 0,X=void 0,W=void 0,Y=void 0,J=void 0,re=void 0,ae=void 0,pe=void 0,de=void 0,ve=n*Ym(o),me=n*Qp(o),Ie=i*Ym(d),Le=i*Qp(d),Ee=x>su;if(Ee){var Ue=e.cornerRadius;Ue&&(r=mbe(Ue),M=r[0],D=r[1],P=r[2],O=r[3]);var Ke=AU(n-i)/2;if(z=Hu(Ke,P),V=Hu(Ke,O),H=Hu(Ke,M),$=Hu(Ke,D),Y=X=Gx(z,V),J=W=Gx(H,$),(X>su||W>su)&&(re=n*Ym(d),ae=n*Qp(d),pe=i*Ym(o),de=i*Qp(o),x<PY)){var We=vbe(ve,me,pe,de,re,ae,Ie,Le);if(We){var Rt=ve-We[0],Et=me-We[1],ar=re-We[0],ur=ae-We[1],cr=1/Qp(gbe((Rt*ar+Et*ur)/(v1(Rt*Rt+Et*Et)*v1(ar*ar+ur*ur)))/2),lt=v1(We[0]*We[0]+We[1]*We[1]);Y=Hu(X,(n-lt)/(cr+1)),J=Hu(W,(i-lt)/(cr-1))}}}if(!Ee)t.moveTo(g+ve,m+me);else if(Y>su){var qt=Hu(P,Y),Ut=Hu(O,Y),rr=LT(pe,de,ve,me,n,qt,y),br=LT(re,ae,Ie,Le,n,Ut,y);t.moveTo(g+rr.cx+rr.x0,m+rr.cy+rr.y0),Y<X&&qt===Ut?t.arc(g+rr.cx,m+rr.cy,Y,Ro(rr.y0,rr.x0),Ro(br.y0,br.x0),!y):(qt>0&&t.arc(g+rr.cx,m+rr.cy,qt,Ro(rr.y0,rr.x0),Ro(rr.y1,rr.x1),!y),t.arc(g,m,n,Ro(rr.cy+rr.y1,rr.cx+rr.x1),Ro(br.cy+br.y1,br.cx+br.x1),!y),Ut>0&&t.arc(g+br.cx,m+br.cy,Ut,Ro(br.y1,br.x1),Ro(br.y0,br.x0),!y))}else t.moveTo(g+ve,m+me),t.arc(g,m,n,o,d,!y);if(!(i>su)||!Ee)t.lineTo(g+Ie,m+Le);else if(J>su){var qt=Hu(M,J),Ut=Hu(D,J),rr=LT(Ie,Le,re,ae,i,-Ut,y),br=LT(ve,me,pe,de,i,-qt,y);t.lineTo(g+rr.cx+rr.x0,m+rr.cy+rr.y0),J<W&&qt===Ut?t.arc(g+rr.cx,m+rr.cy,J,Ro(rr.y0,rr.x0),Ro(br.y0,br.x0),!y):(Ut>0&&t.arc(g+rr.cx,m+rr.cy,Ut,Ro(rr.y0,rr.x0),Ro(rr.y1,rr.x1),!y),t.arc(g,m,i,Ro(rr.cy+rr.y1,rr.cx+rr.x1),Ro(br.cy+br.y1,br.cx+br.x1),y),qt>0&&t.arc(g+br.cx,m+br.cy,qt,Ro(br.y1,br.x1),Ro(br.y0,br.x0),!y))}else t.lineTo(g+Ie,m+Le),t.arc(g,m,i,d,o,y)}t.closePath()}}}var ybe=function(){function t(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return t}(),as=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultShape=function(){return new ybe},e.prototype.buildPath=function(r,n){_be(r,n)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(kn);as.prototype.type="sector";var xbe=function(){function t(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return t}(),LY=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultShape=function(){return new xbe},e.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,l=Math.PI*2;r.moveTo(i+n.r,a),r.arc(i,a,n.r,0,l,!1),r.moveTo(i+n.r0,a),r.arc(i,a,n.r0,0,l,!0)},e}(kn);LY.prototype.type="ring";const cI=LY;function bbe(t,e,r,n){var i=[],a=[],l=[],c=[],o,d,g,m;if(n){g=[1/0,1/0],m=[-1/0,-1/0];for(var y=0,x=t.length;y<x;y++)Xf(g,g,t[y]),Qf(m,m,t[y]);Xf(g,g,n[0]),Qf(m,m,n[1])}for(var y=0,x=t.length;y<x;y++){var A=t[y];if(r)o=t[y?y-1:x-1],d=t[(y+1)%x];else if(y===0||y===x-1){i.push(ah(t[y]));continue}else o=t[y-1],d=t[y+1];Tg(a,d,o),zA(a,a,e);var M=bk(A,o),D=bk(A,d),P=M+D;P!==0&&(M/=P,D/=P),zA(l,a,-M),zA(c,a,D);var O=_G([],A,l),z=_G([],A,c);n&&(Qf(O,O,g),Xf(O,O,m),Qf(z,z,g),Xf(z,z,m)),i.push(O),i.push(z)}return r&&i.push(i.shift()),i}function RY(t,e,r){var n=e.smooth,i=e.points;if(i&&i.length>=2){if(n){var a=bbe(i,n,r,e.smoothConstraint);t.moveTo(i[0][0],i[0][1]);for(var l=i.length,c=0;c<(r?l:l-1);c++){var o=a[c*2],d=a[c*2+1],g=i[(c+1)%l];t.bezierCurveTo(o[0],o[1],d[0],d[1],g[0],g[1])}}else{t.moveTo(i[0][0],i[0][1]);for(var c=1,m=i.length;c<m;c++)t.lineTo(i[c][0],i[c][1])}r&&t.closePath()}}var wbe=function(){function t(){this.points=null,this.smooth=0,this.smoothConstraint=null}return t}(),os=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultShape=function(){return new wbe},e.prototype.buildPath=function(r,n){RY(r,n,!0)},e}(kn);os.prototype.type="polygon";var Sbe=function(){function t(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return t}(),ls=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Sbe},e.prototype.buildPath=function(r,n){RY(r,n,!1)},e}(kn);ls.prototype.type="polyline";var Tbe={},Abe=function(){function t(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return t}(),Ka=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Abe},e.prototype.buildPath=function(r,n){var i,a,l,c;if(this.subPixelOptimize){var o=fY(Tbe,n,this.style);i=o.x1,a=o.y1,l=o.x2,c=o.y2}else i=n.x1,a=n.y1,l=n.x2,c=n.y2;var d=n.percent;d!==0&&(r.moveTo(i,a),d<1&&(l=i*(1-d)+l*d,c=a*(1-d)+c*d),r.lineTo(l,c))},e.prototype.pointAt=function(r){var n=this.shape;return[n.x1*(1-r)+n.x2*r,n.y1*(1-r)+n.y2*r]},e}(kn);Ka.prototype.type="line";var ms=[],Cbe=function(){function t(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return t}();function CU(t,e,r){var n=t.cpx2,i=t.cpy2;return n!=null||i!=null?[(r?DG:Xa)(t.x1,t.cpx1,t.cpx2,t.x2,e),(r?DG:Xa)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(r?Ck:lo)(t.x1,t.cpx1,t.x2,e),(r?Ck:lo)(t.y1,t.cpy1,t.y2,e)]}var Cb=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Cbe},e.prototype.buildPath=function(r,n){var i=n.x1,a=n.y1,l=n.x2,c=n.y2,o=n.cpx1,d=n.cpy1,g=n.cpx2,m=n.cpy2,y=n.percent;y!==0&&(r.moveTo(i,a),g==null||m==null?(y<1&&(N1(i,o,l,y,ms),o=ms[1],l=ms[2],N1(a,d,c,y,ms),d=ms[1],c=ms[2]),r.quadraticCurveTo(o,d,l,c)):(y<1&&(vd(i,o,g,l,y,ms),o=ms[1],g=ms[2],l=ms[3],vd(a,d,m,c,y,ms),d=ms[1],m=ms[2],c=ms[3]),r.bezierCurveTo(o,d,g,m,l,c)))},e.prototype.pointAt=function(r){return CU(this.shape,r,!1)},e.prototype.tangentAt=function(r){var n=CU(this.shape,r,!0);return iy(n,n)},e}(kn);Cb.prototype.type="bezier-curve";var Mbe=function(){function t(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return t}(),hI=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Mbe},e.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,l=Math.max(n.r,0),c=n.startAngle,o=n.endAngle,d=n.clockwise,g=Math.cos(c),m=Math.sin(c);r.moveTo(g*l+i,m*l+a),r.arc(i,a,l,c,o,!d)},e}(kn);hI.prototype.type="arc";var Ibe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="compound",r}return e.prototype._updatePathDirty=function(){for(var r=this.shape.paths,n=this.shapeChanged(),i=0;i<r.length;i++)n=n||r[i].shapeChanged();n&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var r=this.shape.paths||[],n=this.getGlobalScale(),i=0;i<r.length;i++)r[i].path||r[i].createPathProxy(),r[i].path.setScale(n[0],n[1],r[i].segmentIgnoreThreshold)},e.prototype.buildPath=function(r,n){for(var i=n.paths||[],a=0;a<i.length;a++)i[a].buildPath(r,i[a].shape,!0)},e.prototype.afterBrush=function(){for(var r=this.shape.paths||[],n=0;n<r.length;n++)r[n].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),kn.prototype.getBoundingRect.call(this)},e}(kn);const Uz=Ibe;var kY=function(){function t(e){this.colorStops=e||[]}return t.prototype.addColorStop=function(e,r){this.colorStops.push({offset:e,color:r})},t}(),Mb=function(t){et(e,t);function e(r,n,i,a,l,c){var o=t.call(this,l)||this;return o.x=r??0,o.y=n??0,o.x2=i??1,o.y2=a??0,o.type="linear",o.global=c||!1,o}return e}(kY),Ebe=function(t){et(e,t);function e(r,n,i,a,l){var c=t.call(this,a)||this;return c.x=r??.5,c.y=n??.5,c.r=i??.5,c.type="radial",c.global=l||!1,c}return e}(kY);const OY=Ebe;var Kp=[0,0],Jp=[0,0],RT=new hn,kT=new hn,Dbe=function(){function t(e,r){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new hn;for(var n=0;n<2;n++)this._axes[n]=new hn;e&&this.fromBoundingRect(e,r)}return t.prototype.fromBoundingRect=function(e,r){var n=this._corners,i=this._axes,a=e.x,l=e.y,c=a+e.width,o=l+e.height;if(n[0].set(a,l),n[1].set(c,l),n[2].set(c,o),n[3].set(a,o),r)for(var d=0;d<4;d++)n[d].transform(r);hn.sub(i[0],n[1],n[0]),hn.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(var d=0;d<2;d++)this._origin[d]=i[d].dot(n[0])},t.prototype.intersect=function(e,r){var n=!0,i=!r;return RT.set(1/0,1/0),kT.set(0,0),!this._intersectCheckOneSide(this,e,RT,kT,i,1)&&(n=!1,i)||!this._intersectCheckOneSide(e,this,RT,kT,i,-1)&&(n=!1,i)||i||hn.copy(r,n?RT:kT),n},t.prototype._intersectCheckOneSide=function(e,r,n,i,a,l){for(var c=!0,o=0;o<2;o++){var d=this._axes[o];if(this._getProjMinMaxOnAxis(o,e._corners,Kp),this._getProjMinMaxOnAxis(o,r._corners,Jp),Kp[1]<Jp[0]||Kp[0]>Jp[1]){if(c=!1,a)return c;var g=Math.abs(Jp[0]-Kp[1]),m=Math.abs(Kp[0]-Jp[1]);Math.min(g,m)>i.len()&&(g<m?hn.scale(i,d,-g*l):hn.scale(i,d,m*l))}else if(n){var g=Math.abs(Jp[0]-Kp[1]),m=Math.abs(Kp[0]-Jp[1]);Math.min(g,m)<n.len()&&(g<m?hn.scale(n,d,g*l):hn.scale(n,d,-m*l))}}return c},t.prototype._getProjMinMaxOnAxis=function(e,r,n){for(var i=this._axes[e],a=this._origin,l=r[0].dot(i)+a[e],c=l,o=l,d=1;d<r.length;d++){var g=r[d].dot(i)+a[e];c=Math.min(g,c),o=Math.max(g,o)}n[0]=c,n[1]=o},t}();const RC=Dbe;var Pbe=[],Lbe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.notClear=!0,r.incremental=!0,r._displayables=[],r._temporaryDisplayables=[],r._cursor=0,r}return e.prototype.traverse=function(r,n){r.call(n,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(r,n){n?this._temporaryDisplayables.push(r):this._displayables.push(r),this.markRedraw()},e.prototype.addDisplayables=function(r,n){n=n||!1;for(var i=0;i<r.length;i++)this.addDisplayable(r[i],n)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(r){for(var n=this._cursor;n<this._displayables.length;n++)r&&r(this._displayables[n]);for(var n=0;n<this._temporaryDisplayables.length;n++)r&&r(this._temporaryDisplayables[n])},e.prototype.update=function(){this.updateTransform();for(var r=this._cursor;r<this._displayables.length;r++){var n=this._displayables[r];n.parent=this,n.update(),n.parent=null}for(var r=0;r<this._temporaryDisplayables.length;r++){var n=this._temporaryDisplayables[r];n.parent=this,n.update(),n.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var r=new gn(1/0,1/0,-1/0,-1/0),n=0;n<this._displayables.length;n++){var i=this._displayables[n],a=i.getBoundingRect().clone();i.needLocalTransform()&&a.applyTransform(i.getLocalTransform(Pbe)),r.union(a)}this._rect=r}return this._rect},e.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(a.contain(i[0],i[1]))for(var l=0;l<this._displayables.length;l++){var c=this._displayables[l];if(c.contain(r,n))return!0}return!1},e}(zl);const Rbe=Lbe;var zY=ri();function ly(t,e,r,n,i){var a;if(e&&e.ecModel){var l=e.ecModel.getUpdatePayload();a=l&&l.animation}var c=e&&e.isAnimationEnabled(),o=t==="update";if(c){var d=void 0,g=void 0,m=void 0;n?(d=tn(n.duration,200),g=tn(n.easing,"cubicOut"),m=0):(d=e.getShallow(o?"animationDurationUpdate":"animationDuration"),g=e.getShallow(o?"animationEasingUpdate":"animationEasing"),m=e.getShallow(o?"animationDelayUpdate":"animationDelay")),a&&(a.duration!=null&&(d=a.duration),a.easing!=null&&(g=a.easing),a.delay!=null&&(m=a.delay)),zr(m)&&(m=m(r,i)),zr(d)&&(d=d(r));var y={duration:d||0,delay:m,easing:g};return y}else return null}function $z(t,e,r,n,i,a,l){var c=!1,o;zr(i)?(l=a,a=i,i=null):Ur(i)&&(a=i.cb,l=i.during,c=i.isFrom,o=i.removeOpt,i=i.dataIndex);var d=t==="leave";d||e.stopAnimation("leave");var g=ly(t,n,i,d?o||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(e,i):null);if(g&&g.duration>0){var m=g.duration,y=g.delay,x=g.easing,A={duration:m,delay:y||0,easing:x,done:a,force:!!a||!!l,setToFinal:!d,scope:t,during:l};c?e.animateFrom(r,A):e.animateTo(r,A)}else e.stopAnimation(),!c&&e.attr(r),l&&l(1),a&&a()}function li(t,e,r,n,i,a){$z("update",t,e,r,n,i,a)}function Qi(t,e,r,n,i,a){$z("enter",t,e,r,n,i,a)}function A_(t){if(!t.__zr)return!0;for(var e=0;e<t.animators.length;e++){var r=t.animators[e];if(r.scope==="leave")return!0}return!1}function md(t,e,r,n,i,a){A_(t)||$z("leave",t,e,r,n,i,a)}function MU(t,e,r,n){t.removeTextContent(),t.removeTextGuideLine(),md(t,{style:{opacity:0}},e,r,n)}function W1(t,e,r){function n(){t.parent&&t.parent.remove(t)}t.isGroup?t.traverse(function(i){i.isGroup||MU(i,e,r,n)}):MU(t,e,r,n)}function xu(t){zY(t).oldStyle=t.style}function kbe(t){return zY(t).oldStyle}var kC=Math.max,OC=Math.min,Qk={};function Obe(t){return kn.extend(t)}var zbe=hbe;function Bbe(t,e){return zbe(t,e)}function Su(t,e){Qk[t]=e}function Hz(t){if(Qk.hasOwnProperty(t))return Qk[t]}function fI(t,e,r,n){var i=EY(t,e);return r&&(n==="center"&&(r=FY(r,i.getBoundingRect())),NY(i,r)),i}function BY(t,e,r){var n=new fo({style:{image:t,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(i){if(r==="center"){var a={width:i.width,height:i.height};n.setStyle(FY(e,a))}}});return n}function FY(t,e){var r=e.width/e.height,n=t.height*r,i;n<=t.width?i=t.height:(n=t.width,i=n/r);var a=t.x+t.width/2,l=t.y+t.height/2;return{x:a-n/2,y:l-i/2,width:n,height:i}}var Cl=fbe;function NY(t,e){if(t.applyTransform){var r=t.getBoundingRect(),n=r.calculateTransform(e);t.applyTransform(n)}}function $_(t,e){return fY(t,t,{lineWidth:e}),t}function Fbe(t){return dY(t.shape,t.shape,t.style),t}var jA=Ag;function Ug(t,e){for(var r=eI([]);t&&t!==e;)oh(r,t.getLocalTransform(),r),t=t.parent;return r}function vu(t,e,r){return e&&!Vo(e)&&(e=th.getLocalTransform(e)),r&&(e=ay([],e)),So([],t,e)}function dI(t,e,r){var n=e[4]===0||e[5]===0||e[0]===0?1:Math.abs(2*e[4]/e[0]),i=e[4]===0||e[5]===0||e[2]===0?1:Math.abs(2*e[4]/e[2]),a=[t==="left"?-n:t==="right"?n:0,t==="top"?-i:t==="bottom"?i:0];return a=vu(a,e,r),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function IU(t){return!t.isGroup}function Nbe(t){return t.shape!=null}function Ib(t,e,r){if(!t||!e)return;function n(l){var c={};return l.traverse(function(o){IU(o)&&o.anid&&(c[o.anid]=o)}),c}function i(l){var c={x:l.x,y:l.y,rotation:l.rotation};return Nbe(l)&&(c.shape=Lt({},l.shape)),c}var a=n(t);e.traverse(function(l){if(IU(l)&&l.anid){var c=a[l.anid];if(c){var o=i(l);l.attr(i(c)),li(l,o,r,Yr(l).dataIndex)}}})}function VY(t,e){return Zt(t,function(r){var n=r[0];n=kC(n,e.x),n=OC(n,e.x+e.width);var i=r[1];return i=kC(i,e.y),i=OC(i,e.y+e.height),[n,i]})}function Vbe(t,e){var r=kC(t.x,e.x),n=OC(t.x+t.width,e.x+e.width),i=kC(t.y,e.y),a=OC(t.y+t.height,e.y+e.height);if(n>=r&&a>=i)return{x:r,y:i,width:n-r,height:a-i}}function Eb(t,e,r){var n=Lt({rectHover:!0},e),i=n.style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},t)return t.indexOf("image://")===0?(i.image=t.slice(8),Fr(i,r),new fo(n)):fI(t.replace("path://",""),n,r,"center")}function Ux(t,e,r,n,i){for(var a=0,l=i[i.length-1];a<i.length;a++){var c=i[a];if(GY(t,e,r,n,c[0],c[1],l[0],l[1]))return!0;l=c}}function GY(t,e,r,n,i,a,l,c){var o=r-t,d=n-e,g=l-i,m=c-a,y=WP(g,m,o,d);if(Gbe(y))return!1;var x=t-i,A=e-a,M=WP(x,A,o,d)/y;if(M<0||M>1)return!1;var D=WP(x,A,g,m)/y;return!(D<0||D>1)}function WP(t,e,r,n){return t*n-r*e}function Gbe(t){return t<=1e-6&&t>=-1e-6}function uy(t){var e=t.itemTooltipOption,r=t.componentModel,n=t.itemName,i=yr(e)?{formatter:e}:e,a=r.mainType,l=r.componentIndex,c={componentType:a,name:n,$vars:["name"]};c[a+"Index"]=l;var o=t.formatterParamsExtra;o&&fe(Hn(o),function(g){Cr(c,g)||(c[g]=o[g],c.$vars.push(g))});var d=Yr(t.el);d.componentMainType=a,d.componentIndex=l,d.tooltipConfig={name:n,option:Fr({content:n,formatterParams:c},i)}}function EU(t,e){var r;t.isGroup&&(r=e(t)),r||t.traverse(e)}function Id(t,e){if(t)if(Ht(t))for(var r=0;r<t.length;r++)EU(t[r],e);else EU(t,e)}Su("circle",Ch);Su("ellipse",Gz);Su("sector",as);Su("ring",cI);Su("polygon",os);Su("polyline",ls);Su("rect",Kn);Su("line",Ka);Su("bezierCurve",Cb);Su("arc",hI);const fv=Object.freeze(Object.defineProperty({__proto__:null,Arc:hI,BezierCurve:Cb,BoundingRect:gn,Circle:Ch,CompoundPath:Uz,Ellipse:Gz,Group:jr,Image:fo,IncrementalDisplayable:Rbe,Line:Ka,LinearGradient:Mb,OrientedBoundingRect:RC,Path:kn,Point:hn,Polygon:os,Polyline:ls,RadialGradient:OY,Rect:Kn,Ring:cI,Sector:as,Text:ti,applyTransform:vu,clipPointsByRect:VY,clipRectByRect:Vbe,createIcon:Eb,extendPath:Bbe,extendShape:Obe,getShapeClass:Hz,getTransform:Ug,groupTransition:Ib,initProps:Qi,isElementRemoved:A_,lineLineIntersect:GY,linePolygonIntersect:Ux,makeImage:BY,makePath:fI,mergePath:Cl,registerShape:Su,removeElement:md,removeElementWithFadeOut:W1,resizePath:NY,setTooltipConfig:uy,subPixelOptimize:jA,subPixelOptimizeLine:$_,subPixelOptimizeRect:Fbe,transformDirection:dI,traverseElements:Id,updateProps:li},Symbol.toStringTag,{value:"Module"}));var pI={};function UY(t,e){for(var r=0;r<is.length;r++){var n=is[r],i=e[n],a=t.ensureState(n);a.style=a.style||{},a.style.text=i}var l=t.currentStates.slice();t.clearStates(!0),t.setStyle({text:e.normal}),t.useStates(l,!0)}function Kk(t,e,r){var n=t.labelFetcher,i=t.labelDataIndex,a=t.labelDimIndex,l=e.normal,c;n&&(c=n.getFormattedLabel(i,"normal",null,a,l&&l.get("formatter"),r!=null?{interpolatedValue:r}:null)),c==null&&(c=zr(t.defaultText)?t.defaultText(i,t,r):t.defaultText);for(var o={normal:c},d=0;d<is.length;d++){var g=is[d],m=e[g];o[g]=tn(n?n.getFormattedLabel(i,g,null,a,m&&m.get("formatter")):null,c)}return o}function Ao(t,e,r,n){r=r||pI;for(var i=t instanceof ti,a=!1,l=0;l<H1.length;l++){var c=e[H1[l]];if(c&&c.getShallow("show")){a=!0;break}}var o=i?t:t.getTextContent();if(a){i||(o||(o=new ti,t.setTextContent(o)),t.stateProxy&&(o.stateProxy=t.stateProxy));var d=Kk(r,e),g=e.normal,m=!!g.getShallow("show"),y=Hi(g,n&&n.normal,r,!1,!i);y.text=d.normal,i||t.setTextConfig(zC(g,r,!1));for(var l=0;l<is.length;l++){var x=is[l],c=e[x];if(c){var A=o.ensureState(x),M=!!tn(c.getShallow("show"),m);if(M!==m&&(A.ignore=!M),A.style=Hi(c,n&&n[x],r,!0,!i),A.style.text=d[x],!i){var D=t.ensureState(x);D.textConfig=zC(c,r,!0)}}}o.silent=!!g.getShallow("silent"),o.style.x!=null&&(y.x=o.style.x),o.style.y!=null&&(y.y=o.style.y),o.ignore=!m,o.useStyle(y),o.dirty(),r.enableTextSetter&&(cy(o).setLabelText=function(P){var O=Kk(r,e,P);UY(o,O)})}else o&&(o.ignore=!0);t.dirty()}function to(t,e){e=e||"label";for(var r={normal:t.getModel(e)},n=0;n<is.length;n++){var i=is[n];r[i]=t.getModel([i,e])}return r}function Hi(t,e,r,n,i){var a={};return Ube(a,t,r,n,i),e&&Lt(a,e),a}function zC(t,e,r){e=e||{};var n={},i,a=t.getShallow("rotate"),l=tn(t.getShallow("distance"),r?null:5),c=t.getShallow("offset");return i=t.getShallow("position")||(r?null:"inside"),i==="outside"&&(i=e.defaultOutsidePosition||"top"),i!=null&&(n.position=i),c!=null&&(n.offset=c),a!=null&&(a*=Math.PI/180,n.rotation=a),l!=null&&(n.distance=l),n.outsideFill=t.get("color")==="inherit"?e.inheritColor||null:"auto",n}function Ube(t,e,r,n,i){r=r||pI;var a=e.ecModel,l=a&&a.option.textStyle,c=$be(e),o;if(c){o={};for(var d in c)if(c.hasOwnProperty(d)){var g=e.getModel(["rich",d]);RU(o[d]={},g,l,r,n,i,!1,!0)}}o&&(t.rich=o);var m=e.get("overflow");m&&(t.overflow=m);var y=e.get("minMargin");y!=null&&(t.margin=y),RU(t,e,l,r,n,i,!0,!1)}function $be(t){for(var e;t&&t!==t.ecModel;){var r=(t.option||pI).rich;if(r){e=e||{};for(var n=Hn(r),i=0;i<n.length;i++){var a=n[i];e[a]=1}}t=t.parentModel}return e}var DU=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],PU=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],LU=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function RU(t,e,r,n,i,a,l,c){r=!i&&r||pI;var o=n&&n.inheritColor,d=e.getShallow("color"),g=e.getShallow("textBorderColor"),m=tn(e.getShallow("opacity"),r.opacity);(d==="inherit"||d==="auto")&&(o?d=o:d=null),(g==="inherit"||g==="auto")&&(o?g=o:g=null),a||(d=d||r.color,g=g||r.textBorderColor),d!=null&&(t.fill=d),g!=null&&(t.stroke=g);var y=tn(e.getShallow("textBorderWidth"),r.textBorderWidth);y!=null&&(t.lineWidth=y);var x=tn(e.getShallow("textBorderType"),r.textBorderType);x!=null&&(t.lineDash=x);var A=tn(e.getShallow("textBorderDashOffset"),r.textBorderDashOffset);A!=null&&(t.lineDashOffset=A),!i&&m==null&&!c&&(m=n&&n.defaultOpacity),m!=null&&(t.opacity=m),!i&&!a&&t.fill==null&&n.inheritColor&&(t.fill=n.inheritColor);for(var M=0;M<DU.length;M++){var D=DU[M],P=tn(e.getShallow(D),r[D]);P!=null&&(t[D]=P)}for(var M=0;M<PU.length;M++){var D=PU[M],P=e.getShallow(D);P!=null&&(t[D]=P)}if(t.verticalAlign==null){var O=e.getShallow("baseline");O!=null&&(t.verticalAlign=O)}if(!l||!n.disableBox){for(var M=0;M<LU.length;M++){var D=LU[M],P=e.getShallow(D);P!=null&&(t[D]=P)}var z=e.getShallow("borderType");z!=null&&(t.borderDash=z),(t.backgroundColor==="auto"||t.backgroundColor==="inherit")&&o&&(t.backgroundColor=o),(t.borderColor==="auto"||t.borderColor==="inherit")&&o&&(t.borderColor=o)}}function jz(t,e){var r=e&&e.getModel("textStyle");return fu([t.fontStyle||r&&r.getShallow("fontStyle")||"",t.fontWeight||r&&r.getShallow("fontWeight")||"",(t.fontSize||r&&r.getShallow("fontSize")||12)+"px",t.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}var cy=ri();function $Y(t,e,r,n){if(t){var i=cy(t);i.prevValue=i.value,i.value=r;var a=e.normal;i.valueAnimation=a.get("valueAnimation"),i.valueAnimation&&(i.precision=a.get("precision"),i.defaultInterpolatedText=n,i.statesModels=e)}}function HY(t,e,r,n,i){var a=cy(t);if(!a.valueAnimation||a.prevValue===a.value)return;var l=a.defaultInterpolatedText,c=tn(a.interpolatedValue,a.prevValue),o=a.value;function d(g){var m=iY(r,a.precision,c,o,g);a.interpolatedValue=g===1?null:m;var y=Kk({labelDataIndex:e,labelFetcher:i,defaultText:l?l(m):m+""},a.statesModels,m);UY(t,y)}t.percent=0,(a.prevValue==null?Qi:li)(t,{percent:1},n,e,null,d)}var Hbe=["textStyle","color"],ZP=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],qP=new ti,jbe=function(){function t(){}return t.prototype.getTextColor=function(e){var r=this.ecModel;return this.getShallow("color")||(!e&&r?r.get(Hbe):null)},t.prototype.getFont=function(){return jz({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},t.prototype.getTextRect=function(e){for(var r={text:e,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<ZP.length;n++)r[ZP[n]]=this.getShallow(ZP[n]);return qP.useStyle(r),qP.update(),qP.getBoundingRect()},t}(),jY=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],Wbe=tv(jY),Zbe=function(){function t(){}return t.prototype.getLineStyle=function(e){return Wbe(this,e)},t}(),WY=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],qbe=tv(WY),Ybe=function(){function t(){}return t.prototype.getItemStyle=function(e,r){return qbe(this,e,r)},t}(),bi=function(){function t(e,r,n){this.parentModel=r,this.ecModel=n,this.option=e}return t.prototype.init=function(e,r,n){},t.prototype.mergeOption=function(e,r){pn(this.option,e,!0)},t.prototype.get=function(e,r){return e==null?this.option:this._doGet(this.parsePath(e),!r&&this.parentModel)},t.prototype.getShallow=function(e,r){var n=this.option,i=n==null?n:n[e];if(i==null&&!r){var a=this.parentModel;a&&(i=a.getShallow(e))}return i},t.prototype.getModel=function(e,r){var n=e!=null,i=n?this.parsePath(e):null,a=n?this._doGet(i):this.option;return r=r||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new t(a,r,this.ecModel)},t.prototype.isEmpty=function(){return this.option==null},t.prototype.restoreData=function(){},t.prototype.clone=function(){var e=this.constructor;return new e($r(this.option))},t.prototype.parsePath=function(e){return typeof e=="string"?e.split("."):e},t.prototype.resolveParentPath=function(e){return e},t.prototype.isAnimationEnabled=function(){if(!Nn.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},t.prototype._doGet=function(e,r){var n=this.option;if(!e)return n;for(var i=0;i<e.length&&!(e[i]&&(n=n&&typeof n=="object"?n[e[i]]:null,n==null));i++);return n==null&&r&&(n=r._doGet(this.resolveParentPath(e),r.parentModel)),n},t}();Lz(bi);e1e(bi);Ea(bi,Zbe);Ea(bi,Ybe);Ea(bi,a1e);Ea(bi,jbe);var Xbe=Math.round(Math.random()*10);function hy(t){return[t||"",Xbe++].join("_")}function Qbe(t){var e={};t.registerSubTypeDefaulter=function(r,n){var i=ec(r);e[i.main]=n},t.determineSubType=function(r,n){var i=n.type;if(!i){var a=ec(r).main;t.hasSubTypes(r)&&e[a]&&(i=e[a](n))}return i}}function Kbe(t,e){t.topologicalTravel=function(a,l,c,o){if(!a.length)return;var d=r(l),g=d.graph,m=d.noEntryList,y={};for(fe(a,function(O){y[O]=!0});m.length;){var x=m.pop(),A=g[x],M=!!y[x];M&&(c.call(o,x,A.originalDeps.slice()),delete y[x]),fe(A.successor,M?P:D)}fe(y,function(){var O="";throw new Error(O)});function D(O){g[O].entryCount--,g[O].entryCount===0&&m.push(O)}function P(O){y[O]=!0,D(O)}};function r(a){var l={},c=[];return fe(a,function(o){var d=n(l,o),g=d.originalDeps=e(o),m=i(g,a);d.entryCount=m.length,d.entryCount===0&&c.push(o),fe(m,function(y){An(d.predecessor,y)<0&&d.predecessor.push(y);var x=n(l,y);An(x.successor,y)<0&&x.successor.push(o)})}),{graph:l,noEntryList:c}}function n(a,l){return a[l]||(a[l]={predecessor:[],successor:[]}),a[l]}function i(a,l){var c=[];return fe(a,function(o){An(l,o)>=0&&c.push(o)}),c}}function Ed(t,e){return pn(pn({},t,!0),e,!0)}const Jbe={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},ewe={time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:"",custom:"",chart:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};var BC="ZH",Wz="EN",C_=Wz,WA={},Zz={},ZY=Nn.domSupported?function(){var t=(document.documentElement.lang||navigator.language||navigator.browserLanguage||C_).toUpperCase();return t.indexOf(BC)>-1?BC:C_}():C_;function qY(t,e){t=t.toUpperCase(),Zz[t]=new bi(e),WA[t]=e}function twe(t){if(yr(t)){var e=WA[t.toUpperCase()]||{};return t===BC||t===Wz?$r(e):pn($r(e),$r(WA[C_]),!1)}else return pn($r(t),$r(WA[C_]),!1)}function Jk(t){return Zz[t]}function rwe(){return Zz[C_]}qY(Wz,Jbe);qY(BC,ewe);var qz=1e3,Yz=qz*60,m1=Yz*60,Ml=m1*24,kU=Ml*365,$x={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},OT="{yyyy}-{MM}-{dd}",OU={year:"{yyyy}",month:"{yyyy}-{MM}",day:OT,hour:OT+" "+$x.hour,minute:OT+" "+$x.minute,second:OT+" "+$x.second,millisecond:$x.none},YP=["year","month","day","hour","minute","second","millisecond"],YY=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function Tf(t,e){return t+="","0000".substr(0,e-t.length)+t}function M_(t){switch(t){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return t}}function nwe(t){return t===M_(t)}function iwe(t){switch(t){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function gI(t,e,r,n){var i=dc(t),a=i[Xz(r)](),l=i[I_(r)]()+1,c=Math.floor((l-1)/3)+1,o=i[vI(r)](),d=i["get"+(r?"UTC":"")+"Day"](),g=i[Z1(r)](),m=(g-1)%12+1,y=i[mI(r)](),x=i[_I(r)](),A=i[yI(r)](),M=n instanceof bi?n:Jk(n||ZY)||rwe(),D=M.getModel("time"),P=D.get("month"),O=D.get("monthAbbr"),z=D.get("dayOfWeek"),V=D.get("dayOfWeekAbbr");return(e||"").replace(/{yyyy}/g,a+"").replace(/{yy}/g,Tf(a%100+"",2)).replace(/{Q}/g,c+"").replace(/{MMMM}/g,P[l-1]).replace(/{MMM}/g,O[l-1]).replace(/{MM}/g,Tf(l,2)).replace(/{M}/g,l+"").replace(/{dd}/g,Tf(o,2)).replace(/{d}/g,o+"").replace(/{eeee}/g,z[d]).replace(/{ee}/g,V[d]).replace(/{e}/g,d+"").replace(/{HH}/g,Tf(g,2)).replace(/{H}/g,g+"").replace(/{hh}/g,Tf(m+"",2)).replace(/{h}/g,m+"").replace(/{mm}/g,Tf(y,2)).replace(/{m}/g,y+"").replace(/{ss}/g,Tf(x,2)).replace(/{s}/g,x+"").replace(/{SSS}/g,Tf(A,3)).replace(/{S}/g,A+"")}function awe(t,e,r,n,i){var a=null;if(yr(r))a=r;else if(zr(r))a=r(t.value,e,{level:t.level});else{var l=Lt({},$x);if(t.level>0)for(var c=0;c<YP.length;++c)l[YP[c]]="{primary|"+l[YP[c]]+"}";var o=r?r.inherit===!1?r:Fr(r,l):l,d=XY(t.value,i);if(o[d])a=o[d];else if(o.inherit){for(var g=YY.indexOf(d),c=g-1;c>=0;--c)if(o[d]){a=o[d];break}a=a||l.none}if(Ht(a)){var m=t.level==null?0:t.level>=0?t.level:a.length+t.level;m=Math.min(m,a.length-1),a=a[m]}}return gI(new Date(t.value),a,i,n)}function XY(t,e){var r=dc(t),n=r[I_(e)]()+1,i=r[vI(e)](),a=r[Z1(e)](),l=r[mI(e)](),c=r[_I(e)](),o=r[yI(e)](),d=o===0,g=d&&c===0,m=g&&l===0,y=m&&a===0,x=y&&i===1,A=x&&n===1;return A?"year":x?"month":y?"day":m?"hour":g?"minute":d?"second":"millisecond"}function zU(t,e,r){var n=ii(t)?dc(t):t;switch(e=e||XY(t,r),e){case"year":return n[Xz(r)]();case"half-year":return n[I_(r)]()>=6?1:0;case"quarter":return Math.floor((n[I_(r)]()+1)/4);case"month":return n[I_(r)]();case"day":return n[vI(r)]();case"half-day":return n[Z1(r)]()/24;case"hour":return n[Z1(r)]();case"minute":return n[mI(r)]();case"second":return n[_I(r)]();case"millisecond":return n[yI(r)]()}}function Xz(t){return t?"getUTCFullYear":"getFullYear"}function I_(t){return t?"getUTCMonth":"getMonth"}function vI(t){return t?"getUTCDate":"getDate"}function Z1(t){return t?"getUTCHours":"getHours"}function mI(t){return t?"getUTCMinutes":"getMinutes"}function _I(t){return t?"getUTCSeconds":"getSeconds"}function yI(t){return t?"getUTCMilliseconds":"getMilliseconds"}function owe(t){return t?"setUTCFullYear":"setFullYear"}function QY(t){return t?"setUTCMonth":"setMonth"}function KY(t){return t?"setUTCDate":"setDate"}function JY(t){return t?"setUTCHours":"setHours"}function eX(t){return t?"setUTCMinutes":"setMinutes"}function tX(t){return t?"setUTCSeconds":"setSeconds"}function rX(t){return t?"setUTCMilliseconds":"setMilliseconds"}function nX(t){if(!X2(t))return yr(t)?t:"-";var e=(t+"").split(".");return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function iX(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(r,n){return n.toUpperCase()}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}var fy=wz;function eO(t,e,r){var n="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(g){return g&&fu(g)?g:"-"}function a(g){return!!(g!=null&&!isNaN(g)&&isFinite(g))}var l=e==="time",c=t instanceof Date;if(l||c){var o=l?dc(t):t;if(isNaN(+o)){if(c)return"-"}else return gI(o,n,r)}if(e==="ordinal")return _k(t)?i(t):ii(t)&&a(t)?t+"":"-";var d=ph(t);return a(d)?nX(d):_k(t)?i(t):typeof t=="boolean"?t+"":"-"}var BU=["a","b","c","d","e","f","g"],XP=function(t,e){return"{"+t+(e??"")+"}"};function aX(t,e,r){Ht(e)||(e=[e]);var n=e.length;if(!n)return"";for(var i=e[0].$vars||[],a=0;a<i.length;a++){var l=BU[a];t=t.replace(XP(l),XP(l,0))}for(var c=0;c<n;c++)for(var o=0;o<i.length;o++){var d=e[c][i[o]];t=t.replace(XP(BU[o],c),r?qs(d):d)}return t}function swe(t,e,r){return fe(e,function(n,i){t=t.replace("{"+i+"}",n)}),t}function lwe(t,e){var r=yr(t)?{color:t,extraCssText:e}:t||{},n=r.color,i=r.type;e=r.extraCssText;var a=r.renderMode||"html";if(!n)return"";if(a==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+qs(n)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+qs(n)+";"+(e||"")+'"></span>';var l=r.markerId||"markerX";return{renderMode:a,content:"{"+l+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}}function nv(t,e){return e=e||"transparent",yr(t)?t:Ur(t)&&t.colorStops&&(t.colorStops[0]||{}).color||e}function FC(t,e){if(e==="_blank"||e==="blank"){var r=window.open();r.opener=null,r.location.href=t}else window.open(t,e)}var ZA=fe,oX=["left","right","top","bottom","width","height"],Mg=[["width","left","right"],["height","top","bottom"]];function Qz(t,e,r,n,i){var a=0,l=0;n==null&&(n=1/0),i==null&&(i=1/0);var c=0;e.eachChild(function(o,d){var g=o.getBoundingRect(),m=e.childAt(d+1),y=m&&m.getBoundingRect(),x,A;if(t==="horizontal"){var M=g.width+(y?-y.x+g.x:0);x=a+M,x>n||o.newline?(a=0,x=M,l+=c+r,c=g.height):c=Math.max(c,g.height)}else{var D=g.height+(y?-y.y+g.y:0);A=l+D,A>i||o.newline?(a+=c+r,l=0,A=D,c=g.width):c=Math.max(c,g.width)}o.newline||(o.x=a,o.y=l,o.markRedraw(),t==="horizontal"?a=x+r:l=A+r)})}var $g=Qz;on(Qz,"vertical");on(Qz,"horizontal");function uwe(t,e,r){var n=e.width,i=e.height,a=dr(t.left,n),l=dr(t.top,i),c=dr(t.right,n),o=dr(t.bottom,i);return(isNaN(a)||isNaN(parseFloat(t.left)))&&(a=0),(isNaN(c)||isNaN(parseFloat(t.right)))&&(c=n),(isNaN(l)||isNaN(parseFloat(t.top)))&&(l=0),(isNaN(o)||isNaN(parseFloat(t.bottom)))&&(o=i),r=fy(r||0),{width:Math.max(c-a-r[1]-r[3],0),height:Math.max(o-l-r[0]-r[2],0)}}function Na(t,e,r){r=fy(r||0);var n=e.width,i=e.height,a=dr(t.left,n),l=dr(t.top,i),c=dr(t.right,n),o=dr(t.bottom,i),d=dr(t.width,n),g=dr(t.height,i),m=r[2]+r[0],y=r[1]+r[3],x=t.aspect;switch(isNaN(d)&&(d=n-c-y-a),isNaN(g)&&(g=i-o-m-l),x!=null&&(isNaN(d)&&isNaN(g)&&(x>n/i?d=n*.8:g=i*.8),isNaN(d)&&(d=x*g),isNaN(g)&&(g=d/x)),isNaN(a)&&(a=n-c-d-y),isNaN(l)&&(l=i-o-g-m),t.left||t.right){case"center":a=n/2-d/2-r[3];break;case"right":a=n-d-y;break}switch(t.top||t.bottom){case"middle":case"center":l=i/2-g/2-r[0];break;case"bottom":l=i-g-m;break}a=a||0,l=l||0,isNaN(d)&&(d=n-y-a-(c||0)),isNaN(g)&&(g=i-m-l-(o||0));var A=new gn(a+r[3],l+r[0],d,g);return A.margin=r,A}function xI(t,e,r,n,i,a){var l=!i||!i.hv||i.hv[0],c=!i||!i.hv||i.hv[1],o=i&&i.boundingMode||"all";if(a=a||t,a.x=t.x,a.y=t.y,!l&&!c)return!1;var d;if(o==="raw")d=t.type==="group"?new gn(0,0,+e.width||0,+e.height||0):t.getBoundingRect();else if(d=t.getBoundingRect(),t.needLocalTransform()){var g=t.getLocalTransform();d=d.clone(),d.applyTransform(g)}var m=Na(Fr({width:d.width,height:d.height},e),r,n),y=l?m.x-d.x:0,x=c?m.y-d.y:0;return o==="raw"?(a.x=y,a.y=x):(a.x+=y,a.y+=x),a===t&&t.markRedraw(),!0}function cwe(t,e){return t[Mg[e][0]]!=null||t[Mg[e][1]]!=null&&t[Mg[e][2]]!=null}function q1(t){var e=t.layoutMode||t.constructor.layoutMode;return Ur(e)?e:e?{type:e}:null}function _d(t,e,r){var n=r&&r.ignoreSize;!Ht(n)&&(n=[n,n]);var i=l(Mg[0],0),a=l(Mg[1],1);d(Mg[0],t,i),d(Mg[1],t,a);function l(g,m){var y={},x=0,A={},M=0,D=2;if(ZA(g,function(z){A[z]=t[z]}),ZA(g,function(z){c(e,z)&&(y[z]=A[z]=e[z]),o(y,z)&&x++,o(A,z)&&M++}),n[m])return o(e,g[1])?A[g[2]]=null:o(e,g[2])&&(A[g[1]]=null),A;if(M===D||!x)return A;if(x>=D)return y;for(var P=0;P<g.length;P++){var O=g[P];if(!c(y,O)&&c(t,O)){y[O]=t[O];break}}return y}function c(g,m){return g.hasOwnProperty(m)}function o(g,m){return g[m]!=null&&g[m]!=="auto"}function d(g,m,y){ZA(g,function(x){m[x]=y[x]})}}function dy(t){return sX({},t)}function sX(t,e){return e&&t&&ZA(oX,function(r){e.hasOwnProperty(r)&&(t[r]=e[r])}),t}var hwe=ri(),$n=function(t){et(e,t);function e(r,n,i){var a=t.call(this,r,n,i)||this;return a.uid=hy("ec_cpt_model"),a}return e.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},e.prototype.mergeDefaultAndTheme=function(r,n){var i=q1(this),a=i?dy(r):{},l=n.getTheme();pn(r,l.get(this.mainType)),pn(r,this.getDefaultOption()),i&&_d(r,a,i)},e.prototype.mergeOption=function(r,n){pn(this.option,r,!0);var i=q1(this);i&&_d(this.option,r,i)},e.prototype.optionUpdated=function(r,n){},e.prototype.getDefaultOption=function(){var r=this.constructor;if(!Qxe(r))return r.defaultOption;var n=hwe(this);if(!n.defaultOption){for(var i=[],a=r;a;){var l=a.prototype.defaultOption;l&&i.push(l),a=a.superClass}for(var c={},o=i.length-1;o>=0;o--)c=pn(c,i[o],!0);n.defaultOption=c}return n.defaultOption},e.prototype.getReferringComponents=function(r,n){var i=r+"Index",a=r+"Id";return Tb(this.ecModel,r,{index:this.get(i,!0),id:this.get(a,!0)},n)},e.prototype.getBoxLayoutParams=function(){var r=this;return{left:r.get("left"),top:r.get("top"),right:r.get("right"),bottom:r.get("bottom"),width:r.get("width"),height:r.get("height")}},e.prototype.getZLevelKey=function(){return""},e.prototype.setZLevel=function(r){this.option.zlevel=r},e.protoInitialize=function(){var r=e.prototype;r.type="component",r.id="",r.name="",r.mainType="",r.subType="",r.componentIndex=0}(),e}(bi);oY($n,bi);iI($n);Qbe($n);Kbe($n,fwe);function fwe(t){var e=[];return fe($n.getClassesByMainType(t),function(r){e=e.concat(r.dependencies||r.prototype.dependencies||[])}),e=Zt(e,function(r){return ec(r).main}),t!=="dataset"&&An(e,"dataset")<=0&&e.unshift("dataset"),e}var lX="";typeof navigator<"u"&&(lX=navigator.platform||"");var Xm="rgba(0, 0, 0, 0.2)";const dwe={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:Xm,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:Xm,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:Xm,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:Xm,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:Xm,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:Xm,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:lX.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var uX=Ir(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),Nl="original",Go="arrayRows",Vl="objectRows",mc="keyedColumns",ud="typedArray",cX="unknown",oc="column",py="row",xo={Must:1,Might:2,Not:3},hX=ri();function pwe(t){hX(t).datasetMap=Ir()}function fX(t,e,r){var n={},i=Jz(e);if(!i||!t)return n;var a=[],l=[],c=e.ecModel,o=hX(c).datasetMap,d=i.uid+"_"+r.seriesLayoutBy,g,m;t=t.slice(),fe(t,function(M,D){var P=Ur(M)?M:t[D]={name:M};P.type==="ordinal"&&g==null&&(g=D,m=A(P)),n[P.name]=[]});var y=o.get(d)||o.set(d,{categoryWayDim:m,valueWayDim:0});fe(t,function(M,D){var P=M.name,O=A(M);if(g==null){var z=y.valueWayDim;x(n[P],z,O),x(l,z,O),y.valueWayDim+=O}else if(g===D)x(n[P],0,O),x(a,0,O);else{var z=y.categoryWayDim;x(n[P],z,O),x(l,z,O),y.categoryWayDim+=O}});function x(M,D,P){for(var O=0;O<P;O++)M.push(D+O)}function A(M){var D=M.dimsDef;return D?D.length:1}return a.length&&(n.itemName=a),l.length&&(n.seriesName=l),n}function Kz(t,e,r){var n={},i=Jz(t);if(!i)return n;var a=e.sourceFormat,l=e.dimensionsDefine,c;(a===Vl||a===mc)&&fe(l,function(g,m){(Ur(g)?g.name:g)==="name"&&(c=m)});var o=function(){for(var g={},m={},y=[],x=0,A=Math.min(5,r);x<A;x++){var M=pX(e.data,a,e.seriesLayoutBy,l,e.startIndex,x);y.push(M);var D=M===xo.Not;if(D&&g.v==null&&x!==c&&(g.v=x),(g.n==null||g.n===g.v||!D&&y[g.n]===xo.Not)&&(g.n=x),P(g)&&y[g.n]!==xo.Not)return g;D||(M===xo.Might&&m.v==null&&x!==c&&(m.v=x),(m.n==null||m.n===m.v)&&(m.n=x))}function P(O){return O.v!=null&&O.n!=null}return P(g)?g:P(m)?m:null}();if(o){n.value=[o.v];var d=c??o.n;n.itemName=[d],n.seriesName=[d]}return n}function Jz(t){var e=t.get("data",!0);if(!e)return Tb(t.ecModel,"dataset",{index:t.get("datasetIndex",!0),id:t.get("datasetId",!0)},Ma).models[0]}function gwe(t){return!t.get("transform",!0)&&!t.get("fromTransformResult",!0)?[]:Tb(t.ecModel,"dataset",{index:t.get("fromDatasetIndex",!0),id:t.get("fromDatasetId",!0)},Ma).models}function dX(t,e){return pX(t.data,t.sourceFormat,t.seriesLayoutBy,t.dimensionsDefine,t.startIndex,e)}function pX(t,e,r,n,i,a){var l,c=5;if(Is(t))return xo.Not;var o,d;if(n){var g=n[a];Ur(g)?(o=g.name,d=g.type):yr(g)&&(o=g)}if(d!=null)return d==="ordinal"?xo.Must:xo.Not;if(e===Go){var m=t;if(r===py){for(var y=m[a],x=0;x<(y||[]).length&&x<c;x++)if((l=V(y[i+x]))!=null)return l}else for(var x=0;x<m.length&&x<c;x++){var A=m[i+x];if(A&&(l=V(A[a]))!=null)return l}}else if(e===Vl){var M=t;if(!o)return xo.Not;for(var x=0;x<M.length&&x<c;x++){var D=M[x];if(D&&(l=V(D[o]))!=null)return l}}else if(e===mc){var P=t;if(!o)return xo.Not;var y=P[o];if(!y||Is(y))return xo.Not;for(var x=0;x<y.length&&x<c;x++)if((l=V(y[x]))!=null)return l}else if(e===Nl)for(var O=t,x=0;x<O.length&&x<c;x++){var D=O[x],z=oy(D);if(!Ht(z))return xo.Not;if((l=V(z[a]))!=null)return l}function V(H){var $=yr(H);if(H!=null&&isFinite(H)&&H!=="")return $?xo.Might:xo.Not;if($&&H!=="-")return xo.Must}return xo.Not}var tO=Ir();function vwe(t,e){ns(tO.get(t)==null&&e),tO.set(t,e)}function mwe(t,e,r){var n=tO.get(e);if(!n)return r;var i=n(t);return i?r.concat(i):r}var FU=ri(),_we=ri(),eB=function(){function t(){}return t.prototype.getColorFromPalette=function(e,r,n){var i=Pi(this.get("color",!0)),a=this.get("colorLayer",!0);return gX(this,FU,i,a,e,r,n)},t.prototype.clearColorPalette=function(){xwe(this,FU)},t}();function rO(t,e,r,n){var i=Pi(t.get(["aria","decal","decals"]));return gX(t,_we,i,null,e,r,n)}function ywe(t,e){for(var r=t.length,n=0;n<r;n++)if(t[n].length>e)return t[n];return t[r-1]}function gX(t,e,r,n,i,a,l){a=a||t;var c=e(a),o=c.paletteIdx||0,d=c.paletteNameMap=c.paletteNameMap||{};if(d.hasOwnProperty(i))return d[i];var g=l==null||!n?r:ywe(n,l);if(g=g||r,!(!g||!g.length)){var m=g[o];return i&&(d[i]=m),c.paletteIdx=(o+1)%g.length,m}}function xwe(t,e){e(t).paletteIdx=0,e(t).paletteNameMap={}}var zT,px,NU,VU="\0_ec_inner",bwe=1,tB=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.init=function(r,n,i,a,l,c){a=a||{},this.option=null,this._theme=new bi(a),this._locale=new bi(l),this._optionManager=c},e.prototype.setOption=function(r,n,i){var a=$U(n);this._optionManager.setOption(r,i,a),this._resetOption(null,a)},e.prototype.resetOption=function(r,n){return this._resetOption(r,$U(n))},e.prototype._resetOption=function(r,n){var i=!1,a=this._optionManager;if(!r||r==="recreate"){var l=a.mountOption(r==="recreate");!this.option||r==="recreate"?NU(this,l):(this.restoreData(),this._mergeOption(l,n)),i=!0}if((r==="timeline"||r==="media")&&this.restoreData(),!r||r==="recreate"||r==="timeline"){var c=a.getTimelineOption(this);c&&(i=!0,this._mergeOption(c,n))}if(!r||r==="recreate"||r==="media"){var o=a.getMediaOption(this);o.length&&fe(o,function(d){i=!0,this._mergeOption(d,n)},this)}return i},e.prototype.mergeOption=function(r){this._mergeOption(r,null)},e.prototype._mergeOption=function(r,n){var i=this.option,a=this._componentsMap,l=this._componentsCount,c=[],o=Ir(),d=n&&n.replaceMergeMainTypeMap;pwe(this),fe(r,function(m,y){m!=null&&($n.hasClass(y)?y&&(c.push(y),o.set(y,!0)):i[y]=i[y]==null?$r(m):pn(i[y],m,!0))}),d&&d.each(function(m,y){$n.hasClass(y)&&!o.get(y)&&(c.push(y),o.set(y,!0))}),$n.topologicalTravel(c,$n.getAllClassMainTypes(),g,this);function g(m){var y=mwe(this,m,Pi(r[m])),x=a.get(m),A=x?d&&d.get(m)?"replaceMerge":"normalMerge":"replaceAll",M=tY(x,y,A);Uxe(M,m,$n),i[m]=null,a.set(m,null),l.set(m,0);var D=[],P=[],O=0,z;fe(M,function(V,H){var $=V.existing,X=V.newOption;if(!X)$&&($.mergeOption({},this),$.optionUpdated({},!1));else{var W=m==="series",Y=$n.getClass(m,V.keyInfo.subType,!W);if(!Y)return;if(m==="tooltip"){if(z)return;z=!0}if($&&$.constructor===Y)$.name=V.keyInfo.name,$.mergeOption(X,this),$.optionUpdated(X,!1);else{var J=Lt({componentIndex:H},V.keyInfo);$=new Y(X,this,this,J),Lt($,J),V.brandNew&&($.__requireNewView=!0),$.init(X,this,this),$.optionUpdated(null,!0)}}$?(D.push($.option),P.push($),O++):(D.push(void 0),P.push(void 0))},this),i[m]=D,a.set(m,P),l.set(m,O),m==="series"&&zT(this)}this._seriesIndices||zT(this)},e.prototype.getOption=function(){var r=$r(this.option);return fe(r,function(n,i){if($n.hasClass(i)){for(var a=Pi(n),l=a.length,c=!1,o=l-1;o>=0;o--)a[o]&&!$1(a[o])?c=!0:(a[o]=null,!c&&l--);a.length=l,r[i]=a}}),delete r[VU],r},e.prototype.getTheme=function(){return this._theme},e.prototype.getLocaleModel=function(){return this._locale},e.prototype.setUpdatePayload=function(r){this._payload=r},e.prototype.getUpdatePayload=function(){return this._payload},e.prototype.getComponent=function(r,n){var i=this._componentsMap.get(r);if(i){var a=i[n||0];if(a)return a;if(n==null){for(var l=0;l<i.length;l++)if(i[l])return i[l]}}},e.prototype.queryComponents=function(r){var n=r.mainType;if(!n)return[];var i=r.index,a=r.id,l=r.name,c=this._componentsMap.get(n);if(!c||!c.length)return[];var o;return i!=null?(o=[],fe(Pi(i),function(d){c[d]&&o.push(c[d])})):a!=null?o=GU("id",a,c):l!=null?o=GU("name",l,c):o=Ei(c,function(d){return!!d}),UU(o,r)},e.prototype.findComponents=function(r){var n=r.query,i=r.mainType,a=c(n),l=a?this.queryComponents(a):Ei(this._componentsMap.get(i),function(d){return!!d});return o(UU(l,r));function c(d){var g=i+"Index",m=i+"Id",y=i+"Name";return d&&(d[g]!=null||d[m]!=null||d[y]!=null)?{mainType:i,index:d[g],id:d[m],name:d[y]}:null}function o(d){return r.filter?Ei(d,r.filter):d}},e.prototype.eachComponent=function(r,n,i){var a=this._componentsMap;if(zr(r)){var l=n,c=r;a.each(function(m,y){for(var x=0;m&&x<m.length;x++){var A=m[x];A&&c.call(l,y,A,A.componentIndex)}})}else for(var o=yr(r)?a.get(r):Ur(r)?this.findComponents(r):null,d=0;o&&d<o.length;d++){var g=o[d];g&&n.call(i,g,g.componentIndex)}},e.prototype.getSeriesByName=function(r){var n=za(r,null);return Ei(this._componentsMap.get("series"),function(i){return!!i&&n!=null&&i.name===n})},e.prototype.getSeriesByIndex=function(r){return this._componentsMap.get("series")[r]},e.prototype.getSeriesByType=function(r){return Ei(this._componentsMap.get("series"),function(n){return!!n&&n.subType===r})},e.prototype.getSeries=function(){return Ei(this._componentsMap.get("series"),function(r){return!!r})},e.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},e.prototype.eachSeries=function(r,n){px(this),fe(this._seriesIndices,function(i){var a=this._componentsMap.get("series")[i];r.call(n,a,i)},this)},e.prototype.eachRawSeries=function(r,n){fe(this._componentsMap.get("series"),function(i){i&&r.call(n,i,i.componentIndex)})},e.prototype.eachSeriesByType=function(r,n,i){px(this),fe(this._seriesIndices,function(a){var l=this._componentsMap.get("series")[a];l.subType===r&&n.call(i,l,a)},this)},e.prototype.eachRawSeriesByType=function(r,n,i){return fe(this.getSeriesByType(r),n,i)},e.prototype.isSeriesFiltered=function(r){return px(this),this._seriesIndicesMap.get(r.componentIndex)==null},e.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},e.prototype.filterSeries=function(r,n){px(this);var i=[];fe(this._seriesIndices,function(a){var l=this._componentsMap.get("series")[a];r.call(n,l,a)&&i.push(a)},this),this._seriesIndices=i,this._seriesIndicesMap=Ir(i)},e.prototype.restoreData=function(r){zT(this);var n=this._componentsMap,i=[];n.each(function(a,l){$n.hasClass(l)&&i.push(l)}),$n.topologicalTravel(i,$n.getAllClassMainTypes(),function(a){fe(n.get(a),function(l){l&&(a!=="series"||!wwe(l,r))&&l.restoreData()})})},e.internalField=function(){zT=function(r){var n=r._seriesIndices=[];fe(r._componentsMap.get("series"),function(i){i&&n.push(i.componentIndex)}),r._seriesIndicesMap=Ir(n)},px=function(r){},NU=function(r,n){r.option={},r.option[VU]=bwe,r._componentsMap=Ir({series:[]}),r._componentsCount=Ir();var i=n.aria;Ur(i)&&i.enabled==null&&(i.enabled=!0),Swe(n,r._theme.option),pn(n,dwe,!1),r._mergeOption(n,null)}}(),e}(bi);function wwe(t,e){if(e){var r=e.seriesIndex,n=e.seriesId,i=e.seriesName;return r!=null&&t.componentIndex!==r||n!=null&&t.id!==n||i!=null&&t.name!==i}}function Swe(t,e){var r=t.color&&!t.colorLayer;fe(e,function(n,i){i==="colorLayer"&&r||$n.hasClass(i)||(typeof n=="object"?t[i]=t[i]?pn(t[i],n,!1):$r(n):t[i]==null&&(t[i]=n))})}function GU(t,e,r){if(Ht(e)){var n=Ir();return fe(e,function(a){if(a!=null){var l=za(a,null);l!=null&&n.set(a,!0)}}),Ei(r,function(a){return a&&n.get(a[t])})}else{var i=za(e,null);return Ei(r,function(a){return a&&i!=null&&a[t]===i})}}function UU(t,e){return e.hasOwnProperty("subType")?Ei(t,function(r){return r&&r.subType===e.subType}):t}function $U(t){var e=Ir();return t&&fe(Pi(t.replaceMerge),function(r){e.set(r,!0)}),{replaceMergeMainTypeMap:e}}Ea(tB,eB);var Twe=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],vX=function(){function t(e){fe(Twe,function(r){this[r]=wr(e[r],e)},this)}return t}(),QP={},Db=function(){function t(){this._coordinateSystems=[]}return t.prototype.create=function(e,r){var n=[];fe(QP,function(i,a){var l=i.create(e,r);n=n.concat(l||[])}),this._coordinateSystems=n},t.prototype.update=function(e,r){fe(this._coordinateSystems,function(n){n.update&&n.update(e,r)})},t.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},t.register=function(e,r){QP[e]=r},t.get=function(e){return QP[e]},t}(),Awe=/^(min|max)?(.+)$/,Cwe=function(){function t(e){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=e}return t.prototype.setOption=function(e,r,n){e&&(fe(Pi(e.series),function(l){l&&l.data&&Is(l.data)&&bC(l.data)}),fe(Pi(e.dataset),function(l){l&&l.source&&Is(l.source)&&bC(l.source)})),e=$r(e);var i=this._optionBackup,a=Mwe(e,r,!i);this._newBaseOption=a.baseOption,i?(a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},t.prototype.mountOption=function(e){var r=this._optionBackup;return this._timelineOptions=r.timelineOptions,this._mediaList=r.mediaList,this._mediaDefault=r.mediaDefault,this._currentMediaIndices=[],$r(e?r.baseOption:this._newBaseOption)},t.prototype.getTimelineOption=function(e){var r,n=this._timelineOptions;if(n.length){var i=e.getComponent("timeline");i&&(r=$r(n[i.getCurrentIndex()]))}return r},t.prototype.getMediaOption=function(e){var r=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,a=this._mediaDefault,l=[],c=[];if(!i.length&&!a)return c;for(var o=0,d=i.length;o<d;o++)Iwe(i[o].query,r,n)&&l.push(o);return!l.length&&a&&(l=[-1]),l.length&&!Dwe(l,this._currentMediaIndices)&&(c=Zt(l,function(g){return $r(g===-1?a.option:i[g].option)})),this._currentMediaIndices=l,c},t}();function Mwe(t,e,r){var n=[],i,a,l=t.baseOption,c=t.timeline,o=t.options,d=t.media,g=!!t.media,m=!!(o||c||l&&l.timeline);l?(a=l,a.timeline||(a.timeline=c)):((m||g)&&(t.options=t.media=null),a=t),g&&Ht(d)&&fe(d,function(x){x&&x.option&&(x.query?n.push(x):i||(i=x))}),y(a),fe(o,function(x){return y(x)}),fe(n,function(x){return y(x.option)});function y(x){fe(e,function(A){A(x,r)})}return{baseOption:a,timelineOptions:o||[],mediaDefault:i,mediaList:n}}function Iwe(t,e,r){var n={width:e,height:r,aspectratio:e/r},i=!0;return fe(t,function(a,l){var c=l.match(Awe);if(!(!c||!c[1]||!c[2])){var o=c[1],d=c[2].toLowerCase();Ewe(n[d],a,o)||(i=!1)}}),i}function Ewe(t,e,r){return r==="min"?t>=e:r==="max"?t<=e:t===e}function Dwe(t,e){return t.join(",")===e.join(",")}var iu=fe,Y1=Ur,HU=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function KP(t){var e=t&&t.itemStyle;if(e)for(var r=0,n=HU.length;r<n;r++){var i=HU[r],a=e.normal,l=e.emphasis;a&&a[i]&&(t[i]=t[i]||{},t[i].normal?pn(t[i].normal,a[i]):t[i].normal=a[i],a[i]=null),l&&l[i]&&(t[i]=t[i]||{},t[i].emphasis?pn(t[i].emphasis,l[i]):t[i].emphasis=l[i],l[i]=null)}}function Oo(t,e,r){if(t&&t[e]&&(t[e].normal||t[e].emphasis)){var n=t[e].normal,i=t[e].emphasis;n&&(r?(t[e].normal=t[e].emphasis=null,Fr(t[e],n)):t[e]=n),i&&(t.emphasis=t.emphasis||{},t.emphasis[e]=i,i.focus&&(t.emphasis.focus=i.focus),i.blurScope&&(t.emphasis.blurScope=i.blurScope))}}function Hx(t){Oo(t,"itemStyle"),Oo(t,"lineStyle"),Oo(t,"areaStyle"),Oo(t,"label"),Oo(t,"labelLine"),Oo(t,"upperLabel"),Oo(t,"edgeLabel")}function Ca(t,e){var r=Y1(t)&&t[e],n=Y1(r)&&r.textStyle;if(n)for(var i=0,a=XG.length;i<a;i++){var l=XG[i];n.hasOwnProperty(l)&&(r[l]=n[l])}}function bl(t){t&&(Hx(t),Ca(t,"label"),t.emphasis&&Ca(t.emphasis,"label"))}function Pwe(t){if(Y1(t)){KP(t),Hx(t),Ca(t,"label"),Ca(t,"upperLabel"),Ca(t,"edgeLabel"),t.emphasis&&(Ca(t.emphasis,"label"),Ca(t.emphasis,"upperLabel"),Ca(t.emphasis,"edgeLabel"));var e=t.markPoint;e&&(KP(e),bl(e));var r=t.markLine;r&&(KP(r),bl(r));var n=t.markArea;n&&bl(n);var i=t.data;if(t.type==="graph"){i=i||t.nodes;var a=t.links||t.edges;if(a&&!Is(a))for(var l=0;l<a.length;l++)bl(a[l]);fe(t.categories,function(d){Hx(d)})}if(i&&!Is(i))for(var l=0;l<i.length;l++)bl(i[l]);if(e=t.markPoint,e&&e.data)for(var c=e.data,l=0;l<c.length;l++)bl(c[l]);if(r=t.markLine,r&&r.data)for(var o=r.data,l=0;l<o.length;l++)Ht(o[l])?(bl(o[l][0]),bl(o[l][1])):bl(o[l]);t.type==="gauge"?(Ca(t,"axisLabel"),Ca(t,"title"),Ca(t,"detail")):t.type==="treemap"?(Oo(t.breadcrumb,"itemStyle"),fe(t.levels,function(d){Hx(d)})):t.type==="tree"&&Hx(t.leaves)}}function qc(t){return Ht(t)?t:t?[t]:[]}function jU(t){return(Ht(t)?t[0]:t)||{}}function Lwe(t,e){iu(qc(t.series),function(n){Y1(n)&&Pwe(n)});var r=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&r.push("valueAxis","categoryAxis","logAxis","timeAxis"),iu(r,function(n){iu(qc(t[n]),function(i){i&&(Ca(i,"axisLabel"),Ca(i.axisPointer,"label"))})}),iu(qc(t.parallel),function(n){var i=n&&n.parallelAxisDefault;Ca(i,"axisLabel"),Ca(i&&i.axisPointer,"label")}),iu(qc(t.calendar),function(n){Oo(n,"itemStyle"),Ca(n,"dayLabel"),Ca(n,"monthLabel"),Ca(n,"yearLabel")}),iu(qc(t.radar),function(n){Ca(n,"name"),n.name&&n.axisName==null&&(n.axisName=n.name,delete n.name),n.nameGap!=null&&n.axisNameGap==null&&(n.axisNameGap=n.nameGap,delete n.nameGap)}),iu(qc(t.geo),function(n){Y1(n)&&(bl(n),iu(qc(n.regions),function(i){bl(i)}))}),iu(qc(t.timeline),function(n){bl(n),Oo(n,"label"),Oo(n,"itemStyle"),Oo(n,"controlStyle",!0);var i=n.data;Ht(i)&&fe(i,function(a){Ur(a)&&(Oo(a,"label"),Oo(a,"itemStyle"))})}),iu(qc(t.toolbox),function(n){Oo(n,"iconStyle"),iu(n.feature,function(i){Oo(i,"iconStyle")})}),Ca(jU(t.axisPointer),"label"),Ca(jU(t.tooltip).axisPointer,"label")}function Rwe(t,e){for(var r=e.split(","),n=t,i=0;i<r.length&&(n=n&&n[r[i]],n!=null);i++);return n}function kwe(t,e,r,n){for(var i=e.split(","),a=t,l,c=0;c<i.length-1;c++)l=i[c],a[l]==null&&(a[l]={}),a=a[l];a[i[c]]==null&&(a[i[c]]=r)}function WU(t){t&&fe(Owe,function(e){e[0]in t&&!(e[1]in t)&&(t[e[1]]=t[e[0]])})}var Owe=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],zwe=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],JP=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function gx(t){var e=t&&t.itemStyle;if(e)for(var r=0;r<JP.length;r++){var n=JP[r][1],i=JP[r][0];e[n]!=null&&(e[i]=e[n])}}function ZU(t){t&&t.alignTo==="edge"&&t.margin!=null&&t.edgeDistance==null&&(t.edgeDistance=t.margin)}function qU(t){t&&t.downplay&&!t.blur&&(t.blur=t.downplay)}function Bwe(t){t&&t.focusNodeAdjacency!=null&&(t.emphasis=t.emphasis||{},t.emphasis.focus==null&&(t.emphasis.focus="adjacency"))}function mX(t,e){if(t)for(var r=0;r<t.length;r++)e(t[r]),t[r]&&mX(t[r].children,e)}function _X(t,e){Lwe(t,e),t.series=Pi(t.series),fe(t.series,function(r){if(Ur(r)){var n=r.type;if(n==="line")r.clipOverflow!=null&&(r.clip=r.clipOverflow);else if(n==="pie"||n==="gauge"){r.clockWise!=null&&(r.clockwise=r.clockWise),ZU(r.label);var i=r.data;if(i&&!Is(i))for(var a=0;a<i.length;a++)ZU(i[a]);r.hoverOffset!=null&&(r.emphasis=r.emphasis||{},(r.emphasis.scaleSize=null)&&(r.emphasis.scaleSize=r.hoverOffset))}else if(n==="gauge"){var l=Rwe(r,"pointer.color");l!=null&&kwe(r,"itemStyle.color",l)}else if(n==="bar"){gx(r),gx(r.backgroundStyle),gx(r.emphasis);var i=r.data;if(i&&!Is(i))for(var a=0;a<i.length;a++)typeof i[a]=="object"&&(gx(i[a]),gx(i[a]&&i[a].emphasis))}else if(n==="sunburst"){var c=r.highlightPolicy;c&&(r.emphasis=r.emphasis||{},r.emphasis.focus||(r.emphasis.focus=c)),qU(r),mX(r.data,qU)}else n==="graph"||n==="sankey"?Bwe(r):n==="map"&&(r.mapType&&!r.map&&(r.map=r.mapType),r.mapLocation&&Fr(r,r.mapLocation));r.hoverAnimation!=null&&(r.emphasis=r.emphasis||{},r.emphasis&&r.emphasis.scale==null&&(r.emphasis.scale=r.hoverAnimation)),WU(r)}}),t.dataRange&&(t.visualMap=t.dataRange),fe(zwe,function(r){var n=t[r];n&&(Ht(n)||(n=[n]),fe(n,function(i){WU(i)}))})}function Fwe(t){var e=Ir();t.eachSeries(function(r){var n=r.get("stack");if(n){var i=e.get(n)||e.set(n,[]),a=r.getData(),l={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:r};if(!l.stackedDimension||!(l.isStackedByIndex||l.stackedByDimension))return;i.length&&a.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(l)}}),e.each(Nwe)}function Nwe(t){fe(t,function(e,r){var n=[],i=[NaN,NaN],a=[e.stackResultDimension,e.stackedOverDimension],l=e.data,c=e.isStackedByIndex,o=e.seriesModel.get("stackStrategy")||"samesign";l.modify(a,function(d,g,m){var y=l.get(e.stackedDimension,m);if(isNaN(y))return i;var x,A;c?A=l.getRawIndex(m):x=l.get(e.stackedByDimension,m);for(var M=NaN,D=r-1;D>=0;D--){var P=t[D];if(c||(A=P.data.rawIndexOf(P.stackedByDimension,x)),A>=0){var O=P.data.getByRawIndex(P.stackResultDimension,A);if(o==="all"||o==="positive"&&O>0||o==="negative"&&O<0||o==="samesign"&&y>=0&&O>0||o==="samesign"&&y<=0&&O<0){y=Pxe(y,O),M=O;break}}}return n[0]=y,n[1]=M,n})})}var bI=function(){function t(e){this.data=e.data||(e.sourceFormat===mc?{}:[]),this.sourceFormat=e.sourceFormat||cX,this.seriesLayoutBy=e.seriesLayoutBy||oc,this.startIndex=e.startIndex||0,this.dimensionsDetectedCount=e.dimensionsDetectedCount,this.metaRawOption=e.metaRawOption;var r=this.dimensionsDefine=e.dimensionsDefine;if(r)for(var n=0;n<r.length;n++){var i=r[n];i.type==null&&dX(this,n)===xo.Must&&(i.type="ordinal")}}return t}();function rB(t){return t instanceof bI}function nO(t,e,r){r=r||yX(t);var n=e.seriesLayoutBy,i=Gwe(t,r,n,e.sourceHeader,e.dimensions),a=new bI({data:t,sourceFormat:r,seriesLayoutBy:n,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:$r(e)});return a}function nB(t){return new bI({data:t,sourceFormat:Is(t)?ud:Nl})}function Vwe(t){return new bI({data:t.data,sourceFormat:t.sourceFormat,seriesLayoutBy:t.seriesLayoutBy,dimensionsDefine:$r(t.dimensionsDefine),startIndex:t.startIndex,dimensionsDetectedCount:t.dimensionsDetectedCount})}function yX(t){var e=cX;if(Is(t))e=ud;else if(Ht(t)){t.length===0&&(e=Go);for(var r=0,n=t.length;r<n;r++){var i=t[r];if(i!=null){if(Ht(i)||Is(i)){e=Go;break}else if(Ur(i)){e=Vl;break}}}}else if(Ur(t)){for(var a in t)if(Cr(t,a)&&Vo(t[a])){e=mc;break}}return e}function Gwe(t,e,r,n,i){var a,l;if(!t)return{dimensionsDefine:YU(i),startIndex:l,dimensionsDetectedCount:a};if(e===Go){var c=t;n==="auto"||n==null?XU(function(d){d!=null&&d!=="-"&&(yr(d)?l==null&&(l=1):l=0)},r,c,10):l=ii(n)?n:n?1:0,!i&&l===1&&(i=[],XU(function(d,g){i[g]=d!=null?d+"":""},r,c,1/0)),a=i?i.length:r===py?c.length:c[0]?c[0].length:null}else if(e===Vl)i||(i=Uwe(t));else if(e===mc)i||(i=[],fe(t,function(d,g){i.push(g)}));else if(e===Nl){var o=oy(t[0]);a=Ht(o)&&o.length||1}return{startIndex:l,dimensionsDefine:YU(i),dimensionsDetectedCount:a}}function Uwe(t){for(var e=0,r;e<t.length&&!(r=t[e++]););if(r)return Hn(r)}function YU(t){if(t){var e=Ir();return Zt(t,function(r,n){r=Ur(r)?r:{name:r};var i={name:r.name,displayName:r.displayName,type:r.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var a=e.get(i.name);return a?i.name+="-"+a.count++:e.set(i.name,{count:1}),i})}}function XU(t,e,r,n){if(e===py)for(var i=0;i<r.length&&i<n;i++)t(r[i]?r[i][0]:null,i);else for(var a=r[0]||[],i=0;i<a.length&&i<n;i++)t(a[i],i)}function xX(t){var e=t.sourceFormat;return e===Vl||e===mc}var eg,tg,rg,QU,KU,bX=function(){function t(e,r){var n=rB(e)?e:nB(e);this._source=n;var i=this._data=n.data;n.sourceFormat===ud&&(this._offset=0,this._dimSize=r,this._data=i),KU(this,i,n)}return t.prototype.getSource=function(){return this._source},t.prototype.count=function(){return 0},t.prototype.getItem=function(e,r){},t.prototype.appendData=function(e){},t.prototype.clean=function(){},t.protoInitialize=function(){var e=t.prototype;e.pure=!1,e.persistent=!0}(),t.internalField=function(){var e;KU=function(l,c,o){var d=o.sourceFormat,g=o.seriesLayoutBy,m=o.startIndex,y=o.dimensionsDefine,x=QU[iB(d,g)];if(Lt(l,x),d===ud)l.getItem=r,l.count=i,l.fillStorage=n;else{var A=wX(d,g);l.getItem=wr(A,null,c,m,y);var M=SX(d,g);l.count=wr(M,null,c,m,y)}};var r=function(l,c){l=l-this._offset,c=c||[];for(var o=this._data,d=this._dimSize,g=d*l,m=0;m<d;m++)c[m]=o[g+m];return c},n=function(l,c,o,d){for(var g=this._data,m=this._dimSize,y=0;y<m;y++){for(var x=d[y],A=x[0]==null?1/0:x[0],M=x[1]==null?-1/0:x[1],D=c-l,P=o[y],O=0;O<D;O++){var z=g[O*m+y];P[l+O]=z,z<A&&(A=z),z>M&&(M=z)}x[0]=A,x[1]=M}},i=function(){return this._data?this._data.length/this._dimSize:0};QU=(e={},e[Go+"_"+oc]={pure:!0,appendData:a},e[Go+"_"+py]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},e[Vl]={pure:!0,appendData:a},e[mc]={pure:!0,appendData:function(l){var c=this._data;fe(l,function(o,d){for(var g=c[d]||(c[d]=[]),m=0;m<(o||[]).length;m++)g.push(o[m])})}},e[Nl]={appendData:a},e[ud]={persistent:!1,pure:!0,appendData:function(l){this._data=l},clean:function(){this._offset+=this.count(),this._data=null}},e);function a(l){for(var c=0;c<l.length;c++)this._data.push(l[c])}}(),t}(),JU=function(t,e,r,n){return t[n]},$we=(eg={},eg[Go+"_"+oc]=function(t,e,r,n){return t[n+e]},eg[Go+"_"+py]=function(t,e,r,n,i){n+=e;for(var a=i||[],l=t,c=0;c<l.length;c++){var o=l[c];a[c]=o?o[n]:null}return a},eg[Vl]=JU,eg[mc]=function(t,e,r,n,i){for(var a=i||[],l=0;l<r.length;l++){var c=r[l].name,o=t[c];a[l]=o?o[n]:null}return a},eg[Nl]=JU,eg);function wX(t,e){var r=$we[iB(t,e)];return r}var e8=function(t,e,r){return t.length},Hwe=(tg={},tg[Go+"_"+oc]=function(t,e,r){return Math.max(0,t.length-e)},tg[Go+"_"+py]=function(t,e,r){var n=t[0];return n?Math.max(0,n.length-e):0},tg[Vl]=e8,tg[mc]=function(t,e,r){var n=r[0].name,i=t[n];return i?i.length:0},tg[Nl]=e8,tg);function SX(t,e){var r=Hwe[iB(t,e)];return r}var eL=function(t,e,r){return t[e]},jwe=(rg={},rg[Go]=eL,rg[Vl]=function(t,e,r){return t[r]},rg[mc]=eL,rg[Nl]=function(t,e,r){var n=oy(t);return n instanceof Array?n[e]:n},rg[ud]=eL,rg);function TX(t){var e=jwe[t];return e}function iB(t,e){return t===Go?t+"_"+e:t}function H_(t,e,r){if(t){var n=t.getRawDataItem(e);if(n!=null){var i=t.getStore(),a=i.getSource().sourceFormat;if(r!=null){var l=t.getDimensionIndex(r),c=i.getDimensionProperty(l);return TX(a)(n,l,c)}else{var o=n;return a===Nl&&(o=oy(n)),o}}}}var Wwe=/\{@(.+?)\}/g,aB=function(){function t(){}return t.prototype.getDataParams=function(e,r){var n=this.getData(r),i=this.getRawValue(e,r),a=n.getRawIndex(e),l=n.getName(e),c=n.getRawDataItem(e),o=n.getItemVisual(e,"style"),d=o&&o[n.getItemVisual(e,"drawType")||"fill"],g=o&&o.stroke,m=this.mainType,y=m==="series",x=n.userOutput&&n.userOutput.get();return{componentType:m,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:y?this.subType:null,seriesIndex:this.seriesIndex,seriesId:y?this.id:null,seriesName:y?this.name:null,name:l,dataIndex:a,data:c,dataType:r,value:i,color:d,borderColor:g,dimensionNames:x?x.fullDimensions:null,encode:x?x.encode:null,$vars:["seriesName","name","value"]}},t.prototype.getFormattedLabel=function(e,r,n,i,a,l){r=r||"normal";var c=this.getData(n),o=this.getDataParams(e,n);if(l&&(o.value=l.interpolatedValue),i!=null&&Ht(o.value)&&(o.value=o.value[i]),!a){var d=c.getItemModel(e);a=d.get(r==="normal"?["label","formatter"]:[r,"label","formatter"])}if(zr(a))return o.status=r,o.dimensionIndex=i,a(o);if(yr(a)){var g=aX(a,o);return g.replace(Wwe,function(m,y){var x=y.length,A=y;A.charAt(0)==="["&&A.charAt(x-1)==="]"&&(A=+A.slice(1,x-1));var M=H_(c,e,A);if(l&&Ht(l.interpolatedValue)){var D=c.getDimensionIndex(A);D>=0&&(M=l.interpolatedValue[D])}return M!=null?M+"":""})}},t.prototype.getRawValue=function(e,r){return H_(this.getData(r),e)},t.prototype.formatTooltip=function(e,r,n){},t}();function t8(t){var e,r;return Ur(t)?t.type&&(r=t):e=t,{text:e,frag:r}}function _1(t){return new Zwe(t)}var Zwe=function(){function t(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}return t.prototype.perform=function(e){var r=this._upstream,n=e&&e.skip;if(this._dirty&&r){var i=this.context;i.data=i.outputData=r.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var a;this._plan&&!n&&(a=this._plan(this.context));var l=g(this._modBy),c=this._modDataCount||0,o=g(e&&e.modBy),d=e&&e.modDataCount||0;(l!==o||c!==d)&&(a="reset");function g(O){return!(O>=1)&&(O=1),O}var m;(this._dirty||a==="reset")&&(this._dirty=!1,m=this._doReset(n)),this._modBy=o,this._modDataCount=d;var y=e&&e.step;if(r?this._dueEnd=r._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var x=this._dueIndex,A=Math.min(y!=null?this._dueIndex+y:1/0,this._dueEnd);if(!n&&(m||x<A)){var M=this._progress;if(Ht(M))for(var D=0;D<M.length;D++)this._doProgress(M[D],x,A,o,d);else this._doProgress(M,x,A,o,d)}this._dueIndex=A;var P=this._settedOutputEnd!=null?this._settedOutputEnd:A;this._outputDueEnd=P}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},t.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},t.prototype._doProgress=function(e,r,n,i,a){r8.reset(r,n,i,a),this._callingProgress=e,this._callingProgress({start:r,end:n,count:n-r,next:r8.next},this.context)},t.prototype._doReset=function(e){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var r,n;!e&&this._reset&&(r=this._reset(this.context),r&&r.progress&&(n=r.forceFirstProgress,r=r.progress),Ht(r)&&!r.length&&(r=null)),this._progress=r,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),n},t.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},t.prototype.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},t.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},t.prototype.getUpstream=function(){return this._upstream},t.prototype.getDownstream=function(){return this._downstream},t.prototype.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},t}(),r8=function(){var t,e,r,n,i,a={reset:function(o,d,g,m){e=o,t=d,r=g,n=m,i=Math.ceil(n/r),a.next=r>1&&n>0?c:l}};return a;function l(){return e<t?e++:null}function c(){var o=e%i*r+Math.ceil(e/i),d=e>=t?null:o<n?o:e;return e++,d}}();function cd(t,e){var r=e&&e.type;return r==="ordinal"?t:(r==="time"&&!ii(t)&&t!=null&&t!=="-"&&(t=+dc(t)),t==null||t===""?NaN:+t)}var qwe=Ir({number:function(t){return parseFloat(t)},time:function(t){return+dc(t)},trim:function(t){return yr(t)?fu(t):t}});function AX(t){return qwe.get(t)}var CX={lt:function(t,e){return t<e},lte:function(t,e){return t<=e},gt:function(t,e){return t>e},gte:function(t,e){return t>=e}},Ywe=function(){function t(e,r){if(!ii(r)){var n="";vi(n)}this._opFn=CX[e],this._rvalFloat=ph(r)}return t.prototype.evaluate=function(e){return ii(e)?this._opFn(e,this._rvalFloat):this._opFn(ph(e),this._rvalFloat)},t}(),MX=function(){function t(e,r){var n=e==="desc";this._resultLT=n?1:-1,r==null&&(r=n?"min":"max"),this._incomparable=r==="min"?-1/0:1/0}return t.prototype.evaluate=function(e,r){var n=ii(e)?e:ph(e),i=ii(r)?r:ph(r),a=isNaN(n),l=isNaN(i);if(a&&(n=this._incomparable),l&&(i=this._incomparable),a&&l){var c=yr(e),o=yr(r);c&&(n=o?e:0),o&&(i=c?r:0)}return n<i?this._resultLT:n>i?-this._resultLT:0},t}(),Xwe=function(){function t(e,r){this._rval=r,this._isEQ=e,this._rvalTypeof=typeof r,this._rvalFloat=ph(r)}return t.prototype.evaluate=function(e){var r=e===this._rval;if(!r){var n=typeof e;n!==this._rvalTypeof&&(n==="number"||this._rvalTypeof==="number")&&(r=ph(e)===this._rvalFloat)}return this._isEQ?r:!r},t}();function Qwe(t,e){return t==="eq"||t==="ne"?new Xwe(t==="eq",e):Cr(CX,t)?new Ywe(t,e):null}var Kwe=function(){function t(){}return t.prototype.getRawData=function(){throw new Error("not supported")},t.prototype.getRawDataItem=function(e){throw new Error("not supported")},t.prototype.cloneRawData=function(){},t.prototype.getDimensionInfo=function(e){},t.prototype.cloneAllDimensionInfo=function(){},t.prototype.count=function(){},t.prototype.retrieveValue=function(e,r){},t.prototype.retrieveValueFromItem=function(e,r){},t.prototype.convertValue=function(e,r){return cd(e,r)},t}();function Jwe(t,e){var r=new Kwe,n=t.data,i=r.sourceFormat=t.sourceFormat,a=t.startIndex,l="";t.seriesLayoutBy!==oc&&vi(l);var c=[],o={},d=t.dimensionsDefine;if(d)fe(d,function(M,D){var P=M.name,O={index:D,name:P,displayName:M.displayName};if(c.push(O),P!=null){var z="";Cr(o,P)&&vi(z),o[P]=O}});else for(var g=0;g<t.dimensionsDetectedCount;g++)c.push({index:g});var m=wX(i,oc);e.__isBuiltIn&&(r.getRawDataItem=function(M){return m(n,a,c,M)},r.getRawData=wr(eSe,null,t)),r.cloneRawData=wr(tSe,null,t);var y=SX(i,oc);r.count=wr(y,null,n,a,c);var x=TX(i);r.retrieveValue=function(M,D){var P=m(n,a,c,M);return A(P,D)};var A=r.retrieveValueFromItem=function(M,D){if(M!=null){var P=c[D];if(P)return x(M,D,P.name)}};return r.getDimensionInfo=wr(rSe,null,c,o),r.cloneAllDimensionInfo=wr(nSe,null,c),r}function eSe(t){var e=t.sourceFormat;if(!oB(e)){var r="";vi(r)}return t.data}function tSe(t){var e=t.sourceFormat,r=t.data;if(!oB(e)){var n="";vi(n)}if(e===Go){for(var i=[],a=0,l=r.length;a<l;a++)i.push(r[a].slice());return i}else if(e===Vl){for(var i=[],a=0,l=r.length;a<l;a++)i.push(Lt({},r[a]));return i}}function rSe(t,e,r){if(r!=null){if(ii(r)||!isNaN(r)&&!Cr(e,r))return t[r];if(Cr(e,r))return e[r]}}function nSe(t){return $r(t)}var IX=Ir();function iSe(t){t=$r(t);var e=t.type,r="";e||vi(r);var n=e.split(":");n.length!==2&&vi(r);var i=!1;n[0]==="echarts"&&(e=n[1],i=!0),t.__isBuiltIn=i,IX.set(e,t)}function aSe(t,e,r){var n=Pi(t),i=n.length,a="";i||vi(a);for(var l=0,c=i;l<c;l++){var o=n[l];e=oSe(o,e),l!==c-1&&(e.length=Math.max(e.length,1))}return e}function oSe(t,e,r,n){var i="";e.length||vi(i),Ur(t)||vi(i);var a=t.type,l=IX.get(a);l||vi(i);var c=Zt(e,function(d){return Jwe(d,l)}),o=Pi(l.transform({upstream:c[0],upstreamList:c,config:$r(t.config)}));return Zt(o,function(d,g){var m="";Ur(d)||vi(m),d.data||vi(m);var y=yX(d.data);oB(y)||vi(m);var x,A=e[0];if(A&&g===0&&!d.dimensions){var M=A.startIndex;M&&(d.data=A.data.slice(0,M).concat(d.data)),x={seriesLayoutBy:oc,sourceHeader:M,dimensions:A.metaRawOption.dimensions}}else x={seriesLayoutBy:oc,sourceHeader:0,dimensions:d.dimensions};return nO(d.data,x,null)})}function oB(t){return t===Go||t===Vl}var wI="undefined",sSe=typeof Uint32Array===wI?Array:Uint32Array,lSe=typeof Uint16Array===wI?Array:Uint16Array,EX=typeof Int32Array===wI?Array:Int32Array,n8=typeof Float64Array===wI?Array:Float64Array,DX={float:n8,int:EX,ordinal:Array,number:Array,time:n8},tL;function vx(t){return t>65535?sSe:lSe}function Qm(){return[1/0,-1/0]}function uSe(t){var e=t.constructor;return e===Array?t.slice():new e(t)}function i8(t,e,r,n,i){var a=DX[r||"float"];if(i){var l=t[e],c=l&&l.length;if(c!==n){for(var o=new a(n),d=0;d<c;d++)o[d]=l[d];t[e]=o}}else t[e]=new a(n)}var iO=function(){function t(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=Ir()}return t.prototype.initData=function(e,r,n){this._provider=e,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=e.getSource(),a=this.defaultDimValueGetter=tL[i.sourceFormat];this._dimValueGetter=n||a,this._rawExtent=[],xX(i),this._dimensions=Zt(r,function(l){return{type:l.type,property:l.property}}),this._initDataFromProvider(0,e.count())},t.prototype.getProvider=function(){return this._provider},t.prototype.getSource=function(){return this._provider.getSource()},t.prototype.ensureCalculationDimension=function(e,r){var n=this._calcDimNameToIdx,i=this._dimensions,a=n.get(e);if(a!=null){if(i[a].type===r)return a}else a=i.length;return i[a]={type:r},n.set(e,a),this._chunks[a]=new DX[r||"float"](this._rawCount),this._rawExtent[a]=Qm(),a},t.prototype.collectOrdinalMeta=function(e,r){var n=this._chunks[e],i=this._dimensions[e],a=this._rawExtent,l=i.ordinalOffset||0,c=n.length;l===0&&(a[e]=Qm());for(var o=a[e],d=l;d<c;d++){var g=n[d]=r.parseAndCollect(n[d]);isNaN(g)||(o[0]=Math.min(g,o[0]),o[1]=Math.max(g,o[1]))}i.ordinalMeta=r,i.ordinalOffset=c,i.type="ordinal"},t.prototype.getOrdinalMeta=function(e){var r=this._dimensions[e],n=r.ordinalMeta;return n},t.prototype.getDimensionProperty=function(e){var r=this._dimensions[e];return r&&r.property},t.prototype.appendData=function(e){var r=this._provider,n=this.count();r.appendData(e);var i=r.count();return r.persistent||(i+=n),n<i&&this._initDataFromProvider(n,i,!0),[n,i]},t.prototype.appendValues=function(e,r){for(var n=this._chunks,i=this._dimensions,a=i.length,l=this._rawExtent,c=this.count(),o=c+Math.max(e.length,r||0),d=0;d<a;d++){var g=i[d];i8(n,d,g.type,o,!0)}for(var m=[],y=c;y<o;y++)for(var x=y-c,A=0;A<a;A++){var g=i[A],M=tL.arrayRows.call(this,e[x]||m,g.property,x,A);n[A][y]=M;var D=l[A];M<D[0]&&(D[0]=M),M>D[1]&&(D[1]=M)}return this._rawCount=this._count=o,{start:c,end:o}},t.prototype._initDataFromProvider=function(e,r,n){for(var i=this._provider,a=this._chunks,l=this._dimensions,c=l.length,o=this._rawExtent,d=Zt(l,function(O){return O.property}),g=0;g<c;g++){var m=l[g];o[g]||(o[g]=Qm()),i8(a,g,m.type,r,n)}if(i.fillStorage)i.fillStorage(e,r,a,o);else for(var y=[],x=e;x<r;x++){y=i.getItem(x,y);for(var A=0;A<c;A++){var M=a[A],D=this._dimValueGetter(y,d[A],x,A);M[x]=D;var P=o[A];D<P[0]&&(P[0]=D),D>P[1]&&(P[1]=D)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=r,this._extent=[]},t.prototype.count=function(){return this._count},t.prototype.get=function(e,r){if(!(r>=0&&r<this._count))return NaN;var n=this._chunks[e];return n?n[this.getRawIndex(r)]:NaN},t.prototype.getValues=function(e,r){var n=[],i=[];if(r==null){r=e,e=[];for(var a=0;a<this._dimensions.length;a++)i.push(a)}else i=e;for(var a=0,l=i.length;a<l;a++)n.push(this.get(i[a],r));return n},t.prototype.getByRawIndex=function(e,r){if(!(r>=0&&r<this._rawCount))return NaN;var n=this._chunks[e];return n?n[r]:NaN},t.prototype.getSum=function(e){var r=this._chunks[e],n=0;if(r)for(var i=0,a=this.count();i<a;i++){var l=this.get(e,i);isNaN(l)||(n+=l)}return n},t.prototype.getMedian=function(e){var r=[];this.each([e],function(a){isNaN(a)||r.push(a)});var n=r.sort(function(a,l){return a-l}),i=this.count();return i===0?0:i%2===1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},t.prototype.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var r=this._indices,n=r[e];if(n!=null&&n<this._count&&n===e)return e;for(var i=0,a=this._count-1;i<=a;){var l=(i+a)/2|0;if(r[l]<e)i=l+1;else if(r[l]>e)a=l-1;else return l}return-1},t.prototype.indicesOfNearest=function(e,r,n){var i=this._chunks,a=i[e],l=[];if(!a)return l;n==null&&(n=1/0);for(var c=1/0,o=-1,d=0,g=0,m=this.count();g<m;g++){var y=this.getRawIndex(g),x=r-a[y],A=Math.abs(x);A<=n&&((A<c||A===c&&x>=0&&o<0)&&(c=A,o=x,d=0),x===o&&(l[d++]=g))}return l.length=d,l},t.prototype.getIndices=function(){var e,r=this._indices;if(r){var n=r.constructor,i=this._count;if(n===Array){e=new n(i);for(var a=0;a<i;a++)e[a]=r[a]}else e=new n(r.buffer,0,i)}else{var n=vx(this._rawCount);e=new n(this.count());for(var a=0;a<e.length;a++)e[a]=a}return e},t.prototype.filter=function(e,r){if(!this._count)return this;for(var n=this.clone(),i=n.count(),a=vx(n._rawCount),l=new a(i),c=[],o=e.length,d=0,g=e[0],m=n._chunks,y=0;y<i;y++){var x=void 0,A=n.getRawIndex(y);if(o===0)x=r(y);else if(o===1){var M=m[g][A];x=r(M,y)}else{for(var D=0;D<o;D++)c[D]=m[e[D]][A];c[D]=y,x=r.apply(null,c)}x&&(l[d++]=A)}return d<i&&(n._indices=l),n._count=d,n._extent=[],n._updateGetRawIdx(),n},t.prototype.selectRange=function(e){var r=this.clone(),n=r._count;if(!n)return this;var i=Hn(e),a=i.length;if(!a)return this;var l=r.count(),c=vx(r._rawCount),o=new c(l),d=0,g=i[0],m=e[g][0],y=e[g][1],x=r._chunks,A=!1;if(!r._indices){var M=0;if(a===1){for(var D=x[i[0]],P=0;P<n;P++){var O=D[P];(O>=m&&O<=y||isNaN(O))&&(o[d++]=M),M++}A=!0}else if(a===2){for(var D=x[i[0]],z=x[i[1]],V=e[i[1]][0],H=e[i[1]][1],P=0;P<n;P++){var O=D[P],$=z[P];(O>=m&&O<=y||isNaN(O))&&($>=V&&$<=H||isNaN($))&&(o[d++]=M),M++}A=!0}}if(!A)if(a===1)for(var P=0;P<l;P++){var X=r.getRawIndex(P),O=x[i[0]][X];(O>=m&&O<=y||isNaN(O))&&(o[d++]=X)}else for(var P=0;P<l;P++){for(var W=!0,X=r.getRawIndex(P),Y=0;Y<a;Y++){var J=i[Y],O=x[J][X];(O<e[J][0]||O>e[J][1])&&(W=!1)}W&&(o[d++]=r.getRawIndex(P))}return d<l&&(r._indices=o),r._count=d,r._extent=[],r._updateGetRawIdx(),r},t.prototype.map=function(e,r){var n=this.clone(e);return this._updateDims(n,e,r),n},t.prototype.modify=function(e,r){this._updateDims(this,e,r)},t.prototype._updateDims=function(e,r,n){for(var i=e._chunks,a=[],l=r.length,c=e.count(),o=[],d=e._rawExtent,g=0;g<r.length;g++)d[r[g]]=Qm();for(var m=0;m<c;m++){for(var y=e.getRawIndex(m),x=0;x<l;x++)o[x]=i[r[x]][y];o[l]=m;var A=n&&n.apply(null,o);if(A!=null){typeof A!="object"&&(a[0]=A,A=a);for(var g=0;g<A.length;g++){var M=r[g],D=A[g],P=d[M],O=i[M];O&&(O[y]=D),D<P[0]&&(P[0]=D),D>P[1]&&(P[1]=D)}}}},t.prototype.lttbDownSample=function(e,r){var n=this.clone([e],!0),i=n._chunks,a=i[e],l=this.count(),c=0,o=Math.floor(1/r),d=this.getRawIndex(0),g,m,y,x=new(vx(this._rawCount))(Math.min((Math.ceil(l/o)+2)*2,l));x[c++]=d;for(var A=1;A<l-1;A+=o){for(var M=Math.min(A+o,l-1),D=Math.min(A+o*2,l),P=(D+M)/2,O=0,z=M;z<D;z++){var V=this.getRawIndex(z),H=a[V];isNaN(H)||(O+=H)}O/=D-M;var $=A,X=Math.min(A+o,l),W=A-1,Y=a[d];g=-1,y=$;for(var J=-1,re=0,z=$;z<X;z++){var V=this.getRawIndex(z),H=a[V];if(isNaN(H)){re++,J<0&&(J=V);continue}m=Math.abs((W-P)*(H-Y)-(W-z)*(O-Y)),m>g&&(g=m,y=V)}re>0&&re<X-$&&(x[c++]=Math.min(J,y),y=Math.max(J,y)),x[c++]=y,d=y}return x[c++]=this.getRawIndex(l-1),n._count=c,n._indices=x,n.getRawIndex=this._getRawIdx,n},t.prototype.downSample=function(e,r,n,i){for(var a=this.clone([e],!0),l=a._chunks,c=[],o=Math.floor(1/r),d=l[e],g=this.count(),m=a._rawExtent[e]=Qm(),y=new(vx(this._rawCount))(Math.ceil(g/o)),x=0,A=0;A<g;A+=o){o>g-A&&(o=g-A,c.length=o);for(var M=0;M<o;M++){var D=this.getRawIndex(A+M);c[M]=d[D]}var P=n(c),O=this.getRawIndex(Math.min(A+i(c,P)||0,g-1));d[O]=P,P<m[0]&&(m[0]=P),P>m[1]&&(m[1]=P),y[x++]=O}return a._count=x,a._indices=y,a._updateGetRawIdx(),a},t.prototype.each=function(e,r){if(this._count)for(var n=e.length,i=this._chunks,a=0,l=this.count();a<l;a++){var c=this.getRawIndex(a);switch(n){case 0:r(a);break;case 1:r(i[e[0]][c],a);break;case 2:r(i[e[0]][c],i[e[1]][c],a);break;default:for(var o=0,d=[];o<n;o++)d[o]=i[e[o]][c];d[o]=a,r.apply(null,d)}}},t.prototype.getDataExtent=function(e){var r=this._chunks[e],n=Qm();if(!r)return n;var i=this.count(),a=!this._indices,l;if(a)return this._rawExtent[e].slice();if(l=this._extent[e],l)return l.slice();l=n;for(var c=l[0],o=l[1],d=0;d<i;d++){var g=this.getRawIndex(d),m=r[g];m<c&&(c=m),m>o&&(o=m)}return l=[c,o],this._extent[e]=l,l},t.prototype.getRawDataItem=function(e){var r=this.getRawIndex(e);if(this._provider.persistent)return this._provider.getItem(r);for(var n=[],i=this._chunks,a=0;a<i.length;a++)n.push(i[a][r]);return n},t.prototype.clone=function(e,r){var n=new t,i=this._chunks,a=e&&cc(e,function(c,o){return c[o]=!0,c},{});if(a)for(var l=0;l<i.length;l++)n._chunks[l]=a[l]?uSe(i[l]):i[l];else n._chunks=i;return this._copyCommonProps(n),r||(n._indices=this._cloneIndices()),n._updateGetRawIdx(),n},t.prototype._copyCommonProps=function(e){e._count=this._count,e._rawCount=this._rawCount,e._provider=this._provider,e._dimensions=this._dimensions,e._extent=$r(this._extent),e._rawExtent=$r(this._rawExtent)},t.prototype._cloneIndices=function(){if(this._indices){var e=this._indices.constructor,r=void 0;if(e===Array){var n=this._indices.length;r=new e(n);for(var i=0;i<n;i++)r[i]=this._indices[i]}else r=new e(this._indices);return r}return null},t.prototype._getRawIdxIdentity=function(e){return e},t.prototype._getRawIdx=function(e){return e<this._count&&e>=0?this._indices[e]:-1},t.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},t.internalField=function(){function e(r,n,i,a){return cd(r[a],this._dimensions[a])}tL={arrayRows:e,objectRows:function(r,n,i,a){return cd(r[n],this._dimensions[a])},keyedColumns:e,original:function(r,n,i,a){var l=r&&(r.value==null?r:r.value);return cd(l instanceof Array?l[a]:l,this._dimensions[a])},typedArray:function(r,n,i,a){return r[a]}}}(),t}(),PX=function(){function t(e){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=e}return t.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},t.prototype._setLocalSource=function(e,r){this._sourceList=e,this._upstreamSignList=r,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},t.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},t.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},t.prototype._createSource=function(){this._setLocalSource([],[]);var e=this._sourceHost,r=this._getUpstreamSourceManagers(),n=!!r.length,i,a;if(BT(e)){var l=e,c=void 0,o=void 0,d=void 0;if(n){var g=r[0];g.prepareSource(),d=g.getSource(),c=d.data,o=d.sourceFormat,a=[g._getVersionSign()]}else c=l.get("data",!0),o=Is(c)?ud:Nl,a=[];var m=this._getSourceMetaRawOption()||{},y=d&&d.metaRawOption||{},x=tn(m.seriesLayoutBy,y.seriesLayoutBy)||null,A=tn(m.sourceHeader,y.sourceHeader),M=tn(m.dimensions,y.dimensions),D=x!==y.seriesLayoutBy||!!A!=!!y.sourceHeader||M;i=D?[nO(c,{seriesLayoutBy:x,sourceHeader:A,dimensions:M},o)]:[]}else{var P=e;if(n){var O=this._applyTransform(r);i=O.sourceList,a=O.upstreamSignList}else{var z=P.get("source",!0);i=[nO(z,this._getSourceMetaRawOption(),null)],a=[]}}this._setLocalSource(i,a)},t.prototype._applyTransform=function(e){var r=this._sourceHost,n=r.get("transform",!0),i=r.get("fromTransformResult",!0);if(i!=null){var a="";e.length!==1&&o8(a)}var l,c=[],o=[];return fe(e,function(d){d.prepareSource();var g=d.getSource(i||0),m="";i!=null&&!g&&o8(m),c.push(g),o.push(d._getVersionSign())}),n?l=aSe(n,c,{datasetIndex:r.componentIndex}):i!=null&&(l=[Vwe(c[0])]),{sourceList:l,upstreamSignList:o}},t.prototype._isDirty=function(){if(this._dirty)return!0;for(var e=this._getUpstreamSourceManagers(),r=0;r<e.length;r++){var n=e[r];if(n._isDirty()||this._upstreamSignList[r]!==n._getVersionSign())return!0}},t.prototype.getSource=function(e){e=e||0;var r=this._sourceList[e];if(!r){var n=this._getUpstreamSourceManagers();return n[0]&&n[0].getSource(e)}return r},t.prototype.getSharedDataStore=function(e){var r=e.makeStoreSchema();return this._innerGetDataStore(r.dimensions,e.source,r.hash)},t.prototype._innerGetDataStore=function(e,r,n){var i=0,a=this._storeList,l=a[i];l||(l=a[i]={});var c=l[n];if(!c){var o=this._getUpstreamSourceManagers()[0];BT(this._sourceHost)&&o?c=o._innerGetDataStore(e,r,n):(c=new iO,c.initData(new bX(r,e.length),e)),l[n]=c}return c},t.prototype._getUpstreamSourceManagers=function(){var e=this._sourceHost;if(BT(e)){var r=Jz(e);return r?[r.getSourceManager()]:[]}else return Zt(gwe(e),function(n){return n.getSourceManager()})},t.prototype._getSourceMetaRawOption=function(){var e=this._sourceHost,r,n,i;if(BT(e))r=e.get("seriesLayoutBy",!0),n=e.get("sourceHeader",!0),i=e.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=e;r=a.get("seriesLayoutBy",!0),n=a.get("sourceHeader",!0),i=a.get("dimensions",!0)}return{seriesLayoutBy:r,sourceHeader:n,dimensions:i}},t}();function a8(t){var e=t.option.transform;e&&bC(t.option.transform)}function BT(t){return t.mainType==="series"}function o8(t){throw new Error(t)}var LX="line-height:1";function RX(t,e){var r=t.color||"#6e7079",n=t.fontSize||12,i=t.fontWeight||"400",a=t.color||"#464646",l=t.fontSize||14,c=t.fontWeight||"900";return e==="html"?{nameStyle:"font-size:"+qs(n+"")+"px;color:"+qs(r)+";font-weight:"+qs(i+""),valueStyle:"font-size:"+qs(l+"")+"px;color:"+qs(a)+";font-weight:"+qs(c+"")}:{nameStyle:{fontSize:n,fill:r,fontWeight:i},valueStyle:{fontSize:l,fill:a,fontWeight:c}}}var cSe=[0,10,20,30],hSe=["",`
`,`

`,`


`];function ro(t,e){return e.type=t,e}function aO(t){return t.type==="section"}function kX(t){return aO(t)?fSe:dSe}function OX(t){if(aO(t)){var e=0,r=t.blocks.length,n=r>1||r>0&&!t.noHeader;return fe(t.blocks,function(i){var a=OX(i);a>=e&&(e=a+ +(n&&(!a||aO(i)&&!i.noHeader)))}),e}return 0}function fSe(t,e,r,n){var i=e.noHeader,a=pSe(OX(e)),l=[],c=e.blocks||[];ns(!c||Ht(c)),c=c||[];var o=t.orderMode;if(e.sortBlocks&&o){c=c.slice();var d={valueAsc:"asc",valueDesc:"desc"};if(Cr(d,o)){var g=new MX(d[o],null);c.sort(function(A,M){return g.evaluate(A.sortParam,M.sortParam)})}else o==="seriesDesc"&&c.reverse()}fe(c,function(A,M){var D=e.valueFormatter,P=kX(A)(D?Lt(Lt({},t),{valueFormatter:D}):t,A,M>0?a.html:0,n);P!=null&&l.push(P)});var m=t.renderMode==="richText"?l.join(a.richText):oO(l.join(""),i?r:a.html);if(i)return m;var y=eO(e.header,"ordinal",t.useUTC),x=RX(n,t.renderMode).nameStyle;return t.renderMode==="richText"?zX(t,y,x)+a.richText+m:oO('<div style="'+x+";"+LX+';">'+qs(y)+"</div>"+m,r)}function dSe(t,e,r,n){var i=t.renderMode,a=e.noName,l=e.noValue,c=!e.markerType,o=e.name,d=t.useUTC,g=e.valueFormatter||t.valueFormatter||function(V){return V=Ht(V)?V:[V],Zt(V,function(H,$){return eO(H,Ht(x)?x[$]:x,d)})};if(!(a&&l)){var m=c?"":t.markupStyleCreator.makeTooltipMarker(e.markerType,e.markerColor||"#333",i),y=a?"":eO(o,"ordinal",d),x=e.valueType,A=l?[]:g(e.value,e.dataIndex),M=!c||!a,D=!c&&a,P=RX(n,i),O=P.nameStyle,z=P.valueStyle;return i==="richText"?(c?"":m)+(a?"":zX(t,y,O))+(l?"":mSe(t,A,M,D,z)):oO((c?"":m)+(a?"":gSe(y,!c,O))+(l?"":vSe(A,M,D,z)),r)}}function s8(t,e,r,n,i,a){if(t){var l=kX(t),c={useUTC:i,renderMode:r,orderMode:n,markupStyleCreator:e,valueFormatter:t.valueFormatter};return l(c,t,0,a)}}function pSe(t){return{html:cSe[t],richText:hSe[t]}}function oO(t,e){var r='<div style="clear:both"></div>',n="margin: "+e+"px 0 0";return'<div style="'+n+";"+LX+';">'+t+r+"</div>"}function gSe(t,e,r){var n=e?"margin-left:2px":"";return'<span style="'+r+";"+n+'">'+qs(t)+"</span>"}function vSe(t,e,r,n){var i=r?"10px":"20px",a=e?"float:right;margin-left:"+i:"";return t=Ht(t)?t:[t],'<span style="'+a+";"+n+'">'+Zt(t,function(l){return qs(l)}).join("&nbsp;&nbsp;")+"</span>"}function zX(t,e,r){return t.markupStyleCreator.wrapRichTextStyle(e,r)}function mSe(t,e,r,n,i){var a=[i],l=n?10:20;return r&&a.push({padding:[0,0,0,l],align:"right"}),t.markupStyleCreator.wrapRichTextStyle(Ht(e)?e.join("  "):e,a)}function BX(t,e){var r=t.getData().getItemVisual(e,"style"),n=r[t.visualDrawType];return nv(n)}function FX(t,e){var r=t.get("padding");return r??(e==="richText"?[8,10]:10)}var rL=function(){function t(){this.richTextStyles={},this._nextStyleNameId=Q2()}return t.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},t.prototype.makeTooltipMarker=function(e,r,n){var i=n==="richText"?this._generateStyleName():null,a=lwe({color:r,type:e,renderMode:n,markerId:i});return yr(a)?a:(this.richTextStyles[i]=a.style,a.content)},t.prototype.wrapRichTextStyle=function(e,r){var n={};Ht(r)?fe(r,function(a){return Lt(n,a)}):Lt(n,r);var i=this._generateStyleName();return this.richTextStyles[i]=n,"{"+i+"|"+e+"}"},t}();function NX(t){var e=t.series,r=t.dataIndex,n=t.multipleSeries,i=e.getData(),a=i.mapDimensionsAll("defaultedTooltip"),l=a.length,c=e.getRawValue(r),o=Ht(c),d=BX(e,r),g,m,y,x;if(l>1||o&&!l){var A=_Se(c,e,r,a,d);g=A.inlineValues,m=A.inlineValueTypes,y=A.blocks,x=A.inlineValues[0]}else if(l){var M=i.getDimensionInfo(a[0]);x=g=H_(i,r,a[0]),m=M.type}else x=g=o?c[0]:c;var D=Dz(e),P=D&&e.name||"",O=i.getName(r),z=n?P:O;return ro("section",{header:P,noHeader:n||!D,sortParam:x,blocks:[ro("nameValue",{markerType:"item",markerColor:d,name:z,noName:!fu(z),value:g,valueType:m,dataIndex:r})].concat(y||[])})}function _Se(t,e,r,n,i){var a=e.getData(),l=cc(t,function(m,y,x){var A=a.getDimensionInfo(x);return m=m||A&&A.tooltip!==!1&&A.displayName!=null},!1),c=[],o=[],d=[];n.length?fe(n,function(m){g(H_(a,r,m),m)}):fe(t,g);function g(m,y){var x=a.getDimensionInfo(y);!x||x.otherDims.tooltip===!1||(l?d.push(ro("nameValue",{markerType:"subItem",markerColor:i,name:x.displayName,value:m,valueType:x.type})):(c.push(m),o.push(x.type)))}return{inlineValues:c,inlineValueTypes:o,blocks:d}}var Af=ri();function FT(t,e){return t.getName(e)||t.getId(e)}var qA="__universalTransitionEnabled",Wi=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._selectedDataIndicesMap={},r}return e.prototype.init=function(r,n,i){this.seriesIndex=this.componentIndex,this.dataTask=_1({count:xSe,reset:bSe}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(r,i);var a=Af(this).sourceManager=new PX(this);a.prepareSource();var l=this.getInitialData(r,i);u8(l,this),this.dataTask.context.data=l,Af(this).dataBeforeProcessed=l,l8(this),this._initSelectedMapFromData(l)},e.prototype.mergeDefaultAndTheme=function(r,n){var i=q1(this),a=i?dy(r):{},l=this.subType;$n.hasClass(l)&&(l+="Series"),pn(r,n.getTheme().get(this.subType)),pn(r,this.getDefaultOption()),Jg(r,"label",["show"]),this.fillDataTextStyle(r.data),i&&_d(r,a,i)},e.prototype.mergeOption=function(r,n){r=pn(this.option,r,!0),this.fillDataTextStyle(r.data);var i=q1(this);i&&_d(this.option,r,i);var a=Af(this).sourceManager;a.dirty(),a.prepareSource();var l=this.getInitialData(r,n);u8(l,this),this.dataTask.dirty(),this.dataTask.context.data=l,Af(this).dataBeforeProcessed=l,l8(this),this._initSelectedMapFromData(l)},e.prototype.fillDataTextStyle=function(r){if(r&&!Is(r))for(var n=["show"],i=0;i<r.length;i++)r[i]&&r[i].label&&Jg(r[i],"label",n)},e.prototype.getInitialData=function(r,n){},e.prototype.appendData=function(r){var n=this.getRawData();n.appendData(r.data)},e.prototype.getData=function(r){var n=sO(this);if(n){var i=n.context.data;return r==null?i:i.getLinkedData(r)}else return Af(this).data},e.prototype.getAllData=function(){var r=this.getData();return r&&r.getLinkedDataAll?r.getLinkedDataAll():[{data:r}]},e.prototype.setData=function(r){var n=sO(this);if(n){var i=n.context;i.outputData=r,n!==this.dataTask&&(i.data=r)}Af(this).data=r},e.prototype.getEncode=function(){var r=this.get("encode",!0);if(r)return Ir(r)},e.prototype.getSourceManager=function(){return Af(this).sourceManager},e.prototype.getSource=function(){return this.getSourceManager().getSource()},e.prototype.getRawData=function(){return Af(this).dataBeforeProcessed},e.prototype.getColorBy=function(){var r=this.get("colorBy");return r||"series"},e.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},e.prototype.getBaseAxis=function(){var r=this.coordinateSystem;return r&&r.getBaseAxis&&r.getBaseAxis()},e.prototype.formatTooltip=function(r,n,i){return NX({series:this,dataIndex:r,multipleSeries:n})},e.prototype.isAnimationEnabled=function(){var r=this.ecModel;if(Nn.node&&!(r&&r.ssr))return!1;var n=this.getShallow("animation");return n&&this.getData().count()>this.getShallow("animationThreshold")&&(n=!1),!!n},e.prototype.restoreData=function(){this.dataTask.dirty()},e.prototype.getColorFromPalette=function(r,n,i){var a=this.ecModel,l=eB.prototype.getColorFromPalette.call(this,r,n,i);return l||(l=a.getColorFromPalette(r,n,i)),l},e.prototype.coordDimToDataDim=function(r){return this.getRawData().mapDimensionsAll(r)},e.prototype.getProgressive=function(){return this.get("progressive")},e.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},e.prototype.select=function(r,n){this._innerSelect(this.getData(n),r)},e.prototype.unselect=function(r,n){var i=this.option.selectedMap;if(i){var a=this.option.selectedMode,l=this.getData(n);if(a==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var c=0;c<r.length;c++){var o=r[c],d=FT(l,o);i[d]=!1,this._selectedDataIndicesMap[d]=-1}}},e.prototype.toggleSelect=function(r,n){for(var i=[],a=0;a<r.length;a++)i[0]=r[a],this.isSelected(r[a],n)?this.unselect(i,n):this.select(i,n)},e.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var r=this._selectedDataIndicesMap,n=Hn(r),i=[],a=0;a<n.length;a++){var l=r[n[a]];l>=0&&i.push(l)}return i},e.prototype.isSelected=function(r,n){var i=this.option.selectedMap;if(!i)return!1;var a=this.getData(n);return(i==="all"||i[FT(a,r)])&&!a.getItemModel(r).get(["select","disabled"])},e.prototype.isUniversalTransitionEnabled=function(){if(this[qA])return!0;var r=this.option.universalTransition;return r?r===!0?!0:r&&r.enabled:!1},e.prototype._innerSelect=function(r,n){var i,a,l=this.option,c=l.selectedMode,o=n.length;if(!(!c||!o)){if(c==="series")l.selectedMap="all";else if(c==="multiple"){Ur(l.selectedMap)||(l.selectedMap={});for(var d=l.selectedMap,g=0;g<o;g++){var m=n[g],y=FT(r,m);d[y]=!0,this._selectedDataIndicesMap[y]=r.getRawIndex(m)}}else if(c==="single"||c===!0){var x=n[o-1],y=FT(r,x);l.selectedMap=(i={},i[y]=!0,i),this._selectedDataIndicesMap=(a={},a[y]=r.getRawIndex(x),a)}}},e.prototype._initSelectedMapFromData=function(r){if(!this.option.selectedMap){var n=[];r.hasItemOption&&r.each(function(i){var a=r.getRawDataItem(i);a&&a.selected&&n.push(i)}),n.length>0&&this._innerSelect(r,n)}},e.registerClass=function(r){return $n.registerClass(r)},e.protoInitialize=function(){var r=e.prototype;r.type="series.__base__",r.seriesIndex=0,r.ignoreStyleOnData=!1,r.hasSymbolVisual=!1,r.defaultSymbol="circle",r.visualStyleAccessPath="itemStyle",r.visualDrawType="fill"}(),e}($n);Ea(Wi,aB);Ea(Wi,eB);oY(Wi,$n);function l8(t){var e=t.name;Dz(t)||(t.name=ySe(t)||e)}function ySe(t){var e=t.getRawData(),r=e.mapDimensionsAll("seriesName"),n=[];return fe(r,function(i){var a=e.getDimensionInfo(i);a.displayName&&n.push(a.displayName)}),n.join(" ")}function xSe(t){return t.model.getRawData().count()}function bSe(t){var e=t.model;return e.setData(e.getRawData().cloneShallow()),wSe}function wSe(t,e){e.outputData&&t.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function u8(t,e){fe(wC(t.CHANGABLE_METHODS,t.DOWNSAMPLE_METHODS),function(r){t.wrapMethod(r,on(SSe,e))})}function SSe(t,e){var r=sO(t);return r&&r.setOutputEnd((e||this).count()),e}function sO(t){var e=(t.ecModel||{}).scheduler,r=e&&e.getPipeline(t.uid);if(r){var n=r.currentTask;if(n){var i=n.agentStubMap;i&&(n=i.get(t.uid))}return n}}var ra=function(){function t(){this.group=new jr,this.uid=hy("viewComponent")}return t.prototype.init=function(e,r){},t.prototype.render=function(e,r,n,i){},t.prototype.dispose=function(e,r){},t.prototype.updateView=function(e,r,n,i){},t.prototype.updateLayout=function(e,r,n,i){},t.prototype.updateVisual=function(e,r,n,i){},t.prototype.toggleBlurSeries=function(e,r,n){},t.prototype.eachRendered=function(e){var r=this.group;r&&r.traverse(e)},t}();Lz(ra);iI(ra);function gy(){var t=ri();return function(e){var r=t(e),n=e.pipelineContext,i=!!r.large,a=!!r.progressiveRender,l=r.large=!!(n&&n.large),c=r.progressiveRender=!!(n&&n.progressiveRender);return(i!==l||a!==c)&&"reset"}}var VX=ri(),TSe=gy(),Oi=function(){function t(){this.group=new jr,this.uid=hy("viewChart"),this.renderTask=_1({plan:ASe,reset:CSe}),this.renderTask.context={view:this}}return t.prototype.init=function(e,r){},t.prototype.render=function(e,r,n,i){},t.prototype.highlight=function(e,r,n,i){var a=e.getData(i&&i.dataType);a&&h8(a,i,"emphasis")},t.prototype.downplay=function(e,r,n,i){var a=e.getData(i&&i.dataType);a&&h8(a,i,"normal")},t.prototype.remove=function(e,r){this.group.removeAll()},t.prototype.dispose=function(e,r){},t.prototype.updateView=function(e,r,n,i){this.render(e,r,n,i)},t.prototype.updateLayout=function(e,r,n,i){this.render(e,r,n,i)},t.prototype.updateVisual=function(e,r,n,i){this.render(e,r,n,i)},t.prototype.eachRendered=function(e){Id(this.group,e)},t.markUpdateMethod=function(e,r){VX(e).updateMethod=r},t.protoInitialize=function(){var e=t.prototype;e.type="chart"}(),t}();function c8(t,e,r){t&&j1(t)&&(e==="emphasis"?gh:vh)(t,r)}function h8(t,e,r){var n=ev(t,e),i=e&&e.highlightKey!=null?ibe(e.highlightKey):null;n!=null?fe(Pi(n),function(a){c8(t.getItemGraphicEl(a),r,i)}):t.eachItemGraphicEl(function(a){c8(a,r,i)})}Lz(Oi);iI(Oi);function ASe(t){return TSe(t.model)}function CSe(t){var e=t.model,r=t.ecModel,n=t.api,i=t.payload,a=e.pipelineContext.progressiveRender,l=t.view,c=i&&VX(i).updateMethod,o=a?"incrementalPrepareRender":c&&l[c]?c:"render";return o!=="render"&&l[o](e,r,n,i),MSe[o]}var MSe={incrementalPrepareRender:{progress:function(t,e){e.view.incrementalRender(t,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(t,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},NC="\0__throttleOriginMethod",f8="\0__throttleRate",d8="\0__throttleType";function sB(t,e,r){var n,i=0,a=0,l=null,c,o,d,g;e=e||0;function m(){a=new Date().getTime(),l=null,t.apply(o,d||[])}var y=function(){for(var x=[],A=0;A<arguments.length;A++)x[A]=arguments[A];n=new Date().getTime(),o=this,d=x;var M=g||e,D=g||r;g=null,c=n-(D?i:a)-M,clearTimeout(l),D?l=setTimeout(m,M):c>=0?m():l=setTimeout(m,-c),i=n};return y.clear=function(){l&&(clearTimeout(l),l=null)},y.debounceNextCall=function(x){g=x},y}function vy(t,e,r,n){var i=t[e];if(i){var a=i[NC]||i,l=i[d8],c=i[f8];if(c!==r||l!==n){if(r==null||!n)return t[e]=a;i=t[e]=sB(a,r,n==="debounce"),i[NC]=a,i[d8]=n,i[f8]=r}return i}}function X1(t,e){var r=t[e];r&&r[NC]&&(r.clear&&r.clear(),t[e]=r[NC])}var p8=ri(),g8={itemStyle:tv(WY,!0),lineStyle:tv(jY,!0)},ISe={lineStyle:"stroke",itemStyle:"fill"};function GX(t,e){var r=t.visualStyleMapper||g8[e];return r||(console.warn("Unknown style type '"+e+"'."),g8.itemStyle)}function UX(t,e){var r=t.visualDrawType||ISe[e];return r||(console.warn("Unknown style type '"+e+"'."),"fill")}var ESe={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){var r=t.getData(),n=t.visualStyleAccessPath||"itemStyle",i=t.getModel(n),a=GX(t,n),l=a(i),c=i.getShallow("decal");c&&(r.setVisual("decal",c),c.dirty=!0);var o=UX(t,n),d=l[o],g=zr(d)?d:null,m=l.fill==="auto"||l.stroke==="auto";if(!l[o]||g||m){var y=t.getColorFromPalette(t.name,null,e.getSeriesCount());l[o]||(l[o]=y,r.setVisual("colorFromPalette",!0)),l.fill=l.fill==="auto"||zr(l.fill)?y:l.fill,l.stroke=l.stroke==="auto"||zr(l.stroke)?y:l.stroke}if(r.setVisual("style",l),r.setVisual("drawType",o),!e.isSeriesFiltered(t)&&g)return r.setVisual("colorFromPalette",!1),{dataEach:function(x,A){var M=t.getDataParams(A),D=Lt({},l);D[o]=g(M),x.setItemVisual(A,"style",D)}}}},mx=new bi,DSe={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){if(!(t.ignoreStyleOnData||e.isSeriesFiltered(t))){var r=t.getData(),n=t.visualStyleAccessPath||"itemStyle",i=GX(t,n),a=r.getVisual("drawType");return{dataEach:r.hasItemOption?function(l,c){var o=l.getRawDataItem(c);if(o&&o[n]){mx.option=o[n];var d=i(mx),g=l.ensureUniqueItemVisual(c,"style");Lt(g,d),mx.option.decal&&(l.setItemVisual(c,"decal",mx.option.decal),mx.option.decal.dirty=!0),a in d&&l.setItemVisual(c,"colorFromPalette",!1)}}:null}}}},PSe={performRawSeries:!0,overallReset:function(t){var e=Ir();t.eachSeries(function(r){var n=r.getColorBy();if(!r.isColorBySeries()){var i=r.type+"-"+n,a=e.get(i);a||(a={},e.set(i,a)),p8(r).scope=a}}),t.eachSeries(function(r){if(!(r.isColorBySeries()||t.isSeriesFiltered(r))){var n=r.getRawData(),i={},a=r.getData(),l=p8(r).scope,c=r.visualStyleAccessPath||"itemStyle",o=UX(r,c);a.each(function(d){var g=a.getRawIndex(d);i[g]=d}),n.each(function(d){var g=i[d],m=a.getItemVisual(g,"colorFromPalette");if(m){var y=a.ensureUniqueItemVisual(g,"style"),x=n.getName(d)||d+"",A=n.count();y[o]=r.getColorFromPalette(x,l,A)}})}})}},NT=Math.PI;function LSe(t,e){e=e||{},Fr(e,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var r=new jr,n=new Kn({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});r.add(n);var i=new ti({style:{text:e.text,fill:e.textColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:e.fontFamily},zlevel:e.zlevel,z:10001}),a=new Kn({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:e.zlevel,z:10001});r.add(a);var l;return e.showSpinner&&(l=new hI({shape:{startAngle:-NT/2,endAngle:-NT/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001}),l.animateShape(!0).when(1e3,{endAngle:NT*3/2}).start("circularInOut"),l.animateShape(!0).when(1e3,{startAngle:NT*3/2}).delay(300).start("circularInOut"),r.add(l)),r.resize=function(){var c=i.getBoundingRect().width,o=e.showSpinner?e.spinnerRadius:0,d=(t.getWidth()-o*2-(e.showSpinner&&c?10:0)-c)/2-(e.showSpinner&&c?0:5+c/2)+(e.showSpinner?0:c/2)+(c?0:o),g=t.getHeight()/2;e.showSpinner&&l.setShape({cx:d,cy:g}),a.setShape({x:d-o,y:g-o,width:o*2,height:o*2}),n.setShape({x:0,y:0,width:t.getWidth(),height:t.getHeight()})},r.resize(),r}var $X=function(){function t(e,r,n,i){this._stageTaskMap=Ir(),this.ecInstance=e,this.api=r,n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=n.concat(i)}return t.prototype.restoreData=function(e,r){e.restoreData(r),this._stageTaskMap.each(function(n){var i=n.overallTask;i&&i.dirty()})},t.prototype.getPerformArgs=function(e,r){if(e.__pipeline){var n=this._pipelineMap.get(e.__pipeline.id),i=n.context,a=!r&&n.progressiveEnabled&&(!i||i.progressiveRender)&&e.__idxInPipeline>n.blockIndex,l=a?n.step:null,c=i&&i.modDataCount,o=c!=null?Math.ceil(c/l):null;return{step:l,modBy:o,modDataCount:c}}},t.prototype.getPipeline=function(e){return this._pipelineMap.get(e)},t.prototype.updateStreamModes=function(e,r){var n=this._pipelineMap.get(e.uid),i=e.getData(),a=i.count(),l=n.progressiveEnabled&&r.incrementalPrepareRender&&a>=n.threshold,c=e.get("large")&&a>=e.get("largeThreshold"),o=e.get("progressiveChunkMode")==="mod"?a:null;e.pipelineContext=n.context={progressiveRender:l,modDataCount:o,large:c}},t.prototype.restorePipelines=function(e){var r=this,n=r._pipelineMap=Ir();e.eachSeries(function(i){var a=i.getProgressive(),l=i.uid;n.set(l,{id:l,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:a&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(a||700),count:0}),r._pipe(i,i.dataTask)})},t.prototype.prepareStageTasks=function(){var e=this._stageTaskMap,r=this.api.getModel(),n=this.api;fe(this._allHandlers,function(i){var a=e.get(i.uid)||e.set(i.uid,{}),l="";ns(!(i.reset&&i.overallReset),l),i.reset&&this._createSeriesStageTask(i,a,r,n),i.overallReset&&this._createOverallStageTask(i,a,r,n)},this)},t.prototype.prepareView=function(e,r,n,i){var a=e.renderTask,l=a.context;l.model=r,l.ecModel=n,l.api=i,a.__block=!e.incrementalPrepareRender,this._pipe(r,a)},t.prototype.performDataProcessorTasks=function(e,r){this._performStageTasks(this._dataProcessorHandlers,e,r,{block:!0})},t.prototype.performVisualTasks=function(e,r,n){this._performStageTasks(this._visualHandlers,e,r,n)},t.prototype._performStageTasks=function(e,r,n,i){i=i||{};var a=!1,l=this;fe(e,function(o,d){if(!(i.visualType&&i.visualType!==o.visualType)){var g=l._stageTaskMap.get(o.uid),m=g.seriesTaskMap,y=g.overallTask;if(y){var x,A=y.agentStubMap;A.each(function(D){c(i,D)&&(D.dirty(),x=!0)}),x&&y.dirty(),l.updatePayload(y,n);var M=l.getPerformArgs(y,i.block);A.each(function(D){D.perform(M)}),y.perform(M)&&(a=!0)}else m&&m.each(function(D,P){c(i,D)&&D.dirty();var O=l.getPerformArgs(D,i.block);O.skip=!o.performRawSeries&&r.isSeriesFiltered(D.context.model),l.updatePayload(D,n),D.perform(O)&&(a=!0)})}});function c(o,d){return o.setDirty&&(!o.dirtyMap||o.dirtyMap.get(d.__pipeline.id))}this.unfinished=a||this.unfinished},t.prototype.performSeriesTasks=function(e){var r;e.eachSeries(function(n){r=n.dataTask.perform()||r}),this.unfinished=r||this.unfinished},t.prototype.plan=function(){this._pipelineMap.each(function(e){var r=e.tail;do{if(r.__block){e.blockIndex=r.__idxInPipeline;break}r=r.getUpstream()}while(r)})},t.prototype.updatePayload=function(e,r){r!=="remain"&&(e.context.payload=r)},t.prototype._createSeriesStageTask=function(e,r,n,i){var a=this,l=r.seriesTaskMap,c=r.seriesTaskMap=Ir(),o=e.seriesType,d=e.getTargetSeries;e.createOnAllSeries?n.eachRawSeries(g):o?n.eachRawSeriesByType(o,g):d&&d(n,i).each(g);function g(m){var y=m.uid,x=c.set(y,l&&l.get(y)||_1({plan:BSe,reset:FSe,count:VSe}));x.context={model:m,ecModel:n,api:i,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:a},a._pipe(m,x)}},t.prototype._createOverallStageTask=function(e,r,n,i){var a=this,l=r.overallTask=r.overallTask||_1({reset:RSe});l.context={ecModel:n,api:i,overallReset:e.overallReset,scheduler:a};var c=l.agentStubMap,o=l.agentStubMap=Ir(),d=e.seriesType,g=e.getTargetSeries,m=!0,y=!1,x="";ns(!e.createOnAllSeries,x),d?n.eachRawSeriesByType(d,A):g?g(n,i).each(A):(m=!1,fe(n.getSeries(),A));function A(M){var D=M.uid,P=o.set(D,c&&c.get(D)||(y=!0,_1({reset:kSe,onDirty:zSe})));P.context={model:M,overallProgress:m},P.agent=l,P.__block=m,a._pipe(M,P)}y&&l.dirty()},t.prototype._pipe=function(e,r){var n=e.uid,i=this._pipelineMap.get(n);!i.head&&(i.head=r),i.tail&&i.tail.pipe(r),i.tail=r,r.__idxInPipeline=i.count++,r.__pipeline=i},t.wrapStageHandler=function(e,r){return zr(e)&&(e={overallReset:e,seriesType:GSe(e)}),e.uid=hy("stageHandler"),r&&(e.visualType=r),e},t}();function RSe(t){t.overallReset(t.ecModel,t.api,t.payload)}function kSe(t){return t.overallProgress&&OSe}function OSe(){this.agent.dirty(),this.getDownstream().dirty()}function zSe(){this.agent&&this.agent.dirty()}function BSe(t){return t.plan?t.plan(t.model,t.ecModel,t.api,t.payload):null}function FSe(t){t.useClearVisual&&t.data.clearAllVisual();var e=t.resetDefines=Pi(t.reset(t.model,t.ecModel,t.api,t.payload));return e.length>1?Zt(e,function(r,n){return HX(n)}):NSe}var NSe=HX(0);function HX(t){return function(e,r){var n=r.data,i=r.resetDefines[t];if(i&&i.dataEach)for(var a=e.start;a<e.end;a++)i.dataEach(n,a);else i&&i.progress&&i.progress(e,n)}}function VSe(t){return t.data.count()}function GSe(t){VC=null;try{t(Q1,jX)}catch{}return VC}var Q1={},jX={},VC;WX(Q1,tB);WX(jX,vX);Q1.eachSeriesByType=Q1.eachRawSeriesByType=function(t){VC=t};Q1.eachComponent=function(t){t.mainType==="series"&&t.subType&&(VC=t.subType)};function WX(t,e){for(var r in e.prototype)t[r]=Sa}var v8=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const USe={color:v8,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],v8]};var Xo="#B9B8CE",m8="#100C2A",VT=function(){return{axisLine:{lineStyle:{color:Xo}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},_8=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],ZX={darkMode:!0,color:_8,backgroundColor:m8,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:Xo}},textStyle:{color:Xo},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:Xo}},dataZoom:{borderColor:"#71708A",textStyle:{color:Xo},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:Xo}},timeline:{lineStyle:{color:Xo},label:{color:Xo},controlStyle:{color:Xo,borderColor:Xo}},calendar:{itemStyle:{color:m8},dayLabel:{color:Xo},monthLabel:{color:Xo},yearLabel:{color:Xo}},timeAxis:VT(),logAxis:VT(),valueAxis:VT(),categoryAxis:VT(),line:{symbol:"circle"},graph:{color:_8},gauge:{title:{color:Xo},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:Xo},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};ZX.categoryAxis.splitLine.show=!1;var $Se=function(){function t(){}return t.prototype.normalizeQuery=function(e){var r={},n={},i={};if(yr(e)){var a=ec(e);r.mainType=a.main||null,r.subType=a.sub||null}else{var l=["Index","Name","Id"],c={name:1,dataIndex:1,dataType:1};fe(e,function(o,d){for(var g=!1,m=0;m<l.length;m++){var y=l[m],x=d.lastIndexOf(y);if(x>0&&x===d.length-y.length){var A=d.slice(0,x);A!=="data"&&(r.mainType=A,r[y.toLowerCase()]=o,g=!0)}}c.hasOwnProperty(d)&&(n[d]=o,g=!0),g||(i[d]=o)})}return{cptQuery:r,dataQuery:n,otherQuery:i}},t.prototype.filter=function(e,r){var n=this.eventInfo;if(!n)return!0;var i=n.targetEl,a=n.packedEvent,l=n.model,c=n.view;if(!l||!c)return!0;var o=r.cptQuery,d=r.dataQuery;return g(o,l,"mainType")&&g(o,l,"subType")&&g(o,l,"index","componentIndex")&&g(o,l,"name")&&g(o,l,"id")&&g(d,a,"name")&&g(d,a,"dataIndex")&&g(d,a,"dataType")&&(!c.filterForExposedEvent||c.filterForExposedEvent(e,r.otherQuery,i,a));function g(m,y,x,A){return m[x]==null||y[A||x]===m[x]}},t.prototype.afterTrigger=function(){this.eventInfo=null},t}(),lO=["symbol","symbolSize","symbolRotate","symbolOffset"],y8=lO.concat(["symbolKeepAspect"]),HSe={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){var r=t.getData();if(t.legendIcon&&r.setVisual("legendIcon",t.legendIcon),!t.hasSymbolVisual)return;for(var n={},i={},a=!1,l=0;l<lO.length;l++){var c=lO[l],o=t.get(c);zr(o)?(a=!0,i[c]=o):n[c]=o}if(n.symbol=n.symbol||t.defaultSymbol,r.setVisual(Lt({legendIcon:t.legendIcon||n.symbol,symbolKeepAspect:t.get("symbolKeepAspect")},n)),e.isSeriesFiltered(t))return;var d=Hn(i);function g(m,y){for(var x=t.getRawValue(y),A=t.getDataParams(y),M=0;M<d.length;M++){var D=d[M];m.setItemVisual(y,D,i[D](x,A))}}return{dataEach:a?g:null}}},jSe={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){if(!t.hasSymbolVisual||e.isSeriesFiltered(t))return;var r=t.getData();function n(i,a){for(var l=i.getItemModel(a),c=0;c<y8.length;c++){var o=y8[c],d=l.getShallow(o,!0);d!=null&&i.setItemVisual(a,o,d)}}return{dataEach:r.hasItemOption?n:null}}};function lB(t,e,r){switch(r){case"color":var n=t.getItemVisual(e,"style");return n[t.getVisual("drawType")];case"opacity":return t.getItemVisual(e,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return t.getItemVisual(e,r)}}function Pb(t,e){switch(e){case"color":var r=t.getVisual("style");return r[t.getVisual("drawType")];case"opacity":return t.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return t.getVisual(e)}}function qX(t,e,r,n){switch(r){case"color":var i=t.ensureUniqueItemVisual(e,"style");i[t.getVisual("drawType")]=n,t.setItemVisual(e,"colorFromPalette",!1);break;case"opacity":t.ensureUniqueItemVisual(e,"style").opacity=n;break;case"symbol":case"symbolSize":case"liftZ":t.setItemVisual(e,r,n);break}}function YX(t,e){function r(n,i){var a=[];return n.eachComponent({mainType:"series",subType:t,query:i},function(l){a.push(l.seriesIndex)}),a}fe([[t+"ToggleSelect","toggleSelect"],[t+"Select","select"],[t+"UnSelect","unselect"]],function(n){e(n[0],function(i,a,l){i=Lt({},i),l.dispatchAction(Lt(i,{type:n[1],seriesIndex:r(a,i)}))})})}function Km(t,e,r,n,i){var a=t+e;r.isSilent(a)||n.eachComponent({mainType:"series",subType:"pie"},function(l){for(var c=l.seriesIndex,o=l.option.selectedMap,d=i.selected,g=0;g<d.length;g++)if(d[g].seriesIndex===c){var m=l.getData(),y=ev(m,i.fromActionPayload);r.trigger(a,{type:a,seriesId:l.id,name:Ht(y)?m.getName(y[0]):m.getName(y),selected:yr(o)?o:Lt({},o)})}})}function WSe(t,e,r){t.on("selectchanged",function(n){var i=r.getModel();n.isFromClick?(Km("map","selectchanged",e,i,n),Km("pie","selectchanged",e,i,n)):n.fromAction==="select"?(Km("map","selected",e,i,n),Km("pie","selected",e,i,n)):n.fromAction==="unselect"&&(Km("map","unselected",e,i,n),Km("pie","unselected",e,i,n))})}function Ig(t,e,r){for(var n;t&&!(e(t)&&(n=t,r));)t=t.__hostTarget||t.parent;return n}var ZSe=Math.round(Math.random()*9),qSe=typeof Object.defineProperty=="function",YSe=function(){function t(){this._id="__ec_inner_"+ZSe++}return t.prototype.get=function(e){return this._guard(e)[this._id]},t.prototype.set=function(e,r){var n=this._guard(e);return qSe?Object.defineProperty(n,this._id,{value:r,enumerable:!1,configurable:!0}):n[this._id]=r,this},t.prototype.delete=function(e){return this.has(e)?(delete this._guard(e)[this._id],!0):!1},t.prototype.has=function(e){return!!this._guard(e)[this._id]},t.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},t}(),XSe=kn.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var r=e.cx,n=e.cy,i=e.width/2,a=e.height/2;t.moveTo(r,n-a),t.lineTo(r+i,n+a),t.lineTo(r-i,n+a),t.closePath()}}),QSe=kn.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var r=e.cx,n=e.cy,i=e.width/2,a=e.height/2;t.moveTo(r,n-a),t.lineTo(r+i,n),t.lineTo(r,n+a),t.lineTo(r-i,n),t.closePath()}}),KSe=kn.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var r=e.x,n=e.y,i=e.width/5*3,a=Math.max(i,e.height),l=i/2,c=l*l/(a-l),o=n-a+l+c,d=Math.asin(c/l),g=Math.cos(d)*l,m=Math.sin(d),y=Math.cos(d),x=l*.6,A=l*.7;t.moveTo(r-g,o+c),t.arc(r,o,l,Math.PI-d,Math.PI*2+d),t.bezierCurveTo(r+g-m*x,o+c+y*x,r,n-A,r,n),t.bezierCurveTo(r,n-A,r-g+m*x,o+c+y*x,r-g,o+c),t.closePath()}}),JSe=kn.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var r=e.height,n=e.width,i=e.x,a=e.y,l=n/3*2;t.moveTo(i,a),t.lineTo(i+l,a+r),t.lineTo(i,a+r/4*3),t.lineTo(i-l,a+r),t.lineTo(i,a),t.closePath()}}),eTe={line:Ka,rect:Kn,roundRect:Kn,square:Kn,circle:Ch,diamond:QSe,pin:KSe,arrow:JSe,triangle:XSe},tTe={line:function(t,e,r,n,i){i.x1=t,i.y1=e+n/2,i.x2=t+r,i.y2=e+n/2},rect:function(t,e,r,n,i){i.x=t,i.y=e,i.width=r,i.height=n},roundRect:function(t,e,r,n,i){i.x=t,i.y=e,i.width=r,i.height=n,i.r=Math.min(r,n)/4},square:function(t,e,r,n,i){var a=Math.min(r,n);i.x=t,i.y=e,i.width=a,i.height=a},circle:function(t,e,r,n,i){i.cx=t+r/2,i.cy=e+n/2,i.r=Math.min(r,n)/2},diamond:function(t,e,r,n,i){i.cx=t+r/2,i.cy=e+n/2,i.width=r,i.height=n},pin:function(t,e,r,n,i){i.x=t+r/2,i.y=e+n/2,i.width=r,i.height=n},arrow:function(t,e,r,n,i){i.x=t+r/2,i.y=e+n/2,i.width=r,i.height=n},triangle:function(t,e,r,n,i){i.cx=t+r/2,i.cy=e+n/2,i.width=r,i.height=n}},GC={};fe(eTe,function(t,e){GC[e]=new t});var rTe=kn.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(t,e,r){var n=DC(t,e,r),i=this.shape;return i&&i.symbolType==="pin"&&e.position==="inside"&&(n.y=r.y+r.height*.4),n},buildPath:function(t,e,r){var n=e.symbolType;if(n!=="none"){var i=GC[n];i||(n="rect",i=GC[n]),tTe[n](e.x,e.y,e.width,e.height,i.shape),i.buildPath(t,i.shape,r)}}});function nTe(t,e){if(this.type!=="image"){var r=this.style;this.__isEmptyBrush?(r.stroke=t,r.fill=e||"#fff",r.lineWidth=2):this.shape.symbolType==="line"?r.stroke=t:r.fill=t,this.markRedraw()}}function Ia(t,e,r,n,i,a,l){var c=t.indexOf("empty")===0;c&&(t=t.substr(5,1).toLowerCase()+t.substr(6));var o;return t.indexOf("image://")===0?o=BY(t.slice(8),new gn(e,r,n,i),l?"center":"cover"):t.indexOf("path://")===0?o=fI(t.slice(7),{},new gn(e,r,n,i),l?"center":"cover"):o=new rTe({shape:{symbolType:t,x:e,y:r,width:n,height:i}}),o.__isEmptyBrush=c,o.setColor=nTe,a&&o.setColor(a),o}function my(t){return Ht(t)||(t=[+t,+t]),[t[0]||0,t[1]||0]}function dv(t,e){if(t!=null)return Ht(t)||(t=[t,t]),[dr(t[0],e[0])||0,dr(tn(t[1],t[0]),e[1])||0]}function Eg(t){return isFinite(t)}function iTe(t,e,r){var n=e.x==null?0:e.x,i=e.x2==null?1:e.x2,a=e.y==null?0:e.y,l=e.y2==null?0:e.y2;e.global||(n=n*r.width+r.x,i=i*r.width+r.x,a=a*r.height+r.y,l=l*r.height+r.y),n=Eg(n)?n:0,i=Eg(i)?i:1,a=Eg(a)?a:0,l=Eg(l)?l:0;var c=t.createLinearGradient(n,a,i,l);return c}function aTe(t,e,r){var n=r.width,i=r.height,a=Math.min(n,i),l=e.x==null?.5:e.x,c=e.y==null?.5:e.y,o=e.r==null?.5:e.r;e.global||(l=l*n+r.x,c=c*i+r.y,o=o*a),l=Eg(l)?l:.5,c=Eg(c)?c:.5,o=o>=0&&Eg(o)?o:.5;var d=t.createRadialGradient(l,c,0,l,c,o);return d}function uO(t,e,r){for(var n=e.type==="radial"?aTe(t,e,r):iTe(t,e,r),i=e.colorStops,a=0;a<i.length;a++)n.addColorStop(i[a].offset,i[a].color);return n}function oTe(t,e){if(t===e||!t&&!e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!0;return!1}function GT(t){return parseInt(t,10)}function __(t,e,r){var n=["width","height"][e],i=["clientWidth","clientHeight"][e],a=["paddingLeft","paddingTop"][e],l=["paddingRight","paddingBottom"][e];if(r[n]!=null&&r[n]!=="auto")return parseFloat(r[n]);var c=document.defaultView.getComputedStyle(t);return(t[i]||GT(c[n])||GT(t.style[n]))-(GT(c[a])||0)-(GT(c[l])||0)|0}function sTe(t,e){return!t||t==="solid"||!(e>0)?null:t==="dashed"?[4*e,2*e]:t==="dotted"?[e]:ii(t)?[t]:Ht(t)?t:null}function uB(t){var e=t.style,r=e.lineDash&&e.lineWidth>0&&sTe(e.lineDash,e.lineWidth),n=e.lineDashOffset;if(r){var i=e.strokeNoScale&&t.getLineScale?t.getLineScale():1;i&&i!==1&&(r=Zt(r,function(a){return a/i}),n/=i)}return[r,n]}var lTe=new pc(!0);function UC(t){var e=t.stroke;return!(e==null||e==="none"||!(t.lineWidth>0))}function x8(t){return typeof t=="string"&&t!=="none"}function $C(t){var e=t.fill;return e!=null&&e!=="none"}function b8(t,e){if(e.fillOpacity!=null&&e.fillOpacity!==1){var r=t.globalAlpha;t.globalAlpha=e.fillOpacity*e.opacity,t.fill(),t.globalAlpha=r}else t.fill()}function w8(t,e){if(e.strokeOpacity!=null&&e.strokeOpacity!==1){var r=t.globalAlpha;t.globalAlpha=e.strokeOpacity*e.opacity,t.stroke(),t.globalAlpha=r}else t.stroke()}function cO(t,e,r){var n=Rz(e.image,e.__image,r);if(aI(n)){var i=t.createPattern(n,e.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var a=new DOMMatrix;a.translateSelf(e.x||0,e.y||0),a.rotateSelf(0,0,(e.rotation||0)*OA),a.scaleSelf(e.scaleX||1,e.scaleY||1),i.setTransform(a)}return i}}function uTe(t,e,r,n){var i,a=UC(r),l=$C(r),c=r.strokePercent,o=c<1,d=!e.path;(!e.silent||o)&&d&&e.createPathProxy();var g=e.path||lTe,m=e.__dirty;if(!n){var y=r.fill,x=r.stroke,A=l&&!!y.colorStops,M=a&&!!x.colorStops,D=l&&!!y.image,P=a&&!!x.image,O=void 0,z=void 0,V=void 0,H=void 0,$=void 0;(A||M)&&($=e.getBoundingRect()),A&&(O=m?uO(t,y,$):e.__canvasFillGradient,e.__canvasFillGradient=O),M&&(z=m?uO(t,x,$):e.__canvasStrokeGradient,e.__canvasStrokeGradient=z),D&&(V=m||!e.__canvasFillPattern?cO(t,y,e):e.__canvasFillPattern,e.__canvasFillPattern=V),P&&(H=m||!e.__canvasStrokePattern?cO(t,x,e):e.__canvasStrokePattern,e.__canvasStrokePattern=V),A?t.fillStyle=O:D&&(V?t.fillStyle=V:l=!1),M?t.strokeStyle=z:P&&(H?t.strokeStyle=H:a=!1)}var X=e.getGlobalScale();g.setScale(X[0],X[1],e.segmentIgnoreThreshold);var W,Y;t.setLineDash&&r.lineDash&&(i=uB(e),W=i[0],Y=i[1]);var J=!0;(d||m&h_)&&(g.setDPR(t.dpr),o?g.setContext(null):(g.setContext(t),J=!1),g.reset(),e.buildPath(g,e.shape,n),g.toStatic(),e.pathUpdated()),J&&g.rebuildPath(t,o?c:1),W&&(t.setLineDash(W),t.lineDashOffset=Y),n||(r.strokeFirst?(a&&w8(t,r),l&&b8(t,r)):(l&&b8(t,r),a&&w8(t,r))),W&&t.setLineDash([])}function cTe(t,e,r){var n=e.__image=Rz(r.image,e.__image,e,e.onload);if(!(!n||!aI(n))){var i=r.x||0,a=r.y||0,l=e.getWidth(),c=e.getHeight(),o=n.width/n.height;if(l==null&&c!=null?l=c*o:c==null&&l!=null?c=l/o:l==null&&c==null&&(l=n.width,c=n.height),r.sWidth&&r.sHeight){var d=r.sx||0,g=r.sy||0;t.drawImage(n,d,g,r.sWidth,r.sHeight,i,a,l,c)}else if(r.sx&&r.sy){var d=r.sx,g=r.sy,m=l-d,y=c-g;t.drawImage(n,d,g,m,y,i,a,l,c)}else t.drawImage(n,i,a,l,c)}}function hTe(t,e,r){var n,i=r.text;if(i!=null&&(i+=""),i){t.font=r.font||pd,t.textAlign=r.textAlign,t.textBaseline=r.textBaseline;var a=void 0,l=void 0;t.setLineDash&&r.lineDash&&(n=uB(e),a=n[0],l=n[1]),a&&(t.setLineDash(a),t.lineDashOffset=l),r.strokeFirst?(UC(r)&&t.strokeText(i,r.x,r.y),$C(r)&&t.fillText(i,r.x,r.y)):($C(r)&&t.fillText(i,r.x,r.y),UC(r)&&t.strokeText(i,r.x,r.y)),a&&t.setLineDash([])}}var S8=["shadowBlur","shadowOffsetX","shadowOffsetY"],T8=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function XX(t,e,r,n,i){var a=!1;if(!n&&(r=r||{},e===r))return!1;if(n||e.opacity!==r.opacity){ws(t,i),a=!0;var l=Math.max(Math.min(e.opacity,1),0);t.globalAlpha=isNaN(l)?Ng.opacity:l}(n||e.blend!==r.blend)&&(a||(ws(t,i),a=!0),t.globalCompositeOperation=e.blend||Ng.blend);for(var c=0;c<S8.length;c++){var o=S8[c];(n||e[o]!==r[o])&&(a||(ws(t,i),a=!0),t[o]=t.dpr*(e[o]||0))}return(n||e.shadowColor!==r.shadowColor)&&(a||(ws(t,i),a=!0),t.shadowColor=e.shadowColor||Ng.shadowColor),a}function A8(t,e,r,n,i){var a=K1(e,i.inHover),l=n?null:r&&K1(r,i.inHover)||{};if(a===l)return!1;var c=XX(t,a,l,n,i);if((n||a.fill!==l.fill)&&(c||(ws(t,i),c=!0),x8(a.fill)&&(t.fillStyle=a.fill)),(n||a.stroke!==l.stroke)&&(c||(ws(t,i),c=!0),x8(a.stroke)&&(t.strokeStyle=a.stroke)),(n||a.opacity!==l.opacity)&&(c||(ws(t,i),c=!0),t.globalAlpha=a.opacity==null?1:a.opacity),e.hasStroke()){var o=a.lineWidth,d=o/(a.strokeNoScale&&e.getLineScale?e.getLineScale():1);t.lineWidth!==d&&(c||(ws(t,i),c=!0),t.lineWidth=d)}for(var g=0;g<T8.length;g++){var m=T8[g],y=m[0];(n||a[y]!==l[y])&&(c||(ws(t,i),c=!0),t[y]=a[y]||m[1])}return c}function fTe(t,e,r,n,i){return XX(t,K1(e,i.inHover),r&&K1(r,i.inHover),n,i)}function QX(t,e){var r=e.transform,n=t.dpr||1;r?t.setTransform(n*r[0],n*r[1],n*r[2],n*r[3],n*r[4],n*r[5]):t.setTransform(n,0,0,n,0,0)}function dTe(t,e,r){for(var n=!1,i=0;i<t.length;i++){var a=t[i];n=n||a.isZeroArea(),QX(e,a),e.beginPath(),a.buildPath(e,a.shape),e.clip()}r.allClipped=n}function pTe(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||t[4]!==e[4]||t[5]!==e[5]:!(!t&&!e)}var C8=1,M8=2,I8=3,E8=4;function gTe(t){var e=$C(t),r=UC(t);return!(t.lineDash||!(+e^+r)||e&&typeof t.fill!="string"||r&&typeof t.stroke!="string"||t.strokePercent<1||t.strokeOpacity<1||t.fillOpacity<1)}function ws(t,e){e.batchFill&&t.fill(),e.batchStroke&&t.stroke(),e.batchFill="",e.batchStroke=""}function K1(t,e){return e&&t.__hoverStyle||t.style}function KX(t,e){Dg(t,e,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Dg(t,e,r,n){var i=e.transform;if(!e.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1)){e.__dirty&=~Ys,e.__isRendered=!1;return}var a=e.__clipPaths,l=r.prevElClipPaths,c=!1,o=!1;if((!l||oTe(a,l))&&(l&&l.length&&(ws(t,r),t.restore(),o=c=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),a&&a.length&&(ws(t,r),t.save(),dTe(a,t,r),c=!0),r.prevElClipPaths=a),r.allClipped){e.__isRendered=!1;return}e.beforeBrush&&e.beforeBrush(),e.innerBeforeBrush();var d=r.prevEl;d||(o=c=!0);var g=e instanceof kn&&e.autoBatch&&gTe(e.style);c||pTe(i,d.transform)?(ws(t,r),QX(t,e)):g||ws(t,r);var m=K1(e,r.inHover);e instanceof kn?(r.lastDrawType!==C8&&(o=!0,r.lastDrawType=C8),A8(t,e,d,o,r),(!g||!r.batchFill&&!r.batchStroke)&&t.beginPath(),uTe(t,e,m,g),g&&(r.batchFill=m.fill||"",r.batchStroke=m.stroke||"")):e instanceof U_?(r.lastDrawType!==I8&&(o=!0,r.lastDrawType=I8),A8(t,e,d,o,r),hTe(t,e,m)):e instanceof fo?(r.lastDrawType!==M8&&(o=!0,r.lastDrawType=M8),fTe(t,e,d,o,r),cTe(t,e,m)):e.getTemporalDisplayables&&(r.lastDrawType!==E8&&(o=!0,r.lastDrawType=E8),vTe(t,e,r)),g&&n&&ws(t,r),e.innerAfterBrush(),e.afterBrush&&e.afterBrush(),r.prevEl=e,e.__dirty=0,e.__isRendered=!0}function vTe(t,e,r){var n=e.getDisplayables(),i=e.getTemporalDisplayables();t.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover},l,c;for(l=e.getCursor(),c=n.length;l<c;l++){var o=n[l];o.beforeBrush&&o.beforeBrush(),o.innerBeforeBrush(),Dg(t,o,a,l===c-1),o.innerAfterBrush(),o.afterBrush&&o.afterBrush(),a.prevEl=o}for(var d=0,g=i.length;d<g;d++){var o=i[d];o.beforeBrush&&o.beforeBrush(),o.innerBeforeBrush(),Dg(t,o,a,d===g-1),o.innerAfterBrush(),o.afterBrush&&o.afterBrush(),a.prevEl=o}e.clearTemporalDisplayables(),e.notClear=!0,t.restore()}var nL=new YSe,D8=new wb(100),P8=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function j_(t,e){if(t==="none")return null;var r=e.getDevicePixelRatio(),n=e.getZr(),i=n.painter.type==="svg";t.dirty&&nL.delete(t);var a=nL.get(t);if(a)return a;var l=Fr(t,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});l.backgroundColor==="none"&&(l.backgroundColor=null);var c={repeat:"repeat"};return o(c),c.rotation=l.rotation,c.scaleX=c.scaleY=i?1:1/r,nL.set(t,c),t.dirty=!1,c;function o(d){for(var g=[r],m=!0,y=0;y<P8.length;++y){var x=l[P8[y]];if(x!=null&&!Ht(x)&&!yr(x)&&!ii(x)&&typeof x!="boolean"){m=!1;break}g.push(x)}var A;if(m){A=g.join(",")+(i?"-svg":"");var M=D8.get(A);M&&(i?d.svgElement=M:d.image=M)}var D=eQ(l.dashArrayX),P=mTe(l.dashArrayY),O=JX(l.symbol),z=_Te(D),V=tQ(P),H=!i&&gd.createCanvas(),$=i&&{tag:"g",attrs:{},key:"dcl",children:[]},X=Y(),W;H&&(H.width=X.width*r,H.height=X.height*r,W=H.getContext("2d")),J(),m&&D8.put(A,H||$),d.image=H,d.svgElement=$,d.svgWidth=X.width,d.svgHeight=X.height;function Y(){for(var re=1,ae=0,pe=z.length;ae<pe;++ae)re=qG(re,z[ae]);for(var de=1,ae=0,pe=O.length;ae<pe;++ae)de=qG(de,O[ae].length);re*=de;var ve=V*z.length*O.length;return{width:Math.max(1,Math.min(re,l.maxTileWidth)),height:Math.max(1,Math.min(ve,l.maxTileHeight))}}function J(){W&&(W.clearRect(0,0,H.width,H.height),l.backgroundColor&&(W.fillStyle=l.backgroundColor,W.fillRect(0,0,H.width,H.height)));for(var re=0,ae=0;ae<P.length;++ae)re+=P[ae];if(re<=0)return;for(var pe=-V,de=0,ve=0,me=0;pe<X.height;){if(de%2===0){for(var Ie=ve/2%O.length,Le=0,Ee=0,Ue=0;Le<X.width*2;){for(var Ke=0,ae=0;ae<D[me].length;++ae)Ke+=D[me][ae];if(Ke<=0)break;if(Ee%2===0){var We=(1-l.symbolSize)*.5,Rt=Le+D[me][Ee]*We,Et=pe+P[de]*We,ar=D[me][Ee]*l.symbolSize,ur=P[de]*l.symbolSize,cr=Ue/2%O[Ie].length;lt(Rt,Et,ar,ur,O[Ie][cr])}Le+=D[me][Ee],++Ue,++Ee,Ee===D[me].length&&(Ee=0)}++me,me===D.length&&(me=0)}pe+=P[de],++ve,++de,de===P.length&&(de=0)}function lt(qt,Ut,rr,br,Oe){var $e=i?1:r,ct=Ia(Oe,qt*$e,Ut*$e,rr*$e,br*$e,l.color,l.symbolKeepAspect);if(i){var bt=n.painter.renderOneToVNode(ct);bt&&$.children.push(bt)}else KX(W,ct)}}}}function JX(t){if(!t||t.length===0)return[["rect"]];if(yr(t))return[[t]];for(var e=!0,r=0;r<t.length;++r)if(!yr(t[r])){e=!1;break}if(e)return JX([t]);for(var n=[],r=0;r<t.length;++r)yr(t[r])?n.push([t[r]]):n.push(t[r]);return n}function eQ(t){if(!t||t.length===0)return[[0,0]];if(ii(t)){var e=Math.ceil(t);return[[e,e]]}for(var r=!0,n=0;n<t.length;++n)if(!ii(t[n])){r=!1;break}if(r)return eQ([t]);for(var i=[],n=0;n<t.length;++n)if(ii(t[n])){var e=Math.ceil(t[n]);i.push([e,e])}else{var e=Zt(t[n],function(c){return Math.ceil(c)});e.length%2===1?i.push(e.concat(e)):i.push(e)}return i}function mTe(t){if(!t||typeof t=="object"&&t.length===0)return[0,0];if(ii(t)){var e=Math.ceil(t);return[e,e]}var r=Zt(t,function(n){return Math.ceil(n)});return t.length%2?r.concat(r):r}function _Te(t){return Zt(t,function(e){return tQ(e)})}function tQ(t){for(var e=0,r=0;r<t.length;++r)e+=t[r];return t.length%2===1?e*2:e}function yTe(t,e){t.eachRawSeries(function(r){if(!t.isSeriesFiltered(r)){var n=r.getData();n.hasItemVisual()&&n.each(function(l){var c=n.getItemVisual(l,"decal");if(c){var o=n.ensureUniqueItemVisual(l,"style");o.decal=j_(c,e)}});var i=n.getVisual("decal");if(i){var a=n.getVisual("style");a.decal=j_(i,e)}}})}var uu=new Fl,rQ={};function xTe(t,e){rQ[t]=e}function bTe(t){return rQ[t]}var wTe=1,STe=800,TTe=900,ATe=1e3,CTe=2e3,MTe=5e3,nQ=1e3,ITe=1100,cB=2e3,iQ=3e3,ETe=4e3,SI=4500,DTe=4600,PTe=5e3,LTe=6e3,aQ=7e3,RTe={PROCESSOR:{FILTER:ATe,SERIES_FILTER:STe,STATISTIC:MTe},VISUAL:{LAYOUT:nQ,PROGRESSIVE_LAYOUT:ITe,GLOBAL:cB,CHART:iQ,POST_CHART_LAYOUT:DTe,COMPONENT:ETe,BRUSH:PTe,CHART_ITEM:SI,ARIA:LTe,DECAL:aQ}},ko="__flagInMainProcess",_s="__pendingUpdate",iL="__needsUpdateStatus",L8=/^[a-zA-Z0-9_]+$/,aL="__connectUpdateStatus",R8=0,kTe=1,OTe=2;function oQ(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(this.isDisposed()){this.id;return}return lQ(this,t,e)}}function sQ(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return lQ(this,t,e)}}function lQ(t,e,r){return r[0]=r[0]&&r[0].toLowerCase(),Fl.prototype[e].apply(t,r)}var uQ=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Fl),cQ=uQ.prototype;cQ.on=sQ("on");cQ.off=sQ("off");var Jm,oL,UT,Cf,sL,lL,uL,_x,yx,k8,O8,cL,z8,$T,B8,hQ,pl,F8,fQ=function(t){et(e,t);function e(r,n,i){var a=t.call(this,new $Se)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],i=i||{},yr(n)&&(n=dQ[n]),a._dom=r;var l="canvas",c="auto",o=!1;i.ssr&&Mxe(function(y){var x=Yr(y),A=x.dataIndex;if(A!=null){var M=Ir();return M.set("series_index",x.seriesIndex),M.set("data_index",A),x.ssrType&&M.set("ssr_type",x.ssrType),M}});var d=a._zr=HG(r,{renderer:i.renderer||l,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:tn(i.useDirtyRect,o),useCoarsePointer:tn(i.useCoarsePointer,c),pointerSize:i.pointerSize});a._ssr=i.ssr,a._throttledZrFlush=sB(wr(d.flush,d),17),n=$r(n),n&&_X(n,!0),a._theme=n,a._locale=twe(i.locale||ZY),a._coordSysMgr=new Db;var g=a._api=B8(a);function m(y,x){return y.__prio-x.__prio}return FA(jC,m),FA(hO,m),a._scheduler=new $X(a,g,hO,jC),a._messageCenter=new uQ,a._initEvents(),a.resize=wr(a.resize,a),d.animation.on("frame",a._onframe,a),k8(d,a),O8(d,a),bC(a),a}return e.prototype._onframe=function(){if(!this._disposed){F8(this);var r=this._scheduler;if(this[_s]){var n=this[_s].silent;this[ko]=!0;try{Jm(this),Cf.update.call(this,null,this[_s].updateParams)}catch(o){throw this[ko]=!1,this[_s]=null,o}this._zr.flush(),this[ko]=!1,this[_s]=null,_x.call(this,n),yx.call(this,n)}else if(r.unfinished){var i=wTe,a=this._model,l=this._api;r.unfinished=!1;do{var c=+new Date;r.performSeriesTasks(a),r.performDataProcessorTasks(a),lL(this,a),r.performVisualTasks(a),$T(this,this._model,l,"remain",{}),i-=+new Date-c}while(i>0&&r.unfinished);r.unfinished||this._zr.flush()}}},e.prototype.getDom=function(){return this._dom},e.prototype.getId=function(){return this.id},e.prototype.getZr=function(){return this._zr},e.prototype.isSSR=function(){return this._ssr},e.prototype.setOption=function(r,n,i){if(!this[ko]){if(this._disposed){this.id;return}var a,l,c;if(Ur(n)&&(i=n.lazyUpdate,a=n.silent,l=n.replaceMerge,c=n.transition,n=n.notMerge),this[ko]=!0,!this._model||n){var o=new Cwe(this._api),d=this._theme,g=this._model=new tB;g.scheduler=this._scheduler,g.ssr=this._ssr,g.init(null,null,null,d,this._locale,o)}this._model.setOption(r,{replaceMerge:l},fO);var m={seriesTransition:c,optionChanged:!0};if(i)this[_s]={silent:a,updateParams:m},this[ko]=!1,this.getZr().wakeUp();else{try{Jm(this),Cf.update.call(this,null,m)}catch(y){throw this[_s]=null,this[ko]=!1,y}this._ssr||this._zr.flush(),this[_s]=null,this[ko]=!1,_x.call(this,a),yx.call(this,a)}}},e.prototype.setTheme=function(){},e.prototype.getModel=function(){return this._model},e.prototype.getOption=function(){return this._model&&this._model.getOption()},e.prototype.getWidth=function(){return this._zr.getWidth()},e.prototype.getHeight=function(){return this._zr.getHeight()},e.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||Nn.hasGlobalWindow&&window.devicePixelRatio||1},e.prototype.getRenderedCanvas=function(r){return this.renderToCanvas(r)},e.prototype.renderToCanvas=function(r){r=r||{};var n=this._zr.painter;return n.getRenderedCanvas({backgroundColor:r.backgroundColor||this._model.get("backgroundColor"),pixelRatio:r.pixelRatio||this.getDevicePixelRatio()})},e.prototype.renderToSVGString=function(r){r=r||{};var n=this._zr.painter;return n.renderToString({useViewBox:r.useViewBox})},e.prototype.getSvgDataURL=function(){if(Nn.svgSupported){var r=this._zr,n=r.storage.getDisplayList();return fe(n,function(i){i.stopAnimation(null,!0)}),r.painter.toDataURL()}},e.prototype.getDataURL=function(r){if(this._disposed){this.id;return}r=r||{};var n=r.excludeComponents,i=this._model,a=[],l=this;fe(n,function(o){i.eachComponent({mainType:o},function(d){var g=l._componentsMap[d.__viewId];g.group.ignore||(a.push(g),g.group.ignore=!0)})});var c=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(r).toDataURL("image/"+(r&&r.type||"png"));return fe(a,function(o){o.group.ignore=!1}),c},e.prototype.getConnectedDataURL=function(r){if(this._disposed){this.id;return}var n=r.type==="svg",i=this.group,a=Math.min,l=Math.max,c=1/0;if(N8[i]){var o=c,d=c,g=-c,m=-c,y=[],x=r&&r.pixelRatio||this.getDevicePixelRatio();fe(x1,function(z,V){if(z.group===i){var H=n?z.getZr().painter.getSvgDom().innerHTML:z.renderToCanvas($r(r)),$=z.getDom().getBoundingClientRect();o=a($.left,o),d=a($.top,d),g=l($.right,g),m=l($.bottom,m),y.push({dom:H,left:$.left,top:$.top})}}),o*=x,d*=x,g*=x,m*=x;var A=g-o,M=m-d,D=gd.createCanvas(),P=HG(D,{renderer:n?"svg":"canvas"});if(P.resize({width:A,height:M}),n){var O="";return fe(y,function(z){var V=z.left-o,H=z.top-d;O+='<g transform="translate('+V+","+H+')">'+z.dom+"</g>"}),P.painter.getSvgRoot().innerHTML=O,r.connectedBackgroundColor&&P.painter.setBackgroundColor(r.connectedBackgroundColor),P.refreshImmediately(),P.painter.toDataURL()}else return r.connectedBackgroundColor&&P.add(new Kn({shape:{x:0,y:0,width:A,height:M},style:{fill:r.connectedBackgroundColor}})),fe(y,function(z){var V=new fo({style:{x:z.left*x-o,y:z.top*x-d,image:z.dom}});P.add(V)}),P.refreshImmediately(),D.toDataURL("image/"+(r&&r.type||"png"))}else return this.getDataURL(r)},e.prototype.convertToPixel=function(r,n){return sL(this,"convertToPixel",r,n)},e.prototype.convertFromPixel=function(r,n){return sL(this,"convertFromPixel",r,n)},e.prototype.containPixel=function(r,n){if(this._disposed){this.id;return}var i=this._model,a,l=d1(i,r);return fe(l,function(c,o){o.indexOf("Models")>=0&&fe(c,function(d){var g=d.coordinateSystem;if(g&&g.containPoint)a=a||!!g.containPoint(n);else if(o==="seriesModels"){var m=this._chartsMap[d.__viewId];m&&m.containPoint&&(a=a||m.containPoint(n,d))}},this)},this),!!a},e.prototype.getVisual=function(r,n){var i=this._model,a=d1(i,r,{defaultMainType:"series"}),l=a.seriesModel,c=l.getData(),o=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?c.indexOfRawIndex(a.dataIndex):null;return o!=null?lB(c,o,n):Pb(c,n)},e.prototype.getViewOfComponentModel=function(r){return this._componentsMap[r.__viewId]},e.prototype.getViewOfSeriesModel=function(r){return this._chartsMap[r.__viewId]},e.prototype._initEvents=function(){var r=this;fe(zTe,function(n){var i=function(a){var l=r.getModel(),c=a.target,o,d=n==="globalout";if(d?o={}:c&&Ig(c,function(A){var M=Yr(A);if(M&&M.dataIndex!=null){var D=M.dataModel||l.getSeriesByIndex(M.seriesIndex);return o=D&&D.getDataParams(M.dataIndex,M.dataType,c)||{},!0}else if(M.eventData)return o=Lt({},M.eventData),!0},!0),o){var g=o.componentType,m=o.componentIndex;(g==="markLine"||g==="markPoint"||g==="markArea")&&(g="series",m=o.seriesIndex);var y=g&&m!=null&&l.getComponent(g,m),x=y&&r[y.mainType==="series"?"_chartsMap":"_componentsMap"][y.__viewId];o.event=a,o.type=n,r._$eventProcessor.eventInfo={targetEl:c,packedEvent:o,model:y,view:x},r.trigger(n,o)}};i.zrEventfulCallAtLast=!0,r._zr.on(n,i,r)}),fe(y1,function(n,i){r._messageCenter.on(i,function(a){this.trigger(i,a)},r)}),fe(["selectchanged"],function(n){r._messageCenter.on(n,function(i){this.trigger(n,i)},r)}),WSe(this._messageCenter,this,this._api)},e.prototype.isDisposed=function(){return this._disposed},e.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},e.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var r=this.getDom();r&&nY(this.getDom(),fB,"");var n=this,i=n._api,a=n._model;fe(n._componentsViews,function(l){l.dispose(a,i)}),fe(n._chartsViews,function(l){l.dispose(a,i)}),n._zr.dispose(),n._dom=n._model=n._chartsMap=n._componentsMap=n._chartsViews=n._componentsViews=n._scheduler=n._api=n._zr=n._throttledZrFlush=n._theme=n._coordSysMgr=n._messageCenter=null,delete x1[n.id]},e.prototype.resize=function(r){if(!this[ko]){if(this._disposed){this.id;return}this._zr.resize(r);var n=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!n){var i=n.resetOption("media"),a=r&&r.silent;this[_s]&&(a==null&&(a=this[_s].silent),i=!0,this[_s]=null),this[ko]=!0;try{i&&Jm(this),Cf.update.call(this,{type:"resize",animation:Lt({duration:0},r&&r.animation)})}catch(l){throw this[ko]=!1,l}this[ko]=!1,_x.call(this,a),yx.call(this,a)}}},e.prototype.showLoading=function(r,n){if(this._disposed){this.id;return}if(Ur(r)&&(n=r,r=""),r=r||"default",this.hideLoading(),!!dO[r]){var i=dO[r](this._api,n),a=this._zr;this._loadingFX=i,a.add(i)}},e.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},e.prototype.makeActionFromEvent=function(r){var n=Lt({},r);return n.type=y1[r.type],n},e.prototype.dispatchAction=function(r,n){if(this._disposed){this.id;return}if(Ur(n)||(n={silent:!!n}),!!HC[r.type]&&this._model){if(this[ko]){this._pendingActions.push(r);return}var i=n.silent;uL.call(this,r,i);var a=n.flush;a?this._zr.flush():a!==!1&&Nn.browser.weChat&&this._throttledZrFlush(),_x.call(this,i),yx.call(this,i)}},e.prototype.updateLabelLayout=function(){uu.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},e.prototype.appendData=function(r){if(this._disposed){this.id;return}var n=r.seriesIndex,i=this.getModel(),a=i.getSeriesByIndex(n);a.appendData(r),this._scheduler.unfinished=!0,this.getZr().wakeUp()},e.internalField=function(){Jm=function(m){var y=m._scheduler;y.restorePipelines(m._model),y.prepareStageTasks(),oL(m,!0),oL(m,!1),y.plan()},oL=function(m,y){for(var x=m._model,A=m._scheduler,M=y?m._componentsViews:m._chartsViews,D=y?m._componentsMap:m._chartsMap,P=m._zr,O=m._api,z=0;z<M.length;z++)M[z].__alive=!1;y?x.eachComponent(function($,X){$!=="series"&&V(X)}):x.eachSeries(V);function V($){var X=$.__requireNewView;$.__requireNewView=!1;var W="_ec_"+$.id+"_"+$.type,Y=!X&&D[W];if(!Y){var J=ec($.type),re=y?ra.getClass(J.main,J.sub):Oi.getClass(J.sub);Y=new re,Y.init(x,O),D[W]=Y,M.push(Y),P.add(Y.group)}$.__viewId=Y.__id=W,Y.__alive=!0,Y.__model=$,Y.group.__ecComponentInfo={mainType:$.mainType,index:$.componentIndex},!y&&A.prepareView(Y,$,x,O)}for(var z=0;z<M.length;){var H=M[z];H.__alive?z++:(!y&&H.renderTask.dispose(),P.remove(H.group),H.dispose(x,O),M.splice(z,1),D[H.__id]===H&&delete D[H.__id],H.__id=H.group.__ecComponentInfo=null)}},UT=function(m,y,x,A,M){var D=m._model;if(D.setUpdatePayload(x),!A){fe([].concat(m._componentsViews).concat(m._chartsViews),H);return}var P={};P[A+"Id"]=x[A+"Id"],P[A+"Index"]=x[A+"Index"],P[A+"Name"]=x[A+"Name"];var O={mainType:A,query:P};M&&(O.subType=M);var z=x.excludeSeriesId,V;z!=null&&(V=Ir(),fe(Pi(z),function($){var X=za($,null);X!=null&&V.set(X,!0)})),D&&D.eachComponent(O,function($){var X=V&&V.get($.id)!=null;if(!X)if(xU(x))if($ instanceof Wi)x.type===Vg&&!x.notBlur&&!$.get(["emphasis","disabled"])&&X1e($,x,m._api);else{var W=Nz($.mainType,$.componentIndex,x.name,m._api),Y=W.focusSelf,J=W.dispatchers;x.type===Vg&&Y&&!x.notBlur&&Zk($.mainType,$.componentIndex,m._api),J&&fe(J,function(re){x.type===Vg?gh(re):vh(re)})}else Yk(x)&&$ instanceof Wi&&(J1e($,x,m._api),_U($),pl(m))},m),D&&D.eachComponent(O,function($){var X=V&&V.get($.id)!=null;X||H(m[A==="series"?"_chartsMap":"_componentsMap"][$.__viewId])},m);function H($){$&&$.__alive&&$[y]&&$[y]($.__model,D,m._api,x)}},Cf={prepareAndUpdate:function(m){Jm(this),Cf.update.call(this,m,{optionChanged:m.newOption!=null})},update:function(m,y){var x=this._model,A=this._api,M=this._zr,D=this._coordSysMgr,P=this._scheduler;if(x){x.setUpdatePayload(m),P.restoreData(x,m),P.performSeriesTasks(x),D.create(x,A),P.performDataProcessorTasks(x,m),lL(this,x),D.update(x,A),r(x),P.performVisualTasks(x,m),cL(this,x,A,m,y);var O=x.get("backgroundColor")||"transparent",z=x.get("darkMode");M.setBackgroundColor(O),z!=null&&z!=="auto"&&M.setDarkMode(z),uu.trigger("afterupdate",x,A)}},updateTransform:function(m){var y=this,x=this._model,A=this._api;if(x){x.setUpdatePayload(m);var M=[];x.eachComponent(function(P,O){if(P!=="series"){var z=y.getViewOfComponentModel(O);if(z&&z.__alive)if(z.updateTransform){var V=z.updateTransform(O,x,A,m);V&&V.update&&M.push(z)}else M.push(z)}});var D=Ir();x.eachSeries(function(P){var O=y._chartsMap[P.__viewId];if(O.updateTransform){var z=O.updateTransform(P,x,A,m);z&&z.update&&D.set(P.uid,1)}else D.set(P.uid,1)}),r(x),this._scheduler.performVisualTasks(x,m,{setDirty:!0,dirtyMap:D}),$T(this,x,A,m,{},D),uu.trigger("afterupdate",x,A)}},updateView:function(m){var y=this._model;y&&(y.setUpdatePayload(m),Oi.markUpdateMethod(m,"updateView"),r(y),this._scheduler.performVisualTasks(y,m,{setDirty:!0}),cL(this,y,this._api,m,{}),uu.trigger("afterupdate",y,this._api))},updateVisual:function(m){var y=this,x=this._model;x&&(x.setUpdatePayload(m),x.eachSeries(function(A){A.getData().clearAllVisual()}),Oi.markUpdateMethod(m,"updateVisual"),r(x),this._scheduler.performVisualTasks(x,m,{visualType:"visual",setDirty:!0}),x.eachComponent(function(A,M){if(A!=="series"){var D=y.getViewOfComponentModel(M);D&&D.__alive&&D.updateVisual(M,x,y._api,m)}}),x.eachSeries(function(A){var M=y._chartsMap[A.__viewId];M.updateVisual(A,x,y._api,m)}),uu.trigger("afterupdate",x,this._api))},updateLayout:function(m){Cf.update.call(this,m)}},sL=function(m,y,x,A){if(m._disposed){m.id;return}for(var M=m._model,D=m._coordSysMgr.getCoordinateSystems(),P,O=d1(M,x),z=0;z<D.length;z++){var V=D[z];if(V[y]&&(P=V[y](M,O,A))!=null)return P}},lL=function(m,y){var x=m._chartsMap,A=m._scheduler;y.eachSeries(function(M){A.updateStreamModes(M,x[M.__viewId])})},uL=function(m,y){var x=this,A=this.getModel(),M=m.type,D=m.escapeConnect,P=HC[M],O=P.actionInfo,z=(O.update||"update").split(":"),V=z.pop(),H=z[0]!=null&&ec(z[0]);this[ko]=!0;var $=[m],X=!1;m.batch&&(X=!0,$=Zt(m.batch,function(de){return de=Fr(Lt({},de),m),de.batch=null,de}));var W=[],Y,J=Yk(m),re=xU(m);if(re&&TY(this._api),fe($,function(de){if(Y=P.action(de,x._model,x._api),Y=Y||Lt({},de),Y.type=O.event||Y.type,W.push(Y),re){var ve=Pz(m),me=ve.queryOptionMap,Ie=ve.mainTypeSpecified,Le=Ie?me.keys()[0]:"series";UT(x,V,de,Le),pl(x)}else J?(UT(x,V,de,"series"),pl(x)):H&&UT(x,V,de,H.main,H.sub)}),V!=="none"&&!re&&!J&&!H)try{this[_s]?(Jm(this),Cf.update.call(this,m),this[_s]=null):Cf[V].call(this,m)}catch(de){throw this[ko]=!1,de}if(X?Y={type:O.event||M,escapeConnect:D,batch:W}:Y=W[0],this[ko]=!1,!y){var ae=this._messageCenter;if(ae.trigger(Y.type,Y),J){var pe={type:"selectchanged",escapeConnect:D,selected:ebe(A),isFromClick:m.isFromClick||!1,fromAction:m.type,fromActionPayload:m};ae.trigger(pe.type,pe)}}},_x=function(m){for(var y=this._pendingActions;y.length;){var x=y.shift();uL.call(this,x,m)}},yx=function(m){!m&&this.trigger("updated")},k8=function(m,y){m.on("rendered",function(x){y.trigger("rendered",x),m.animation.isFinished()&&!y[_s]&&!y._scheduler.unfinished&&!y._pendingActions.length&&y.trigger("finished")})},O8=function(m,y){m.on("mouseover",function(x){var A=x.target,M=Ig(A,j1);M&&(Q1e(M,x,y._api),pl(y))}).on("mouseout",function(x){var A=x.target,M=Ig(A,j1);M&&(K1e(M,x,y._api),pl(y))}).on("click",function(x){var A=x.target,M=Ig(A,function(O){return Yr(O).dataIndex!=null},!0);if(M){var D=M.selected?"unselect":"select",P=Yr(M);y._api.dispatchAction({type:D,dataType:P.dataType,dataIndexInside:P.dataIndex,seriesIndex:P.seriesIndex,isFromClick:!0})}})};function r(m){m.clearColorPalette(),m.eachSeries(function(y){y.clearColorPalette()})}function n(m){var y=[],x=[],A=!1;if(m.eachComponent(function(O,z){var V=z.get("zlevel")||0,H=z.get("z")||0,$=z.getZLevelKey();A=A||!!$,(O==="series"?x:y).push({zlevel:V,z:H,idx:z.componentIndex,type:O,key:$})}),A){var M=y.concat(x),D,P;FA(M,function(O,z){return O.zlevel===z.zlevel?O.z-z.z:O.zlevel-z.zlevel}),fe(M,function(O){var z=m.getComponent(O.type,O.idx),V=O.zlevel,H=O.key;D!=null&&(V=Math.max(D,V)),H?(V===D&&H!==P&&V++,P=H):P&&(V===D&&V++,P=""),D=V,z.setZLevel(V)})}}cL=function(m,y,x,A,M){n(y),z8(m,y,x,A,M),fe(m._chartsViews,function(D){D.__alive=!1}),$T(m,y,x,A,M),fe(m._chartsViews,function(D){D.__alive||D.remove(y,x)})},z8=function(m,y,x,A,M,D){fe(D||m._componentsViews,function(P){var O=P.__model;d(O,P),P.render(O,y,x,A),c(O,P),g(O,P)})},$T=function(m,y,x,A,M,D){var P=m._scheduler;M=Lt(M||{},{updatedSeries:y.getSeries()}),uu.trigger("series:beforeupdate",y,x,M);var O=!1;y.eachSeries(function(z){var V=m._chartsMap[z.__viewId];V.__alive=!0;var H=V.renderTask;P.updatePayload(H,A),d(z,V),D&&D.get(z.uid)&&H.dirty(),H.perform(P.getPerformArgs(H))&&(O=!0),V.group.silent=!!z.get("silent"),l(z,V),_U(z)}),P.unfinished=O||P.unfinished,uu.trigger("series:layoutlabels",y,x,M),uu.trigger("series:transition",y,x,M),y.eachSeries(function(z){var V=m._chartsMap[z.__viewId];c(z,V),g(z,V)}),a(m,y),uu.trigger("series:afterupdate",y,x,M)},pl=function(m){m[iL]=!0,m.getZr().wakeUp()},F8=function(m){m[iL]&&(m.getZr().storage.traverse(function(y){A_(y)||i(y)}),m[iL]=!1)};function i(m){for(var y=[],x=m.currentStates,A=0;A<x.length;A++){var M=x[A];M==="emphasis"||M==="blur"||M==="select"||y.push(M)}m.selected&&m.states.select&&y.push("select"),m.hoverState===lI&&m.states.emphasis?y.push("emphasis"):m.hoverState===Ab&&m.states.blur&&y.push("blur"),m.useStates(y)}function a(m,y){var x=m._zr,A=x.storage,M=0;A.traverse(function(D){D.isGroup||M++}),M>y.get("hoverLayerThreshold")&&!Nn.node&&!Nn.worker&&y.eachSeries(function(D){if(!D.preventUsingHoverLayer){var P=m._chartsMap[D.__viewId];P.__alive&&P.eachRendered(function(O){O.states.emphasis&&(O.states.emphasis.hoverLayer=!0)})}})}function l(m,y){var x=m.get("blendMode")||null;y.eachRendered(function(A){A.isGroup||(A.style.blend=x)})}function c(m,y){if(!m.preventAutoZ){var x=m.get("z")||0,A=m.get("zlevel")||0;y.eachRendered(function(M){return o(M,x,A,-1/0),!0})}}function o(m,y,x,A){var M=m.getTextContent(),D=m.getTextGuideLine(),P=m.isGroup;if(P)for(var O=m.childrenRef(),z=0;z<O.length;z++)A=Math.max(o(O[z],y,x,A),A);else m.z=y,m.zlevel=x,A=Math.max(m.z2,A);if(M&&(M.z=y,M.zlevel=x,isFinite(A)&&(M.z2=A+2)),D){var V=m.textGuideLineConfig;D.z=y,D.zlevel=x,isFinite(A)&&(D.z2=A+(V&&V.showAbove?1:-1))}return A}function d(m,y){y.eachRendered(function(x){if(!A_(x)){var A=x.getTextContent(),M=x.getTextGuideLine();x.stateTransition&&(x.stateTransition=null),A&&A.stateTransition&&(A.stateTransition=null),M&&M.stateTransition&&(M.stateTransition=null),x.hasState()?(x.prevStates=x.currentStates,x.clearStates()):x.prevStates&&(x.prevStates=null)}})}function g(m,y){var x=m.getModel("stateAnimation"),A=m.isAnimationEnabled(),M=x.get("duration"),D=M>0?{duration:M,delay:x.get("delay"),easing:x.get("easing")}:null;y.eachRendered(function(P){if(P.states&&P.states.emphasis){if(A_(P))return;if(P instanceof kn&&abe(P),P.__dirty){var O=P.prevStates;O&&P.useStates(O)}if(A){P.stateTransition=D;var z=P.getTextContent(),V=P.getTextGuideLine();z&&(z.stateTransition=D),V&&(V.stateTransition=D)}P.__dirty&&i(P)}})}B8=function(m){return new(function(y){et(x,y);function x(){return y!==null&&y.apply(this,arguments)||this}return x.prototype.getCoordinateSystems=function(){return m._coordSysMgr.getCoordinateSystems()},x.prototype.getComponentByElement=function(A){for(;A;){var M=A.__ecComponentInfo;if(M!=null)return m._model.getComponent(M.mainType,M.index);A=A.parent}},x.prototype.enterEmphasis=function(A,M){gh(A,M),pl(m)},x.prototype.leaveEmphasis=function(A,M){vh(A,M),pl(m)},x.prototype.enterBlur=function(A){xY(A),pl(m)},x.prototype.leaveBlur=function(A){Fz(A),pl(m)},x.prototype.enterSelect=function(A){bY(A),pl(m)},x.prototype.leaveSelect=function(A){wY(A),pl(m)},x.prototype.getModel=function(){return m.getModel()},x.prototype.getViewOfComponentModel=function(A){return m.getViewOfComponentModel(A)},x.prototype.getViewOfSeriesModel=function(A){return m.getViewOfSeriesModel(A)},x}(vX))(m)},hQ=function(m){function y(x,A){for(var M=0;M<x.length;M++){var D=x[M];D[aL]=A}}fe(y1,function(x,A){m._messageCenter.on(A,function(M){if(N8[m.group]&&m[aL]!==R8){if(M&&M.escapeConnect)return;var D=m.makeActionFromEvent(M),P=[];fe(x1,function(O){O!==m&&O.group===m.group&&P.push(O)}),y(P,R8),fe(P,function(O){O[aL]!==kTe&&O.dispatchAction(D)}),y(P,OTe)}})})}}(),e}(Fl),hB=fQ.prototype;hB.on=oQ("on");hB.off=oQ("off");hB.one=function(t,e,r){var n=this;function i(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];e&&e.apply&&e.apply(this,a),n.off(t,i)}this.on.call(this,t,i,r)};var zTe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var HC={},y1={},hO=[],fO=[],jC=[],dQ={},dO={},x1={},N8={},BTe=+new Date-0,fB="_echarts_instance_";function pQ(t,e,r){{var n=FTe(t);if(n)return n}var i=new fQ(t,e,r);return i.id="ec_"+BTe++,x1[i.id]=i,nY(t,fB,i.id),hQ(i),uu.trigger("afterinit",i),i}function FTe(t){return x1[Zxe(t,fB)]}function gQ(t,e){dQ[t]=e}function vQ(t){An(fO,t)<0&&fO.push(t)}function mQ(t,e){pB(hO,t,e,CTe)}function NTe(t){dB("afterinit",t)}function VTe(t){dB("afterupdate",t)}function dB(t,e){uu.on(t,e)}function _c(t,e,r){zr(e)&&(r=e,e="");var n=Ur(t)?t.type:[t,t={event:e}][0];t.event=(t.event||n).toLowerCase(),e=t.event,!y1[e]&&(ns(L8.test(n)&&L8.test(e)),HC[n]||(HC[n]={action:r,actionInfo:t}),y1[e]=n)}function GTe(t,e){Db.register(t,e)}function UTe(t,e){pB(jC,t,e,nQ,"layout")}function pv(t,e){pB(jC,t,e,iQ,"visual")}var V8=[];function pB(t,e,r,n,i){if((zr(e)||Ur(e))&&(r=e,e=n),!(An(V8,r)>=0)){V8.push(r);var a=$X.wrapStageHandler(r,i);a.__prio=e,a.__raw=r,t.push(a)}}function _Q(t,e){dO[t]=e}function $Te(t,e,r){var n=bTe("registerMap");n&&n(t,e,r)}var HTe=iSe;pv(cB,ESe);pv(SI,DSe);pv(SI,PSe);pv(cB,HSe);pv(SI,jSe);pv(aQ,yTe);vQ(_X);mQ(TTe,Fwe);_Q("default",LSe);_c({type:Vg,event:Vg,update:Vg},Sa);_c({type:$A,event:$A,update:$A},Sa);_c({type:p1,event:p1,update:p1},Sa);_c({type:HA,event:HA,update:HA},Sa);_c({type:g1,event:g1,update:g1},Sa);gQ("light",USe);gQ("dark",ZX);var G8=[],jTe={registerPreprocessor:vQ,registerProcessor:mQ,registerPostInit:NTe,registerPostUpdate:VTe,registerUpdateLifecycle:dB,registerAction:_c,registerCoordinateSystem:GTe,registerLayout:UTe,registerVisual:pv,registerTransform:HTe,registerLoading:_Q,registerMap:$Te,registerImpl:xTe,PRIORITY:RTe,ComponentModel:$n,ComponentView:ra,SeriesModel:Wi,ChartView:Oi,registerComponentModel:function(t){$n.registerClass(t)},registerComponentView:function(t){ra.registerClass(t)},registerSeriesModel:function(t){Wi.registerClass(t)},registerChartView:function(t){Oi.registerClass(t)},registerSubTypeDefaulter:function(t,e){$n.registerSubTypeDefaulter(t,e)},registerPainter:function(t,e){Axe(t,e)}};function En(t){if(Ht(t)){fe(t,function(e){En(e)});return}An(G8,t)>=0||(G8.push(t),zr(t)&&(t={install:t}),t.install(jTe))}function xx(t){return t==null?0:t.length||1}function U8(t){return t}var mh=function(){function t(e,r,n,i,a,l){this._old=e,this._new=r,this._oldKeyGetter=n||U8,this._newKeyGetter=i||U8,this.context=a,this._diffModeMultiple=l==="multiple"}return t.prototype.add=function(e){return this._add=e,this},t.prototype.update=function(e){return this._update=e,this},t.prototype.updateManyToOne=function(e){return this._updateManyToOne=e,this},t.prototype.updateOneToMany=function(e){return this._updateOneToMany=e,this},t.prototype.updateManyToMany=function(e){return this._updateManyToMany=e,this},t.prototype.remove=function(e){return this._remove=e,this},t.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},t.prototype._executeOneToOne=function(){var e=this._old,r=this._new,n={},i=new Array(e.length),a=new Array(r.length);this._initIndexMap(e,null,i,"_oldKeyGetter"),this._initIndexMap(r,n,a,"_newKeyGetter");for(var l=0;l<e.length;l++){var c=i[l],o=n[c],d=xx(o);if(d>1){var g=o.shift();o.length===1&&(n[c]=o[0]),this._update&&this._update(g,l)}else d===1?(n[c]=null,this._update&&this._update(o,l)):this._remove&&this._remove(l)}this._performRestAdd(a,n)},t.prototype._executeMultiple=function(){var e=this._old,r=this._new,n={},i={},a=[],l=[];this._initIndexMap(e,n,a,"_oldKeyGetter"),this._initIndexMap(r,i,l,"_newKeyGetter");for(var c=0;c<a.length;c++){var o=a[c],d=n[o],g=i[o],m=xx(d),y=xx(g);if(m>1&&y===1)this._updateManyToOne&&this._updateManyToOne(g,d),i[o]=null;else if(m===1&&y>1)this._updateOneToMany&&this._updateOneToMany(g,d),i[o]=null;else if(m===1&&y===1)this._update&&this._update(g,d),i[o]=null;else if(m>1&&y>1)this._updateManyToMany&&this._updateManyToMany(g,d),i[o]=null;else if(m>1)for(var x=0;x<m;x++)this._remove&&this._remove(d[x]);else this._remove&&this._remove(d)}this._performRestAdd(l,i)},t.prototype._performRestAdd=function(e,r){for(var n=0;n<e.length;n++){var i=e[n],a=r[i],l=xx(a);if(l>1)for(var c=0;c<l;c++)this._add&&this._add(a[c]);else l===1&&this._add&&this._add(a);r[i]=null}},t.prototype._initIndexMap=function(e,r,n,i){for(var a=this._diffModeMultiple,l=0;l<e.length;l++){var c="_ec_"+this[i](e[l],l);if(a||(n[l]=c),!!r){var o=r[c],d=xx(o);d===0?(r[c]=l,a&&n.push(c)):d===1?r[c]=[o,l]:o.push(l)}}},t}(),WTe=function(){function t(e,r){this._encode=e,this._schema=r}return t.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},t.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},t}();function ZTe(t,e){var r={},n=r.encode={},i=Ir(),a=[],l=[],c={};fe(t.dimensions,function(y){var x=t.getDimensionInfo(y),A=x.coordDim;if(A){var M=x.coordDimIndex;hL(n,A)[M]=y,x.isExtraCoord||(i.set(A,1),qTe(x.type)&&(a[0]=y),hL(c,A)[M]=t.getDimensionIndex(x.name)),x.defaultTooltip&&l.push(y)}uX.each(function(D,P){var O=hL(n,P),z=x.otherDims[P];z!=null&&z!==!1&&(O[z]=x.name)})});var o=[],d={};i.each(function(y,x){var A=n[x];d[x]=A[0],o=o.concat(A)}),r.dataDimsOnCoord=o,r.dataDimIndicesOnCoord=Zt(o,function(y){return t.getDimensionInfo(y).storeDimIndex}),r.encodeFirstDimNotExtra=d;var g=n.label;g&&g.length&&(a=g.slice());var m=n.tooltip;return m&&m.length?l=m.slice():l.length||(l=a.slice()),n.defaultedLabel=a,n.defaultedTooltip=l,r.userOutput=new WTe(c,e),r}function hL(t,e){return t.hasOwnProperty(e)||(t[e]=[]),t[e]}function WC(t){return t==="category"?"ordinal":t==="time"?"time":"float"}function qTe(t){return!(t==="ordinal"||t==="time")}var YA=function(){function t(e){this.otherDims={},e!=null&&Lt(this,e)}return t}(),YTe=ri(),XTe={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},yQ=function(){function t(e){this.dimensions=e.dimensions,this._dimOmitted=e.dimensionOmitted,this.source=e.source,this._fullDimCount=e.fullDimensionCount,this._updateDimOmitted(e.dimensionOmitted)}return t.prototype.isDimensionOmitted=function(){return this._dimOmitted},t.prototype._updateDimOmitted=function(e){this._dimOmitted=e,e&&(this._dimNameMap||(this._dimNameMap=wQ(this.source)))},t.prototype.getSourceDimensionIndex=function(e){return tn(this._dimNameMap.get(e),-1)},t.prototype.getSourceDimension=function(e){var r=this.source.dimensionsDefine;if(r)return r[e]},t.prototype.makeStoreSchema=function(){for(var e=this._fullDimCount,r=xX(this.source),n=!SQ(e),i="",a=[],l=0,c=0;l<e;l++){var o=void 0,d=void 0,g=void 0,m=this.dimensions[c];if(m&&m.storeDimIndex===l)o=r?m.name:null,d=m.type,g=m.ordinalMeta,c++;else{var y=this.getSourceDimension(l);y&&(o=r?y.name:null,d=y.type)}a.push({property:o,type:d,ordinalMeta:g}),r&&o!=null&&(!m||!m.isCalculationCoord)&&(i+=n?o.replace(/\`/g,"`1").replace(/\$/g,"`2"):o),i+="$",i+=XTe[d]||"f",g&&(i+=g.uid),i+="$"}var x=this.source,A=[x.seriesLayoutBy,x.startIndex,i].join("$$");return{dimensions:a,hash:A}},t.prototype.makeOutputDimensionNames=function(){for(var e=[],r=0,n=0;r<this._fullDimCount;r++){var i=void 0,a=this.dimensions[n];if(a&&a.storeDimIndex===r)a.isCalculationCoord||(i=a.name),n++;else{var l=this.getSourceDimension(r);l&&(i=l.name)}e.push(i)}return e},t.prototype.appendCalculationDimension=function(e){this.dimensions.push(e),e.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},t}();function xQ(t){return t instanceof yQ}function bQ(t){for(var e=Ir(),r=0;r<(t||[]).length;r++){var n=t[r],i=Ur(n)?n.name:n;i!=null&&e.get(i)==null&&e.set(i,r)}return e}function wQ(t){var e=YTe(t);return e.dimNameMap||(e.dimNameMap=bQ(t.dimensionsDefine))}function SQ(t){return t>30}var bx=Ur,Mf=Zt,QTe=typeof Int32Array>"u"?Array:Int32Array,KTe="e\0\0",$8=-1,JTe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],eAe=["_approximateExtent"],H8,HT,Sx,Tx,fL,jT,dL,ts=function(){function t(e,r){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var n,i=!1;xQ(e)?(n=e.dimensions,this._dimOmitted=e.isDimensionOmitted(),this._schema=e):(i=!0,n=e),n=n||["x","y"];for(var a={},l=[],c={},o=!1,d={},g=0;g<n.length;g++){var m=n[g],y=yr(m)?new YA({name:m}):m instanceof YA?m:new YA(m),x=y.name;y.type=y.type||"float",y.coordDim||(y.coordDim=x,y.coordDimIndex=0);var A=y.otherDims=y.otherDims||{};l.push(x),a[x]=y,d[x]!=null&&(o=!0),y.createInvertedIndices&&(c[x]=[]),A.itemName===0&&(this._nameDimIdx=g),A.itemId===0&&(this._idDimIdx=g),i&&(y.storeDimIndex=g)}if(this.dimensions=l,this._dimInfos=a,this._initGetDimensionInfo(o),this.hostModel=r,this._invertedIndicesMap=c,this._dimOmitted){var M=this._dimIdxToName=Ir();fe(l,function(D){M.set(a[D].storeDimIndex,D)})}}return t.prototype.getDimension=function(e){var r=this._recognizeDimIndex(e);if(r==null)return e;if(r=e,!this._dimOmitted)return this.dimensions[r];var n=this._dimIdxToName.get(r);if(n!=null)return n;var i=this._schema.getSourceDimension(r);if(i)return i.name},t.prototype.getDimensionIndex=function(e){var r=this._recognizeDimIndex(e);if(r!=null)return r;if(e==null)return-1;var n=this._getDimInfo(e);return n?n.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(e):-1},t.prototype._recognizeDimIndex=function(e){if(ii(e)||e!=null&&!isNaN(e)&&!this._getDimInfo(e)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(e)<0))return+e},t.prototype._getStoreDimIndex=function(e){var r=this.getDimensionIndex(e);return r},t.prototype.getDimensionInfo=function(e){return this._getDimInfo(this.getDimension(e))},t.prototype._initGetDimensionInfo=function(e){var r=this._dimInfos;this._getDimInfo=e?function(n){return r.hasOwnProperty(n)?r[n]:void 0}:function(n){return r[n]}},t.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},t.prototype.mapDimension=function(e,r){var n=this._dimSummary;if(r==null)return n.encodeFirstDimNotExtra[e];var i=n.encode[e];return i?i[r]:null},t.prototype.mapDimensionsAll=function(e){var r=this._dimSummary,n=r.encode[e];return(n||[]).slice()},t.prototype.getStore=function(){return this._store},t.prototype.initData=function(e,r,n){var i=this,a;if(e instanceof iO&&(a=e),!a){var l=this.dimensions,c=rB(e)||Vo(e)?new bX(e,l.length):e;a=new iO;var o=Mf(l,function(d){return{type:i._dimInfos[d].type,property:d}});a.initData(c,o,n)}this._store=a,this._nameList=(r||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,a.count()),this._dimSummary=ZTe(this,this._schema),this.userOutput=this._dimSummary.userOutput},t.prototype.appendData=function(e){var r=this._store.appendData(e);this._doInit(r[0],r[1])},t.prototype.appendValues=function(e,r){var n=this._store.appendValues(e,r.length),i=n.start,a=n.end,l=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),r)for(var c=i;c<a;c++){var o=c-i;this._nameList[c]=r[o],l&&dL(this,c)}},t.prototype._updateOrdinalMeta=function(){for(var e=this._store,r=this.dimensions,n=0;n<r.length;n++){var i=this._dimInfos[r[n]];i.ordinalMeta&&e.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},t.prototype._shouldMakeIdFromName=function(){var e=this._store.getProvider();return this._idDimIdx==null&&e.getSource().sourceFormat!==ud&&!e.fillStorage},t.prototype._doInit=function(e,r){if(!(e>=r)){var n=this._store,i=n.getProvider();this._updateOrdinalMeta();var a=this._nameList,l=this._idList,c=i.getSource().sourceFormat,o=c===Nl;if(o&&!i.pure)for(var d=[],g=e;g<r;g++){var m=i.getItem(g,d);if(!this.hasItemOption&&kxe(m)&&(this.hasItemOption=!0),m){var y=m.name;a[g]==null&&y!=null&&(a[g]=za(y,null));var x=m.id;l[g]==null&&x!=null&&(l[g]=za(x,null))}}if(this._shouldMakeIdFromName())for(var g=e;g<r;g++)dL(this,g);H8(this)}},t.prototype.getApproximateExtent=function(e){return this._approximateExtent[e]||this._store.getDataExtent(this._getStoreDimIndex(e))},t.prototype.setApproximateExtent=function(e,r){r=this.getDimension(r),this._approximateExtent[r]=e.slice()},t.prototype.getCalculationInfo=function(e){return this._calculationInfo[e]},t.prototype.setCalculationInfo=function(e,r){bx(e)?Lt(this._calculationInfo,e):this._calculationInfo[e]=r},t.prototype.getName=function(e){var r=this.getRawIndex(e),n=this._nameList[r];return n==null&&this._nameDimIdx!=null&&(n=Sx(this,this._nameDimIdx,r)),n==null&&(n=""),n},t.prototype._getCategory=function(e,r){var n=this._store.get(e,r),i=this._store.getOrdinalMeta(e);return i?i.categories[n]:n},t.prototype.getId=function(e){return HT(this,this.getRawIndex(e))},t.prototype.count=function(){return this._store.count()},t.prototype.get=function(e,r){var n=this._store,i=this._dimInfos[e];if(i)return n.get(i.storeDimIndex,r)},t.prototype.getByRawIndex=function(e,r){var n=this._store,i=this._dimInfos[e];if(i)return n.getByRawIndex(i.storeDimIndex,r)},t.prototype.getIndices=function(){return this._store.getIndices()},t.prototype.getDataExtent=function(e){return this._store.getDataExtent(this._getStoreDimIndex(e))},t.prototype.getSum=function(e){return this._store.getSum(this._getStoreDimIndex(e))},t.prototype.getMedian=function(e){return this._store.getMedian(this._getStoreDimIndex(e))},t.prototype.getValues=function(e,r){var n=this,i=this._store;return Ht(e)?i.getValues(Mf(e,function(a){return n._getStoreDimIndex(a)}),r):i.getValues(e)},t.prototype.hasValue=function(e){for(var r=this._dimSummary.dataDimIndicesOnCoord,n=0,i=r.length;n<i;n++)if(isNaN(this._store.get(r[n],e)))return!1;return!0},t.prototype.indexOfName=function(e){for(var r=0,n=this._store.count();r<n;r++)if(this.getName(r)===e)return r;return-1},t.prototype.getRawIndex=function(e){return this._store.getRawIndex(e)},t.prototype.indexOfRawIndex=function(e){return this._store.indexOfRawIndex(e)},t.prototype.rawIndexOf=function(e,r){var n=e&&this._invertedIndicesMap[e],i=n[r];return i==null||isNaN(i)?$8:i},t.prototype.indicesOfNearest=function(e,r,n){return this._store.indicesOfNearest(this._getStoreDimIndex(e),r,n)},t.prototype.each=function(e,r,n){zr(e)&&(n=r,r=e,e=[]);var i=n||this,a=Mf(Tx(e),this._getStoreDimIndex,this);this._store.each(a,i?wr(r,i):r)},t.prototype.filterSelf=function(e,r,n){zr(e)&&(n=r,r=e,e=[]);var i=n||this,a=Mf(Tx(e),this._getStoreDimIndex,this);return this._store=this._store.filter(a,i?wr(r,i):r),this},t.prototype.selectRange=function(e){var r=this,n={},i=Hn(e);return fe(i,function(a){var l=r._getStoreDimIndex(a);n[l]=e[a]}),this._store=this._store.selectRange(n),this},t.prototype.mapArray=function(e,r,n){zr(e)&&(n=r,r=e,e=[]),n=n||this;var i=[];return this.each(e,function(){i.push(r&&r.apply(this,arguments))},n),i},t.prototype.map=function(e,r,n,i){var a=n||i||this,l=Mf(Tx(e),this._getStoreDimIndex,this),c=jT(this);return c._store=this._store.map(l,a?wr(r,a):r),c},t.prototype.modify=function(e,r,n,i){var a=n||i||this,l=Mf(Tx(e),this._getStoreDimIndex,this);this._store.modify(l,a?wr(r,a):r)},t.prototype.downSample=function(e,r,n,i){var a=jT(this);return a._store=this._store.downSample(this._getStoreDimIndex(e),r,n,i),a},t.prototype.lttbDownSample=function(e,r){var n=jT(this);return n._store=this._store.lttbDownSample(this._getStoreDimIndex(e),r),n},t.prototype.getRawDataItem=function(e){return this._store.getRawDataItem(e)},t.prototype.getItemModel=function(e){var r=this.hostModel,n=this.getRawDataItem(e);return new bi(n,r,r&&r.ecModel)},t.prototype.diff=function(e){var r=this;return new mh(e?e.getStore().getIndices():[],this.getStore().getIndices(),function(n){return HT(e,n)},function(n){return HT(r,n)})},t.prototype.getVisual=function(e){var r=this._visual;return r&&r[e]},t.prototype.setVisual=function(e,r){this._visual=this._visual||{},bx(e)?Lt(this._visual,e):this._visual[e]=r},t.prototype.getItemVisual=function(e,r){var n=this._itemVisuals[e],i=n&&n[r];return i??this.getVisual(r)},t.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},t.prototype.ensureUniqueItemVisual=function(e,r){var n=this._itemVisuals,i=n[e];i||(i=n[e]={});var a=i[r];return a==null&&(a=this.getVisual(r),Ht(a)?a=a.slice():bx(a)&&(a=Lt({},a)),i[r]=a),a},t.prototype.setItemVisual=function(e,r,n){var i=this._itemVisuals[e]||{};this._itemVisuals[e]=i,bx(r)?Lt(i,r):i[r]=n},t.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},t.prototype.setLayout=function(e,r){bx(e)?Lt(this._layout,e):this._layout[e]=r},t.prototype.getLayout=function(e){return this._layout[e]},t.prototype.getItemLayout=function(e){return this._itemLayouts[e]},t.prototype.setItemLayout=function(e,r,n){this._itemLayouts[e]=n?Lt(this._itemLayouts[e]||{},r):r},t.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},t.prototype.setItemGraphicEl=function(e,r){var n=this.hostModel&&this.hostModel.seriesIndex;jk(n,this.dataType,e,r),this._graphicEls[e]=r},t.prototype.getItemGraphicEl=function(e){return this._graphicEls[e]},t.prototype.eachItemGraphicEl=function(e,r){fe(this._graphicEls,function(n,i){n&&e&&e.call(r,n,i)})},t.prototype.cloneShallow=function(e){return e||(e=new t(this._schema?this._schema:Mf(this.dimensions,this._getDimInfo,this),this.hostModel)),fL(e,this),e._store=this._store,e},t.prototype.wrapMethod=function(e,r){var n=this[e];zr(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var i=n.apply(this,arguments);return r.apply(this,[i].concat(bz(arguments)))})},t.internalField=function(){H8=function(e){var r=e._invertedIndicesMap;fe(r,function(n,i){var a=e._dimInfos[i],l=a.ordinalMeta,c=e._store;if(l){n=r[i]=new QTe(l.categories.length);for(var o=0;o<n.length;o++)n[o]=$8;for(var o=0;o<c.count();o++)n[c.get(a.storeDimIndex,o)]=o}})},Sx=function(e,r,n){return za(e._getCategory(r,n),null)},HT=function(e,r){var n=e._idList[r];return n==null&&e._idDimIdx!=null&&(n=Sx(e,e._idDimIdx,r)),n==null&&(n=KTe+r),n},Tx=function(e){return Ht(e)||(e=e!=null?[e]:[]),e},jT=function(e){var r=new t(e._schema?e._schema:Mf(e.dimensions,e._getDimInfo,e),e.hostModel);return fL(r,e),r},fL=function(e,r){fe(JTe.concat(r.__wrappedMethods||[]),function(n){r.hasOwnProperty(n)&&(e[n]=r[n])}),e.__wrappedMethods=r.__wrappedMethods,fe(eAe,function(n){e[n]=$r(r[n])}),e._calculationInfo=Lt({},r._calculationInfo)},dL=function(e,r){var n=e._nameList,i=e._idList,a=e._nameDimIdx,l=e._idDimIdx,c=n[r],o=i[r];if(c==null&&a!=null&&(n[r]=c=Sx(e,a,r)),o==null&&l!=null&&(i[r]=o=Sx(e,l,r)),o==null&&c!=null){var d=e._nameRepeatCount,g=d[c]=(d[c]||0)+1;o=c,g>1&&(o+="__ec__"+g),i[r]=o}}}(),t}();function Lb(t,e){rB(t)||(t=nB(t)),e=e||{};var r=e.coordDimensions||[],n=e.dimensionsDefine||t.dimensionsDefine||[],i=Ir(),a=[],l=rAe(t,r,n,e.dimensionsCount),c=e.canOmitUnusedDimensions&&SQ(l),o=n===t.dimensionsDefine,d=o?wQ(t):bQ(n),g=e.encodeDefine;!g&&e.encodeDefaulter&&(g=e.encodeDefaulter(t,l));for(var m=Ir(g),y=new EX(l),x=0;x<y.length;x++)y[x]=-1;function A(Y){var J=y[Y];if(J<0){var re=n[Y],ae=Ur(re)?re:{name:re},pe=new YA,de=ae.name;de!=null&&d.get(de)!=null&&(pe.name=pe.displayName=de),ae.type!=null&&(pe.type=ae.type),ae.displayName!=null&&(pe.displayName=ae.displayName);var ve=a.length;return y[Y]=ve,pe.storeDimIndex=Y,a.push(pe),pe}return a[J]}if(!c)for(var x=0;x<l;x++)A(x);m.each(function(Y,J){var re=Pi(Y).slice();if(re.length===1&&!yr(re[0])&&re[0]<0){m.set(J,!1);return}var ae=m.set(J,[]);fe(re,function(pe,de){var ve=yr(pe)?d.get(pe):pe;ve!=null&&ve<l&&(ae[de]=ve,D(A(ve),J,de))})});var M=0;fe(r,function(Y){var J,re,ae,pe;if(yr(Y))J=Y,pe={};else{pe=Y,J=pe.name;var de=pe.ordinalMeta;pe.ordinalMeta=null,pe=Lt({},pe),pe.ordinalMeta=de,re=pe.dimsDef,ae=pe.otherDims,pe.name=pe.coordDim=pe.coordDimIndex=pe.dimsDef=pe.otherDims=null}var ve=m.get(J);if(ve!==!1){if(ve=Pi(ve),!ve.length)for(var me=0;me<(re&&re.length||1);me++){for(;M<l&&A(M).coordDim!=null;)M++;M<l&&ve.push(M++)}fe(ve,function(Ie,Le){var Ee=A(Ie);if(o&&pe.type!=null&&(Ee.type=pe.type),D(Fr(Ee,pe),J,Le),Ee.name==null&&re){var Ue=re[Le];!Ur(Ue)&&(Ue={name:Ue}),Ee.name=Ee.displayName=Ue.name,Ee.defaultTooltip=Ue.defaultTooltip}ae&&Fr(Ee.otherDims,ae)})}});function D(Y,J,re){uX.get(J)!=null?Y.otherDims[J]=re:(Y.coordDim=J,Y.coordDimIndex=re,i.set(J,!0))}var P=e.generateCoord,O=e.generateCoordCount,z=O!=null;O=P?O||1:0;var V=P||"value";function H(Y){Y.name==null&&(Y.name=Y.coordDim)}if(c)fe(a,function(Y){H(Y)}),a.sort(function(Y,J){return Y.storeDimIndex-J.storeDimIndex});else for(var $=0;$<l;$++){var X=A($),W=X.coordDim;W==null&&(X.coordDim=nAe(V,i,z),X.coordDimIndex=0,(!P||O<=0)&&(X.isExtraCoord=!0),O--),H(X),X.type==null&&(dX(t,$)===xo.Must||X.isExtraCoord&&(X.otherDims.itemName!=null||X.otherDims.seriesName!=null))&&(X.type="ordinal")}return tAe(a),new yQ({source:t,dimensions:a,fullDimensionCount:l,dimensionOmitted:c})}function tAe(t){for(var e=Ir(),r=0;r<t.length;r++){var n=t[r],i=n.name,a=e.get(i)||0;a>0&&(n.name=i+(a-1)),a++,e.set(i,a)}}function rAe(t,e,r,n){var i=Math.max(t.dimensionsDetectedCount||1,e.length,r.length,n||0);return fe(e,function(a){var l;Ur(a)&&(l=a.dimsDef)&&(i=Math.max(i,l.length))}),i}function nAe(t,e,r){if(r||e.hasKey(t)){for(var n=0;e.hasKey(t+n);)n++;t+=n}return e.set(t,!0),t}var iAe=function(){function t(e){this.coordSysDims=[],this.axisMap=Ir(),this.categoryAxisMap=Ir(),this.coordSysName=e}return t}();function aAe(t){var e=t.get("coordinateSystem"),r=new iAe(e),n=oAe[e];if(n)return n(t,r,r.axisMap,r.categoryAxisMap),r}var oAe={cartesian2d:function(t,e,r,n){var i=t.getReferringComponents("xAxis",Ma).models[0],a=t.getReferringComponents("yAxis",Ma).models[0];e.coordSysDims=["x","y"],r.set("x",i),r.set("y",a),e_(i)&&(n.set("x",i),e.firstCategoryDimIndex=0),e_(a)&&(n.set("y",a),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},singleAxis:function(t,e,r,n){var i=t.getReferringComponents("singleAxis",Ma).models[0];e.coordSysDims=["single"],r.set("single",i),e_(i)&&(n.set("single",i),e.firstCategoryDimIndex=0)},polar:function(t,e,r,n){var i=t.getReferringComponents("polar",Ma).models[0],a=i.findAxisModel("radiusAxis"),l=i.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],r.set("radius",a),r.set("angle",l),e_(a)&&(n.set("radius",a),e.firstCategoryDimIndex=0),e_(l)&&(n.set("angle",l),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},geo:function(t,e,r,n){e.coordSysDims=["lng","lat"]},parallel:function(t,e,r,n){var i=t.ecModel,a=i.getComponent("parallel",t.get("parallelIndex")),l=e.coordSysDims=a.dimensions.slice();fe(a.parallelAxisIndex,function(c,o){var d=i.getComponent("parallelAxis",c),g=l[o];r.set(g,d),e_(d)&&(n.set(g,d),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=o))})}};function e_(t){return t.get("type")==="category"}function sAe(t,e,r){r=r||{};var n=r.byIndex,i=r.stackedCoordDimension,a,l,c;lAe(e)?a=e:(l=e.schema,a=l.dimensions,c=e.store);var o=!!(t&&t.get("stack")),d,g,m,y;if(fe(a,function(O,z){yr(O)&&(a[z]=O={name:O}),o&&!O.isExtraCoord&&(!n&&!d&&O.ordinalMeta&&(d=O),!g&&O.type!=="ordinal"&&O.type!=="time"&&(!i||i===O.coordDim)&&(g=O))}),g&&!n&&!d&&(n=!0),g){m="__\0ecstackresult_"+t.id,y="__\0ecstackedover_"+t.id,d&&(d.createInvertedIndices=!0);var x=g.coordDim,A=g.type,M=0;fe(a,function(O){O.coordDim===x&&M++});var D={name:m,coordDim:x,coordDimIndex:M,type:A,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length},P={name:y,coordDim:y,coordDimIndex:M+1,type:A,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length+1};l?(c&&(D.storeDimIndex=c.ensureCalculationDimension(y,A),P.storeDimIndex=c.ensureCalculationDimension(m,A)),l.appendCalculationDimension(D),l.appendCalculationDimension(P)):(a.push(D),a.push(P))}return{stackedDimension:g&&g.name,stackedByDimension:d&&d.name,isStackedByIndex:n,stackedOverDimension:y,stackResultDimension:m}}function lAe(t){return!xQ(t.schema)}function yd(t,e){return!!e&&e===t.getCalculationInfo("stackedDimension")}function TQ(t,e){return yd(t,e)?t.getCalculationInfo("stackResultDimension"):e}function uAe(t,e){var r=t.get("coordinateSystem"),n=Db.get(r),i;return e&&e.coordSysDims&&(i=Zt(e.coordSysDims,function(a){var l={name:a},c=e.axisMap.get(a);if(c){var o=c.get("type");l.type=WC(o)}return l})),i||(i=n&&(n.getDimensionsInfo?n.getDimensionsInfo():n.dimensions.slice())||["x","y"]),i}function cAe(t,e,r){var n,i;return r&&fe(t,function(a,l){var c=a.coordDim,o=r.categoryAxisMap.get(c);o&&(n==null&&(n=l),a.ordinalMeta=o.getOrdinalMeta(),e&&(a.createInvertedIndices=!0)),a.otherDims.itemName!=null&&(i=!0)}),!i&&n!=null&&(t[n].otherDims.itemName=0),n}function Mh(t,e,r){r=r||{};var n=e.getSourceManager(),i,a=!1;t?(a=!0,i=nB(t)):(i=n.getSource(),a=i.sourceFormat===Nl);var l=aAe(e),c=uAe(e,l),o=r.useEncodeDefaulter,d=zr(o)?o:o?on(fX,c,e):null,g={coordDimensions:c,generateCoord:r.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:d,canOmitUnusedDimensions:!a},m=Lb(i,g),y=cAe(m.dimensions,r.createInvertedIndices,l),x=a?null:n.getSharedDataStore(m),A=sAe(e,{schema:m,store:x}),M=new ts(m,e);M.setCalculationInfo(A);var D=y!=null&&hAe(i)?function(P,O,z,V){return V===y?z:this.defaultDimValueGetter(P,O,z,V)}:null;return M.hasItemOption=!1,M.initData(a?i:x,null,D),M}function hAe(t){if(t.sourceFormat===Nl){var e=fAe(t.data||[]);return!Ht(oy(e))}}function fAe(t){for(var e=0;e<t.length&&t[e]==null;)e++;return t[e]}var yc=function(){function t(e){this._setting=e||{},this._extent=[1/0,-1/0]}return t.prototype.getSetting=function(e){return this._setting[e]},t.prototype.unionExtent=function(e){var r=this._extent;e[0]<r[0]&&(r[0]=e[0]),e[1]>r[1]&&(r[1]=e[1])},t.prototype.unionExtentFromData=function(e,r){this.unionExtent(e.getApproximateExtent(r))},t.prototype.getExtent=function(){return this._extent.slice()},t.prototype.setExtent=function(e,r){var n=this._extent;isNaN(e)||(n[0]=e),isNaN(r)||(n[1]=r)},t.prototype.isInExtentRange=function(e){return this._extent[0]<=e&&this._extent[1]>=e},t.prototype.isBlank=function(){return this._isBlank},t.prototype.setBlank=function(e){this._isBlank=e},t}();iI(yc);var dAe=0,pO=function(){function t(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this.uid=++dAe}return t.createByAxisModel=function(e){var r=e.option,n=r.data,i=n&&Zt(n,pAe);return new t({categories:i,needCollect:!i,deduplication:r.dedplication!==!1})},t.prototype.getOrdinal=function(e){return this._getOrCreateMap().get(e)},t.prototype.parseAndCollect=function(e){var r,n=this._needCollect;if(!yr(e)&&!n)return e;if(n&&!this._deduplication)return r=this.categories.length,this.categories[r]=e,r;var i=this._getOrCreateMap();return r=i.get(e),r==null&&(n?(r=this.categories.length,this.categories[r]=e,i.set(e,r)):r=NaN),r},t.prototype._getOrCreateMap=function(){return this._map||(this._map=Ir(this.categories))},t}();function pAe(t){return Ur(t)&&t.value!=null?t.value:t+""}function gO(t){return t.type==="interval"||t.type==="log"}function gAe(t,e,r,n){var i={},a=t[1]-t[0],l=i.interval=Y2(a/e);r!=null&&l<r&&(l=i.interval=r),n!=null&&l>n&&(l=i.interval=n);var c=i.intervalPrecision=AQ(l),o=i.niceTickExtent=[ma(Math.ceil(t[0]/l)*l,c),ma(Math.floor(t[1]/l)*l,c)];return vAe(o,t),i}function pL(t){var e=Math.pow(10,Ez(t)),r=t/e;return r?r===2?r=3:r===3?r=5:r*=2:r=1,ma(r*e)}function AQ(t){return Ju(t)+2}function j8(t,e,r){t[e]=Math.max(Math.min(t[e],r[1]),r[0])}function vAe(t,e){!isFinite(t[0])&&(t[0]=e[0]),!isFinite(t[1])&&(t[1]=e[1]),j8(t,0,e),j8(t,1,e),t[0]>t[1]&&(t[0]=t[1])}function TI(t,e){return t>=e[0]&&t<=e[1]}function AI(t,e){return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0])}function CI(t,e){return t*(e[1]-e[0])+e[0]}var MI=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;n.type="ordinal";var i=n.getSetting("ordinalMeta");return i||(i=new pO({})),Ht(i)&&(i=new pO({categories:Zt(i,function(a){return Ur(a)?a.value:a})})),n._ordinalMeta=i,n._extent=n.getSetting("extent")||[0,i.categories.length-1],n}return e.prototype.parse=function(r){return r==null?NaN:yr(r)?this._ordinalMeta.getOrdinal(r):Math.round(r)},e.prototype.contain=function(r){return r=this.parse(r),TI(r,this._extent)&&this._ordinalMeta.categories[r]!=null},e.prototype.normalize=function(r){return r=this._getTickNumber(this.parse(r)),AI(r,this._extent)},e.prototype.scale=function(r){return r=Math.round(CI(r,this._extent)),this.getRawOrdinalNumber(r)},e.prototype.getTicks=function(){for(var r=[],n=this._extent,i=n[0];i<=n[1];)r.push({value:i}),i++;return r},e.prototype.getMinorTicks=function(r){},e.prototype.setSortInfo=function(r){if(r==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var n=r.ordinalNumbers,i=this._ordinalNumbersByTick=[],a=this._ticksByOrdinalNumber=[],l=0,c=this._ordinalMeta.categories.length,o=Math.min(c,n.length);l<o;++l){var d=n[l];i[l]=d,a[d]=l}for(var g=0;l<c;++l){for(;a[g]!=null;)g++;i.push(g),a[g]=l}},e.prototype._getTickNumber=function(r){var n=this._ticksByOrdinalNumber;return n&&r>=0&&r<n.length?n[r]:r},e.prototype.getRawOrdinalNumber=function(r){var n=this._ordinalNumbersByTick;return n&&r>=0&&r<n.length?n[r]:r},e.prototype.getLabel=function(r){if(!this.isBlank()){var n=this.getRawOrdinalNumber(r.value),i=this._ordinalMeta.categories[n];return i==null?"":i+""}},e.prototype.count=function(){return this._extent[1]-this._extent[0]+1},e.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},e.prototype.isInExtentRange=function(r){return r=this._getTickNumber(r),this._extent[0]<=r&&this._extent[1]>=r},e.prototype.getOrdinalMeta=function(){return this._ordinalMeta},e.prototype.calcNiceTicks=function(){},e.prototype.calcNiceExtent=function(){},e.type="ordinal",e}(yc);yc.registerClass(MI);var ng=ma,_h=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="interval",r._interval=0,r._intervalPrecision=2,r}return e.prototype.parse=function(r){return r},e.prototype.contain=function(r){return TI(r,this._extent)},e.prototype.normalize=function(r){return AI(r,this._extent)},e.prototype.scale=function(r){return CI(r,this._extent)},e.prototype.setExtent=function(r,n){var i=this._extent;isNaN(r)||(i[0]=parseFloat(r)),isNaN(n)||(i[1]=parseFloat(n))},e.prototype.unionExtent=function(r){var n=this._extent;r[0]<n[0]&&(n[0]=r[0]),r[1]>n[1]&&(n[1]=r[1]),this.setExtent(n[0],n[1])},e.prototype.getInterval=function(){return this._interval},e.prototype.setInterval=function(r){this._interval=r,this._niceExtent=this._extent.slice(),this._intervalPrecision=AQ(r)},e.prototype.getTicks=function(r){var n=this._interval,i=this._extent,a=this._niceExtent,l=this._intervalPrecision,c=[];if(!n)return c;var o=1e4;i[0]<a[0]&&(r?c.push({value:ng(a[0]-n,l)}):c.push({value:i[0]}));for(var d=a[0];d<=a[1]&&(c.push({value:d}),d=ng(d+n,l),d!==c[c.length-1].value);)if(c.length>o)return[];var g=c.length?c[c.length-1].value:a[1];return i[1]>g&&(r?c.push({value:ng(g+n,l)}):c.push({value:i[1]})),c},e.prototype.getMinorTicks=function(r){for(var n=this.getTicks(!0),i=[],a=this.getExtent(),l=1;l<n.length;l++){for(var c=n[l],o=n[l-1],d=0,g=[],m=c.value-o.value,y=m/r;d<r-1;){var x=ng(o.value+(d+1)*y);x>a[0]&&x<a[1]&&g.push(x),d++}i.push(g)}return i},e.prototype.getLabel=function(r,n){if(r==null)return"";var i=n&&n.precision;i==null?i=Ju(r.value)||0:i==="auto"&&(i=this._intervalPrecision);var a=ng(r.value,i,!0);return nX(a)},e.prototype.calcNiceTicks=function(r,n,i){r=r||5;var a=this._extent,l=a[1]-a[0];if(isFinite(l)){l<0&&(l=-l,a.reverse());var c=gAe(a,r,n,i);this._intervalPrecision=c.intervalPrecision,this._interval=c.interval,this._niceExtent=c.niceTickExtent}},e.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1])if(n[0]!==0){var i=Math.abs(n[0]);r.fixMax||(n[1]+=i/2),n[0]-=i/2}else n[1]=1;var a=n[1]-n[0];isFinite(a)||(n[0]=0,n[1]=1),this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval);var l=this._interval;r.fixMin||(n[0]=ng(Math.floor(n[0]/l)*l)),r.fixMax||(n[1]=ng(Math.ceil(n[1]/l)*l))},e.prototype.setNiceExtent=function(r,n){this._niceExtent=[r,n]},e.type="interval",e}(yc);yc.registerClass(_h);var CQ=typeof Float32Array<"u",mAe=CQ?Float32Array:Array;function tc(t){return Ht(t)?CQ?new Float32Array(t):t:new mAe(t)}var vO="__ec_stack_";function gB(t){return t.get("stack")||vO+t.seriesIndex}function vB(t){return t.dim+t.index}function _Ae(t){var e=[],r=t.axis,n="axis0";if(r.type==="category"){for(var i=r.getBandWidth(),a=0;a<t.count;a++)e.push(Fr({bandWidth:i,axisKey:n,stackId:vO+a},t));for(var l=EQ(e),c=[],a=0;a<t.count;a++){var o=l[n][vO+a];o.offsetCenter=o.offset+o.width/2,c.push(o)}return c}}function MQ(t,e){var r=[];return e.eachSeriesByType(t,function(n){LQ(n)&&r.push(n)}),r}function yAe(t){var e={};fe(t,function(o){var d=o.coordinateSystem,g=d.getBaseAxis();if(!(g.type!=="time"&&g.type!=="value"))for(var m=o.getData(),y=g.dim+"_"+g.index,x=m.getDimensionIndex(m.mapDimension(g.dim)),A=m.getStore(),M=0,D=A.count();M<D;++M){var P=A.get(x,M);e[y]?e[y].push(P):e[y]=[P]}});var r={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(i){i.sort(function(o,d){return o-d});for(var a=null,l=1;l<i.length;++l){var c=i[l]-i[l-1];c>0&&(a=a===null?c:Math.min(a,c))}r[n]=a}}return r}function IQ(t){var e=yAe(t),r=[];return fe(t,function(n){var i=n.coordinateSystem,a=i.getBaseAxis(),l=a.getExtent(),c;if(a.type==="category")c=a.getBandWidth();else if(a.type==="value"||a.type==="time"){var o=a.dim+"_"+a.index,d=e[o],g=Math.abs(l[1]-l[0]),m=a.scale.getExtent(),y=Math.abs(m[1]-m[0]);c=d?g/y*d:g}else{var x=n.getData();c=Math.abs(l[1]-l[0])/x.count()}var A=dr(n.get("barWidth"),c),M=dr(n.get("barMaxWidth"),c),D=dr(n.get("barMinWidth")||(RQ(n)?.5:1),c),P=n.get("barGap"),O=n.get("barCategoryGap");r.push({bandWidth:c,barWidth:A,barMaxWidth:M,barMinWidth:D,barGap:P,barCategoryGap:O,axisKey:vB(a),stackId:gB(n)})}),EQ(r)}function EQ(t){var e={};fe(t,function(n,i){var a=n.axisKey,l=n.bandWidth,c=e[a]||{bandWidth:l,remainedWidth:l,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},o=c.stacks;e[a]=c;var d=n.stackId;o[d]||c.autoWidthCount++,o[d]=o[d]||{width:0,maxWidth:0};var g=n.barWidth;g&&!o[d].width&&(o[d].width=g,g=Math.min(c.remainedWidth,g),c.remainedWidth-=g);var m=n.barMaxWidth;m&&(o[d].maxWidth=m);var y=n.barMinWidth;y&&(o[d].minWidth=y);var x=n.barGap;x!=null&&(c.gap=x);var A=n.barCategoryGap;A!=null&&(c.categoryGap=A)});var r={};return fe(e,function(n,i){r[i]={};var a=n.stacks,l=n.bandWidth,c=n.categoryGap;if(c==null){var o=Hn(a).length;c=Math.max(35-o*4,15)+"%"}var d=dr(c,l),g=dr(n.gap,1),m=n.remainedWidth,y=n.autoWidthCount,x=(m-d)/(y+(y-1)*g);x=Math.max(x,0),fe(a,function(P){var O=P.maxWidth,z=P.minWidth;if(P.width){var V=P.width;O&&(V=Math.min(V,O)),z&&(V=Math.max(V,z)),P.width=V,m-=V+g*V,y--}else{var V=x;O&&O<V&&(V=Math.min(O,m)),z&&z>V&&(V=z),V!==x&&(P.width=V,m-=V+g*V,y--)}}),x=(m-d)/(y+(y-1)*g),x=Math.max(x,0);var A=0,M;fe(a,function(P,O){P.width||(P.width=x),M=P,A+=P.width*(1+g)}),M&&(A-=M.width*g);var D=-A/2;fe(a,function(P,O){r[i][O]=r[i][O]||{bandWidth:l,offset:D,width:P.width},D+=P.width*(1+g)})}),r}function xAe(t,e,r){if(t&&e){var n=t[vB(e)];return n!=null&&r!=null?n[gB(r)]:n}}function DQ(t,e){var r=MQ(t,e),n=IQ(r);fe(r,function(i){var a=i.getData(),l=i.coordinateSystem,c=l.getBaseAxis(),o=gB(i),d=n[vB(c)][o],g=d.offset,m=d.width;a.setLayout({bandWidth:d.bandWidth,offset:g,size:m})})}function PQ(t){return{seriesType:t,plan:gy(),reset:function(e){if(LQ(e)){var r=e.getData(),n=e.coordinateSystem,i=n.getBaseAxis(),a=n.getOtherAxis(i),l=r.getDimensionIndex(r.mapDimension(a.dim)),c=r.getDimensionIndex(r.mapDimension(i.dim)),o=e.get("showBackground",!0),d=r.mapDimension(a.dim),g=r.getCalculationInfo("stackResultDimension"),m=yd(r,d)&&!!r.getCalculationInfo("stackedOnSeries"),y=a.isHorizontal(),x=bAe(i,a),A=RQ(e),M=e.get("barMinHeight")||0,D=g&&r.getDimensionIndex(g),P=r.getLayout("size"),O=r.getLayout("offset");return{progress:function(z,V){for(var H=z.count,$=A&&tc(H*3),X=A&&o&&tc(H*3),W=A&&tc(H),Y=n.master.getRect(),J=y?Y.width:Y.height,re,ae=V.getStore(),pe=0;(re=z.next())!=null;){var de=ae.get(m?D:l,re),ve=ae.get(c,re),me=x,Ie=void 0;m&&(Ie=+de-ae.get(l,re));var Le=void 0,Ee=void 0,Ue=void 0,Ke=void 0;if(y){var We=n.dataToPoint([de,ve]);if(m){var Rt=n.dataToPoint([Ie,ve]);me=Rt[0]}Le=me,Ee=We[1]+O,Ue=We[0]-me,Ke=P,Math.abs(Ue)<M&&(Ue=(Ue<0?-1:1)*M)}else{var We=n.dataToPoint([ve,de]);if(m){var Rt=n.dataToPoint([ve,Ie]);me=Rt[1]}Le=We[0]+O,Ee=me,Ue=P,Ke=We[1]-me,Math.abs(Ke)<M&&(Ke=(Ke<=0?-1:1)*M)}A?($[pe]=Le,$[pe+1]=Ee,$[pe+2]=y?Ue:Ke,X&&(X[pe]=y?Y.x:Le,X[pe+1]=y?Ee:Y.y,X[pe+2]=J),W[re]=re):V.setItemLayout(re,{x:Le,y:Ee,width:Ue,height:Ke}),pe+=3}A&&V.setLayout({largePoints:$,largeDataIndices:W,largeBackgroundPoints:X,valueAxisHorizontal:y})}}}}}}function LQ(t){return t.coordinateSystem&&t.coordinateSystem.type==="cartesian2d"}function RQ(t){return t.pipelineContext&&t.pipelineContext.large}function bAe(t,e){return e.toGlobalCoord(e.dataToCoord(e.type==="log"?1:0))}var wAe=function(t,e,r,n){for(;r<n;){var i=r+n>>>1;t[i][1]<e?r=i+1:n=i}return r},mB=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="time",n}return e.prototype.getLabel=function(r){var n=this.getSetting("useUTC");return gI(r.value,OU[iwe(M_(this._minLevelUnit))]||OU.second,n,this.getSetting("locale"))},e.prototype.getFormattedLabel=function(r,n,i){var a=this.getSetting("useUTC"),l=this.getSetting("locale");return awe(r,n,i,l,a)},e.prototype.getTicks=function(){var r=this._interval,n=this._extent,i=[];if(!r)return i;i.push({value:n[0],level:0});var a=this.getSetting("useUTC"),l=EAe(this._minLevelUnit,this._approxInterval,a,n);return i=i.concat(l),i.push({value:n[1],level:0}),i},e.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1]&&(n[0]-=Ml,n[1]+=Ml),n[1]===-1/0&&n[0]===1/0){var i=new Date;n[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),n[0]=n[1]-Ml}this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval)},e.prototype.calcNiceTicks=function(r,n,i){r=r||10;var a=this._extent,l=a[1]-a[0];this._approxInterval=l/r,n!=null&&this._approxInterval<n&&(this._approxInterval=n),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var c=WT.length,o=Math.min(wAe(WT,this._approxInterval,0,c),c-1);this._interval=WT[o][1],this._minLevelUnit=WT[Math.max(o-1,0)][0]},e.prototype.parse=function(r){return ii(r)?r:+dc(r)},e.prototype.contain=function(r){return TI(this.parse(r),this._extent)},e.prototype.normalize=function(r){return AI(this.parse(r),this._extent)},e.prototype.scale=function(r){return CI(r,this._extent)},e.type="time",e}(_h),WT=[["second",qz],["minute",Yz],["hour",m1],["quarter-day",m1*6],["half-day",m1*12],["day",Ml*1.2],["half-week",Ml*3.5],["week",Ml*7],["month",Ml*31],["quarter",Ml*95],["half-year",kU/2],["year",kU]];function SAe(t,e,r,n){var i=dc(e),a=dc(r),l=function(A){return zU(i,A,n)===zU(a,A,n)},c=function(){return l("year")},o=function(){return c()&&l("month")},d=function(){return o()&&l("day")},g=function(){return d()&&l("hour")},m=function(){return g()&&l("minute")},y=function(){return m()&&l("second")},x=function(){return y()&&l("millisecond")};switch(t){case"year":return c();case"month":return o();case"day":return d();case"hour":return g();case"minute":return m();case"second":return y();case"millisecond":return x()}}function TAe(t,e){return t/=Ml,t>16?16:t>7.5?7:t>3.5?4:t>1.5?2:1}function AAe(t){var e=30*Ml;return t/=e,t>6?6:t>3?3:t>2?2:1}function CAe(t){return t/=m1,t>12?12:t>6?6:t>3.5?4:t>2?2:1}function W8(t,e){return t/=e?Yz:qz,t>30?30:t>20?20:t>15?15:t>10?10:t>5?5:t>2?2:1}function MAe(t){return Y2(t)}function IAe(t,e,r){var n=new Date(t);switch(M_(e)){case"year":case"month":n[QY(r)](0);case"day":n[KY(r)](1);case"hour":n[JY(r)](0);case"minute":n[eX(r)](0);case"second":n[tX(r)](0),n[rX(r)](0)}return n.getTime()}function EAe(t,e,r,n){var i=1e4,a=YY,l=0;function c(J,re,ae,pe,de,ve,me){for(var Ie=new Date(re),Le=re,Ee=Ie[pe]();Le<ae&&Le<=n[1];)me.push({value:Le}),Ee+=J,Ie[de](Ee),Le=Ie.getTime();me.push({value:Le,notAdd:!0})}function o(J,re,ae){var pe=[],de=!re.length;if(!SAe(M_(J),n[0],n[1],r)){de&&(re=[{value:IAe(new Date(n[0]),J,r)},{value:n[1]}]);for(var ve=0;ve<re.length-1;ve++){var me=re[ve].value,Ie=re[ve+1].value;if(me!==Ie){var Le=void 0,Ee=void 0,Ue=void 0,Ke=!1;switch(J){case"year":Le=Math.max(1,Math.round(e/Ml/365)),Ee=Xz(r),Ue=owe(r);break;case"half-year":case"quarter":case"month":Le=AAe(e),Ee=I_(r),Ue=QY(r);break;case"week":case"half-week":case"day":Le=TAe(e),Ee=vI(r),Ue=KY(r),Ke=!0;break;case"half-day":case"quarter-day":case"hour":Le=CAe(e),Ee=Z1(r),Ue=JY(r);break;case"minute":Le=W8(e,!0),Ee=mI(r),Ue=eX(r);break;case"second":Le=W8(e,!1),Ee=_I(r),Ue=tX(r);break;case"millisecond":Le=MAe(e),Ee=yI(r),Ue=rX(r);break}c(Le,me,Ie,Ee,Ue,Ke,pe),J==="year"&&ae.length>1&&ve===0&&ae.unshift({value:ae[0].value-Le})}}for(var ve=0;ve<pe.length;ve++)ae.push(pe[ve]);return pe}}for(var d=[],g=[],m=0,y=0,x=0;x<a.length&&l++<i;++x){var A=M_(a[x]);if(nwe(a[x])){o(a[x],d[d.length-1]||[],g);var M=a[x+1]?M_(a[x+1]):null;if(A!==M){if(g.length){y=m,g.sort(function(J,re){return J.value-re.value});for(var D=[],P=0;P<g.length;++P){var O=g[P].value;(P===0||g[P-1].value!==O)&&(D.push(g[P]),O>=n[0]&&O<=n[1]&&m++)}var z=(n[1]-n[0])/e;if(m>z*1.5&&y>z/1.5||(d.push(D),m>z||t===a[x]))break}g=[]}}}for(var V=Ei(Zt(d,function(J){return Ei(J,function(re){return re.value>=n[0]&&re.value<=n[1]&&!re.notAdd})}),function(J){return J.length>0}),H=[],$=V.length-1,x=0;x<V.length;++x)for(var X=V[x],W=0;W<X.length;++W)H.push({value:X[W].value,level:$-x});H.sort(function(J,re){return J.value-re.value});for(var Y=[],x=0;x<H.length;++x)(x===0||H[x].value!==H[x-1].value)&&Y.push(H[x]);return Y}yc.registerClass(mB);var Z8=yc.prototype,b1=_h.prototype,DAe=ma,PAe=Math.floor,LAe=Math.ceil,ZT=Math.pow,au=Math.log,_B=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="log",r.base=10,r._originalScale=new _h,r._interval=0,r}return e.prototype.getTicks=function(r){var n=this._originalScale,i=this._extent,a=n.getExtent(),l=b1.getTicks.call(this,r);return Zt(l,function(c){var o=c.value,d=ma(ZT(this.base,o));return d=o===i[0]&&this._fixMin?qT(d,a[0]):d,d=o===i[1]&&this._fixMax?qT(d,a[1]):d,{value:d}},this)},e.prototype.setExtent=function(r,n){var i=au(this.base);r=au(Math.max(0,r))/i,n=au(Math.max(0,n))/i,b1.setExtent.call(this,r,n)},e.prototype.getExtent=function(){var r=this.base,n=Z8.getExtent.call(this);n[0]=ZT(r,n[0]),n[1]=ZT(r,n[1]);var i=this._originalScale,a=i.getExtent();return this._fixMin&&(n[0]=qT(n[0],a[0])),this._fixMax&&(n[1]=qT(n[1],a[1])),n},e.prototype.unionExtent=function(r){this._originalScale.unionExtent(r);var n=this.base;r[0]=au(r[0])/au(n),r[1]=au(r[1])/au(n),Z8.unionExtent.call(this,r)},e.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},e.prototype.calcNiceTicks=function(r){r=r||10;var n=this._extent,i=n[1]-n[0];if(!(i===1/0||i<=0)){var a=Rxe(i),l=r/i*a;for(l<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var c=[ma(LAe(n[0]/a)*a),ma(PAe(n[1]/a)*a)];this._interval=a,this._niceExtent=c}},e.prototype.calcNiceExtent=function(r){b1.calcNiceExtent.call(this,r),this._fixMin=r.fixMin,this._fixMax=r.fixMax},e.prototype.parse=function(r){return r},e.prototype.contain=function(r){return r=au(r)/au(this.base),TI(r,this._extent)},e.prototype.normalize=function(r){return r=au(r)/au(this.base),AI(r,this._extent)},e.prototype.scale=function(r){return r=CI(r,this._extent),ZT(this.base,r)},e.type="log",e}(yc),kQ=_B.prototype;kQ.getMinorTicks=b1.getMinorTicks;kQ.getLabel=b1.getLabel;function qT(t,e){return DAe(t,Ju(e))}yc.registerClass(_B);var RAe=function(){function t(e,r,n){this._prepareParams(e,r,n)}return t.prototype._prepareParams=function(e,r,n){n[1]<n[0]&&(n=[NaN,NaN]),this._dataMin=n[0],this._dataMax=n[1];var i=this._isOrdinal=e.type==="ordinal";this._needCrossZero=e.type==="interval"&&r.getNeedCrossZero&&r.getNeedCrossZero();var a=this._modelMinRaw=r.get("min",!0);zr(a)?this._modelMinNum=YT(e,a({min:n[0],max:n[1]})):a!=="dataMin"&&(this._modelMinNum=YT(e,a));var l=this._modelMaxRaw=r.get("max",!0);if(zr(l)?this._modelMaxNum=YT(e,l({min:n[0],max:n[1]})):l!=="dataMax"&&(this._modelMaxNum=YT(e,l)),i)this._axisDataLen=r.getCategories().length;else{var c=r.get("boundaryGap"),o=Ht(c)?c:[c||0,c||0];typeof o[0]=="boolean"||typeof o[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[yu(o[0],1),yu(o[1],1)]}},t.prototype.calculate=function(){var e=this._isOrdinal,r=this._dataMin,n=this._dataMax,i=this._axisDataLen,a=this._boundaryGapInner,l=e?null:n-r||Math.abs(r),c=this._modelMinRaw==="dataMin"?r:this._modelMinNum,o=this._modelMaxRaw==="dataMax"?n:this._modelMaxNum,d=c!=null,g=o!=null;c==null&&(c=e?i?0:NaN:r-a[0]*l),o==null&&(o=e?i?i-1:NaN:n+a[1]*l),(c==null||!isFinite(c))&&(c=NaN),(o==null||!isFinite(o))&&(o=NaN);var m=F1(c)||F1(o)||e&&!i;this._needCrossZero&&(c>0&&o>0&&!d&&(c=0),c<0&&o<0&&!g&&(o=0));var y=this._determinedMin,x=this._determinedMax;return y!=null&&(c=y,d=!0),x!=null&&(o=x,g=!0),{min:c,max:o,minFixed:d,maxFixed:g,isBlank:m}},t.prototype.modifyDataMinMax=function(e,r){this[OAe[e]]=r},t.prototype.setDeterminedMinMax=function(e,r){var n=kAe[e];this[n]=r},t.prototype.freeze=function(){this.frozen=!0},t}(),kAe={min:"_determinedMin",max:"_determinedMax"},OAe={min:"_dataMin",max:"_dataMax"};function OQ(t,e,r){var n=t.rawExtentInfo;return n||(n=new RAe(t,e,r),t.rawExtentInfo=n,n)}function YT(t,e){return e==null?null:F1(e)?NaN:t.parse(e)}function zQ(t,e){var r=t.type,n=OQ(t,e,t.getExtent()).calculate();t.setBlank(n.isBlank);var i=n.min,a=n.max,l=e.ecModel;if(l&&r==="time"){var c=MQ("bar",l),o=!1;if(fe(c,function(m){o=o||m.getBaseAxis()===e.axis}),o){var d=IQ(c),g=zAe(i,a,e,d);i=g.min,a=g.max}}return{extent:[i,a],fixMin:n.minFixed,fixMax:n.maxFixed}}function zAe(t,e,r,n){var i=r.axis.getExtent(),a=i[1]-i[0],l=xAe(n,r.axis);if(l===void 0)return{min:t,max:e};var c=1/0;fe(l,function(x){c=Math.min(x.offset,c)});var o=-1/0;fe(l,function(x){o=Math.max(x.offset+x.width,o)}),c=Math.abs(c),o=Math.abs(o);var d=c+o,g=e-t,m=1-(c+o)/a,y=g/m-g;return e+=y*(o/d),t-=y*(c/d),{min:t,max:e}}function W_(t,e){var r=e,n=zQ(t,r),i=n.extent,a=r.get("splitNumber");t instanceof _B&&(t.base=r.get("logBase"));var l=t.type,c=r.get("interval"),o=l==="interval"||l==="time";t.setExtent(i[0],i[1]),t.calcNiceExtent({splitNumber:a,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:o?r.get("minInterval"):null,maxInterval:o?r.get("maxInterval"):null}),c!=null&&t.setInterval&&t.setInterval(c)}function II(t,e){if(e=e||t.get("type"),e)switch(e){case"category":return new MI({ordinalMeta:t.getOrdinalMeta?t.getOrdinalMeta():t.getCategories(),extent:[1/0,-1/0]});case"time":return new mB({locale:t.ecModel.getLocaleModel(),useUTC:t.ecModel.get("useUTC")});default:return new(yc.getClass(e)||_h)}}function BAe(t){var e=t.scale.getExtent(),r=e[0],n=e[1];return!(r>0&&n>0||r<0&&n<0)}function Rb(t){var e=t.getLabelModel().get("formatter"),r=t.type==="category"?t.scale.getExtent()[0]:null;return t.scale.type==="time"?function(n){return function(i,a){return t.scale.getFormattedLabel(i,a,n)}}(e):yr(e)?function(n){return function(i){var a=t.scale.getLabel(i),l=n.replace("{value}",a??"");return l}}(e):zr(e)?function(n){return function(i,a){return r!=null&&(a=i.value-r),n(yB(t,i),a,i.level!=null?{level:i.level}:null)}}(e):function(n){return t.scale.getLabel(n)}}function yB(t,e){return t.type==="category"?t.scale.getLabel(e):e.value}function FAe(t){var e=t.model,r=t.scale;if(!(!e.get(["axisLabel","show"])||r.isBlank())){var n,i,a=r.getExtent();r instanceof MI?i=r.count():(n=r.getTicks(),i=n.length);var l=t.getLabelModel(),c=Rb(t),o,d=1;i>40&&(d=Math.ceil(i/40));for(var g=0;g<i;g+=d){var m=n?n[g]:{value:a[0]+g},y=c(m,g),x=l.getTextRect(y),A=NAe(x,l.get("rotate")||0);o?o.union(A):o=A}return o}}function NAe(t,e){var r=e*Math.PI/180,n=t.width,i=t.height,a=n*Math.abs(Math.cos(r))+Math.abs(i*Math.sin(r)),l=n*Math.abs(Math.sin(r))+Math.abs(i*Math.cos(r)),c=new gn(t.x,t.y,a,l);return c}function xB(t){var e=t.get("interval");return e??"auto"}function BQ(t){return t.type==="category"&&xB(t.getLabelModel())===0}function ZC(t,e){var r={};return fe(t.mapDimensionsAll(e),function(n){r[TQ(t,n)]=!0}),Hn(r)}function VAe(t,e,r){e&&fe(ZC(e,r),function(n){var i=e.getApproximateExtent(n);i[0]<t[0]&&(t[0]=i[0]),i[1]>t[1]&&(t[1]=i[1])})}var kb=function(){function t(){}return t.prototype.getNeedCrossZero=function(){var e=this.option;return!e.scale},t.prototype.getCoordSysModel=function(){},t}(),GAe=1e-8;function q8(t,e){return Math.abs(t-e)<GAe}function mg(t,e,r){var n=0,i=t[0];if(!i)return!1;for(var a=1;a<t.length;a++){var l=t[a];n+=Jc(i[0],i[1],l[0],l[1],e,r),i=l}var c=t[0];return(!q8(i[0],c[0])||!q8(i[1],c[1]))&&(n+=Jc(i[0],i[1],c[0],c[1],e,r)),n!==0}var UAe=[];function gL(t,e){for(var r=0;r<t.length;r++)So(t[r],t[r],e)}function Y8(t,e,r,n){for(var i=0;i<t.length;i++){var a=t[i];n&&(a=n.project(a)),a&&isFinite(a[0])&&isFinite(a[1])&&(Xf(e,e,a),Qf(r,r,a))}}function $Ae(t){for(var e=0,r=0,n=0,i=t.length,a=t[i-1][0],l=t[i-1][1],c=0;c<i;c++){var o=t[c][0],d=t[c][1],g=a*d-o*l;e+=g,r+=(a+o)*g,n+=(l+d)*g,a=o,l=d}return e?[r/e/3,n/e/3,e]:[t[0][0]||0,t[0][1]||0]}var FQ=function(){function t(e){this.name=e}return t.prototype.setCenter=function(e){this._center=e},t.prototype.getCenter=function(){var e=this._center;return e||(e=this._center=this.calcCenter()),e},t}(),X8=function(){function t(e,r){this.type="polygon",this.exterior=e,this.interiors=r}return t}(),Q8=function(){function t(e){this.type="linestring",this.points=e}return t}(),NQ=function(t){et(e,t);function e(r,n,i){var a=t.call(this,r)||this;return a.type="geoJSON",a.geometries=n,a._center=i&&[i[0],i[1]],a}return e.prototype.calcCenter=function(){for(var r=this.geometries,n,i=0,a=0;a<r.length;a++){var l=r[a],c=l.exterior,o=c&&c.length;o>i&&(n=l,i=o)}if(n)return $Ae(n.exterior);var d=this.getBoundingRect();return[d.x+d.width/2,d.y+d.height/2]},e.prototype.getBoundingRect=function(r){var n=this._rect;if(n&&!r)return n;var i=[1/0,1/0],a=[-1/0,-1/0],l=this.geometries;return fe(l,function(c){c.type==="polygon"?Y8(c.exterior,i,a,r):fe(c.points,function(o){Y8(o,i,a,r)})}),isFinite(i[0])&&isFinite(i[1])&&isFinite(a[0])&&isFinite(a[1])||(i[0]=i[1]=a[0]=a[1]=0),n=new gn(i[0],i[1],a[0]-i[0],a[1]-i[1]),r||(this._rect=n),n},e.prototype.contain=function(r){var n=this.getBoundingRect(),i=this.geometries;if(!n.contain(r[0],r[1]))return!1;e:for(var a=0,l=i.length;a<l;a++){var c=i[a];if(c.type==="polygon"){var o=c.exterior,d=c.interiors;if(mg(o,r[0],r[1])){for(var g=0;g<(d?d.length:0);g++)if(mg(d[g],r[0],r[1]))continue e;return!0}}}return!1},e.prototype.transformTo=function(r,n,i,a){var l=this.getBoundingRect(),c=l.width/l.height;i?a||(a=i/c):i=c*a;for(var o=new gn(r,n,i,a),d=l.calculateTransform(o),g=this.geometries,m=0;m<g.length;m++){var y=g[m];y.type==="polygon"?(gL(y.exterior,d),fe(y.interiors,function(x){gL(x,d)})):fe(y.points,function(x){gL(x,d)})}l=this._rect,l.copy(o),this._center=[l.x+l.width/2,l.y+l.height/2]},e.prototype.cloneShallow=function(r){r==null&&(r=this.name);var n=new e(r,this.geometries,this._center);return n._rect=this._rect,n.transformTo=null,n},e}(FQ),HAe=function(t){et(e,t);function e(r,n){var i=t.call(this,r)||this;return i.type="geoSVG",i._elOnlyForCalculate=n,i}return e.prototype.calcCenter=function(){for(var r=this._elOnlyForCalculate,n=r.getBoundingRect(),i=[n.x+n.width/2,n.y+n.height/2],a=eI(UAe),l=r;l&&!l.isGeoSVGGraphicRoot;)oh(a,l.getLocalTransform(),a),l=l.parent;return ay(a,a),So(i,i,a),i},e}(FQ);function jAe(t){if(!t.UTF8Encoding)return t;var e=t,r=e.UTF8Scale;r==null&&(r=1024);var n=e.features;return fe(n,function(i){var a=i.geometry,l=a.encodeOffsets,c=a.coordinates;if(l)switch(a.type){case"LineString":a.coordinates=VQ(c,l,r);break;case"Polygon":vL(c,l,r);break;case"MultiLineString":vL(c,l,r);break;case"MultiPolygon":fe(c,function(o,d){return vL(o,l[d],r)})}}),e.UTF8Encoding=!1,e}function vL(t,e,r){for(var n=0;n<t.length;n++)t[n]=VQ(t[n],e[n],r)}function VQ(t,e,r){for(var n=[],i=e[0],a=e[1],l=0;l<t.length;l+=2){var c=t.charCodeAt(l)-64,o=t.charCodeAt(l+1)-64;c=c>>1^-(c&1),o=o>>1^-(o&1),c+=i,o+=a,i=c,a=o,n.push([c/r,o/r])}return n}function WAe(t,e){return t=jAe(t),Zt(Ei(t.features,function(r){return r.geometry&&r.properties&&r.geometry.coordinates.length>0}),function(r){var n=r.properties,i=r.geometry,a=[];switch(i.type){case"Polygon":var l=i.coordinates;a.push(new X8(l[0],l.slice(1)));break;case"MultiPolygon":fe(i.coordinates,function(o){o[0]&&a.push(new X8(o[0],o.slice(1)))});break;case"LineString":a.push(new Q8([i.coordinates]));break;case"MultiLineString":a.push(new Q8(i.coordinates))}var c=new NQ(n[e||"name"],a,n.cp);return c.properties=n,c})}var J1=ri();function ZAe(t){return t.type==="category"?YAe(t):QAe(t)}function qAe(t,e){return t.type==="category"?XAe(t,e):{ticks:Zt(t.scale.getTicks(),function(r){return r.value})}}function YAe(t){var e=t.getLabelModel(),r=GQ(t,e);return!e.get("show")||t.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r}function GQ(t,e){var r=UQ(t,"labels"),n=xB(e),i=$Q(r,n);if(i)return i;var a,l;return zr(n)?a=WQ(t,n):(l=n==="auto"?KAe(t):n,a=jQ(t,l)),HQ(r,n,{labels:a,labelCategoryInterval:l})}function XAe(t,e){var r=UQ(t,"ticks"),n=xB(e),i=$Q(r,n);if(i)return i;var a,l;if((!e.get("show")||t.scale.isBlank())&&(a=[]),zr(n))a=WQ(t,n,!0);else if(n==="auto"){var c=GQ(t,t.getLabelModel());l=c.labelCategoryInterval,a=Zt(c.labels,function(o){return o.tickValue})}else l=n,a=jQ(t,l,!0);return HQ(r,n,{ticks:a,tickCategoryInterval:l})}function QAe(t){var e=t.scale.getTicks(),r=Rb(t);return{labels:Zt(e,function(n,i){return{level:n.level,formattedLabel:r(n,i),rawLabel:t.scale.getLabel(n),tickValue:n.value}})}}function UQ(t,e){return J1(t)[e]||(J1(t)[e]=[])}function $Q(t,e){for(var r=0;r<t.length;r++)if(t[r].key===e)return t[r].value}function HQ(t,e,r){return t.push({key:e,value:r}),r}function KAe(t){var e=J1(t).autoInterval;return e??(J1(t).autoInterval=t.calculateCategoryInterval())}function JAe(t){var e=eCe(t),r=Rb(t),n=(e.axisRotate-e.labelRotate)/180*Math.PI,i=t.scale,a=i.getExtent(),l=i.count();if(a[1]-a[0]<1)return 0;var c=1;l>40&&(c=Math.max(1,Math.floor(l/40)));for(var o=a[0],d=t.dataToCoord(o+1)-t.dataToCoord(o),g=Math.abs(d*Math.cos(n)),m=Math.abs(d*Math.sin(n)),y=0,x=0;o<=a[1];o+=c){var A=0,M=0,D=Sb(r({value:o}),e.font,"center","top");A=D.width*1.3,M=D.height*1.3,y=Math.max(y,A,7),x=Math.max(x,M,7)}var P=y/g,O=x/m;isNaN(P)&&(P=1/0),isNaN(O)&&(O=1/0);var z=Math.max(0,Math.floor(Math.min(P,O))),V=J1(t.model),H=t.getExtent(),$=V.lastAutoInterval,X=V.lastTickCount;return $!=null&&X!=null&&Math.abs($-z)<=1&&Math.abs(X-l)<=1&&$>z&&V.axisExtent0===H[0]&&V.axisExtent1===H[1]?z=$:(V.lastTickCount=l,V.lastAutoInterval=z,V.axisExtent0=H[0],V.axisExtent1=H[1]),z}function eCe(t){var e=t.getLabelModel();return{axisRotate:t.getRotate?t.getRotate():t.isHorizontal&&!t.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}function jQ(t,e,r){var n=Rb(t),i=t.scale,a=i.getExtent(),l=t.getLabelModel(),c=[],o=Math.max((e||0)+1,1),d=a[0],g=i.count();d!==0&&o>1&&g/o>2&&(d=Math.round(Math.ceil(d/o)*o));var m=BQ(t),y=l.get("showMinLabel")||m,x=l.get("showMaxLabel")||m;y&&d!==a[0]&&M(a[0]);for(var A=d;A<=a[1];A+=o)M(A);x&&A-o!==a[1]&&M(a[1]);function M(D){var P={value:D};c.push(r?D:{formattedLabel:n(P),rawLabel:i.getLabel(P),tickValue:D})}return c}function WQ(t,e,r){var n=t.scale,i=Rb(t),a=[];return fe(n.getTicks(),function(l){var c=n.getLabel(l),o=l.value;e(l.value,c)&&a.push(r?o:{formattedLabel:i(l),rawLabel:c,tickValue:o})}),a}var K8=[0,1],Tu=function(){function t(e,r,n){this.onBand=!1,this.inverse=!1,this.dim=e,this.scale=r,this._extent=n||[0,0]}return t.prototype.contain=function(e){var r=this._extent,n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return e>=n&&e<=i},t.prototype.containData=function(e){return this.scale.contain(e)},t.prototype.getExtent=function(){return this._extent.slice()},t.prototype.getPixelPrecision=function(e){return Z2(e||this.scale.getExtent(),this._extent)},t.prototype.setExtent=function(e,r){var n=this._extent;n[0]=e,n[1]=r},t.prototype.dataToCoord=function(e,r){var n=this._extent,i=this.scale;return e=i.normalize(e),this.onBand&&i.type==="ordinal"&&(n=n.slice(),J8(n,i.count())),Ci(e,K8,n,r)},t.prototype.coordToData=function(e,r){var n=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(n=n.slice(),J8(n,i.count()));var a=Ci(e,n,K8,r);return this.scale.scale(a)},t.prototype.pointToData=function(e,r){},t.prototype.getTicksCoords=function(e){e=e||{};var r=e.tickModel||this.getTickModel(),n=qAe(this,r),i=n.ticks,a=Zt(i,function(c){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(c):c),tickValue:c}},this),l=r.get("alignWithLabel");return tCe(this,a,l,e.clamp),a},t.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var e=this.model.getModel("minorTick"),r=e.get("splitNumber");r>0&&r<100||(r=5);var n=this.scale.getMinorTicks(r),i=Zt(n,function(a){return Zt(a,function(l){return{coord:this.dataToCoord(l),tickValue:l}},this)},this);return i},t.prototype.getViewLabels=function(){return ZAe(this).labels},t.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},t.prototype.getTickModel=function(){return this.model.getModel("axisTick")},t.prototype.getBandWidth=function(){var e=this._extent,r=this.scale.getExtent(),n=r[1]-r[0]+(this.onBand?1:0);n===0&&(n=1);var i=Math.abs(e[1]-e[0]);return Math.abs(i)/n},t.prototype.calculateCategoryInterval=function(){return JAe(this)},t}();function J8(t,e){var r=t[1]-t[0],n=e,i=r/n/2;t[0]+=i,t[1]-=i}function tCe(t,e,r,n){var i=e.length;if(!t.onBand||r||!i)return;var a=t.getExtent(),l,c;if(i===1)e[0].coord=a[0],l=e[1]={coord:a[1]};else{var o=e[i-1].tickValue-e[0].tickValue,d=(e[i-1].coord-e[0].coord)/o;fe(e,function(x){x.coord-=d/2});var g=t.scale.getExtent();c=1+g[1]-e[i-1].tickValue,l={coord:e[i-1].coord+d*c},e.push(l)}var m=a[0]>a[1];y(e[0].coord,a[0])&&(n?e[0].coord=a[0]:e.shift()),n&&y(a[0],e[0].coord)&&e.unshift({coord:a[0]}),y(a[1],l.coord)&&(n?l.coord=a[1]:e.pop()),n&&y(l.coord,a[1])&&e.push({coord:a[1]});function y(x,A){return x=ma(x),A=ma(A),m?x>A:x<A}}var Ax=Math.PI*2,ig=pc.CMD,rCe=["top","right","bottom","left"];function nCe(t,e,r,n,i){var a=r.width,l=r.height;switch(t){case"top":n.set(r.x+a/2,r.y-e),i.set(0,-1);break;case"bottom":n.set(r.x+a/2,r.y+l+e),i.set(0,1);break;case"left":n.set(r.x-e,r.y+l/2),i.set(-1,0);break;case"right":n.set(r.x+a+e,r.y+l/2),i.set(1,0);break}}function iCe(t,e,r,n,i,a,l,c,o){l-=t,c-=e;var d=Math.sqrt(l*l+c*c);l/=d,c/=d;var g=l*r+t,m=c*r+e;if(Math.abs(n-i)%Ax<1e-4)return o[0]=g,o[1]=m,d-r;if(a){var y=n;n=Xs(i),i=Xs(y)}else n=Xs(n),i=Xs(i);n>i&&(i+=Ax);var x=Math.atan2(c,l);if(x<0&&(x+=Ax),x>=n&&x<=i||x+Ax>=n&&x+Ax<=i)return o[0]=g,o[1]=m,d-r;var A=r*Math.cos(n)+t,M=r*Math.sin(n)+e,D=r*Math.cos(i)+t,P=r*Math.sin(i)+e,O=(A-l)*(A-l)+(M-c)*(M-c),z=(D-l)*(D-l)+(P-c)*(P-c);return O<z?(o[0]=A,o[1]=M,Math.sqrt(O)):(o[0]=D,o[1]=P,Math.sqrt(z))}function qC(t,e,r,n,i,a,l,c){var o=i-t,d=a-e,g=r-t,m=n-e,y=Math.sqrt(g*g+m*m);g/=y,m/=y;var x=o*g+d*m,A=x/y;c&&(A=Math.min(Math.max(A,0),1)),A*=y;var M=l[0]=t+A*g,D=l[1]=e+A*m;return Math.sqrt((M-i)*(M-i)+(D-a)*(D-a))}function ZQ(t,e,r,n,i,a,l){r<0&&(t=t+r,r=-r),n<0&&(e=e+n,n=-n);var c=t+r,o=e+n,d=l[0]=Math.min(Math.max(i,t),c),g=l[1]=Math.min(Math.max(a,e),o);return Math.sqrt((d-i)*(d-i)+(g-a)*(g-a))}var cu=[];function aCe(t,e,r){var n=ZQ(e.x,e.y,e.width,e.height,t.x,t.y,cu);return r.set(cu[0],cu[1]),n}function oCe(t,e,r){for(var n=0,i=0,a=0,l=0,c,o,d=1/0,g=e.data,m=t.x,y=t.y,x=0;x<g.length;){var A=g[x++];x===1&&(n=g[x],i=g[x+1],a=n,l=i);var M=d;switch(A){case ig.M:a=g[x++],l=g[x++],n=a,i=l;break;case ig.L:M=qC(n,i,g[x],g[x+1],m,y,cu,!0),n=g[x++],i=g[x++];break;case ig.C:M=E2(n,i,g[x++],g[x++],g[x++],g[x++],g[x],g[x+1],m,y,cu),n=g[x++],i=g[x++];break;case ig.Q:M=P2(n,i,g[x++],g[x++],g[x],g[x+1],m,y,cu),n=g[x++],i=g[x++];break;case ig.A:var D=g[x++],P=g[x++],O=g[x++],z=g[x++],V=g[x++],H=g[x++];x+=1;var $=!!(1-g[x++]);c=Math.cos(V)*O+D,o=Math.sin(V)*z+P,x<=1&&(a=c,l=o);var X=(m-D)*z/O+D;M=iCe(D,P,z,V,V+H,$,X,y,cu),n=Math.cos(V+H)*O+D,i=Math.sin(V+H)*z+P;break;case ig.R:a=n=g[x++],l=i=g[x++];var W=g[x++],Y=g[x++];M=ZQ(a,l,W,Y,m,y,cu);break;case ig.Z:M=qC(n,i,a,l,m,y,cu,!0),n=a,i=l;break}M<d&&(d=M,r.set(cu[0],cu[1]))}return d}var du=new hn,$i=new hn,wa=new hn,rc=new hn,Ku=new hn;function e$(t,e){if(t){var r=t.getTextGuideLine(),n=t.getTextContent();if(n&&r){var i=t.textGuideLineConfig||{},a=[[0,0],[0,0],[0,0]],l=i.candidates||rCe,c=n.getBoundingRect().clone();c.applyTransform(n.getComputedTransform());var o=1/0,d=i.anchor,g=t.getComputedTransform(),m=g&&ay([],g),y=e.get("length2")||0;d&&wa.copy(d);for(var x=0;x<l.length;x++){var A=l[x];nCe(A,0,c,du,rc),hn.scaleAndAdd($i,du,rc,y),$i.transform(m);var M=t.getBoundingRect(),D=d?d.distance($i):t instanceof kn?oCe($i,t.path,wa):aCe($i,M,wa);D<o&&(o=D,$i.transform(g),wa.transform(g),wa.toArray(a[0]),$i.toArray(a[1]),du.toArray(a[2]))}qQ(a,e.get("minTurnAngle")),r.setShape({points:a})}}}var YC=[],Jo=new hn;function qQ(t,e){if(e<=180&&e>0){e=e/180*Math.PI,du.fromArray(t[0]),$i.fromArray(t[1]),wa.fromArray(t[2]),hn.sub(rc,du,$i),hn.sub(Ku,wa,$i);var r=rc.len(),n=Ku.len();if(!(r<.001||n<.001)){rc.scale(1/r),Ku.scale(1/n);var i=rc.dot(Ku),a=Math.cos(e);if(a<i){var l=qC($i.x,$i.y,wa.x,wa.y,du.x,du.y,YC,!1);Jo.fromArray(YC),Jo.scaleAndAdd(Ku,l/Math.tan(Math.PI-e));var c=wa.x!==$i.x?(Jo.x-$i.x)/(wa.x-$i.x):(Jo.y-$i.y)/(wa.y-$i.y);if(isNaN(c))return;c<0?hn.copy(Jo,$i):c>1&&hn.copy(Jo,wa),Jo.toArray(t[1])}}}}function sCe(t,e,r){if(r<=180&&r>0){r=r/180*Math.PI,du.fromArray(t[0]),$i.fromArray(t[1]),wa.fromArray(t[2]),hn.sub(rc,$i,du),hn.sub(Ku,wa,$i);var n=rc.len(),i=Ku.len();if(!(n<.001||i<.001)){rc.scale(1/n),Ku.scale(1/i);var a=rc.dot(e),l=Math.cos(r);if(a<l){var c=qC($i.x,$i.y,wa.x,wa.y,du.x,du.y,YC,!1);Jo.fromArray(YC);var o=Math.PI/2,d=Math.acos(Ku.dot(e)),g=o+d-r;if(g>=o)hn.copy(Jo,wa);else{Jo.scaleAndAdd(Ku,c/Math.tan(Math.PI/2-g));var m=wa.x!==$i.x?(Jo.x-$i.x)/(wa.x-$i.x):(Jo.y-$i.y)/(wa.y-$i.y);if(isNaN(m))return;m<0?hn.copy(Jo,$i):m>1&&hn.copy(Jo,wa)}Jo.toArray(t[1])}}}}function mL(t,e,r,n){var i=r==="normal",a=i?t:t.ensureState(r);a.ignore=e;var l=n.get("smooth");l&&l===!0&&(l=.3),a.shape=a.shape||{},l>0&&(a.shape.smooth=l);var c=n.getModel("lineStyle").getLineStyle();i?t.useStyle(c):a.style=c}function lCe(t,e){var r=e.smooth,n=e.points;if(n)if(t.moveTo(n[0][0],n[0][1]),r>0&&n.length>=3){var i=Yf(n[0],n[1]),a=Yf(n[1],n[2]);if(!i||!a){t.lineTo(n[1][0],n[1][1]),t.lineTo(n[2][0],n[2][1]);return}var l=Math.min(i,a)*r,c=BA([],n[1],n[0],l/i),o=BA([],n[1],n[2],l/a),d=BA([],c,o,.5);t.bezierCurveTo(c[0],c[1],c[0],c[1],d[0],d[1]),t.bezierCurveTo(o[0],o[1],o[0],o[1],n[2][0],n[2][1])}else for(var g=1;g<n.length;g++)t.lineTo(n[g][0],n[g][1])}function bB(t,e,r){var n=t.getTextGuideLine(),i=t.getTextContent();if(!i){n&&t.removeTextGuideLine();return}for(var a=e.normal,l=a.get("show"),c=i.ignore,o=0;o<H1.length;o++){var d=H1[o],g=e[d],m=d==="normal";if(g){var y=g.get("show"),x=m?c:tn(i.states[d]&&i.states[d].ignore,c);if(x||!tn(y,l)){var A=m?n:n&&n.states[d];A&&(A.ignore=!0),n&&mL(n,!0,d,g);continue}n||(n=new ls,t.setTextGuideLine(n),!m&&(c||!l)&&mL(n,!0,"normal",e.normal),t.stateProxy&&(n.stateProxy=t.stateProxy)),mL(n,!1,d,g)}}if(n){Fr(n.style,r),n.style.fill=null;var M=a.get("showAbove"),D=t.textGuideLineConfig=t.textGuideLineConfig||{};D.showAbove=M||!1,n.buildPath=lCe}}function wB(t,e){e=e||"labelLine";for(var r={normal:t.getModel(e)},n=0;n<is.length;n++){var i=is[n];r[i]=t.getModel([i,e])}return r}function YQ(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];if(!n.defaultAttr.ignore){var i=n.label,a=i.getComputedTransform(),l=i.getBoundingRect(),c=!a||a[1]<1e-5&&a[2]<1e-5,o=i.style.margin||0,d=l.clone();d.applyTransform(a),d.x-=o/2,d.y-=o/2,d.width+=o,d.height+=o;var g=c?new RC(l,a):null;e.push({label:i,labelLine:n.labelLine,rect:d,localRect:l,obb:g,priority:n.priority,defaultAttr:n.defaultAttr,layoutOption:n.computedLayoutOption,axisAligned:c,transform:a})}}return e}function XQ(t,e,r,n,i,a){var l=t.length;if(l<2)return;t.sort(function(W,Y){return W.rect[e]-Y.rect[e]});for(var c=0,o,d=!1,g=0,m=0;m<l;m++){var y=t[m],x=y.rect;o=x[e]-c,o<0&&(x[e]-=o,y.label[e]-=o,d=!0);var A=Math.max(-o,0);g+=A,c=x[e]+x[r]}g>0&&a&&H(-g/l,0,l);var M=t[0],D=t[l-1],P,O;z(),P<0&&$(-P,.8),O<0&&$(O,.8),z(),V(P,O,1),V(O,P,-1),z(),P<0&&X(-P),O<0&&X(O);function z(){P=M.rect[e]-n,O=i-D.rect[e]-D.rect[r]}function V(W,Y,J){if(W<0){var re=Math.min(Y,-W);if(re>0){H(re*J,0,l);var ae=re+W;ae<0&&$(-ae*J,1)}else $(-W*J,1)}}function H(W,Y,J){W!==0&&(d=!0);for(var re=Y;re<J;re++){var ae=t[re],pe=ae.rect;pe[e]+=W,ae.label[e]+=W}}function $(W,Y){for(var J=[],re=0,ae=1;ae<l;ae++){var pe=t[ae-1].rect,de=Math.max(t[ae].rect[e]-pe[e]-pe[r],0);J.push(de),re+=de}if(re){var ve=Math.min(Math.abs(W)/re,Y);if(W>0)for(var ae=0;ae<l-1;ae++){var me=J[ae]*ve;H(me,0,ae+1)}else for(var ae=l-1;ae>0;ae--){var me=J[ae-1]*ve;H(-me,ae,l)}}}function X(W){var Y=W<0?-1:1;W=Math.abs(W);for(var J=Math.ceil(W/(l-1)),re=0;re<l-1;re++)if(Y>0?H(J,0,re+1):H(-J,l-re-1,l),W-=J,W<=0)return}return d}function uCe(t,e,r,n){return XQ(t,"x","width",e,r,n)}function QQ(t,e,r,n){return XQ(t,"y","height",e,r,n)}function KQ(t){var e=[];t.sort(function(M,D){return D.priority-M.priority});var r=new gn(0,0,0,0);function n(M){if(!M.ignore){var D=M.ensureState("emphasis");D.ignore==null&&(D.ignore=!1)}M.ignore=!0}for(var i=0;i<t.length;i++){var a=t[i],l=a.axisAligned,c=a.localRect,o=a.transform,d=a.label,g=a.labelLine;r.copy(a.rect),r.width-=.1,r.height-=.1,r.x+=.05,r.y+=.05;for(var m=a.obb,y=!1,x=0;x<e.length;x++){var A=e[x];if(r.intersect(A.rect)){if(l&&A.axisAligned){y=!0;break}if(A.obb||(A.obb=new RC(A.localRect,A.transform)),m||(m=new RC(c,o)),m.intersect(A.obb)){y=!0;break}}}y?(n(d),g&&n(g)):(d.attr("ignore",a.defaultAttr.ignore),g&&g.attr("ignore",a.defaultAttr.labelGuideIgnore),e.push(a))}}function cCe(t){if(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r].slice());return e}}function hCe(t,e){var r=t.label,n=e&&e.getTextGuideLine();return{dataIndex:t.dataIndex,dataType:t.dataType,seriesIndex:t.seriesModel.seriesIndex,text:t.label.style.text,rect:t.hostRect,labelRect:t.rect,align:r.style.align,verticalAlign:r.style.verticalAlign,labelLinePoints:cCe(n&&n.shape.points)}}var t$=["align","verticalAlign","width","height","fontSize"],qo=new th,_L=ri(),fCe=ri();function XT(t,e,r){for(var n=0;n<r.length;n++){var i=r[n];e[i]!=null&&(t[i]=e[i])}}var QT=["x","y","rotation"],dCe=function(){function t(){this._labelList=[],this._chartViewList=[]}return t.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},t.prototype._addLabel=function(e,r,n,i,a){var l=i.style,c=i.__hostTarget,o=c.textConfig||{},d=i.getComputedTransform(),g=i.getBoundingRect().plain();gn.applyTransform(g,g,d),d?qo.setLocalTransform(d):(qo.x=qo.y=qo.rotation=qo.originX=qo.originY=0,qo.scaleX=qo.scaleY=1),qo.rotation=Xs(qo.rotation);var m=i.__hostTarget,y;if(m){y=m.getBoundingRect().plain();var x=m.getComputedTransform();gn.applyTransform(y,y,x)}var A=y&&m.getTextGuideLine();this._labelList.push({label:i,labelLine:A,seriesModel:n,dataIndex:e,dataType:r,layoutOption:a,computedLayoutOption:null,rect:g,hostRect:y,priority:y?y.width*y.height:0,defaultAttr:{ignore:i.ignore,labelGuideIgnore:A&&A.ignore,x:qo.x,y:qo.y,scaleX:qo.scaleX,scaleY:qo.scaleY,rotation:qo.rotation,style:{x:l.x,y:l.y,align:l.align,verticalAlign:l.verticalAlign,width:l.width,height:l.height,fontSize:l.fontSize},cursor:i.cursor,attachedPos:o.position,attachedRot:o.rotation}})},t.prototype.addLabelsOfSeries=function(e){var r=this;this._chartViewList.push(e);var n=e.__model,i=n.get("labelLayout");(zr(i)||Hn(i).length)&&e.group.traverse(function(a){if(a.ignore)return!0;var l=a.getTextContent(),c=Yr(a);l&&!l.disableLabelLayout&&r._addLabel(c.dataIndex,c.dataType,n,l,i)})},t.prototype.updateLayoutConfig=function(e){var r=e.getWidth(),n=e.getHeight();function i(z,V){return function(){e$(z,V)}}for(var a=0;a<this._labelList.length;a++){var l=this._labelList[a],c=l.label,o=c.__hostTarget,d=l.defaultAttr,g=void 0;zr(l.layoutOption)?g=l.layoutOption(hCe(l,o)):g=l.layoutOption,g=g||{},l.computedLayoutOption=g;var m=Math.PI/180;o&&o.setTextConfig({local:!1,position:g.x!=null||g.y!=null?null:d.attachedPos,rotation:g.rotate!=null?g.rotate*m:d.attachedRot,offset:[g.dx||0,g.dy||0]});var y=!1;if(g.x!=null?(c.x=dr(g.x,r),c.setStyle("x",0),y=!0):(c.x=d.x,c.setStyle("x",d.style.x)),g.y!=null?(c.y=dr(g.y,n),c.setStyle("y",0),y=!0):(c.y=d.y,c.setStyle("y",d.style.y)),g.labelLinePoints){var x=o.getTextGuideLine();x&&(x.setShape({points:g.labelLinePoints}),y=!1)}var A=_L(c);A.needsUpdateLabelLine=y,c.rotation=g.rotate!=null?g.rotate*m:d.rotation,c.scaleX=d.scaleX,c.scaleY=d.scaleY;for(var M=0;M<t$.length;M++){var D=t$[M];c.setStyle(D,g[D]!=null?g[D]:d.style[D])}if(g.draggable){if(c.draggable=!0,c.cursor="move",o){var P=l.seriesModel;if(l.dataIndex!=null){var O=l.seriesModel.getData(l.dataType);P=O.getItemModel(l.dataIndex)}c.on("drag",i(o,P.getModel("labelLine")))}}else c.off("drag"),c.cursor=d.cursor}},t.prototype.layout=function(e){var r=e.getWidth(),n=e.getHeight(),i=YQ(this._labelList),a=Ei(i,function(o){return o.layoutOption.moveOverlap==="shiftX"}),l=Ei(i,function(o){return o.layoutOption.moveOverlap==="shiftY"});uCe(a,0,r),QQ(l,0,n);var c=Ei(i,function(o){return o.layoutOption.hideOverlap});KQ(c)},t.prototype.processLabelsOverall=function(){var e=this;fe(this._chartViewList,function(r){var n=r.__model,i=r.ignoreLabelLineUpdate,a=n.isAnimationEnabled();r.group.traverse(function(l){if(l.ignore&&!l.forceLabelAnimation)return!0;var c=!i,o=l.getTextContent();!c&&o&&(c=_L(o).needsUpdateLabelLine),c&&e._updateLabelLine(l,n),a&&e._animateLabels(l,n)})})},t.prototype._updateLabelLine=function(e,r){var n=e.getTextContent(),i=Yr(e),a=i.dataIndex;if(n&&a!=null){var l=r.getData(i.dataType),c=l.getItemModel(a),o={},d=l.getItemVisual(a,"style");if(d){var g=l.getVisual("drawType");o.stroke=d[g]}var m=c.getModel("labelLine");bB(e,wB(c),o),e$(e,m)}},t.prototype._animateLabels=function(e,r){var n=e.getTextContent(),i=e.getTextGuideLine();if(n&&(e.forceLabelAnimation||!n.ignore&&!n.invisible&&!e.disableLabelAnimation&&!A_(e))){var a=_L(n),l=a.oldLayout,c=Yr(e),o=c.dataIndex,d={x:n.x,y:n.y,rotation:n.rotation},g=r.getData(c.dataType);if(l){n.attr(l);var y=e.prevStates;y&&(An(y,"select")>=0&&n.attr(a.oldLayoutSelect),An(y,"emphasis")>=0&&n.attr(a.oldLayoutEmphasis)),li(n,d,r,o)}else if(n.attr(d),!cy(n).valueAnimation){var m=tn(n.style.opacity,1);n.style.opacity=0,Qi(n,{style:{opacity:m}},r,o)}if(a.oldLayout=d,n.states.select){var x=a.oldLayoutSelect={};XT(x,d,QT),XT(x,n.states.select,QT)}if(n.states.emphasis){var A=a.oldLayoutEmphasis={};XT(A,d,QT),XT(A,n.states.emphasis,QT)}HY(n,o,g,r,r)}if(i&&!i.ignore&&!i.invisible){var a=fCe(i),l=a.oldLayout,M={points:i.shape.points};l?(i.attr({shape:l}),li(i,{shape:M},r)):(i.setShape(M),i.style.strokePercent=0,Qi(i,{style:{strokePercent:1}},r)),a.oldLayout=M}},t}(),yL=ri();function pCe(t){t.registerUpdateLifecycle("series:beforeupdate",function(e,r,n){var i=yL(r).labelManager;i||(i=yL(r).labelManager=new dCe),i.clearLabels()}),t.registerUpdateLifecycle("series:layoutlabels",function(e,r,n){var i=yL(r).labelManager;n.updatedSeries.forEach(function(a){i.addLabelsOfSeries(r.getViewOfSeriesModel(a))}),i.updateLayoutConfig(r),i.layout(r),i.processLabelsOverall()})}var xL=Math.sin,bL=Math.cos,JQ=Math.PI,ag=Math.PI*2,gCe=180/JQ,eK=function(){function t(){}return t.prototype.reset=function(e){this._start=!0,this._d=[],this._str="",this._p=Math.pow(10,e||4)},t.prototype.moveTo=function(e,r){this._add("M",e,r)},t.prototype.lineTo=function(e,r){this._add("L",e,r)},t.prototype.bezierCurveTo=function(e,r,n,i,a,l){this._add("C",e,r,n,i,a,l)},t.prototype.quadraticCurveTo=function(e,r,n,i){this._add("Q",e,r,n,i)},t.prototype.arc=function(e,r,n,i,a,l){this.ellipse(e,r,n,n,0,i,a,l)},t.prototype.ellipse=function(e,r,n,i,a,l,c,o){var d=c-l,g=!o,m=Math.abs(d),y=ed(m-ag)||(g?d>=ag:-d>=ag),x=d>0?d%ag:d%ag+ag,A=!1;y?A=!0:ed(m)?A=!1:A=x>=JQ==!!g;var M=e+n*bL(l),D=r+i*xL(l);this._start&&this._add("M",M,D);var P=Math.round(a*gCe);if(y){var O=1/this._p,z=(g?1:-1)*(ag-O);this._add("A",n,i,P,1,+g,e+n*bL(l+z),r+i*xL(l+z)),O>.01&&this._add("A",n,i,P,0,+g,M,D)}else{var V=e+n*bL(c),H=r+i*xL(c);this._add("A",n,i,P,+A,+g,V,H)}},t.prototype.rect=function(e,r,n,i){this._add("M",e,r),this._add("l",n,0),this._add("l",0,i),this._add("l",-n,0),this._add("Z")},t.prototype.closePath=function(){this._d.length>0&&this._add("Z")},t.prototype._add=function(e,r,n,i,a,l,c,o,d){for(var g=[],m=this._p,y=1;y<arguments.length;y++){var x=arguments[y];if(isNaN(x)){this._invalid=!0;return}g.push(Math.round(x*m)/m)}this._d.push(e+g.join(" ")),this._start=e==="Z"},t.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(""),this._d=[]},t.prototype.getStr=function(){return this._str},t}(),SB="none",vCe=Math.round;function mCe(t){var e=t.fill;return e!=null&&e!==SB}function _Ce(t){var e=t.stroke;return e!=null&&e!==SB}var mO=["lineCap","miterLimit","lineJoin"],yCe=Zt(mO,function(t){return"stroke-"+t.toLowerCase()});function xCe(t,e,r,n){var i=e.opacity==null?1:e.opacity;if(r instanceof fo){t("opacity",i);return}if(mCe(e)){var a=G1(e.fill);t("fill",a.color);var l=e.fillOpacity!=null?e.fillOpacity*a.opacity*i:a.opacity*i;l<1&&t("fill-opacity",l)}else t("fill",SB);if(_Ce(e)){var c=G1(e.stroke);t("stroke",c.color);var o=e.strokeNoScale?r.getLineScale():1,d=o?(e.lineWidth||0)/o:0,g=e.strokeOpacity!=null?e.strokeOpacity*c.opacity*i:c.opacity*i,m=e.strokeFirst;if(d!==1&&t("stroke-width",d),m&&t("paint-order",m?"stroke":"fill"),g<1&&t("stroke-opacity",g),e.lineDash){var y=uB(r),x=y[0],A=y[1];x&&(A=vCe(A||0),t("stroke-dasharray",x.join(",")),(A||n)&&t("stroke-dashoffset",A))}for(var M=0;M<mO.length;M++){var D=mO[M];if(e[D]!==PC[D]){var P=e[D]||PC[D];P&&t(yCe[M],P)}}}}var tK="http://www.w3.org/2000/svg",rK="http://www.w3.org/1999/xlink",bCe="http://www.w3.org/2000/xmlns/",wCe="http://www.w3.org/XML/1998/namespace",r$="ecmeta_";function nK(t){return document.createElementNS(tK,t)}function Ja(t,e,r,n,i){return{tag:t,attrs:r||{},children:n,text:i,key:e}}function SCe(t,e){var r=[];if(e)for(var n in e){var i=e[n],a=n;i!==!1&&(i!==!0&&i!=null&&(a+='="'+i+'"'),r.push(a))}return"<"+t+" "+r.join(" ")+">"}function TCe(t){return"</"+t+">"}function TB(t,e){e=e||{};var r=e.newline?`
`:"";function n(i){var a=i.children,l=i.tag,c=i.attrs,o=i.text;return SCe(l,c)+(l!=="style"?qs(o):o||"")+(a?""+r+Zt(a,function(d){return n(d)}).join(r)+r:"")+TCe(l)}return n(t)}function ACe(t,e,r){r=r||{};var n=r.newline?`
`:"",i=" {"+n,a=n+"}",l=Zt(Hn(t),function(o){return o+i+Zt(Hn(t[o]),function(d){return d+":"+t[o][d]+";"}).join(n)+a}).join(n),c=Zt(Hn(e),function(o){return"@keyframes "+o+i+Zt(Hn(e[o]),function(d){return d+i+Zt(Hn(e[o][d]),function(g){var m=e[o][d][g];return g==="d"&&(m='path("'+m+'")'),g+":"+m+";"}).join(n)+a}).join(n)+a}).join(n);return!l&&!c?"":["<![CDATA[",l,c,"]]>"].join(n)}function _O(t){return{zrId:t,shadowCache:{},patternCache:{},gradientCache:{},clipPathCache:{},defs:{},cssNodes:{},cssAnims:{},cssStyleCache:{},cssAnimIdx:0,shadowIdx:0,gradientIdx:0,patternIdx:0,clipPathIdx:0}}function n$(t,e,r,n){return Ja("svg","root",{width:t,height:e,xmlns:tK,"xmlns:xlink":rK,version:"1.1",baseProfile:"full",viewBox:n?"0 0 "+t+" "+e:!1},r)}var CCe=0;function iK(){return CCe++}var i$={cubicIn:"0.32,0,0.67,0",cubicOut:"0.33,1,0.68,1",cubicInOut:"0.65,0,0.35,1",quadraticIn:"0.11,0,0.5,0",quadraticOut:"0.5,1,0.89,1",quadraticInOut:"0.45,0,0.55,1",quarticIn:"0.5,0,0.75,0",quarticOut:"0.25,1,0.5,1",quarticInOut:"0.76,0,0.24,1",quinticIn:"0.64,0,0.78,0",quinticOut:"0.22,1,0.36,1",quinticInOut:"0.83,0,0.17,1",sinusoidalIn:"0.12,0,0.39,0",sinusoidalOut:"0.61,1,0.88,1",sinusoidalInOut:"0.37,0,0.63,1",exponentialIn:"0.7,0,0.84,0",exponentialOut:"0.16,1,0.3,1",exponentialInOut:"0.87,0,0.13,1",circularIn:"0.55,0,1,0.45",circularOut:"0,0.55,0.45,1",circularInOut:"0.85,0,0.15,1"},lg="transform-origin";function MCe(t,e,r){var n=Lt({},t.shape);Lt(n,e),t.buildPath(r,n);var i=new eK;return i.reset(F2(t)),r.rebuildPath(i,1),i.generateStr(),i.getStr()}function ICe(t,e){var r=e.originX,n=e.originY;(r||n)&&(t[lg]=r+"px "+n+"px")}var ECe={fill:"fill",opacity:"opacity",lineWidth:"stroke-width",lineDashOffset:"stroke-dashoffset"};function aK(t,e){var r=e.zrId+"-ani-"+e.cssAnimIdx++;return e.cssAnims[r]=t,r}function DCe(t,e,r){var n=t.shape.paths,i={},a,l;if(fe(n,function(o){var d=_O(r.zrId);d.animation=!0,EI(o,{},d,!0);var g=d.cssAnims,m=d.cssNodes,y=Hn(g),x=y.length;if(x){l=y[x-1];var A=g[l];for(var M in A){var D=A[M];i[M]=i[M]||{d:""},i[M].d+=D.d||""}for(var P in m){var O=m[P].animation;O.indexOf(l)>=0&&(a=O)}}}),!!a){e.d=!1;var c=aK(i,r);return a.replace(l,c)}}function a$(t){return yr(t)?i$[t]?"cubic-bezier("+i$[t]+")":Cz(t)?t:"":""}function EI(t,e,r,n){var i=t.animators,a=i.length,l=[];if(t instanceof Uz){var c=DCe(t,e,r);if(c)l.push(c);else if(!a)return}else if(!a)return;for(var o={},d=0;d<a;d++){var g=i[d],m=[g.getMaxTime()/1e3+"s"],y=a$(g.getClip().easing),x=g.getDelay();y?m.push(y):m.push("linear"),x&&m.push(x/1e3+"s"),g.getLoop()&&m.push("infinite");var A=m.join(" ");o[A]=o[A]||[A,[]],o[A][1].push(g)}function M(O){var z=O[1],V=z.length,H={},$={},X={},W="animation-timing-function";function Y(lt,qt,Ut){for(var rr=lt.getTracks(),br=lt.getMaxTime(),Oe=0;Oe<rr.length;Oe++){var $e=rr[Oe];if($e.needsAnimate()){var ct=$e.keyframes,bt=$e.propName;if(Ut&&(bt=Ut(bt)),bt)for(var At=0;At<ct.length;At++){var Jt=ct[At],mt=Math.round(Jt.time/br*100)+"%",ht=a$(Jt.easing),er=Jt.rawValue;(yr(er)||ii(er))&&(qt[mt]=qt[mt]||{},qt[mt][bt]=Jt.rawValue,ht&&(qt[mt][W]=ht))}}}}for(var J=0;J<V;J++){var re=z[J],ae=re.targetName;ae?ae==="shape"&&Y(re,$):!n&&Y(re,H)}for(var pe in H){var de={};$2(de,t),Lt(de,H[pe]);var ve=N2(de),me=H[pe][W];X[pe]=ve?{transform:ve}:{},ICe(X[pe],de),me&&(X[pe][W]=me)}var Ie,Le=!0;for(var pe in $){X[pe]=X[pe]||{};var Ee=!Ie,me=$[pe][W];Ee&&(Ie=new pc);var Ue=Ie.len();Ie.reset(),X[pe].d=MCe(t,$[pe],Ie);var Ke=Ie.len();if(!Ee&&Ue!==Ke){Le=!1;break}me&&(X[pe][W]=me)}if(!Le)for(var pe in X)delete X[pe].d;if(!n)for(var J=0;J<V;J++){var re=z[J],ae=re.targetName;ae==="style"&&Y(re,X,function(rr){return ECe[rr]})}for(var We=Hn(X),Rt=!0,Et,J=1;J<We.length;J++){var ar=We[J-1],ur=We[J];if(X[ar][lg]!==X[ur][lg]){Rt=!1;break}Et=X[ar][lg]}if(Rt&&Et){for(var pe in X)X[pe][lg]&&delete X[pe][lg];e[lg]=Et}if(Ei(We,function(lt){return Hn(X[lt]).length>0}).length){var cr=aK(X,r);return cr+" "+O[0]+" both"}}for(var D in o){var c=M(o[D]);c&&l.push(c)}if(l.length){var P=r.zrId+"-cls-"+iK();r.cssNodes["."+P]={animation:l.join(",")},e.class=P}}function PCe(t,e,r){if(!t.ignore)if(t.isSilent()){var n={"pointer-events":"none"};o$(n,e,r)}else{var i=t.states.emphasis&&t.states.emphasis.style?t.states.emphasis.style:{},a=i.fill;if(!a){var l=t.style&&t.style.fill,c=t.states.select&&t.states.select.style&&t.states.select.style.fill,o=t.currentStates.indexOf("select")>=0&&c||l;o&&(a=Dk(o))}var d=i.lineWidth;if(d){var g=!i.strokeNoScale&&t.transform?t.transform[0]:1;d=d/g}var n={cursor:"pointer"};a&&(n.fill=a),i.stroke&&(n.stroke=i.stroke),d&&(n["stroke-width"]=d),o$(n,e,r)}}function o$(t,e,r,n){var i=JSON.stringify(t),a=r.cssStyleCache[i];a||(a=r.zrId+"-cls-"+iK(),r.cssStyleCache[i]=a,r.cssNodes["."+a+":hover"]=t),e.class=e.class?e.class+" "+a:a}var eb=Math.round;function oK(t){return t&&yr(t.src)}function sK(t){return t&&zr(t.toDataURL)}function AB(t,e,r,n){xCe(function(i,a){var l=i==="fill"||i==="stroke";l&&B2(a)?uK(e,t,i,n):l&&Mz(a)?cK(r,t,i,n):l&&a==="none"?t[i]="transparent":t[i]=a},e,r,!1),FCe(r,t,n)}function CB(t,e){var r=Cxe(e);r&&(r.each(function(n,i){n!=null&&(t[(r$+i).toLowerCase()]=n+"")}),e.isSilent()&&(t[r$+"silent"]="true"))}function s$(t){return ed(t[0]-1)&&ed(t[1])&&ed(t[2])&&ed(t[3]-1)}function LCe(t){return ed(t[4])&&ed(t[5])}function MB(t,e,r){if(e&&!(LCe(e)&&s$(e))){var n=1e4;t.transform=s$(e)?"translate("+eb(e[4]*n)/n+" "+eb(e[5]*n)/n+")":Y0e(e)}}function l$(t,e,r){for(var n=t.points,i=[],a=0;a<n.length;a++)i.push(eb(n[a][0]*r)/r),i.push(eb(n[a][1]*r)/r);e.points=i.join(" ")}function u$(t){return!t.smooth}function RCe(t){var e=Zt(t,function(r){return typeof r=="string"?[r,r]:r});return function(r,n,i){for(var a=0;a<e.length;a++){var l=e[a],c=r[l[0]];c!=null&&(n[l[1]]=eb(c*i)/i)}}}var kCe={circle:[RCe(["cx","cy","r"])],polyline:[l$,u$],polygon:[l$,u$]};function OCe(t){for(var e=t.animators,r=0;r<e.length;r++)if(e[r].targetName==="shape")return!0;return!1}function lK(t,e){var r=t.style,n=t.shape,i=kCe[t.type],a={},l=e.animation,c="path",o=t.style.strokePercent,d=e.compress&&F2(t)||4;if(i&&!e.willUpdate&&!(i[1]&&!i[1](n))&&!(l&&OCe(t))&&!(o<1)){c=t.type;var g=Math.pow(10,d);i[0](n,a,g)}else{var m=!t.path||t.shapeChanged();t.path||t.createPathProxy();var y=t.path;m&&(y.beginPath(),t.buildPath(y,t.shape),t.pathUpdated());var x=y.getVersion(),A=t,M=A.__svgPathBuilder;(A.__svgPathVersion!==x||!M||o!==A.__svgPathStrokePercent)&&(M||(M=A.__svgPathBuilder=new eK),M.reset(d),y.rebuildPath(M,o),M.generateStr(),A.__svgPathVersion=x,A.__svgPathStrokePercent=o),a.d=M.getStr()}return MB(a,t.transform),AB(a,r,t,e),CB(a,t),e.animation&&EI(t,a,e),e.emphasis&&PCe(t,a,e),Ja(c,t.id+"",a)}function zCe(t,e){var r=t.style,n=r.image;if(n&&!yr(n)&&(oK(n)?n=n.src:sK(n)&&(n=n.toDataURL())),!!n){var i=r.x||0,a=r.y||0,l=r.width,c=r.height,o={href:n,width:l,height:c};return i&&(o.x=i),a&&(o.y=a),MB(o,t.transform),AB(o,r,t,e),CB(o,t),e.animation&&EI(t,o,e),Ja("image",t.id+"",o)}}function BCe(t,e){var r=t.style,n=r.text;if(n!=null&&(n+=""),!(!n||isNaN(r.x)||isNaN(r.y))){var i=r.font||pd,a=r.x||0,l=Q0e(r.y||0,rI(i),r.textBaseline),c=X0e[r.textAlign]||r.textAlign,o={"dominant-baseline":"central","text-anchor":c};if(gY(r)){var d="",g=r.fontStyle,m=pY(r.fontSize);if(!parseFloat(m))return;var y=r.fontFamily||p2,x=r.fontWeight;d+="font-size:"+m+";font-family:"+y+";",g&&g!=="normal"&&(d+="font-style:"+g+";"),x&&x!=="normal"&&(d+="font-weight:"+x+";"),o.style=d}else o.style="font: "+i;return n.match(/\s/)&&(o["xml:space"]="preserve"),a&&(o.x=a),l&&(o.y=l),MB(o,t.transform),AB(o,r,t,e),CB(o,t),e.animation&&EI(t,o,e),Ja("text",t.id+"",o,void 0,n)}}function c$(t,e){if(t instanceof kn)return lK(t,e);if(t instanceof fo)return zCe(t,e);if(t instanceof U_)return BCe(t,e)}function FCe(t,e,r){var n=t.style;if(K0e(n)){var i=J0e(t),a=r.shadowCache,l=a[i];if(!l){var c=t.getGlobalScale(),o=c[0],d=c[1];if(!o||!d)return;var g=n.shadowOffsetX||0,m=n.shadowOffsetY||0,y=n.shadowBlur,x=G1(n.shadowColor),A=x.opacity,M=x.color,D=y/2/o,P=y/2/d,O=D+" "+P;l=r.zrId+"-s"+r.shadowIdx++,r.defs[l]=Ja("filter",l,{id:l,x:"-100%",y:"-100%",width:"300%",height:"300%"},[Ja("feDropShadow","",{dx:g/o,dy:m/d,stdDeviation:O,"flood-color":M,"flood-opacity":A})]),a[i]=l}e.filter=tI(l)}}function uK(t,e,r,n){var i=t[r],a,l={gradientUnits:i.global?"userSpaceOnUse":"objectBoundingBox"};if(O2(i))a="linearGradient",l.x1=i.x,l.y1=i.y,l.x2=i.x2,l.y2=i.y2;else if(z2(i))a="radialGradient",l.cx=tn(i.x,.5),l.cy=tn(i.y,.5),l.r=tn(i.r,.5);else return;for(var c=i.colorStops,o=[],d=0,g=c.length;d<g;++d){var m=Pk(c[d].offset)*100+"%",y=c[d].color,x=G1(y),A=x.color,M=x.opacity,D={offset:m};D["stop-color"]=A,M<1&&(D["stop-opacity"]=M),o.push(Ja("stop",d+"",D))}var P=Ja(a,"",l,o),O=TB(P),z=n.gradientCache,V=z[O];V||(V=n.zrId+"-g"+n.gradientIdx++,z[O]=V,l.id=V,n.defs[V]=Ja(a,V,l,o)),e[r]=tI(V)}function cK(t,e,r,n){var i=t.style[r],a=t.getBoundingRect(),l={},c=i.repeat,o=c==="no-repeat",d=c==="repeat-x",g=c==="repeat-y",m;if(k2(i)){var y=i.imageWidth,x=i.imageHeight,A=void 0,M=i.image;if(yr(M)?A=M:oK(M)?A=M.src:sK(M)&&(A=M.toDataURL()),typeof Image>"u"){var D="Image width/height must been given explictly in svg-ssr renderer.";ns(y,D),ns(x,D)}else if(y==null||x==null){var P=function(J,re){if(J){var ae=J.elm,pe=y||re.width,de=x||re.height;J.tag==="pattern"&&(d?(de=1,pe/=a.width):g&&(pe=1,de/=a.height)),J.attrs.width=pe,J.attrs.height=de,ae&&(ae.setAttribute("width",pe),ae.setAttribute("height",de))}},O=Rz(A,null,t,function(J){o||P($,J),P(m,J)});O&&O.width&&O.height&&(y=y||O.width,x=x||O.height)}m=Ja("image","img",{href:A,width:y,height:x}),l.width=y,l.height=x}else i.svgElement&&(m=$r(i.svgElement),l.width=i.svgWidth,l.height=i.svgHeight);if(m){var z,V;o?z=V=1:d?(V=1,z=l.width/a.width):g?(z=1,V=l.height/a.height):l.patternUnits="userSpaceOnUse",z!=null&&!isNaN(z)&&(l.width=z),V!=null&&!isNaN(V)&&(l.height=V);var H=N2(i);H&&(l.patternTransform=H);var $=Ja("pattern","",l,[m]),X=TB($),W=n.patternCache,Y=W[X];Y||(Y=n.zrId+"-p"+n.patternIdx++,W[X]=Y,l.id=Y,$=n.defs[Y]=Ja("pattern",Y,l,[m])),e[r]=tI(Y)}}function NCe(t,e,r){var n=r.clipPathCache,i=r.defs,a=n[t.id];if(!a){a=r.zrId+"-c"+r.clipPathIdx++;var l={id:a};n[t.id]=a,i[a]=Ja("clipPath",a,l,[lK(t,r)])}e["clip-path"]=tI(a)}function h$(t){return document.createTextNode(t)}function _g(t,e,r){t.insertBefore(e,r)}function f$(t,e){t.removeChild(e)}function d$(t,e){t.appendChild(e)}function hK(t){return t.parentNode}function fK(t){return t.nextSibling}function wL(t,e){t.textContent=e}var p$=58,VCe=120,GCe=Ja("","");function yO(t){return t===void 0}function qu(t){return t!==void 0}function UCe(t,e,r){for(var n={},i=e;i<=r;++i){var a=t[i].key;a!==void 0&&(n[a]=i)}return n}function jx(t,e){var r=t.key===e.key,n=t.tag===e.tag;return n&&r}function tb(t){var e,r=t.children,n=t.tag;if(qu(n)){var i=t.elm=nK(n);if(IB(GCe,t),Ht(r))for(e=0;e<r.length;++e){var a=r[e];a!=null&&d$(i,tb(a))}else qu(t.text)&&!Ur(t.text)&&d$(i,h$(t.text))}else t.elm=h$(t.text);return t.elm}function dK(t,e,r,n,i){for(;n<=i;++n){var a=r[n];a!=null&&_g(t,tb(a),e)}}function XC(t,e,r,n){for(;r<=n;++r){var i=e[r];if(i!=null)if(qu(i.tag)){var a=hK(i.elm);f$(a,i.elm)}else f$(t,i.elm)}}function IB(t,e){var r,n=e.elm,i=t&&t.attrs||{},a=e.attrs||{};if(i!==a){for(r in a){var l=a[r],c=i[r];c!==l&&(l===!0?n.setAttribute(r,""):l===!1?n.removeAttribute(r):r==="style"?n.style.cssText=l:r.charCodeAt(0)!==VCe?n.setAttribute(r,l):r==="xmlns:xlink"||r==="xmlns"?n.setAttributeNS(bCe,r,l):r.charCodeAt(3)===p$?n.setAttributeNS(wCe,r,l):r.charCodeAt(5)===p$?n.setAttributeNS(rK,r,l):n.setAttribute(r,l))}for(r in i)r in a||n.removeAttribute(r)}}function $Ce(t,e,r){for(var n=0,i=0,a=e.length-1,l=e[0],c=e[a],o=r.length-1,d=r[0],g=r[o],m,y,x,A;n<=a&&i<=o;)l==null?l=e[++n]:c==null?c=e[--a]:d==null?d=r[++i]:g==null?g=r[--o]:jx(l,d)?(d_(l,d),l=e[++n],d=r[++i]):jx(c,g)?(d_(c,g),c=e[--a],g=r[--o]):jx(l,g)?(d_(l,g),_g(t,l.elm,fK(c.elm)),l=e[++n],g=r[--o]):jx(c,d)?(d_(c,d),_g(t,c.elm,l.elm),c=e[--a],d=r[++i]):(yO(m)&&(m=UCe(e,n,a)),y=m[d.key],yO(y)?_g(t,tb(d),l.elm):(x=e[y],x.tag!==d.tag?_g(t,tb(d),l.elm):(d_(x,d),e[y]=void 0,_g(t,x.elm,l.elm))),d=r[++i]);(n<=a||i<=o)&&(n>a?(A=r[o+1]==null?null:r[o+1].elm,dK(t,A,r,i,o)):XC(t,e,n,a))}function d_(t,e){var r=e.elm=t.elm,n=t.children,i=e.children;t!==e&&(IB(t,e),yO(e.text)?qu(n)&&qu(i)?n!==i&&$Ce(r,n,i):qu(i)?(qu(t.text)&&wL(r,""),dK(r,null,i,0,i.length-1)):qu(n)?XC(r,n,0,n.length-1):qu(t.text)&&wL(r,""):t.text!==e.text&&(qu(n)&&XC(r,n,0,n.length-1),wL(r,e.text)))}function HCe(t,e){if(jx(t,e))d_(t,e);else{var r=t.elm,n=hK(r);tb(e),n!==null&&(_g(n,e.elm,fK(r)),XC(n,[t],0,0))}return e}var jCe=0,WCe=function(){function t(e,r,n){if(this.type="svg",this.refreshHover=g$(),this.configLayer=g$(),this.storage=r,this._opts=n=Lt({},n),this.root=e,this._id="zr"+jCe++,this._oldVNode=n$(n.width,n.height),e&&!n.ssr){var i=this._viewport=document.createElement("div");i.style.cssText="position:relative;overflow:hidden";var a=this._svgDom=this._oldVNode.elm=nK("svg");IB(null,this._oldVNode),i.appendChild(a),e.appendChild(i)}this.resize(n.width,n.height)}return t.prototype.getType=function(){return this.type},t.prototype.getViewportRoot=function(){return this._viewport},t.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},t.prototype.getSvgDom=function(){return this._svgDom},t.prototype.refresh=function(){if(this.root){var e=this.renderToVNode({willUpdate:!0});e.attrs.style="position:absolute;left:0;top:0;user-select:none",HCe(this._oldVNode,e),this._oldVNode=e}},t.prototype.renderOneToVNode=function(e){return c$(e,_O(this._id))},t.prototype.renderToVNode=function(e){e=e||{};var r=this.storage.getDisplayList(!0),n=this._width,i=this._height,a=_O(this._id);a.animation=e.animation,a.willUpdate=e.willUpdate,a.compress=e.compress,a.emphasis=e.emphasis;var l=[],c=this._bgVNode=ZCe(n,i,this._backgroundColor,a);c&&l.push(c);var o=e.compress?null:this._mainVNode=Ja("g","main",{},[]);this._paintList(r,a,o?o.children:l),o&&l.push(o);var d=Zt(Hn(a.defs),function(y){return a.defs[y]});if(d.length&&l.push(Ja("defs","defs",{},d)),e.animation){var g=ACe(a.cssNodes,a.cssAnims,{newline:!0});if(g){var m=Ja("style","stl",{},[],g);l.push(m)}}return n$(n,i,l,e.useViewBox)},t.prototype.renderToString=function(e){return e=e||{},TB(this.renderToVNode({animation:tn(e.cssAnimation,!0),emphasis:tn(e.cssEmphasis,!0),willUpdate:!1,compress:!0,useViewBox:tn(e.useViewBox,!0)}),{newline:!0})},t.prototype.setBackgroundColor=function(e){this._backgroundColor=e},t.prototype.getSvgRoot=function(){return this._mainVNode&&this._mainVNode.elm},t.prototype._paintList=function(e,r,n){for(var i=e.length,a=[],l=0,c,o,d=0,g=0;g<i;g++){var m=e[g];if(!m.invisible){var y=m.__clipPaths,x=y&&y.length||0,A=o&&o.length||0,M=void 0;for(M=Math.max(x-1,A-1);M>=0&&!(y&&o&&y[M]===o[M]);M--);for(var D=A-1;D>M;D--)l--,c=a[l-1];for(var P=M+1;P<x;P++){var O={};NCe(y[P],O,r);var z=Ja("g","clip-g-"+d++,O,[]);(c?c.children:n).push(z),a[l++]=z,c=z}o=y;var V=c$(m,r);V&&(c?c.children:n).push(V)}}},t.prototype.resize=function(e,r){var n=this._opts,i=this.root,a=this._viewport;if(e!=null&&(n.width=e),r!=null&&(n.height=r),i&&a&&(a.style.display="none",e=__(i,0,n),r=__(i,1,n),a.style.display=""),this._width!==e||this._height!==r){if(this._width=e,this._height=r,a){var l=a.style;l.width=e+"px",l.height=r+"px"}if(Mz(this._backgroundColor))this.refresh();else{var c=this._svgDom;c&&(c.setAttribute("width",e),c.setAttribute("height",r));var o=this._bgVNode&&this._bgVNode.elm;o&&(o.setAttribute("width",e),o.setAttribute("height",r))}}},t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t.prototype.dispose=function(){this.root&&(this.root.innerHTML=""),this._svgDom=this._viewport=this.storage=this._oldVNode=this._bgVNode=this._mainVNode=null},t.prototype.clear=function(){this._svgDom&&(this._svgDom.innerHTML=null),this._oldVNode=null},t.prototype.toDataURL=function(e){var r=this.renderToString(),n="data:image/svg+xml;";return e?(r=txe(r),r&&n+"base64,"+r):n+"charset=UTF-8,"+encodeURIComponent(r)},t}();function g$(t){return function(){}}function ZCe(t,e,r,n){var i;if(r&&r!=="none")if(i=Ja("rect","bg",{width:t,height:e,x:"0",y:"0"}),B2(r))uK({fill:r},i.attrs,"fill",n);else if(Mz(r))cK({style:{fill:r},dirty:Sa,getBoundingRect:function(){return{width:t,height:e}}},i.attrs,"fill",n);else{var a=G1(r),l=a.color,c=a.opacity;i.attrs.fill=l,c<1&&(i.attrs["fill-opacity"]=c)}return i}function qCe(t){t.registerPainter("svg",WCe)}function v$(t,e,r){var n=gd.createCanvas(),i=e.getWidth(),a=e.getHeight(),l=n.style;return l&&(l.position="absolute",l.left="0",l.top="0",l.width=i+"px",l.height=a+"px",n.setAttribute("data-zr-dom-id",t)),n.width=i*r,n.height=a*r,n}var SL=function(t){et(e,t);function e(r,n,i){var a=t.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var l;i=i||EC,typeof r=="string"?l=v$(r,n,i):Ur(r)&&(l=r,r=l.id),a.id=r,a.dom=l;var c=l.style;return c&&(x2(l),l.onselectstart=function(){return!1},c.padding="0",c.margin="0",c.borderWidth="0"),a.painter=n,a.dpr=i,a}return e.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},e.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},e.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},e.prototype.setUnpainted=function(){this.__firstTimePaint=!0},e.prototype.createBackBuffer=function(){var r=this.dpr;this.domBack=v$("back-"+this.id,this.painter,r),this.ctxBack=this.domBack.getContext("2d"),r!==1&&this.ctxBack.scale(r,r)},e.prototype.createRepaintRects=function(r,n,i,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var l=[],c=this.maxRepaintRectCount,o=!1,d=new gn(0,0,0,0);function g(O){if(!(!O.isFinite()||O.isZero()))if(l.length===0){var z=new gn(0,0,0,0);z.copy(O),l.push(z)}else{for(var V=!1,H=1/0,$=0,X=0;X<l.length;++X){var W=l[X];if(W.intersect(O)){var Y=new gn(0,0,0,0);Y.copy(W),Y.union(O),l[X]=Y,V=!0;break}else if(o){d.copy(O),d.union(W);var J=O.width*O.height,re=W.width*W.height,ae=d.width*d.height,pe=ae-J-re;pe<H&&(H=pe,$=X)}}if(o&&(l[$].union(O),V=!0),!V){var z=new gn(0,0,0,0);z.copy(O),l.push(z)}o||(o=l.length>=c)}}for(var m=this.__startIndex;m<this.__endIndex;++m){var y=r[m];if(y){var x=y.shouldBePainted(i,a,!0,!0),A=y.__isRendered&&(y.__dirty&Ys||!x)?y.getPrevPaintRect():null;A&&g(A);var M=x&&(y.__dirty&Ys||!y.__isRendered)?y.getPaintRect():null;M&&g(M)}}for(var m=this.__prevStartIndex;m<this.__prevEndIndex;++m){var y=n[m],x=y&&y.shouldBePainted(i,a,!0,!0);if(y&&(!x||!y.__zr)&&y.__isRendered){var A=y.getPrevPaintRect();A&&g(A)}}var D;do{D=!1;for(var m=0;m<l.length;){if(l[m].isZero()){l.splice(m,1);continue}for(var P=m+1;P<l.length;)l[m].intersect(l[P])?(D=!0,l[m].union(l[P]),l.splice(P,1)):P++;m++}}while(D);return this._paintRects=l,l},e.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},e.prototype.resize=function(r,n){var i=this.dpr,a=this.dom,l=a.style,c=this.domBack;l&&(l.width=r+"px",l.height=n+"px"),a.width=r*i,a.height=n*i,c&&(c.width=r*i,c.height=n*i,i!==1&&this.ctxBack.scale(i,i))},e.prototype.clear=function(r,n,i){var a=this.dom,l=this.ctx,c=a.width,o=a.height;n=n||this.clearColor;var d=this.motionBlur&&!r,g=this.lastFrameAlpha,m=this.dpr,y=this;d&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,c/m,o/m));var x=this.domBack;function A(M,D,P,O){if(l.clearRect(M,D,P,O),n&&n!=="transparent"){var z=void 0;if(KM(n)){var V=n.global||n.__width===P&&n.__height===O;z=V&&n.__canvasGradient||uO(l,n,{x:0,y:0,width:P,height:O}),n.__canvasGradient=z,n.__width=P,n.__height=O}else u0e(n)&&(n.scaleX=n.scaleX||m,n.scaleY=n.scaleY||m,z=cO(l,n,{dirty:function(){y.setUnpainted(),y.painter.refresh()}}));l.save(),l.fillStyle=z||n,l.fillRect(M,D,P,O),l.restore()}d&&(l.save(),l.globalAlpha=g,l.drawImage(x,M,D,P,O),l.restore())}!i||d?A(0,0,c,o):i.length&&fe(i,function(M){A(M.x*m,M.y*m,M.width*m,M.height*m)})},e}(Fl),m$=1e5,og=314159,KT=.01,YCe=.001;function XCe(t){return t?t.__builtin__?!0:!(typeof t.resize!="function"||typeof t.refresh!="function"):!1}function QCe(t,e){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var KCe=function(){function t(e,r,n,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!e.nodeName||e.nodeName.toUpperCase()==="CANVAS";this._opts=n=Lt({},n||{}),this.dpr=n.devicePixelRatio||EC,this._singleCanvas=a,this.root=e;var l=e.style;l&&(x2(e),e.innerHTML=""),this.storage=r;var c=this._zlevelList;this._prevDisplayList=[];var o=this._layers;if(a){var g=e,m=g.width,y=g.height;n.width!=null&&(m=n.width),n.height!=null&&(y=n.height),this.dpr=n.devicePixelRatio||1,g.width=m*this.dpr,g.height=y*this.dpr,this._width=m,this._height=y;var x=new SL(g,this,this.dpr);x.__builtin__=!0,x.initContext(),o[og]=x,x.zlevel=og,c.push(og),this._domRoot=e}else{this._width=__(e,0,n),this._height=__(e,1,n);var d=this._domRoot=QCe(this._width,this._height);e.appendChild(d)}}return t.prototype.getType=function(){return"canvas"},t.prototype.isSingleCanvas=function(){return this._singleCanvas},t.prototype.getViewportRoot=function(){return this._domRoot},t.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},t.prototype.refresh=function(e){var r=this.storage.getDisplayList(!0),n=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(r,n,e,this._redrawId);for(var a=0;a<i.length;a++){var l=i[a],c=this._layers[l];if(!c.__builtin__&&c.refresh){var o=a===0?this._backgroundColor:null;c.refresh(o)}}return this._opts.useDirtyRect&&(this._prevDisplayList=r.slice()),this},t.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},t.prototype._paintHoverList=function(e){var r=e.length,n=this._hoverlayer;if(n&&n.clear(),!!r){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,l=0;l<r;l++){var c=e[l];c.__inHover&&(n||(n=this._hoverlayer=this.getLayer(m$)),a||(a=n.ctx,a.save()),Dg(a,c,i,l===r-1))}a&&a.restore()}},t.prototype.getHoverLayer=function(){return this.getLayer(m$)},t.prototype.paintOne=function(e,r){KX(e,r)},t.prototype._paintList=function(e,r,n,i){if(this._redrawId===i){n=n||!1,this._updateLayerStatus(e);var a=this._doPaintList(e,r,n),l=a.finished,c=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),c&&this._paintHoverList(e),l)this.eachLayer(function(d){d.afterBrush&&d.afterBrush()});else{var o=this;SC(function(){o._paintList(e,r,n,i)})}}},t.prototype._compositeManually=function(){var e=this.getLayer(og).ctx,r=this._domRoot.width,n=this._domRoot.height;e.clearRect(0,0,r,n),this.eachBuiltinLayer(function(i){i.virtual&&e.drawImage(i.dom,0,0,r,n)})},t.prototype._doPaintList=function(e,r,n){for(var i=this,a=[],l=this._opts.useDirtyRect,c=0;c<this._zlevelList.length;c++){var o=this._zlevelList[c],d=this._layers[o];d.__builtin__&&d!==this._hoverlayer&&(d.__dirty||n)&&a.push(d)}for(var g=!0,m=!1,y=function(M){var D=a[M],P=D.ctx,O=l&&D.createRepaintRects(e,r,x._width,x._height),z=n?D.__startIndex:D.__drawIndex,V=!n&&D.incremental&&Date.now,H=V&&Date.now(),$=D.zlevel===x._zlevelList[0]?x._backgroundColor:null;if(D.__startIndex===D.__endIndex)D.clear(!1,$,O);else if(z===D.__startIndex){var X=e[z];(!X.incremental||!X.notClear||n)&&D.clear(!1,$,O)}z===-1&&(console.error("For some unknown reason. drawIndex is -1"),z=D.__startIndex);var W,Y=function(pe){var de={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(W=z;W<D.__endIndex;W++){var ve=e[W];if(ve.__inHover&&(m=!0),i._doPaintEl(ve,D,l,pe,de,W===D.__endIndex-1),V){var me=Date.now()-H;if(me>15)break}}de.prevElClipPaths&&P.restore()};if(O)if(O.length===0)W=D.__endIndex;else for(var J=x.dpr,re=0;re<O.length;++re){var ae=O[re];P.save(),P.beginPath(),P.rect(ae.x*J,ae.y*J,ae.width*J,ae.height*J),P.clip(),Y(ae),P.restore()}else P.save(),Y(),P.restore();D.__drawIndex=W,D.__drawIndex<D.__endIndex&&(g=!1)},x=this,A=0;A<a.length;A++)y(A);return Nn.wxa&&fe(this._layers,function(M){M&&M.ctx&&M.ctx.draw&&M.ctx.draw()}),{finished:g,needsRefreshHover:m}},t.prototype._doPaintEl=function(e,r,n,i,a,l){var c=r.ctx;if(n){var o=e.getPaintRect();(!i||o&&o.intersect(i))&&(Dg(c,e,a,l),e.setPrevPaintRect(o))}else Dg(c,e,a,l)},t.prototype.getLayer=function(e,r){this._singleCanvas&&!this._needsManuallyCompositing&&(e=og);var n=this._layers[e];return n||(n=new SL("zr_"+e,this,this.dpr),n.zlevel=e,n.__builtin__=!0,this._layerConfig[e]?pn(n,this._layerConfig[e],!0):this._layerConfig[e-KT]&&pn(n,this._layerConfig[e-KT],!0),r&&(n.virtual=r),this.insertLayer(e,n),n.initContext()),n},t.prototype.insertLayer=function(e,r){var n=this._layers,i=this._zlevelList,a=i.length,l=this._domRoot,c=null,o=-1;if(!n[e]&&XCe(r)){if(a>0&&e>i[0]){for(o=0;o<a-1&&!(i[o]<e&&i[o+1]>e);o++);c=n[i[o]]}if(i.splice(o+1,0,e),n[e]=r,!r.virtual)if(c){var d=c.dom;d.nextSibling?l.insertBefore(r.dom,d.nextSibling):l.appendChild(r.dom)}else l.firstChild?l.insertBefore(r.dom,l.firstChild):l.appendChild(r.dom);r.painter||(r.painter=this)}},t.prototype.eachLayer=function(e,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i];e.call(r,this._layers[a],a)}},t.prototype.eachBuiltinLayer=function(e,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],l=this._layers[a];l.__builtin__&&e.call(r,l,a)}},t.prototype.eachOtherLayer=function(e,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],l=this._layers[a];l.__builtin__||e.call(r,l,a)}},t.prototype.getLayers=function(){return this._layers},t.prototype._updateLayerStatus=function(e){this.eachBuiltinLayer(function(m,y){m.__dirty=m.__used=!1});function r(m){a&&(a.__endIndex!==m&&(a.__dirty=!0),a.__endIndex=m)}if(this._singleCanvas)for(var n=1;n<e.length;n++){var i=e[n];if(i.zlevel!==e[n-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var a=null,l=0,c,o;for(o=0;o<e.length;o++){var i=e[o],d=i.zlevel,g=void 0;c!==d&&(c=d,l=0),i.incremental?(g=this.getLayer(d+YCe,this._needsManuallyCompositing),g.incremental=!0,l=1):g=this.getLayer(d+(l>0?KT:0),this._needsManuallyCompositing),g.__builtin__||yz("ZLevel "+d+" has been used by unkown layer "+g.id),g!==a&&(g.__used=!0,g.__startIndex!==o&&(g.__dirty=!0),g.__startIndex=o,g.incremental?g.__drawIndex=-1:g.__drawIndex=o,r(o),a=g),i.__dirty&Ys&&!i.__inHover&&(g.__dirty=!0,g.incremental&&g.__drawIndex<0&&(g.__drawIndex=o))}r(o),this.eachBuiltinLayer(function(m,y){!m.__used&&m.getElementCount()>0&&(m.__dirty=!0,m.__startIndex=m.__endIndex=m.__drawIndex=0),m.__dirty&&m.__drawIndex<0&&(m.__drawIndex=m.__startIndex)})},t.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},t.prototype._clearLayer=function(e){e.clear()},t.prototype.setBackgroundColor=function(e){this._backgroundColor=e,fe(this._layers,function(r){r.setUnpainted()})},t.prototype.configLayer=function(e,r){if(r){var n=this._layerConfig;n[e]?pn(n[e],r,!0):n[e]=r;for(var i=0;i<this._zlevelList.length;i++){var a=this._zlevelList[i];if(a===e||a===e+KT){var l=this._layers[a];pn(l,n[e],!0)}}}},t.prototype.delLayer=function(e){var r=this._layers,n=this._zlevelList,i=r[e];i&&(i.dom.parentNode.removeChild(i.dom),delete r[e],n.splice(An(n,e),1))},t.prototype.resize=function(e,r){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var i=this._opts,a=this.root;if(e!=null&&(i.width=e),r!=null&&(i.height=r),e=__(a,0,i),r=__(a,1,i),n.style.display="",this._width!==e||r!==this._height){n.style.width=e+"px",n.style.height=r+"px";for(var l in this._layers)this._layers.hasOwnProperty(l)&&this._layers[l].resize(e,r);this.refresh(!0)}this._width=e,this._height=r}else{if(e==null||r==null)return;this._width=e,this._height=r,this.getLayer(og).resize(e,r)}return this},t.prototype.clearLayer=function(e){var r=this._layers[e];r&&r.clear()},t.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},t.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[og].dom;var r=new SL("image",this,e.pixelRatio||this.dpr);r.initContext(),r.clear(!1,e.backgroundColor||this._backgroundColor);var n=r.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var i=r.dom.width,a=r.dom.height;this.eachLayer(function(m){m.__builtin__?n.drawImage(m.dom,0,0,i,a):m.renderToCanvas&&(n.save(),m.renderToCanvas(n),n.restore())})}else for(var l={inHover:!1,viewWidth:this._width,viewHeight:this._height},c=this.storage.getDisplayList(!0),o=0,d=c.length;o<d;o++){var g=c[o];Dg(n,g,l,o===d-1)}return r.dom},t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t}();function JCe(t){t.registerPainter("canvas",KCe)}var eMe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.hasSymbolVisual=!0,r}return e.prototype.getInitialData=function(r){return Mh(null,this,{useEncodeDefaulter:!0})},e.prototype.getLegendIcon=function(r){var n=new jr,i=Ia("line",0,r.itemHeight/2,r.itemWidth,0,r.lineStyle.stroke,!1);n.add(i),i.setStyle(r.lineStyle);var a=this.getData().getVisual("symbol"),l=this.getData().getVisual("symbolRotate"),c=a==="none"?"circle":a,o=r.itemHeight*.8,d=Ia(c,(r.itemWidth-o)/2,(r.itemHeight-o)/2,o,o,r.itemStyle.fill);n.add(d),d.setStyle(r.itemStyle);var g=r.iconRotate==="inherit"?l:r.iconRotate||0;return d.rotation=g*Math.PI/180,d.setOrigin([r.itemWidth/2,r.itemHeight/2]),c.indexOf("empty")>-1&&(d.style.stroke=d.style.fill,d.style.fill="#fff",d.style.lineWidth=2),n},e.type="series.line",e.dependencies=["grid","polar"],e.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},e}(Wi);function Z_(t,e){var r=t.mapDimensionsAll("defaultedLabel"),n=r.length;if(n===1){var i=H_(t,e,r[0]);return i!=null?i+"":null}else if(n){for(var a=[],l=0;l<r.length;l++)a.push(H_(t,e,r[l]));return a.join(" ")}}function pK(t,e){var r=t.mapDimensionsAll("defaultedLabel");if(!Ht(e))return e+"";for(var n=[],i=0;i<r.length;i++){var a=t.getDimensionIndex(r[i]);a>=0&&n.push(e[a])}return n.join(" ")}var Ob=function(t){et(e,t);function e(r,n,i,a){var l=t.call(this)||this;return l.updateData(r,n,i,a),l}return e.prototype._createSymbol=function(r,n,i,a,l){this.removeAll();var c=Ia(r,-1,-1,2,2,null,l);c.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),c.drift=tMe,this._symbolType=r,this.add(c)},e.prototype.stopSymbolAnimation=function(r){this.childAt(0).stopAnimation(null,r)},e.prototype.getSymbolType=function(){return this._symbolType},e.prototype.getSymbolPath=function(){return this.childAt(0)},e.prototype.highlight=function(){gh(this.childAt(0))},e.prototype.downplay=function(){vh(this.childAt(0))},e.prototype.setZ=function(r,n){var i=this.childAt(0);i.zlevel=r,i.z=n},e.prototype.setDraggable=function(r,n){var i=this.childAt(0);i.draggable=r,i.cursor=!n&&r?"move":i.cursor},e.prototype.updateData=function(r,n,i,a){this.silent=!1;var l=r.getItemVisual(n,"symbol")||"circle",c=r.hostModel,o=e.getSymbolSize(r,n),d=l!==this._symbolType,g=a&&a.disableAnimation;if(d){var m=r.getItemVisual(n,"symbolKeepAspect");this._createSymbol(l,r,n,o,m)}else{var y=this.childAt(0);y.silent=!1;var x={scaleX:o[0]/2,scaleY:o[1]/2};g?y.attr(x):li(y,x,c,n),xu(y)}if(this._updateCommon(r,n,o,i,a),d){var y=this.childAt(0);if(!g){var x={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:y.style.opacity}};y.scaleX=y.scaleY=0,y.style.opacity=0,Qi(y,x,c,n)}}g&&this.childAt(0).stopAnimation("leave")},e.prototype._updateCommon=function(r,n,i,a,l){var c=this.childAt(0),o=r.hostModel,d,g,m,y,x,A,M,D,P;if(a&&(d=a.emphasisItemStyle,g=a.blurItemStyle,m=a.selectItemStyle,y=a.focus,x=a.blurScope,M=a.labelStatesModels,D=a.hoverScale,P=a.cursorStyle,A=a.emphasisDisabled),!a||r.hasItemOption){var O=a&&a.itemModel?a.itemModel:r.getItemModel(n),z=O.getModel("emphasis");d=z.getModel("itemStyle").getItemStyle(),m=O.getModel(["select","itemStyle"]).getItemStyle(),g=O.getModel(["blur","itemStyle"]).getItemStyle(),y=z.get("focus"),x=z.get("blurScope"),A=z.get("disabled"),M=to(O),D=z.getShallow("scale"),P=O.getShallow("cursor")}var V=r.getItemVisual(n,"symbolRotate");c.attr("rotation",(V||0)*Math.PI/180||0);var H=dv(r.getItemVisual(n,"symbolOffset"),i);H&&(c.x=H[0],c.y=H[1]),P&&c.attr("cursor",P);var $=r.getItemVisual(n,"style"),X=$.fill;if(c instanceof fo){var W=c.style;c.useStyle(Lt({image:W.image,x:W.x,y:W.y,width:W.width,height:W.height},$))}else c.__isEmptyBrush?c.useStyle(Lt({},$)):c.useStyle($),c.style.decal=null,c.setColor(X,l&&l.symbolInnerColor),c.style.strokeNoScale=!0;var Y=r.getItemVisual(n,"liftZ"),J=this._z2;Y!=null?J==null&&(this._z2=c.z2,c.z2+=Y):J!=null&&(c.z2=J,this._z2=null);var re=l&&l.useNameLabel;Ao(c,M,{labelFetcher:o,labelDataIndex:n,defaultText:ae,inheritColor:X,defaultOpacity:$.opacity});function ae(ve){return re?r.getName(ve):Z_(r,ve)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var pe=c.ensureState("emphasis");pe.style=d,c.ensureState("select").style=m,c.ensureState("blur").style=g;var de=D==null||D===!0?Math.max(1.1,3/this._sizeY):isFinite(D)&&D>0?+D:1;pe.scaleX=this._sizeX*de,pe.scaleY=this._sizeY*de,this.setSymbolScale(1),da(this,y,x,A)},e.prototype.setSymbolScale=function(r){this.scaleX=this.scaleY=r},e.prototype.fadeOut=function(r,n,i){var a=this.childAt(0),l=Yr(this).dataIndex,c=i&&i.animation;if(this.silent=a.silent=!0,i&&i.fadeLabel){var o=a.getTextContent();o&&md(o,{style:{opacity:0}},n,{dataIndex:l,removeOpt:c,cb:function(){a.removeTextContent()}})}else a.removeTextContent();md(a,{style:{opacity:0},scaleX:0,scaleY:0},n,{dataIndex:l,cb:r,removeOpt:c})},e.getSymbolSize=function(r,n){return my(r.getItemVisual(n,"symbolSize"))},e}(jr);function tMe(t,e){this.parent.drift(t,e)}function TL(t,e,r,n){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(n.isIgnore&&n.isIgnore(r))&&!(n.clipShape&&!n.clipShape.contain(e[0],e[1]))&&t.getItemVisual(r,"symbol")!=="none"}function _$(t){return t!=null&&!Ur(t)&&(t={isIgnore:t}),t||{}}function y$(t){var e=t.hostModel,r=e.getModel("emphasis");return{emphasisItemStyle:r.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:r.get("focus"),blurScope:r.get("blurScope"),emphasisDisabled:r.get("disabled"),hoverScale:r.get("scale"),labelStatesModels:to(e),cursorStyle:e.get("cursor")}}var zb=function(){function t(e){this.group=new jr,this._SymbolCtor=e||Ob}return t.prototype.updateData=function(e,r){this._progressiveEls=null,r=_$(r);var n=this.group,i=e.hostModel,a=this._data,l=this._SymbolCtor,c=r.disableAnimation,o=y$(e),d={disableAnimation:c},g=r.getSymbolPoint||function(m){return e.getItemLayout(m)};a||n.removeAll(),e.diff(a).add(function(m){var y=g(m);if(TL(e,y,m,r)){var x=new l(e,m,o,d);x.setPosition(y),e.setItemGraphicEl(m,x),n.add(x)}}).update(function(m,y){var x=a.getItemGraphicEl(y),A=g(m);if(!TL(e,A,m,r)){n.remove(x);return}var M=e.getItemVisual(m,"symbol")||"circle",D=x&&x.getSymbolType&&x.getSymbolType();if(!x||D&&D!==M)n.remove(x),x=new l(e,m,o,d),x.setPosition(A);else{x.updateData(e,m,o,d);var P={x:A[0],y:A[1]};c?x.attr(P):li(x,P,i)}n.add(x),e.setItemGraphicEl(m,x)}).remove(function(m){var y=a.getItemGraphicEl(m);y&&y.fadeOut(function(){n.remove(y)},i)}).execute(),this._getSymbolPoint=g,this._data=e},t.prototype.updateLayout=function(){var e=this,r=this._data;r&&r.eachItemGraphicEl(function(n,i){var a=e._getSymbolPoint(i);n.setPosition(a),n.markRedraw()})},t.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=y$(e),this._data=null,this.group.removeAll()},t.prototype.incrementalUpdate=function(e,r,n){this._progressiveEls=[],n=_$(n);function i(o){o.isGroup||(o.incremental=!0,o.ensureState("emphasis").hoverLayer=!0)}for(var a=e.start;a<e.end;a++){var l=r.getItemLayout(a);if(TL(r,l,a,n)){var c=new this._SymbolCtor(r,a,this._seriesScope);c.traverse(i),c.setPosition(l),this.group.add(c),r.setItemGraphicEl(a,c),this._progressiveEls.push(c)}}},t.prototype.eachRendered=function(e){Id(this._progressiveEls||this.group,e)},t.prototype.remove=function(e){var r=this.group,n=this._data;n&&e?n.eachItemGraphicEl(function(i){i.fadeOut(function(){r.remove(i)},n.hostModel)}):r.removeAll()},t}();function gK(t,e,r){var n=t.getBaseAxis(),i=t.getOtherAxis(n),a=rMe(i,r),l=n.dim,c=i.dim,o=e.mapDimension(c),d=e.mapDimension(l),g=c==="x"||c==="radius"?1:0,m=Zt(t.dimensions,function(A){return e.mapDimension(A)}),y=!1,x=e.getCalculationInfo("stackResultDimension");return yd(e,m[0])&&(y=!0,m[0]=x),yd(e,m[1])&&(y=!0,m[1]=x),{dataDimsForPoint:m,valueStart:a,valueAxisDim:c,baseAxisDim:l,stacked:!!y,valueDim:o,baseDim:d,baseDataOffset:g,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function rMe(t,e){var r=0,n=t.scale.getExtent();return e==="start"?r=n[0]:e==="end"?r=n[1]:ii(e)&&!isNaN(e)?r=e:n[0]>0?r=n[0]:n[1]<0&&(r=n[1]),r}function vK(t,e,r,n){var i=NaN;t.stacked&&(i=r.get(r.getCalculationInfo("stackedOverDimension"),n)),isNaN(i)&&(i=t.valueStart);var a=t.baseDataOffset,l=[];return l[a]=r.get(t.baseDim,n),l[1-a]=i,e.dataToPoint(l)}function nMe(t,e){var r=[];return e.diff(t).add(function(n){r.push({cmd:"+",idx:n})}).update(function(n,i){r.push({cmd:"=",idx:i,idx1:n})}).remove(function(n){r.push({cmd:"-",idx:n})}).execute(),r}function iMe(t,e,r,n,i,a,l,c){for(var o=nMe(t,e),d=[],g=[],m=[],y=[],x=[],A=[],M=[],D=gK(i,e,l),P=t.getLayout("points")||[],O=e.getLayout("points")||[],z=0;z<o.length;z++){var V=o[z],H=!0,$=void 0,X=void 0;switch(V.cmd){case"=":$=V.idx*2,X=V.idx1*2;var W=P[$],Y=P[$+1],J=O[X],re=O[X+1];(isNaN(W)||isNaN(Y))&&(W=J,Y=re),d.push(W,Y),g.push(J,re),m.push(r[$],r[$+1]),y.push(n[X],n[X+1]),M.push(e.getRawIndex(V.idx1));break;case"+":var ae=V.idx,pe=D.dataDimsForPoint,de=i.dataToPoint([e.get(pe[0],ae),e.get(pe[1],ae)]);X=ae*2,d.push(de[0],de[1]),g.push(O[X],O[X+1]);var ve=vK(D,i,e,ae);m.push(ve[0],ve[1]),y.push(n[X],n[X+1]),M.push(e.getRawIndex(ae));break;case"-":H=!1}H&&(x.push(V),A.push(A.length))}A.sort(function(ar,ur){return M[ar]-M[ur]});for(var me=d.length,Ie=tc(me),Le=tc(me),Ee=tc(me),Ue=tc(me),Ke=[],z=0;z<A.length;z++){var We=A[z],Rt=z*2,Et=We*2;Ie[Rt]=d[Et],Ie[Rt+1]=d[Et+1],Le[Rt]=g[Et],Le[Rt+1]=g[Et+1],Ee[Rt]=m[Et],Ee[Rt+1]=m[Et+1],Ue[Rt]=y[Et],Ue[Rt+1]=y[Et+1],Ke[z]=x[We]}return{current:Ie,next:Le,stackedOnCurrent:Ee,stackedOnNext:Ue,status:Ke}}var If=Math.min,Ef=Math.max;function Hg(t,e){return isNaN(t)||isNaN(e)}function xO(t,e,r,n,i,a,l,c,o){for(var d,g,m,y,x,A,M=r,D=0;D<n;D++){var P=e[M*2],O=e[M*2+1];if(M>=i||M<0)break;if(Hg(P,O)){if(o){M+=a;continue}break}if(M===r)t[a>0?"moveTo":"lineTo"](P,O),m=P,y=O;else{var z=P-d,V=O-g;if(z*z+V*V<.5){M+=a;continue}if(l>0){for(var H=M+a,$=e[H*2],X=e[H*2+1];$===P&&X===O&&D<n;)D++,H+=a,M+=a,$=e[H*2],X=e[H*2+1],P=e[M*2],O=e[M*2+1],z=P-d,V=O-g;var W=D+1;if(o)for(;Hg($,X)&&W<n;)W++,H+=a,$=e[H*2],X=e[H*2+1];var Y=.5,J=0,re=0,ae=void 0,pe=void 0;if(W>=n||Hg($,X))x=P,A=O;else{J=$-d,re=X-g;var de=P-d,ve=$-P,me=O-g,Ie=X-O,Le=void 0,Ee=void 0;if(c==="x"){Le=Math.abs(de),Ee=Math.abs(ve);var Ue=J>0?1:-1;x=P-Ue*Le*l,A=O,ae=P+Ue*Ee*l,pe=O}else if(c==="y"){Le=Math.abs(me),Ee=Math.abs(Ie);var Ke=re>0?1:-1;x=P,A=O-Ke*Le*l,ae=P,pe=O+Ke*Ee*l}else Le=Math.sqrt(de*de+me*me),Ee=Math.sqrt(ve*ve+Ie*Ie),Y=Ee/(Ee+Le),x=P-J*l*(1-Y),A=O-re*l*(1-Y),ae=P+J*l*Y,pe=O+re*l*Y,ae=If(ae,Ef($,P)),pe=If(pe,Ef(X,O)),ae=Ef(ae,If($,P)),pe=Ef(pe,If(X,O)),J=ae-P,re=pe-O,x=P-J*Le/Ee,A=O-re*Le/Ee,x=If(x,Ef(d,P)),A=If(A,Ef(g,O)),x=Ef(x,If(d,P)),A=Ef(A,If(g,O)),J=P-x,re=O-A,ae=P+J*Ee/Le,pe=O+re*Ee/Le}t.bezierCurveTo(m,y,x,A,P,O),m=ae,y=pe}else t.lineTo(P,O)}d=P,g=O,M+=a}return D}var mK=function(){function t(){this.smooth=0,this.smoothConstraint=!0}return t}(),aMe=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="ec-polyline",n}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new mK},e.prototype.buildPath=function(r,n){var i=n.points,a=0,l=i.length/2;if(n.connectNulls){for(;l>0&&Hg(i[l*2-2],i[l*2-1]);l--);for(;a<l&&Hg(i[a*2],i[a*2+1]);a++);}for(;a<l;)a+=xO(r,i,a,l,l,1,n.smooth,n.smoothMonotone,n.connectNulls)+1},e.prototype.getPointOn=function(r,n){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,a=i.data,l=pc.CMD,c,o,d=n==="x",g=[],m=0;m<a.length;){var y=a[m++],x=void 0,A=void 0,M=void 0,D=void 0,P=void 0,O=void 0,z=void 0;switch(y){case l.M:c=a[m++],o=a[m++];break;case l.L:if(x=a[m++],A=a[m++],z=d?(r-c)/(x-c):(r-o)/(A-o),z<=1&&z>=0){var V=d?(A-o)*z+o:(x-c)*z+c;return d?[r,V]:[V,r]}c=x,o=A;break;case l.C:x=a[m++],A=a[m++],M=a[m++],D=a[m++],P=a[m++],O=a[m++];var H=d?AC(c,x,M,P,r,g):AC(o,A,D,O,r,g);if(H>0)for(var $=0;$<H;$++){var X=g[$];if(X<=1&&X>=0){var V=d?Xa(o,A,D,O,X):Xa(c,x,M,P,X);return d?[r,V]:[V,r]}}c=P,o=O;break}}},e}(kn),oMe=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(mK),_K=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="ec-polygon",n}return e.prototype.getDefaultShape=function(){return new oMe},e.prototype.buildPath=function(r,n){var i=n.points,a=n.stackedOnPoints,l=0,c=i.length/2,o=n.smoothMonotone;if(n.connectNulls){for(;c>0&&Hg(i[c*2-2],i[c*2-1]);c--);for(;l<c&&Hg(i[l*2],i[l*2+1]);l++);}for(;l<c;){var d=xO(r,i,l,c,c,1,n.smooth,o,n.connectNulls);xO(r,a,l+d-1,d,c,-1,n.stackedOnSmooth,o,n.connectNulls),l+=d+1,r.closePath()}},e}(kn);function yK(t,e,r,n,i){var a=t.getArea(),l=a.x,c=a.y,o=a.width,d=a.height,g=r.get(["lineStyle","width"])||2;l-=g/2,c-=g/2,o+=g,d+=g,o=Math.ceil(o),l!==Math.floor(l)&&(l=Math.floor(l),o++);var m=new Kn({shape:{x:l,y:c,width:o,height:d}});if(e){var y=t.getBaseAxis(),x=y.isHorizontal(),A=y.inverse;x?(A&&(m.shape.x+=o),m.shape.width=0):(A||(m.shape.y+=d),m.shape.height=0);var M=zr(i)?function(D){i(D,m)}:null;Qi(m,{shape:{width:o,height:d,x:l,y:c}},r,null,n,M)}return m}function xK(t,e,r){var n=t.getArea(),i=ma(n.r0,1),a=ma(n.r,1),l=new as({shape:{cx:ma(t.cx,1),cy:ma(t.cy,1),r0:i,r:a,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});if(e){var c=t.getBaseAxis().dim==="angle";c?l.shape.endAngle=n.startAngle:l.shape.r=i,Qi(l,{shape:{endAngle:n.endAngle,r:a}},r)}return l}function Bb(t,e,r,n,i){if(t){if(t.type==="polar")return xK(t,e,r);if(t.type==="cartesian2d")return yK(t,e,r,n,i)}else return null;return null}function gv(t,e){return t.type===e}function x$(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return;return!0}}function b$(t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,a=0;a<t.length;){var l=t[a++],c=t[a++];isNaN(l)||(e=Math.min(l,e),n=Math.max(l,n)),isNaN(c)||(r=Math.min(c,r),i=Math.max(c,i))}return[[e,r],[n,i]]}function w$(t,e){var r=b$(t),n=r[0],i=r[1],a=b$(e),l=a[0],c=a[1];return Math.max(Math.abs(n[0]-l[0]),Math.abs(n[1]-l[1]),Math.abs(i[0]-c[0]),Math.abs(i[1]-c[1]))}function S$(t){return ii(t)?t:t?.5:0}function sMe(t,e,r){if(!r.valueDim)return[];for(var n=e.count(),i=tc(n*2),a=0;a<n;a++){var l=vK(r,t,e,a);i[a*2]=l[0],i[a*2+1]=l[1]}return i}function Df(t,e,r,n){var i=e.getBaseAxis(),a=i.dim==="x"||i.dim==="radius"?0:1,l=[],c=0,o=[],d=[],g=[],m=[];if(n){for(c=0;c<t.length;c+=2)!isNaN(t[c])&&!isNaN(t[c+1])&&m.push(t[c],t[c+1]);t=m}for(c=0;c<t.length-2;c+=2)switch(g[0]=t[c+2],g[1]=t[c+3],d[0]=t[c],d[1]=t[c+1],l.push(d[0],d[1]),r){case"end":o[a]=g[a],o[1-a]=d[1-a],l.push(o[0],o[1]);break;case"middle":var y=(d[a]+g[a])/2,x=[];o[a]=x[a]=y,o[1-a]=d[1-a],x[1-a]=g[1-a],l.push(o[0],o[1]),l.push(x[0],x[1]);break;default:o[a]=d[a],o[1-a]=g[1-a],l.push(o[0],o[1])}return l.push(t[c++],t[c++]),l}function lMe(t,e){var r=[],n=t.length,i,a;function l(g,m,y){var x=g.coord,A=(y-x)/(m.coord-x),M=q0e(A,[g.color,m.color]);return{coord:y,color:M}}for(var c=0;c<n;c++){var o=t[c],d=o.coord;if(d<0)i=o;else if(d>e){a?r.push(l(a,o,e)):i&&r.push(l(i,o,0),l(i,o,e));break}else i&&(r.push(l(i,o,0)),i=null),r.push(o),a=o}return r}function uMe(t,e,r){var n=t.getVisual("visualMeta");if(!(!n||!n.length||!t.count())&&e.type==="cartesian2d"){for(var i,a,l=n.length-1;l>=0;l--){var c=t.getDimensionInfo(n[l].dimension);if(i=c&&c.coordDim,i==="x"||i==="y"){a=n[l];break}}if(a){var o=e.getAxis(i),d=Zt(a.stops,function(z){return{coord:o.toGlobalCoord(o.dataToCoord(z.value)),color:z.color}}),g=d.length,m=a.outerColors.slice();g&&d[0].coord>d[g-1].coord&&(d.reverse(),m.reverse());var y=lMe(d,i==="x"?r.getWidth():r.getHeight()),x=y.length;if(!x&&g)return d[0].coord<0?m[1]?m[1]:d[g-1].color:m[0]?m[0]:d[0].color;var A=10,M=y[0].coord-A,D=y[x-1].coord+A,P=D-M;if(P<.001)return"transparent";fe(y,function(z){z.offset=(z.coord-M)/P}),y.push({offset:x?y[x-1].offset:.5,color:m[1]||"transparent"}),y.unshift({offset:x?y[0].offset:.5,color:m[0]||"transparent"});var O=new Mb(0,0,0,0,y,!0);return O[i]=M,O[i+"2"]=D,O}}}function cMe(t,e,r){var n=t.get("showAllSymbol"),i=n==="auto";if(!(n&&!i)){var a=r.getAxesByScale("ordinal")[0];if(a&&!(i&&hMe(a,e))){var l=e.mapDimension(a.dim),c={};return fe(a.getViewLabels(),function(o){var d=a.scale.getRawOrdinalNumber(o.tickValue);c[d]=1}),function(o){return!c.hasOwnProperty(e.get(l,o))}}}}function hMe(t,e){var r=t.getExtent(),n=Math.abs(r[1]-r[0])/t.scale.count();isNaN(n)&&(n=0);for(var i=e.count(),a=Math.max(1,Math.round(i/5)),l=0;l<i;l+=a)if(Ob.getSymbolSize(e,l)[t.isHorizontal()?1:0]*1.5>n)return!1;return!0}function fMe(t,e){return isNaN(t)||isNaN(e)}function dMe(t){for(var e=t.length/2;e>0&&fMe(t[e*2-2],t[e*2-1]);e--);return e-1}function T$(t,e){return[t[e*2],t[e*2+1]]}function pMe(t,e,r){for(var n=t.length/2,i=r==="x"?0:1,a,l,c=0,o=-1,d=0;d<n;d++)if(l=t[d*2+i],!(isNaN(l)||isNaN(t[d*2+1-i]))){if(d===0){a=l;continue}if(a<=e&&l>=e||a>=e&&l<=e){o=d;break}c=d,a=l}return{range:[c,o],t:(e-a)/(l-a)}}function bK(t){if(t.get(["endLabel","show"]))return!0;for(var e=0;e<is.length;e++)if(t.get([is[e],"endLabel","show"]))return!0;return!1}function AL(t,e,r,n){if(gv(e,"cartesian2d")){var i=n.getModel("endLabel"),a=i.get("valueAnimation"),l=n.getData(),c={lastFrameIndex:0},o=bK(n)?function(x,A){t._endLabelOnDuring(x,A,l,c,a,i,e)}:null,d=e.getBaseAxis().isHorizontal(),g=yK(e,r,n,function(){var x=t._endLabel;x&&r&&c.originalX!=null&&x.attr({x:c.originalX,y:c.originalY})},o);if(!n.get("clip",!0)){var m=g.shape,y=Math.max(m.width,m.height);d?(m.y-=y,m.height+=y*2):(m.x-=y,m.width+=y*2)}return o&&o(1,g),g}else return xK(e,r,n)}function gMe(t,e){var r=e.getBaseAxis(),n=r.isHorizontal(),i=r.inverse,a=n?i?"right":"left":"center",l=n?"middle":i?"top":"bottom";return{normal:{align:t.get("align")||a,verticalAlign:t.get("verticalAlign")||l}}}var vMe=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.init=function(){var r=new jr,n=new zb;this.group.add(n.group),this._symbolDraw=n,this._lineGroup=r},e.prototype.render=function(r,n,i){var a=this,l=r.coordinateSystem,c=this.group,o=r.getData(),d=r.getModel("lineStyle"),g=r.getModel("areaStyle"),m=o.getLayout("points")||[],y=l.type==="polar",x=this._coordSys,A=this._symbolDraw,M=this._polyline,D=this._polygon,P=this._lineGroup,O=!n.ssr&&r.get("animation"),z=!g.isEmpty(),V=g.get("origin"),H=gK(l,o,V),$=z&&sMe(l,o,H),X=r.get("showSymbol"),W=r.get("connectNulls"),Y=X&&!y&&cMe(r,o,l),J=this._data;J&&J.eachItemGraphicEl(function(ur,cr){ur.__temp&&(c.remove(ur),J.setItemGraphicEl(cr,null))}),X||A.remove(),c.add(P);var re=y?!1:r.get("step"),ae;l&&l.getArea&&r.get("clip",!0)&&(ae=l.getArea(),ae.width!=null?(ae.x-=.1,ae.y-=.1,ae.width+=.2,ae.height+=.2):ae.r0&&(ae.r0-=.5,ae.r+=.5)),this._clipShapeForSymbol=ae;var pe=uMe(o,l,i)||o.getVisual("style")[o.getVisual("drawType")];if(!(M&&x.type===l.type&&re===this._step))X&&A.updateData(o,{isIgnore:Y,clipShape:ae,disableAnimation:!0,getSymbolPoint:function(ur){return[m[ur*2],m[ur*2+1]]}}),O&&this._initSymbolLabelAnimation(o,l,ae),re&&(m=Df(m,l,re,W),$&&($=Df($,l,re,W))),M=this._newPolyline(m),z?D=this._newPolygon(m,$):D&&(P.remove(D),D=this._polygon=null),y||this._initOrUpdateEndLabel(r,l,nv(pe)),P.setClipPath(AL(this,l,!0,r));else{z&&!D?D=this._newPolygon(m,$):D&&!z&&(P.remove(D),D=this._polygon=null),y||this._initOrUpdateEndLabel(r,l,nv(pe));var de=P.getClipPath();if(de){var ve=AL(this,l,!1,r);Qi(de,{shape:ve.shape},r)}else P.setClipPath(AL(this,l,!0,r));X&&A.updateData(o,{isIgnore:Y,clipShape:ae,disableAnimation:!0,getSymbolPoint:function(ur){return[m[ur*2],m[ur*2+1]]}}),(!x$(this._stackedOnPoints,$)||!x$(this._points,m))&&(O?this._doUpdateAnimation(o,$,l,i,re,V,W):(re&&(m=Df(m,l,re,W),$&&($=Df($,l,re,W))),M.setShape({points:m}),D&&D.setShape({points:m,stackedOnPoints:$})))}var me=r.getModel("emphasis"),Ie=me.get("focus"),Le=me.get("blurScope"),Ee=me.get("disabled");if(M.useStyle(Fr(d.getLineStyle(),{fill:"none",stroke:pe,lineJoin:"bevel"})),To(M,r,"lineStyle"),M.style.lineWidth>0&&r.get(["emphasis","lineStyle","width"])==="bolder"){var Ue=M.getState("emphasis").style;Ue.lineWidth=+M.style.lineWidth+1}Yr(M).seriesIndex=r.seriesIndex,da(M,Ie,Le,Ee);var Ke=S$(r.get("smooth")),We=r.get("smoothMonotone");if(M.setShape({smooth:Ke,smoothMonotone:We,connectNulls:W}),D){var Rt=o.getCalculationInfo("stackedOnSeries"),Et=0;D.useStyle(Fr(g.getAreaStyle(),{fill:pe,opacity:.7,lineJoin:"bevel",decal:o.getVisual("style").decal})),Rt&&(Et=S$(Rt.get("smooth"))),D.setShape({smooth:Ke,stackedOnSmooth:Et,smoothMonotone:We,connectNulls:W}),To(D,r,"areaStyle"),Yr(D).seriesIndex=r.seriesIndex,da(D,Ie,Le,Ee)}var ar=function(ur){a._changePolyState(ur)};o.eachItemGraphicEl(function(ur){ur&&(ur.onHoverStateChange=ar)}),this._polyline.onHoverStateChange=ar,this._data=o,this._coordSys=l,this._stackedOnPoints=$,this._points=m,this._step=re,this._valueOrigin=V,r.get("triggerLineEvent")&&(this.packEventData(r,M),D&&this.packEventData(r,D))},e.prototype.packEventData=function(r,n){Yr(n).eventData={componentType:"series",componentSubType:"line",componentIndex:r.componentIndex,seriesIndex:r.seriesIndex,seriesName:r.name,seriesType:"line"}},e.prototype.highlight=function(r,n,i,a){var l=r.getData(),c=ev(l,a);if(this._changePolyState("emphasis"),!(c instanceof Array)&&c!=null&&c>=0){var o=l.getLayout("points"),d=l.getItemGraphicEl(c);if(!d){var g=o[c*2],m=o[c*2+1];if(isNaN(g)||isNaN(m)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(g,m))return;var y=r.get("zlevel")||0,x=r.get("z")||0;d=new Ob(l,c),d.x=g,d.y=m,d.setZ(y,x);var A=d.getSymbolPath().getTextContent();A&&(A.zlevel=y,A.z=x,A.z2=this._polyline.z2+1),d.__temp=!0,l.setItemGraphicEl(c,d),d.stopSymbolAnimation(!0),this.group.add(d)}d.highlight()}else Oi.prototype.highlight.call(this,r,n,i,a)},e.prototype.downplay=function(r,n,i,a){var l=r.getData(),c=ev(l,a);if(this._changePolyState("normal"),c!=null&&c>=0){var o=l.getItemGraphicEl(c);o&&(o.__temp?(l.setItemGraphicEl(c,null),this.group.remove(o)):o.downplay())}else Oi.prototype.downplay.call(this,r,n,i,a)},e.prototype._changePolyState=function(r){var n=this._polygon;LC(this._polyline,r),n&&LC(n,r)},e.prototype._newPolyline=function(r){var n=this._polyline;return n&&this._lineGroup.remove(n),n=new aMe({shape:{points:r},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(n),this._polyline=n,n},e.prototype._newPolygon=function(r,n){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new _K({shape:{points:r,stackedOnPoints:n},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},e.prototype._initSymbolLabelAnimation=function(r,n,i){var a,l,c=n.getBaseAxis(),o=c.inverse;n.type==="cartesian2d"?(a=c.isHorizontal(),l=!1):n.type==="polar"&&(a=c.dim==="angle",l=!0);var d=r.hostModel,g=d.get("animationDuration");zr(g)&&(g=g(null));var m=d.get("animationDelay")||0,y=zr(m)?m(null):m;r.eachItemGraphicEl(function(x,A){var M=x;if(M){var D=[x.x,x.y],P=void 0,O=void 0,z=void 0;if(i)if(l){var V=i,H=n.pointToCoord(D);a?(P=V.startAngle,O=V.endAngle,z=-H[1]/180*Math.PI):(P=V.r0,O=V.r,z=H[0])}else{var $=i;a?(P=$.x,O=$.x+$.width,z=x.x):(P=$.y+$.height,O=$.y,z=x.y)}var X=O===P?0:(z-P)/(O-P);o&&(X=1-X);var W=zr(m)?m(A):g*X+y,Y=M.getSymbolPath(),J=Y.getTextContent();M.attr({scaleX:0,scaleY:0}),M.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:W}),J&&J.animateFrom({style:{opacity:0}},{duration:300,delay:W}),Y.disableLabelAnimation=!0}})},e.prototype._initOrUpdateEndLabel=function(r,n,i){var a=r.getModel("endLabel");if(bK(r)){var l=r.getData(),c=this._polyline,o=l.getLayout("points");if(!o){c.removeTextContent(),this._endLabel=null;return}var d=this._endLabel;d||(d=this._endLabel=new ti({z2:200}),d.ignoreClip=!0,c.setTextContent(this._endLabel),c.disableLabelAnimation=!0);var g=dMe(o);g>=0&&(Ao(c,to(r,"endLabel"),{inheritColor:i,labelFetcher:r,labelDataIndex:g,defaultText:function(m,y,x){return x!=null?pK(l,x):Z_(l,m)},enableTextSetter:!0},gMe(a,n)),c.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},e.prototype._endLabelOnDuring=function(r,n,i,a,l,c,o){var d=this._endLabel,g=this._polyline;if(d){r<1&&a.originalX==null&&(a.originalX=d.x,a.originalY=d.y);var m=i.getLayout("points"),y=i.hostModel,x=y.get("connectNulls"),A=c.get("precision"),M=c.get("distance")||0,D=o.getBaseAxis(),P=D.isHorizontal(),O=D.inverse,z=n.shape,V=O?P?z.x:z.y+z.height:P?z.x+z.width:z.y,H=(P?M:0)*(O?-1:1),$=(P?0:-M)*(O?-1:1),X=P?"x":"y",W=pMe(m,V,X),Y=W.range,J=Y[1]-Y[0],re=void 0;if(J>=1){if(J>1&&!x){var ae=T$(m,Y[0]);d.attr({x:ae[0]+H,y:ae[1]+$}),l&&(re=y.getRawValue(Y[0]))}else{var ae=g.getPointOn(V,X);ae&&d.attr({x:ae[0]+H,y:ae[1]+$});var pe=y.getRawValue(Y[0]),de=y.getRawValue(Y[1]);l&&(re=iY(i,A,pe,de,W.t))}a.lastFrameIndex=Y[0]}else{var ve=r===1||a.lastFrameIndex>0?Y[0]:0,ae=T$(m,ve);l&&(re=y.getRawValue(ve)),d.attr({x:ae[0]+H,y:ae[1]+$})}if(l){var me=cy(d);typeof me.setLabelText=="function"&&me.setLabelText(re)}}},e.prototype._doUpdateAnimation=function(r,n,i,a,l,c,o){var d=this._polyline,g=this._polygon,m=r.hostModel,y=iMe(this._data,r,this._stackedOnPoints,n,this._coordSys,i,this._valueOrigin),x=y.current,A=y.stackedOnCurrent,M=y.next,D=y.stackedOnNext;if(l&&(x=Df(y.current,i,l,o),A=Df(y.stackedOnCurrent,i,l,o),M=Df(y.next,i,l,o),D=Df(y.stackedOnNext,i,l,o)),w$(x,M)>3e3||g&&w$(A,D)>3e3){d.stopAnimation(),d.setShape({points:M}),g&&(g.stopAnimation(),g.setShape({points:M,stackedOnPoints:D}));return}d.shape.__points=y.current,d.shape.points=x;var P={shape:{points:M}};y.current!==x&&(P.shape.__points=y.next),d.stopAnimation(),li(d,P,m),g&&(g.setShape({points:x,stackedOnPoints:A}),g.stopAnimation(),li(g,{shape:{stackedOnPoints:D}},m),d.shape.points!==g.shape.points&&(g.shape.points=d.shape.points));for(var O=[],z=y.status,V=0;V<z.length;V++){var H=z[V].cmd;if(H==="="){var $=r.getItemGraphicEl(z[V].idx1);$&&O.push({el:$,ptIdx:V})}}d.animators&&d.animators.length&&d.animators[0].during(function(){g&&g.dirtyShape();for(var X=d.shape.__points,W=0;W<O.length;W++){var Y=O[W].el,J=O[W].ptIdx*2;Y.x=X[J],Y.y=X[J+1],Y.markRedraw()}})},e.prototype.remove=function(r){var n=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(a,l){a.__temp&&(n.remove(a),i.setItemGraphicEl(l,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},e.type="line",e}(Oi);function Fb(t,e){return{seriesType:t,plan:gy(),reset:function(r){var n=r.getData(),i=r.coordinateSystem,a=r.pipelineContext,l=e||a.large;if(i){var c=Zt(i.dimensions,function(x){return n.mapDimension(x)}).slice(0,2),o=c.length,d=n.getCalculationInfo("stackResultDimension");yd(n,c[0])&&(c[0]=d),yd(n,c[1])&&(c[1]=d);var g=n.getStore(),m=n.getDimensionIndex(c[0]),y=n.getDimensionIndex(c[1]);return o&&{progress:function(x,A){for(var M=x.end-x.start,D=l&&tc(M*o),P=[],O=[],z=x.start,V=0;z<x.end;z++){var H=void 0;if(o===1){var $=g.get(m,z);H=i.dataToPoint($,null,O)}else P[0]=g.get(m,z),P[1]=g.get(y,z),H=i.dataToPoint(P,null,O);l?(D[V++]=H[0],D[V++]=H[1]):A.setItemLayout(z,H.slice())}l&&A.setLayout("points",D)}}}}}}var mMe={average:function(t){for(var e=0,r=0,n=0;n<t.length;n++)isNaN(t[n])||(e+=t[n],r++);return r===0?NaN:e/r},sum:function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r]||0;return e},max:function(t){for(var e=-1/0,r=0;r<t.length;r++)t[r]>e&&(e=t[r]);return isFinite(e)?e:NaN},min:function(t){for(var e=1/0,r=0;r<t.length;r++)t[r]<e&&(e=t[r]);return isFinite(e)?e:NaN},minmax:function(t){for(var e=-1/0,r=-1/0,n=0;n<t.length;n++){var i=t[n],a=Math.abs(i);a>e&&(e=a,r=i)}return isFinite(r)?r:NaN},nearest:function(t){return t[0]}},_Me=function(t){return Math.round(t.length/2)};function wK(t){return{seriesType:t,reset:function(e,r,n){var i=e.getData(),a=e.get("sampling"),l=e.coordinateSystem,c=i.count();if(c>10&&l.type==="cartesian2d"&&a){var o=l.getBaseAxis(),d=l.getOtherAxis(o),g=o.getExtent(),m=n.getDevicePixelRatio(),y=Math.abs(g[1]-g[0])*(m||1),x=Math.round(c/y);if(isFinite(x)&&x>1){a==="lttb"&&e.setData(i.lttbDownSample(i.mapDimension(d.dim),1/x));var A=void 0;yr(a)?A=mMe[a]:zr(a)&&(A=a),A&&e.setData(i.downSample(i.mapDimension(d.dim),1/x,A,_Me))}}}}}function yMe(t){t.registerChartView(vMe),t.registerSeriesModel(eMe),t.registerLayout(Fb("line",!0)),t.registerVisual({seriesType:"line",reset:function(e){var r=e.getData(),n=e.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=r.getVisual("style").fill),r.setVisual("legendLineStyle",n)}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,wK("line"))}var rb=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.getInitialData=function(r,n){return Mh(null,this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(r,n,i){var a=this.coordinateSystem;if(a&&a.clampData){var l=a.clampData(r),c=a.dataToPoint(l);if(i)fe(a.getAxes(),function(y,x){if(y.type==="category"&&n!=null){var A=y.getTicksCoords(),M=y.getTickModel().get("alignWithLabel"),D=l[x],P=n[x]==="x1"||n[x]==="y1";if(P&&!M&&(D+=1),A.length<2)return;if(A.length===2){c[x]=y.toGlobalCoord(y.getExtent()[P?1:0]);return}for(var O=void 0,z=void 0,V=1,H=0;H<A.length;H++){var $=A[H].coord,X=H===A.length-1?A[H-1].tickValue+V:A[H].tickValue;if(X===D){z=$;break}else if(X<D)O=$;else if(O!=null&&X>D){z=($+O)/2;break}H===1&&(V=X-A[0].tickValue)}z==null&&(O?O&&(z=A[A.length-1].coord):z=A[0].coord),c[x]=y.toGlobalCoord(z)}});else{var o=this.getData(),d=o.getLayout("offset"),g=o.getLayout("size"),m=a.getBaseAxis().isHorizontal()?0:1;c[m]+=d+g/2}return c}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},e}(Wi);Wi.registerClass(rb);var xMe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.getInitialData=function(){return Mh(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},e.prototype.getProgressiveThreshold=function(){var r=this.get("progressiveThreshold"),n=this.get("largeThreshold");return n>r&&(r=n),r},e.prototype.brushSelector=function(r,n,i){return i.rect(n.getItemLayout(r))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=Ed(rb.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),e}(rb),bMe=function(){function t(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return t}(),QC=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="sausage",n}return e.prototype.getDefaultShape=function(){return new bMe},e.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,l=Math.max(n.r0||0,0),c=Math.max(n.r,0),o=(c-l)*.5,d=l+o,g=n.startAngle,m=n.endAngle,y=n.clockwise,x=Math.PI*2,A=y?m-g<x:g-m<x;A||(g=m-(y?x:-x));var M=Math.cos(g),D=Math.sin(g),P=Math.cos(m),O=Math.sin(m);A?(r.moveTo(M*l+i,D*l+a),r.arc(M*d+i,D*d+a,o,-Math.PI+g,g,!y)):r.moveTo(M*c+i,D*c+a),r.arc(i,a,c,g,m,!y),r.arc(P*d+i,O*d+a,o,m-Math.PI*2,m-Math.PI,!y),l!==0&&r.arc(i,a,l,m,g,y)},e}(kn);function wMe(t,e){e=e||{};var r=e.isRoundCap;return function(n,i,a){var l=i.position;if(!l||l instanceof Array)return DC(n,i,a);var c=t(l),o=i.distance!=null?i.distance:5,d=this.shape,g=d.cx,m=d.cy,y=d.r,x=d.r0,A=(y+x)/2,M=d.startAngle,D=d.endAngle,P=(M+D)/2,O=r?Math.abs(y-x)/2:0,z=Math.cos,V=Math.sin,H=g+y*z(M),$=m+y*V(M),X="left",W="top";switch(c){case"startArc":H=g+(x-o)*z(P),$=m+(x-o)*V(P),X="center",W="top";break;case"insideStartArc":H=g+(x+o)*z(P),$=m+(x+o)*V(P),X="center",W="bottom";break;case"startAngle":H=g+A*z(M)+JT(M,o+O,!1),$=m+A*V(M)+eA(M,o+O,!1),X="right",W="middle";break;case"insideStartAngle":H=g+A*z(M)+JT(M,-o+O,!1),$=m+A*V(M)+eA(M,-o+O,!1),X="left",W="middle";break;case"middle":H=g+A*z(P),$=m+A*V(P),X="center",W="middle";break;case"endArc":H=g+(y+o)*z(P),$=m+(y+o)*V(P),X="center",W="bottom";break;case"insideEndArc":H=g+(y-o)*z(P),$=m+(y-o)*V(P),X="center",W="top";break;case"endAngle":H=g+A*z(D)+JT(D,o+O,!0),$=m+A*V(D)+eA(D,o+O,!0),X="left",W="middle";break;case"insideEndAngle":H=g+A*z(D)+JT(D,-o+O,!0),$=m+A*V(D)+eA(D,-o+O,!0),X="right",W="middle";break;default:return DC(n,i,a)}return n=n||{},n.x=H,n.y=$,n.align=X,n.verticalAlign=W,n}}function SMe(t,e,r,n){if(ii(n)){t.setTextConfig({rotation:n});return}else if(Ht(e)){t.setTextConfig({rotation:0});return}var i=t.shape,a=i.clockwise?i.startAngle:i.endAngle,l=i.clockwise?i.endAngle:i.startAngle,c=(a+l)/2,o,d=r(e);switch(d){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":o=c;break;case"startAngle":case"insideStartAngle":o=a;break;case"endAngle":case"insideEndAngle":o=l;break;default:t.setTextConfig({rotation:0});return}var g=Math.PI*1.5-o;d==="middle"&&g>Math.PI/2&&g<Math.PI*1.5&&(g-=Math.PI),t.setTextConfig({rotation:g})}function JT(t,e,r){return e*Math.sin(t)*(r?-1:1)}function eA(t,e,r){return e*Math.cos(t)*(r?1:-1)}function Pg(t,e,r){var n=t.get("borderRadius");if(n==null)return r?{cornerRadius:0}:null;Ht(n)||(n=[n,n,n,n]);var i=Math.abs(e.r||0-e.r0||0);return{cornerRadius:Zt(n,function(a){return yu(a,i)})}}var CL=Math.max,ML=Math.min;function TMe(t,e){var r=t.getArea&&t.getArea();if(gv(t,"cartesian2d")){var n=t.getBaseAxis();if(n.type!=="category"||!n.onBand){var i=e.getLayout("bandWidth");n.isHorizontal()?(r.x-=i,r.width+=i*2):(r.y-=i,r.height+=i*2)}}return r}var AMe=function(t){et(e,t);function e(){var r=t.call(this)||this;return r.type=e.type,r._isFirstFrame=!0,r}return e.prototype.render=function(r,n,i,a){this._model=r,this._removeOnRenderedListener(i),this._updateDrawMode(r);var l=r.get("coordinateSystem");(l==="cartesian2d"||l==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(r,n,i):this._renderNormal(r,n,i,a))},e.prototype.incrementalPrepareRender=function(r){this._clear(),this._updateDrawMode(r),this._updateLargeClip(r)},e.prototype.incrementalRender=function(r,n){this._progressiveEls=[],this._incrementalRenderLarge(r,n)},e.prototype.eachRendered=function(r){Id(this._progressiveEls||this.group,r)},e.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},e.prototype._renderNormal=function(r,n,i,a){var l=this.group,c=r.getData(),o=this._data,d=r.coordinateSystem,g=d.getBaseAxis(),m;d.type==="cartesian2d"?m=g.isHorizontal():d.type==="polar"&&(m=g.dim==="angle");var y=r.isAnimationEnabled()?r:null,x=CMe(r,d);x&&this._enableRealtimeSort(x,c,i);var A=r.get("clip",!0)||x,M=TMe(d,c);l.removeClipPath();var D=r.get("roundCap",!0),P=r.get("showBackground",!0),O=r.getModel("backgroundStyle"),z=O.get("borderRadius")||0,V=[],H=this._backgroundEls,$=a&&a.isInitSort,X=a&&a.type==="changeAxisOrder";function W(re){var ae=tA[d.type](c,re),pe=RMe(d,m,ae);return pe.useStyle(O.getItemStyle()),d.type==="cartesian2d"?pe.setShape("r",z):pe.setShape("cornerRadius",z),V[re]=pe,pe}c.diff(o).add(function(re){var ae=c.getItemModel(re),pe=tA[d.type](c,re,ae);if(P&&W(re),!(!c.hasValue(re)||!E$[d.type](pe))){var de=!1;A&&(de=A$[d.type](M,pe));var ve=C$[d.type](r,c,re,pe,m,y,g.model,!1,D);x&&(ve.forceLabelAnimation=!0),D$(ve,c,re,ae,pe,r,m,d.type==="polar"),$?ve.attr({shape:pe}):x?M$(x,y,ve,pe,re,m,!1,!1):Qi(ve,{shape:pe},r,re),c.setItemGraphicEl(re,ve),l.add(ve),ve.ignore=de}}).update(function(re,ae){var pe=c.getItemModel(re),de=tA[d.type](c,re,pe);if(P){var ve=void 0;H.length===0?ve=W(ae):(ve=H[ae],ve.useStyle(O.getItemStyle()),d.type==="cartesian2d"?ve.setShape("r",z):ve.setShape("cornerRadius",z),V[re]=ve);var me=tA[d.type](c,re),Ie=TK(m,me,d);li(ve,{shape:Ie},y,re)}var Le=o.getItemGraphicEl(ae);if(!c.hasValue(re)||!E$[d.type](de)){l.remove(Le);return}var Ee=!1;if(A&&(Ee=A$[d.type](M,de),Ee&&l.remove(Le)),Le?xu(Le):Le=C$[d.type](r,c,re,de,m,y,g.model,!!Le,D),x&&(Le.forceLabelAnimation=!0),X){var Ue=Le.getTextContent();if(Ue){var Ke=cy(Ue);Ke.prevValue!=null&&(Ke.prevValue=Ke.value)}}else D$(Le,c,re,pe,de,r,m,d.type==="polar");$?Le.attr({shape:de}):x?M$(x,y,Le,de,re,m,!0,X):li(Le,{shape:de},r,re,null),c.setItemGraphicEl(re,Le),Le.ignore=Ee,l.add(Le)}).remove(function(re){var ae=o.getItemGraphicEl(re);ae&&W1(ae,r,re)}).execute();var Y=this._backgroundGroup||(this._backgroundGroup=new jr);Y.removeAll();for(var J=0;J<V.length;++J)Y.add(V[J]);l.add(Y),this._backgroundEls=V,this._data=c},e.prototype._renderLarge=function(r,n,i){this._clear(),L$(r,this.group),this._updateLargeClip(r)},e.prototype._incrementalRenderLarge=function(r,n){this._removeBackground(),L$(n,this.group,this._progressiveEls,!0)},e.prototype._updateLargeClip=function(r){var n=r.get("clip",!0)&&Bb(r.coordinateSystem,!1,r),i=this.group;n?i.setClipPath(n):i.removeClipPath()},e.prototype._enableRealtimeSort=function(r,n,i){var a=this;if(n.count()){var l=r.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(n,r,i),this._isFirstFrame=!1;else{var c=function(o){var d=n.getItemGraphicEl(o),g=d&&d.shape;return g&&Math.abs(l.isHorizontal()?g.height:g.width)||0};this._onRendered=function(){a._updateSortWithinSameData(n,c,l,i)},i.getZr().on("rendered",this._onRendered)}}},e.prototype._dataSort=function(r,n,i){var a=[];return r.each(r.mapDimension(n.dim),function(l,c){var o=i(c);o=o??NaN,a.push({dataIndex:c,mappedValue:o,ordinalNumber:l})}),a.sort(function(l,c){return c.mappedValue-l.mappedValue}),{ordinalNumbers:Zt(a,function(l){return l.ordinalNumber})}},e.prototype._isOrderChangedWithinSameData=function(r,n,i){for(var a=i.scale,l=r.mapDimension(i.dim),c=Number.MAX_VALUE,o=0,d=a.getOrdinalMeta().categories.length;o<d;++o){var g=r.rawIndexOf(l,a.getRawOrdinalNumber(o)),m=g<0?Number.MIN_VALUE:n(r.indexOfRawIndex(g));if(m>c)return!0;c=m}return!1},e.prototype._isOrderDifferentInView=function(r,n){for(var i=n.scale,a=i.getExtent(),l=Math.max(0,a[0]),c=Math.min(a[1],i.getOrdinalMeta().categories.length-1);l<=c;++l)if(r.ordinalNumbers[l]!==i.getRawOrdinalNumber(l))return!0},e.prototype._updateSortWithinSameData=function(r,n,i,a){if(this._isOrderChangedWithinSameData(r,n,i)){var l=this._dataSort(r,i,n);this._isOrderDifferentInView(l,i)&&(this._removeOnRenderedListener(a),a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:l}))}},e.prototype._dispatchInitSort=function(r,n,i){var a=n.baseAxis,l=this._dataSort(r,a,function(c){return r.get(r.mapDimension(n.otherAxis.dim),c)});i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",isInitSort:!0,axisId:a.index,sortInfo:l})},e.prototype.remove=function(r,n){this._clear(this._model),this._removeOnRenderedListener(n)},e.prototype.dispose=function(r,n){this._removeOnRenderedListener(n)},e.prototype._removeOnRenderedListener=function(r){this._onRendered&&(r.getZr().off("rendered",this._onRendered),this._onRendered=null)},e.prototype._clear=function(r){var n=this.group,i=this._data;r&&r.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(a){W1(a,r,Yr(a).dataIndex)})):n.removeAll(),this._data=null,this._isFirstFrame=!0},e.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},e.type="bar",e}(Oi),A$={cartesian2d:function(t,e){var r=e.width<0?-1:1,n=e.height<0?-1:1;r<0&&(e.x+=e.width,e.width=-e.width),n<0&&(e.y+=e.height,e.height=-e.height);var i=t.x+t.width,a=t.y+t.height,l=CL(e.x,t.x),c=ML(e.x+e.width,i),o=CL(e.y,t.y),d=ML(e.y+e.height,a),g=c<l,m=d<o;return e.x=g&&l>i?c:l,e.y=m&&o>a?d:o,e.width=g?0:c-l,e.height=m?0:d-o,r<0&&(e.x+=e.width,e.width=-e.width),n<0&&(e.y+=e.height,e.height=-e.height),g||m},polar:function(t,e){var r=e.r0<=e.r?1:-1;if(r<0){var n=e.r;e.r=e.r0,e.r0=n}var i=ML(e.r,t.r),a=CL(e.r0,t.r0);e.r=i,e.r0=a;var l=i-a<0;if(r<0){var n=e.r;e.r=e.r0,e.r0=n}return l}},C$={cartesian2d:function(t,e,r,n,i,a,l,c,o){var d=new Kn({shape:Lt({},n),z2:1});if(d.__dataIndex=r,d.name="item",a){var g=d.shape,m=i?"height":"width";g[m]=0}return d},polar:function(t,e,r,n,i,a,l,c,o){var d=!i&&o?QC:as,g=new d({shape:n,z2:1});g.name="item";var m=SK(i);if(g.calculateTextPosition=wMe(m,{isRoundCap:d===QC}),a){var y=g.shape,x=i?"r":"endAngle",A={};y[x]=i?n.r0:n.startAngle,A[x]=n[x],(c?li:Qi)(g,{shape:A},a)}return g}};function CMe(t,e){var r=t.get("realtimeSort",!0),n=e.getBaseAxis();if(r&&n.type==="category"&&e.type==="cartesian2d")return{baseAxis:n,otherAxis:e.getOtherAxis(n)}}function M$(t,e,r,n,i,a,l,c){var o,d;a?(d={x:n.x,width:n.width},o={y:n.y,height:n.height}):(d={y:n.y,height:n.height},o={x:n.x,width:n.width}),c||(l?li:Qi)(r,{shape:o},e,i,null);var g=e?t.baseAxis.model:null;(l?li:Qi)(r,{shape:d},g,i)}function I$(t,e){for(var r=0;r<e.length;r++)if(!isFinite(t[e[r]]))return!0;return!1}var MMe=["x","y","width","height"],IMe=["cx","cy","r","startAngle","endAngle"],E$={cartesian2d:function(t){return!I$(t,MMe)},polar:function(t){return!I$(t,IMe)}},tA={cartesian2d:function(t,e,r){var n=t.getItemLayout(e),i=r?DMe(r,n):0,a=n.width>0?1:-1,l=n.height>0?1:-1;return{x:n.x+a*i/2,y:n.y+l*i/2,width:n.width-a*i,height:n.height-l*i}},polar:function(t,e,r){var n=t.getItemLayout(e);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function EMe(t){return t.startAngle!=null&&t.endAngle!=null&&t.startAngle===t.endAngle}function SK(t){return function(e){var r=e?"Arc":"Angle";return function(n){switch(n){case"start":case"insideStart":case"end":case"insideEnd":return n+r;default:return n}}}(t)}function D$(t,e,r,n,i,a,l,c){var o=e.getItemVisual(r,"style");if(c){if(!a.get("roundCap")){var g=t.shape,m=Pg(n.getModel("itemStyle"),g,!0);Lt(g,m),t.setShape(g)}}else{var d=n.get(["itemStyle","borderRadius"])||0;t.setShape("r",d)}t.useStyle(o);var y=n.getShallow("cursor");y&&t.attr("cursor",y);var x=c?l?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":l?i.height>=0?"bottom":"top":i.width>=0?"right":"left",A=to(n);Ao(t,A,{labelFetcher:a,labelDataIndex:r,defaultText:Z_(a.getData(),r),inheritColor:o.fill,defaultOpacity:o.opacity,defaultOutsidePosition:x});var M=t.getTextContent();if(c&&M){var D=n.get(["label","position"]);t.textConfig.inside=D==="middle"?!0:null,SMe(t,D==="outside"?x:D,SK(l),n.get(["label","rotate"]))}$Y(M,A,a.getRawValue(r),function(O){return pK(e,O)});var P=n.getModel(["emphasis"]);da(t,P.get("focus"),P.get("blurScope"),P.get("disabled")),To(t,n),EMe(i)&&(t.style.fill="none",t.style.stroke="none",fe(t.states,function(O){O.style&&(O.style.fill=O.style.stroke="none")}))}function DMe(t,e){var r=t.get(["itemStyle","borderColor"]);if(!r||r==="none")return 0;var n=t.get(["itemStyle","borderWidth"])||0,i=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),a=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(n,i,a)}var PMe=function(){function t(){}return t}(),P$=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="largeBar",n}return e.prototype.getDefaultShape=function(){return new PMe},e.prototype.buildPath=function(r,n){for(var i=n.points,a=this.baseDimIdx,l=1-this.baseDimIdx,c=[],o=[],d=this.barWidth,g=0;g<i.length;g+=3)o[a]=d,o[l]=i[g+2],c[a]=i[g+a],c[l]=i[g+l],r.rect(c[0],c[1],o[0],o[1])},e}(kn);function L$(t,e,r,n){var i=t.getData(),a=i.getLayout("valueAxisHorizontal")?1:0,l=i.getLayout("largeDataIndices"),c=i.getLayout("size"),o=t.getModel("backgroundStyle"),d=i.getLayout("largeBackgroundPoints");if(d){var g=new P$({shape:{points:d},incremental:!!n,silent:!0,z2:0});g.baseDimIdx=a,g.largeDataIndices=l,g.barWidth=c,g.useStyle(o.getItemStyle()),e.add(g),r&&r.push(g)}var m=new P$({shape:{points:i.getLayout("largePoints")},incremental:!!n,ignoreCoarsePointer:!0,z2:1});m.baseDimIdx=a,m.largeDataIndices=l,m.barWidth=c,e.add(m),m.useStyle(i.getVisual("style")),Yr(m).seriesIndex=t.seriesIndex,t.get("silent")||(m.on("mousedown",R$),m.on("mousemove",R$)),r&&r.push(m)}var R$=sB(function(t){var e=this,r=LMe(e,t.offsetX,t.offsetY);Yr(e).dataIndex=r>=0?r:null},30,!1);function LMe(t,e,r){for(var n=t.baseDimIdx,i=1-n,a=t.shape.points,l=t.largeDataIndices,c=[],o=[],d=t.barWidth,g=0,m=a.length/3;g<m;g++){var y=g*3;if(o[n]=d,o[i]=a[y+2],c[n]=a[y+n],c[i]=a[y+i],o[i]<0&&(c[i]+=o[i],o[i]=-o[i]),e>=c[0]&&e<=c[0]+o[0]&&r>=c[1]&&r<=c[1]+o[1])return l[g]}return-1}function TK(t,e,r){if(gv(r,"cartesian2d")){var n=e,i=r.getArea();return{x:t?n.x:i.x,y:t?i.y:n.y,width:t?n.width:i.width,height:t?i.height:n.height}}else{var i=r.getArea(),a=e;return{cx:i.cx,cy:i.cy,r0:t?i.r0:a.r0,r:t?i.r:a.r,startAngle:t?a.startAngle:0,endAngle:t?a.endAngle:Math.PI*2}}}function RMe(t,e,r){var n=t.type==="polar"?as:Kn;return new n({shape:TK(e,r,t),silent:!0,z2:0})}function kMe(t){t.registerChartView(AMe),t.registerSeriesModel(xMe),t.registerLayout(t.PRIORITY.VISUAL.LAYOUT,on(DQ,"bar")),t.registerLayout(t.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,PQ("bar")),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,wK("bar")),t.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(e,r){var n=e.componentType||"series";r.eachComponent({mainType:n,query:e},function(i){e.sortInfo&&i.axis.setCategorySortInfo(e.sortInfo)})})}var k$=Math.PI*2,rA=Math.PI/180;function AK(t,e){return Na(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function CK(t,e){var r=AK(t,e),n=t.get("center"),i=t.get("radius");Ht(i)||(i=[0,i]);var a=dr(r.width,e.getWidth()),l=dr(r.height,e.getHeight()),c=Math.min(a,l),o=dr(i[0],c/2),d=dr(i[1],c/2),g,m,y=t.coordinateSystem;if(y){var x=y.dataToPoint(n);g=x[0]||0,m=x[1]||0}else Ht(n)||(n=[n,n]),g=dr(n[0],a)+r.x,m=dr(n[1],l)+r.y;return{cx:g,cy:m,r0:o,r:d}}function OMe(t,e,r){e.eachSeriesByType(t,function(n){var i=n.getData(),a=i.mapDimension("value"),l=AK(n,r),c=CK(n,r),o=c.cx,d=c.cy,g=c.r,m=c.r0,y=-n.get("startAngle")*rA,x=n.get("endAngle"),A=n.get("padAngle")*rA;x=x==="auto"?y-k$:-x*rA;var M=n.get("minAngle")*rA,D=M+A,P=0;i.each(a,function(me){!isNaN(me)&&P++});var O=i.getSum(a),z=Math.PI/(O||P)*2,V=n.get("clockwise"),H=n.get("roseType"),$=n.get("stillShowZeroSum"),X=i.getDataExtent(a);X[0]=0;var W=V?1:-1,Y=[y,x],J=W*A/2;kz(Y,!V),y=Y[0],x=Y[1];var re=Math.abs(x-y),ae=re,pe=0,de=y;if(i.setLayout({viewRect:l,r:g}),i.each(a,function(me,Ie){var Le;if(isNaN(me)){i.setItemLayout(Ie,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:V,cx:o,cy:d,r0:m,r:H?NaN:g});return}H!=="area"?Le=O===0&&$?z:me*z:Le=re/P,Le<D?(Le=D,ae-=D):pe+=me;var Ee=de+W*Le,Ue=0,Ke=0;A>Le?(Ue=de+W*Le/2,Ke=Ue):(Ue=de+J,Ke=Ee-J),i.setItemLayout(Ie,{angle:Le,startAngle:Ue,endAngle:Ke,clockwise:V,cx:o,cy:d,r0:m,r:H?Ci(me,X,[m,g]):g}),de=Ee}),ae<k$&&P)if(ae<=.001){var ve=re/P;i.each(a,function(me,Ie){if(!isNaN(me)){var Le=i.getItemLayout(Ie);Le.angle=ve;var Ee=0,Ue=0;ve<A?(Ee=y+W*(Ie+1/2)*ve,Ue=Ee):(Ee=y+W*Ie*ve+J,Ue=y+W*(Ie+1)*ve-J),Le.startAngle=Ee,Le.endAngle=Ue}})}else z=ae/pe,de=y,i.each(a,function(me,Ie){if(!isNaN(me)){var Le=i.getItemLayout(Ie),Ee=Le.angle===D?D:me*z,Ue=0,Ke=0;Ee<A?(Ue=de+W*Ee/2,Ke=Ue):(Ue=de+J,Ke=de+W*Ee-J),Le.startAngle=Ue,Le.endAngle=Ke,de+=W*Ee}})})}function Nb(t){return{seriesType:t,reset:function(e,r){var n=r.findComponents({mainType:"legend"});if(!(!n||!n.length)){var i=e.getData();i.filterSelf(function(a){for(var l=i.getName(a),c=0;c<n.length;c++)if(!n[c].isSelected(l))return!1;return!0})}}}}var zMe=Math.PI/180;function O$(t,e,r,n,i,a,l,c,o,d){if(t.length<2)return;function g(M){for(var D=M.rB,P=D*D,O=0;O<M.list.length;O++){var z=M.list[O],V=Math.abs(z.label.y-r),H=n+z.len,$=H*H,X=Math.sqrt((1-Math.abs(V*V/P))*$),W=e+(X+z.len2)*i,Y=W-z.label.x,J=z.targetTextWidth-Y*i;MK(z,J,!0),z.label.x=W}}function m(M){for(var D={list:[],maxY:0},P={list:[],maxY:0},O=0;O<M.length;O++)if(M[O].labelAlignTo==="none"){var z=M[O],V=z.label.y>r?P:D,H=Math.abs(z.label.y-r);if(H>=V.maxY){var $=z.label.x-e-z.len2*i,X=n+z.len,W=Math.abs($)<X?Math.sqrt(H*H/(1-$*$/X/X)):X;V.rB=W,V.maxY=H}V.list.push(z)}g(D),g(P)}for(var y=t.length,x=0;x<y;x++)if(t[x].position==="outer"&&t[x].labelAlignTo==="labelLine"){var A=t[x].label.x-d;t[x].linePoints[1][0]+=A,t[x].label.x=d}QQ(t,o,o+l)&&m(t)}function BMe(t,e,r,n,i,a,l,c){for(var o=[],d=[],g=Number.MAX_VALUE,m=-Number.MAX_VALUE,y=0;y<t.length;y++){var x=t[y].label;IL(t[y])||(x.x<e?(g=Math.min(g,x.x),o.push(t[y])):(m=Math.max(m,x.x),d.push(t[y])))}for(var y=0;y<t.length;y++){var A=t[y];if(!IL(A)&&A.linePoints){if(A.labelStyleWidth!=null)continue;var x=A.label,M=A.linePoints,D=void 0;A.labelAlignTo==="edge"?x.x<e?D=M[2][0]-A.labelDistance-l-A.edgeDistance:D=l+i-A.edgeDistance-M[2][0]-A.labelDistance:A.labelAlignTo==="labelLine"?x.x<e?D=g-l-A.bleedMargin:D=l+i-m-A.bleedMargin:x.x<e?D=x.x-l-A.bleedMargin:D=l+i-x.x-A.bleedMargin,A.targetTextWidth=D,MK(A,D)}}O$(d,e,r,n,1,i,a,l,c,m),O$(o,e,r,n,-1,i,a,l,c,g);for(var y=0;y<t.length;y++){var A=t[y];if(!IL(A)&&A.linePoints){var x=A.label,M=A.linePoints,P=A.labelAlignTo==="edge",O=x.style.padding,z=O?O[1]+O[3]:0,V=x.style.backgroundColor?0:z,H=A.rect.width+V,$=M[1][0]-M[2][0];P?x.x<e?M[2][0]=l+A.edgeDistance+H+A.labelDistance:M[2][0]=l+i-A.edgeDistance-H-A.labelDistance:(x.x<e?M[2][0]=x.x+A.labelDistance:M[2][0]=x.x-A.labelDistance,M[1][0]=M[2][0]+$),M[1][1]=M[2][1]=x.y}}}function MK(t,e,r){if(r===void 0&&(r=!1),t.labelStyleWidth==null){var n=t.label,i=n.style,a=t.rect,l=i.backgroundColor,c=i.padding,o=c?c[1]+c[3]:0,d=i.overflow,g=a.width+(l?0:o);if(e<g||r){var m=a.height;if(d&&d.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",e-o);var y=n.getBoundingRect();n.setStyle("width",Math.ceil(y.width)),n.setStyle("backgroundColor",l)}else{var x=e-o,A=e<g?x:r?x>t.unconstrainedWidth?null:x:null;n.setStyle("width",A)}var M=n.getBoundingRect();a.width=M.width;var D=(n.style.margin||0)+2.1;a.height=M.height+D,a.y-=(a.height-m)/2}}}function IL(t){return t.position==="center"}function FMe(t){var e=t.getData(),r=[],n,i,a=!1,l=(t.get("minShowLabelAngle")||0)*zMe,c=e.getLayout("viewRect"),o=e.getLayout("r"),d=c.width,g=c.x,m=c.y,y=c.height;function x($){$.ignore=!0}function A($){if(!$.ignore)return!0;for(var X in $.states)if($.states[X].ignore===!1)return!0;return!1}e.each(function($){var X=e.getItemGraphicEl($),W=X.shape,Y=X.getTextContent(),J=X.getTextGuideLine(),re=e.getItemModel($),ae=re.getModel("label"),pe=ae.get("position")||re.get(["emphasis","label","position"]),de=ae.get("distanceToLabelLine"),ve=ae.get("alignTo"),me=dr(ae.get("edgeDistance"),d),Ie=ae.get("bleedMargin"),Le=re.getModel("labelLine"),Ee=Le.get("length");Ee=dr(Ee,d);var Ue=Le.get("length2");if(Ue=dr(Ue,d),Math.abs(W.endAngle-W.startAngle)<l){fe(Y.states,x),Y.ignore=!0,J&&(fe(J.states,x),J.ignore=!0);return}if(A(Y)){var Ke=(W.startAngle+W.endAngle)/2,We=Math.cos(Ke),Rt=Math.sin(Ke),Et,ar,ur,cr;n=W.cx,i=W.cy;var lt=pe==="inside"||pe==="inner";if(pe==="center")Et=W.cx,ar=W.cy,cr="center";else{var qt=(lt?(W.r+W.r0)/2*We:W.r*We)+n,Ut=(lt?(W.r+W.r0)/2*Rt:W.r*Rt)+i;if(Et=qt+We*3,ar=Ut+Rt*3,!lt){var rr=qt+We*(Ee+o-W.r),br=Ut+Rt*(Ee+o-W.r),Oe=rr+(We<0?-1:1)*Ue,$e=br;ve==="edge"?Et=We<0?g+me:g+d-me:Et=Oe+(We<0?-de:de),ar=$e,ur=[[qt,Ut],[rr,br],[Oe,$e]]}cr=lt?"center":ve==="edge"?We>0?"right":"left":We>0?"left":"right"}var ct=Math.PI,bt=0,At=ae.get("rotate");if(ii(At))bt=At*(ct/180);else if(pe==="center")bt=0;else if(At==="radial"||At===!0){var Jt=We<0?-Ke+ct:-Ke;bt=Jt}else if(At==="tangential"&&pe!=="outside"&&pe!=="outer"){var mt=Math.atan2(We,Rt);mt<0&&(mt=ct*2+mt);var ht=Rt>0;ht&&(mt=ct+mt),bt=mt-ct}if(a=!!bt,Y.x=Et,Y.y=ar,Y.rotation=bt,Y.setStyle({verticalAlign:"middle"}),lt){Y.setStyle({align:cr});var qe=Y.states.select;qe&&(qe.x+=Y.x,qe.y+=Y.y)}else{var er=Y.getBoundingRect().clone();er.applyTransform(Y.getComputedTransform());var Bt=(Y.style.margin||0)+2.1;er.y-=Bt/2,er.height+=Bt,r.push({label:Y,labelLine:J,position:pe,len:Ee,len2:Ue,minTurnAngle:Le.get("minTurnAngle"),maxSurfaceAngle:Le.get("maxSurfaceAngle"),surfaceNormal:new hn(We,Rt),linePoints:ur,textAlign:cr,labelDistance:de,labelAlignTo:ve,edgeDistance:me,bleedMargin:Ie,rect:er,unconstrainedWidth:er.width,labelStyleWidth:Y.style.width})}X.setTextConfig({inside:lt})}}),!a&&t.get("avoidLabelOverlap")&&BMe(r,n,i,o,d,y,g,m);for(var M=0;M<r.length;M++){var D=r[M],P=D.label,O=D.labelLine,z=isNaN(P.x)||isNaN(P.y);if(P){P.setStyle({align:D.textAlign}),z&&(fe(P.states,x),P.ignore=!0);var V=P.states.select;V&&(V.x+=P.x,V.y+=P.y)}if(O){var H=D.linePoints;z||!H?(fe(O.states,x),O.ignore=!0):(qQ(H,D.minTurnAngle),sCe(H,D.surfaceNormal,D.maxSurfaceAngle),O.setShape({points:H}),P.__hostTarget.textGuideLineConfig={anchor:new hn(H[0][0],H[0][1])})}}}var NMe=function(t){et(e,t);function e(r,n,i){var a=t.call(this)||this;a.z2=2;var l=new ti;return a.setTextContent(l),a.updateData(r,n,i,!0),a}return e.prototype.updateData=function(r,n,i,a){var l=this,c=r.hostModel,o=r.getItemModel(n),d=o.getModel("emphasis"),g=r.getItemLayout(n),m=Lt(Pg(o.getModel("itemStyle"),g,!0),g);if(isNaN(m.startAngle)){l.setShape(m);return}if(a){l.setShape(m);var y=c.getShallow("animationType");c.ecModel.ssr?(Qi(l,{scaleX:0,scaleY:0},c,{dataIndex:n,isFrom:!0}),l.originX=m.cx,l.originY=m.cy):y==="scale"?(l.shape.r=g.r0,Qi(l,{shape:{r:g.r}},c,n)):i!=null?(l.setShape({startAngle:i,endAngle:i}),Qi(l,{shape:{startAngle:g.startAngle,endAngle:g.endAngle}},c,n)):(l.shape.endAngle=g.startAngle,li(l,{shape:{endAngle:g.endAngle}},c,n))}else xu(l),li(l,{shape:m},c,n);l.useStyle(r.getItemVisual(n,"style")),To(l,o);var x=(g.startAngle+g.endAngle)/2,A=c.get("selectedOffset"),M=Math.cos(x)*A,D=Math.sin(x)*A,P=o.getShallow("cursor");P&&l.attr("cursor",P),this._updateLabel(c,r,n),l.ensureState("emphasis").shape=Lt({r:g.r+(d.get("scale")&&d.get("scaleSize")||0)},Pg(d.getModel("itemStyle"),g)),Lt(l.ensureState("select"),{x:M,y:D,shape:Pg(o.getModel(["select","itemStyle"]),g)}),Lt(l.ensureState("blur"),{shape:Pg(o.getModel(["blur","itemStyle"]),g)});var O=l.getTextGuideLine(),z=l.getTextContent();O&&Lt(O.ensureState("select"),{x:M,y:D}),Lt(z.ensureState("select"),{x:M,y:D}),da(this,d.get("focus"),d.get("blurScope"),d.get("disabled"))},e.prototype._updateLabel=function(r,n,i){var a=this,l=n.getItemModel(i),c=l.getModel("labelLine"),o=n.getItemVisual(i,"style"),d=o&&o.fill,g=o&&o.opacity;Ao(a,to(l),{labelFetcher:n.hostModel,labelDataIndex:i,inheritColor:d,defaultOpacity:g,defaultText:r.getFormattedLabel(i,"normal")||n.getName(i)});var m=a.getTextContent();a.setTextConfig({position:null,rotation:null}),m.attr({z2:10});var y=r.get(["label","position"]);if(y!=="outside"&&y!=="outer")a.removeTextGuideLine();else{var x=this.getTextGuideLine();x||(x=new ls,this.setTextGuideLine(x)),bB(this,wB(l),{stroke:d,opacity:ac(c.get(["lineStyle","opacity"]),g,1)})}},e}(as),VMe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return e.prototype.render=function(r,n,i,a){var l=r.getData(),c=this._data,o=this.group,d;if(!c&&l.count()>0){for(var g=l.getItemLayout(0),m=1;isNaN(g&&g.startAngle)&&m<l.count();++m)g=l.getItemLayout(m);g&&(d=g.startAngle)}if(this._emptyCircleSector&&o.remove(this._emptyCircleSector),l.count()===0&&r.get("showEmptyCircle")){var y=new as({shape:CK(r,i)});y.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=y,o.add(y)}l.diff(c).add(function(x){var A=new NMe(l,x,d);l.setItemGraphicEl(x,A),o.add(A)}).update(function(x,A){var M=c.getItemGraphicEl(A);M.updateData(l,x,d),M.off("click"),o.add(M),l.setItemGraphicEl(x,M)}).remove(function(x){var A=c.getItemGraphicEl(x);W1(A,r,x)}).execute(),FMe(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=l)},e.prototype.dispose=function(){},e.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var l=r[0]-a.cx,c=r[1]-a.cy,o=Math.sqrt(l*l+c*c);return o<=a.r&&o>=a.r0}},e.type="pie",e}(Oi);function _y(t,e,r){e=Ht(e)&&{coordDimensions:e}||Lt({encodeDefine:t.getEncode()},e);var n=t.getSource(),i=Lb(n,e).dimensions,a=new ts(i,t);return a.initData(n,r),a}var Vb=function(){function t(e,r){this._getDataWithEncodedVisual=e,this._getRawData=r}return t.prototype.getAllNames=function(){var e=this._getRawData();return e.mapArray(e.getName)},t.prototype.containName=function(e){var r=this._getRawData();return r.indexOfName(e)>=0},t.prototype.indexOfName=function(e){var r=this._getDataWithEncodedVisual();return r.indexOfName(e)},t.prototype.getItemVisual=function(e,r){var n=this._getDataWithEncodedVisual();return n.getItemVisual(e,r)},t}(),GMe=ri(),UMe=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.init=function(r){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new Vb(wr(this.getData,this),wr(this.getRawData,this)),this._defaultLabelLine(r)},e.prototype.mergeOption=function(){t.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return _y(this,{coordDimensions:["value"],encodeDefaulter:on(Kz,this)})},e.prototype.getDataParams=function(r){var n=this.getData(),i=GMe(n),a=i.seats;if(!a){var l=[];n.each(n.mapDimension("value"),function(o){l.push(o)}),a=i.seats=Dxe(l,n.hostModel.get("percentPrecision"))}var c=t.prototype.getDataParams.call(this,r);return c.percent=a[r]||0,c.$vars.push("percent"),c},e.prototype._defaultLabelLine=function(r){Jg(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},e.type="series.pie",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(Wi);function $Me(t){return{seriesType:t,reset:function(e,r){var n=e.getData();n.filterSelf(function(i){var a=n.mapDimension("value"),l=n.get(a,i);return!(ii(l)&&!isNaN(l)&&l<0)})}}}function HMe(t){t.registerChartView(VMe),t.registerSeriesModel(UMe),YX("pie",t.registerAction),t.registerLayout(on(OMe,"pie")),t.registerProcessor(Nb("pie")),t.registerProcessor($Me("pie"))}var jMe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.hasSymbolVisual=!0,r}return e.prototype.getInitialData=function(r,n){return Mh(null,this,{useEncodeDefaulter:!0})},e.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?5e3:this.get("progressive"))},e.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?1e4:this.get("progressiveThreshold"))},e.prototype.brushSelector=function(r,n,i){return i.point(n.getItemLayout(r))},e.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},e.type="series.scatter",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},e}(Wi),IK=4,WMe=function(){function t(){}return t}(),ZMe=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n._off=0,n.hoverDataIdx=-1,n}return e.prototype.getDefaultShape=function(){return new WMe},e.prototype.reset=function(){this.notClear=!1,this._off=0},e.prototype.buildPath=function(r,n){var i=n.points,a=n.size,l=this.symbolProxy,c=l.shape,o=r.getContext?r.getContext():r,d=o&&a[0]<IK,g=this.softClipShape,m;if(d){this._ctx=o;return}for(this._ctx=null,m=this._off;m<i.length;){var y=i[m++],x=i[m++];isNaN(y)||isNaN(x)||g&&!g.contain(y,x)||(c.x=y-a[0]/2,c.y=x-a[1]/2,c.width=a[0],c.height=a[1],l.buildPath(r,c,!0))}this.incremental&&(this._off=m,this.notClear=!0)},e.prototype.afterBrush=function(){var r=this.shape,n=r.points,i=r.size,a=this._ctx,l=this.softClipShape,c;if(a){for(c=this._off;c<n.length;){var o=n[c++],d=n[c++];isNaN(o)||isNaN(d)||l&&!l.contain(o,d)||a.fillRect(o-i[0]/2,d-i[1]/2,i[0],i[1])}this.incremental&&(this._off=c,this.notClear=!0)}},e.prototype.findDataIndex=function(r,n){for(var i=this.shape,a=i.points,l=i.size,c=Math.max(l[0],4),o=Math.max(l[1],4),d=a.length/2-1;d>=0;d--){var g=d*2,m=a[g]-c/2,y=a[g+1]-o/2;if(r>=m&&n>=y&&r<=m+c&&n<=y+o)return d}return-1},e.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(r=i[0],n=i[1],a.contain(r,n)){var l=this.hoverDataIdx=this.findDataIndex(r,n);return l>=0}return this.hoverDataIdx=-1,!1},e.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var n=this.shape,i=n.points,a=n.size,l=a[0],c=a[1],o=1/0,d=1/0,g=-1/0,m=-1/0,y=0;y<i.length;){var x=i[y++],A=i[y++];o=Math.min(x,o),g=Math.max(x,g),d=Math.min(A,d),m=Math.max(A,m)}r=this._rect=new gn(o-l/2,d-c/2,g-o+l,m-d+c)}return r},e}(kn),qMe=function(){function t(){this.group=new jr}return t.prototype.updateData=function(e,r){this._clear();var n=this._create();n.setShape({points:e.getLayout("points")}),this._setCommon(n,e,r)},t.prototype.updateLayout=function(e){var r=e.getLayout("points");this.group.eachChild(function(n){if(n.startIndex!=null){var i=(n.endIndex-n.startIndex)*2,a=n.startIndex*4*2;r=new Float32Array(r.buffer,a,i)}n.setShape("points",r),n.reset()})},t.prototype.incrementalPrepareUpdate=function(e){this._clear()},t.prototype.incrementalUpdate=function(e,r,n){var i=this._newAdded[0],a=r.getLayout("points"),l=i&&i.shape.points;if(l&&l.length<2e4){var c=l.length,o=new Float32Array(c+a.length);o.set(l),o.set(a,c),i.endIndex=e.end,i.setShape({points:o})}else{this._newAdded=[];var d=this._create();d.startIndex=e.start,d.endIndex=e.end,d.incremental=!0,d.setShape({points:a}),this._setCommon(d,r,n)}},t.prototype.eachRendered=function(e){this._newAdded[0]&&e(this._newAdded[0])},t.prototype._create=function(){var e=new ZMe({cursor:"default"});return e.ignoreCoarsePointer=!0,this.group.add(e),this._newAdded.push(e),e},t.prototype._setCommon=function(e,r,n){var i=r.hostModel;n=n||{};var a=r.getVisual("symbolSize");e.setShape("size",a instanceof Array?a:[a,a]),e.softClipShape=n.clipShape||null,e.symbolProxy=Ia(r.getVisual("symbol"),0,0,0,0),e.setColor=e.symbolProxy.setColor;var l=e.shape.size[0]<IK;e.useStyle(i.getModel("itemStyle").getItemStyle(l?["color","shadowBlur","shadowColor"]:["color"]));var c=r.getVisual("style"),o=c&&c.fill;o&&e.setColor(o);var d=Yr(e);d.seriesIndex=i.seriesIndex,e.on("mousemove",function(g){d.dataIndex=null;var m=e.hoverDataIdx;m>=0&&(d.dataIndex=m+(e.startIndex||0))})},t.prototype.remove=function(){this._clear()},t.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},t}(),YMe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=r.getData(),l=this._updateSymbolDraw(a,r);l.updateData(a,{clipShape:this._getClipShape(r)}),this._finished=!0},e.prototype.incrementalPrepareRender=function(r,n,i){var a=r.getData(),l=this._updateSymbolDraw(a,r);l.incrementalPrepareUpdate(a),this._finished=!1},e.prototype.incrementalRender=function(r,n,i){this._symbolDraw.incrementalUpdate(r,n.getData(),{clipShape:this._getClipShape(n)}),this._finished=r.end===n.getData().count()},e.prototype.updateTransform=function(r,n,i){var a=r.getData();if(this.group.dirty(),!this._finished||a.count()>1e4)return{update:!0};var l=Fb("").reset(r,n,i);l.progress&&l.progress({start:0,end:a.count(),count:a.count()},a),this._symbolDraw.updateLayout(a)},e.prototype.eachRendered=function(r){this._symbolDraw&&this._symbolDraw.eachRendered(r)},e.prototype._getClipShape=function(r){if(r.get("clip",!0)){var n=r.coordinateSystem;return n&&n.getArea&&n.getArea(.1)}},e.prototype._updateSymbolDraw=function(r,n){var i=this._symbolDraw,a=n.pipelineContext,l=a.large;return(!i||l!==this._isLargeDraw)&&(i&&i.remove(),i=this._symbolDraw=l?new qMe:new zb,this._isLargeDraw=l,this.group.removeAll()),this.group.add(i.group),i},e.prototype.remove=function(r,n){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},e.prototype.dispose=function(){},e.type="scatter",e}(Oi),XMe=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},e}($n),bO=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",Ma).models[0]},e.type="cartesian2dAxis",e}($n);Ea(bO,kb);var EK={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},QMe=pn({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},EK),EB=pn({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},EK),KMe=pn({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},EB),JMe=Fr({logBase:10},EB);const DK={category:QMe,value:EB,time:KMe,log:JMe};var eIe={value:1,category:1,time:1,log:1};function q_(t,e,r,n){fe(eIe,function(i,a){var l=pn(pn({},DK[a],!0),n,!0),c=function(o){et(d,o);function d(){var g=o!==null&&o.apply(this,arguments)||this;return g.type=e+"Axis."+a,g}return d.prototype.mergeDefaultAndTheme=function(g,m){var y=q1(this),x=y?dy(g):{},A=m.getTheme();pn(g,A.get(a+"Axis")),pn(g,this.getDefaultOption()),g.type=z$(g),y&&_d(g,x,y)},d.prototype.optionUpdated=function(){var g=this.option;g.type==="category"&&(this.__ordinalMeta=pO.createByAxisModel(this))},d.prototype.getCategories=function(g){var m=this.option;if(m.type==="category")return g?m.data:this.__ordinalMeta.categories},d.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},d.type=e+"Axis."+a,d.defaultOption=l,d}(r);t.registerComponentModel(c)}),t.registerSubTypeDefaulter(e+"Axis",z$)}function z$(t){return t.type||(t.data?"category":"value")}var tIe=function(){function t(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return t.prototype.getAxis=function(e){return this._axes[e]},t.prototype.getAxes=function(){return Zt(this._dimList,function(e){return this._axes[e]},this)},t.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),Ei(this.getAxes(),function(r){return r.scale.type===e})},t.prototype.addAxis=function(e){var r=e.dim;this._axes[r]=e,this._dimList.push(r)},t}(),wO=["x","y"];function B$(t){return t.type==="interval"||t.type==="time"}var rIe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="cartesian2d",r.dimensions=wO,r}return e.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var r=this.getAxis("x").scale,n=this.getAxis("y").scale;if(!(!B$(r)||!B$(n))){var i=r.getExtent(),a=n.getExtent(),l=this.dataToPoint([i[0],a[0]]),c=this.dataToPoint([i[1],a[1]]),o=i[1]-i[0],d=a[1]-a[0];if(!(!o||!d)){var g=(c[0]-l[0])/o,m=(c[1]-l[1])/d,y=l[0]-i[0]*g,x=l[1]-a[0]*m,A=this._transform=[g,0,0,m,y,x];this._invTransform=ay([],A)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(r){var n=this.getAxis("x"),i=this.getAxis("y");return n.contain(n.toLocalCoord(r[0]))&&i.contain(i.toLocalCoord(r[1]))},e.prototype.containData=function(r){return this.getAxis("x").containData(r[0])&&this.getAxis("y").containData(r[1])},e.prototype.containZone=function(r,n){var i=this.dataToPoint(r),a=this.dataToPoint(n),l=this.getArea(),c=new gn(i[0],i[1],a[0]-i[0],a[1]-i[1]);return l.intersect(c)},e.prototype.dataToPoint=function(r,n,i){i=i||[];var a=r[0],l=r[1];if(this._transform&&a!=null&&isFinite(a)&&l!=null&&isFinite(l))return So(i,r,this._transform);var c=this.getAxis("x"),o=this.getAxis("y");return i[0]=c.toGlobalCoord(c.dataToCoord(a,n)),i[1]=o.toGlobalCoord(o.dataToCoord(l,n)),i},e.prototype.clampData=function(r,n){var i=this.getAxis("x").scale,a=this.getAxis("y").scale,l=i.getExtent(),c=a.getExtent(),o=i.parse(r[0]),d=a.parse(r[1]);return n=n||[],n[0]=Math.min(Math.max(Math.min(l[0],l[1]),o),Math.max(l[0],l[1])),n[1]=Math.min(Math.max(Math.min(c[0],c[1]),d),Math.max(c[0],c[1])),n},e.prototype.pointToData=function(r,n){var i=[];if(this._invTransform)return So(i,r,this._invTransform);var a=this.getAxis("x"),l=this.getAxis("y");return i[0]=a.coordToData(a.toLocalCoord(r[0]),n),i[1]=l.coordToData(l.toLocalCoord(r[1]),n),i},e.prototype.getOtherAxis=function(r){return this.getAxis(r.dim==="x"?"y":"x")},e.prototype.getArea=function(r){r=r||0;var n=this.getAxis("x").getGlobalExtent(),i=this.getAxis("y").getGlobalExtent(),a=Math.min(n[0],n[1])-r,l=Math.min(i[0],i[1])-r,c=Math.max(n[0],n[1])-a+r,o=Math.max(i[0],i[1])-l+r;return new gn(a,l,c,o)},e}(tIe),nIe=function(t){et(e,t);function e(r,n,i,a,l){var c=t.call(this,r,n,i)||this;return c.index=0,c.type=a||"value",c.position=l||"bottom",c}return e.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},e.prototype.getGlobalExtent=function(r){var n=this.getExtent();return n[0]=this.toGlobalCoord(n[0]),n[1]=this.toGlobalCoord(n[1]),r&&n[0]>n[1]&&n.reverse(),n},e.prototype.pointToData=function(r,n){return this.coordToData(this.toLocalCoord(r[this.dim==="x"?0:1]),n)},e.prototype.setCategorySortInfo=function(r){if(this.type!=="category")return!1;this.model.option.categorySortInfo=r,this.scale.setSortInfo(r)},e}(Tu);function SO(t,e,r){r=r||{};var n=t.coordinateSystem,i=e.axis,a={},l=i.getAxesOnZeroOf()[0],c=i.position,o=l?"onZero":c,d=i.dim,g=n.getRect(),m=[g.x,g.x+g.width,g.y,g.y+g.height],y={left:0,right:1,top:0,bottom:1,onZero:2},x=e.get("offset")||0,A=d==="x"?[m[2]-x,m[3]+x]:[m[0]-x,m[1]+x];if(l){var M=l.toGlobalCoord(l.dataToCoord(0));A[y.onZero]=Math.max(Math.min(M,A[1]),A[0])}a.position=[d==="y"?A[y[o]]:m[0],d==="x"?A[y[o]]:m[3]],a.rotation=Math.PI/2*(d==="x"?0:1);var D={top:-1,bottom:1,left:-1,right:1};a.labelDirection=a.tickDirection=a.nameDirection=D[c],a.labelOffset=l?A[y[c]]-A[y.onZero]:0,e.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),ho(r.labelInside,e.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var P=e.get(["axisLabel","rotate"]);return a.labelRotate=o==="top"?-P:P,a.z2=1,a}function F$(t){return t.get("coordinateSystem")==="cartesian2d"}function N$(t){var e={xAxisModel:null,yAxisModel:null};return fe(e,function(r,n){var i=n.replace(/Model$/,""),a=t.getReferringComponents(i,Ma).models[0];e[n]=a}),e}var EL=Math.log;function PK(t,e,r){var n=_h.prototype,i=n.getTicks.call(r),a=n.getTicks.call(r,!0),l=i.length-1,c=n.getInterval.call(r),o=zQ(t,e),d=o.extent,g=o.fixMin,m=o.fixMax;if(t.type==="log"){var y=EL(t.base);d=[EL(d[0])/y,EL(d[1])/y]}t.setExtent(d[0],d[1]),t.calcNiceExtent({splitNumber:l,fixMin:g,fixMax:m});var x=n.getExtent.call(t);g&&(d[0]=x[0]),m&&(d[1]=x[1]);var A=n.getInterval.call(t),M=d[0],D=d[1];if(g&&m)A=(D-M)/l;else if(g)for(D=d[0]+A*l;D<d[1]&&isFinite(D)&&isFinite(d[1]);)A=pL(A),D=d[0]+A*l;else if(m)for(M=d[1]-A*l;M>d[0]&&isFinite(M)&&isFinite(d[0]);)A=pL(A),M=d[1]-A*l;else{var P=t.getTicks().length-1;P>l&&(A=pL(A));var O=A*l;D=Math.ceil(d[1]/A)*A,M=ma(D-O),M<0&&d[0]>=0?(M=0,D=ma(O)):D>0&&d[1]<=0&&(D=0,M=-ma(O))}var z=(i[0].value-a[0].value)/c,V=(i[l].value-a[l].value)/c;n.setExtent.call(t,M+A*z,D+A*V),n.setInterval.call(t,A),(z||V)&&n.setNiceExtent.call(t,M+A,D-A)}var iIe=function(){function t(e,r,n){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=wO,this._initCartesian(e,r,n),this.model=e}return t.prototype.getRect=function(){return this._rect},t.prototype.update=function(e,r){var n=this._axesMap;this._updateScale(e,this.model);function i(l){var c,o=Hn(l),d=o.length;if(d){for(var g=[],m=d-1;m>=0;m--){var y=+o[m],x=l[y],A=x.model,M=x.scale;gO(M)&&A.get("alignTicks")&&A.get("interval")==null?g.push(x):(W_(M,A),gO(M)&&(c=x))}g.length&&(c||(c=g.pop(),W_(c.scale,c.model)),fe(g,function(D){PK(D.scale,D.model,c.scale)}))}}i(n.x),i(n.y);var a={};fe(n.x,function(l){V$(n,"y",l,a)}),fe(n.y,function(l){V$(n,"x",l,a)}),this.resize(this.model,r)},t.prototype.resize=function(e,r,n){var i=e.getBoxLayoutParams(),a=!n&&e.get("containLabel"),l=Na(i,{width:r.getWidth(),height:r.getHeight()});this._rect=l;var c=this._axesList;o(),a&&(fe(c,function(d){if(!d.model.get(["axisLabel","inside"])){var g=FAe(d);if(g){var m=d.isHorizontal()?"height":"width",y=d.model.get(["axisLabel","margin"]);l[m]-=g[m]+y,d.position==="top"?l.y+=g.height+y:d.position==="left"&&(l.x+=g.width+y)}}}),o()),fe(this._coordsList,function(d){d.calcAffineTransform()});function o(){fe(c,function(d){var g=d.isHorizontal(),m=g?[0,l.width]:[0,l.height],y=d.inverse?1:0;d.setExtent(m[y],m[1-y]),aIe(d,g?l.x:l.y)})}},t.prototype.getAxis=function(e,r){var n=this._axesMap[e];if(n!=null)return n[r||0]},t.prototype.getAxes=function(){return this._axesList.slice()},t.prototype.getCartesian=function(e,r){if(e!=null&&r!=null){var n="x"+e+"y"+r;return this._coordsMap[n]}Ur(e)&&(r=e.yAxisIndex,e=e.xAxisIndex);for(var i=0,a=this._coordsList;i<a.length;i++)if(a[i].getAxis("x").index===e||a[i].getAxis("y").index===r)return a[i]},t.prototype.getCartesians=function(){return this._coordsList.slice()},t.prototype.convertToPixel=function(e,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},t.prototype.convertFromPixel=function(e,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},t.prototype._findConvertTarget=function(e){var r=e.seriesModel,n=e.xAxisModel||r&&r.getReferringComponents("xAxis",Ma).models[0],i=e.yAxisModel||r&&r.getReferringComponents("yAxis",Ma).models[0],a=e.gridModel,l=this._coordsList,c,o;if(r)c=r.coordinateSystem,An(l,c)<0&&(c=null);else if(n&&i)c=this.getCartesian(n.componentIndex,i.componentIndex);else if(n)o=this.getAxis("x",n.componentIndex);else if(i)o=this.getAxis("y",i.componentIndex);else if(a){var d=a.coordinateSystem;d===this&&(c=this._coordsList[0])}return{cartesian:c,axis:o}},t.prototype.containPoint=function(e){var r=this._coordsList[0];if(r)return r.containPoint(e)},t.prototype._initCartesian=function(e,r,n){var i=this,a=this,l={left:!1,right:!1,top:!1,bottom:!1},c={x:{},y:{}},o={x:0,y:0};if(r.eachComponent("xAxis",d("x"),this),r.eachComponent("yAxis",d("y"),this),!o.x||!o.y){this._axesMap={},this._axesList=[];return}this._axesMap=c,fe(c.x,function(g,m){fe(c.y,function(y,x){var A="x"+m+"y"+x,M=new rIe(A);M.master=i,M.model=e,i._coordsMap[A]=M,i._coordsList.push(M),M.addAxis(g),M.addAxis(y)})});function d(g){return function(m,y){if(DL(m,e)){var x=m.get("position");g==="x"?x!=="top"&&x!=="bottom"&&(x=l.bottom?"top":"bottom"):x!=="left"&&x!=="right"&&(x=l.left?"right":"left"),l[x]=!0;var A=new nIe(g,II(m),[0,0],m.get("type"),x),M=A.type==="category";A.onBand=M&&m.get("boundaryGap"),A.inverse=m.get("inverse"),m.axis=A,A.model=m,A.grid=a,A.index=y,a._axesList.push(A),c[g][y]=A,o[g]++}}}},t.prototype._updateScale=function(e,r){fe(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var a=i.model.get("categorySortInfo");i.scale.setSortInfo(a)}}),e.eachSeries(function(i){if(F$(i)){var a=N$(i),l=a.xAxisModel,c=a.yAxisModel;if(!DL(l,r)||!DL(c,r))return;var o=this.getCartesian(l.componentIndex,c.componentIndex),d=i.getData(),g=o.getAxis("x"),m=o.getAxis("y");n(d,g),n(d,m)}},this);function n(i,a){fe(ZC(i,a.dim),function(l){a.scale.unionExtentFromData(i,l)})}},t.prototype.getTooltipAxes=function(e){var r=[],n=[];return fe(this.getCartesians(),function(i){var a=e!=null&&e!=="auto"?i.getAxis(e):i.getBaseAxis(),l=i.getOtherAxis(a);An(r,a)<0&&r.push(a),An(n,l)<0&&n.push(l)}),{baseAxes:r,otherAxes:n}},t.create=function(e,r){var n=[];return e.eachComponent("grid",function(i,a){var l=new t(i,e,r);l.name="grid_"+a,l.resize(i,r,!0),i.coordinateSystem=l,n.push(l)}),e.eachSeries(function(i){if(F$(i)){var a=N$(i),l=a.xAxisModel,c=a.yAxisModel,o=l.getCoordSysModel(),d=o.coordinateSystem;i.coordinateSystem=d.getCartesian(l.componentIndex,c.componentIndex)}}),n},t.dimensions=wO,t}();function DL(t,e){return t.getCoordSysModel()===e}function V$(t,e,r,n){r.getAxesOnZeroOf=function(){return a?[a]:[]};var i=t[e],a,l=r.model,c=l.get(["axisLine","onZero"]),o=l.get(["axisLine","onZeroAxisIndex"]);if(!c)return;if(o!=null)G$(i[o])&&(a=i[o]);else for(var d in i)if(i.hasOwnProperty(d)&&G$(i[d])&&!n[g(i[d])]){a=i[d];break}a&&(n[g(a)]=!0);function g(m){return m.dim+"_"+m.index}}function G$(t){return t&&t.type!=="category"&&t.type!=="time"&&BAe(t)}function aIe(t,e){var r=t.getExtent(),n=r[0]+r[1];t.toGlobalCoord=t.dim==="x"?function(i){return i+e}:function(i){return n-i+e},t.toLocalCoord=t.dim==="x"?function(i){return i-e}:function(i){return n-i+e}}var td=Math.PI,rs=function(){function t(e,r){this.group=new jr,this.opt=r,this.axisModel=e,Fr(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var n=new jr({x:r.position[0],y:r.position[1],rotation:r.rotation});n.updateTransform(),this._transformGroup=n}return t.prototype.hasBuilder=function(e){return!!U$[e]},t.prototype.add=function(e){U$[e](this.opt,this.axisModel,this.group,this._transformGroup)},t.prototype.getGroup=function(){return this.group},t.innerTextLayout=function(e,r,n){var i=q2(r-e),a,l;return U1(i)?(l=n>0?"top":"bottom",a="center"):U1(i-td)?(l=n>0?"bottom":"top",a="center"):(l="middle",i>0&&i<td?a=n>0?"right":"left":a=n>0?"left":"right"),{rotation:i,textAlign:a,textVerticalAlign:l}},t.makeAxisEventDataBase=function(e){var r={componentType:e.mainType,componentIndex:e.componentIndex};return r[e.mainType+"Index"]=e.componentIndex,r},t.isLabelSilent=function(e){var r=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||r&&r.show)},t}(),U$={axisLine:function(t,e,r,n){var i=e.get(["axisLine","show"]);if(i==="auto"&&t.handleAutoShown&&(i=t.handleAutoShown("axisLine")),!!i){var a=e.axis.getExtent(),l=n.transform,c=[a[0],0],o=[a[1],0],d=c[0]>o[0];l&&(So(c,c,l),So(o,o,l));var g=Lt({lineCap:"round"},e.getModel(["axisLine","lineStyle"]).getLineStyle()),m=new Ka({shape:{x1:c[0],y1:c[1],x2:o[0],y2:o[1]},style:g,strokeContainThreshold:t.strokeContainThreshold||5,silent:!0,z2:1});$_(m.shape,m.style.lineWidth),m.anid="line",r.add(m);var y=e.get(["axisLine","symbol"]);if(y!=null){var x=e.get(["axisLine","symbolSize"]);yr(y)&&(y=[y,y]),(yr(x)||ii(x))&&(x=[x,x]);var A=dv(e.get(["axisLine","symbolOffset"])||0,x),M=x[0],D=x[1];fe([{rotate:t.rotation+Math.PI/2,offset:A[0],r:0},{rotate:t.rotation-Math.PI/2,offset:A[1],r:Math.sqrt((c[0]-o[0])*(c[0]-o[0])+(c[1]-o[1])*(c[1]-o[1]))}],function(P,O){if(y[O]!=="none"&&y[O]!=null){var z=Ia(y[O],-M/2,-D/2,M,D,g.stroke,!0),V=P.r+P.offset,H=d?o:c;z.attr({rotation:P.rotate,x:H[0]+V*Math.cos(t.rotation),y:H[1]-V*Math.sin(t.rotation),silent:!0,z2:11}),r.add(z)}})}}},axisTickLabel:function(t,e,r,n){var i=lIe(r,n,e,t),a=cIe(r,n,e,t);if(sIe(e,a,i),uIe(r,n,e,t.tickDirection),e.get(["axisLabel","hideOverlap"])){var l=YQ(Zt(a,function(c){return{label:c,priority:c.z2,defaultAttr:{ignore:c.ignore}}}));KQ(l)}},axisName:function(t,e,r,n){var i=ho(t.axisName,e.get("name"));if(i){var a=e.get("nameLocation"),l=t.nameDirection,c=e.getModel("nameTextStyle"),o=e.get("nameGap")||0,d=e.axis.getExtent(),g=d[0]>d[1]?-1:1,m=[a==="start"?d[0]-g*o:a==="end"?d[1]+g*o:(d[0]+d[1])/2,H$(a)?t.labelOffset+l*o:0],y,x=e.get("nameRotate");x!=null&&(x=x*td/180);var A;H$(a)?y=rs.innerTextLayout(t.rotation,x??t.rotation,l):(y=oIe(t.rotation,a,x||0,d),A=t.axisNameAvailableWidth,A!=null&&(A=Math.abs(A/Math.sin(y.rotation)),!isFinite(A)&&(A=null)));var M=c.getFont(),D=e.get("nameTruncate",!0)||{},P=D.ellipsis,O=ho(t.nameTruncateMaxWidth,D.maxWidth,A),z=new ti({x:m[0],y:m[1],rotation:y.rotation,silent:rs.isLabelSilent(e),style:Hi(c,{text:i,font:M,overflow:"truncate",width:O,ellipsis:P,fill:c.getTextColor()||e.get(["axisLine","lineStyle","color"]),align:c.get("align")||y.textAlign,verticalAlign:c.get("verticalAlign")||y.textVerticalAlign}),z2:1});if(uy({el:z,componentModel:e,itemName:i}),z.__fullText=i,z.anid="name",e.get("triggerEvent")){var V=rs.makeAxisEventDataBase(e);V.targetType="axisName",V.name=i,Yr(z).eventData=V}n.add(z),z.updateTransform(),r.add(z),z.decomposeTransform()}}};function oIe(t,e,r,n){var i=q2(r-t),a,l,c=n[0]>n[1],o=e==="start"&&!c||e!=="start"&&c;return U1(i-td/2)?(l=o?"bottom":"top",a="center"):U1(i-td*1.5)?(l=o?"top":"bottom",a="center"):(l="middle",i<td*1.5&&i>td/2?a=o?"left":"right":a=o?"right":"left"),{rotation:i,textAlign:a,textVerticalAlign:l}}function sIe(t,e,r){if(!BQ(t.axis)){var n=t.get(["axisLabel","showMinLabel"]),i=t.get(["axisLabel","showMaxLabel"]);e=e||[],r=r||[];var a=e[0],l=e[1],c=e[e.length-1],o=e[e.length-2],d=r[0],g=r[1],m=r[r.length-1],y=r[r.length-2];n===!1?(gl(a),gl(d)):$$(a,l)&&(n?(gl(l),gl(g)):(gl(a),gl(d))),i===!1?(gl(c),gl(m)):$$(o,c)&&(i?(gl(o),gl(y)):(gl(c),gl(m)))}}function gl(t){t&&(t.ignore=!0)}function $$(t,e){var r=t&&t.getBoundingRect().clone(),n=e&&e.getBoundingRect().clone();if(!(!r||!n)){var i=eI([]);return hv(i,i,-t.rotation),r.applyTransform(oh([],i,t.getLocalTransform())),n.applyTransform(oh([],i,e.getLocalTransform())),r.intersect(n)}}function H$(t){return t==="middle"||t==="center"}function LK(t,e,r,n,i){for(var a=[],l=[],c=[],o=0;o<t.length;o++){var d=t[o].coord;l[0]=d,l[1]=0,c[0]=d,c[1]=r,e&&(So(l,l,e),So(c,c,e));var g=new Ka({shape:{x1:l[0],y1:l[1],x2:c[0],y2:c[1]},style:n,z2:2,autoBatch:!0,silent:!0});$_(g.shape,g.style.lineWidth),g.anid=i+"_"+t[o].tickValue,a.push(g)}return a}function lIe(t,e,r,n){var i=r.axis,a=r.getModel("axisTick"),l=a.get("show");if(l==="auto"&&n.handleAutoShown&&(l=n.handleAutoShown("axisTick")),!(!l||i.scale.isBlank())){for(var c=a.getModel("lineStyle"),o=n.tickDirection*a.get("length"),d=i.getTicksCoords(),g=LK(d,e.transform,o,Fr(c.getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])}),"ticks"),m=0;m<g.length;m++)t.add(g[m]);return g}}function uIe(t,e,r,n){var i=r.axis,a=r.getModel("minorTick");if(!(!a.get("show")||i.scale.isBlank())){var l=i.getMinorTicksCoords();if(l.length)for(var c=a.getModel("lineStyle"),o=n*a.get("length"),d=Fr(c.getLineStyle(),Fr(r.getModel("axisTick").getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])})),g=0;g<l.length;g++)for(var m=LK(l[g],e.transform,o,d,"minorticks_"+g),y=0;y<m.length;y++)t.add(m[y])}}function cIe(t,e,r,n){var i=r.axis,a=ho(n.axisLabelShow,r.get(["axisLabel","show"]));if(!(!a||i.scale.isBlank())){var l=r.getModel("axisLabel"),c=l.get("margin"),o=i.getViewLabels(),d=(ho(n.labelRotate,l.get("rotate"))||0)*td/180,g=rs.innerTextLayout(n.rotation,d,n.labelDirection),m=r.getCategories&&r.getCategories(!0),y=[],x=rs.isLabelSilent(r),A=r.get("triggerEvent");return fe(o,function(M,D){var P=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(M.tickValue):M.tickValue,O=M.formattedLabel,z=M.rawLabel,V=l;if(m&&m[P]){var H=m[P];Ur(H)&&H.textStyle&&(V=new bi(H.textStyle,l,r.ecModel))}var $=V.getTextColor()||r.get(["axisLine","lineStyle","color"]),X=i.dataToCoord(P),W=V.getShallow("align",!0)||g.textAlign,Y=tn(V.getShallow("alignMinLabel",!0),W),J=tn(V.getShallow("alignMaxLabel",!0),W),re=V.getShallow("verticalAlign",!0)||V.getShallow("baseline",!0)||g.textVerticalAlign,ae=tn(V.getShallow("verticalAlignMinLabel",!0),re),pe=tn(V.getShallow("verticalAlignMaxLabel",!0),re),de=new ti({x:X,y:n.labelOffset+n.labelDirection*c,rotation:g.rotation,silent:x,z2:10+(M.level||0),style:Hi(V,{text:O,align:D===0?Y:D===o.length-1?J:W,verticalAlign:D===0?ae:D===o.length-1?pe:re,fill:zr($)?$(i.type==="category"?z:i.type==="value"?P+"":P,D):$})});if(de.anid="label_"+P,A){var ve=rs.makeAxisEventDataBase(r);ve.targetType="axisLabel",ve.value=z,ve.tickIndex=D,i.type==="category"&&(ve.dataIndex=P),Yr(de).eventData=ve}e.add(de),de.updateTransform(),y.push(de),t.add(de),de.decomposeTransform()}),y}}function hIe(t,e){var r={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return fIe(r,t,e),r.seriesInvolved&&pIe(r,t),r}function fIe(t,e,r){var n=e.getComponent("tooltip"),i=e.getComponent("axisPointer"),a=i.get("link",!0)||[],l=[];fe(r.getCoordinateSystems(),function(c){if(!c.axisPointerEnabled)return;var o=nb(c.model),d=t.coordSysAxesInfo[o]={};t.coordSysMap[o]=c;var g=c.model,m=g.getModel("tooltip",n);if(fe(c.getAxes(),on(M,!1,null)),c.getTooltipAxes&&n&&m.get("show")){var y=m.get("trigger")==="axis",x=m.get(["axisPointer","type"])==="cross",A=c.getTooltipAxes(m.get(["axisPointer","axis"]));(y||x)&&fe(A.baseAxes,on(M,x?"cross":!0,y)),x&&fe(A.otherAxes,on(M,"cross",!1))}function M(D,P,O){var z=O.model.getModel("axisPointer",i),V=z.get("show");if(!(!V||V==="auto"&&!D&&!TO(z))){P==null&&(P=z.get("triggerTooltip")),z=D?dIe(O,m,i,e,D,P):z;var H=z.get("snap"),$=z.get("triggerEmphasis"),X=nb(O.model),W=P||H||O.type==="category",Y=t.axesInfo[X]={key:X,axis:O,coordSys:c,axisPointerModel:z,triggerTooltip:P,triggerEmphasis:$,involveSeries:W,snap:H,useHandle:TO(z),seriesModels:[],linkGroup:null};d[X]=Y,t.seriesInvolved=t.seriesInvolved||W;var J=gIe(a,O);if(J!=null){var re=l[J]||(l[J]={axesInfo:{}});re.axesInfo[X]=Y,re.mapper=a[J].mapper,Y.linkGroup=re}}}})}function dIe(t,e,r,n,i,a){var l=e.getModel("axisPointer"),c=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],o={};fe(c,function(y){o[y]=$r(l.get(y))}),o.snap=t.type!=="category"&&!!a,l.get("type")==="cross"&&(o.type="line");var d=o.label||(o.label={});if(d.show==null&&(d.show=!1),i==="cross"){var g=l.get(["label","show"]);if(d.show=g??!0,!a){var m=o.lineStyle=l.get("crossStyle");m&&Fr(d,m.textStyle)}}return t.model.getModel("axisPointer",new bi(o,r,n))}function pIe(t,e){e.eachSeries(function(r){var n=r.coordinateSystem,i=r.get(["tooltip","trigger"],!0),a=r.get(["tooltip","show"],!0);!n||i==="none"||i===!1||i==="item"||a===!1||r.get(["axisPointer","show"],!0)===!1||fe(t.coordSysAxesInfo[nb(n.model)],function(l){var c=l.axis;n.getAxis(c.dim)===c&&(l.seriesModels.push(r),l.seriesDataCount==null&&(l.seriesDataCount=0),l.seriesDataCount+=r.getData().count())})})}function gIe(t,e){for(var r=e.model,n=e.dim,i=0;i<t.length;i++){var a=t[i]||{};if(PL(a[n+"AxisId"],r.id)||PL(a[n+"AxisIndex"],r.componentIndex)||PL(a[n+"AxisName"],r.name))return i}}function PL(t,e){return t==="all"||Ht(t)&&An(t,e)>=0||t===e}function vIe(t){var e=DB(t);if(e){var r=e.axisPointerModel,n=e.axis.scale,i=r.option,a=r.get("status"),l=r.get("value");l!=null&&(l=n.parse(l));var c=TO(r);a==null&&(i.status=c?"show":"hide");var o=n.getExtent().slice();o[0]>o[1]&&o.reverse(),(l==null||l>o[1])&&(l=o[1]),l<o[0]&&(l=o[0]),i.value=l,c&&(i.status=e.axis.scale.isBlank()?"hide":"show")}}function DB(t){var e=(t.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[nb(t)]}function mIe(t){var e=DB(t);return e&&e.axisPointerModel}function TO(t){return!!t.get(["handle","show"])}function nb(t){return t.type+"||"+t.id}var j$={},vv=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i,a){this.axisPointerClass&&vIe(r),t.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(r,i,!0)},e.prototype.updateAxisPointer=function(r,n,i,a){this._doUpdateAxisPointerClass(r,i,!1)},e.prototype.remove=function(r,n){var i=this._axisPointer;i&&i.remove(n)},e.prototype.dispose=function(r,n){this._disposeAxisPointer(n),t.prototype.dispose.apply(this,arguments)},e.prototype._doUpdateAxisPointerClass=function(r,n,i){var a=e.getAxisPointerClass(this.axisPointerClass);if(a){var l=mIe(r);l?(this._axisPointer||(this._axisPointer=new a)).render(r,l,n,i):this._disposeAxisPointer(n)}},e.prototype._disposeAxisPointer=function(r){this._axisPointer&&this._axisPointer.dispose(r),this._axisPointer=null},e.registerAxisPointerClass=function(r,n){j$[r]=n},e.getAxisPointerClass=function(r){return r&&j$[r]},e.type="axis",e}(ra),AO=ri();function RK(t,e,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitArea"),l=a.getModel("areaStyle"),c=l.get("color"),o=n.coordinateSystem.getRect(),d=i.getTicksCoords({tickModel:a,clamp:!0});if(d.length){var g=c.length,m=AO(t).splitAreaColors,y=Ir(),x=0;if(m)for(var A=0;A<d.length;A++){var M=m.get(d[A].tickValue);if(M!=null){x=(M+(g-1)*A)%g;break}}var D=i.toGlobalCoord(d[0].coord),P=l.getAreaStyle();c=Ht(c)?c:[c];for(var A=1;A<d.length;A++){var O=i.toGlobalCoord(d[A].coord),z=void 0,V=void 0,H=void 0,$=void 0;i.isHorizontal()?(z=D,V=o.y,H=O-z,$=o.height,D=z+H):(z=o.x,V=D,H=o.width,$=O-V,D=V+$);var X=d[A-1].tickValue;X!=null&&y.set(X,x),e.add(new Kn({anid:X!=null?"area_"+X:null,shape:{x:z,y:V,width:H,height:$},style:Fr({fill:c[x]},P),autoBatch:!0,silent:!0})),x=(x+1)%g}AO(t).splitAreaColors=y}}}function kK(t){AO(t).splitAreaColors=null}var _Ie=["axisLine","axisTickLabel","axisName"],yIe=["splitArea","splitLine","minorSplitLine"],OK=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.axisPointerClass="CartesianAxisPointer",r}return e.prototype.render=function(r,n,i,a){this.group.removeAll();var l=this._axisGroup;if(this._axisGroup=new jr,this.group.add(this._axisGroup),!!r.get("show")){var c=r.getCoordSysModel(),o=SO(c,r),d=new rs(r,Lt({handleAutoShown:function(m){for(var y=c.coordinateSystem.getCartesians(),x=0;x<y.length;x++)if(gO(y[x].getOtherAxis(r.axis).scale))return!0;return!1}},o));fe(_Ie,d.add,d),this._axisGroup.add(d.getGroup()),fe(yIe,function(m){r.get([m,"show"])&&xIe[m](this,this._axisGroup,r,c)},this);var g=a&&a.type==="changeAxisOrder"&&a.isInitSort;g||Ib(l,this._axisGroup,r),t.prototype.render.call(this,r,n,i,a)}},e.prototype.remove=function(){kK(this)},e.type="cartesianAxis",e}(vv),xIe={splitLine:function(t,e,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitLine"),l=a.getModel("lineStyle"),c=l.get("color");c=Ht(c)?c:[c];for(var o=n.coordinateSystem.getRect(),d=i.isHorizontal(),g=0,m=i.getTicksCoords({tickModel:a}),y=[],x=[],A=l.getLineStyle(),M=0;M<m.length;M++){var D=i.toGlobalCoord(m[M].coord);d?(y[0]=D,y[1]=o.y,x[0]=D,x[1]=o.y+o.height):(y[0]=o.x,y[1]=D,x[0]=o.x+o.width,x[1]=D);var P=g++%c.length,O=m[M].tickValue,z=new Ka({anid:O!=null?"line_"+m[M].tickValue:null,autoBatch:!0,shape:{x1:y[0],y1:y[1],x2:x[0],y2:x[1]},style:Fr({stroke:c[P]},A),silent:!0});$_(z.shape,A.lineWidth),e.add(z)}}},minorSplitLine:function(t,e,r,n){var i=r.axis,a=r.getModel("minorSplitLine"),l=a.getModel("lineStyle"),c=n.coordinateSystem.getRect(),o=i.isHorizontal(),d=i.getMinorTicksCoords();if(d.length)for(var g=[],m=[],y=l.getLineStyle(),x=0;x<d.length;x++)for(var A=0;A<d[x].length;A++){var M=i.toGlobalCoord(d[x][A].coord);o?(g[0]=M,g[1]=c.y,m[0]=M,m[1]=c.y+c.height):(g[0]=c.x,g[1]=M,m[0]=c.x+c.width,m[1]=M);var D=new Ka({anid:"minor_line_"+d[x][A].tickValue,autoBatch:!0,shape:{x1:g[0],y1:g[1],x2:m[0],y2:m[1]},style:y,silent:!0});$_(D.shape,y.lineWidth),e.add(D)}},splitArea:function(t,e,r,n){RK(t,e,r,n)}},zK=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="xAxis",e}(OK),bIe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=zK.type,r}return e.type="yAxis",e}(OK),wIe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="grid",r}return e.prototype.render=function(r,n){this.group.removeAll(),r.get("show")&&this.group.add(new Kn({shape:r.coordinateSystem.getRect(),style:Fr({fill:r.get("backgroundColor")},r.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}(ra),W$={offset:0};function BK(t){t.registerComponentView(wIe),t.registerComponentModel(XMe),t.registerCoordinateSystem("cartesian2d",iIe),q_(t,"x",bO,W$),q_(t,"y",bO,W$),t.registerComponentView(zK),t.registerComponentView(bIe),t.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})}function SIe(t){En(BK),t.registerSeriesModel(jMe),t.registerChartView(YMe),t.registerLayout(Fb("scatter"))}function TIe(t){t.eachSeriesByType("radar",function(e){var r=e.getData(),n=[],i=e.coordinateSystem;if(i){var a=i.getIndicatorAxes();fe(a,function(l,c){r.each(r.mapDimension(a[c].dim),function(o,d){n[d]=n[d]||[];var g=i.dataToPoint(o,c);n[d][c]=Z$(g)?g:q$(i)})}),r.each(function(l){var c=s0e(n[l],function(o){return Z$(o)})||q$(i);n[l].push(c.slice()),r.setItemLayout(l,n[l])})}})}function Z$(t){return!isNaN(t[0])&&!isNaN(t[1])}function q$(t){return[t.cx,t.cy]}function AIe(t){var e=t.polar;if(e){Ht(e)||(e=[e]);var r=[];fe(e,function(n,i){n.indicator?(n.type&&!n.shape&&(n.shape=n.type),t.radar=t.radar||[],Ht(t.radar)||(t.radar=[t.radar]),t.radar.push(n)):r.push(n)}),t.polar=r}fe(t.series,function(n){n&&n.type==="radar"&&n.polarIndex&&(n.radarIndex=n.polarIndex)})}var CIe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=r.coordinateSystem,l=this.group,c=r.getData(),o=this._data;function d(y,x){var A=y.getItemVisual(x,"symbol")||"circle";if(A!=="none"){var M=my(y.getItemVisual(x,"symbolSize")),D=Ia(A,-1,-1,2,2),P=y.getItemVisual(x,"symbolRotate")||0;return D.attr({style:{strokeNoScale:!0},z2:100,scaleX:M[0]/2,scaleY:M[1]/2,rotation:P*Math.PI/180||0}),D}}function g(y,x,A,M,D,P){A.removeAll();for(var O=0;O<x.length-1;O++){var z=d(M,D);z&&(z.__dimIdx=O,y[O]?(z.setPosition(y[O]),fv[P?"initProps":"updateProps"](z,{x:x[O][0],y:x[O][1]},r,D)):z.setPosition(x[O]),A.add(z))}}function m(y){return Zt(y,function(x){return[a.cx,a.cy]})}c.diff(o).add(function(y){var x=c.getItemLayout(y);if(x){var A=new os,M=new ls,D={shape:{points:x}};A.shape.points=m(x),M.shape.points=m(x),Qi(A,D,r,y),Qi(M,D,r,y);var P=new jr,O=new jr;P.add(M),P.add(A),P.add(O),g(M.shape.points,x,O,c,y,!0),c.setItemGraphicEl(y,P)}}).update(function(y,x){var A=o.getItemGraphicEl(x),M=A.childAt(0),D=A.childAt(1),P=A.childAt(2),O={shape:{points:c.getItemLayout(y)}};O.shape.points&&(g(M.shape.points,O.shape.points,P,c,y,!1),xu(D),xu(M),li(M,O,r),li(D,O,r),c.setItemGraphicEl(y,A))}).remove(function(y){l.remove(o.getItemGraphicEl(y))}).execute(),c.eachItemGraphicEl(function(y,x){var A=c.getItemModel(x),M=y.childAt(0),D=y.childAt(1),P=y.childAt(2),O=c.getItemVisual(x,"style"),z=O.fill;l.add(y),M.useStyle(Fr(A.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:z})),To(M,A,"lineStyle"),To(D,A,"areaStyle");var V=A.getModel("areaStyle"),H=V.isEmpty()&&V.parentModel.isEmpty();D.ignore=H,fe(["emphasis","select","blur"],function(W){var Y=A.getModel([W,"areaStyle"]),J=Y.isEmpty()&&Y.parentModel.isEmpty();D.ensureState(W).ignore=J&&H}),D.useStyle(Fr(V.getAreaStyle(),{fill:z,opacity:.7,decal:O.decal}));var $=A.getModel("emphasis"),X=$.getModel("itemStyle").getItemStyle();P.eachChild(function(W){if(W instanceof fo){var Y=W.style;W.useStyle(Lt({image:Y.image,x:Y.x,y:Y.y,width:Y.width,height:Y.height},O))}else W.useStyle(O),W.setColor(z),W.style.strokeNoScale=!0;var J=W.ensureState("emphasis");J.style=$r(X);var re=c.getStore().get(c.getDimensionIndex(W.__dimIdx),x);(re==null||isNaN(re))&&(re=""),Ao(W,to(A),{labelFetcher:c.hostModel,labelDataIndex:x,labelDimIndex:W.__dimIdx,defaultText:re,inheritColor:z,defaultOpacity:O.opacity})}),da(y,$.get("focus"),$.get("blurScope"),$.get("disabled"))}),this._data=c},e.prototype.remove=function(){this.group.removeAll(),this._data=null},e.type="radar",e}(Oi),MIe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.hasSymbolVisual=!0,r}return e.prototype.init=function(r){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new Vb(wr(this.getData,this),wr(this.getRawData,this))},e.prototype.getInitialData=function(r,n){return _y(this,{generateCoord:"indicator_",generateCoordCount:1/0})},e.prototype.formatTooltip=function(r,n,i){var a=this.getData(),l=this.coordinateSystem,c=l.getIndicatorAxes(),o=this.getData().getName(r),d=o===""?this.name:o,g=BX(this,r);return ro("section",{header:d,sortBlocks:!0,blocks:Zt(c,function(m){var y=a.get(a.mapDimension(m.dim),r);return ro("nameValue",{markerType:"subItem",markerColor:g,name:m.name,value:y,sortParam:y})})})},e.prototype.getTooltipPosition=function(r){if(r!=null){for(var n=this.getData(),i=this.coordinateSystem,a=n.getValues(Zt(i.dimensions,function(d){return n.mapDimension(d)}),r),l=0,c=a.length;l<c;l++)if(!isNaN(a[l])){var o=i.getIndicatorAxes();return i.coordToPoint(o[l].dataToCoord(a[l]),l)}}},e.type="series.radar",e.dependencies=["radar"],e.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},e}(Wi),Cx=DK.value;function nA(t,e){return Fr({show:e},t)}var IIe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.optionUpdated=function(){var r=this.get("boundaryGap"),n=this.get("splitNumber"),i=this.get("scale"),a=this.get("axisLine"),l=this.get("axisTick"),c=this.get("axisLabel"),o=this.get("axisName"),d=this.get(["axisName","show"]),g=this.get(["axisName","formatter"]),m=this.get("axisNameGap"),y=this.get("triggerEvent"),x=Zt(this.get("indicator")||[],function(A){A.max!=null&&A.max>0&&!A.min?A.min=0:A.min!=null&&A.min<0&&!A.max&&(A.max=0);var M=o;A.color!=null&&(M=Fr({color:A.color},o));var D=pn($r(A),{boundaryGap:r,splitNumber:n,scale:i,axisLine:a,axisTick:l,axisLabel:c,name:A.text,showName:d,nameLocation:"end",nameGap:m,nameTextStyle:M,triggerEvent:y},!1);if(yr(g)){var P=D.name;D.name=g.replace("{value}",P??"")}else zr(g)&&(D.name=g(D.name,D));var O=new bi(D,null,this.ecModel);return Ea(O,kb.prototype),O.mainType="radar",O.componentIndex=this.componentIndex,O},this);this._indicatorModels=x},e.prototype.getIndicatorModels=function(){return this._indicatorModels},e.type="radar",e.defaultOption={z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:pn({lineStyle:{color:"#bbb"}},Cx.axisLine),axisLabel:nA(Cx.axisLabel,!1),axisTick:nA(Cx.axisTick,!1),splitLine:nA(Cx.splitLine,!0),splitArea:nA(Cx.splitArea,!0),indicator:[]},e}($n),EIe=["axisLine","axisTickLabel","axisName"],DIe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=this.group;a.removeAll(),this._buildAxes(r),this._buildSplitLineAndArea(r)},e.prototype._buildAxes=function(r){var n=r.coordinateSystem,i=n.getIndicatorAxes(),a=Zt(i,function(l){var c=l.model.get("showName")?l.name:"",o=new rs(l.model,{axisName:c,position:[n.cx,n.cy],rotation:l.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});return o});fe(a,function(l){fe(EIe,l.add,l),this.group.add(l.getGroup())},this)},e.prototype._buildSplitLineAndArea=function(r){var n=r.coordinateSystem,i=n.getIndicatorAxes();if(!i.length)return;var a=r.get("shape"),l=r.getModel("splitLine"),c=r.getModel("splitArea"),o=l.getModel("lineStyle"),d=c.getModel("areaStyle"),g=l.get("show"),m=c.get("show"),y=o.get("color"),x=d.get("color"),A=Ht(y)?y:[y],M=Ht(x)?x:[x],D=[],P=[];function O(ve,me,Ie){var Le=Ie%me.length;return ve[Le]=ve[Le]||[],Le}if(a==="circle")for(var z=i[0].getTicksCoords(),V=n.cx,H=n.cy,$=0;$<z.length;$++){if(g){var X=O(D,A,$);D[X].push(new Ch({shape:{cx:V,cy:H,r:z[$].coord}}))}if(m&&$<z.length-1){var X=O(P,M,$);P[X].push(new cI({shape:{cx:V,cy:H,r0:z[$].coord,r:z[$+1].coord}}))}}else for(var W,Y=Zt(i,function(ve,me){var Ie=ve.getTicksCoords();return W=W==null?Ie.length-1:Math.min(Ie.length-1,W),Zt(Ie,function(Le){return n.coordToPoint(Le.coord,me)})}),J=[],$=0;$<=W;$++){for(var re=[],ae=0;ae<i.length;ae++)re.push(Y[ae][$]);if(re[0]&&re.push(re[0].slice()),g){var X=O(D,A,$);D[X].push(new ls({shape:{points:re}}))}if(m&&J){var X=O(P,M,$-1);P[X].push(new os({shape:{points:re.concat(J)}}))}J=re.slice().reverse()}var pe=o.getLineStyle(),de=d.getAreaStyle();fe(P,function(ve,me){this.group.add(Cl(ve,{style:Fr({stroke:"none",fill:M[me%M.length]},de),silent:!0}))},this),fe(D,function(ve,me){this.group.add(Cl(ve,{style:Fr({fill:"none",stroke:A[me%A.length]},pe),silent:!0}))},this)},e.type="radar",e}(ra),PIe=function(t){et(e,t);function e(r,n,i){var a=t.call(this,r,n,i)||this;return a.type="value",a.angle=0,a.name="",a}return e}(Tu),LIe=function(){function t(e,r,n){this.dimensions=[],this._model=e,this._indicatorAxes=Zt(e.getIndicatorModels(),function(i,a){var l="indicator_"+a,c=new PIe(l,new _h);return c.name=i.get("name"),c.model=i,i.axis=c,this.dimensions.push(l),c},this),this.resize(e,n)}return t.prototype.getIndicatorAxes=function(){return this._indicatorAxes},t.prototype.dataToPoint=function(e,r){var n=this._indicatorAxes[r];return this.coordToPoint(n.dataToCoord(e),r)},t.prototype.coordToPoint=function(e,r){var n=this._indicatorAxes[r],i=n.angle,a=this.cx+e*Math.cos(i),l=this.cy-e*Math.sin(i);return[a,l]},t.prototype.pointToData=function(e){var r=e[0]-this.cx,n=e[1]-this.cy,i=Math.sqrt(r*r+n*n);r/=i,n/=i;for(var a=Math.atan2(-n,r),l=1/0,c,o=-1,d=0;d<this._indicatorAxes.length;d++){var g=this._indicatorAxes[d],m=Math.abs(a-g.angle);m<l&&(c=g,o=d,l=m)}return[o,+(c&&c.coordToData(i))]},t.prototype.resize=function(e,r){var n=e.get("center"),i=r.getWidth(),a=r.getHeight(),l=Math.min(i,a)/2;this.cx=dr(n[0],i),this.cy=dr(n[1],a),this.startAngle=e.get("startAngle")*Math.PI/180;var c=e.get("radius");(yr(c)||ii(c))&&(c=[0,c]),this.r0=dr(c[0],l),this.r=dr(c[1],l),fe(this._indicatorAxes,function(o,d){o.setExtent(this.r0,this.r);var g=this.startAngle+d*Math.PI*2/this._indicatorAxes.length;g=Math.atan2(Math.sin(g),Math.cos(g)),o.angle=g},this)},t.prototype.update=function(e,r){var n=this._indicatorAxes,i=this._model;fe(n,function(c){c.scale.setExtent(1/0,-1/0)}),e.eachSeriesByType("radar",function(c,o){if(!(c.get("coordinateSystem")!=="radar"||e.getComponent("radar",c.get("radarIndex"))!==i)){var d=c.getData();fe(n,function(g){g.scale.unionExtentFromData(d,d.mapDimension(g.dim))})}},this);var a=i.get("splitNumber"),l=new _h;l.setExtent(0,a),l.setInterval(1),fe(n,function(c,o){PK(c.scale,c.model,l)})},t.prototype.convertToPixel=function(e,r,n){return console.warn("Not implemented."),null},t.prototype.convertFromPixel=function(e,r,n){return console.warn("Not implemented."),null},t.prototype.containPoint=function(e){return console.warn("Not implemented."),!1},t.create=function(e,r){var n=[];return e.eachComponent("radar",function(i){var a=new t(i,e,r);n.push(a),i.coordinateSystem=a}),e.eachSeriesByType("radar",function(i){i.get("coordinateSystem")==="radar"&&(i.coordinateSystem=n[i.get("radarIndex")||0])}),n},t.dimensions=[],t}();function RIe(t){t.registerCoordinateSystem("radar",LIe),t.registerComponentModel(IIe),t.registerComponentView(DIe),t.registerVisual({seriesType:"radar",reset:function(e){var r=e.getData();r.each(function(n){r.setItemVisual(n,"legendIcon","roundRect")}),r.setVisual("legendIcon","roundRect")}})}function kIe(t){En(RIe),t.registerChartView(CIe),t.registerSeriesModel(MIe),t.registerLayout(TIe),t.registerProcessor(Nb("radar")),t.registerPreprocessor(AIe)}var Y$="\0_ec_interaction_mutex";function OIe(t,e,r){var n=PB(t);n[e]=r}function zIe(t,e,r){var n=PB(t),i=n[e];i===r&&(n[e]=null)}function X$(t,e){return!!PB(t)[e]}function PB(t){return t[Y$]||(t[Y$]={})}_c({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Sa);var Gb=function(t){et(e,t);function e(r){var n=t.call(this)||this;n._zr=r;var i=wr(n._mousedownHandler,n),a=wr(n._mousemoveHandler,n),l=wr(n._mouseupHandler,n),c=wr(n._mousewheelHandler,n),o=wr(n._pinchHandler,n);return n.enable=function(d,g){this.disable(),this._opt=Fr($r(g)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),d==null&&(d=!0),(d===!0||d==="move"||d==="pan")&&(r.on("mousedown",i),r.on("mousemove",a),r.on("mouseup",l)),(d===!0||d==="scale"||d==="zoom")&&(r.on("mousewheel",c),r.on("pinch",o))},n.disable=function(){r.off("mousedown",i),r.off("mousemove",a),r.off("mouseup",l),r.off("mousewheel",c),r.off("pinch",o)},n}return e.prototype.isDragging=function(){return this._dragging},e.prototype.isPinching=function(){return this._pinching},e.prototype.setPointerChecker=function(r){this.pointerChecker=r},e.prototype.dispose=function(){this.disable()},e.prototype._mousedownHandler=function(r){if(!wG(r)){for(var n=r.target;n;){if(n.draggable)return;n=n.__hostTarget||n.parent}var i=r.offsetX,a=r.offsetY;this.pointerChecker&&this.pointerChecker(r,i,a)&&(this._x=i,this._y=a,this._dragging=!0)}},e.prototype._mousemoveHandler=function(r){if(!(!this._dragging||!XA("moveOnMouseMove",r,this._opt)||r.gestureEvent==="pinch"||X$(this._zr,"globalPan"))){var n=r.offsetX,i=r.offsetY,a=this._x,l=this._y,c=n-a,o=i-l;this._x=n,this._y=i,this._opt.preventDefaultMouseMove&&dh(r.event),FK(this,"pan","moveOnMouseMove",r,{dx:c,dy:o,oldX:a,oldY:l,newX:n,newY:i,isAvailableBehavior:null})}},e.prototype._mouseupHandler=function(r){wG(r)||(this._dragging=!1)},e.prototype._mousewheelHandler=function(r){var n=XA("zoomOnMouseWheel",r,this._opt),i=XA("moveOnMouseWheel",r,this._opt),a=r.wheelDelta,l=Math.abs(a),c=r.offsetX,o=r.offsetY;if(!(a===0||!n&&!i)){if(n){var d=l>3?1.4:l>1?1.2:1.1,g=a>0?d:1/d;LL(this,"zoom","zoomOnMouseWheel",r,{scale:g,originX:c,originY:o,isAvailableBehavior:null})}if(i){var m=Math.abs(a),y=(a>0?1:-1)*(m>3?.4:m>1?.15:.05);LL(this,"scrollMove","moveOnMouseWheel",r,{scrollDelta:y,originX:c,originY:o,isAvailableBehavior:null})}}},e.prototype._pinchHandler=function(r){if(!X$(this._zr,"globalPan")){var n=r.pinchScale>1?1.1:1/1.1;LL(this,"zoom",null,r,{scale:n,originX:r.pinchX,originY:r.pinchY,isAvailableBehavior:null})}},e}(Fl);function LL(t,e,r,n,i){t.pointerChecker&&t.pointerChecker(n,i.originX,i.originY)&&(dh(n.event),FK(t,e,r,n,i))}function FK(t,e,r,n,i){i.isAvailableBehavior=wr(XA,null,r,n),t.trigger(e,i)}function XA(t,e,r){var n=r[t];return!t||n&&(!yr(n)||e.event[n+"Key"])}function LB(t,e,r){var n=t.target;n.x+=e,n.y+=r,n.dirty()}function RB(t,e,r,n){var i=t.target,a=t.zoomLimit,l=t.zoom=t.zoom||1;if(l*=e,a){var c=a.min||0,o=a.max||1/0;l=Math.max(Math.min(o,l),c)}var d=l/t.zoom;t.zoom=l,i.x-=(r-i.x)*(d-1),i.y-=(n-i.y)*(d-1),i.scaleX*=d,i.scaleY*=d,i.dirty()}var BIe={axisPointer:1,tooltip:1,brush:1};function DI(t,e,r){var n=e.getComponentByElement(t.topTarget),i=n&&n.coordinateSystem;return n&&n!==r&&!BIe.hasOwnProperty(n.mainType)&&i&&i.model!==r}function NK(t){if(yr(t)){var e=new DOMParser;t=e.parseFromString(t,"text/xml")}var r=t;for(r.nodeType===9&&(r=r.firstChild);r.nodeName.toLowerCase()!=="svg"||r.nodeType!==1;)r=r.nextSibling;return r}var RL,KC={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},Q$=Hn(KC),JC={"alignment-baseline":"textBaseline","stop-color":"stopColor"},K$=Hn(JC),FIe=function(){function t(){this._defs={},this._root=null}return t.prototype.parse=function(e,r){r=r||{};var n=NK(e);this._defsUsePending=[];var i=new jr;this._root=i;var a=[],l=n.getAttribute("viewBox")||"",c=parseFloat(n.getAttribute("width")||r.width),o=parseFloat(n.getAttribute("height")||r.height);isNaN(c)&&(c=null),isNaN(o)&&(o=null),Hs(n,i,null,!0,!1);for(var d=n.firstChild;d;)this._parseNode(d,i,a,null,!1,!1),d=d.nextSibling;GIe(this._defs,this._defsUsePending),this._defsUsePending=[];var g,m;if(l){var y=PI(l);y.length>=4&&(g={x:parseFloat(y[0]||0),y:parseFloat(y[1]||0),width:parseFloat(y[2]),height:parseFloat(y[3])})}if(g&&c!=null&&o!=null&&(m=GK(g,{x:0,y:0,width:c,height:o}),!r.ignoreViewBox)){var x=i;i=new jr,i.add(x),x.scaleX=x.scaleY=m.scale,x.x=m.x,x.y=m.y}return!r.ignoreRootClip&&c!=null&&o!=null&&i.setClipPath(new Kn({shape:{x:0,y:0,width:c,height:o}})),{root:i,width:c,height:o,viewBoxRect:g,viewBoxTransform:m,named:a}},t.prototype._parseNode=function(e,r,n,i,a,l){var c=e.nodeName.toLowerCase(),o,d=i;if(c==="defs"&&(a=!0),c==="text"&&(l=!0),c==="defs"||c==="switch")o=r;else{if(!a){var g=RL[c];if(g&&Cr(RL,c)){o=g.call(this,e,r);var m=e.getAttribute("name");if(m){var y={name:m,namedFrom:null,svgNodeTagLower:c,el:o};n.push(y),c==="g"&&(d=y)}else i&&n.push({name:i.name,namedFrom:i,svgNodeTagLower:c,el:o});r.add(o)}}var x=J$[c];if(x&&Cr(J$,c)){var A=x.call(this,e),M=e.getAttribute("id");M&&(this._defs[M]=A)}}if(o&&o.isGroup)for(var D=e.firstChild;D;)D.nodeType===1?this._parseNode(D,o,n,d,a,l):D.nodeType===3&&l&&this._parseText(D,o),D=D.nextSibling},t.prototype._parseText=function(e,r){var n=new U_({style:{text:e.textContent},silent:!0,x:this._textX||0,y:this._textY||0});vl(r,n),Hs(e,n,this._defsUsePending,!1,!1),NIe(n,r);var i=n.style,a=i.fontSize;a&&a<9&&(i.fontSize=9,n.scaleX*=a/9,n.scaleY*=a/9);var l=(i.fontSize||i.fontFamily)&&[i.fontStyle,i.fontWeight,(i.fontSize||12)+"px",i.fontFamily||"sans-serif"].join(" ");i.font=l;var c=n.getBoundingRect();return this._textX+=c.width,r.add(n),n},t.internalField=function(){RL={g:function(e,r){var n=new jr;return vl(r,n),Hs(e,n,this._defsUsePending,!1,!1),n},rect:function(e,r){var n=new Kn;return vl(r,n),Hs(e,n,this._defsUsePending,!1,!1),n.setShape({x:parseFloat(e.getAttribute("x")||"0"),y:parseFloat(e.getAttribute("y")||"0"),width:parseFloat(e.getAttribute("width")||"0"),height:parseFloat(e.getAttribute("height")||"0")}),n.silent=!0,n},circle:function(e,r){var n=new Ch;return vl(r,n),Hs(e,n,this._defsUsePending,!1,!1),n.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),r:parseFloat(e.getAttribute("r")||"0")}),n.silent=!0,n},line:function(e,r){var n=new Ka;return vl(r,n),Hs(e,n,this._defsUsePending,!1,!1),n.setShape({x1:parseFloat(e.getAttribute("x1")||"0"),y1:parseFloat(e.getAttribute("y1")||"0"),x2:parseFloat(e.getAttribute("x2")||"0"),y2:parseFloat(e.getAttribute("y2")||"0")}),n.silent=!0,n},ellipse:function(e,r){var n=new Gz;return vl(r,n),Hs(e,n,this._defsUsePending,!1,!1),n.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),rx:parseFloat(e.getAttribute("rx")||"0"),ry:parseFloat(e.getAttribute("ry")||"0")}),n.silent=!0,n},polygon:function(e,r){var n=e.getAttribute("points"),i;n&&(i=rH(n));var a=new os({shape:{points:i||[]},silent:!0});return vl(r,a),Hs(e,a,this._defsUsePending,!1,!1),a},polyline:function(e,r){var n=e.getAttribute("points"),i;n&&(i=rH(n));var a=new ls({shape:{points:i||[]},silent:!0});return vl(r,a),Hs(e,a,this._defsUsePending,!1,!1),a},image:function(e,r){var n=new fo;return vl(r,n),Hs(e,n,this._defsUsePending,!1,!1),n.setStyle({image:e.getAttribute("xlink:href")||e.getAttribute("href"),x:+e.getAttribute("x"),y:+e.getAttribute("y"),width:+e.getAttribute("width"),height:+e.getAttribute("height")}),n.silent=!0,n},text:function(e,r){var n=e.getAttribute("x")||"0",i=e.getAttribute("y")||"0",a=e.getAttribute("dx")||"0",l=e.getAttribute("dy")||"0";this._textX=parseFloat(n)+parseFloat(a),this._textY=parseFloat(i)+parseFloat(l);var c=new jr;return vl(r,c),Hs(e,c,this._defsUsePending,!1,!0),c},tspan:function(e,r){var n=e.getAttribute("x"),i=e.getAttribute("y");n!=null&&(this._textX=parseFloat(n)),i!=null&&(this._textY=parseFloat(i));var a=e.getAttribute("dx")||"0",l=e.getAttribute("dy")||"0",c=new jr;return vl(r,c),Hs(e,c,this._defsUsePending,!1,!0),this._textX+=parseFloat(a),this._textY+=parseFloat(l),c},path:function(e,r){var n=e.getAttribute("d")||"",i=EY(n);return vl(r,i),Hs(e,i,this._defsUsePending,!1,!1),i.silent=!0,i}}}(),t}(),J$={lineargradient:function(t){var e=parseInt(t.getAttribute("x1")||"0",10),r=parseInt(t.getAttribute("y1")||"0",10),n=parseInt(t.getAttribute("x2")||"10",10),i=parseInt(t.getAttribute("y2")||"0",10),a=new Mb(e,r,n,i);return eH(t,a),tH(t,a),a},radialgradient:function(t){var e=parseInt(t.getAttribute("cx")||"0",10),r=parseInt(t.getAttribute("cy")||"0",10),n=parseInt(t.getAttribute("r")||"0",10),i=new OY(e,r,n);return eH(t,i),tH(t,i),i}};function eH(t,e){var r=t.getAttribute("gradientUnits");r==="userSpaceOnUse"&&(e.global=!0)}function tH(t,e){for(var r=t.firstChild;r;){if(r.nodeType===1&&r.nodeName.toLocaleLowerCase()==="stop"){var n=r.getAttribute("offset"),i=void 0;n&&n.indexOf("%")>0?i=parseInt(n,10)/100:n?i=parseFloat(n):i=0;var a={};VK(r,a,a);var l=a.stopColor||r.getAttribute("stop-color")||"#000000";e.colorStops.push({offset:i,color:l})}r=r.nextSibling}}function vl(t,e){t&&t.__inheritedStyle&&(e.__inheritedStyle||(e.__inheritedStyle={}),Fr(e.__inheritedStyle,t.__inheritedStyle))}function rH(t){for(var e=PI(t),r=[],n=0;n<e.length;n+=2){var i=parseFloat(e[n]),a=parseFloat(e[n+1]);r.push([i,a])}return r}function Hs(t,e,r,n,i){var a=e,l=a.__inheritedStyle=a.__inheritedStyle||{},c={};t.nodeType===1&&(HIe(t,e),VK(t,l,c),n||jIe(t,l,c)),a.style=a.style||{},l.fill!=null&&(a.style.fill=nH(a,"fill",l.fill,r)),l.stroke!=null&&(a.style.stroke=nH(a,"stroke",l.stroke,r)),fe(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(o){l[o]!=null&&(a.style[o]=parseFloat(l[o]))}),fe(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],function(o){l[o]!=null&&(a.style[o]=l[o])}),i&&(a.__selfStyle=c),l.lineDash&&(a.style.lineDash=Zt(PI(l.lineDash),function(o){return parseFloat(o)})),(l.visibility==="hidden"||l.visibility==="collapse")&&(a.invisible=!0),l.display==="none"&&(a.ignore=!0)}function NIe(t,e){var r=e.__selfStyle;if(r){var n=r.textBaseline,i=n;!n||n==="auto"||n==="baseline"?i="alphabetic":n==="before-edge"||n==="text-before-edge"?i="top":n==="after-edge"||n==="text-after-edge"?i="bottom":(n==="central"||n==="mathematical")&&(i="middle"),t.style.textBaseline=i}var a=e.__inheritedStyle;if(a){var l=a.textAlign,c=l;l&&(l==="middle"&&(c="center"),t.style.textAlign=c)}}var VIe=/^url\(\s*#(.*?)\)/;function nH(t,e,r,n){var i=r&&r.match(VIe);if(i){var a=fu(i[1]);n.push([t,e,a]);return}return r==="none"&&(r=null),r}function GIe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n[0].style[n[1]]=t[n[2]]}}var UIe=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function PI(t){return t.match(UIe)||[]}var $Ie=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,kL=Math.PI/180;function HIe(t,e){var r=t.getAttribute("transform");if(r){r=r.replace(/,/g," ");var n=[],i=null;r.replace($Ie,function(m,y,x){return n.push(y,x),""});for(var a=n.length-1;a>0;a-=2){var l=n[a],c=n[a-1],o=PI(l);switch(i=i||Qs(),c){case"translate":hc(i,i,[parseFloat(o[0]),parseFloat(o[1]||"0")]);break;case"scale":Az(i,i,[parseFloat(o[0]),parseFloat(o[1]||o[0])]);break;case"rotate":hv(i,i,-parseFloat(o[0])*kL,[parseFloat(o[1]||"0"),parseFloat(o[2]||"0")]);break;case"skewX":var d=Math.tan(parseFloat(o[0])*kL);oh(i,[1,0,d,1,0,0],i);break;case"skewY":var g=Math.tan(parseFloat(o[0])*kL);oh(i,[1,g,0,1,0,0],i);break;case"matrix":i[0]=parseFloat(o[0]),i[1]=parseFloat(o[1]),i[2]=parseFloat(o[2]),i[3]=parseFloat(o[3]),i[4]=parseFloat(o[4]),i[5]=parseFloat(o[5]);break}}e.setLocalTransform(i)}}var iH=/([^\s:;]+)\s*:\s*([^:;]+)/g;function VK(t,e,r){var n=t.getAttribute("style");if(n){iH.lastIndex=0;for(var i;(i=iH.exec(n))!=null;){var a=i[1],l=Cr(KC,a)?KC[a]:null;l&&(e[l]=i[2]);var c=Cr(JC,a)?JC[a]:null;c&&(r[c]=i[2])}}}function jIe(t,e,r){for(var n=0;n<Q$.length;n++){var i=Q$[n],a=t.getAttribute(i);a!=null&&(e[KC[i]]=a)}for(var n=0;n<K$.length;n++){var i=K$[n],a=t.getAttribute(i);a!=null&&(r[JC[i]]=a)}}function GK(t,e){var r=e.width/t.width,n=e.height/t.height,i=Math.min(r,n);return{scale:i,x:-(t.x+t.width/2)*i+(e.x+e.width/2),y:-(t.y+t.height/2)*i+(e.y+e.height/2)}}function WIe(t,e){var r=new FIe;return r.parse(t,e)}var ZIe=Ir(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),qIe=function(){function t(e,r){this.type="geoSVG",this._usedGraphicMap=Ir(),this._freedGraphics=[],this._mapName=e,this._parsedXML=NK(r)}return t.prototype.load=function(){var e=this._firstGraphic;if(!e){e=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(e),this._boundingRect=this._firstGraphic.boundingRect.clone();var r=XIe(e.named),n=r.regions,i=r.regionsMap;this._regions=n,this._regionsMap=i}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},t.prototype._buildGraphic=function(e){var r,n;try{r=e&&WIe(e,{ignoreViewBox:!0,ignoreRootClip:!0})||{},n=r.root,ns(n!=null)}catch(D){throw new Error(`Invalid svg format
`+D.message)}var i=new jr;i.add(n),i.isGeoSVGGraphicRoot=!0;var a=r.width,l=r.height,c=r.viewBoxRect,o=this._boundingRect;if(!o){var d=void 0,g=void 0,m=void 0,y=void 0;if(a!=null?(d=0,m=a):c&&(d=c.x,m=c.width),l!=null?(g=0,y=l):c&&(g=c.y,y=c.height),d==null||g==null){var x=n.getBoundingRect();d==null&&(d=x.x,m=x.width),g==null&&(g=x.y,y=x.height)}o=this._boundingRect=new gn(d,g,m,y)}if(c){var A=GK(c,o);n.scaleX=n.scaleY=A.scale,n.x=A.x,n.y=A.y}i.setClipPath(new Kn({shape:o.plain()}));var M=[];return fe(r.named,function(D){ZIe.get(D.svgNodeTagLower)!=null&&(M.push(D),YIe(D.el))}),{root:i,boundingRect:o,named:M}},t.prototype.useGraphic=function(e){var r=this._usedGraphicMap,n=r.get(e);return n||(n=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),r.set(e,n),n)},t.prototype.freeGraphic=function(e){var r=this._usedGraphicMap,n=r.get(e);n&&(r.removeKey(e),this._freedGraphics.push(n))},t}();function YIe(t){t.silent=!1,t.isGroup&&t.traverse(function(e){e.silent=!1})}function XIe(t){var e=[],r=Ir();return fe(t,function(n){if(n.namedFrom==null){var i=new HAe(n.name,n.el);e.push(i),r.set(n.name,i)}}),{regions:e,regionsMap:r}}var CO=[126,25],aH="",ug=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]];for(var sg=0;sg<ug.length;sg++)for(var t_=0;t_<ug[sg].length;t_++)ug[sg][t_][0]/=10.5,ug[sg][t_][1]/=-10.5/.75,ug[sg][t_][0]+=CO[0],ug[sg][t_][1]+=CO[1];function QIe(t,e){if(t==="china"){for(var r=0;r<e.length;r++)if(e[r].name===aH)return;e.push(new NQ(aH,Zt(ug,function(n){return{type:"polygon",exterior:n}}),CO))}}var KIe={:[32,80],:[0,-10],:[10,5],:[-10,10],:[5,5]};function JIe(t,e){if(t==="china"){var r=KIe[e.name];if(r){var n=e.getCenter();n[0]+=r[0]/10.5,n[1]+=-r[1]/(10.5/.75),e.setCenter(n)}}}var eEe=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];function tEe(t,e){t==="china"&&e.name===""&&e.geometries.push({type:"polygon",exterior:eEe[0]})}var rEe="name",nEe=function(){function t(e,r,n){this.type="geoJSON",this._parsedMap=Ir(),this._mapName=e,this._specialAreas=n,this._geoJSON=aEe(r)}return t.prototype.load=function(e,r){r=r||rEe;var n=this._parsedMap.get(r);if(!n){var i=this._parseToRegions(r);n=this._parsedMap.set(r,{regions:i,boundingRect:iEe(i)})}var a=Ir(),l=[];return fe(n.regions,function(c){var o=c.name;e&&Cr(e,o)&&(c=c.cloneShallow(o=e[o])),l.push(c),a.set(o,c)}),{regions:l,boundingRect:n.boundingRect||new gn(0,0,0,0),regionsMap:a}},t.prototype._parseToRegions=function(e){var r=this._mapName,n=this._geoJSON,i;try{i=n?WAe(n,e):[]}catch(a){throw new Error(`Invalid geoJson format
`+a.message)}return QIe(r,i),fe(i,function(a){var l=a.name;JIe(r,a),tEe(r,a);var c=this._specialAreas&&this._specialAreas[l];c&&a.transformTo(c.left,c.top,c.width,c.height)},this),i},t.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},t}();function iEe(t){for(var e,r=0;r<t.length;r++){var n=t[r].getBoundingRect();e=e||n.clone(),e.union(n)}return e}function aEe(t){return yr(t)?typeof JSON<"u"&&JSON.parse?JSON.parse(t):new Function("return ("+t+");")():t}var Mx=Ir();const yh={registerMap:function(t,e,r){if(e.svg){var n=new qIe(t,e.svg);Mx.set(t,n)}else{var i=e.geoJson||e.geoJSON;i&&!e.features?r=e.specialAreas:i=e;var n=new nEe(t,i,r);Mx.set(t,n)}},getGeoResource:function(t){return Mx.get(t)},getMapForUser:function(t){var e=Mx.get(t);return e&&e.type==="geoJSON"&&e.getMapForUser()},load:function(t,e,r){var n=Mx.get(t);if(n)return n.load(e,r)}};var kB=["rect","circle","line","ellipse","polygon","polyline","path"],oEe=Ir(kB),sEe=Ir(kB.concat(["g"])),lEe=Ir(kB.concat(["g"])),UK=ri();function iA(t){var e=t.getItemStyle(),r=t.get("areaColor");return r!=null&&(e.fill=r),e}function oH(t){var e=t.style;e&&(e.stroke=e.stroke||e.fill,e.fill=null)}var $K=function(){function t(e){var r=new jr;this.uid=hy("ec_map_draw"),this._controller=new Gb(e.getZr()),this._controllerHost={target:r},this.group=r,r.add(this._regionsGroup=new jr),r.add(this._svgGroup=new jr)}return t.prototype.draw=function(e,r,n,i,a){var l=e.mainType==="geo",c=e.getData&&e.getData();l&&r.eachComponent({mainType:"series",subType:"map"},function(P){!c&&P.getHostGeoModel()===e&&(c=P.getData())});var o=e.coordinateSystem,d=this._regionsGroup,g=this.group,m=o.getTransformInfo(),y=m.raw,x=m.roam,A=!d.childAt(0)||a;A?(g.x=x.x,g.y=x.y,g.scaleX=x.scaleX,g.scaleY=x.scaleY,g.dirty()):li(g,x,e);var M=c&&c.getVisual("visualMeta")&&c.getVisual("visualMeta").length>0,D={api:n,geo:o,mapOrGeoModel:e,data:c,isVisualEncodedByVisualMap:M,isGeo:l,transformInfoRaw:y};o.resourceType==="geoJSON"?this._buildGeoJSON(D):o.resourceType==="geoSVG"&&this._buildSVG(D),this._updateController(e,r,n),this._updateMapSelectHandler(e,d,n,i)},t.prototype._buildGeoJSON=function(e){var r=this._regionsGroupByName=Ir(),n=Ir(),i=this._regionsGroup,a=e.transformInfoRaw,l=e.mapOrGeoModel,c=e.data,o=e.geo.projection,d=o&&o.stream;function g(x,A){return A&&(x=A(x)),x&&[x[0]*a.scaleX+a.x,x[1]*a.scaleY+a.y]}function m(x){for(var A=[],M=!d&&o&&o.project,D=0;D<x.length;++D){var P=g(x[D],M);P&&A.push(P)}return A}function y(x){return{shape:{points:m(x)}}}i.removeAll(),fe(e.geo.regions,function(x){var A=x.name,M=r.get(A),D=n.get(A)||{},P=D.dataIdx,O=D.regionModel;M||(M=r.set(A,new jr),i.add(M),P=c?c.indexOfName(A):null,O=e.isGeo?l.getRegionModel(A):c?c.getItemModel(P):null,n.set(A,{dataIdx:P,regionModel:O}));var z=[],V=[];fe(x.geometries,function(X){if(X.type==="polygon"){var W=[X.exterior].concat(X.interiors||[]);d&&(W=fH(W,d)),fe(W,function(J){z.push(new os(y(J)))})}else{var Y=X.points;d&&(Y=fH(Y,d,!0)),fe(Y,function(J){V.push(new ls(y(J)))})}});var H=g(x.getCenter(),o&&o.project);function $(X,W){if(X.length){var Y=new Uz({culling:!0,segmentIgnoreThreshold:1,shape:{paths:X}});M.add(Y),sH(e,Y,P,O),lH(e,Y,A,O,l,P,H),W&&(oH(Y),fe(Y.states,oH))}}$(z),$(V,!0)}),r.each(function(x,A){var M=n.get(A),D=M.dataIdx,P=M.regionModel;uH(e,x,A,P,l,D),cH(e,x,A,P,l),hH(e,x,A,P,l)},this)},t.prototype._buildSVG=function(e){var r=e.geo.map,n=e.transformInfoRaw;this._svgGroup.x=n.x,this._svgGroup.y=n.y,this._svgGroup.scaleX=n.scaleX,this._svgGroup.scaleY=n.scaleY,this._svgResourceChanged(r)&&(this._freeSVG(),this._useSVG(r));var i=this._svgDispatcherMap=Ir(),a=!1;fe(this._svgGraphicRecord.named,function(l){var c=l.name,o=e.mapOrGeoModel,d=e.data,g=l.svgNodeTagLower,m=l.el,y=d?d.indexOfName(c):null,x=o.getRegionModel(c);if(oEe.get(g)!=null&&m instanceof zl&&sH(e,m,y,x),m instanceof zl&&(m.culling=!0),m.z2EmphasisLift=0,!l.namedFrom&&(lEe.get(g)!=null&&lH(e,m,c,x,o,y,null),uH(e,m,c,x,o,y),cH(e,m,c,x,o),sEe.get(g)!=null)){var A=hH(e,m,c,x,o);A==="self"&&(a=!0);var M=i.get(c)||i.set(c,[]);M.push(m)}},this),this._enableBlurEntireSVG(a,e)},t.prototype._enableBlurEntireSVG=function(e,r){if(e&&r.isGeo){var n=r.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle(),i=n.opacity;this._svgGraphicRecord.root.traverse(function(a){if(!a.isGroup){rv(a);var l=a.ensureState("blur").style||{};l.opacity==null&&i!=null&&(l.opacity=i),a.ensureState("emphasis")}})}},t.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},t.prototype.findHighDownDispatchers=function(e,r){if(e==null)return[];var n=r.coordinateSystem;if(n.resourceType==="geoJSON"){var i=this._regionsGroupByName;if(i){var a=i.get(e);return a?[a]:[]}}else if(n.resourceType==="geoSVG")return this._svgDispatcherMap&&this._svgDispatcherMap.get(e)||[]},t.prototype._svgResourceChanged=function(e){return this._svgMapName!==e},t.prototype._useSVG=function(e){var r=yh.getGeoResource(e);if(r&&r.type==="geoSVG"){var n=r.useGraphic(this.uid);this._svgGroup.add(n.root),this._svgGraphicRecord=n,this._svgMapName=e}},t.prototype._freeSVG=function(){var e=this._svgMapName;if(e!=null){var r=yh.getGeoResource(e);r&&r.type==="geoSVG"&&r.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},t.prototype._updateController=function(e,r,n){var i=e.coordinateSystem,a=this._controller,l=this._controllerHost;l.zoomLimit=e.get("scaleLimit"),l.zoom=i.getZoom(),a.enable(e.get("roam")||!1);var c=e.mainType;function o(){var d={type:"geoRoam",componentType:c};return d[c+"Id"]=e.id,d}a.off("pan").on("pan",function(d){this._mouseDownFlag=!1,LB(l,d.dx,d.dy),n.dispatchAction(Lt(o(),{dx:d.dx,dy:d.dy,animation:{duration:0}}))},this),a.off("zoom").on("zoom",function(d){this._mouseDownFlag=!1,RB(l,d.scale,d.originX,d.originY),n.dispatchAction(Lt(o(),{zoom:d.scale,originX:d.originX,originY:d.originY,animation:{duration:0}}))},this),a.setPointerChecker(function(d,g,m){return i.containPoint([g,m])&&!DI(d,n,e)})},t.prototype.resetForLabelLayout=function(){this.group.traverse(function(e){var r=e.getTextContent();r&&(r.ignore=UK(r).ignore)})},t.prototype._updateMapSelectHandler=function(e,r,n,i){var a=this;r.off("mousedown"),r.off("click"),e.get("selectedMode")&&(r.on("mousedown",function(){a._mouseDownFlag=!0}),r.on("click",function(l){a._mouseDownFlag&&(a._mouseDownFlag=!1)}))},t}();function sH(t,e,r,n){var i=n.getModel("itemStyle"),a=n.getModel(["emphasis","itemStyle"]),l=n.getModel(["blur","itemStyle"]),c=n.getModel(["select","itemStyle"]),o=iA(i),d=iA(a),g=iA(c),m=iA(l),y=t.data;if(y){var x=y.getItemVisual(r,"style"),A=y.getItemVisual(r,"decal");t.isVisualEncodedByVisualMap&&x.fill&&(o.fill=x.fill),A&&(o.decal=j_(A,t.api))}e.setStyle(o),e.style.strokeNoScale=!0,e.ensureState("emphasis").style=d,e.ensureState("select").style=g,e.ensureState("blur").style=m,rv(e)}function lH(t,e,r,n,i,a,l){var c=t.data,o=t.isGeo,d=c&&isNaN(c.get(c.mapDimension("value"),a)),g=c&&c.getItemLayout(a);if(o||d||g&&g.showLabel){var m=o?r:a,y=void 0;(!c||a>=0)&&(y=i);var x=l?{normal:{align:"center",verticalAlign:"middle"}}:null;Ao(e,to(n),{labelFetcher:y,labelDataIndex:m,defaultText:r},x);var A=e.getTextContent();if(A&&(UK(A).ignore=A.ignore,e.textConfig&&l)){var M=e.getBoundingRect().clone();e.textConfig.layoutRect=M,e.textConfig.position=[(l[0]-M.x)/M.width*100+"%",(l[1]-M.y)/M.height*100+"%"]}e.disableLabelAnimation=!0}else e.removeTextContent(),e.removeTextConfig(),e.disableLabelAnimation=null}function uH(t,e,r,n,i,a){t.data?t.data.setItemGraphicEl(a,e):Yr(e).eventData={componentType:"geo",componentIndex:i.componentIndex,geoIndex:i.componentIndex,name:r,region:n&&n.option||{}}}function cH(t,e,r,n,i){t.data||uy({el:e,componentModel:i,itemName:r,itemTooltipOption:n.get("tooltip")})}function hH(t,e,r,n,i){e.highDownSilentOnTouch=!!i.get("selectedMode");var a=n.getModel("emphasis"),l=a.get("focus");return da(e,l,a.get("blurScope"),a.get("disabled")),t.isGeo&&nbe(e,i,r),l}function fH(t,e,r){var n=[],i;function a(){i=[]}function l(){i.length&&(n.push(i),i=[])}var c=e({polygonStart:a,polygonEnd:l,lineStart:a,lineEnd:l,point:function(o,d){isFinite(o)&&isFinite(d)&&i.push([o,d])},sphere:function(){}});return!r&&c.polygonStart(),fe(t,function(o){c.lineStart();for(var d=0;d<o.length;d++)c.point(o[d][0],o[d][1]);c.lineEnd()}),!r&&c.polygonEnd(),n}var uEe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i,a){if(!(a&&a.type==="mapToggleSelect"&&a.from===this.uid)){var l=this.group;if(l.removeAll(),!r.getHostGeoModel()){if(this._mapDraw&&a&&a.type==="geoRoam"&&this._mapDraw.resetForLabelLayout(),a&&a.type==="geoRoam"&&a.componentType==="series"&&a.seriesId===r.id){var c=this._mapDraw;c&&l.add(c.group)}else if(r.needsDrawMap){var c=this._mapDraw||new $K(i);l.add(c.group),c.draw(r,n,i,this,a),this._mapDraw=c}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;r.get("showLegendSymbol")&&n.getComponent("legend")&&this._renderSymbols(r,n,i)}}},e.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},e.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},e.prototype._renderSymbols=function(r,n,i){var a=r.originalData,l=this.group;a.each(a.mapDimension("value"),function(c,o){if(!isNaN(c)){var d=a.getItemLayout(o);if(!(!d||!d.point)){var g=d.point,m=d.offset,y=new Ch({style:{fill:r.getData().getVisual("style").fill},shape:{cx:g[0]+m*9,cy:g[1],r:3},silent:!0,z2:8+(m?0:sy+1)});if(!m){var x=r.mainSeries.getData(),A=a.getName(o),M=x.indexOfName(A),D=a.getItemModel(o),P=D.getModel("label"),O=x.getItemGraphicEl(M);Ao(y,to(D),{labelFetcher:{getFormattedLabel:function(z,V){return r.getFormattedLabel(M,V)}},defaultText:A}),y.disableLabelAnimation=!0,P.get("position")||y.setTextConfig({position:"bottom"}),O.onHoverStateChange=function(z){LC(y,z)}}l.add(y)}}})},e.type="map",e}(Oi),cEe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.needsDrawMap=!1,r.seriesGroup=[],r.getTooltipPosition=function(n){if(n!=null){var i=this.getData().getName(n),a=this.coordinateSystem,l=a.getRegion(i);return l&&a.dataToPoint(l.getCenter())}},r}return e.prototype.getInitialData=function(r){for(var n=_y(this,{coordDimensions:["value"],encodeDefaulter:on(Kz,this)}),i=Ir(),a=[],l=0,c=n.count();l<c;l++){var o=n.getName(l);i.set(o,!0)}var d=yh.load(this.getMapType(),this.option.nameMap,this.option.nameProperty);return fe(d.regions,function(g){var m=g.name;i.get(m)||a.push(m)}),n.appendValues([],a),n},e.prototype.getHostGeoModel=function(){var r=this.option.geoIndex;return r!=null?this.ecModel.getComponent("geo",r):null},e.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},e.prototype.getRawValue=function(r){var n=this.getData();return n.get(n.mapDimension("value"),r)},e.prototype.getRegionModel=function(r){var n=this.getData();return n.getItemModel(n.indexOfName(r))},e.prototype.formatTooltip=function(r,n,i){for(var a=this.getData(),l=this.getRawValue(r),c=a.getName(r),o=this.seriesGroup,d=[],g=0;g<o.length;g++){var m=o[g].originalData.indexOfName(c),y=a.mapDimension("value");isNaN(o[g].originalData.get(y,m))||d.push(o[g].name)}return ro("section",{header:d.join(", "),noHeader:!d.length,blocks:[ro("nameValue",{name:c,value:l})]})},e.prototype.setZoom=function(r){this.option.zoom=r},e.prototype.setCenter=function(r){this.option.center=r},e.prototype.getLegendIcon=function(r){var n=r.icon||"roundRect",i=Ia(n,0,0,r.itemWidth,r.itemHeight,r.itemStyle.fill);return i.setStyle(r.itemStyle),i.style.stroke="none",n.indexOf("empty")>-1&&(i.style.stroke=i.style.fill,i.style.fill="#fff",i.style.lineWidth=2),i},e.type="series.map",e.dependencies=["geo"],e.layoutMode="box",e.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},e}(Wi);function hEe(t,e){var r={};return fe(t,function(n){n.each(n.mapDimension("value"),function(i,a){var l="ec-"+n.getName(a);r[l]=r[l]||[],isNaN(i)||r[l].push(i)})}),t[0].map(t[0].mapDimension("value"),function(n,i){for(var a="ec-"+t[0].getName(i),l=0,c=1/0,o=-1/0,d=r[a].length,g=0;g<d;g++)c=Math.min(c,r[a][g]),o=Math.max(o,r[a][g]),l+=r[a][g];var m;return e==="min"?m=c:e==="max"?m=o:e==="average"?m=l/d:m=l,d===0?NaN:m})}function fEe(t){var e={};t.eachSeriesByType("map",function(r){var n=r.getHostGeoModel(),i=n?"o"+n.id:"i"+r.getMapType();(e[i]=e[i]||[]).push(r)}),fe(e,function(r,n){for(var i=hEe(Zt(r,function(l){return l.getData()}),r[0].get("mapValueCalculation")),a=0;a<r.length;a++)r[a].originalData=r[a].getData();for(var a=0;a<r.length;a++)r[a].seriesGroup=r,r[a].needsDrawMap=a===0&&!r[a].getHostGeoModel(),r[a].setData(i.cloneShallow()),r[a].mainSeries=r[0]})}function dEe(t){var e={};t.eachSeriesByType("map",function(r){var n=r.getMapType();if(!(r.getHostGeoModel()||e[n])){var i={};fe(r.seriesGroup,function(l){var c=l.coordinateSystem,o=l.originalData;l.get("showLegendSymbol")&&t.getComponent("legend")&&o.each(o.mapDimension("value"),function(d,g){var m=o.getName(g),y=c.getRegion(m);if(!(!y||isNaN(d))){var x=i[m]||0,A=c.dataToPoint(y.getCenter());i[m]=x+1,o.setItemLayout(g,{point:A,offset:x})}})});var a=r.getData();a.each(function(l){var c=a.getName(l),o=a.getItemLayout(l)||{};o.showLabel=!i[c],a.setItemLayout(l,o)}),e[n]=!0}})}var dH=So,Ub=function(t){et(e,t);function e(r){var n=t.call(this)||this;return n.type="view",n.dimensions=["x","y"],n._roamTransformable=new th,n._rawTransformable=new th,n.name=r,n}return e.prototype.setBoundingRect=function(r,n,i,a){return this._rect=new gn(r,n,i,a),this._rect},e.prototype.getBoundingRect=function(){return this._rect},e.prototype.setViewRect=function(r,n,i,a){this._transformTo(r,n,i,a),this._viewRect=new gn(r,n,i,a)},e.prototype._transformTo=function(r,n,i,a){var l=this.getBoundingRect(),c=this._rawTransformable;c.transform=l.calculateTransform(new gn(r,n,i,a));var o=c.parent;c.parent=null,c.decomposeTransform(),c.parent=o,this._updateTransform()},e.prototype.setCenter=function(r,n){r&&(this._center=[dr(r[0],n.getWidth()),dr(r[1],n.getHeight())],this._updateCenterAndZoom())},e.prototype.setZoom=function(r){r=r||1;var n=this.zoomLimit;n&&(n.max!=null&&(r=Math.min(n.max,r)),n.min!=null&&(r=Math.max(n.min,r))),this._zoom=r,this._updateCenterAndZoom()},e.prototype.getDefaultCenter=function(){var r=this.getBoundingRect(),n=r.x+r.width/2,i=r.y+r.height/2;return[n,i]},e.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},e.prototype.getZoom=function(){return this._zoom||1},e.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},e.prototype._updateCenterAndZoom=function(){var r=this._rawTransformable.getLocalTransform(),n=this._roamTransformable,i=this.getDefaultCenter(),a=this.getCenter(),l=this.getZoom();a=So([],a,r),i=So([],i,r),n.originX=a[0],n.originY=a[1],n.x=i[0]-a[0],n.y=i[1]-a[1],n.scaleX=n.scaleY=l,this._updateTransform()},e.prototype._updateTransform=function(){var r=this._roamTransformable,n=this._rawTransformable;n.parent=r,r.updateTransform(),n.updateTransform(),Tz(this.transform||(this.transform=[]),n.transform||Qs()),this._rawTransform=n.getLocalTransform(),this.invTransform=this.invTransform||[],ay(this.invTransform,this.transform),this.decomposeTransform()},e.prototype.getTransformInfo=function(){var r=this._rawTransformable,n=this._roamTransformable,i=new th;return i.transform=n.transform,i.decomposeTransform(),{roam:{x:i.x,y:i.y,scaleX:i.scaleX,scaleY:i.scaleY},raw:{x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY}}},e.prototype.getViewRect=function(){return this._viewRect},e.prototype.getViewRectAfterRoam=function(){var r=this.getBoundingRect().clone();return r.applyTransform(this.transform),r},e.prototype.dataToPoint=function(r,n,i){var a=n?this._rawTransform:this.transform;return i=i||[],a?dH(i,r,a):Qo(i,r)},e.prototype.pointToData=function(r){var n=this.invTransform;return n?dH([],r,n):[r[0],r[1]]},e.prototype.convertToPixel=function(r,n,i){var a=pH(n);return a===this?a.dataToPoint(i):null},e.prototype.convertFromPixel=function(r,n,i){var a=pH(n);return a===this?a.pointToData(i):null},e.prototype.containPoint=function(r){return this.getViewRectAfterRoam().contain(r[0],r[1])},e.dimensions=["x","y"],e}(th);function pH(t){var e=t.seriesModel;return e?e.coordinateSystem:null}var pEe={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},HK=["lng","lat"],jK=function(t){et(e,t);function e(r,n,i){var a=t.call(this,r)||this;a.dimensions=HK,a.type="geo",a._nameCoordMap=Ir(),a.map=n;var l=i.projection,c=yh.load(n,i.nameMap,i.nameProperty),o=yh.getGeoResource(n);a.resourceType=o?o.type:null;var d=a.regions=c.regions,g=pEe[o.type];a._regionsMap=c.regionsMap,a.regions=c.regions,a.projection=l;var m;if(l)for(var y=0;y<d.length;y++){var x=d[y].getBoundingRect(l);m=m||x.clone(),m.union(x)}else m=c.boundingRect;return a.setBoundingRect(m.x,m.y,m.width,m.height),a.aspectScale=l?1:tn(i.aspectScale,g.aspectScale),a._invertLongitute=l?!1:g.invertLongitute,a}return e.prototype._transformTo=function(r,n,i,a){var l=this.getBoundingRect(),c=this._invertLongitute;l=l.clone(),c&&(l.y=-l.y-l.height);var o=this._rawTransformable;o.transform=l.calculateTransform(new gn(r,n,i,a));var d=o.parent;o.parent=null,o.decomposeTransform(),o.parent=d,c&&(o.scaleY=-o.scaleY),this._updateTransform()},e.prototype.getRegion=function(r){return this._regionsMap.get(r)},e.prototype.getRegionByCoord=function(r){for(var n=this.regions,i=0;i<n.length;i++){var a=n[i];if(a.type==="geoJSON"&&a.contain(r))return n[i]}},e.prototype.addGeoCoord=function(r,n){this._nameCoordMap.set(r,n)},e.prototype.getGeoCoord=function(r){var n=this._regionsMap.get(r);return this._nameCoordMap.get(r)||n&&n.getCenter()},e.prototype.dataToPoint=function(r,n,i){if(yr(r)&&(r=this.getGeoCoord(r)),r){var a=this.projection;return a&&(r=a.project(r)),r&&this.projectedToPoint(r,n,i)}},e.prototype.pointToData=function(r){var n=this.projection;return n&&(r=n.unproject(r)),r&&this.pointToProjected(r)},e.prototype.pointToProjected=function(r){return t.prototype.pointToData.call(this,r)},e.prototype.projectedToPoint=function(r,n,i){return t.prototype.dataToPoint.call(this,r,n,i)},e.prototype.convertToPixel=function(r,n,i){var a=gH(n);return a===this?a.dataToPoint(i):null},e.prototype.convertFromPixel=function(r,n,i){var a=gH(n);return a===this?a.pointToData(i):null},e}(Ub);Ea(jK,Ub);function gH(t){var e=t.geoModel,r=t.seriesModel;return e?e.coordinateSystem:r?r.coordinateSystem||(r.getReferringComponents("geo",Ma).models[0]||{}).coordinateSystem:null}const vH=jK;function mH(t,e){var r=t.get("boundingCoords");if(r!=null){var n=r[0],i=r[1];if(isFinite(n[0])&&isFinite(n[1])&&isFinite(i[0])&&isFinite(i[1])){var a=this.projection;if(a){var l=n[0],c=n[1],o=i[0],d=i[1];n=[1/0,1/0],i=[-1/0,-1/0];var g=function($,X,W,Y){for(var J=W-$,re=Y-X,ae=0;ae<=100;ae++){var pe=ae/100,de=a.project([$+J*pe,X+re*pe]);Xf(n,n,de),Qf(i,i,de)}};g(l,c,o,c),g(o,c,o,d),g(o,d,l,d),g(l,d,o,c)}this.setBoundingRect(n[0],n[1],i[0]-n[0],i[1]-n[1])}}var m=this.getBoundingRect(),y=t.get("layoutCenter"),x=t.get("layoutSize"),A=e.getWidth(),M=e.getHeight(),D=m.width/m.height*this.aspectScale,P=!1,O,z;y&&x&&(O=[dr(y[0],A),dr(y[1],M)],z=dr(x,Math.min(A,M)),!isNaN(O[0])&&!isNaN(O[1])&&!isNaN(z)&&(P=!0));var V;if(P)V={},D>1?(V.width=z,V.height=z/D):(V.height=z,V.width=z*D),V.y=O[1]-V.height/2,V.x=O[0]-V.width/2;else{var H=t.getBoxLayoutParams();H.aspect=D,V=Na(H,{width:A,height:M})}this.setViewRect(V.x,V.y,V.width,V.height),this.setCenter(t.get("center"),e),this.setZoom(t.get("zoom"))}function gEe(t,e){fe(e.get("geoCoord"),function(r,n){t.addGeoCoord(n,r)})}var vEe=function(){function t(){this.dimensions=HK}return t.prototype.create=function(e,r){var n=[];function i(l){return{nameProperty:l.get("nameProperty"),aspectScale:l.get("aspectScale"),projection:l.get("projection")}}e.eachComponent("geo",function(l,c){var o=l.get("map"),d=new vH(o+c,o,Lt({nameMap:l.get("nameMap")},i(l)));d.zoomLimit=l.get("scaleLimit"),n.push(d),l.coordinateSystem=d,d.model=l,d.resize=mH,d.resize(l,r)}),e.eachSeries(function(l){var c=l.get("coordinateSystem");if(c==="geo"){var o=l.get("geoIndex")||0;l.coordinateSystem=n[o]}});var a={};return e.eachSeriesByType("map",function(l){if(!l.getHostGeoModel()){var c=l.getMapType();a[c]=a[c]||[],a[c].push(l)}}),fe(a,function(l,c){var o=Zt(l,function(g){return g.get("nameMap")}),d=new vH(c,c,Lt({nameMap:xz(o)},i(l[0])));d.zoomLimit=ho.apply(null,Zt(l,function(g){return g.get("scaleLimit")})),n.push(d),d.resize=mH,d.resize(l[0],r),fe(l,function(g){g.coordinateSystem=d,gEe(d,g)})}),n},t.prototype.getFilledRegions=function(e,r,n,i){for(var a=(e||[]).slice(),l=Ir(),c=0;c<a.length;c++)l.set(a[c].name,a[c]);var o=yh.load(r,n,i);return fe(o.regions,function(d){var g=d.name;!l.get(g)&&a.push({name:g})}),a},t}(),WK=new vEe,mEe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r,n,i){var a=yh.getGeoResource(r.map);if(a&&a.type==="geoJSON"){var l=r.itemStyle=r.itemStyle||{};"color"in l||(l.color="#eee")}this.mergeDefaultAndTheme(r,i),Jg(r,"label",["show"])},e.prototype.optionUpdated=function(){var r=this,n=this.option;n.regions=WK.getFilledRegions(n.regions,n.map,n.nameMap,n.nameProperty);var i={};this._optionModelMap=cc(n.regions||[],function(a,l){var c=l.name;return c&&(a.set(c,new bi(l,r,r.ecModel)),l.selected&&(i[c]=!0)),a},Ir()),n.selectedMap||(n.selectedMap=i)},e.prototype.getRegionModel=function(r){return this._optionModelMap.get(r)||new bi(null,this,this.ecModel)},e.prototype.getFormattedLabel=function(r,n){var i=this.getRegionModel(r),a=n==="normal"?i.get(["label","formatter"]):i.get(["emphasis","label","formatter"]),l={name:r};if(zr(a))return l.status=n,a(l);if(yr(a))return a.replace("{a}",r??"")},e.prototype.setZoom=function(r){this.option.zoom=r},e.prototype.setCenter=function(r){this.option.center=r},e.prototype.select=function(r){var n=this.option,i=n.selectedMode;if(i){i!=="multiple"&&(n.selectedMap=null);var a=n.selectedMap||(n.selectedMap={});a[r]=!0}},e.prototype.unSelect=function(r){var n=this.option.selectedMap;n&&(n[r]=!1)},e.prototype.toggleSelected=function(r){this[this.isSelected(r)?"unSelect":"select"](r)},e.prototype.isSelected=function(r){var n=this.option.selectedMap;return!!(n&&n[r])},e.type="geo",e.layoutMode="box",e.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},e}($n);function _H(t,e){return t.pointToProjected?t.pointToProjected(e):t.pointToData(e)}function OB(t,e,r,n){var i=t.getZoom(),a=t.getCenter(),l=e.zoom,c=t.projectedToPoint?t.projectedToPoint(a):t.dataToPoint(a);if(e.dx!=null&&e.dy!=null&&(c[0]-=e.dx,c[1]-=e.dy,t.setCenter(_H(t,c),n)),l!=null){if(r){var o=r.min||0,d=r.max||1/0;l=Math.max(Math.min(i*l,d),o)/i}t.scaleX*=l,t.scaleY*=l;var g=(e.originX-t.x)*(l-1),m=(e.originY-t.y)*(l-1);t.x-=g,t.y-=m,t.updateTransform(),t.setCenter(_H(t,c),n),t.setZoom(l*i)}return{center:t.getCenter(),zoom:t.getZoom()}}var _Ee=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.focusBlurEnabled=!0,r}return e.prototype.init=function(r,n){this._api=n},e.prototype.render=function(r,n,i,a){if(this._model=r,!r.get("show")){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;return}this._mapDraw||(this._mapDraw=new $K(i));var l=this._mapDraw;l.draw(r,n,i,this,a),l.group.on("click",this._handleRegionClick,this),l.group.silent=r.get("silent"),this.group.add(l.group),this.updateSelectStatus(r,n,i)},e.prototype._handleRegionClick=function(r){var n;Ig(r.target,function(i){return(n=Yr(i).eventData)!=null},!0),n&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:n.name})},e.prototype.updateSelectStatus=function(r,n,i){var a=this;this._mapDraw.group.traverse(function(l){var c=Yr(l).eventData;if(c)return a._model.isSelected(c.name)?i.enterSelect(l):i.leaveSelect(l),!0})},e.prototype.findHighDownDispatchers=function(r){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(r,this._model)},e.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},e.type="geo",e}(ra);function yEe(t,e,r){yh.registerMap(t,e,r)}function ZK(t){t.registerCoordinateSystem("geo",WK),t.registerComponentModel(mEe),t.registerComponentView(_Ee),t.registerImpl("registerMap",yEe),t.registerImpl("getMap",function(r){return yh.getMapForUser(r)});function e(r,n){n.update="geo:updateSelectStatus",t.registerAction(n,function(i,a){var l={},c=[];return a.eachComponent({mainType:"geo",query:i},function(o){o[r](i.name);var d=o.coordinateSystem;fe(d.regions,function(m){l[m.name]=o.isSelected(m.name)||!1});var g=[];fe(l,function(m,y){l[y]&&g.push(y)}),c.push({geoIndex:o.componentIndex,name:g})}),{selected:l,allSelected:c,name:i.name}})}e("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),e("select",{type:"geoSelect",event:"geoselected"}),e("unSelect",{type:"geoUnSelect",event:"geounselected"}),t.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(r,n,i){var a=r.componentType||"series";n.eachComponent({mainType:a,query:r},function(l){var c=l.coordinateSystem;if(c.type==="geo"){var o=OB(c,r,l.get("scaleLimit"),i);l.setCenter&&l.setCenter(o.center),l.setZoom&&l.setZoom(o.zoom),a==="series"&&fe(l.seriesGroup,function(d){d.setCenter(o.center),d.setZoom(o.zoom)})}})})}function xEe(t){En(ZK),t.registerChartView(uEe),t.registerSeriesModel(cEe),t.registerLayout(dEe),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,fEe),YX("map",t.registerAction)}function bEe(t){var e=t;e.hierNode={defaultAncestor:null,ancestor:e,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var r=[e],n,i;n=r.pop();)if(i=n.children,n.isExpand&&i.length)for(var a=i.length,l=a-1;l>=0;l--){var c=i[l];c.hierNode={defaultAncestor:null,ancestor:c,prelim:0,modifier:0,change:0,shift:0,i:l,thread:null},r.push(c)}}function wEe(t,e){var r=t.isExpand?t.children:[],n=t.parentNode.children,i=t.hierNode.i?n[t.hierNode.i-1]:null;if(r.length){AEe(t);var a=(r[0].hierNode.prelim+r[r.length-1].hierNode.prelim)/2;i?(t.hierNode.prelim=i.hierNode.prelim+e(t,i),t.hierNode.modifier=t.hierNode.prelim-a):t.hierNode.prelim=a}else i&&(t.hierNode.prelim=i.hierNode.prelim+e(t,i));t.parentNode.hierNode.defaultAncestor=CEe(t,i,t.parentNode.hierNode.defaultAncestor||n[0],e)}function SEe(t){var e=t.hierNode.prelim+t.parentNode.hierNode.modifier;t.setLayout({x:e},!0),t.hierNode.modifier+=t.parentNode.hierNode.modifier}function yH(t){return arguments.length?t:EEe}function Wx(t,e){return t-=Math.PI/2,{x:e*Math.cos(t),y:e*Math.sin(t)}}function TEe(t,e){return Na(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function AEe(t){for(var e=t.children,r=e.length,n=0,i=0;--r>=0;){var a=e[r];a.hierNode.prelim+=n,a.hierNode.modifier+=n,i+=a.hierNode.change,n+=a.hierNode.shift+i}}function CEe(t,e,r,n){if(e){for(var i=t,a=t,l=a.parentNode.children[0],c=e,o=i.hierNode.modifier,d=a.hierNode.modifier,g=l.hierNode.modifier,m=c.hierNode.modifier;c=OL(c),a=zL(a),c&&a;){i=OL(i),l=zL(l),i.hierNode.ancestor=t;var y=c.hierNode.prelim+m-a.hierNode.prelim-d+n(c,a);y>0&&(IEe(MEe(c,t,r),t,y),d+=y,o+=y),m+=c.hierNode.modifier,d+=a.hierNode.modifier,o+=i.hierNode.modifier,g+=l.hierNode.modifier}c&&!OL(i)&&(i.hierNode.thread=c,i.hierNode.modifier+=m-o),a&&!zL(l)&&(l.hierNode.thread=a,l.hierNode.modifier+=d-g,r=t)}return r}function OL(t){var e=t.children;return e.length&&t.isExpand?e[e.length-1]:t.hierNode.thread}function zL(t){var e=t.children;return e.length&&t.isExpand?e[0]:t.hierNode.thread}function MEe(t,e,r){return t.hierNode.ancestor.parentNode===e.parentNode?t.hierNode.ancestor:r}function IEe(t,e,r){var n=r/(e.hierNode.i-t.hierNode.i);e.hierNode.change-=n,e.hierNode.shift+=r,e.hierNode.modifier+=r,e.hierNode.prelim+=r,t.hierNode.change+=n}function EEe(t,e){return t.parentNode===e.parentNode?1:2}var DEe=function(){function t(){this.parentPoint=[],this.childPoints=[]}return t}(),PEe=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new DEe},e.prototype.buildPath=function(r,n){var i=n.childPoints,a=i.length,l=n.parentPoint,c=i[0],o=i[a-1];if(a===1){r.moveTo(l[0],l[1]),r.lineTo(c[0],c[1]);return}var d=n.orient,g=d==="TB"||d==="BT"?0:1,m=1-g,y=dr(n.forkPosition,1),x=[];x[g]=l[g],x[m]=l[m]+(o[m]-l[m])*y,r.moveTo(l[0],l[1]),r.lineTo(x[0],x[1]),r.moveTo(c[0],c[1]),x[g]=c[g],r.lineTo(x[0],x[1]),x[g]=o[g],r.lineTo(x[0],x[1]),r.lineTo(o[0],o[1]);for(var A=1;A<a-1;A++){var M=i[A];r.moveTo(M[0],M[1]),x[g]=M[g],r.lineTo(x[0],x[1])}},e}(kn),LEe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._mainGroup=new jr,r}return e.prototype.init=function(r,n){this._controller=new Gb(n.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},e.prototype.render=function(r,n,i){var a=r.getData(),l=r.layoutInfo,c=this._mainGroup,o=r.get("layout");o==="radial"?(c.x=l.x+l.width/2,c.y=l.y+l.height/2):(c.x=l.x,c.y=l.y),this._updateViewCoordSys(r,i),this._updateController(r,n,i);var d=this._data;a.diff(d).add(function(g){xH(a,g)&&bH(a,g,null,c,r)}).update(function(g,m){var y=d.getItemGraphicEl(m);if(!xH(a,g)){y&&SH(d,m,y,c,r);return}bH(a,g,y,c,r)}).remove(function(g){var m=d.getItemGraphicEl(g);m&&SH(d,g,m,c,r)}).execute(),this._nodeScaleRatio=r.get("nodeScaleRatio"),this._updateNodeAndLinkScale(r),r.get("expandAndCollapse")===!0&&a.eachItemGraphicEl(function(g,m){g.off("click").on("click",function(){i.dispatchAction({type:"treeExpandAndCollapse",seriesId:r.id,dataIndex:m})})}),this._data=a},e.prototype._updateViewCoordSys=function(r,n){var i=r.getData(),a=[];i.each(function(m){var y=i.getItemLayout(m);y&&!isNaN(y.x)&&!isNaN(y.y)&&a.push([+y.x,+y.y])});var l=[],c=[];sI(a,l,c);var o=this._min,d=this._max;c[0]-l[0]===0&&(l[0]=o?o[0]:l[0]-1,c[0]=d?d[0]:c[0]+1),c[1]-l[1]===0&&(l[1]=o?o[1]:l[1]-1,c[1]=d?d[1]:c[1]+1);var g=r.coordinateSystem=new Ub;g.zoomLimit=r.get("scaleLimit"),g.setBoundingRect(l[0],l[1],c[0]-l[0],c[1]-l[1]),g.setCenter(r.get("center"),n),g.setZoom(r.get("zoom")),this.group.attr({x:g.x,y:g.y,scaleX:g.scaleX,scaleY:g.scaleY}),this._min=l,this._max=c},e.prototype._updateController=function(r,n,i){var a=this,l=this._controller,c=this._controllerHost,o=this.group;l.setPointerChecker(function(d,g,m){var y=o.getBoundingRect();return y.applyTransform(o.transform),y.contain(g,m)&&!DI(d,i,r)}),l.enable(r.get("roam")),c.zoomLimit=r.get("scaleLimit"),c.zoom=r.coordinateSystem.getZoom(),l.off("pan").off("zoom").on("pan",function(d){LB(c,d.dx,d.dy),i.dispatchAction({seriesId:r.id,type:"treeRoam",dx:d.dx,dy:d.dy})}).on("zoom",function(d){RB(c,d.scale,d.originX,d.originY),i.dispatchAction({seriesId:r.id,type:"treeRoam",zoom:d.scale,originX:d.originX,originY:d.originY}),a._updateNodeAndLinkScale(r),i.updateLabelLayout()})},e.prototype._updateNodeAndLinkScale=function(r){var n=r.getData(),i=this._getNodeGlobalScale(r);n.eachItemGraphicEl(function(a,l){a.setSymbolScale(i)})},e.prototype._getNodeGlobalScale=function(r){var n=r.coordinateSystem;if(n.type!=="view")return 1;var i=this._nodeScaleRatio,a=n.scaleX||1,l=n.getZoom(),c=(l-1)*i+1;return c/a},e.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},e.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},e.type="tree",e}(Oi);function xH(t,e){var r=t.getItemLayout(e);return r&&!isNaN(r.x)&&!isNaN(r.y)}function bH(t,e,r,n,i){var a=!r,l=t.tree.getNodeByDataIndex(e),c=l.getModel(),o=l.getVisual("style").fill,d=l.isExpand===!1&&l.children.length!==0?o:"#fff",g=t.tree.root,m=l.parentNode===g?l:l.parentNode||l,y=t.getItemGraphicEl(m.dataIndex),x=m.getLayout(),A=y?{x:y.__oldX,y:y.__oldY,rawX:y.__radialOldRawX,rawY:y.__radialOldRawY}:x,M=l.getLayout();a?(r=new Ob(t,e,null,{symbolInnerColor:d,useNameLabel:!0}),r.x=A.x,r.y=A.y):r.updateData(t,e,null,{symbolInnerColor:d,useNameLabel:!0}),r.__radialOldRawX=r.__radialRawX,r.__radialOldRawY=r.__radialRawY,r.__radialRawX=M.rawX,r.__radialRawY=M.rawY,n.add(r),t.setItemGraphicEl(e,r),r.__oldX=r.x,r.__oldY=r.y,li(r,{x:M.x,y:M.y},i);var D=r.getSymbolPath();if(i.get("layout")==="radial"){var P=g.children[0],O=P.getLayout(),z=P.children.length,V=void 0,H=void 0;if(M.x===O.x&&l.isExpand===!0&&P.children.length){var $={x:(P.children[0].getLayout().x+P.children[z-1].getLayout().x)/2,y:(P.children[0].getLayout().y+P.children[z-1].getLayout().y)/2};V=Math.atan2($.y-O.y,$.x-O.x),V<0&&(V=Math.PI*2+V),H=$.x<O.x,H&&(V=V-Math.PI)}else V=Math.atan2(M.y-O.y,M.x-O.x),V<0&&(V=Math.PI*2+V),l.children.length===0||l.children.length!==0&&l.isExpand===!1?(H=M.x<O.x,H&&(V=V-Math.PI)):(H=M.x>O.x,H||(V=V-Math.PI));var X=H?"left":"right",W=c.getModel("label"),Y=W.get("rotate"),J=Y*(Math.PI/180),re=D.getTextContent();re&&(D.setTextConfig({position:W.get("position")||X,rotation:Y==null?-V:J,origin:"center"}),re.setStyle("verticalAlign","middle"))}var ae=c.get(["emphasis","focus"]),pe=ae==="relative"?wC(l.getAncestorsIndices(),l.getDescendantIndices()):ae==="ancestor"?l.getAncestorsIndices():ae==="descendant"?l.getDescendantIndices():null;pe&&(Yr(r).focus=pe),REe(i,l,g,r,A,x,M,n),r.__edge&&(r.onHoverStateChange=function(de){if(de!=="blur"){var ve=l.parentNode&&t.getItemGraphicEl(l.parentNode.dataIndex);ve&&ve.hoverState===Ab||LC(r.__edge,de)}})}function REe(t,e,r,n,i,a,l,c){var o=e.getModel(),d=t.get("edgeShape"),g=t.get("layout"),m=t.getOrient(),y=t.get(["lineStyle","curveness"]),x=t.get("edgeForkPosition"),A=o.getModel("lineStyle").getLineStyle(),M=n.__edge;if(d==="curve")e.parentNode&&e.parentNode!==r&&(M||(M=n.__edge=new Cb({shape:MO(g,m,y,i,i)})),li(M,{shape:MO(g,m,y,a,l)},t));else if(d==="polyline"&&g==="orthogonal"&&e!==r&&e.children&&e.children.length!==0&&e.isExpand===!0){for(var D=e.children,P=[],O=0;O<D.length;O++){var z=D[O].getLayout();P.push([z.x,z.y])}M||(M=n.__edge=new PEe({shape:{parentPoint:[l.x,l.y],childPoints:[[l.x,l.y]],orient:m,forkPosition:x}})),li(M,{shape:{parentPoint:[l.x,l.y],childPoints:P}},t)}M&&!(d==="polyline"&&!e.isExpand)&&(M.useStyle(Fr({strokeNoScale:!0,fill:null},A)),To(M,o,"lineStyle"),rv(M),c.add(M))}function wH(t,e,r,n,i){var a=e.tree.root,l=qK(a,t),c=l.source,o=l.sourceLayout,d=e.getItemGraphicEl(t.dataIndex);if(d){var g=e.getItemGraphicEl(c.dataIndex),m=g.__edge,y=d.__edge||(c.isExpand===!1||c.children.length===1?m:void 0),x=n.get("edgeShape"),A=n.get("layout"),M=n.get("orient"),D=n.get(["lineStyle","curveness"]);y&&(x==="curve"?md(y,{shape:MO(A,M,D,o,o),style:{opacity:0}},n,{cb:function(){r.remove(y)},removeOpt:i}):x==="polyline"&&n.get("layout")==="orthogonal"&&md(y,{shape:{parentPoint:[o.x,o.y],childPoints:[[o.x,o.y]]},style:{opacity:0}},n,{cb:function(){r.remove(y)},removeOpt:i}))}}function qK(t,e){for(var r=e.parentNode===t?e:e.parentNode||e,n;n=r.getLayout(),n==null;)r=r.parentNode===t?r:r.parentNode||r;return{source:r,sourceLayout:n}}function SH(t,e,r,n,i){var a=t.tree.getNodeByDataIndex(e),l=t.tree.root,c=qK(l,a).sourceLayout,o={duration:i.get("animationDurationUpdate"),easing:i.get("animationEasingUpdate")};md(r,{x:c.x+1,y:c.y+1},i,{cb:function(){n.remove(r),t.setItemGraphicEl(e,null)},removeOpt:o}),r.fadeOut(null,t.hostModel,{fadeLabel:!0,animation:o}),a.children.forEach(function(d){wH(d,t,n,i,o)}),wH(a,t,n,i,o)}function MO(t,e,r,n,i){var a,l,c,o,d,g,m,y;if(t==="radial"){d=n.rawX,m=n.rawY,g=i.rawX,y=i.rawY;var x=Wx(d,m),A=Wx(d,m+(y-m)*r),M=Wx(g,y+(m-y)*r),D=Wx(g,y);return{x1:x.x||0,y1:x.y||0,x2:D.x||0,y2:D.y||0,cpx1:A.x||0,cpy1:A.y||0,cpx2:M.x||0,cpy2:M.y||0}}else d=n.x,m=n.y,g=i.x,y=i.y,(e==="LR"||e==="RL")&&(a=d+(g-d)*r,l=m,c=g+(d-g)*r,o=y),(e==="TB"||e==="BT")&&(a=d,l=m+(y-m)*r,c=g,o=y+(m-y)*r);return{x1:d,y1:m,x2:g,y2:y,cpx1:a,cpy1:l,cpx2:c,cpy2:o}}var Ll=ri();function YK(t){var e=t.mainData,r=t.datas;r||(r={main:e},t.datasAttr={main:"data"}),t.datas=t.mainData=null,XK(e,r,t),fe(r,function(n){fe(e.TRANSFERABLE_METHODS,function(i){n.wrapMethod(i,on(kEe,t))})}),e.wrapMethod("cloneShallow",on(zEe,t)),fe(e.CHANGABLE_METHODS,function(n){e.wrapMethod(n,on(OEe,t))}),ns(r[e.dataType]===e)}function kEe(t,e){if(NEe(this)){var r=Lt({},Ll(this).datas);r[this.dataType]=e,XK(e,r,t)}else zB(e,this.dataType,Ll(this).mainData,t);return e}function OEe(t,e){return t.struct&&t.struct.update(),e}function zEe(t,e){return fe(Ll(e).datas,function(r,n){r!==e&&zB(r.cloneShallow(),n,e,t)}),e}function BEe(t){var e=Ll(this).mainData;return t==null||e==null?e:Ll(e).datas[t]}function FEe(){var t=Ll(this).mainData;return t==null?[{data:t}]:Zt(Hn(Ll(t).datas),function(e){return{type:e,data:Ll(t).datas[e]}})}function NEe(t){return Ll(t).mainData===t}function XK(t,e,r){Ll(t).datas={},fe(e,function(n,i){zB(n,i,t,r)})}function zB(t,e,r,n){Ll(r).datas[e]=t,Ll(t).mainData=r,t.dataType=e,n.struct&&(t[n.structAttr]=n.struct,n.struct[n.datasAttr[e]]=t),t.getLinkedData=BEe,t.getLinkedDataAll=FEe}var VEe=function(){function t(e,r){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=e||"",this.hostTree=r}return t.prototype.isRemoved=function(){return this.dataIndex<0},t.prototype.eachNode=function(e,r,n){zr(e)&&(n=r,r=e,e=null),e=e||{},yr(e)&&(e={order:e});var i=e.order||"preorder",a=this[e.attr||"children"],l;i==="preorder"&&(l=r.call(n,this));for(var c=0;!l&&c<a.length;c++)a[c].eachNode(e,r,n);i==="postorder"&&r.call(n,this)},t.prototype.updateDepthAndHeight=function(e){var r=0;this.depth=e;for(var n=0;n<this.children.length;n++){var i=this.children[n];i.updateDepthAndHeight(e+1),i.height>r&&(r=i.height)}this.height=r+1},t.prototype.getNodeById=function(e){if(this.getId()===e)return this;for(var r=0,n=this.children,i=n.length;r<i;r++){var a=n[r].getNodeById(e);if(a)return a}},t.prototype.contains=function(e){if(e===this)return!0;for(var r=0,n=this.children,i=n.length;r<i;r++){var a=n[r].contains(e);if(a)return a}},t.prototype.getAncestors=function(e){for(var r=[],n=e?this:this.parentNode;n;)r.push(n),n=n.parentNode;return r.reverse(),r},t.prototype.getAncestorsIndices=function(){for(var e=[],r=this;r;)e.push(r.dataIndex),r=r.parentNode;return e.reverse(),e},t.prototype.getDescendantIndices=function(){var e=[];return this.eachNode(function(r){e.push(r.dataIndex)}),e},t.prototype.getValue=function(e){var r=this.hostTree.data;return r.getStore().get(r.getDimensionIndex(e||"value"),this.dataIndex)},t.prototype.setLayout=function(e,r){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,e,r)},t.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},t.prototype.getModel=function(e){if(!(this.dataIndex<0)){var r=this.hostTree,n=r.data.getItemModel(this.dataIndex);return n.getModel(e)}},t.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},t.prototype.setVisual=function(e,r){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,e,r)},t.prototype.getVisual=function(e){return this.hostTree.data.getItemVisual(this.dataIndex,e)},t.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},t.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},t.prototype.getChildIndex=function(){if(this.parentNode){for(var e=this.parentNode.children,r=0;r<e.length;++r)if(e[r]===this)return r;return-1}return-1},t.prototype.isAncestorOf=function(e){for(var r=e.parentNode;r;){if(r===this)return!0;r=r.parentNode}return!1},t.prototype.isDescendantOf=function(e){return e!==this&&e.isAncestorOf(this)},t}(),BB=function(){function t(e){this.type="tree",this._nodes=[],this.hostModel=e}return t.prototype.eachNode=function(e,r,n){this.root.eachNode(e,r,n)},t.prototype.getNodeByDataIndex=function(e){var r=this.data.getRawIndex(e);return this._nodes[r]},t.prototype.getNodeById=function(e){return this.root.getNodeById(e)},t.prototype.update=function(){for(var e=this.data,r=this._nodes,n=0,i=r.length;n<i;n++)r[n].dataIndex=-1;for(var n=0,i=e.count();n<i;n++)r[e.getRawIndex(n)].dataIndex=n},t.prototype.clearLayouts=function(){this.data.clearItemLayouts()},t.createTree=function(e,r,n){var i=new t(r),a=[],l=1;c(e);function c(g,m){var y=g.value;l=Math.max(l,Ht(y)?y.length:1),a.push(g);var x=new VEe(za(g.name,""),i);m?GEe(x,m):i.root=x,i._nodes.push(x);var A=g.children;if(A)for(var M=0;M<A.length;M++)c(A[M],x)}i.root.updateDepthAndHeight(0);var o=Lb(a,{coordDimensions:["value"],dimensionsCount:l}).dimensions,d=new ts(o,r);return d.initData(a),n&&n(d),YK({mainData:d,struct:i,structAttr:"tree"}),i.update(),i},t}();function GEe(t,e){var r=e.children;t.parentNode!==e&&(r.push(t),t.parentNode=e)}function ib(t,e,r){if(t&&An(e,t.type)>=0){var n=r.getData().tree.root,i=t.targetNode;if(yr(i)&&(i=n.getNodeById(i)),i&&n.contains(i))return{node:i};var a=t.targetNodeId;if(a!=null&&(i=n.getNodeById(a)))return{node:i}}}function QK(t){for(var e=[];t;)t=t.parentNode,t&&e.push(t);return e.reverse()}function FB(t,e){var r=QK(t);return An(r,e)>=0}function LI(t,e){for(var r=[];t;){var n=t.dataIndex;r.push({name:t.name,dataIndex:n,value:e.getRawValue(n)}),t=t.parentNode}return r.reverse(),r}var UEe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.hasSymbolVisual=!0,r.ignoreStyleOnData=!0,r}return e.prototype.getInitialData=function(r){var n={name:r.name,children:r.data},i=r.leaves||{},a=new bi(i,this,this.ecModel),l=BB.createTree(n,this,c);function c(m){m.wrapMethod("getItemModel",function(y,x){var A=l.getNodeByDataIndex(x);return A&&A.children.length&&A.isExpand||(y.parentModel=a),y})}var o=0;l.eachNode("preorder",function(m){m.depth>o&&(o=m.depth)});var d=r.expandAndCollapse,g=d&&r.initialTreeDepth>=0?r.initialTreeDepth:o;return l.root.eachNode("preorder",function(m){var y=m.hostTree.data.getRawDataItem(m.dataIndex);m.isExpand=y&&y.collapsed!=null?!y.collapsed:m.depth<=g}),l.data},e.prototype.getOrient=function(){var r=this.get("orient");return r==="horizontal"?r="LR":r==="vertical"&&(r="TB"),r},e.prototype.setZoom=function(r){this.option.zoom=r},e.prototype.setCenter=function(r){this.option.center=r},e.prototype.formatTooltip=function(r,n,i){for(var a=this.getData().tree,l=a.root.children[0],c=a.getNodeByDataIndex(r),o=c.getValue(),d=c.name;c&&c!==l;)d=c.parentNode.name+"."+d,c=c.parentNode;return ro("nameValue",{name:d,value:o,noValue:isNaN(o)||o==null})},e.prototype.getDataParams=function(r){var n=t.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(r);return n.treeAncestors=LI(i,this),n.collapsed=!i.isExpand,n},e.type="series.tree",e.layoutMode="box",e.defaultOption={z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},e}(Wi);function $Ee(t,e,r){for(var n=[t],i=[],a;a=n.pop();)if(i.push(a),a.isExpand){var l=a.children;if(l.length)for(var c=0;c<l.length;c++)n.push(l[c])}for(;a=i.pop();)e(a,r)}function Ix(t,e){for(var r=[t],n;n=r.pop();)if(e(n),n.isExpand){var i=n.children;if(i.length)for(var a=i.length-1;a>=0;a--)r.push(i[a])}}function HEe(t,e){t.eachSeriesByType("tree",function(r){jEe(r,e)})}function jEe(t,e){var r=TEe(t,e);t.layoutInfo=r;var n=t.get("layout"),i=0,a=0,l=null;n==="radial"?(i=2*Math.PI,a=Math.min(r.height,r.width)/2,l=yH(function(z,V){return(z.parentNode===V.parentNode?1:2)/z.depth})):(i=r.width,a=r.height,l=yH());var c=t.getData().tree.root,o=c.children[0];if(o){bEe(c),$Ee(o,wEe,l),c.hierNode.modifier=-o.hierNode.prelim,Ix(o,SEe);var d=o,g=o,m=o;Ix(o,function(z){var V=z.getLayout().x;V<d.getLayout().x&&(d=z),V>g.getLayout().x&&(g=z),z.depth>m.depth&&(m=z)});var y=d===g?1:l(d,g)/2,x=y-d.getLayout().x,A=0,M=0,D=0,P=0;if(n==="radial")A=i/(g.getLayout().x+y+x),M=a/(m.depth-1||1),Ix(o,function(z){D=(z.getLayout().x+x)*A,P=(z.depth-1)*M;var V=Wx(D,P);z.setLayout({x:V.x,y:V.y,rawX:D,rawY:P},!0)});else{var O=t.getOrient();O==="RL"||O==="LR"?(M=a/(g.getLayout().x+y+x),A=i/(m.depth-1||1),Ix(o,function(z){P=(z.getLayout().x+x)*M,D=O==="LR"?(z.depth-1)*A:i-(z.depth-1)*A,z.setLayout({x:D,y:P},!0)})):(O==="TB"||O==="BT")&&(A=i/(g.getLayout().x+y+x),M=a/(m.depth-1||1),Ix(o,function(z){D=(z.getLayout().x+x)*A,P=O==="TB"?(z.depth-1)*M:a-(z.depth-1)*M,z.setLayout({x:D,y:P},!0)}))}}}function WEe(t){t.eachSeriesByType("tree",function(e){var r=e.getData(),n=r.tree;n.eachNode(function(i){var a=i.getModel(),l=a.getModel("itemStyle").getItemStyle(),c=r.ensureUniqueItemVisual(i.dataIndex,"style");Lt(c,l)})})}function ZEe(t){t.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(e,r){r.eachComponent({mainType:"series",subType:"tree",query:e},function(n){var i=e.dataIndex,a=n.getData().tree,l=a.getNodeByDataIndex(i);l.isExpand=!l.isExpand})}),t.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(e,r,n){r.eachComponent({mainType:"series",subType:"tree",query:e},function(i){var a=i.coordinateSystem,l=OB(a,e,void 0,n);i.setCenter&&i.setCenter(l.center),i.setZoom&&i.setZoom(l.zoom)})})}function qEe(t){t.registerChartView(LEe),t.registerSeriesModel(UEe),t.registerLayout(HEe),t.registerVisual(WEe),ZEe(t)}var TH=["treemapZoomToNode","treemapRender","treemapMove"];function YEe(t){for(var e=0;e<TH.length;e++)t.registerAction({type:TH[e],update:"updateView"},Sa);t.registerAction({type:"treemapRootToNode",update:"updateView"},function(r,n){n.eachComponent({mainType:"series",subType:"treemap",query:r},i);function i(a,l){var c=["treemapZoomToNode","treemapRootToNode"],o=ib(r,c,a);if(o){var d=a.getViewRoot();d&&(r.direction=FB(d,o.node)?"rollUp":"drillDown"),a.resetViewRoot(o.node)}}})}function KK(t){var e=t.getData(),r=e.tree,n={};r.eachNode(function(i){for(var a=i;a&&a.depth>1;)a=a.parentNode;var l=rO(t.ecModel,a.name||a.dataIndex+"",n);i.setVisual("decal",l)})}var XEe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.preventUsingHoverLayer=!0,r}return e.prototype.getInitialData=function(r,n){var i={name:r.name,children:r.data};JK(i);var a=r.levels||[],l=this.designatedVisualItemStyle={},c=new bi({itemStyle:l},this,n);a=r.levels=QEe(a,n);var o=Zt(a||[],function(m){return new bi(m,c,n)},this),d=BB.createTree(i,this,g);function g(m){m.wrapMethod("getItemModel",function(y,x){var A=d.getNodeByDataIndex(x),M=A?o[A.depth]:null;return y.parentModel=M||c,y})}return d.data},e.prototype.optionUpdated=function(){this.resetViewRoot()},e.prototype.formatTooltip=function(r,n,i){var a=this.getData(),l=this.getRawValue(r),c=a.getName(r);return ro("nameValue",{name:c,value:l})},e.prototype.getDataParams=function(r){var n=t.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(r);return n.treeAncestors=LI(i,this),n.treePathInfo=n.treeAncestors,n},e.prototype.setLayoutInfo=function(r){this.layoutInfo=this.layoutInfo||{},Lt(this.layoutInfo,r)},e.prototype.mapIdToIndex=function(r){var n=this._idIndexMap;n||(n=this._idIndexMap=Ir(),this._idIndexMapCount=0);var i=n.get(r);return i==null&&n.set(r,i=this._idIndexMapCount++),i},e.prototype.getViewRoot=function(){return this._viewRoot},e.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var n=this.getRawData().tree.root;(!r||r!==n&&!n.contains(r))&&(this._viewRoot=n)},e.prototype.enableAriaDecal=function(){KK(this)},e.type="series.treemap",e.layoutMode="box",e.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"",zoomToNodeRatio:.32*.32,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},e}(Wi);function JK(t){var e=0;fe(t.children,function(n){JK(n);var i=n.value;Ht(i)&&(i=i[0]),e+=i});var r=t.value;Ht(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=e),r<0&&(r=0),Ht(t.value)?t.value[0]=r:t.value=r}function QEe(t,e){var r=Pi(e.get("color")),n=Pi(e.get(["aria","decal","decals"]));if(r){t=t||[];var i,a;fe(t,function(c){var o=new bi(c),d=o.get("color"),g=o.get("decal");(o.get(["itemStyle","color"])||d&&d!=="none")&&(i=!0),(o.get(["itemStyle","decal"])||g&&g!=="none")&&(a=!0)});var l=t[0]||(t[0]={});return i||(l.color=r.slice()),!a&&n&&(l.decal=n.slice()),t}}var KEe=8,AH=8,BL=5,JEe=function(){function t(e){this.group=new jr,e.add(this.group)}return t.prototype.render=function(e,r,n,i){var a=e.getModel("breadcrumb"),l=this.group;if(l.removeAll(),!(!a.get("show")||!n)){var c=a.getModel("itemStyle"),o=a.getModel("emphasis"),d=c.getModel("textStyle"),g=o.getModel(["itemStyle","textStyle"]),m={pos:{left:a.get("left"),right:a.get("right"),top:a.get("top"),bottom:a.get("bottom")},box:{width:r.getWidth(),height:r.getHeight()},emptyItemWidth:a.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(n,m,d),this._renderContent(e,m,c,o,d,g,i),xI(l,m.pos,m.box)}},t.prototype._prepare=function(e,r,n){for(var i=e;i;i=i.parentNode){var a=za(i.getModel().get("name"),""),l=n.getTextRect(a),c=Math.max(l.width+KEe*2,r.emptyItemWidth);r.totalWidth+=c+AH,r.renderList.push({node:i,text:a,width:c})}},t.prototype._renderContent=function(e,r,n,i,a,l,c){for(var o=0,d=r.emptyItemWidth,g=e.get(["breadcrumb","height"]),m=uwe(r.pos,r.box),y=r.totalWidth,x=r.renderList,A=i.getModel("itemStyle").getItemStyle(),M=x.length-1;M>=0;M--){var D=x[M],P=D.node,O=D.width,z=D.text;y>m.width&&(y-=O-d,O=d,z=null);var V=new os({shape:{points:eDe(o,0,O,g,M===x.length-1,M===0)},style:Fr(n.getItemStyle(),{lineJoin:"bevel"}),textContent:new ti({style:Hi(a,{text:z})}),textConfig:{position:"inside"},z2:sy*1e4,onclick:on(c,P)});V.disableLabelAnimation=!0,V.getTextContent().ensureState("emphasis").style=Hi(l,{text:z}),V.ensureState("emphasis").style=A,da(V,i.get("focus"),i.get("blurScope"),i.get("disabled")),this.group.add(V),tDe(V,e,P),o+=O+AH}},t.prototype.remove=function(){this.group.removeAll()},t}();function eDe(t,e,r,n,i,a){var l=[[i?t:t-BL,e],[t+r,e],[t+r,e+n],[i?t:t-BL,e+n]];return!a&&l.splice(2,0,[t+r+BL,e+n/2]),!i&&l.push([t,e+n/2]),l}function tDe(t,e,r){Yr(t).eventData={componentType:"series",componentSubType:"treemap",componentIndex:e.componentIndex,seriesIndex:e.seriesIndex,seriesName:e.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:r&&r.dataIndex,name:r&&r.name},treePathInfo:r&&LI(r,e)}}var rDe=function(){function t(){this._storage=[],this._elExistsMap={}}return t.prototype.add=function(e,r,n,i,a){return this._elExistsMap[e.id]?!1:(this._elExistsMap[e.id]=!0,this._storage.push({el:e,target:r,duration:n,delay:i,easing:a}),!0)},t.prototype.finished=function(e){return this._finishedCallback=e,this},t.prototype.start=function(){for(var e=this,r=this._storage.length,n=function(){r--,r<=0&&(e._storage.length=0,e._elExistsMap={},e._finishedCallback&&e._finishedCallback())},i=0,a=this._storage.length;i<a;i++){var l=this._storage[i];l.el.animateTo(l.target,{duration:l.duration,delay:l.delay,easing:l.easing,setToFinal:!0,done:n,aborted:n})}return this},t}();function nDe(){return new rDe}var IO=jr,CH=Kn,MH=3,IH="label",EH="upperLabel",iDe=sy*10,aDe=sy*2,oDe=sy*3,cg=tv([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),DH=function(t){var e=cg(t);return e.stroke=e.fill=e.lineWidth=null,e},eM=ri(),sDe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._state="ready",r._storage=Ex(),r}return e.prototype.render=function(r,n,i,a){var l=n.findComponents({mainType:"series",subType:"treemap",query:a});if(!(An(l,r)<0)){this.seriesModel=r,this.api=i,this.ecModel=n;var c=["treemapZoomToNode","treemapRootToNode"],o=ib(a,c,r),d=a&&a.type,g=r.layoutInfo,m=!this._oldTree,y=this._storage,x=d==="treemapRootToNode"&&o&&y?{rootNodeGroup:y.nodeGroup[o.node.getRawIndex()],direction:a.direction}:null,A=this._giveContainerGroup(g),M=r.get("animation"),D=this._doRender(A,r,x);M&&!m&&(!d||d==="treemapZoomToNode"||d==="treemapRootToNode")?this._doAnimation(A,D,r,x):D.renderFinally(),this._resetController(i),this._renderBreadcrumb(r,i,o)}},e.prototype._giveContainerGroup=function(r){var n=this._containerGroup;return n||(n=this._containerGroup=new IO,this._initEvents(n),this.group.add(n)),n.x=r.x,n.y=r.y,n},e.prototype._doRender=function(r,n,i){var a=n.getData().tree,l=this._oldTree,c=Ex(),o=Ex(),d=this._storage,g=[];function m(D,P,O,z){return lDe(n,o,d,i,c,g,D,P,O,z)}x(a.root?[a.root]:[],l&&l.root?[l.root]:[],r,a===l||!l,0);var y=A(d);return this._oldTree=a,this._storage=o,{lastsForAnimation:c,willDeleteEls:y,renderFinally:M};function x(D,P,O,z,V){z?(P=D,fe(D,function(X,W){!X.isRemoved()&&$(W,W)})):new mh(P,D,H,H).add($).update($).remove(on($,null)).execute();function H(X){return X.getId()}function $(X,W){var Y=X!=null?D[X]:null,J=W!=null?P[W]:null,re=m(Y,J,O,V);re&&x(Y&&Y.viewChildren||[],J&&J.viewChildren||[],re,z,V+1)}}function A(D){var P=Ex();return D&&fe(D,function(O,z){var V=P[z];fe(O,function(H){H&&(V.push(H),eM(H).willDelete=!0)})}),P}function M(){fe(y,function(D){fe(D,function(P){P.parent&&P.parent.remove(P)})}),fe(g,function(D){D.invisible=!0,D.dirty()})}},e.prototype._doAnimation=function(r,n,i,a){var l=i.get("animationDurationUpdate"),c=i.get("animationEasing"),o=(zr(l)?0:l)||0,d=(zr(c)?null:c)||"cubicOut",g=nDe();fe(n.willDeleteEls,function(m,y){fe(m,function(x,A){if(!x.invisible){var M=x.parent,D,P=eM(M);if(a&&a.direction==="drillDown")D=M===a.rootNodeGroup?{shape:{x:0,y:0,width:P.nodeWidth,height:P.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var O=0,z=0;P.willDelete||(O=P.nodeWidth/2,z=P.nodeHeight/2),D=y==="nodeGroup"?{x:O,y:z,style:{opacity:0}}:{shape:{x:O,y:z,width:0,height:0},style:{opacity:0}}}D&&g.add(x,D,o,0,d)}})}),fe(this._storage,function(m,y){fe(m,function(x,A){var M=n.lastsForAnimation[y][A],D={};M&&(x instanceof jr?M.oldX!=null&&(D.x=x.x,D.y=x.y,x.x=M.oldX,x.y=M.oldY):(M.oldShape&&(D.shape=Lt({},x.shape),x.setShape(M.oldShape)),M.fadein?(x.setStyle("opacity",0),D.style={opacity:1}):x.style.opacity!==1&&(D.style={opacity:1})),g.add(x,D,o,0,d))})},this),this._state="animating",g.finished(wr(function(){this._state="ready",n.renderFinally()},this)).start()},e.prototype._resetController=function(r){var n=this._controller;n||(n=this._controller=new Gb(r.getZr()),n.enable(this.seriesModel.get("roam")),n.on("pan",wr(this._onPan,this)),n.on("zoom",wr(this._onZoom,this)));var i=new gn(0,0,r.getWidth(),r.getHeight());n.setPointerChecker(function(a,l,c){return i.contain(l,c)})},e.prototype._clearController=function(){var r=this._controller;r&&(r.dispose(),r=null)},e.prototype._onPan=function(r){if(this._state!=="animating"&&(Math.abs(r.dx)>MH||Math.abs(r.dy)>MH)){var n=this.seriesModel.getData().tree.root;if(!n)return;var i=n.getLayout();if(!i)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:i.x+r.dx,y:i.y+r.dy,width:i.width,height:i.height}})}},e.prototype._onZoom=function(r){var n=r.originX,i=r.originY;if(this._state!=="animating"){var a=this.seriesModel.getData().tree.root;if(!a)return;var l=a.getLayout();if(!l)return;var c=new gn(l.x,l.y,l.width,l.height),o=this.seriesModel.layoutInfo;n-=o.x,i-=o.y;var d=Qs();hc(d,d,[-n,-i]),Az(d,d,[r.scale,r.scale]),hc(d,d,[n,i]),c.applyTransform(d),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:c.x,y:c.y,width:c.width,height:c.height}})}},e.prototype._initEvents=function(r){var n=this;r.on("click",function(i){if(n._state==="ready"){var a=n.seriesModel.get("nodeClick",!0);if(a){var l=n.findTarget(i.offsetX,i.offsetY);if(l){var c=l.node;if(c.getLayout().isLeafRoot)n._rootToNode(l);else if(a==="zoomToNode")n._zoomToNode(l);else if(a==="link"){var o=c.hostTree.data.getItemModel(c.dataIndex),d=o.get("link",!0),g=o.get("target",!0)||"blank";d&&FC(d,g)}}}}},this)},e.prototype._renderBreadcrumb=function(r,n,i){var a=this;i||(i=r.get("leafDepth",!0)!=null?{node:r.getViewRoot()}:this.findTarget(n.getWidth()/2,n.getHeight()/2),i||(i={node:r.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new JEe(this.group))).render(r,n,i.node,function(l){a._state!=="animating"&&(FB(r.getViewRoot(),l)?a._rootToNode({node:l}):a._zoomToNode({node:l}))})},e.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=Ex(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},e.prototype.dispose=function(){this._clearController()},e.prototype._zoomToNode=function(r){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},e.prototype._rootToNode=function(r){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},e.prototype.findTarget=function(r,n){var i,a=this.seriesModel.getViewRoot();return a.eachNode({attr:"viewChildren",order:"preorder"},function(l){var c=this._storage.background[l.getRawIndex()];if(c){var o=c.transformCoordToLocal(r,n),d=c.shape;if(d.x<=o[0]&&o[0]<=d.x+d.width&&d.y<=o[1]&&o[1]<=d.y+d.height)i={node:l,offsetX:o[0],offsetY:o[1]};else return!1}},this),i},e.type="treemap",e}(Oi);function Ex(){return{nodeGroup:[],background:[],content:[]}}function lDe(t,e,r,n,i,a,l,c,o,d){if(!l)return;var g=l.getLayout(),m=t.getData(),y=l.getModel();if(m.setItemGraphicEl(l.dataIndex,null),!g||!g.isInView)return;var x=g.width,A=g.height,M=g.borderWidth,D=g.invisible,P=l.getRawIndex(),O=c&&c.getRawIndex(),z=l.viewChildren,V=g.upperHeight,H=z&&z.length,$=y.getModel("itemStyle"),X=y.getModel(["emphasis","itemStyle"]),W=y.getModel(["blur","itemStyle"]),Y=y.getModel(["select","itemStyle"]),J=$.get("borderRadius")||0,re=Et("nodeGroup",IO);if(!re)return;if(o.add(re),re.x=g.x||0,re.y=g.y||0,re.markRedraw(),eM(re).nodeWidth=x,eM(re).nodeHeight=A,g.isAboveViewRoot)return re;var ae=Et("background",CH,d,aDe);ae&&Ee(re,ae,H&&g.upperLabelHeight);var pe=y.getModel("emphasis"),de=pe.get("focus"),ve=pe.get("blurScope"),me=pe.get("disabled"),Ie=de==="ancestor"?l.getAncestorsIndices():de==="descendant"?l.getDescendantIndices():de;if(H)j1(re)&&Cg(re,!1),ae&&(Cg(ae,!me),m.setItemGraphicEl(l.dataIndex,ae),qk(ae,Ie,ve));else{var Le=Et("content",CH,d,oDe);Le&&Ue(re,Le),ae.disableMorphing=!0,ae&&j1(ae)&&Cg(ae,!1),Cg(re,!me),m.setItemGraphicEl(l.dataIndex,re),qk(re,Ie,ve)}return re;function Ee(cr,lt,qt){var Ut=Yr(lt);if(Ut.dataIndex=l.dataIndex,Ut.seriesIndex=t.seriesIndex,lt.setShape({x:0,y:0,width:x,height:A,r:J}),D)Ke(lt);else{lt.invisible=!1;var rr=l.getVisual("style"),br=rr.stroke,Oe=DH($);Oe.fill=br;var $e=cg(X);$e.fill=X.get("borderColor");var ct=cg(W);ct.fill=W.get("borderColor");var bt=cg(Y);if(bt.fill=Y.get("borderColor"),qt){var At=x-2*M;We(lt,br,rr.opacity,{x:M,y:0,width:At,height:V})}else lt.removeTextContent();lt.setStyle(Oe),lt.ensureState("emphasis").style=$e,lt.ensureState("blur").style=ct,lt.ensureState("select").style=bt,rv(lt)}cr.add(lt)}function Ue(cr,lt){var qt=Yr(lt);qt.dataIndex=l.dataIndex,qt.seriesIndex=t.seriesIndex;var Ut=Math.max(x-2*M,0),rr=Math.max(A-2*M,0);if(lt.culling=!0,lt.setShape({x:M,y:M,width:Ut,height:rr,r:J}),D)Ke(lt);else{lt.invisible=!1;var br=l.getVisual("style"),Oe=br.fill,$e=DH($);$e.fill=Oe,$e.decal=br.decal;var ct=cg(X),bt=cg(W),At=cg(Y);We(lt,Oe,br.opacity,null),lt.setStyle($e),lt.ensureState("emphasis").style=ct,lt.ensureState("blur").style=bt,lt.ensureState("select").style=At,rv(lt)}cr.add(lt)}function Ke(cr){!cr.invisible&&a.push(cr)}function We(cr,lt,qt,Ut){var rr=y.getModel(Ut?EH:IH),br=za(y.get("name"),null),Oe=rr.getShallow("show");Ao(cr,to(y,Ut?EH:IH),{defaultText:Oe?br:null,inheritColor:lt,defaultOpacity:qt,labelFetcher:t,labelDataIndex:l.dataIndex});var $e=cr.getTextContent();if($e){var ct=$e.style,bt=wz(ct.padding||0);Ut&&(cr.setTextConfig({layoutRect:Ut}),$e.disableLabelLayout=!0),$e.beforeUpdate=function(){var Jt=Math.max((Ut?Ut.width:cr.shape.width)-bt[1]-bt[3],0),mt=Math.max((Ut?Ut.height:cr.shape.height)-bt[0]-bt[2],0);(ct.width!==Jt||ct.height!==mt)&&$e.setStyle({width:Jt,height:mt})},ct.truncateMinChar=2,ct.lineOverflow="truncate",Rt(ct,Ut,g);var At=$e.getState("emphasis");Rt(At?At.style:null,Ut,g)}}function Rt(cr,lt,qt){var Ut=cr?cr.text:null;if(!lt&&qt.isLeafRoot&&Ut!=null){var rr=t.get("drillDownIcon",!0);cr.text=rr?rr+" "+Ut:Ut}}function Et(cr,lt,qt,Ut){var rr=O!=null&&r[cr][O],br=i[cr];return rr?(r[cr][O]=null,ar(br,rr)):D||(rr=new lt,rr instanceof zl&&(rr.z2=uDe(qt,Ut)),ur(br,rr)),e[cr][P]=rr}function ar(cr,lt){var qt=cr[P]={};lt instanceof IO?(qt.oldX=lt.x,qt.oldY=lt.y):qt.oldShape=Lt({},lt.shape)}function ur(cr,lt){var qt=cr[P]={},Ut=l.parentNode,rr=lt instanceof jr;if(Ut&&(!n||n.direction==="drillDown")){var br=0,Oe=0,$e=i.background[Ut.getRawIndex()];!n&&$e&&$e.oldShape&&(br=$e.oldShape.width,Oe=$e.oldShape.height),rr?(qt.oldX=0,qt.oldY=Oe):qt.oldShape={x:br,y:Oe,width:0,height:0}}qt.fadein=!rr}}function uDe(t,e){return t*iDe+e}var ab=fe,cDe=Ur,tM=-1,eo=function(){function t(e){var r=e.mappingMethod,n=e.type,i=this.option=$r(e);this.type=n,this.mappingMethod=r,this._normalizeData=dDe[r];var a=t.visualHandlers[n];this.applyVisual=a.applyVisual,this.getColorMapper=a.getColorMapper,this._normalizedToVisual=a._normalizedToVisual[r],r==="piecewise"?(FL(i),hDe(i)):r==="category"?i.categories?fDe(i):FL(i,!0):(ns(r!=="linear"||i.dataExtent),FL(i))}return t.prototype.mapValueToVisual=function(e){var r=this._normalizeData(e);return this._normalizedToVisual(r,e)},t.prototype.getNormalizer=function(){return wr(this._normalizeData,this)},t.listVisualTypes=function(){return Hn(t.visualHandlers)},t.isValidType=function(e){return t.visualHandlers.hasOwnProperty(e)},t.eachVisual=function(e,r,n){Ur(e)?fe(e,r,n):r.call(n,e)},t.mapVisual=function(e,r,n){var i,a=Ht(e)?[]:Ur(e)?{}:(i=!0,null);return t.eachVisual(e,function(l,c){var o=r.call(n,l,c);i?a=o:a[c]=o}),a},t.retrieveVisuals=function(e){var r={},n;return e&&ab(t.visualHandlers,function(i,a){e.hasOwnProperty(a)&&(r[a]=e[a],n=!0)}),n?r:null},t.prepareVisualTypes=function(e){if(Ht(e))e=e.slice();else if(cDe(e)){var r=[];ab(e,function(n,i){r.push(i)}),e=r}else return[];return e.sort(function(n,i){return i==="color"&&n!=="color"&&n.indexOf("color")===0?1:-1}),e},t.dependsOn=function(e,r){return r==="color"?!!(e&&e.indexOf(r)===0):e===r},t.findPieceIndex=function(e,r,n){for(var i,a=1/0,l=0,c=r.length;l<c;l++){var o=r[l].value;if(o!=null){if(o===e||yr(o)&&o===e+"")return l;n&&y(o,l)}}for(var l=0,c=r.length;l<c;l++){var d=r[l],g=d.interval,m=d.close;if(g){if(g[0]===-1/0){if(oA(m[1],e,g[1]))return l}else if(g[1]===1/0){if(oA(m[0],g[0],e))return l}else if(oA(m[0],g[0],e)&&oA(m[1],e,g[1]))return l;n&&y(g[0],l),n&&y(g[1],l)}}if(n)return e===1/0?r.length-1:e===-1/0?0:i;function y(x,A){var M=Math.abs(x-e);M<a&&(a=M,i=A)}},t.visualHandlers={color:{applyVisual:Dx("color"),getColorMapper:function(){var e=this.option;return wr(e.mappingMethod==="category"?function(r,n){return!n&&(r=this._normalizeData(r)),Zx.call(this,r)}:function(r,n,i){var a=!!i;return!n&&(r=this._normalizeData(r)),i=_P(r,e.parsedVisual,i),a?i:sh(i,"rgba")},this)},_normalizedToVisual:{linear:function(e){return sh(_P(e,this.option.parsedVisual),"rgba")},category:Zx,piecewise:function(e,r){var n=DO.call(this,r);return n==null&&(n=sh(_P(e,this.option.parsedVisual),"rgba")),n},fixed:hg}},colorHue:aA(function(e,r){return c1(e,r)}),colorSaturation:aA(function(e,r){return c1(e,null,r)}),colorLightness:aA(function(e,r){return c1(e,null,null,r)}),colorAlpha:aA(function(e,r){return CC(e,r)}),decal:{applyVisual:Dx("decal"),_normalizedToVisual:{linear:null,category:Zx,piecewise:null,fixed:null}},opacity:{applyVisual:Dx("opacity"),_normalizedToVisual:EO([0,1])},liftZ:{applyVisual:Dx("liftZ"),_normalizedToVisual:{linear:hg,category:hg,piecewise:hg,fixed:hg}},symbol:{applyVisual:function(e,r,n){var i=this.mapValueToVisual(e);n("symbol",i)},_normalizedToVisual:{linear:PH,category:Zx,piecewise:function(e,r){var n=DO.call(this,r);return n==null&&(n=PH.call(this,e)),n},fixed:hg}},symbolSize:{applyVisual:Dx("symbolSize"),_normalizedToVisual:EO([0,1])}},t}();function hDe(t){var e=t.pieceList;t.hasSpecialVisual=!1,fe(e,function(r,n){r.originIndex=n,r.visual!=null&&(t.hasSpecialVisual=!0)})}function fDe(t){var e=t.categories,r=t.categoryMap={},n=t.visual;if(ab(e,function(l,c){r[l]=c}),!Ht(n)){var i=[];Ur(n)?ab(n,function(l,c){var o=r[c];i[o??tM]=l}):i[tM]=n,n=eJ(t,i)}for(var a=e.length-1;a>=0;a--)n[a]==null&&(delete r[e[a]],e.pop())}function FL(t,e){var r=t.visual,n=[];Ur(r)?ab(r,function(a){n.push(a)}):r!=null&&n.push(r);var i={color:1,symbol:1};!e&&n.length===1&&!i.hasOwnProperty(t.type)&&(n[1]=n[0]),eJ(t,n)}function aA(t){return{applyVisual:function(e,r,n){var i=this.mapValueToVisual(e);n("color",t(r("color"),i))},_normalizedToVisual:EO([0,1])}}function PH(t){var e=this.option.visual;return e[Math.round(Ci(t,[0,1],[0,e.length-1],!0))]||{}}function Dx(t){return function(e,r,n){n(t,this.mapValueToVisual(e))}}function Zx(t){var e=this.option.visual;return e[this.option.loop&&t!==tM?t%e.length:t]}function hg(){return this.option.visual[0]}function EO(t){return{linear:function(e){return Ci(e,t,this.option.visual,!0)},category:Zx,piecewise:function(e,r){var n=DO.call(this,r);return n==null&&(n=Ci(e,t,this.option.visual,!0)),n},fixed:hg}}function DO(t){var e=this.option,r=e.pieceList;if(e.hasSpecialVisual){var n=eo.findPieceIndex(t,r),i=r[n];if(i&&i.visual)return i.visual[this.type]}}function eJ(t,e){return t.visual=e,t.type==="color"&&(t.parsedVisual=Zt(e,function(r){var n=Ks(r);return n||[0,0,0,1]})),e}var dDe={linear:function(t){return Ci(t,this.option.dataExtent,[0,1],!0)},piecewise:function(t){var e=this.option.pieceList,r=eo.findPieceIndex(t,e,!0);if(r!=null)return Ci(r,[0,e.length-1],[0,1],!0)},category:function(t){var e=this.option.categories?this.option.categoryMap[t]:t;return e??tM},fixed:Sa};function oA(t,e,r){return t?e<=r:e<r}var pDe="itemStyle",tJ=ri();const gDe={seriesType:"treemap",reset:function(t){var e=t.getData().tree,r=e.root;r.isRemoved()||rJ(r,{},t.getViewRoot().getAncestors(),t)}};function rJ(t,e,r,n){var i=t.getModel(),a=t.getLayout(),l=t.hostTree.data;if(!(!a||a.invisible||!a.isInView)){var c=i.getModel(pDe),o=vDe(c,e,n),d=l.ensureUniqueItemVisual(t.dataIndex,"style"),g=c.get("borderColor"),m=c.get("borderColorSaturation"),y;m!=null&&(y=LH(o),g=mDe(m,y)),d.stroke=g;var x=t.viewChildren;if(!x||!x.length)y=LH(o),d.fill=y;else{var A=_De(t,i,a,c,o,x);fe(x,function(M,D){if(M.depth>=r.length||M===r[M.depth]){var P=yDe(i,o,M,D,A,n);rJ(M,P,r,n)}})}}}function vDe(t,e,r){var n=Lt({},e),i=r.designatedVisualItemStyle;return fe(["color","colorAlpha","colorSaturation"],function(a){i[a]=e[a];var l=t.get(a);i[a]=null,l!=null&&(n[a]=l)}),n}function LH(t){var e=NL(t,"color");if(e){var r=NL(t,"colorAlpha"),n=NL(t,"colorSaturation");return n&&(e=c1(e,null,null,n)),r&&(e=CC(e,r)),e}}function mDe(t,e){return e!=null?c1(e,null,null,t):null}function NL(t,e){var r=t[e];if(r!=null&&r!=="none")return r}function _De(t,e,r,n,i,a){if(!(!a||!a.length)){var l=VL(e,"color")||i.color!=null&&i.color!=="none"&&(VL(e,"colorAlpha")||VL(e,"colorSaturation"));if(l){var c=e.get("visualMin"),o=e.get("visualMax"),d=r.dataExtent.slice();c!=null&&c<d[0]&&(d[0]=c),o!=null&&o>d[1]&&(d[1]=o);var g=e.get("colorMappingBy"),m={type:l.name,dataExtent:d,visual:l.range};m.type==="color"&&(g==="index"||g==="id")?(m.mappingMethod="category",m.loop=!0):m.mappingMethod="linear";var y=new eo(m);return tJ(y).drColorMappingBy=g,y}}}function VL(t,e){var r=t.get(e);return Ht(r)&&r.length?{name:e,range:r}:null}function yDe(t,e,r,n,i,a){var l=Lt({},e);if(i){var c=i.type,o=c==="color"&&tJ(i).drColorMappingBy,d=o==="index"?n:o==="id"?a.mapIdToIndex(r.getId()):r.getValue(t.get("visualDimension"));l[c]=i.mapValueToVisual(d)}return l}var ob=Math.max,rM=Math.min,RH=ho,NB=fe,nJ=["itemStyle","borderWidth"],xDe=["itemStyle","gapWidth"],bDe=["upperLabel","show"],wDe=["upperLabel","height"];const SDe={seriesType:"treemap",reset:function(t,e,r,n){var i=r.getWidth(),a=r.getHeight(),l=t.option,c=Na(t.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),o=l.size||[],d=dr(RH(c.width,o[0]),i),g=dr(RH(c.height,o[1]),a),m=n&&n.type,y=["treemapZoomToNode","treemapRootToNode"],x=ib(n,y,t),A=m==="treemapRender"||m==="treemapMove"?n.rootRect:null,M=t.getViewRoot(),D=QK(M);if(m!=="treemapMove"){var P=m==="treemapZoomToNode"?EDe(t,x,M,d,g):A?[A.width,A.height]:[d,g],O=l.sort;O&&O!=="asc"&&O!=="desc"&&(O="desc");var z={squareRatio:l.squareRatio,sort:O,leafDepth:l.leafDepth};M.hostTree.clearLayouts();var V={x:0,y:0,width:P[0],height:P[1],area:P[0]*P[1]};M.setLayout(V),iJ(M,z,!1,0),V=M.getLayout(),NB(D,function($,X){var W=(D[X+1]||M).getValue();$.setLayout(Lt({dataExtent:[W,W],borderWidth:0,upperHeight:0},V))})}var H=t.getData().tree.root;H.setLayout(DDe(c,A,x),!0),t.setLayoutInfo(c),aJ(H,new gn(-c.x,-c.y,i,a),D,M,0)}};function iJ(t,e,r,n){var i,a;if(!t.isRemoved()){var l=t.getLayout();i=l.width,a=l.height;var c=t.getModel(),o=c.get(nJ),d=c.get(xDe)/2,g=oJ(c),m=Math.max(o,g),y=o-d,x=m-d;t.setLayout({borderWidth:o,upperHeight:m,upperLabelHeight:g},!0),i=ob(i-2*y,0),a=ob(a-y-x,0);var A=i*a,M=TDe(t,c,A,e,r,n);if(M.length){var D={x:y,y:x,width:i,height:a},P=rM(i,a),O=1/0,z=[];z.area=0;for(var V=0,H=M.length;V<H;){var $=M[V];z.push($),z.area+=$.getLayout().area;var X=IDe(z,P,e.squareRatio);X<=O?(V++,O=X):(z.area-=z.pop().getLayout().area,kH(z,P,D,d,!1),P=rM(D.width,D.height),z.length=z.area=0,O=1/0)}if(z.length&&kH(z,P,D,d,!0),!r){var W=c.get("childrenVisibleMin");W!=null&&A<W&&(r=!0)}for(var V=0,H=M.length;V<H;V++)iJ(M[V],e,r,n+1)}}}function TDe(t,e,r,n,i,a){var l=t.children||[],c=n.sort;c!=="asc"&&c!=="desc"&&(c=null);var o=n.leafDepth!=null&&n.leafDepth<=a;if(i&&!o)return t.viewChildren=[];l=Ei(l,function(x){return!x.isRemoved()}),CDe(l,c);var d=MDe(e,l,c);if(d.sum===0)return t.viewChildren=[];if(d.sum=ADe(e,r,d.sum,c,l),d.sum===0)return t.viewChildren=[];for(var g=0,m=l.length;g<m;g++){var y=l[g].getValue()/d.sum*r;l[g].setLayout({area:y})}return o&&(l.length&&t.setLayout({isLeafRoot:!0},!0),l.length=0),t.viewChildren=l,t.setLayout({dataExtent:d.dataExtent},!0),l}function ADe(t,e,r,n,i){if(!n)return r;for(var a=t.get("visibleMin"),l=i.length,c=l,o=l-1;o>=0;o--){var d=i[n==="asc"?l-o-1:o].getValue();d/r*e<a&&(c=o,r-=d)}return n==="asc"?i.splice(0,l-c):i.splice(c,l-c),r}function CDe(t,e){return e&&t.sort(function(r,n){var i=e==="asc"?r.getValue()-n.getValue():n.getValue()-r.getValue();return i===0?e==="asc"?r.dataIndex-n.dataIndex:n.dataIndex-r.dataIndex:i}),t}function MDe(t,e,r){for(var n=0,i=0,a=e.length;i<a;i++)n+=e[i].getValue();var l=t.get("visualDimension"),c;return!e||!e.length?c=[NaN,NaN]:l==="value"&&r?(c=[e[e.length-1].getValue(),e[0].getValue()],r==="asc"&&c.reverse()):(c=[1/0,-1/0],NB(e,function(o){var d=o.getValue(l);d<c[0]&&(c[0]=d),d>c[1]&&(c[1]=d)})),{sum:n,dataExtent:c}}function IDe(t,e,r){for(var n=0,i=1/0,a=0,l=void 0,c=t.length;a<c;a++)l=t[a].getLayout().area,l&&(l<i&&(i=l),l>n&&(n=l));var o=t.area*t.area,d=e*e*r;return o?ob(d*n/o,o/(d*i)):1/0}function kH(t,e,r,n,i){var a=e===r.width?0:1,l=1-a,c=["x","y"],o=["width","height"],d=r[c[a]],g=e?t.area/e:0;(i||g>r[o[l]])&&(g=r[o[l]]);for(var m=0,y=t.length;m<y;m++){var x=t[m],A={},M=g?x.getLayout().area/g:0,D=A[o[l]]=ob(g-2*n,0),P=r[c[a]]+r[o[a]]-d,O=m===y-1||P<M?P:M,z=A[o[a]]=ob(O-2*n,0);A[c[l]]=r[c[l]]+rM(n,D/2),A[c[a]]=d+rM(n,z/2),d+=O,x.setLayout(A,!0)}r[c[l]]+=g,r[o[l]]-=g}function EDe(t,e,r,n,i){var a=(e||{}).node,l=[n,i];if(!a||a===r)return l;for(var c,o=n*i,d=o*t.option.zoomToNodeRatio;c=a.parentNode;){for(var g=0,m=c.children,y=0,x=m.length;y<x;y++)g+=m[y].getValue();var A=a.getValue();if(A===0)return l;d*=g/A;var M=c.getModel(),D=M.get(nJ),P=Math.max(D,oJ(M));d+=4*D*D+(3*D+P)*Math.pow(d,.5),d>WG&&(d=WG),a=c}d<o&&(d=o);var O=Math.pow(d/o,.5);return[n*O,i*O]}function DDe(t,e,r){if(e)return{x:e.x,y:e.y};var n={x:0,y:0};if(!r)return n;var i=r.node,a=i.getLayout();if(!a)return n;for(var l=[a.width/2,a.height/2],c=i;c;){var o=c.getLayout();l[0]+=o.x,l[1]+=o.y,c=c.parentNode}return{x:t.width/2-l[0],y:t.height/2-l[1]}}function aJ(t,e,r,n,i){var a=t.getLayout(),l=r[i],c=l&&l===t;if(!(l&&!c||i===r.length&&t!==n)){t.setLayout({isInView:!0,invisible:!c&&!e.intersect(a),isAboveViewRoot:c},!0);var o=new gn(e.x-a.x,e.y-a.y,e.width,e.height);NB(t.viewChildren||[],function(d){aJ(d,o,r,n,i+1)})}}function oJ(t){return t.get(bDe)?t.get(wDe):0}function PDe(t){t.registerSeriesModel(XEe),t.registerChartView(sDe),t.registerVisual(gDe),t.registerLayout(SDe),YEe(t)}function LDe(t){var e=t.findComponents({mainType:"legend"});!e||!e.length||t.eachSeriesByType("graph",function(r){var n=r.getCategoriesData(),i=r.getGraph(),a=i.data,l=n.mapArray(n.getName);a.filterSelf(function(c){var o=a.getItemModel(c),d=o.getShallow("category");if(d!=null){ii(d)&&(d=l[d]);for(var g=0;g<e.length;g++)if(!e[g].isSelected(d))return!1}return!0})})}function RDe(t){var e={};t.eachSeriesByType("graph",function(r){var n=r.getCategoriesData(),i=r.getData(),a={};n.each(function(l){var c=n.getName(l);a["ec-"+c]=l;var o=n.getItemModel(l),d=o.getModel("itemStyle").getItemStyle();d.fill||(d.fill=r.getColorFromPalette(c,e)),n.setItemVisual(l,"style",d);for(var g=["symbol","symbolSize","symbolKeepAspect"],m=0;m<g.length;m++){var y=o.getShallow(g[m],!0);y!=null&&n.setItemVisual(l,g[m],y)}}),n.count()&&i.each(function(l){var c=i.getItemModel(l),o=c.getShallow("category");if(o!=null){yr(o)&&(o=a["ec-"+o]);var d=n.getItemVisual(o,"style"),g=i.ensureUniqueItemVisual(l,"style");Lt(g,d);for(var m=["symbol","symbolSize","symbolKeepAspect"],y=0;y<m.length;y++)i.setItemVisual(l,m[y],n.getItemVisual(o,m[y]))}})})}function sA(t){return t instanceof Array||(t=[t,t]),t}function kDe(t){t.eachSeriesByType("graph",function(e){var r=e.getGraph(),n=e.getEdgeData(),i=sA(e.get("edgeSymbol")),a=sA(e.get("edgeSymbolSize"));n.setVisual("fromSymbol",i&&i[0]),n.setVisual("toSymbol",i&&i[1]),n.setVisual("fromSymbolSize",a&&a[0]),n.setVisual("toSymbolSize",a&&a[1]),n.setVisual("style",e.getModel("lineStyle").getLineStyle()),n.each(function(l){var c=n.getItemModel(l),o=r.getEdgeByIndex(l),d=sA(c.getShallow("symbol",!0)),g=sA(c.getShallow("symbolSize",!0)),m=c.getModel("lineStyle").getLineStyle(),y=n.ensureUniqueItemVisual(l,"style");switch(Lt(y,m),y.stroke){case"source":{var x=o.node1.getVisual("style");y.stroke=x&&x.fill;break}case"target":{var x=o.node2.getVisual("style");y.stroke=x&&x.fill;break}}d[0]&&o.setVisual("fromSymbol",d[0]),d[1]&&o.setVisual("toSymbol",d[1]),g[0]&&o.setVisual("fromSymbolSize",g[0]),g[1]&&o.setVisual("toSymbolSize",g[1])})})}var PO="-->",RI=function(t){return t.get("autoCurveness")||null},sJ=function(t,e){var r=RI(t),n=20,i=[];if(ii(r))n=r;else if(Ht(r)){t.__curvenessList=r;return}e>n&&(n=e);var a=n%2?n+2:n+3;i=[];for(var l=0;l<a;l++)i.push((l%2?l+1:l)/10*(l%2?-1:1));t.__curvenessList=i},sb=function(t,e,r){var n=[t.id,t.dataIndex].join("."),i=[e.id,e.dataIndex].join(".");return[r.uid,n,i].join(PO)},lJ=function(t){var e=t.split(PO);return[e[0],e[2],e[1]].join(PO)},ODe=function(t,e){var r=sb(t.node1,t.node2,e);return e.__edgeMap[r]},zDe=function(t,e){var r=LO(sb(t.node1,t.node2,e),e),n=LO(sb(t.node2,t.node1,e),e);return r+n},LO=function(t,e){var r=e.__edgeMap;return r[t]?r[t].length:0};function BDe(t){RI(t)&&(t.__curvenessList=[],t.__edgeMap={},sJ(t))}function FDe(t,e,r,n){if(RI(r)){var i=sb(t,e,r),a=r.__edgeMap,l=a[lJ(i)];a[i]&&!l?a[i].isForward=!0:l&&a[i]&&(l.isForward=!0,a[i].isForward=!1),a[i]=a[i]||[],a[i].push(n)}}function VB(t,e,r,n){var i=RI(e),a=Ht(i);if(!i)return null;var l=ODe(t,e);if(!l)return null;for(var c=-1,o=0;o<l.length;o++)if(l[o]===r){c=o;break}var d=zDe(t,e);sJ(e,d),t.lineStyle=t.lineStyle||{};var g=sb(t.node1,t.node2,e),m=e.__curvenessList,y=a||d%2?0:1;if(l.isForward)return m[y+c];var x=lJ(g),A=LO(x,e),M=m[c+A+y];return n?a?i&&i[0]===0?(A+y)%2?M:-M:((A%2?0:1)+y)%2?M:-M:(A+y)%2?M:-M:m[c+A+y]}function uJ(t){var e=t.coordinateSystem;if(!(e&&e.type!=="view")){var r=t.getGraph();r.eachNode(function(n){var i=n.getModel();n.setLayout([+i.get("x"),+i.get("y")])}),GB(r,t)}}function GB(t,e){t.eachEdge(function(r,n){var i=ac(r.getModel().get(["lineStyle","curveness"]),-VB(r,e,n,!0),0),a=ah(r.node1.getLayout()),l=ah(r.node2.getLayout()),c=[a,l];+i&&c.push([(a[0]+l[0])/2-(a[1]-l[1])*i,(a[1]+l[1])/2-(l[0]-a[0])*i]),r.setLayout(c)})}function NDe(t,e){t.eachSeriesByType("graph",function(r){var n=r.get("layout"),i=r.coordinateSystem;if(i&&i.type!=="view"){var a=r.getData(),l=[];fe(i.dimensions,function(y){l=l.concat(a.mapDimensionsAll(y))});for(var c=0;c<a.count();c++){for(var o=[],d=!1,g=0;g<l.length;g++){var m=a.get(l[g],c);isNaN(m)||(d=!0),o.push(m)}d?a.setItemLayout(c,i.dataToPoint(o)):a.setItemLayout(c,[NaN,NaN])}GB(a.graph,r)}else(!n||n==="none")&&uJ(r)})}function qx(t){var e=t.coordinateSystem;if(e.type!=="view")return 1;var r=t.option.nodeScaleRatio,n=e.scaleX,i=e.getZoom(),a=(i-1)*r+1;return a/n}function Yx(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),+e}var OH=Math.PI,GL=[];function UB(t,e,r,n){var i=t.coordinateSystem;if(!(i&&i.type!=="view")){var a=i.getBoundingRect(),l=t.getData(),c=l.graph,o=a.width/2+a.x,d=a.height/2+a.y,g=Math.min(a.width,a.height)/2,m=l.count();if(l.setLayout({cx:o,cy:d}),!!m){if(r){var y=i.pointToData(n),x=y[0],A=y[1],M=[x-o,A-d];iy(M,M),zA(M,M,g),r.setLayout([o+M[0],d+M[1]],!0);var D=t.get(["circular","rotateLabel"]);cJ(r,D,o,d)}VDe[e](t,c,l,g,o,d,m),c.eachEdge(function(P,O){var z=ac(P.getModel().get(["lineStyle","curveness"]),VB(P,t,O),0),V=ah(P.node1.getLayout()),H=ah(P.node2.getLayout()),$,X=(V[0]+H[0])/2,W=(V[1]+H[1])/2;+z&&(z*=3,$=[o*z+X*(1-z),d*z+W*(1-z)]),P.setLayout([V,H,$])})}}}var VDe={value:function(t,e,r,n,i,a,l){var c=0,o=r.getSum("value"),d=Math.PI*2/(o||l);e.eachNode(function(g){var m=g.getValue("value"),y=d*(o?m:1)/2;c+=y,g.setLayout([n*Math.cos(c)+i,n*Math.sin(c)+a]),c+=y})},symbolSize:function(t,e,r,n,i,a,l){var c=0;GL.length=l;var o=qx(t);e.eachNode(function(m){var y=Yx(m);isNaN(y)&&(y=2),y<0&&(y=0),y*=o;var x=Math.asin(y/2/n);isNaN(x)&&(x=OH/2),GL[m.dataIndex]=x,c+=x*2});var d=(2*OH-c)/l/2,g=0;e.eachNode(function(m){var y=d+GL[m.dataIndex];g+=y,(!m.getLayout()||!m.getLayout().fixed)&&m.setLayout([n*Math.cos(g)+i,n*Math.sin(g)+a]),g+=y})}};function cJ(t,e,r,n){var i=t.getGraphicEl();if(i){var a=t.getModel(),l=a.get(["label","rotate"])||0,c=i.getSymbolPath();if(e){var o=t.getLayout(),d=Math.atan2(o[1]-n,o[0]-r);d<0&&(d=Math.PI*2+d);var g=o[0]<r;g&&(d=d-Math.PI);var m=g?"left":"right";c.setTextConfig({rotation:-d,position:m,origin:"center"});var y=c.ensureState("emphasis");Lt(y.textConfig||(y.textConfig={}),{position:m})}else c.setTextConfig({rotation:l*=Math.PI/180})}}function GDe(t){t.eachSeriesByType("graph",function(e){e.get("layout")==="circular"&&UB(e,"symbolSize")})}var r_=yk;function UDe(t,e,r){for(var n=t,i=e,a=r.rect,l=a.width,c=a.height,o=[a.x+l/2,a.y+c/2],d=r.gravity==null?.1:r.gravity,g=0;g<n.length;g++){var m=n[g];m.p||(m.p=cv(l*(Math.random()-.5)+o[0],c*(Math.random()-.5)+o[1])),m.pp=ah(m.p),m.edges=null}var y=r.friction==null?.6:r.friction,x=y,A,M;return{warmUp:function(){x=y*.8},setFixed:function(D){n[D].fixed=!0},setUnfixed:function(D){n[D].fixed=!1},beforeStep:function(D){A=D},afterStep:function(D){M=D},step:function(D){A&&A(n,i);for(var P=[],O=n.length,z=0;z<i.length;z++){var V=i[z];if(!V.ignoreForceLayout){var H=V.n1,$=V.n2;Tg(P,$.p,H.p);var X=xk(P)-V.d,W=$.w/(H.w+$.w);isNaN(W)&&(W=0),iy(P,P),!H.fixed&&r_(H.p,H.p,P,W*X*x),!$.fixed&&r_($.p,$.p,P,-(1-W)*X*x)}}for(var z=0;z<O;z++){var Y=n[z];Y.fixed||(Tg(P,o,Y.p),r_(Y.p,Y.p,P,d*x))}for(var z=0;z<O;z++)for(var H=n[z],J=z+1;J<O;J++){var $=n[J];Tg(P,$.p,H.p);var X=xk(P);X===0&&(p0e(P,Math.random()-.5,Math.random()-.5),X=1);var re=(H.rep+$.rep)/X/X;!H.fixed&&r_(H.pp,H.pp,P,re),!$.fixed&&r_($.pp,$.pp,P,-re)}for(var ae=[],z=0;z<O;z++){var Y=n[z];Y.fixed||(Tg(ae,Y.p,Y.pp),r_(Y.p,Y.p,ae,x),Qo(Y.pp,Y.p))}x=x*.992;var pe=x<.01;M&&M(n,i,pe),D&&D(pe)}}}function $De(t){t.eachSeriesByType("graph",function(e){var r=e.coordinateSystem;if(!(r&&r.type!=="view"))if(e.get("layout")==="force"){var n=e.preservedPoints||{},i=e.getGraph(),a=i.data,l=i.edgeData,c=e.getModel("force"),o=c.get("initLayout");e.preservedPoints?a.each(function(z){var V=a.getId(z);a.setItemLayout(z,n[V]||[NaN,NaN])}):!o||o==="none"?uJ(e):o==="circular"&&UB(e,"value");var d=a.getDataExtent("value"),g=l.getDataExtent("value"),m=c.get("repulsion"),y=c.get("edgeLength"),x=Ht(m)?m:[m,m],A=Ht(y)?y:[y,y];A=[A[1],A[0]];var M=a.mapArray("value",function(z,V){var H=a.getItemLayout(V),$=Ci(z,d,x);return isNaN($)&&($=(x[0]+x[1])/2),{w:$,rep:$,fixed:a.getItemModel(V).get("fixed"),p:!H||isNaN(H[0])||isNaN(H[1])?null:H}}),D=l.mapArray("value",function(z,V){var H=i.getEdgeByIndex(V),$=Ci(z,g,A);isNaN($)&&($=(A[0]+A[1])/2);var X=H.getModel(),W=ac(H.getModel().get(["lineStyle","curveness"]),-VB(H,e,V,!0),0);return{n1:M[H.node1.dataIndex],n2:M[H.node2.dataIndex],d:$,curveness:W,ignoreForceLayout:X.get("ignoreForceLayout")}}),P=r.getBoundingRect(),O=UDe(M,D,{rect:P,gravity:c.get("gravity"),friction:c.get("friction")});O.beforeStep(function(z,V){for(var H=0,$=z.length;H<$;H++)z[H].fixed&&Qo(z[H].p,i.getNodeByIndex(H).getLayout())}),O.afterStep(function(z,V,H){for(var $=0,X=z.length;$<X;$++)z[$].fixed||i.getNodeByIndex($).setLayout(z[$].p),n[a.getId($)]=z[$].p;for(var $=0,X=V.length;$<X;$++){var W=V[$],Y=i.getEdgeByIndex($),J=W.n1.p,re=W.n2.p,ae=Y.getLayout();ae=ae?ae.slice():[],ae[0]=ae[0]||[],ae[1]=ae[1]||[],Qo(ae[0],J),Qo(ae[1],re),+W.curveness&&(ae[2]=[(J[0]+re[0])/2-(J[1]-re[1])*W.curveness,(J[1]+re[1])/2-(re[0]-J[0])*W.curveness]),Y.setLayout(ae)}}),e.forceLayout=O,e.preservedPoints=n,O.step()}else e.forceLayout=null})}function HDe(t,e,r){var n=Lt(t.getBoxLayoutParams(),{aspect:r});return Na(n,{width:e.getWidth(),height:e.getHeight()})}function jDe(t,e){var r=[];return t.eachSeriesByType("graph",function(n){var i=n.get("coordinateSystem");if(!i||i==="view"){var a=n.getData(),l=a.mapArray(function(D){var P=a.getItemModel(D);return[+P.get("x"),+P.get("y")]}),c=[],o=[];sI(l,c,o),o[0]-c[0]===0&&(o[0]+=1,c[0]-=1),o[1]-c[1]===0&&(o[1]+=1,c[1]-=1);var d=(o[0]-c[0])/(o[1]-c[1]),g=HDe(n,e,d);isNaN(d)&&(c=[g.x,g.y],o=[g.x+g.width,g.y+g.height]);var m=o[0]-c[0],y=o[1]-c[1],x=g.width,A=g.height,M=n.coordinateSystem=new Ub;M.zoomLimit=n.get("scaleLimit"),M.setBoundingRect(c[0],c[1],m,y),M.setViewRect(g.x,g.y,x,A),M.setCenter(n.get("center"),e),M.setZoom(n.get("zoom")),r.push(M)}}),r}var zH=Ka.prototype,UL=Cb.prototype,hJ=function(){function t(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return t}();(function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(hJ);function $L(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1)}var WDe=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="ec-line",n}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new hJ},e.prototype.buildPath=function(r,n){$L(n)?zH.buildPath.call(this,r,n):UL.buildPath.call(this,r,n)},e.prototype.pointAt=function(r){return $L(this.shape)?zH.pointAt.call(this,r):UL.pointAt.call(this,r)},e.prototype.tangentAt=function(r){var n=this.shape,i=$L(n)?[n.x2-n.x1,n.y2-n.y1]:UL.tangentAt.call(this,r);return iy(i,i)},e}(kn),HL=["fromSymbol","toSymbol"];function BH(t){return"_"+t+"Type"}function FH(t,e,r){var n=e.getItemVisual(r,t);if(!n||n==="none")return n;var i=e.getItemVisual(r,t+"Size"),a=e.getItemVisual(r,t+"Rotate"),l=e.getItemVisual(r,t+"Offset"),c=e.getItemVisual(r,t+"KeepAspect"),o=my(i),d=dv(l||0,o);return n+o+d+(a||"")+(c||"")}function NH(t,e,r){var n=e.getItemVisual(r,t);if(!(!n||n==="none")){var i=e.getItemVisual(r,t+"Size"),a=e.getItemVisual(r,t+"Rotate"),l=e.getItemVisual(r,t+"Offset"),c=e.getItemVisual(r,t+"KeepAspect"),o=my(i),d=dv(l||0,o),g=Ia(n,-o[0]/2+d[0],-o[1]/2+d[1],o[0],o[1],null,c);return g.__specifiedRotation=a==null||isNaN(a)?void 0:+a*Math.PI/180||0,g.name=t,g}}function ZDe(t){var e=new WDe({name:"line",subPixelOptimize:!0});return RO(e.shape,t),e}function RO(t,e){t.x1=e[0][0],t.y1=e[0][1],t.x2=e[1][0],t.y2=e[1][1],t.percent=1;var r=e[2];r?(t.cpx1=r[0],t.cpy1=r[1]):(t.cpx1=NaN,t.cpy1=NaN)}var $B=function(t){et(e,t);function e(r,n,i){var a=t.call(this)||this;return a._createLine(r,n,i),a}return e.prototype._createLine=function(r,n,i){var a=r.hostModel,l=r.getItemLayout(n),c=ZDe(l);c.shape.percent=0,Qi(c,{shape:{percent:1}},a,n),this.add(c),fe(HL,function(o){var d=NH(o,r,n);this.add(d),this[BH(o)]=FH(o,r,n)},this),this._updateCommonStl(r,n,i)},e.prototype.updateData=function(r,n,i){var a=r.hostModel,l=this.childOfName("line"),c=r.getItemLayout(n),o={shape:{}};RO(o.shape,c),li(l,o,a,n),fe(HL,function(d){var g=FH(d,r,n),m=BH(d);if(this[m]!==g){this.remove(this.childOfName(d));var y=NH(d,r,n);this.add(y)}this[m]=g},this),this._updateCommonStl(r,n,i)},e.prototype.getLinePath=function(){return this.childAt(0)},e.prototype._updateCommonStl=function(r,n,i){var a=r.hostModel,l=this.childOfName("line"),c=i&&i.emphasisLineStyle,o=i&&i.blurLineStyle,d=i&&i.selectLineStyle,g=i&&i.labelStatesModels,m=i&&i.emphasisDisabled,y=i&&i.focus,x=i&&i.blurScope;if(!i||r.hasItemOption){var A=r.getItemModel(n),M=A.getModel("emphasis");c=M.getModel("lineStyle").getLineStyle(),o=A.getModel(["blur","lineStyle"]).getLineStyle(),d=A.getModel(["select","lineStyle"]).getLineStyle(),m=M.get("disabled"),y=M.get("focus"),x=M.get("blurScope"),g=to(A)}var D=r.getItemVisual(n,"style"),P=D.stroke;l.useStyle(D),l.style.fill=null,l.style.strokeNoScale=!0,l.ensureState("emphasis").style=c,l.ensureState("blur").style=o,l.ensureState("select").style=d,fe(HL,function($){var X=this.childOfName($);if(X){X.setColor(P),X.style.opacity=D.opacity;for(var W=0;W<is.length;W++){var Y=is[W],J=l.getState(Y);if(J){var re=J.style||{},ae=X.ensureState(Y),pe=ae.style||(ae.style={});re.stroke!=null&&(pe[X.__isEmptyBrush?"stroke":"fill"]=re.stroke),re.opacity!=null&&(pe.opacity=re.opacity)}}X.markRedraw()}},this);var O=a.getRawValue(n);Ao(this,g,{labelDataIndex:n,labelFetcher:{getFormattedLabel:function($,X){return a.getFormattedLabel($,X,r.dataType)}},inheritColor:P||"#000",defaultOpacity:D.opacity,defaultText:(O==null?r.getName(n):isFinite(O)?ma(O):O)+""});var z=this.getTextContent();if(z){var V=g.normal;z.__align=z.style.align,z.__verticalAlign=z.style.verticalAlign,z.__position=V.get("position")||"middle";var H=V.get("distance");Ht(H)||(H=[H,H]),z.__labelDistance=H}this.setTextConfig({position:null,local:!0,inside:!1}),da(this,y,x,m)},e.prototype.highlight=function(){gh(this)},e.prototype.downplay=function(){vh(this)},e.prototype.updateLayout=function(r,n){this.setLinePoints(r.getItemLayout(n))},e.prototype.setLinePoints=function(r){var n=this.childOfName("line");RO(n.shape,r),n.dirty()},e.prototype.beforeUpdate=function(){var r=this,n=r.childOfName("fromSymbol"),i=r.childOfName("toSymbol"),a=r.getTextContent();if(!n&&!i&&(!a||a.ignore))return;for(var l=1,c=this.parent;c;)c.scaleX&&(l/=c.scaleX),c=c.parent;var o=r.childOfName("line");if(!this.__dirty&&!o.__dirty)return;var d=o.shape.percent,g=o.pointAt(0),m=o.pointAt(d),y=Tg([],m,g);iy(y,y);function x(J,re){var ae=J.__specifiedRotation;if(ae==null){var pe=o.tangentAt(re);J.attr("rotation",(re===1?-1:1)*Math.PI/2-Math.atan2(pe[1],pe[0]))}else J.attr("rotation",ae)}if(n&&(n.setPosition(g),x(n,0),n.scaleX=n.scaleY=l*d,n.markRedraw()),i&&(i.setPosition(m),x(i,1),i.scaleX=i.scaleY=l*d,i.markRedraw()),a&&!a.ignore){a.x=a.y=0,a.originX=a.originY=0;var A=void 0,M=void 0,D=a.__labelDistance,P=D[0]*l,O=D[1]*l,z=d/2,V=o.tangentAt(z),H=[V[1],-V[0]],$=o.pointAt(z);H[1]>0&&(H[0]=-H[0],H[1]=-H[1]);var X=V[0]<0?-1:1;if(a.__position!=="start"&&a.__position!=="end"){var W=-Math.atan2(V[1],V[0]);m[0]<g[0]&&(W=Math.PI+W),a.rotation=W}var Y=void 0;switch(a.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":Y=-O,M="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":Y=O,M="top";break;default:Y=0,M="middle"}switch(a.__position){case"end":a.x=y[0]*P+m[0],a.y=y[1]*O+m[1],A=y[0]>.8?"left":y[0]<-.8?"right":"center",M=y[1]>.8?"top":y[1]<-.8?"bottom":"middle";break;case"start":a.x=-y[0]*P+g[0],a.y=-y[1]*O+g[1],A=y[0]>.8?"right":y[0]<-.8?"left":"center",M=y[1]>.8?"bottom":y[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":a.x=P*X+g[0],a.y=g[1]+Y,A=V[0]<0?"right":"left",a.originX=-P*X,a.originY=-Y;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":a.x=$[0],a.y=$[1]+Y,A="center",a.originY=-Y;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":a.x=-P*X+m[0],a.y=m[1]+Y,A=V[0]>=0?"right":"left",a.originX=P*X,a.originY=-Y;break}a.scaleX=a.scaleY=l,a.setStyle({verticalAlign:a.__verticalAlign||M,align:a.__align||A})}},e}(jr),HB=function(){function t(e){this.group=new jr,this._LineCtor=e||$B}return t.prototype.updateData=function(e){var r=this;this._progressiveEls=null;var n=this,i=n.group,a=n._lineData;n._lineData=e,a||i.removeAll();var l=VH(e);e.diff(a).add(function(c){r._doAdd(e,c,l)}).update(function(c,o){r._doUpdate(a,e,o,c,l)}).remove(function(c){i.remove(a.getItemGraphicEl(c))}).execute()},t.prototype.updateLayout=function(){var e=this._lineData;e&&e.eachItemGraphicEl(function(r,n){r.updateLayout(e,n)},this)},t.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=VH(e),this._lineData=null,this.group.removeAll()},t.prototype.incrementalUpdate=function(e,r){this._progressiveEls=[];function n(c){!c.isGroup&&!qDe(c)&&(c.incremental=!0,c.ensureState("emphasis").hoverLayer=!0)}for(var i=e.start;i<e.end;i++){var a=r.getItemLayout(i);if(jL(a)){var l=new this._LineCtor(r,i,this._seriesScope);l.traverse(n),this.group.add(l),r.setItemGraphicEl(i,l),this._progressiveEls.push(l)}}},t.prototype.remove=function(){this.group.removeAll()},t.prototype.eachRendered=function(e){Id(this._progressiveEls||this.group,e)},t.prototype._doAdd=function(e,r,n){var i=e.getItemLayout(r);if(jL(i)){var a=new this._LineCtor(e,r,n);e.setItemGraphicEl(r,a),this.group.add(a)}},t.prototype._doUpdate=function(e,r,n,i,a){var l=e.getItemGraphicEl(n);if(!jL(r.getItemLayout(i))){this.group.remove(l);return}l?l.updateData(r,i,a):l=new this._LineCtor(r,i,a),r.setItemGraphicEl(i,l),this.group.add(l)},t}();function qDe(t){return t.animators&&t.animators.length>0}function VH(t){var e=t.hostModel,r=e.getModel("emphasis");return{lineStyle:e.getModel("lineStyle").getLineStyle(),emphasisLineStyle:r.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:e.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:e.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:r.get("disabled"),blurScope:r.get("blurScope"),focus:r.get("focus"),labelStatesModels:to(e)}}function GH(t){return isNaN(t[0])||isNaN(t[1])}function jL(t){return t&&!GH(t[0])&&!GH(t[1])}var WL=[],ZL=[],qL=[],n_=lo,YL=Bg,UH=Math.abs;function $H(t,e,r){for(var n=t[0],i=t[1],a=t[2],l=1/0,c,o=r*r,d=.1,g=.1;g<=.9;g+=.1){WL[0]=n_(n[0],i[0],a[0],g),WL[1]=n_(n[1],i[1],a[1],g);var m=UH(YL(WL,e)-o);m<l&&(l=m,c=g)}for(var y=0;y<32;y++){var x=c+d;ZL[0]=n_(n[0],i[0],a[0],c),ZL[1]=n_(n[1],i[1],a[1],c),qL[0]=n_(n[0],i[0],a[0],x),qL[1]=n_(n[1],i[1],a[1],x);var m=YL(ZL,e)-o;if(UH(m)<.01)break;var A=YL(qL,e)-o;d/=2,m<0?A>=0?c=c+d:c=c-d:A>=0?c=c-d:c=c+d}return c}function XL(t,e){var r=[],n=N1,i=[[],[],[]],a=[[],[]],l=[];e/=2,t.eachEdge(function(c,o){var d=c.getLayout(),g=c.getVisual("fromSymbol"),m=c.getVisual("toSymbol");d.__original||(d.__original=[ah(d[0]),ah(d[1])],d[2]&&d.__original.push(ah(d[2])));var y=d.__original;if(d[2]!=null){if(Qo(i[0],y[0]),Qo(i[1],y[2]),Qo(i[2],y[1]),g&&g!=="none"){var x=Yx(c.node1),A=$H(i,y[0],x*e);n(i[0][0],i[1][0],i[2][0],A,r),i[0][0]=r[3],i[1][0]=r[4],n(i[0][1],i[1][1],i[2][1],A,r),i[0][1]=r[3],i[1][1]=r[4]}if(m&&m!=="none"){var x=Yx(c.node2),A=$H(i,y[1],x*e);n(i[0][0],i[1][0],i[2][0],A,r),i[1][0]=r[1],i[2][0]=r[2],n(i[0][1],i[1][1],i[2][1],A,r),i[1][1]=r[1],i[2][1]=r[2]}Qo(d[0],i[0]),Qo(d[1],i[2]),Qo(d[2],i[1])}else{if(Qo(a[0],y[0]),Qo(a[1],y[1]),Tg(l,a[1],a[0]),iy(l,l),g&&g!=="none"){var x=Yx(c.node1);yk(a[0],a[0],l,x*e)}if(m&&m!=="none"){var x=Yx(c.node2);yk(a[1],a[1],l,-x*e)}Qo(d[0],a[0]),Qo(d[1],a[1])}})}function HH(t){return t.type==="view"}var YDe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r,n){var i=new zb,a=new HB,l=this.group;this._controller=new Gb(n.getZr()),this._controllerHost={target:l},l.add(i.group),l.add(a.group),this._symbolDraw=i,this._lineDraw=a,this._firstRender=!0},e.prototype.render=function(r,n,i){var a=this,l=r.coordinateSystem;this._model=r;var c=this._symbolDraw,o=this._lineDraw,d=this.group;if(HH(l)){var g={x:l.x,y:l.y,scaleX:l.scaleX,scaleY:l.scaleY};this._firstRender?d.attr(g):li(d,g,r)}XL(r.getGraph(),qx(r));var m=r.getData();c.updateData(m);var y=r.getEdgeData();o.updateData(y),this._updateNodeAndLinkScale(),this._updateController(r,n,i),clearTimeout(this._layoutTimeout);var x=r.forceLayout,A=r.get(["force","layoutAnimation"]);x&&this._startForceLayoutIteration(x,A);var M=r.get("layout");m.graph.eachNode(function(z){var V=z.dataIndex,H=z.getGraphicEl(),$=z.getModel();if(H){H.off("drag").off("dragend");var X=$.get("draggable");X&&H.on("drag",function(Y){switch(M){case"force":x.warmUp(),!a._layouting&&a._startForceLayoutIteration(x,A),x.setFixed(V),m.setItemLayout(V,[H.x,H.y]);break;case"circular":m.setItemLayout(V,[H.x,H.y]),z.setLayout({fixed:!0},!0),UB(r,"symbolSize",z,[Y.offsetX,Y.offsetY]),a.updateLayout(r);break;case"none":default:m.setItemLayout(V,[H.x,H.y]),GB(r.getGraph(),r),a.updateLayout(r);break}}).on("dragend",function(){x&&x.setUnfixed(V)}),H.setDraggable(X,!!$.get("cursor"));var W=$.get(["emphasis","focus"]);W==="adjacency"&&(Yr(H).focus=z.getAdjacentDataIndices())}}),m.graph.eachEdge(function(z){var V=z.getGraphicEl(),H=z.getModel().get(["emphasis","focus"]);V&&H==="adjacency"&&(Yr(V).focus={edge:[z.dataIndex],node:[z.node1.dataIndex,z.node2.dataIndex]})});var D=r.get("layout")==="circular"&&r.get(["circular","rotateLabel"]),P=m.getLayout("cx"),O=m.getLayout("cy");m.graph.eachNode(function(z){cJ(z,D,P,O)}),this._firstRender=!1},e.prototype.dispose=function(){this.remove(),this._controller&&this._controller.dispose(),this._controllerHost=null},e.prototype._startForceLayoutIteration=function(r,n){var i=this;(function a(){r.step(function(l){i.updateLayout(i._model),(i._layouting=!l)&&(n?i._layoutTimeout=setTimeout(a,16):a())})})()},e.prototype._updateController=function(r,n,i){var a=this,l=this._controller,c=this._controllerHost,o=this.group;if(l.setPointerChecker(function(d,g,m){var y=o.getBoundingRect();return y.applyTransform(o.transform),y.contain(g,m)&&!DI(d,i,r)}),!HH(r.coordinateSystem)){l.disable();return}l.enable(r.get("roam")),c.zoomLimit=r.get("scaleLimit"),c.zoom=r.coordinateSystem.getZoom(),l.off("pan").off("zoom").on("pan",function(d){LB(c,d.dx,d.dy),i.dispatchAction({seriesId:r.id,type:"graphRoam",dx:d.dx,dy:d.dy})}).on("zoom",function(d){RB(c,d.scale,d.originX,d.originY),i.dispatchAction({seriesId:r.id,type:"graphRoam",zoom:d.scale,originX:d.originX,originY:d.originY}),a._updateNodeAndLinkScale(),XL(r.getGraph(),qx(r)),a._lineDraw.updateLayout(),i.updateLabelLayout()})},e.prototype._updateNodeAndLinkScale=function(){var r=this._model,n=r.getData(),i=qx(r);n.eachItemGraphicEl(function(a,l){a&&a.setSymbolScale(i)})},e.prototype.updateLayout=function(r){XL(r.getGraph(),qx(r)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},e.prototype.remove=function(){clearTimeout(this._layoutTimeout),this._layouting=!1,this._layoutTimeout=null,this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},e.type="graph",e}(Oi);function i_(t){return"_EC_"+t}var XDe=function(){function t(e){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=e||!1}return t.prototype.isDirected=function(){return this._directed},t.prototype.addNode=function(e,r){e=e==null?""+r:""+e;var n=this._nodesMap;if(!n[i_(e)]){var i=new fg(e,r);return i.hostGraph=this,this.nodes.push(i),n[i_(e)]=i,i}},t.prototype.getNodeByIndex=function(e){var r=this.data.getRawIndex(e);return this.nodes[r]},t.prototype.getNodeById=function(e){return this._nodesMap[i_(e)]},t.prototype.addEdge=function(e,r,n){var i=this._nodesMap,a=this._edgesMap;if(ii(e)&&(e=this.nodes[e]),ii(r)&&(r=this.nodes[r]),e instanceof fg||(e=i[i_(e)]),r instanceof fg||(r=i[i_(r)]),!(!e||!r)){var l=e.id+"-"+r.id,c=new fJ(e,r,n);return c.hostGraph=this,this._directed&&(e.outEdges.push(c),r.inEdges.push(c)),e.edges.push(c),e!==r&&r.edges.push(c),this.edges.push(c),a[l]=c,c}},t.prototype.getEdgeByIndex=function(e){var r=this.edgeData.getRawIndex(e);return this.edges[r]},t.prototype.getEdge=function(e,r){e instanceof fg&&(e=e.id),r instanceof fg&&(r=r.id);var n=this._edgesMap;return this._directed?n[e+"-"+r]:n[e+"-"+r]||n[r+"-"+e]},t.prototype.eachNode=function(e,r){for(var n=this.nodes,i=n.length,a=0;a<i;a++)n[a].dataIndex>=0&&e.call(r,n[a],a)},t.prototype.eachEdge=function(e,r){for(var n=this.edges,i=n.length,a=0;a<i;a++)n[a].dataIndex>=0&&n[a].node1.dataIndex>=0&&n[a].node2.dataIndex>=0&&e.call(r,n[a],a)},t.prototype.breadthFirstTraverse=function(e,r,n,i){if(r instanceof fg||(r=this._nodesMap[i_(r)]),!!r){for(var a=n==="out"?"outEdges":n==="in"?"inEdges":"edges",l=0;l<this.nodes.length;l++)this.nodes[l].__visited=!1;if(!e.call(i,r,null))for(var c=[r];c.length;)for(var o=c.shift(),d=o[a],l=0;l<d.length;l++){var g=d[l],m=g.node1===o?g.node2:g.node1;if(!m.__visited){if(e.call(i,m,o))return;c.push(m),m.__visited=!0}}}},t.prototype.update=function(){for(var e=this.data,r=this.edgeData,n=this.nodes,i=this.edges,a=0,l=n.length;a<l;a++)n[a].dataIndex=-1;for(var a=0,l=e.count();a<l;a++)n[e.getRawIndex(a)].dataIndex=a;r.filterSelf(function(c){var o=i[r.getRawIndex(c)];return o.node1.dataIndex>=0&&o.node2.dataIndex>=0});for(var a=0,l=i.length;a<l;a++)i[a].dataIndex=-1;for(var a=0,l=r.count();a<l;a++)i[r.getRawIndex(a)].dataIndex=a},t.prototype.clone=function(){for(var e=new t(this._directed),r=this.nodes,n=this.edges,i=0;i<r.length;i++)e.addNode(r[i].id,r[i].dataIndex);for(var i=0;i<n.length;i++){var a=n[i];e.addEdge(a.node1.id,a.node2.id,a.dataIndex)}return e},t}(),fg=function(){function t(e,r){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=e??"",this.dataIndex=r??-1}return t.prototype.degree=function(){return this.edges.length},t.prototype.inDegree=function(){return this.inEdges.length},t.prototype.outDegree=function(){return this.outEdges.length},t.prototype.getModel=function(e){if(!(this.dataIndex<0)){var r=this.hostGraph,n=r.data.getItemModel(this.dataIndex);return n.getModel(e)}},t.prototype.getAdjacentDataIndices=function(){for(var e={edge:[],node:[]},r=0;r<this.edges.length;r++){var n=this.edges[r];n.dataIndex<0||(e.edge.push(n.dataIndex),e.node.push(n.node1.dataIndex,n.node2.dataIndex))}return e},t.prototype.getTrajectoryDataIndices=function(){for(var e=Ir(),r=Ir(),n=0;n<this.edges.length;n++){var i=this.edges[n];if(!(i.dataIndex<0)){e.set(i.dataIndex,!0);for(var a=[i.node1],l=[i.node2],c=0;c<a.length;){var o=a[c];c++,r.set(o.dataIndex,!0);for(var d=0;d<o.inEdges.length;d++)e.set(o.inEdges[d].dataIndex,!0),a.push(o.inEdges[d].node1)}for(c=0;c<l.length;){var g=l[c];c++,r.set(g.dataIndex,!0);for(var d=0;d<g.outEdges.length;d++)e.set(g.outEdges[d].dataIndex,!0),l.push(g.outEdges[d].node2)}}}return{edge:e.keys(),node:r.keys()}},t}(),fJ=function(){function t(e,r,n){this.dataIndex=-1,this.node1=e,this.node2=r,this.dataIndex=n??-1}return t.prototype.getModel=function(e){if(!(this.dataIndex<0)){var r=this.hostGraph,n=r.edgeData.getItemModel(this.dataIndex);return n.getModel(e)}},t.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},t.prototype.getTrajectoryDataIndices=function(){var e=Ir(),r=Ir();e.set(this.dataIndex,!0);for(var n=[this.node1],i=[this.node2],a=0;a<n.length;){var l=n[a];a++,r.set(l.dataIndex,!0);for(var c=0;c<l.inEdges.length;c++)e.set(l.inEdges[c].dataIndex,!0),n.push(l.inEdges[c].node1)}for(a=0;a<i.length;){var o=i[a];a++,r.set(o.dataIndex,!0);for(var c=0;c<o.outEdges.length;c++)e.set(o.outEdges[c].dataIndex,!0),i.push(o.outEdges[c].node2)}return{edge:e.keys(),node:r.keys()}},t}();function dJ(t,e){return{getValue:function(r){var n=this[t][e];return n.getStore().get(n.getDimensionIndex(r||"value"),this.dataIndex)},setVisual:function(r,n){this.dataIndex>=0&&this[t][e].setItemVisual(this.dataIndex,r,n)},getVisual:function(r){return this[t][e].getItemVisual(this.dataIndex,r)},setLayout:function(r,n){this.dataIndex>=0&&this[t][e].setItemLayout(this.dataIndex,r,n)},getLayout:function(){return this[t][e].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[t][e].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[t][e].getRawIndex(this.dataIndex)}}}Ea(fg,dJ("hostGraph","data"));Ea(fJ,dJ("hostGraph","edgeData"));function pJ(t,e,r,n,i){for(var a=new XDe(n),l=0;l<t.length;l++)a.addNode(ho(t[l].id,t[l].name,l),l);for(var c=[],o=[],d=0,l=0;l<e.length;l++){var g=e[l],m=g.source,y=g.target;a.addEdge(m,y,d)&&(o.push(g),c.push(ho(za(g.id,null),m+" > "+y)),d++)}var x=r.get("coordinateSystem"),A;if(x==="cartesian2d"||x==="polar")A=Mh(t,r);else{var M=Db.get(x),D=M?M.dimensions||[]:[];An(D,"value")<0&&D.concat(["value"]);var P=Lb(t,{coordDimensions:D,encodeDefine:r.getEncode()}).dimensions;A=new ts(P,r),A.initData(t)}var O=new ts(["value"],r);return O.initData(o,c),i&&i(A,O),YK({mainData:A,struct:a,structAttr:"graph",datas:{node:A,edge:O},datasAttr:{node:"data",edge:"edgeData"}}),a.update(),a}var QDe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.hasSymbolVisual=!0,r}return e.prototype.init=function(r){t.prototype.init.apply(this,arguments);var n=this;function i(){return n._categoriesData}this.legendVisualProvider=new Vb(i,i),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},e.prototype.mergeOption=function(r){t.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},e.prototype.mergeDefaultAndTheme=function(r){t.prototype.mergeDefaultAndTheme.apply(this,arguments),Jg(r,"edgeLabel",["show"])},e.prototype.getInitialData=function(r,n){var i=r.edges||r.links||[],a=r.data||r.nodes||[],l=this;if(a&&i){BDe(this);var c=pJ(a,i,this,!0,o);return fe(c.edges,function(d){FDe(d.node1,d.node2,this,d.dataIndex)},this),c.data}function o(d,g){d.wrapMethod("getItemModel",function(A){var M=l._categoriesModels,D=A.getShallow("category"),P=M[D];return P&&(P.parentModel=A.parentModel,A.parentModel=P),A});var m=bi.prototype.getModel;function y(A,M){var D=m.call(this,A,M);return D.resolveParentPath=x,D}g.wrapMethod("getItemModel",function(A){return A.resolveParentPath=x,A.getModel=y,A});function x(A){if(A&&(A[0]==="label"||A[1]==="label")){var M=A.slice();return A[0]==="label"?M[0]="edgeLabel":A[1]==="label"&&(M[1]="edgeLabel"),M}return A}}},e.prototype.getGraph=function(){return this.getData().graph},e.prototype.getEdgeData=function(){return this.getGraph().edgeData},e.prototype.getCategoriesData=function(){return this._categoriesData},e.prototype.formatTooltip=function(r,n,i){if(i==="edge"){var a=this.getData(),l=this.getDataParams(r,i),c=a.graph.getEdgeByIndex(r),o=a.getName(c.node1.dataIndex),d=a.getName(c.node2.dataIndex),g=[];return o!=null&&g.push(o),d!=null&&g.push(d),ro("nameValue",{name:g.join(" > "),value:l.value,noValue:l.value==null})}var m=NX({series:this,dataIndex:r,multipleSeries:n});return m},e.prototype._updateCategoriesData=function(){var r=Zt(this.option.categories||[],function(i){return i.value!=null?i:Lt({value:0},i)}),n=new ts(["value"],this);n.initData(r),this._categoriesData=n,this._categoriesModels=n.mapArray(function(i){return n.getItemModel(i)})},e.prototype.setZoom=function(r){this.option.zoom=r},e.prototype.setCenter=function(r){this.option.center=r},e.prototype.isAnimationEnabled=function(){return t.prototype.isAnimationEnabled.call(this)&&!(this.get("layout")==="force"&&this.get(["force","layoutAnimation"]))},e.type="series.graph",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},e}(Wi),KDe={type:"graphRoam",event:"graphRoam",update:"none"};function JDe(t){t.registerChartView(YDe),t.registerSeriesModel(QDe),t.registerProcessor(LDe),t.registerVisual(RDe),t.registerVisual(kDe),t.registerLayout(NDe),t.registerLayout(t.PRIORITY.VISUAL.POST_CHART_LAYOUT,GDe),t.registerLayout($De),t.registerCoordinateSystem("graphView",{dimensions:Ub.dimensions,create:jDe}),t.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},Sa),t.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},Sa),t.registerAction(KDe,function(e,r,n){r.eachComponent({mainType:"series",query:e},function(i){var a=i.coordinateSystem,l=OB(a,e,void 0,n);i.setCenter&&i.setCenter(l.center),i.setZoom&&i.setZoom(l.zoom)})})}var ePe=function(){function t(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0}return t}(),tPe=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="pointer",n}return e.prototype.getDefaultShape=function(){return new ePe},e.prototype.buildPath=function(r,n){var i=Math.cos,a=Math.sin,l=n.r,c=n.width,o=n.angle,d=n.x-i(o)*c*(c>=l/3?1:2),g=n.y-a(o)*c*(c>=l/3?1:2);o=n.angle-Math.PI/2,r.moveTo(d,g),r.lineTo(n.x+i(o)*c,n.y+a(o)*c),r.lineTo(n.x+i(n.angle)*l,n.y+a(n.angle)*l),r.lineTo(n.x-i(o)*c,n.y-a(o)*c),r.lineTo(d,g)},e}(kn);function rPe(t,e){var r=t.get("center"),n=e.getWidth(),i=e.getHeight(),a=Math.min(n,i),l=dr(r[0],e.getWidth()),c=dr(r[1],e.getHeight()),o=dr(t.get("radius"),a/2);return{cx:l,cy:c,r:o}}function lA(t,e){var r=t==null?"":t+"";return e&&(yr(e)?r=e.replace("{value}",r):zr(e)&&(r=e(t))),r}var nPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){this.group.removeAll();var a=r.get(["axisLine","lineStyle","color"]),l=rPe(r,i);this._renderMain(r,n,i,a,l),this._data=r.getData()},e.prototype.dispose=function(){},e.prototype._renderMain=function(r,n,i,a,l){var c=this.group,o=r.get("clockwise"),d=-r.get("startAngle")/180*Math.PI,g=-r.get("endAngle")/180*Math.PI,m=r.getModel("axisLine"),y=m.get("roundCap"),x=y?QC:as,A=m.get("show"),M=m.getModel("lineStyle"),D=M.get("width"),P=[d,g];kz(P,!o),d=P[0],g=P[1];for(var O=g-d,z=d,V=[],H=0;A&&H<a.length;H++){var $=Math.min(Math.max(a[H][0],0),1);g=d+O*$;var X=new x({shape:{startAngle:z,endAngle:g,cx:l.cx,cy:l.cy,clockwise:o,r0:l.r-D,r:l.r},silent:!0});X.setStyle({fill:a[H][1]}),X.setStyle(M.getLineStyle(["color","width"])),V.push(X),z=g}V.reverse(),fe(V,function(Y){return c.add(Y)});var W=function(Y){if(Y<=0)return a[0][1];var J;for(J=0;J<a.length;J++)if(a[J][0]>=Y&&(J===0?0:a[J-1][0])<Y)return a[J][1];return a[J-1][1]};this._renderTicks(r,n,i,W,l,d,g,o,D),this._renderTitleAndDetail(r,n,i,W,l),this._renderAnchor(r,l),this._renderPointer(r,n,i,W,l,d,g,o,D)},e.prototype._renderTicks=function(r,n,i,a,l,c,o,d,g){for(var m=this.group,y=l.cx,x=l.cy,A=l.r,M=+r.get("min"),D=+r.get("max"),P=r.getModel("splitLine"),O=r.getModel("axisTick"),z=r.getModel("axisLabel"),V=r.get("splitNumber"),H=O.get("splitNumber"),$=dr(P.get("length"),A),X=dr(O.get("length"),A),W=c,Y=(o-c)/V,J=Y/H,re=P.getModel("lineStyle").getLineStyle(),ae=O.getModel("lineStyle").getLineStyle(),pe=P.get("distance"),de,ve,me=0;me<=V;me++){if(de=Math.cos(W),ve=Math.sin(W),P.get("show")){var Ie=pe?pe+g:g,Le=new Ka({shape:{x1:de*(A-Ie)+y,y1:ve*(A-Ie)+x,x2:de*(A-$-Ie)+y,y2:ve*(A-$-Ie)+x},style:re,silent:!0});re.stroke==="auto"&&Le.setStyle({stroke:a(me/V)}),m.add(Le)}if(z.get("show")){var Ie=z.get("distance")+pe,Ee=lA(ma(me/V*(D-M)+M),z.get("formatter")),Ue=a(me/V),Ke=de*(A-$-Ie)+y,We=ve*(A-$-Ie)+x,Rt=z.get("rotate"),Et=0;Rt==="radial"?(Et=-W+2*Math.PI,Et>Math.PI/2&&(Et+=Math.PI)):Rt==="tangential"?Et=-W-Math.PI/2:ii(Rt)&&(Et=Rt*Math.PI/180),Et===0?m.add(new ti({style:Hi(z,{text:Ee,x:Ke,y:We,verticalAlign:ve<-.8?"top":ve>.8?"bottom":"middle",align:de<-.4?"left":de>.4?"right":"center"},{inheritColor:Ue}),silent:!0})):m.add(new ti({style:Hi(z,{text:Ee,x:Ke,y:We,verticalAlign:"middle",align:"center"},{inheritColor:Ue}),silent:!0,originX:Ke,originY:We,rotation:Et}))}if(O.get("show")&&me!==V){var Ie=O.get("distance");Ie=Ie?Ie+g:g;for(var ar=0;ar<=H;ar++){de=Math.cos(W),ve=Math.sin(W);var ur=new Ka({shape:{x1:de*(A-Ie)+y,y1:ve*(A-Ie)+x,x2:de*(A-X-Ie)+y,y2:ve*(A-X-Ie)+x},silent:!0,style:ae});ae.stroke==="auto"&&ur.setStyle({stroke:a((me+ar/H)/V)}),m.add(ur),W+=J}W-=J}else W+=Y}},e.prototype._renderPointer=function(r,n,i,a,l,c,o,d,g){var m=this.group,y=this._data,x=this._progressEls,A=[],M=r.get(["pointer","show"]),D=r.getModel("progress"),P=D.get("show"),O=r.getData(),z=O.mapDimension("value"),V=+r.get("min"),H=+r.get("max"),$=[V,H],X=[c,o];function W(J,re){var ae=O.getItemModel(J),pe=ae.getModel("pointer"),de=dr(pe.get("width"),l.r),ve=dr(pe.get("length"),l.r),me=r.get(["pointer","icon"]),Ie=pe.get("offsetCenter"),Le=dr(Ie[0],l.r),Ee=dr(Ie[1],l.r),Ue=pe.get("keepAspect"),Ke;return me?Ke=Ia(me,Le-de/2,Ee-ve,de,ve,null,Ue):Ke=new tPe({shape:{angle:-Math.PI/2,width:de,r:ve,x:Le,y:Ee}}),Ke.rotation=-(re+Math.PI/2),Ke.x=l.cx,Ke.y=l.cy,Ke}function Y(J,re){var ae=D.get("roundCap"),pe=ae?QC:as,de=D.get("overlap"),ve=de?D.get("width"):g/O.count(),me=de?l.r-ve:l.r-(J+1)*ve,Ie=de?l.r:l.r-J*ve,Le=new pe({shape:{startAngle:c,endAngle:re,cx:l.cx,cy:l.cy,clockwise:d,r0:me,r:Ie}});return de&&(Le.z2=H-O.get(z,J)%H),Le}(P||M)&&(O.diff(y).add(function(J){var re=O.get(z,J);if(M){var ae=W(J,c);Qi(ae,{rotation:-((isNaN(+re)?X[0]:Ci(re,$,X,!0))+Math.PI/2)},r),m.add(ae),O.setItemGraphicEl(J,ae)}if(P){var pe=Y(J,c),de=D.get("clip");Qi(pe,{shape:{endAngle:Ci(re,$,X,de)}},r),m.add(pe),jk(r.seriesIndex,O.dataType,J,pe),A[J]=pe}}).update(function(J,re){var ae=O.get(z,J);if(M){var pe=y.getItemGraphicEl(re),de=pe?pe.rotation:c,ve=W(J,de);ve.rotation=de,li(ve,{rotation:-((isNaN(+ae)?X[0]:Ci(ae,$,X,!0))+Math.PI/2)},r),m.add(ve),O.setItemGraphicEl(J,ve)}if(P){var me=x[re],Ie=me?me.shape.endAngle:c,Le=Y(J,Ie),Ee=D.get("clip");li(Le,{shape:{endAngle:Ci(ae,$,X,Ee)}},r),m.add(Le),jk(r.seriesIndex,O.dataType,J,Le),A[J]=Le}}).execute(),O.each(function(J){var re=O.getItemModel(J),ae=re.getModel("emphasis"),pe=ae.get("focus"),de=ae.get("blurScope"),ve=ae.get("disabled");if(M){var me=O.getItemGraphicEl(J),Ie=O.getItemVisual(J,"style"),Le=Ie.fill;if(me instanceof fo){var Ee=me.style;me.useStyle(Lt({image:Ee.image,x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height},Ie))}else me.useStyle(Ie),me.type!=="pointer"&&me.setColor(Le);me.setStyle(re.getModel(["pointer","itemStyle"]).getItemStyle()),me.style.fill==="auto"&&me.setStyle("fill",a(Ci(O.get(z,J),$,[0,1],!0))),me.z2EmphasisLift=0,To(me,re),da(me,pe,de,ve)}if(P){var Ue=A[J];Ue.useStyle(O.getItemVisual(J,"style")),Ue.setStyle(re.getModel(["progress","itemStyle"]).getItemStyle()),Ue.z2EmphasisLift=0,To(Ue,re),da(Ue,pe,de,ve)}}),this._progressEls=A)},e.prototype._renderAnchor=function(r,n){var i=r.getModel("anchor"),a=i.get("show");if(a){var l=i.get("size"),c=i.get("icon"),o=i.get("offsetCenter"),d=i.get("keepAspect"),g=Ia(c,n.cx-l/2+dr(o[0],n.r),n.cy-l/2+dr(o[1],n.r),l,l,null,d);g.z2=i.get("showAbove")?1:0,g.setStyle(i.getModel("itemStyle").getItemStyle()),this.group.add(g)}},e.prototype._renderTitleAndDetail=function(r,n,i,a,l){var c=this,o=r.getData(),d=o.mapDimension("value"),g=+r.get("min"),m=+r.get("max"),y=new jr,x=[],A=[],M=r.isAnimationEnabled(),D=r.get(["pointer","showAbove"]);o.diff(this._data).add(function(P){x[P]=new ti({silent:!0}),A[P]=new ti({silent:!0})}).update(function(P,O){x[P]=c._titleEls[O],A[P]=c._detailEls[O]}).execute(),o.each(function(P){var O=o.getItemModel(P),z=o.get(d,P),V=new jr,H=a(Ci(z,[g,m],[0,1],!0)),$=O.getModel("title");if($.get("show")){var X=$.get("offsetCenter"),W=l.cx+dr(X[0],l.r),Y=l.cy+dr(X[1],l.r),J=x[P];J.attr({z2:D?0:2,style:Hi($,{x:W,y:Y,text:o.getName(P),align:"center",verticalAlign:"middle"},{inheritColor:H})}),V.add(J)}var re=O.getModel("detail");if(re.get("show")){var ae=re.get("offsetCenter"),pe=l.cx+dr(ae[0],l.r),de=l.cy+dr(ae[1],l.r),ve=dr(re.get("width"),l.r),me=dr(re.get("height"),l.r),Ie=r.get(["progress","show"])?o.getItemVisual(P,"style").fill:H,J=A[P],Le=re.get("formatter");J.attr({z2:D?0:2,style:Hi(re,{x:pe,y:de,text:lA(z,Le),width:isNaN(ve)?null:ve,height:isNaN(me)?null:me,align:"center",verticalAlign:"middle"},{inheritColor:Ie})}),$Y(J,{normal:re},z,function(Ue){return lA(Ue,Le)}),M&&HY(J,P,o,r,{getFormattedLabel:function(Ue,Ke,We,Rt,Et,ar){return lA(ar?ar.interpolatedValue:z,Le)}}),V.add(J)}y.add(V)}),this.group.add(y),this._titleEls=x,this._detailEls=A},e.type="gauge",e}(Oi),iPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.visualStyleAccessPath="itemStyle",r}return e.prototype.getInitialData=function(r,n){return _y(this,["value"])},e.type="series.gauge",e.defaultOption={z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#63677A",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#464646",fontSize:12,rotate:0},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:"#fff",borderWidth:0,borderColor:"#5470c6"}},title:{show:!0,offsetCenter:[0,"20%"],color:"#464646",fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"#464646",fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},e}(Wi);function aPe(t){t.registerChartView(nPe),t.registerSeriesModel(iPe)}var oPe=["itemStyle","opacity"],sPe=function(t){et(e,t);function e(r,n){var i=t.call(this)||this,a=i,l=new ls,c=new ti;return a.setTextContent(c),i.setTextGuideLine(l),i.updateData(r,n,!0),i}return e.prototype.updateData=function(r,n,i){var a=this,l=r.hostModel,c=r.getItemModel(n),o=r.getItemLayout(n),d=c.getModel("emphasis"),g=c.get(oPe);g=g??1,i||xu(a),a.useStyle(r.getItemVisual(n,"style")),a.style.lineJoin="round",i?(a.setShape({points:o.points}),a.style.opacity=0,Qi(a,{style:{opacity:g}},l,n)):li(a,{style:{opacity:g},shape:{points:o.points}},l,n),To(a,c),this._updateLabel(r,n),da(this,d.get("focus"),d.get("blurScope"),d.get("disabled"))},e.prototype._updateLabel=function(r,n){var i=this,a=this.getTextGuideLine(),l=i.getTextContent(),c=r.hostModel,o=r.getItemModel(n),d=r.getItemLayout(n),g=d.label,m=r.getItemVisual(n,"style"),y=m.fill;Ao(l,to(o),{labelFetcher:r.hostModel,labelDataIndex:n,defaultOpacity:m.opacity,defaultText:r.getName(n)},{normal:{align:g.textAlign,verticalAlign:g.verticalAlign}}),i.setTextConfig({local:!0,inside:!!g.inside,insideStroke:y,outsideFill:y});var x=g.linePoints;a.setShape({points:x}),i.textGuideLineConfig={anchor:x?new hn(x[0][0],x[0][1]):null},li(l,{style:{x:g.x,y:g.y}},c,n),l.attr({rotation:g.rotation,originX:g.x,originY:g.y,z2:10}),bB(i,wB(o),{stroke:y})},e}(os),lPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.ignoreLabelLineUpdate=!0,r}return e.prototype.render=function(r,n,i){var a=r.getData(),l=this._data,c=this.group;a.diff(l).add(function(o){var d=new sPe(a,o);a.setItemGraphicEl(o,d),c.add(d)}).update(function(o,d){var g=l.getItemGraphicEl(d);g.updateData(a,o),c.add(g),a.setItemGraphicEl(o,g)}).remove(function(o){var d=l.getItemGraphicEl(o);W1(d,r,o)}).execute(),this._data=a},e.prototype.remove=function(){this.group.removeAll(),this._data=null},e.prototype.dispose=function(){},e.type="funnel",e}(Oi),uPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new Vb(wr(this.getData,this),wr(this.getRawData,this)),this._defaultLabelLine(r)},e.prototype.getInitialData=function(r,n){return _y(this,{coordDimensions:["value"],encodeDefaulter:on(Kz,this)})},e.prototype._defaultLabelLine=function(r){Jg(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},e.prototype.getDataParams=function(r){var n=this.getData(),i=t.prototype.getDataParams.call(this,r),a=n.mapDimension("value"),l=n.getSum(a);return i.percent=l?+(n.get(a,r)/l*100).toFixed(2):0,i.$vars.push("percent"),i},e.type="series.funnel",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},e}(Wi);function cPe(t,e){return Na(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function hPe(t,e){for(var r=t.mapDimension("value"),n=t.mapArray(r,function(o){return o}),i=[],a=e==="ascending",l=0,c=t.count();l<c;l++)i[l]=l;return zr(e)?i.sort(e):e!=="none"&&i.sort(function(o,d){return a?n[o]-n[d]:n[d]-n[o]}),i}function fPe(t){var e=t.hostModel,r=e.get("orient");t.each(function(n){var i=t.getItemModel(n),a=i.getModel("label"),l=a.get("position"),c=i.getModel("labelLine"),o=t.getItemLayout(n),d=o.points,g=l==="inner"||l==="inside"||l==="center"||l==="insideLeft"||l==="insideRight",m,y,x,A;if(g)l==="insideLeft"?(y=(d[0][0]+d[3][0])/2+5,x=(d[0][1]+d[3][1])/2,m="left"):l==="insideRight"?(y=(d[1][0]+d[2][0])/2-5,x=(d[1][1]+d[2][1])/2,m="right"):(y=(d[0][0]+d[1][0]+d[2][0]+d[3][0])/4,x=(d[0][1]+d[1][1]+d[2][1]+d[3][1])/4,m="center"),A=[[y,x],[y,x]];else{var M=void 0,D=void 0,P=void 0,O=void 0,z=c.get("length");l==="left"?(M=(d[3][0]+d[0][0])/2,D=(d[3][1]+d[0][1])/2,P=M-z,y=P-5,m="right"):l==="right"?(M=(d[1][0]+d[2][0])/2,D=(d[1][1]+d[2][1])/2,P=M+z,y=P+5,m="left"):l==="top"?(M=(d[3][0]+d[0][0])/2,D=(d[3][1]+d[0][1])/2,O=D-z,x=O-5,m="center"):l==="bottom"?(M=(d[1][0]+d[2][0])/2,D=(d[1][1]+d[2][1])/2,O=D+z,x=O+5,m="center"):l==="rightTop"?(M=r==="horizontal"?d[3][0]:d[1][0],D=r==="horizontal"?d[3][1]:d[1][1],r==="horizontal"?(O=D-z,x=O-5,m="center"):(P=M+z,y=P+5,m="top")):l==="rightBottom"?(M=d[2][0],D=d[2][1],r==="horizontal"?(O=D+z,x=O+5,m="center"):(P=M+z,y=P+5,m="bottom")):l==="leftTop"?(M=d[0][0],D=r==="horizontal"?d[0][1]:d[1][1],r==="horizontal"?(O=D-z,x=O-5,m="center"):(P=M-z,y=P-5,m="right")):l==="leftBottom"?(M=r==="horizontal"?d[1][0]:d[3][0],D=r==="horizontal"?d[1][1]:d[2][1],r==="horizontal"?(O=D+z,x=O+5,m="center"):(P=M-z,y=P-5,m="right")):(M=(d[1][0]+d[2][0])/2,D=(d[1][1]+d[2][1])/2,r==="horizontal"?(O=D+z,x=O+5,m="center"):(P=M+z,y=P+5,m="left")),r==="horizontal"?(P=M,y=P):(O=D,x=O),A=[[M,D],[P,O]]}o.label={linePoints:A,x:y,y:x,verticalAlign:"middle",textAlign:m,inside:g}})}function dPe(t,e){t.eachSeriesByType("funnel",function(r){var n=r.getData(),i=n.mapDimension("value"),a=r.get("sort"),l=cPe(r,e),c=r.get("orient"),o=l.width,d=l.height,g=hPe(n,a),m=l.x,y=l.y,x=c==="horizontal"?[dr(r.get("minSize"),d),dr(r.get("maxSize"),d)]:[dr(r.get("minSize"),o),dr(r.get("maxSize"),o)],A=n.getDataExtent(i),M=r.get("min"),D=r.get("max");M==null&&(M=Math.min(A[0],0)),D==null&&(D=A[1]);var P=r.get("funnelAlign"),O=r.get("gap"),z=c==="horizontal"?o:d,V=(z-O*(n.count()-1))/n.count(),H=function(de,ve){if(c==="horizontal"){var me=n.get(i,de)||0,Ie=Ci(me,[M,D],x,!0),Le=void 0;switch(P){case"top":Le=y;break;case"center":Le=y+(d-Ie)/2;break;case"bottom":Le=y+(d-Ie);break}return[[ve,Le],[ve,Le+Ie]]}var Ee=n.get(i,de)||0,Ue=Ci(Ee,[M,D],x,!0),Ke;switch(P){case"left":Ke=m;break;case"center":Ke=m+(o-Ue)/2;break;case"right":Ke=m+o-Ue;break}return[[Ke,ve],[Ke+Ue,ve]]};a==="ascending"&&(V=-V,O=-O,c==="horizontal"?m+=o:y+=d,g=g.reverse());for(var $=0;$<g.length;$++){var X=g[$],W=g[$+1],Y=n.getItemModel(X);if(c==="horizontal"){var J=Y.get(["itemStyle","width"]);J==null?J=V:(J=dr(J,o),a==="ascending"&&(J=-J));var re=H(X,m),ae=H(W,m+J);m+=J+O,n.setItemLayout(X,{points:re.concat(ae.slice().reverse())})}else{var pe=Y.get(["itemStyle","height"]);pe==null?pe=V:(pe=dr(pe,d),a==="ascending"&&(pe=-pe));var re=H(X,y),ae=H(W,y+pe);y+=pe+O,n.setItemLayout(X,{points:re.concat(ae.slice().reverse())})}}fPe(n)})}function pPe(t){t.registerChartView(lPe),t.registerSeriesModel(uPe),t.registerLayout(dPe),t.registerProcessor(Nb("funnel"))}var gPe=.3,vPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._dataGroup=new jr,r._initialized=!1,r}return e.prototype.init=function(){this.group.add(this._dataGroup)},e.prototype.render=function(r,n,i,a){this._progressiveEls=null;var l=this._dataGroup,c=r.getData(),o=this._data,d=r.coordinateSystem,g=d.dimensions,m=WH(r);c.diff(o).add(y).update(x).remove(A).execute();function y(D){var P=jH(c,l,D,g,d);QL(P,c,D,m)}function x(D,P){var O=o.getItemGraphicEl(P),z=gJ(c,D,g,d);c.setItemGraphicEl(D,O),li(O,{shape:{points:z}},r,D),xu(O),QL(O,c,D,m)}function A(D){var P=o.getItemGraphicEl(D);l.remove(P)}if(!this._initialized){this._initialized=!0;var M=mPe(d,r,function(){setTimeout(function(){l.removeClipPath()})});l.setClipPath(M)}this._data=c},e.prototype.incrementalPrepareRender=function(r,n,i){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},e.prototype.incrementalRender=function(r,n,i){for(var a=n.getData(),l=n.coordinateSystem,c=l.dimensions,o=WH(n),d=this._progressiveEls=[],g=r.start;g<r.end;g++){var m=jH(a,this._dataGroup,g,c,l);m.incremental=!0,QL(m,a,g,o),d.push(m)}},e.prototype.remove=function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null},e.type="parallel",e}(Oi);function mPe(t,e,r){var n=t.model,i=t.getRect(),a=new Kn({shape:{x:i.x,y:i.y,width:i.width,height:i.height}}),l=n.get("layout")==="horizontal"?"width":"height";return a.setShape(l,0),Qi(a,{shape:{width:i.width,height:i.height}},e,r),a}function gJ(t,e,r,n){for(var i=[],a=0;a<r.length;a++){var l=r[a],c=t.get(t.mapDimension(l),e);_Pe(c,n.getAxis(l).type)||i.push(n.dataToPoint(c,l))}return i}function jH(t,e,r,n,i){var a=gJ(t,r,n,i),l=new ls({shape:{points:a},z2:10});return e.add(l),t.setItemGraphicEl(r,l),l}function WH(t){var e=t.get("smooth",!0);return e===!0&&(e=gPe),e=ph(e),F1(e)&&(e=0),{smooth:e}}function QL(t,e,r,n){t.useStyle(e.getItemVisual(r,"style")),t.style.fill=null,t.setShape("smooth",n.smooth);var i=e.getItemModel(r),a=i.getModel("emphasis");To(t,i,"lineStyle"),da(t,a.get("focus"),a.get("blurScope"),a.get("disabled"))}function _Pe(t,e){return e==="category"?t==null:t==null||isNaN(t)}var yPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return e.prototype.getInitialData=function(r,n){return Mh(null,this,{useEncodeDefaulter:wr(xPe,null,this)})},e.prototype.getRawIndicesByActiveState=function(r){var n=this.coordinateSystem,i=this.getData(),a=[];return n.eachActiveState(i,function(l,c){r===l&&a.push(i.getRawIndex(c))}),a},e.type="series.parallel",e.dependencies=["parallel"],e.defaultOption={z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"},e}(Wi);function xPe(t){var e=t.ecModel.getComponent("parallel",t.get("parallelIndex"));if(e){var r={};return fe(e.dimensions,function(n){var i=bPe(n);r[n]=i}),r}}function bPe(t){return+t.replace("dim","")}var wPe=["lineStyle","opacity"],SPe={seriesType:"parallel",reset:function(t,e){var r=t.coordinateSystem,n={normal:t.get(["lineStyle","opacity"]),active:t.get("activeOpacity"),inactive:t.get("inactiveOpacity")};return{progress:function(i,a){r.eachActiveState(a,function(l,c){var o=n[l];if(l==="normal"&&a.hasItemOption){var d=a.getItemModel(c).get(wPe,!0);d!=null&&(o=d)}var g=a.ensureUniqueItemVisual(c,"style");g.opacity=o},i.start,i.end)}}}};function TPe(t){APe(t),CPe(t)}function APe(t){if(!t.parallel){var e=!1;fe(t.series,function(r){r&&r.type==="parallel"&&(e=!0)}),e&&(t.parallel=[{}])}}function CPe(t){var e=Pi(t.parallelAxis);fe(e,function(r){if(Ur(r)){var n=r.parallelIndex||0,i=Pi(t.parallel)[n];i&&i.parallelAxisDefault&&pn(r,i.parallelAxisDefault,!1)}})}var MPe=5,IPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){this._model=r,this._api=i,this._handlers||(this._handlers={},fe(EPe,function(a,l){i.getZr().on(l,this._handlers[l]=wr(a,this))},this)),vy(this,"_throttledDispatchExpand",r.get("axisExpandRate"),"fixRate")},e.prototype.dispose=function(r,n){X1(this,"_throttledDispatchExpand"),fe(this._handlers,function(i,a){n.getZr().off(a,i)}),this._handlers=null},e.prototype._throttledDispatchExpand=function(r){this._dispatchExpand(r)},e.prototype._dispatchExpand=function(r){r&&this._api.dispatchAction(Lt({type:"parallelAxisExpand"},r))},e.type="parallel",e}(ra),EPe={mousedown:function(t){KL(this,"click")&&(this._mouseDownPoint=[t.offsetX,t.offsetY])},mouseup:function(t){var e=this._mouseDownPoint;if(KL(this,"click")&&e){var r=[t.offsetX,t.offsetY],n=Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2);if(n>MPe)return;var i=this._model.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]);i.behavior!=="none"&&this._dispatchExpand({axisExpandWindow:i.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(t){if(!(this._mouseDownPoint||!KL(this,"mousemove"))){var e=this._model,r=e.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]),n=r.behavior;n==="jump"&&this._throttledDispatchExpand.debounceNextCall(e.get("axisExpandDebounce")),this._throttledDispatchExpand(n==="none"?null:{axisExpandWindow:r.axisExpandWindow,animation:n==="jump"?null:{duration:0}})}}};function KL(t,e){var r=t._model;return r.get("axisExpandable")&&r.get("axisExpandTriggerOn")===e}var DPe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(){t.prototype.init.apply(this,arguments),this.mergeOption({})},e.prototype.mergeOption=function(r){var n=this.option;r&&pn(n,r,!0),this._initDimensions()},e.prototype.contains=function(r,n){var i=r.get("parallelIndex");return i!=null&&n.getComponent("parallel",i)===this},e.prototype.setAxisExpand=function(r){fe(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(n){r.hasOwnProperty(n)&&(this.option[n]=r[n])},this)},e.prototype._initDimensions=function(){var r=this.dimensions=[],n=this.parallelAxisIndex=[],i=Ei(this.ecModel.queryComponents({mainType:"parallelAxis"}),function(a){return(a.get("parallelIndex")||0)===this.componentIndex},this);fe(i,function(a){r.push("dim"+a.get("dim")),n.push(a.componentIndex)})},e.type="parallel",e.dependencies=["parallelAxis"],e.layoutMode="box",e.defaultOption={z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},e}($n),PPe=function(t){et(e,t);function e(r,n,i,a,l){var c=t.call(this,r,n,i)||this;return c.type=a||"value",c.axisIndex=l,c}return e.prototype.isHorizontal=function(){return this.coordinateSystem.getModel().get("layout")!=="horizontal"},e}(Tu);function mv(t,e,r,n,i,a){t=t||0;var l=r[1]-r[0];if(i!=null&&(i=a_(i,[0,l])),a!=null&&(a=Math.max(a,i??0)),n==="all"){var c=Math.abs(e[1]-e[0]);c=a_(c,[0,l]),i=a=a_(c,[i,a]),n=0}e[0]=a_(e[0],r),e[1]=a_(e[1],r);var o=JL(e,n);e[n]+=t;var d=i||0,g=r.slice();o.sign<0?g[0]+=d:g[1]-=d,e[n]=a_(e[n],g);var m;return m=JL(e,n),i!=null&&(m.sign!==o.sign||m.span<i)&&(e[1-n]=e[n]+o.sign*i),m=JL(e,n),a!=null&&m.span>a&&(e[1-n]=e[n]+m.sign*a),e}function JL(t,e){var r=t[e]-t[1-e];return{span:Math.abs(r),sign:r>0?-1:r<0?1:e?-1:1}}function a_(t,e){return Math.min(e[1]!=null?e[1]:1/0,Math.max(e[0]!=null?e[0]:-1/0,t))}var eR=fe,vJ=Math.min,mJ=Math.max,ZH=Math.floor,LPe=Math.ceil,qH=ma,RPe=Math.PI,kPe=function(){function t(e,r,n){this.type="parallel",this._axesMap=Ir(),this._axesLayout={},this.dimensions=e.dimensions,this._model=e,this._init(e,r,n)}return t.prototype._init=function(e,r,n){var i=e.dimensions,a=e.parallelAxisIndex;eR(i,function(l,c){var o=a[c],d=r.getComponent("parallelAxis",o),g=this._axesMap.set(l,new PPe(l,II(d),[0,0],d.get("type"),o)),m=g.type==="category";g.onBand=m&&d.get("boundaryGap"),g.inverse=d.get("inverse"),d.axis=g,g.model=d,g.coordinateSystem=d.coordinateSystem=this},this)},t.prototype.update=function(e,r){this._updateAxesFromSeries(this._model,e)},t.prototype.containPoint=function(e){var r=this._makeLayoutInfo(),n=r.axisBase,i=r.layoutBase,a=r.pixelDimIndex,l=e[1-a],c=e[a];return l>=n&&l<=n+r.axisLength&&c>=i&&c<=i+r.layoutLength},t.prototype.getModel=function(){return this._model},t.prototype._updateAxesFromSeries=function(e,r){r.eachSeries(function(n){if(e.contains(n,r)){var i=n.getData();eR(this.dimensions,function(a){var l=this._axesMap.get(a);l.scale.unionExtentFromData(i,i.mapDimension(a)),W_(l.scale,l.model)},this)}},this)},t.prototype.resize=function(e,r){this._rect=Na(e.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),this._layoutAxes()},t.prototype.getRect=function(){return this._rect},t.prototype._makeLayoutInfo=function(){var e=this._model,r=this._rect,n=["x","y"],i=["width","height"],a=e.get("layout"),l=a==="horizontal"?0:1,c=r[i[l]],o=[0,c],d=this.dimensions.length,g=uA(e.get("axisExpandWidth"),o),m=uA(e.get("axisExpandCount")||0,[0,d]),y=e.get("axisExpandable")&&d>3&&d>m&&m>1&&g>0&&c>0,x=e.get("axisExpandWindow"),A;if(x)A=uA(x[1]-x[0],o),x[1]=x[0]+A;else{A=uA(g*(m-1),o);var M=e.get("axisExpandCenter")||ZH(d/2);x=[g*M-A/2],x[1]=x[0]+A}var D=(c-A)/(d-m);D<3&&(D=0);var P=[ZH(qH(x[0]/g,1))+1,LPe(qH(x[1]/g,1))-1],O=D/g*x[0];return{layout:a,pixelDimIndex:l,layoutBase:r[n[l]],layoutLength:c,axisBase:r[n[1-l]],axisLength:r[i[1-l]],axisExpandable:y,axisExpandWidth:g,axisCollapseWidth:D,axisExpandWindow:x,axisCount:d,winInnerIndices:P,axisExpandWindow0Pos:O}},t.prototype._layoutAxes=function(){var e=this._rect,r=this._axesMap,n=this.dimensions,i=this._makeLayoutInfo(),a=i.layout;r.each(function(l){var c=[0,i.axisLength],o=l.inverse?1:0;l.setExtent(c[o],c[1-o])}),eR(n,function(l,c){var o=(i.axisExpandable?zPe:OPe)(c,i),d={horizontal:{x:o.position,y:i.axisLength},vertical:{x:0,y:o.position}},g={horizontal:RPe/2,vertical:0},m=[d[a].x+e.x,d[a].y+e.y],y=g[a],x=Qs();hv(x,x,y),hc(x,x,m),this._axesLayout[l]={position:m,rotation:y,transform:x,axisNameAvailableWidth:o.axisNameAvailableWidth,axisLabelShow:o.axisLabelShow,nameTruncateMaxWidth:o.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},t.prototype.getAxis=function(e){return this._axesMap.get(e)},t.prototype.dataToPoint=function(e,r){return this.axisCoordToPoint(this._axesMap.get(r).dataToCoord(e),r)},t.prototype.eachActiveState=function(e,r,n,i){n==null&&(n=0),i==null&&(i=e.count());var a=this._axesMap,l=this.dimensions,c=[],o=[];fe(l,function(D){c.push(e.mapDimension(D)),o.push(a.get(D).model)});for(var d=this.hasAxisBrushed(),g=n;g<i;g++){var m=void 0;if(!d)m="normal";else{m="active";for(var y=e.getValues(c,g),x=0,A=l.length;x<A;x++){var M=o[x].getActiveState(y[x]);if(M==="inactive"){m="inactive";break}}}r(m,g)}},t.prototype.hasAxisBrushed=function(){for(var e=this.dimensions,r=this._axesMap,n=!1,i=0,a=e.length;i<a;i++)r.get(e[i]).model.getActiveState()!=="normal"&&(n=!0);return n},t.prototype.axisCoordToPoint=function(e,r){var n=this._axesLayout[r];return vu([e,0],n.transform)},t.prototype.getAxisLayout=function(e){return $r(this._axesLayout[e])},t.prototype.getSlidedAxisExpandWindow=function(e){var r=this._makeLayoutInfo(),n=r.pixelDimIndex,i=r.axisExpandWindow.slice(),a=i[1]-i[0],l=[0,r.axisExpandWidth*(r.axisCount-1)];if(!this.containPoint(e))return{behavior:"none",axisExpandWindow:i};var c=e[n]-r.layoutBase-r.axisExpandWindow0Pos,o,d="slide",g=r.axisCollapseWidth,m=this._model.get("axisExpandSlideTriggerArea"),y=m[0]!=null;if(g)y&&g&&c<a*m[0]?(d="jump",o=c-a*m[2]):y&&g&&c>a*(1-m[0])?(d="jump",o=c-a*(1-m[2])):(o=c-a*m[1])>=0&&(o=c-a*(1-m[1]))<=0&&(o=0),o*=r.axisExpandWidth/g,o?mv(o,i,l,"all"):d="none";else{var x=i[1]-i[0],A=l[1]*c/x;i=[mJ(0,A-x/2)],i[1]=vJ(l[1],i[0]+x),i[0]=i[1]-x}return{axisExpandWindow:i,behavior:d}},t}();function uA(t,e){return vJ(mJ(t,e[0]),e[1])}function OPe(t,e){var r=e.layoutLength/(e.axisCount-1);return{position:r*t,axisNameAvailableWidth:r,axisLabelShow:!0}}function zPe(t,e){var r=e.layoutLength,n=e.axisExpandWidth,i=e.axisCount,a=e.axisCollapseWidth,l=e.winInnerIndices,c,o=a,d=!1,g;return t<l[0]?(c=t*a,g=a):t<=l[1]?(c=e.axisExpandWindow0Pos+t*n-e.axisExpandWindow[0],o=n,d=!0):(c=r-(i-1-t)*a,g=a),{position:c,axisNameAvailableWidth:o,axisLabelShow:d,nameTruncateMaxWidth:g}}function BPe(t,e){var r=[];return t.eachComponent("parallel",function(n,i){var a=new kPe(n,t,e);a.name="parallel_"+i,a.resize(n,e),n.coordinateSystem=a,a.model=n,r.push(a)}),t.eachSeries(function(n){if(n.get("coordinateSystem")==="parallel"){var i=n.getReferringComponents("parallel",Ma).models[0];n.coordinateSystem=i.coordinateSystem}}),r}var FPe={create:BPe},kO=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.activeIntervals=[],r}return e.prototype.getAreaSelectStyle=function(){return tv([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},e.prototype.setActiveIntervals=function(r){var n=this.activeIntervals=$r(r);if(n)for(var i=n.length-1;i>=0;i--)El(n[i])},e.prototype.getActiveState=function(r){var n=this.activeIntervals;if(!n.length)return"normal";if(r==null||isNaN(+r))return"inactive";if(n.length===1){var i=n[0];if(i[0]<=r&&r<=i[1])return"active"}else for(var a=0,l=n.length;a<l;a++)if(n[a][0]<=r&&r<=n[a][1])return"active";return"inactive"},e}($n);Ea(kO,kb);var iv=!0,lb=Math.min,Y_=Math.max,NPe=Math.pow,VPe=1e4,GPe=6,UPe=6,YH="globalPan",$Pe={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},HPe={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},XH={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},jPe=0,jB=function(t){et(e,t);function e(r){var n=t.call(this)||this;return n._track=[],n._covers=[],n._handlers={},n._zr=r,n.group=new jr,n._uid="brushController_"+jPe++,fe(KPe,function(i,a){this._handlers[a]=wr(i,this)},n),n}return e.prototype.enableBrush=function(r){return this._brushType&&this._doDisableBrush(),r.brushType&&this._doEnableBrush(r),this},e.prototype._doEnableBrush=function(r){var n=this._zr;this._enableGlobalPan||OIe(n,YH,this._uid),fe(this._handlers,function(i,a){n.on(a,i)}),this._brushType=r.brushType,this._brushOption=pn($r(XH),r,!0)},e.prototype._doDisableBrush=function(){var r=this._zr;zIe(r,YH,this._uid),fe(this._handlers,function(n,i){r.off(i,n)}),this._brushType=this._brushOption=null},e.prototype.setPanels=function(r){if(r&&r.length){var n=this._panels={};fe(r,function(i){n[i.panelId]=$r(i)})}else this._panels=null;return this},e.prototype.mount=function(r){r=r||{},this._enableGlobalPan=r.enableGlobalPan;var n=this.group;return this._zr.add(n),n.attr({x:r.x||0,y:r.y||0,rotation:r.rotation||0,scaleX:r.scaleX||1,scaleY:r.scaleY||1}),this._transform=n.getLocalTransform(),this},e.prototype.updateCovers=function(r){r=Zt(r,function(y){return pn($r(XH),y,!0)});var n="\0-brush-index-",i=this._covers,a=this._covers=[],l=this,c=this._creatingCover;return new mh(i,r,d,o).add(g).update(g).remove(m).execute(),this;function o(y,x){return(y.id!=null?y.id:n+x)+"-"+y.brushType}function d(y,x){return o(y.__brushOption,x)}function g(y,x){var A=r[y];if(x!=null&&i[x]===c)a[y]=i[x];else{var M=a[y]=x!=null?(i[x].__brushOption=A,i[x]):yJ(l,_J(l,A));WB(l,M)}}function m(y){i[y]!==c&&l.group.remove(i[y])}},e.prototype.unmount=function(){return this.enableBrush(!1),OO(this),this._zr.remove(this.group),this},e.prototype.dispose=function(){this.unmount(),this.off()},e}(Fl);function _J(t,e){var r=kI[e.brushType].createCover(t,e);return r.__brushOption=e,bJ(r,e),t.group.add(r),r}function yJ(t,e){var r=ZB(e);return r.endCreating&&(r.endCreating(t,e),bJ(e,e.__brushOption)),e}function xJ(t,e){var r=e.__brushOption;ZB(e).updateCoverShape(t,e,r.range,r)}function bJ(t,e){var r=e.z;r==null&&(r=VPe),t.traverse(function(n){n.z=r,n.z2=r})}function WB(t,e){ZB(e).updateCommon(t,e),xJ(t,e)}function ZB(t){return kI[t.__brushOption.brushType]}function qB(t,e,r){var n=t._panels;if(!n)return iv;var i,a=t._transform;return fe(n,function(l){l.isTargetByCursor(e,r,a)&&(i=l)}),i}function wJ(t,e){var r=t._panels;if(!r)return iv;var n=e.__brushOption.panelId;return n!=null?r[n]:iv}function OO(t){var e=t._covers,r=e.length;return fe(e,function(n){t.group.remove(n)},t),e.length=0,!!r}function av(t,e){var r=Zt(t._covers,function(n){var i=n.__brushOption,a=$r(i.range);return{brushType:i.brushType,panelId:i.panelId,range:a}});t.trigger("brush",{areas:r,isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function WPe(t){var e=t._track;if(!e.length)return!1;var r=e[e.length-1],n=e[0],i=r[0]-n[0],a=r[1]-n[1],l=NPe(i*i+a*a,.5);return l>GPe}function SJ(t){var e=t.length-1;return e<0&&(e=0),[t[0],t[e]]}function TJ(t,e,r,n){var i=new jr;return i.add(new Kn({name:"main",style:YB(r),silent:!0,draggable:!0,cursor:"move",drift:on(QH,t,e,i,["n","s","w","e"]),ondragend:on(av,e,{isEnd:!0})})),fe(n,function(a){i.add(new Kn({name:a.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:on(QH,t,e,i,a),ondragend:on(av,e,{isEnd:!0})}))}),i}function AJ(t,e,r,n){var i=n.brushStyle.lineWidth||0,a=Y_(i,UPe),l=r[0][0],c=r[1][0],o=l-i/2,d=c-i/2,g=r[0][1],m=r[1][1],y=g-a+i/2,x=m-a+i/2,A=g-l,M=m-c,D=A+i,P=M+i;Yc(t,e,"main",l,c,A,M),n.transformable&&(Yc(t,e,"w",o,d,a,P),Yc(t,e,"e",y,d,a,P),Yc(t,e,"n",o,d,D,a),Yc(t,e,"s",o,x,D,a),Yc(t,e,"nw",o,d,a,a),Yc(t,e,"ne",y,d,a,a),Yc(t,e,"sw",o,x,a,a),Yc(t,e,"se",y,x,a,a))}function zO(t,e){var r=e.__brushOption,n=r.transformable,i=e.childAt(0);i.useStyle(YB(r)),i.attr({silent:!n,cursor:n?"move":"default"}),fe([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(a){var l=e.childOfName(a.join("")),c=a.length===1?BO(t,a[0]):qPe(t,a);l&&l.attr({silent:!n,invisible:!n,cursor:n?HPe[c]+"-resize":null})})}function Yc(t,e,r,n,i,a,l){var c=e.childOfName(r);c&&c.setShape(XPe(XB(t,e,[[n,i],[n+a,i+l]])))}function YB(t){return Fr({strokeNoScale:!0},t.brushStyle)}function CJ(t,e,r,n){var i=[lb(t,r),lb(e,n)],a=[Y_(t,r),Y_(e,n)];return[[i[0],a[0]],[i[1],a[1]]]}function ZPe(t){return Ug(t.group)}function BO(t,e){var r={w:"left",e:"right",n:"top",s:"bottom"},n={left:"w",right:"e",top:"n",bottom:"s"},i=dI(r[e],ZPe(t));return n[i]}function qPe(t,e){var r=[BO(t,e[0]),BO(t,e[1])];return(r[0]==="e"||r[0]==="w")&&r.reverse(),r.join("")}function QH(t,e,r,n,i,a){var l=r.__brushOption,c=t.toRectRange(l.range),o=MJ(e,i,a);fe(n,function(d){var g=$Pe[d];c[g[0]][g[1]]+=o[g[0]]}),l.range=t.fromRectRange(CJ(c[0][0],c[1][0],c[0][1],c[1][1])),WB(e,r),av(e,{isEnd:!1})}function YPe(t,e,r,n){var i=e.__brushOption.range,a=MJ(t,r,n);fe(i,function(l){l[0]+=a[0],l[1]+=a[1]}),WB(t,e),av(t,{isEnd:!1})}function MJ(t,e,r){var n=t.group,i=n.transformCoordToLocal(e,r),a=n.transformCoordToLocal(0,0);return[i[0]-a[0],i[1]-a[1]]}function XB(t,e,r){var n=wJ(t,e);return n&&n!==iv?n.clipPath(r,t._transform):$r(r)}function XPe(t){var e=lb(t[0][0],t[1][0]),r=lb(t[0][1],t[1][1]),n=Y_(t[0][0],t[1][0]),i=Y_(t[0][1],t[1][1]);return{x:e,y:r,width:n-e,height:i-r}}function QPe(t,e,r){if(!(!t._brushType||JPe(t,e.offsetX,e.offsetY))){var n=t._zr,i=t._covers,a=qB(t,e,r);if(!t._dragging)for(var l=0;l<i.length;l++){var c=i[l].__brushOption;if(a&&(a===iv||c.panelId===a.panelId)&&kI[c.brushType].contain(i[l],r[0],r[1]))return}a&&n.setCursorStyle("crosshair")}}function FO(t){var e=t.event;e.preventDefault&&e.preventDefault()}function NO(t,e,r){return t.childOfName("main").contain(e,r)}function IJ(t,e,r,n){var i=t._creatingCover,a=t._creatingPanel,l=t._brushOption,c;if(t._track.push(r.slice()),WPe(t)||i){if(a&&!i){l.brushMode==="single"&&OO(t);var o=$r(l);o.brushType=KH(o.brushType,a),o.panelId=a===iv?null:a.panelId,i=t._creatingCover=_J(t,o),t._covers.push(i)}if(i){var d=kI[KH(t._brushType,a)],g=i.__brushOption;g.range=d.getCreatingRange(XB(t,i,t._track)),n&&(yJ(t,i),d.updateCommon(t,i)),xJ(t,i),c={isEnd:n}}}else n&&l.brushMode==="single"&&l.removeOnClick&&qB(t,e,r)&&OO(t)&&(c={isEnd:n,removeOnClick:!0});return c}function KH(t,e){return t==="auto"?e.defaultBrushType:t}var KPe={mousedown:function(t){if(this._dragging)JH(this,t);else if(!t.target||!t.target.draggable){FO(t);var e=this.group.transformCoordToLocal(t.offsetX,t.offsetY);this._creatingCover=null;var r=this._creatingPanel=qB(this,t,e);r&&(this._dragging=!0,this._track=[e.slice()])}},mousemove:function(t){var e=t.offsetX,r=t.offsetY,n=this.group.transformCoordToLocal(e,r);if(QPe(this,t,n),this._dragging){FO(t);var i=IJ(this,t,n,!1);i&&av(this,i)}},mouseup:function(t){JH(this,t)}};function JH(t,e){if(t._dragging){FO(e);var r=e.offsetX,n=e.offsetY,i=t.group.transformCoordToLocal(r,n),a=IJ(t,e,i,!0);t._dragging=!1,t._track=[],t._creatingCover=null,a&&av(t,a)}}function JPe(t,e,r){var n=t._zr;return e<0||e>n.getWidth()||r<0||r>n.getHeight()}var kI={lineX:ej(0),lineY:ej(1),rect:{createCover:function(t,e){function r(n){return n}return TJ({toRectRange:r,fromRectRange:r},t,e,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(t){var e=SJ(t);return CJ(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(t,e,r,n){AJ(t,e,r,n)},updateCommon:zO,contain:NO},polygon:{createCover:function(t,e){var r=new jr;return r.add(new ls({name:"main",style:YB(e),silent:!0})),r},getCreatingRange:function(t){return t},endCreating:function(t,e){e.remove(e.childAt(0)),e.add(new os({name:"main",draggable:!0,drift:on(YPe,t,e),ondragend:on(av,t,{isEnd:!0})}))},updateCoverShape:function(t,e,r,n){e.childAt(0).setShape({points:XB(t,e,r)})},updateCommon:zO,contain:NO}};function ej(t){return{createCover:function(e,r){return TJ({toRectRange:function(n){var i=[n,[0,100]];return t&&i.reverse(),i},fromRectRange:function(n){return n[t]}},e,r,[[["w"],["e"]],[["n"],["s"]]][t])},getCreatingRange:function(e){var r=SJ(e),n=lb(r[0][t],r[1][t]),i=Y_(r[0][t],r[1][t]);return[n,i]},updateCoverShape:function(e,r,n,i){var a,l=wJ(e,r);if(l!==iv&&l.getLinearBrushOtherExtent)a=l.getLinearBrushOtherExtent(t);else{var c=e._zr;a=[0,[c.getWidth(),c.getHeight()][1-t]]}var o=[n,a];t&&o.reverse(),AJ(e,r,o,i)},updateCommon:zO,contain:NO}}function EJ(t){return t=QB(t),function(e){return VY(e,t)}}function DJ(t,e){return t=QB(t),function(r){var n=e??r,i=n?t.width:t.height,a=n?t.x:t.y;return[a,a+(i||0)]}}function PJ(t,e,r){var n=QB(t);return function(i,a){return n.contain(a[0],a[1])&&!DI(i,e,r)}}function QB(t){return gn.create(t)}var eLe=["axisLine","axisTickLabel","axisName"],tLe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r,n){t.prototype.init.apply(this,arguments),(this._brushController=new jB(n.getZr())).on("brush",wr(this._onBrush,this))},e.prototype.render=function(r,n,i,a){if(!rLe(r,n,a)){this.axisModel=r,this.api=i,this.group.removeAll();var l=this._axisGroup;if(this._axisGroup=new jr,this.group.add(this._axisGroup),!!r.get("show")){var c=iLe(r,n),o=c.coordinateSystem,d=r.getAreaSelectStyle(),g=d.width,m=r.axis.dim,y=o.getAxisLayout(m),x=Lt({strokeContainThreshold:g},y),A=new rs(r,x);fe(eLe,A.add,A),this._axisGroup.add(A.getGroup()),this._refreshBrushController(x,d,r,c,g,i),Ib(l,this._axisGroup,r)}}},e.prototype._refreshBrushController=function(r,n,i,a,l,c){var o=i.axis.getExtent(),d=o[1]-o[0],g=Math.min(30,Math.abs(d)*.1),m=gn.create({x:o[0],y:-l/2,width:d,height:l});m.x-=g,m.width+=2*g,this._brushController.mount({enableGlobalPan:!0,rotation:r.rotation,x:r.position[0],y:r.position[1]}).setPanels([{panelId:"pl",clipPath:EJ(m),isTargetByCursor:PJ(m,c,a),getLinearBrushOtherExtent:DJ(m,0)}]).enableBrush({brushType:"lineX",brushStyle:n,removeOnClick:!0}).updateCovers(nLe(i))},e.prototype._onBrush=function(r){var n=r.areas,i=this.axisModel,a=i.axis,l=Zt(n,function(c){return[a.coordToData(c.range[0],!0),a.coordToData(c.range[1],!0)]});(!i.option.realtime===r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:i.id,intervals:l})},e.prototype.dispose=function(){this._brushController.dispose()},e.type="parallelAxis",e}(ra);function rLe(t,e,r){return r&&r.type==="axisAreaSelect"&&e.findComponents({mainType:"parallelAxis",query:r})[0]===t}function nLe(t){var e=t.axis;return Zt(t.activeIntervals,function(r){return{brushType:"lineX",panelId:"pl",range:[e.dataToCoord(r[0],!0),e.dataToCoord(r[1],!0)]}})}function iLe(t,e){return e.getComponent("parallel",t.get("parallelIndex"))}var aLe={type:"axisAreaSelect",event:"axisAreaSelected"};function oLe(t){t.registerAction(aLe,function(e,r){r.eachComponent({mainType:"parallelAxis",query:e},function(n){n.axis.model.setActiveIntervals(e.intervals)})}),t.registerAction("parallelAxisExpand",function(e,r){r.eachComponent({mainType:"parallel",query:e},function(n){n.setAxisExpand(e)})})}var sLe={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};function LJ(t){t.registerComponentView(IPe),t.registerComponentModel(DPe),t.registerCoordinateSystem("parallel",FPe),t.registerPreprocessor(TPe),t.registerComponentModel(kO),t.registerComponentView(tLe),q_(t,"parallel",kO,sLe),oLe(t)}function lLe(t){En(LJ),t.registerChartView(vPe),t.registerSeriesModel(yPe),t.registerVisual(t.PRIORITY.VISUAL.BRUSH,SPe)}var uLe=function(){function t(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}return t}(),cLe=function(t){et(e,t);function e(r){return t.call(this,r)||this}return e.prototype.getDefaultShape=function(){return new uLe},e.prototype.buildPath=function(r,n){var i=n.extent;r.moveTo(n.x1,n.y1),r.bezierCurveTo(n.cpx1,n.cpy1,n.cpx2,n.cpy2,n.x2,n.y2),n.orient==="vertical"?(r.lineTo(n.x2+i,n.y2),r.bezierCurveTo(n.cpx2+i,n.cpy2,n.cpx1+i,n.cpy1,n.x1+i,n.y1)):(r.lineTo(n.x2,n.y2+i),r.bezierCurveTo(n.cpx2,n.cpy2+i,n.cpx1,n.cpy1+i,n.x1,n.y1+i)),r.closePath()},e.prototype.highlight=function(){gh(this)},e.prototype.downplay=function(){vh(this)},e}(kn),hLe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._focusAdjacencyDisabled=!1,r}return e.prototype.render=function(r,n,i){var a=this,l=r.getGraph(),c=this.group,o=r.layoutInfo,d=o.width,g=o.height,m=r.getData(),y=r.getData("edge"),x=r.get("orient");this._model=r,c.removeAll(),c.x=o.x,c.y=o.y,l.eachEdge(function(A){var M=new cLe,D=Yr(M);D.dataIndex=A.dataIndex,D.seriesIndex=r.seriesIndex,D.dataType="edge";var P=A.getModel(),O=P.getModel("lineStyle"),z=O.get("curveness"),V=A.node1.getLayout(),H=A.node1.getModel(),$=H.get("localX"),X=H.get("localY"),W=A.node2.getLayout(),Y=A.node2.getModel(),J=Y.get("localX"),re=Y.get("localY"),ae=A.getLayout(),pe,de,ve,me,Ie,Le,Ee,Ue;M.shape.extent=Math.max(1,ae.dy),M.shape.orient=x,x==="vertical"?(pe=($!=null?$*d:V.x)+ae.sy,de=(X!=null?X*g:V.y)+V.dy,ve=(J!=null?J*d:W.x)+ae.ty,me=re!=null?re*g:W.y,Ie=pe,Le=de*(1-z)+me*z,Ee=ve,Ue=de*z+me*(1-z)):(pe=($!=null?$*d:V.x)+V.dx,de=(X!=null?X*g:V.y)+ae.sy,ve=J!=null?J*d:W.x,me=(re!=null?re*g:W.y)+ae.ty,Ie=pe*(1-z)+ve*z,Le=de,Ee=pe*z+ve*(1-z),Ue=me),M.setShape({x1:pe,y1:de,x2:ve,y2:me,cpx1:Ie,cpy1:Le,cpx2:Ee,cpy2:Ue}),M.useStyle(O.getItemStyle()),tj(M.style,x,A);var Ke=""+P.get("value"),We=to(P,"edgeLabel");Ao(M,We,{labelFetcher:{getFormattedLabel:function(ar,ur,cr,lt,qt,Ut){return r.getFormattedLabel(ar,ur,"edge",lt,ac(qt,We.normal&&We.normal.get("formatter"),Ke),Ut)}},labelDataIndex:A.dataIndex,defaultText:Ke}),M.setTextConfig({position:"inside"});var Rt=P.getModel("emphasis");To(M,P,"lineStyle",function(ar){var ur=ar.getItemStyle();return tj(ur,x,A),ur}),c.add(M),y.setItemGraphicEl(A.dataIndex,M);var Et=Rt.get("focus");da(M,Et==="adjacency"?A.getAdjacentDataIndices():Et==="trajectory"?A.getTrajectoryDataIndices():Et,Rt.get("blurScope"),Rt.get("disabled"))}),l.eachNode(function(A){var M=A.getLayout(),D=A.getModel(),P=D.get("localX"),O=D.get("localY"),z=D.getModel("emphasis"),V=new Kn({shape:{x:P!=null?P*d:M.x,y:O!=null?O*g:M.y,width:M.dx,height:M.dy},style:D.getModel("itemStyle").getItemStyle(),z2:10});Ao(V,to(D),{labelFetcher:{getFormattedLabel:function($,X){return r.getFormattedLabel($,X,"node")}},labelDataIndex:A.dataIndex,defaultText:A.id}),V.disableLabelAnimation=!0,V.setStyle("fill",A.getVisual("color")),V.setStyle("decal",A.getVisual("style").decal),To(V,D),c.add(V),m.setItemGraphicEl(A.dataIndex,V),Yr(V).dataType="node";var H=z.get("focus");da(V,H==="adjacency"?A.getAdjacentDataIndices():H==="trajectory"?A.getTrajectoryDataIndices():H,z.get("blurScope"),z.get("disabled"))}),m.eachItemGraphicEl(function(A,M){var D=m.getItemModel(M);D.get("draggable")&&(A.drift=function(P,O){a._focusAdjacencyDisabled=!0,this.shape.x+=P,this.shape.y+=O,this.dirty(),i.dispatchAction({type:"dragNode",seriesId:r.id,dataIndex:m.getRawIndex(M),localX:this.shape.x/d,localY:this.shape.y/g})},A.ondragend=function(){a._focusAdjacencyDisabled=!1},A.draggable=!0,A.cursor="move")}),!this._data&&r.isAnimationEnabled()&&c.setClipPath(fLe(c.getBoundingRect(),r,function(){c.removeClipPath()})),this._data=r.getData()},e.prototype.dispose=function(){},e.type="sankey",e}(Oi);function tj(t,e,r){switch(t.fill){case"source":t.fill=r.node1.getVisual("color"),t.decal=r.node1.getVisual("style").decal;break;case"target":t.fill=r.node2.getVisual("color"),t.decal=r.node2.getVisual("style").decal;break;case"gradient":var n=r.node1.getVisual("color"),i=r.node2.getVisual("color");yr(n)&&yr(i)&&(t.fill=new Mb(0,0,+(e==="horizontal"),+(e==="vertical"),[{color:n,offset:0},{color:i,offset:1}]))}}function fLe(t,e,r){var n=new Kn({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return Qi(n,{shape:{width:t.width+20}},e,r),n}var dLe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.getInitialData=function(r,n){var i=r.edges||r.links,a=r.data||r.nodes,l=r.levels;this.levelModels=[];for(var c=this.levelModels,o=0;o<l.length;o++)l[o].depth!=null&&l[o].depth>=0&&(c[l[o].depth]=new bi(l[o],this,n));if(a&&i){var d=pJ(a,i,this,!0,g);return d.data}function g(m,y){m.wrapMethod("getItemModel",function(x,A){var M=x.parentModel,D=M.getData().getItemLayout(A);if(D){var P=D.depth,O=M.levelModels[P];O&&(x.parentModel=O)}return x}),y.wrapMethod("getItemModel",function(x,A){var M=x.parentModel,D=M.getGraph().getEdgeByIndex(A),P=D.node1.getLayout();if(P){var O=P.depth,z=M.levelModels[O];z&&(x.parentModel=z)}return x})}},e.prototype.setNodePosition=function(r,n){var i=this.option.data||this.option.nodes,a=i[r];a.localX=n[0],a.localY=n[1]},e.prototype.getGraph=function(){return this.getData().graph},e.prototype.getEdgeData=function(){return this.getGraph().edgeData},e.prototype.formatTooltip=function(r,n,i){function a(x){return isNaN(x)||x==null}if(i==="edge"){var l=this.getDataParams(r,i),c=l.data,o=l.value,d=c.source+" -- "+c.target;return ro("nameValue",{name:d,value:o,noValue:a(o)})}else{var g=this.getGraph().getNodeByIndex(r),m=g.getLayout().value,y=this.getDataParams(r,i).data.name;return ro("nameValue",{name:y!=null?y+"":null,value:m,noValue:a(m)})}},e.prototype.optionUpdated=function(){},e.prototype.getDataParams=function(r,n){var i=t.prototype.getDataParams.call(this,r,n);if(i.value==null&&n==="node"){var a=this.getGraph().getNodeByIndex(r),l=a.getLayout().value;i.value=l}return i},e.type="series.sankey",e.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},e}(Wi);function pLe(t,e){t.eachSeriesByType("sankey",function(r){var n=r.get("nodeWidth"),i=r.get("nodeGap"),a=gLe(r,e);r.layoutInfo=a;var l=a.width,c=a.height,o=r.getGraph(),d=o.nodes,g=o.edges;mLe(d);var m=Ei(d,function(M){return M.getLayout().value===0}),y=m.length!==0?0:r.get("layoutIterations"),x=r.get("orient"),A=r.get("nodeAlign");vLe(d,g,n,i,l,c,y,x,A)})}function gLe(t,e){return Na(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function vLe(t,e,r,n,i,a,l,c,o){_Le(t,e,r,i,a,c,o),wLe(t,e,a,i,n,l,c),PLe(t,c)}function mLe(t){fe(t,function(e){var r=hd(e.outEdges,nM),n=hd(e.inEdges,nM),i=e.getValue()||0,a=Math.max(r,n,i);e.setLayout({value:a},!0)})}function _Le(t,e,r,n,i,a,l){for(var c=[],o=[],d=[],g=[],m=0,y=0;y<e.length;y++)c[y]=1;for(var y=0;y<t.length;y++)o[y]=t[y].inEdges.length,o[y]===0&&d.push(t[y]);for(var x=-1;d.length;){for(var A=0;A<d.length;A++){var M=d[A],D=M.hostGraph.data.getRawDataItem(M.dataIndex),P=D.depth!=null&&D.depth>=0;P&&D.depth>x&&(x=D.depth),M.setLayout({depth:P?D.depth:m},!0),a==="vertical"?M.setLayout({dy:r},!0):M.setLayout({dx:r},!0);for(var O=0;O<M.outEdges.length;O++){var z=M.outEdges[O],V=e.indexOf(z);c[V]=0;var H=z.node2,$=t.indexOf(H);--o[$]===0&&g.indexOf(H)<0&&g.push(H)}}++m,d=g,g=[]}for(var y=0;y<c.length;y++)if(c[y]===1)throw new Error("Sankey is a DAG, the original data has cycle!");var X=x>m-1?x:m-1;l&&l!=="left"&&yLe(t,l,a,X);var W=a==="vertical"?(i-r)/X:(n-r)/X;bLe(t,W,a)}function RJ(t){var e=t.hostGraph.data.getRawDataItem(t.dataIndex);return e.depth!=null&&e.depth>=0}function yLe(t,e,r,n){if(e==="right"){for(var i=[],a=t,l=0;a.length;){for(var c=0;c<a.length;c++){var o=a[c];o.setLayout({skNodeHeight:l},!0);for(var d=0;d<o.inEdges.length;d++){var g=o.inEdges[d];i.indexOf(g.node1)<0&&i.push(g.node1)}}a=i,i=[],++l}fe(t,function(m){RJ(m)||m.setLayout({depth:Math.max(0,n-m.getLayout().skNodeHeight)},!0)})}else e==="justify"&&xLe(t,n)}function xLe(t,e){fe(t,function(r){!RJ(r)&&!r.outEdges.length&&r.setLayout({depth:e},!0)})}function bLe(t,e,r){fe(t,function(n){var i=n.getLayout().depth*e;r==="vertical"?n.setLayout({y:i},!0):n.setLayout({x:i},!0)})}function wLe(t,e,r,n,i,a,l){var c=SLe(t,l);TLe(c,e,r,n,i,l),tR(c,i,r,n,l);for(var o=1;a>0;a--)o*=.99,ALe(c,o,l),tR(c,i,r,n,l),DLe(c,o,l),tR(c,i,r,n,l)}function SLe(t,e){var r=[],n=e==="vertical"?"y":"x",i=Gk(t,function(a){return a.getLayout()[n]});return i.keys.sort(function(a,l){return a-l}),fe(i.keys,function(a){r.push(i.buckets.get(a))}),r}function TLe(t,e,r,n,i,a){var l=1/0;fe(t,function(c){var o=c.length,d=0;fe(c,function(m){d+=m.getLayout().value});var g=a==="vertical"?(n-(o-1)*i)/d:(r-(o-1)*i)/d;g<l&&(l=g)}),fe(t,function(c){fe(c,function(o,d){var g=o.getLayout().value*l;a==="vertical"?(o.setLayout({x:d},!0),o.setLayout({dx:g},!0)):(o.setLayout({y:d},!0),o.setLayout({dy:g},!0))})}),fe(e,function(c){var o=+c.getValue()*l;c.setLayout({dy:o},!0)})}function tR(t,e,r,n,i){var a=i==="vertical"?"x":"y";fe(t,function(l){l.sort(function(M,D){return M.getLayout()[a]-D.getLayout()[a]});for(var c,o,d,g=0,m=l.length,y=i==="vertical"?"dx":"dy",x=0;x<m;x++)o=l[x],d=g-o.getLayout()[a],d>0&&(c=o.getLayout()[a]+d,i==="vertical"?o.setLayout({x:c},!0):o.setLayout({y:c},!0)),g=o.getLayout()[a]+o.getLayout()[y]+e;var A=i==="vertical"?n:r;if(d=g-e-A,d>0){c=o.getLayout()[a]-d,i==="vertical"?o.setLayout({x:c},!0):o.setLayout({y:c},!0),g=c;for(var x=m-2;x>=0;--x)o=l[x],d=o.getLayout()[a]+o.getLayout()[y]+e-g,d>0&&(c=o.getLayout()[a]-d,i==="vertical"?o.setLayout({x:c},!0):o.setLayout({y:c},!0)),g=o.getLayout()[a]}})}function ALe(t,e,r){fe(t.slice().reverse(),function(n){fe(n,function(i){if(i.outEdges.length){var a=hd(i.outEdges,CLe,r)/hd(i.outEdges,nM);if(isNaN(a)){var l=i.outEdges.length;a=l?hd(i.outEdges,MLe,r)/l:0}if(r==="vertical"){var c=i.getLayout().x+(a-xd(i,r))*e;i.setLayout({x:c},!0)}else{var o=i.getLayout().y+(a-xd(i,r))*e;i.setLayout({y:o},!0)}}})})}function CLe(t,e){return xd(t.node2,e)*t.getValue()}function MLe(t,e){return xd(t.node2,e)}function ILe(t,e){return xd(t.node1,e)*t.getValue()}function ELe(t,e){return xd(t.node1,e)}function xd(t,e){return e==="vertical"?t.getLayout().x+t.getLayout().dx/2:t.getLayout().y+t.getLayout().dy/2}function nM(t){return t.getValue()}function hd(t,e,r){for(var n=0,i=t.length,a=-1;++a<i;){var l=+e(t[a],r);isNaN(l)||(n+=l)}return n}function DLe(t,e,r){fe(t,function(n){fe(n,function(i){if(i.inEdges.length){var a=hd(i.inEdges,ILe,r)/hd(i.inEdges,nM);if(isNaN(a)){var l=i.inEdges.length;a=l?hd(i.inEdges,ELe,r)/l:0}if(r==="vertical"){var c=i.getLayout().x+(a-xd(i,r))*e;i.setLayout({x:c},!0)}else{var o=i.getLayout().y+(a-xd(i,r))*e;i.setLayout({y:o},!0)}}})})}function PLe(t,e){var r=e==="vertical"?"x":"y";fe(t,function(n){n.outEdges.sort(function(i,a){return i.node2.getLayout()[r]-a.node2.getLayout()[r]}),n.inEdges.sort(function(i,a){return i.node1.getLayout()[r]-a.node1.getLayout()[r]})}),fe(t,function(n){var i=0,a=0;fe(n.outEdges,function(l){l.setLayout({sy:i},!0),i+=l.getLayout().dy}),fe(n.inEdges,function(l){l.setLayout({ty:a},!0),a+=l.getLayout().dy})})}function LLe(t){t.eachSeriesByType("sankey",function(e){var r=e.getGraph(),n=r.nodes,i=r.edges;if(n.length){var a=1/0,l=-1/0;fe(n,function(c){var o=c.getLayout().value;o<a&&(a=o),o>l&&(l=o)}),fe(n,function(c){var o=new eo({type:"color",mappingMethod:"linear",dataExtent:[a,l],visual:e.get("color")}),d=o.mapValueToVisual(c.getLayout().value),g=c.getModel().get(["itemStyle","color"]);g!=null?(c.setVisual("color",g),c.setVisual("style",{fill:g})):(c.setVisual("color",d),c.setVisual("style",{fill:d}))})}i.length&&fe(i,function(c){var o=c.getModel().get("lineStyle");c.setVisual("style",o)})})}function RLe(t){t.registerChartView(hLe),t.registerSeriesModel(dLe),t.registerLayout(pLe),t.registerVisual(LLe),t.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(e,r){r.eachComponent({mainType:"series",subType:"sankey",query:e},function(n){n.setNodePosition(e.dataIndex,[e.localX,e.localY])})})}var kJ=function(){function t(){}return t.prototype.getInitialData=function(e,r){var n,i=r.getComponent("xAxis",this.get("xAxisIndex")),a=r.getComponent("yAxis",this.get("yAxisIndex")),l=i.get("type"),c=a.get("type"),o;l==="category"?(e.layout="horizontal",n=i.getOrdinalMeta(),o=!0):c==="category"?(e.layout="vertical",n=a.getOrdinalMeta(),o=!0):e.layout=e.layout||"horizontal";var d=["x","y"],g=e.layout==="horizontal"?0:1,m=this._baseAxisDim=d[g],y=d[1-g],x=[i,a],A=x[g].get("type"),M=x[1-g].get("type"),D=e.data;if(D&&o){var P=[];fe(D,function(V,H){var $;Ht(V)?($=V.slice(),V.unshift(H)):Ht(V.value)?($=Lt({},V),$.value=$.value.slice(),V.value.unshift(H)):$=V,P.push($)}),e.data=P}var O=this.defaultValueDimensions,z=[{name:m,type:WC(A),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:y,type:WC(M),dimsDef:O.slice()}];return _y(this,{coordDimensions:z,dimensionsCount:O.length+1,encodeDefaulter:on(fX,z,this)})},t.prototype.getBaseAxis=function(){var e=this._baseAxisDim;return this.ecModel.getComponent(e+"Axis",this.get(e+"AxisIndex")).axis},t}(),OJ=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],r.visualDrawType="stroke",r}return e.type="series.boxplot",e.dependencies=["xAxis","yAxis","grid"],e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}},animationDuration:800},e}(Wi);Ea(OJ,kJ,!0);var kLe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=r.getData(),l=this.group,c=this._data;this._data||l.removeAll();var o=r.get("layout")==="horizontal"?1:0;a.diff(c).add(function(d){if(a.hasValue(d)){var g=a.getItemLayout(d),m=rj(g,a,d,o,!0);a.setItemGraphicEl(d,m),l.add(m)}}).update(function(d,g){var m=c.getItemGraphicEl(g);if(!a.hasValue(d)){l.remove(m);return}var y=a.getItemLayout(d);m?(xu(m),zJ(y,m,a,d)):m=rj(y,a,d,o),l.add(m),a.setItemGraphicEl(d,m)}).remove(function(d){var g=c.getItemGraphicEl(d);g&&l.remove(g)}).execute(),this._data=a},e.prototype.remove=function(r){var n=this.group,i=this._data;this._data=null,i&&i.eachItemGraphicEl(function(a){a&&n.remove(a)})},e.type="boxplot",e}(Oi),OLe=function(){function t(){}return t}(),zLe=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="boxplotBoxPath",n}return e.prototype.getDefaultShape=function(){return new OLe},e.prototype.buildPath=function(r,n){var i=n.points,a=0;for(r.moveTo(i[a][0],i[a][1]),a++;a<4;a++)r.lineTo(i[a][0],i[a][1]);for(r.closePath();a<i.length;a++)r.moveTo(i[a][0],i[a][1]),a++,r.lineTo(i[a][0],i[a][1])},e}(kn);function rj(t,e,r,n,i){var a=t.ends,l=new zLe({shape:{points:i?BLe(a,n,t):a}});return zJ(t,l,e,r,i),l}function zJ(t,e,r,n,i){var a=r.hostModel,l=fv[i?"initProps":"updateProps"];l(e,{shape:{points:t.ends}},a,n),e.useStyle(r.getItemVisual(n,"style")),e.style.strokeNoScale=!0,e.z2=100;var c=r.getItemModel(n),o=c.getModel("emphasis");To(e,c),da(e,o.get("focus"),o.get("blurScope"),o.get("disabled"))}function BLe(t,e,r){return Zt(t,function(n){return n=n.slice(),n[e]=r.initBaseline,n})}var w1=fe;function FLe(t){var e=NLe(t);w1(e,function(r){var n=r.seriesModels;n.length&&(VLe(r),w1(n,function(i,a){GLe(i,r.boxOffsetList[a],r.boxWidthList[a])}))})}function NLe(t){var e=[],r=[];return t.eachSeriesByType("boxplot",function(n){var i=n.getBaseAxis(),a=An(r,i);a<0&&(a=r.length,r[a]=i,e[a]={axis:i,seriesModels:[]}),e[a].seriesModels.push(n)}),e}function VLe(t){var e=t.axis,r=t.seriesModels,n=r.length,i=t.boxWidthList=[],a=t.boxOffsetList=[],l=[],c;if(e.type==="category")c=e.getBandWidth();else{var o=0;w1(r,function(A){o=Math.max(o,A.getData().count())});var d=e.getExtent();c=Math.abs(d[1]-d[0])/o}w1(r,function(A){var M=A.get("boxWidth");Ht(M)||(M=[M,M]),l.push([dr(M[0],c)||0,dr(M[1],c)||0])});var g=c*.8-2,m=g/n*.3,y=(g-m*(n-1))/n,x=y/2-g/2;w1(r,function(A,M){a.push(x),x+=m+y,i.push(Math.min(Math.max(y,l[M][0]),l[M][1]))})}function GLe(t,e,r){var n=t.coordinateSystem,i=t.getData(),a=r/2,l=t.get("layout")==="horizontal"?0:1,c=1-l,o=["x","y"],d=i.mapDimension(o[l]),g=i.mapDimensionsAll(o[c]);if(d==null||g.length<5)return;for(var m=0;m<i.count();m++){var y=i.get(d,m),x=z(y,g[2],m),A=z(y,g[0],m),M=z(y,g[1],m),D=z(y,g[3],m),P=z(y,g[4],m),O=[];V(O,M,!1),V(O,D,!0),O.push(A,M,P,D),H(O,A),H(O,P),H(O,x),i.setItemLayout(m,{initBaseline:x[c],ends:O})}function z($,X,W){var Y=i.get(X,W),J=[];J[l]=$,J[c]=Y;var re;return isNaN($)||isNaN(Y)?re=[NaN,NaN]:(re=n.dataToPoint(J),re[l]+=e),re}function V($,X,W){var Y=X.slice(),J=X.slice();Y[l]+=a,J[l]-=a,W?$.push(Y,J):$.push(J,Y)}function H($,X){var W=X.slice(),Y=X.slice();W[l]-=a,Y[l]+=a,$.push(W,Y)}}function ULe(t,e){e=e||{};for(var r=[],n=[],i=e.boundIQR,a=i==="none"||i===0,l=0;l<t.length;l++){var c=El(t[l].slice()),o=DP(c,.25),d=DP(c,.5),g=DP(c,.75),m=c[0],y=c[c.length-1],x=(i??1.5)*(g-o),A=a?m:Math.max(m,o-x),M=a?y:Math.min(y,g+x),D=e.itemNameFormatter,P=zr(D)?D({value:l}):yr(D)?D.replace("{value}",l+""):l+"";r.push([P,A,o,d,g,M]);for(var O=0;O<c.length;O++){var z=c[O];if(z<A||z>M){var V=[P,z];n.push(V)}}}return{boxData:r,outliers:n}}var $Le={type:"echarts:boxplot",transform:function(e){var r=e.upstream;if(r.sourceFormat!==Go){var n="";vi(n)}var i=ULe(r.getRawData(),e.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:i.boxData},{data:i.outliers}]}};function HLe(t){t.registerSeriesModel(OJ),t.registerChartView(kLe),t.registerLayout(FLe),t.registerTransform($Le)}var jLe=["color","borderColor"],WLe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(r),this._isLargeDraw?this._renderLarge(r):this._renderNormal(r)},e.prototype.incrementalPrepareRender=function(r,n,i){this._clear(),this._updateDrawMode(r)},e.prototype.incrementalRender=function(r,n,i,a){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(r,n):this._incrementalRenderNormal(r,n)},e.prototype.eachRendered=function(r){Id(this._progressiveEls||this.group,r)},e.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},e.prototype._renderNormal=function(r){var n=r.getData(),i=this._data,a=this.group,l=n.getLayout("isSimpleBox"),c=r.get("clip",!0),o=r.coordinateSystem,d=o.getArea&&o.getArea();this._data||a.removeAll(),n.diff(i).add(function(g){if(n.hasValue(g)){var m=n.getItemLayout(g);if(c&&nj(d,m))return;var y=rR(m,g,!0);Qi(y,{shape:{points:m.ends}},r,g),nR(y,n,g,l),a.add(y),n.setItemGraphicEl(g,y)}}).update(function(g,m){var y=i.getItemGraphicEl(m);if(!n.hasValue(g)){a.remove(y);return}var x=n.getItemLayout(g);if(c&&nj(d,x)){a.remove(y);return}y?(li(y,{shape:{points:x.ends}},r,g),xu(y)):y=rR(x),nR(y,n,g,l),a.add(y),n.setItemGraphicEl(g,y)}).remove(function(g){var m=i.getItemGraphicEl(g);m&&a.remove(m)}).execute(),this._data=n},e.prototype._renderLarge=function(r){this._clear(),ij(r,this.group);var n=r.get("clip",!0)?Bb(r.coordinateSystem,!1,r):null;n?this.group.setClipPath(n):this.group.removeClipPath()},e.prototype._incrementalRenderNormal=function(r,n){for(var i=n.getData(),a=i.getLayout("isSimpleBox"),l;(l=r.next())!=null;){var c=i.getItemLayout(l),o=rR(c);nR(o,i,l,a),o.incremental=!0,this.group.add(o),this._progressiveEls.push(o)}},e.prototype._incrementalRenderLarge=function(r,n){ij(n,this.group,this._progressiveEls,!0)},e.prototype.remove=function(r){this._clear()},e.prototype._clear=function(){this.group.removeAll(),this._data=null},e.type="candlestick",e}(Oi),ZLe=function(){function t(){}return t}(),qLe=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="normalCandlestickBox",n}return e.prototype.getDefaultShape=function(){return new ZLe},e.prototype.buildPath=function(r,n){var i=n.points;this.__simpleBox?(r.moveTo(i[4][0],i[4][1]),r.lineTo(i[6][0],i[6][1])):(r.moveTo(i[0][0],i[0][1]),r.lineTo(i[1][0],i[1][1]),r.lineTo(i[2][0],i[2][1]),r.lineTo(i[3][0],i[3][1]),r.closePath(),r.moveTo(i[4][0],i[4][1]),r.lineTo(i[5][0],i[5][1]),r.moveTo(i[6][0],i[6][1]),r.lineTo(i[7][0],i[7][1]))},e}(kn);function rR(t,e,r){var n=t.ends;return new qLe({shape:{points:r?YLe(n,t):n},z2:100})}function nj(t,e){for(var r=!0,n=0;n<e.ends.length;n++)if(t.contain(e.ends[n][0],e.ends[n][1])){r=!1;break}return r}function nR(t,e,r,n){var i=e.getItemModel(r);t.useStyle(e.getItemVisual(r,"style")),t.style.strokeNoScale=!0,t.__simpleBox=n,To(t,i)}function YLe(t,e){return Zt(t,function(r){return r=r.slice(),r[1]=e.initBaseline,r})}var XLe=function(){function t(){}return t}(),iR=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n.type="largeCandlestickBox",n}return e.prototype.getDefaultShape=function(){return new XLe},e.prototype.buildPath=function(r,n){for(var i=n.points,a=0;a<i.length;)if(this.__sign===i[a++]){var l=i[a++];r.moveTo(l,i[a++]),r.lineTo(l,i[a++])}else a+=3},e}(kn);function ij(t,e,r,n){var i=t.getData(),a=i.getLayout("largePoints"),l=new iR({shape:{points:a},__sign:1,ignoreCoarsePointer:!0});e.add(l);var c=new iR({shape:{points:a},__sign:-1,ignoreCoarsePointer:!0});e.add(c);var o=new iR({shape:{points:a},__sign:0,ignoreCoarsePointer:!0});e.add(o),aR(1,l,t),aR(-1,c,t),aR(0,o,t),n&&(l.incremental=!0,c.incremental=!0),r&&r.push(l,c)}function aR(t,e,r,n){var i=r.get(["itemStyle",t>0?"borderColor":"borderColor0"])||r.get(["itemStyle",t>0?"color":"color0"]);t===0&&(i=r.get(["itemStyle","borderColorDoji"]));var a=r.getModel("itemStyle").getItemStyle(jLe);e.useStyle(a),e.style.fill=null,e.style.stroke=i}var BJ=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],r}return e.prototype.getShadowDim=function(){return"open"},e.prototype.brushSelector=function(r,n,i){var a=n.getItemLayout(r);return a&&i.rect(a.brushRect)},e.type="series.candlestick",e.dependencies=["xAxis","yAxis","grid"],e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},e}(Wi);Ea(BJ,kJ,!0);function QLe(t){!t||!Ht(t.series)||fe(t.series,function(e){Ur(e)&&e.type==="k"&&(e.type="candlestick")})}var KLe=["itemStyle","borderColor"],JLe=["itemStyle","borderColor0"],eRe=["itemStyle","borderColorDoji"],tRe=["itemStyle","color"],rRe=["itemStyle","color0"],nRe={seriesType:"candlestick",plan:gy(),performRawSeries:!0,reset:function(t,e){function r(a,l){return l.get(a>0?tRe:rRe)}function n(a,l){return l.get(a===0?eRe:a>0?KLe:JLe)}if(!e.isSeriesFiltered(t)){var i=t.pipelineContext.large;return!i&&{progress:function(a,l){for(var c;(c=a.next())!=null;){var o=l.getItemModel(c),d=l.getItemLayout(c).sign,g=o.getItemStyle();g.fill=r(d,o),g.stroke=n(d,o)||g.fill;var m=l.ensureUniqueItemVisual(c,"style");Lt(m,g)}}}}}},iRe={seriesType:"candlestick",plan:gy(),reset:function(t){var e=t.coordinateSystem,r=t.getData(),n=aRe(t,r),i=0,a=1,l=["x","y"],c=r.getDimensionIndex(r.mapDimension(l[i])),o=Zt(r.mapDimensionsAll(l[a]),r.getDimensionIndex,r),d=o[0],g=o[1],m=o[2],y=o[3];if(r.setLayout({candleWidth:n,isSimpleBox:n<=1.3}),c<0||o.length<4)return;return{progress:t.pipelineContext.large?A:x};function x(M,D){for(var P,O=D.getStore();(P=M.next())!=null;){var z=O.get(c,P),V=O.get(d,P),H=O.get(g,P),$=O.get(m,P),X=O.get(y,P),W=Math.min(V,H),Y=Math.max(V,H),J=Ie(W,z),re=Ie(Y,z),ae=Ie($,z),pe=Ie(X,z),de=[];Le(de,re,0),Le(de,J,1),de.push(Ue(pe),Ue(re),Ue(ae),Ue(J));var ve=D.getItemModel(P),me=!!ve.get(["itemStyle","borderColorDoji"]);D.setItemLayout(P,{sign:aj(O,P,V,H,g,me),initBaseline:V>H?re[a]:J[a],ends:de,brushRect:Ee($,X,z)})}function Ie(Ke,We){var Rt=[];return Rt[i]=We,Rt[a]=Ke,isNaN(We)||isNaN(Ke)?[NaN,NaN]:e.dataToPoint(Rt)}function Le(Ke,We,Rt){var Et=We.slice(),ar=We.slice();Et[i]=jA(Et[i]+n/2,1,!1),ar[i]=jA(ar[i]-n/2,1,!0),Rt?Ke.push(Et,ar):Ke.push(ar,Et)}function Ee(Ke,We,Rt){var Et=Ie(Ke,Rt),ar=Ie(We,Rt);return Et[i]-=n/2,ar[i]-=n/2,{x:Et[0],y:Et[1],width:n,height:ar[1]-Et[1]}}function Ue(Ke){return Ke[i]=jA(Ke[i],1),Ke}}function A(M,D){for(var P=tc(M.count*4),O=0,z,V=[],H=[],$,X=D.getStore(),W=!!t.get(["itemStyle","borderColorDoji"]);($=M.next())!=null;){var Y=X.get(c,$),J=X.get(d,$),re=X.get(g,$),ae=X.get(m,$),pe=X.get(y,$);if(isNaN(Y)||isNaN(ae)||isNaN(pe)){P[O++]=NaN,O+=3;continue}P[O++]=aj(X,$,J,re,g,W),V[i]=Y,V[a]=ae,z=e.dataToPoint(V,null,H),P[O++]=z?z[0]:NaN,P[O++]=z?z[1]:NaN,V[a]=pe,z=e.dataToPoint(V,null,H),P[O++]=z?z[1]:NaN}D.setLayout("largePoints",P)}}};function aj(t,e,r,n,i,a){var l;return r>n?l=-1:r<n?l=1:l=a?0:e>0?t.get(i,e-1)<=n?1:-1:1,l}function aRe(t,e){var r=t.getBaseAxis(),n,i=r.type==="category"?r.getBandWidth():(n=r.getExtent(),Math.abs(n[1]-n[0])/e.count()),a=dr(tn(t.get("barMaxWidth"),i),i),l=dr(tn(t.get("barMinWidth"),1),i),c=t.get("barWidth");return c!=null?dr(c,i):Math.max(Math.min(i/2,a),l)}function oRe(t){t.registerChartView(WLe),t.registerSeriesModel(BJ),t.registerPreprocessor(QLe),t.registerVisual(nRe),t.registerLayout(iRe)}function oj(t,e){var r=e.rippleEffectColor||e.color;t.eachChild(function(n){n.attr({z:e.z,zlevel:e.zlevel,style:{stroke:e.brushType==="stroke"?r:null,fill:e.brushType==="fill"?r:null}})})}var sRe=function(t){et(e,t);function e(r,n){var i=t.call(this)||this,a=new Ob(r,n),l=new jr;return i.add(a),i.add(l),i.updateData(r,n),i}return e.prototype.stopEffectAnimation=function(){this.childAt(1).removeAll()},e.prototype.startEffectAnimation=function(r){for(var n=r.symbolType,i=r.color,a=r.rippleNumber,l=this.childAt(1),c=0;c<a;c++){var o=Ia(n,-1,-1,2,2,i);o.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scaleX:.5,scaleY:.5});var d=-c/a*r.period+r.effectOffset;o.animate("",!0).when(r.period,{scaleX:r.rippleScale/2,scaleY:r.rippleScale/2}).delay(d).start(),o.animateStyle(!0).when(r.period,{opacity:0}).delay(d).start(),l.add(o)}oj(l,r)},e.prototype.updateEffectAnimation=function(r){for(var n=this._effectCfg,i=this.childAt(1),a=["symbolType","period","rippleScale","rippleNumber"],l=0;l<a.length;l++){var c=a[l];if(n[c]!==r[c]){this.stopEffectAnimation(),this.startEffectAnimation(r);return}}oj(i,r)},e.prototype.highlight=function(){gh(this)},e.prototype.downplay=function(){vh(this)},e.prototype.getSymbolType=function(){var r=this.childAt(0);return r&&r.getSymbolType()},e.prototype.updateData=function(r,n){var i=this,a=r.hostModel;this.childAt(0).updateData(r,n);var l=this.childAt(1),c=r.getItemModel(n),o=r.getItemVisual(n,"symbol"),d=my(r.getItemVisual(n,"symbolSize")),g=r.getItemVisual(n,"style"),m=g&&g.fill,y=c.getModel("emphasis");l.setScale(d),l.traverse(function(D){D.setStyle("fill",m)});var x=dv(r.getItemVisual(n,"symbolOffset"),d);x&&(l.x=x[0],l.y=x[1]);var A=r.getItemVisual(n,"symbolRotate");l.rotation=(A||0)*Math.PI/180||0;var M={};M.showEffectOn=a.get("showEffectOn"),M.rippleScale=c.get(["rippleEffect","scale"]),M.brushType=c.get(["rippleEffect","brushType"]),M.period=c.get(["rippleEffect","period"])*1e3,M.effectOffset=n/r.count(),M.z=a.getShallow("z")||0,M.zlevel=a.getShallow("zlevel")||0,M.symbolType=o,M.color=m,M.rippleEffectColor=c.get(["rippleEffect","color"]),M.rippleNumber=c.get(["rippleEffect","number"]),M.showEffectOn==="render"?(this._effectCfg?this.updateEffectAnimation(M):this.startEffectAnimation(M),this._effectCfg=M):(this._effectCfg=null,this.stopEffectAnimation(),this.onHoverStateChange=function(D){D==="emphasis"?M.showEffectOn!=="render"&&i.startEffectAnimation(M):D==="normal"&&M.showEffectOn!=="render"&&i.stopEffectAnimation()}),this._effectCfg=M,da(this,y.get("focus"),y.get("blurScope"),y.get("disabled"))},e.prototype.fadeOut=function(r){r&&r()},e}(jr),lRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(){this._symbolDraw=new zb(sRe)},e.prototype.render=function(r,n,i){var a=r.getData(),l=this._symbolDraw;l.updateData(a,{clipShape:this._getClipShape(r)}),this.group.add(l.group)},e.prototype._getClipShape=function(r){var n=r.coordinateSystem,i=n&&n.getArea&&n.getArea();return r.get("clip",!0)?i:null},e.prototype.updateTransform=function(r,n,i){var a=r.getData();this.group.dirty();var l=Fb("").reset(r,n,i);l.progress&&l.progress({start:0,end:a.count(),count:a.count()},a),this._symbolDraw.updateLayout()},e.prototype._updateGroupTransform=function(r){var n=r.coordinateSystem;n&&n.getRoamTransform&&(this.group.transform=D0e(n.getRoamTransform()),this.group.decomposeTransform())},e.prototype.remove=function(r,n){this._symbolDraw&&this._symbolDraw.remove(!0)},e.type="effectScatter",e}(Oi),uRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.hasSymbolVisual=!0,r}return e.prototype.getInitialData=function(r,n){return Mh(null,this,{useEncodeDefaulter:!0})},e.prototype.brushSelector=function(r,n,i){return i.point(n.getItemLayout(r))},e.type="series.effectScatter",e.dependencies=["grid","polar"],e.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",clip:!0,rippleEffect:{period:4,scale:2.5,brushType:"fill",number:3},universalTransition:{divideShape:"clone"},symbolSize:10},e}(Wi);function cRe(t){t.registerChartView(lRe),t.registerSeriesModel(uRe),t.registerLayout(Fb("effectScatter"))}var FJ=function(t){et(e,t);function e(r,n,i){var a=t.call(this)||this;return a.add(a.createLine(r,n,i)),a._updateEffectSymbol(r,n),a}return e.prototype.createLine=function(r,n,i){return new $B(r,n,i)},e.prototype._updateEffectSymbol=function(r,n){var i=r.getItemModel(n),a=i.getModel("effect"),l=a.get("symbolSize"),c=a.get("symbol");Ht(l)||(l=[l,l]);var o=r.getItemVisual(n,"style"),d=a.get("color")||o&&o.stroke,g=this.childAt(1);this._symbolType!==c&&(this.remove(g),g=Ia(c,-.5,-.5,1,1,d),g.z2=100,g.culling=!0,this.add(g)),g&&(g.setStyle("shadowColor",d),g.setStyle(a.getItemStyle(["color"])),g.scaleX=l[0],g.scaleY=l[1],g.setColor(d),this._symbolType=c,this._symbolScale=l,this._updateEffectAnimation(r,a,n))},e.prototype._updateEffectAnimation=function(r,n,i){var a=this.childAt(1);if(a){var l=r.getItemLayout(i),c=n.get("period")*1e3,o=n.get("loop"),d=n.get("roundTrip"),g=n.get("constantSpeed"),m=ho(n.get("delay"),function(x){return x/r.count()*c/3});if(a.ignore=!0,this._updateAnimationPoints(a,l),g>0&&(c=this._getLineLength(a)/g*1e3),c!==this._period||o!==this._loop||d!==this._roundTrip){a.stopAnimation();var y=void 0;zr(m)?y=m(i):y=m,a.__t>0&&(y=-c*a.__t),this._animateSymbol(a,c,y,o,d)}this._period=c,this._loop=o,this._roundTrip=d}},e.prototype._animateSymbol=function(r,n,i,a,l){if(n>0){r.__t=0;var c=this,o=r.animate("",a).when(l?n*2:n,{__t:l?2:1}).delay(i).during(function(){c._updateSymbolPosition(r)});a||o.done(function(){c.remove(r)}),o.start()}},e.prototype._getLineLength=function(r){return Yf(r.__p1,r.__cp1)+Yf(r.__cp1,r.__p2)},e.prototype._updateAnimationPoints=function(r,n){r.__p1=n[0],r.__p2=n[1],r.__cp1=n[2]||[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]},e.prototype.updateData=function(r,n,i){this.childAt(0).updateData(r,n,i),this._updateEffectSymbol(r,n)},e.prototype._updateSymbolPosition=function(r){var n=r.__p1,i=r.__p2,a=r.__cp1,l=r.__t<1?r.__t:2-r.__t,c=[r.x,r.y],o=c.slice(),d=lo,g=Ck;c[0]=d(n[0],a[0],i[0],l),c[1]=d(n[1],a[1],i[1],l);var m=r.__t<1?g(n[0],a[0],i[0],l):g(i[0],a[0],n[0],1-l),y=r.__t<1?g(n[1],a[1],i[1],l):g(i[1],a[1],n[1],1-l);r.rotation=-Math.atan2(y,m)-Math.PI/2,(this._symbolType==="line"||this._symbolType==="rect"||this._symbolType==="roundRect")&&(r.__lastT!==void 0&&r.__lastT<r.__t?(r.scaleY=Yf(o,c)*1.05,l===1&&(c[0]=o[0]+(c[0]-o[0])/2,c[1]=o[1]+(c[1]-o[1])/2)):r.__lastT===1?r.scaleY=2*Yf(n,c):r.scaleY=this._symbolScale[1]),r.__lastT=r.__t,r.ignore=!1,r.x=c[0],r.y=c[1]},e.prototype.updateLayout=function(r,n){this.childAt(0).updateLayout(r,n);var i=r.getItemModel(n).getModel("effect");this._updateEffectAnimation(r,i,n)},e}(jr),NJ=function(t){et(e,t);function e(r,n,i){var a=t.call(this)||this;return a._createPolyline(r,n,i),a}return e.prototype._createPolyline=function(r,n,i){var a=r.getItemLayout(n),l=new ls({shape:{points:a}});this.add(l),this._updateCommonStl(r,n,i)},e.prototype.updateData=function(r,n,i){var a=r.hostModel,l=this.childAt(0),c={shape:{points:r.getItemLayout(n)}};li(l,c,a,n),this._updateCommonStl(r,n,i)},e.prototype._updateCommonStl=function(r,n,i){var a=this.childAt(0),l=r.getItemModel(n),c=i&&i.emphasisLineStyle,o=i&&i.focus,d=i&&i.blurScope,g=i&&i.emphasisDisabled;if(!i||r.hasItemOption){var m=l.getModel("emphasis");c=m.getModel("lineStyle").getLineStyle(),g=m.get("disabled"),o=m.get("focus"),d=m.get("blurScope")}a.useStyle(r.getItemVisual(n,"style")),a.style.fill=null,a.style.strokeNoScale=!0;var y=a.ensureState("emphasis");y.style=c,da(this,o,d,g)},e.prototype.updateLayout=function(r,n){var i=this.childAt(0);i.setShape("points",r.getItemLayout(n))},e}(jr),hRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._lastFrame=0,r._lastFramePercent=0,r}return e.prototype.createLine=function(r,n,i){return new NJ(r,n,i)},e.prototype._updateAnimationPoints=function(r,n){this._points=n;for(var i=[0],a=0,l=1;l<n.length;l++){var c=n[l-1],o=n[l];a+=Yf(c,o),i.push(a)}if(a===0){this._length=0;return}for(var l=0;l<i.length;l++)i[l]/=a;this._offsets=i,this._length=a},e.prototype._getLineLength=function(){return this._length},e.prototype._updateSymbolPosition=function(r){var n=r.__t<1?r.__t:2-r.__t,i=this._points,a=this._offsets,l=i.length;if(a){var c=this._lastFrame,o;if(n<this._lastFramePercent){var d=Math.min(c+1,l-1);for(o=d;o>=0&&!(a[o]<=n);o--);o=Math.min(o,l-2)}else{for(o=c;o<l&&!(a[o]>n);o++);o=Math.min(o-1,l-2)}var g=(n-a[o])/(a[o+1]-a[o]),m=i[o],y=i[o+1];r.x=m[0]*(1-g)+g*y[0],r.y=m[1]*(1-g)+g*y[1];var x=r.__t<1?y[0]-m[0]:m[0]-y[0],A=r.__t<1?y[1]-m[1]:m[1]-y[1];r.rotation=-Math.atan2(A,x)-Math.PI/2,this._lastFrame=o,this._lastFramePercent=n,r.ignore=!1}},e}(FJ),fRe=function(){function t(){this.polyline=!1,this.curveness=0,this.segs=[]}return t}(),dRe=function(t){et(e,t);function e(r){var n=t.call(this,r)||this;return n._off=0,n.hoverDataIdx=-1,n}return e.prototype.reset=function(){this.notClear=!1,this._off=0},e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new fRe},e.prototype.buildPath=function(r,n){var i=n.segs,a=n.curveness,l;if(n.polyline)for(l=this._off;l<i.length;){var c=i[l++];if(c>0){r.moveTo(i[l++],i[l++]);for(var o=1;o<c;o++)r.lineTo(i[l++],i[l++])}}else for(l=this._off;l<i.length;){var d=i[l++],g=i[l++],m=i[l++],y=i[l++];if(r.moveTo(d,g),a>0){var x=(d+m)/2-(g-y)*a,A=(g+y)/2-(m-d)*a;r.quadraticCurveTo(x,A,m,y)}else r.lineTo(m,y)}this.incremental&&(this._off=l,this.notClear=!0)},e.prototype.findDataIndex=function(r,n){var i=this.shape,a=i.segs,l=i.curveness,c=this.style.lineWidth;if(i.polyline)for(var o=0,d=0;d<a.length;){var g=a[d++];if(g>0)for(var m=a[d++],y=a[d++],x=1;x<g;x++){var A=a[d++],M=a[d++];if(Gf(m,y,A,M,c,r,n))return o}o++}else for(var o=0,d=0;d<a.length;){var m=a[d++],y=a[d++],A=a[d++],M=a[d++];if(l>0){var D=(m+A)/2-(y-M)*l,P=(y+M)/2-(A-m)*l;if(cY(m,y,D,P,A,M,c,r,n))return o}else if(Gf(m,y,A,M,c,r,n))return o;o++}return-1},e.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(r=i[0],n=i[1],a.contain(r,n)){var l=this.hoverDataIdx=this.findDataIndex(r,n);return l>=0}return this.hoverDataIdx=-1,!1},e.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var n=this.shape,i=n.segs,a=1/0,l=1/0,c=-1/0,o=-1/0,d=0;d<i.length;){var g=i[d++],m=i[d++];a=Math.min(g,a),c=Math.max(g,c),l=Math.min(m,l),o=Math.max(m,o)}r=this._rect=new gn(a,l,c,o)}return r},e}(kn),pRe=function(){function t(){this.group=new jr}return t.prototype.updateData=function(e){this._clear();var r=this._create();r.setShape({segs:e.getLayout("linesPoints")}),this._setCommon(r,e)},t.prototype.incrementalPrepareUpdate=function(e){this.group.removeAll(),this._clear()},t.prototype.incrementalUpdate=function(e,r){var n=this._newAdded[0],i=r.getLayout("linesPoints"),a=n&&n.shape.segs;if(a&&a.length<2e4){var l=a.length,c=new Float32Array(l+i.length);c.set(a),c.set(i,l),n.setShape({segs:c})}else{this._newAdded=[];var o=this._create();o.incremental=!0,o.setShape({segs:i}),this._setCommon(o,r),o.__startIndex=e.start}},t.prototype.remove=function(){this._clear()},t.prototype.eachRendered=function(e){this._newAdded[0]&&e(this._newAdded[0])},t.prototype._create=function(){var e=new dRe({cursor:"default",ignoreCoarsePointer:!0});return this._newAdded.push(e),this.group.add(e),e},t.prototype._setCommon=function(e,r,n){var i=r.hostModel;e.setShape({polyline:i.get("polyline"),curveness:i.get(["lineStyle","curveness"])}),e.useStyle(i.getModel("lineStyle").getLineStyle()),e.style.strokeNoScale=!0;var a=r.getVisual("style");a&&a.stroke&&e.setStyle("stroke",a.stroke),e.setStyle("fill",null);var l=Yr(e);l.seriesIndex=i.seriesIndex,e.on("mousemove",function(c){l.dataIndex=null;var o=e.hoverDataIdx;o>0&&(l.dataIndex=o+e.__startIndex)})},t.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},t}(),VJ={seriesType:"lines",plan:gy(),reset:function(t){var e=t.coordinateSystem;if(e){var r=t.get("polyline"),n=t.pipelineContext.large;return{progress:function(i,a){var l=[];if(n){var c=void 0,o=i.end-i.start;if(r){for(var d=0,g=i.start;g<i.end;g++)d+=t.getLineCoordsCount(g);c=new Float32Array(o+d*2)}else c=new Float32Array(o*4);for(var m=0,y=[],g=i.start;g<i.end;g++){var x=t.getLineCoords(g,l);r&&(c[m++]=x);for(var A=0;A<x;A++)y=e.dataToPoint(l[A],!1,y),c[m++]=y[0],c[m++]=y[1]}a.setLayout("linesPoints",c)}else for(var g=i.start;g<i.end;g++){var M=a.getItemModel(g),x=t.getLineCoords(g,l),D=[];if(r)for(var P=0;P<x;P++)D.push(e.dataToPoint(l[P]));else{D[0]=e.dataToPoint(l[0]),D[1]=e.dataToPoint(l[1]);var O=M.get(["lineStyle","curveness"]);+O&&(D[2]=[(D[0][0]+D[1][0])/2-(D[0][1]-D[1][1])*O,(D[0][1]+D[1][1])/2-(D[1][0]-D[0][0])*O])}a.setItemLayout(g,D)}}}}}},gRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=r.getData(),l=this._updateLineDraw(a,r),c=r.get("zlevel"),o=r.get(["effect","trailLength"]),d=i.getZr(),g=d.painter.getType()==="svg";g||d.painter.getLayer(c).clear(!0),this._lastZlevel!=null&&!g&&d.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(r)&&o>0&&(g||d.configLayer(c,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(o/10+.9,1),0)})),l.updateData(a);var m=r.get("clip",!0)&&Bb(r.coordinateSystem,!1,r);m?this.group.setClipPath(m):this.group.removeClipPath(),this._lastZlevel=c,this._finished=!0},e.prototype.incrementalPrepareRender=function(r,n,i){var a=r.getData(),l=this._updateLineDraw(a,r);l.incrementalPrepareUpdate(a),this._clearLayer(i),this._finished=!1},e.prototype.incrementalRender=function(r,n,i){this._lineDraw.incrementalUpdate(r,n.getData()),this._finished=r.end===n.getData().count()},e.prototype.eachRendered=function(r){this._lineDraw&&this._lineDraw.eachRendered(r)},e.prototype.updateTransform=function(r,n,i){var a=r.getData(),l=r.pipelineContext;if(!this._finished||l.large||l.progressiveRender)return{update:!0};var c=VJ.reset(r,n,i);c.progress&&c.progress({start:0,end:a.count(),count:a.count()},a),this._lineDraw.updateLayout(),this._clearLayer(i)},e.prototype._updateLineDraw=function(r,n){var i=this._lineDraw,a=this._showEffect(n),l=!!n.get("polyline"),c=n.pipelineContext,o=c.large;return(!i||a!==this._hasEffet||l!==this._isPolyline||o!==this._isLargeDraw)&&(i&&i.remove(),i=this._lineDraw=o?new pRe:new HB(l?a?hRe:NJ:a?FJ:$B),this._hasEffet=a,this._isPolyline=l,this._isLargeDraw=o),this.group.add(i.group),i},e.prototype._showEffect=function(r){return!!r.get(["effect","show"])},e.prototype._clearLayer=function(r){var n=r.getZr(),i=n.painter.getType()==="svg";!i&&this._lastZlevel!=null&&n.painter.getLayer(this._lastZlevel).clear(!0)},e.prototype.remove=function(r,n){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(n)},e.prototype.dispose=function(r,n){this.remove(r,n)},e.type="lines",e}(Oi),vRe=typeof Uint32Array>"u"?Array:Uint32Array,mRe=typeof Float64Array>"u"?Array:Float64Array;function sj(t){var e=t.data;e&&e[0]&&e[0][0]&&e[0][0].coord&&(t.data=Zt(e,function(r){var n=[r[0].coord,r[1].coord],i={coords:n};return r[0].name&&(i.fromName=r[0].name),r[1].name&&(i.toName=r[1].name),xz([i,r[0],r[1]])}))}var _Re=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return e.prototype.init=function(r){r.data=r.data||[],sj(r);var n=this._processFlatCoordsArray(r.data);this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset,n.flatCoords&&(r.data=new Float32Array(n.count)),t.prototype.init.apply(this,arguments)},e.prototype.mergeOption=function(r){if(sj(r),r.data){var n=this._processFlatCoordsArray(r.data);this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset,n.flatCoords&&(r.data=new Float32Array(n.count))}t.prototype.mergeOption.apply(this,arguments)},e.prototype.appendData=function(r){var n=this._processFlatCoordsArray(r.data);n.flatCoords&&(this._flatCoords?(this._flatCoords=wC(this._flatCoords,n.flatCoords),this._flatCoordsOffset=wC(this._flatCoordsOffset,n.flatCoordsOffset)):(this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset),r.data=new Float32Array(n.count)),this.getRawData().appendData(r.data)},e.prototype._getCoordsFromItemModel=function(r){var n=this.getData().getItemModel(r),i=n.option instanceof Array?n.option:n.getShallow("coords");return i},e.prototype.getLineCoordsCount=function(r){return this._flatCoordsOffset?this._flatCoordsOffset[r*2+1]:this._getCoordsFromItemModel(r).length},e.prototype.getLineCoords=function(r,n){if(this._flatCoordsOffset){for(var i=this._flatCoordsOffset[r*2],a=this._flatCoordsOffset[r*2+1],l=0;l<a;l++)n[l]=n[l]||[],n[l][0]=this._flatCoords[i+l*2],n[l][1]=this._flatCoords[i+l*2+1];return a}else{for(var c=this._getCoordsFromItemModel(r),l=0;l<c.length;l++)n[l]=n[l]||[],n[l][0]=c[l][0],n[l][1]=c[l][1];return c.length}},e.prototype._processFlatCoordsArray=function(r){var n=0;if(this._flatCoords&&(n=this._flatCoords.length),ii(r[0])){for(var i=r.length,a=new vRe(i),l=new mRe(i),c=0,o=0,d=0,g=0;g<i;){d++;var m=r[g++];a[o++]=c+n,a[o++]=m;for(var y=0;y<m;y++){var x=r[g++],A=r[g++];l[c++]=x,l[c++]=A}}return{flatCoordsOffset:new Uint32Array(a.buffer,0,o),flatCoords:l,count:d}}return{flatCoordsOffset:null,flatCoords:null,count:r.length}},e.prototype.getInitialData=function(r,n){var i=new ts(["value"],this);return i.hasItemOption=!1,i.initData(r.data,[],function(a,l,c,o){if(a instanceof Array)return NaN;i.hasItemOption=!0;var d=a.value;if(d!=null)return d instanceof Array?d[o]:d}),i},e.prototype.formatTooltip=function(r,n,i){var a=this.getData(),l=a.getItemModel(r),c=l.get("name");if(c)return c;var o=l.get("fromName"),d=l.get("toName"),g=[];return o!=null&&g.push(o),d!=null&&g.push(d),ro("nameValue",{name:g.join(" > ")})},e.prototype.preventIncremental=function(){return!!this.get(["effect","show"])},e.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?1e4:this.get("progressive"))},e.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?2e4:this.get("progressiveThreshold"))},e.prototype.getZLevelKey=function(){var r=this.getModel("effect"),n=r.get("trailLength");return this.getData().count()>this.getProgressiveThreshold()?this.id:r.get("show")&&n>0?n+"":""},e.type="series.lines",e.dependencies=["grid","polar","geo","calendar"],e.defaultOption={coordinateSystem:"geo",z:2,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}},e}(Wi);function cA(t){return t instanceof Array||(t=[t,t]),t}var yRe={seriesType:"lines",reset:function(t){var e=cA(t.get("symbol")),r=cA(t.get("symbolSize")),n=t.getData();n.setVisual("fromSymbol",e&&e[0]),n.setVisual("toSymbol",e&&e[1]),n.setVisual("fromSymbolSize",r&&r[0]),n.setVisual("toSymbolSize",r&&r[1]);function i(a,l){var c=a.getItemModel(l),o=cA(c.getShallow("symbol",!0)),d=cA(c.getShallow("symbolSize",!0));o[0]&&a.setItemVisual(l,"fromSymbol",o[0]),o[1]&&a.setItemVisual(l,"toSymbol",o[1]),d[0]&&a.setItemVisual(l,"fromSymbolSize",d[0]),d[1]&&a.setItemVisual(l,"toSymbolSize",d[1])}return{dataEach:n.hasItemOption?i:null}}};function xRe(t){t.registerChartView(gRe),t.registerSeriesModel(_Re),t.registerLayout(VJ),t.registerVisual(yRe)}var bRe=256,wRe=function(){function t(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var e=gd.createCanvas();this.canvas=e}return t.prototype.update=function(e,r,n,i,a,l){var c=this._getBrush(),o=this._getGradient(a,"inRange"),d=this._getGradient(a,"outOfRange"),g=this.pointSize+this.blurSize,m=this.canvas,y=m.getContext("2d"),x=e.length;m.width=r,m.height=n;for(var A=0;A<x;++A){var M=e[A],D=M[0],P=M[1],O=M[2],z=i(O);y.globalAlpha=z,y.drawImage(c,D-g,P-g)}if(!m.width||!m.height)return m;for(var V=y.getImageData(0,0,m.width,m.height),H=V.data,$=0,X=H.length,W=this.minOpacity,Y=this.maxOpacity,J=Y-W;$<X;){var z=H[$+3]/256,re=Math.floor(z*(bRe-1))*4;if(z>0){var ae=l(z)?o:d;z>0&&(z=z*J+W),H[$++]=ae[re],H[$++]=ae[re+1],H[$++]=ae[re+2],H[$++]=ae[re+3]*z*256}else $+=4}return y.putImageData(V,0,0),m},t.prototype._getBrush=function(){var e=this._brushCanvas||(this._brushCanvas=gd.createCanvas()),r=this.pointSize+this.blurSize,n=r*2;e.width=n,e.height=n;var i=e.getContext("2d");return i.clearRect(0,0,n,n),i.shadowOffsetX=n,i.shadowBlur=this.blurSize,i.shadowColor="#000",i.beginPath(),i.arc(-r,r,this.pointSize,0,Math.PI*2,!0),i.closePath(),i.fill(),e},t.prototype._getGradient=function(e,r){for(var n=this._gradientPixels,i=n[r]||(n[r]=new Uint8ClampedArray(256*4)),a=[0,0,0,0],l=0,c=0;c<256;c++)e[r](c/255,!0,a),i[l++]=a[0],i[l++]=a[1],i[l++]=a[2],i[l++]=a[3];return i},t}();function SRe(t,e,r){var n=t[1]-t[0];e=Zt(e,function(l){return{interval:[(l.interval[0]-t[0])/n,(l.interval[1]-t[0])/n]}});var i=e.length,a=0;return function(l){var c;for(c=a;c<i;c++){var o=e[c].interval;if(o[0]<=l&&l<=o[1]){a=c;break}}if(c===i)for(c=a-1;c>=0;c--){var o=e[c].interval;if(o[0]<=l&&l<=o[1]){a=c;break}}return c>=0&&c<i&&r[c]}}function TRe(t,e){var r=t[1]-t[0];return e=[(e[0]-t[0])/r,(e[1]-t[0])/r],function(n){return n>=e[0]&&n<=e[1]}}function lj(t){var e=t.dimensions;return e[0]==="lng"&&e[1]==="lat"}var ARe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a;n.eachComponent("visualMap",function(c){c.eachTargetSeries(function(o){o===r&&(a=c)})}),this._progressiveEls=null,this.group.removeAll();var l=r.coordinateSystem;l.type==="cartesian2d"||l.type==="calendar"?this._renderOnCartesianAndCalendar(r,i,0,r.getData().count()):lj(l)&&this._renderOnGeo(l,r,a,i)},e.prototype.incrementalPrepareRender=function(r,n,i){this.group.removeAll()},e.prototype.incrementalRender=function(r,n,i,a){var l=n.coordinateSystem;l&&(lj(l)?this.render(n,i,a):(this._progressiveEls=[],this._renderOnCartesianAndCalendar(n,a,r.start,r.end,!0)))},e.prototype.eachRendered=function(r){Id(this._progressiveEls||this.group,r)},e.prototype._renderOnCartesianAndCalendar=function(r,n,i,a,l){var c=r.coordinateSystem,o=gv(c,"cartesian2d"),d,g,m,y;if(o){var x=c.getAxis("x"),A=c.getAxis("y");d=x.getBandWidth()+.5,g=A.getBandWidth()+.5,m=x.scale.getExtent(),y=A.scale.getExtent()}for(var M=this.group,D=r.getData(),P=r.getModel(["emphasis","itemStyle"]).getItemStyle(),O=r.getModel(["blur","itemStyle"]).getItemStyle(),z=r.getModel(["select","itemStyle"]).getItemStyle(),V=r.get(["itemStyle","borderRadius"]),H=to(r),$=r.getModel("emphasis"),X=$.get("focus"),W=$.get("blurScope"),Y=$.get("disabled"),J=o?[D.mapDimension("x"),D.mapDimension("y"),D.mapDimension("value")]:[D.mapDimension("time"),D.mapDimension("value")],re=i;re<a;re++){var ae=void 0,pe=D.getItemVisual(re,"style");if(o){var de=D.get(J[0],re),ve=D.get(J[1],re);if(isNaN(D.get(J[2],re))||isNaN(de)||isNaN(ve)||de<m[0]||de>m[1]||ve<y[0]||ve>y[1])continue;var me=c.dataToPoint([de,ve]);ae=new Kn({shape:{x:me[0]-d/2,y:me[1]-g/2,width:d,height:g},style:pe})}else{if(isNaN(D.get(J[1],re)))continue;ae=new Kn({z2:1,shape:c.dataToRect([D.get(J[0],re)]).contentShape,style:pe})}if(D.hasItemOption){var Ie=D.getItemModel(re),Le=Ie.getModel("emphasis");P=Le.getModel("itemStyle").getItemStyle(),O=Ie.getModel(["blur","itemStyle"]).getItemStyle(),z=Ie.getModel(["select","itemStyle"]).getItemStyle(),V=Ie.get(["itemStyle","borderRadius"]),X=Le.get("focus"),W=Le.get("blurScope"),Y=Le.get("disabled"),H=to(Ie)}ae.shape.r=V;var Ee=r.getRawValue(re),Ue="-";Ee&&Ee[2]!=null&&(Ue=Ee[2]+""),Ao(ae,H,{labelFetcher:r,labelDataIndex:re,defaultOpacity:pe.opacity,defaultText:Ue}),ae.ensureState("emphasis").style=P,ae.ensureState("blur").style=O,ae.ensureState("select").style=z,da(ae,X,W,Y),ae.incremental=l,l&&(ae.states.emphasis.hoverLayer=!0),M.add(ae),D.setItemGraphicEl(re,ae),this._progressiveEls&&this._progressiveEls.push(ae)}},e.prototype._renderOnGeo=function(r,n,i,a){var l=i.targetVisuals.inRange,c=i.targetVisuals.outOfRange,o=n.getData(),d=this._hmLayer||this._hmLayer||new wRe;d.blurSize=n.get("blurSize"),d.pointSize=n.get("pointSize"),d.minOpacity=n.get("minOpacity"),d.maxOpacity=n.get("maxOpacity");var g=r.getViewRect().clone(),m=r.getRoamTransform();g.applyTransform(m);var y=Math.max(g.x,0),x=Math.max(g.y,0),A=Math.min(g.width+g.x,a.getWidth()),M=Math.min(g.height+g.y,a.getHeight()),D=A-y,P=M-x,O=[o.mapDimension("lng"),o.mapDimension("lat"),o.mapDimension("value")],z=o.mapArray(O,function(X,W,Y){var J=r.dataToPoint([X,W]);return J[0]-=y,J[1]-=x,J.push(Y),J}),V=i.getExtent(),H=i.type==="visualMap.continuous"?TRe(V,i.option.range):SRe(V,i.getPieceList(),i.option.selected);d.update(z,D,P,l.color.getNormalizer(),{inRange:l.color.getColorMapper(),outOfRange:c.color.getColorMapper()},H);var $=new fo({style:{width:D,height:P,x:y,y:x,image:d.canvas},silent:!0});this.group.add($)},e.type="heatmap",e}(Oi),CRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.getInitialData=function(r,n){return Mh(null,this,{generateCoord:"value"})},e.prototype.preventIncremental=function(){var r=Db.get(this.get("coordinateSystem"));if(r&&r.dimensions)return r.dimensions[0]==="lng"&&r.dimensions[1]==="lat"},e.type="series.heatmap",e.dependencies=["grid","geo","calendar"],e.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},e}(Wi);function MRe(t){t.registerChartView(ARe),t.registerSeriesModel(CRe)}var IRe=["itemStyle","borderWidth"],uj=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],oR=new Ch,ERe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=this.group,l=r.getData(),c=this._data,o=r.coordinateSystem,d=o.getBaseAxis(),g=d.isHorizontal(),m=o.master.getRect(),y={ecSize:{width:i.getWidth(),height:i.getHeight()},seriesModel:r,coordSys:o,coordSysExtent:[[m.x,m.x+m.width],[m.y,m.y+m.height]],isHorizontal:g,valueDim:uj[+g],categoryDim:uj[1-+g]};l.diff(c).add(function(A){if(l.hasValue(A)){var M=hj(l,A),D=cj(l,A,M,y),P=fj(l,y,D);l.setItemGraphicEl(A,P),a.add(P),pj(P,y,D)}}).update(function(A,M){var D=c.getItemGraphicEl(M);if(!l.hasValue(A)){a.remove(D);return}var P=hj(l,A),O=cj(l,A,P,y),z=WJ(l,O);D&&z!==D.__pictorialShapeStr&&(a.remove(D),l.setItemGraphicEl(A,null),D=null),D?zRe(D,y,O):D=fj(l,y,O,!0),l.setItemGraphicEl(A,D),D.__pictorialSymbolMeta=O,a.add(D),pj(D,y,O)}).remove(function(A){var M=c.getItemGraphicEl(A);M&&dj(c,A,M.__pictorialSymbolMeta.animationModel,M)}).execute();var x=r.get("clip",!0)?Bb(r.coordinateSystem,!1,r):null;return x?a.setClipPath(x):a.removeClipPath(),this._data=l,this.group},e.prototype.remove=function(r,n){var i=this.group,a=this._data;r.get("animation")?a&&a.eachItemGraphicEl(function(l){dj(a,Yr(l).dataIndex,r,l)}):i.removeAll()},e.type="pictorialBar",e}(Oi);function cj(t,e,r,n){var i=t.getItemLayout(e),a=r.get("symbolRepeat"),l=r.get("symbolClip"),c=r.get("symbolPosition")||"start",o=r.get("symbolRotate"),d=(o||0)*Math.PI/180||0,g=r.get("symbolPatternSize")||2,m=r.isAnimationEnabled(),y={dataIndex:e,layout:i,itemModel:r,symbolType:t.getItemVisual(e,"symbol")||"circle",style:t.getItemVisual(e,"style"),symbolClip:l,symbolRepeat:a,symbolRepeatDirection:r.get("symbolRepeatDirection"),symbolPatternSize:g,rotation:d,animationModel:m?r:null,hoverScale:m&&r.get(["emphasis","scale"]),z2:r.getShallow("z",!0)||0};DRe(r,a,i,n,y),PRe(t,e,i,a,l,y.boundingLength,y.pxSign,g,n,y),LRe(r,y.symbolScale,d,n,y);var x=y.symbolSize,A=dv(r.get("symbolOffset"),x);return RRe(r,x,i,a,l,A,c,y.valueLineWidth,y.boundingLength,y.repeatCutLength,n,y),y}function DRe(t,e,r,n,i){var a=n.valueDim,l=t.get("symbolBoundingData"),c=n.coordSys.getOtherAxis(n.coordSys.getBaseAxis()),o=c.toGlobalCoord(c.dataToCoord(0)),d=1-+(r[a.wh]<=0),g;if(Ht(l)){var m=[sR(c,l[0])-o,sR(c,l[1])-o];m[1]<m[0]&&m.reverse(),g=m[d]}else l!=null?g=sR(c,l)-o:e?g=n.coordSysExtent[a.index][d]-o:g=r[a.wh];i.boundingLength=g,e&&(i.repeatCutLength=r[a.wh]),i.pxSign=g>0?1:-1}function sR(t,e){return t.toGlobalCoord(t.dataToCoord(t.scale.parse(e)))}function PRe(t,e,r,n,i,a,l,c,o,d){var g=o.valueDim,m=o.categoryDim,y=Math.abs(r[m.wh]),x=t.getItemVisual(e,"symbolSize"),A;Ht(x)?A=x.slice():x==null?A=["100%","100%"]:A=[x,x],A[m.index]=dr(A[m.index],y),A[g.index]=dr(A[g.index],n?y:Math.abs(a)),d.symbolSize=A;var M=d.symbolScale=[A[0]/c,A[1]/c];M[g.index]*=(o.isHorizontal?-1:1)*l}function LRe(t,e,r,n,i){var a=t.get(IRe)||0;a&&(oR.attr({scaleX:e[0],scaleY:e[1],rotation:r}),oR.updateTransform(),a/=oR.getLineScale(),a*=e[n.valueDim.index]),i.valueLineWidth=a||0}function RRe(t,e,r,n,i,a,l,c,o,d,g,m){var y=g.categoryDim,x=g.valueDim,A=m.pxSign,M=Math.max(e[x.index]+c,0),D=M;if(n){var P=Math.abs(o),O=ho(t.get("symbolMargin"),"15%")+"",z=!1;O.lastIndexOf("!")===O.length-1&&(z=!0,O=O.slice(0,O.length-1));var V=dr(O,e[x.index]),H=Math.max(M+V*2,0),$=z?0:V*2,X=X2(n),W=X?n:gj((P+$)/H),Y=P-W*M;V=Y/2/(z?W:Math.max(W-1,1)),H=M+V*2,$=z?0:V*2,!X&&n!=="fixed"&&(W=d?gj((Math.abs(d)+$)/H):0),D=W*H-$,m.repeatTimes=W,m.symbolMargin=V}var J=A*(D/2),re=m.pathPosition=[];re[y.index]=r[y.wh]/2,re[x.index]=l==="start"?J:l==="end"?o-J:o/2,a&&(re[0]+=a[0],re[1]+=a[1]);var ae=m.bundlePosition=[];ae[y.index]=r[y.xy],ae[x.index]=r[x.xy];var pe=m.barRectShape=Lt({},r);pe[x.wh]=A*Math.max(Math.abs(r[x.wh]),Math.abs(re[x.index]+J)),pe[y.wh]=r[y.wh];var de=m.clipShape={};de[y.xy]=-r[y.xy],de[y.wh]=g.ecSize[y.wh],de[x.xy]=0,de[x.wh]=r[x.wh]}function GJ(t){var e=t.symbolPatternSize,r=Ia(t.symbolType,-e/2,-e/2,e,e);return r.attr({culling:!0}),r.type!=="image"&&r.setStyle({strokeNoScale:!0}),r}function UJ(t,e,r,n){var i=t.__pictorialBundle,a=r.symbolSize,l=r.valueLineWidth,c=r.pathPosition,o=e.valueDim,d=r.repeatTimes||0,g=0,m=a[e.valueDim.index]+l+r.symbolMargin*2;for(KB(t,function(M){M.__pictorialAnimationIndex=g,M.__pictorialRepeatTimes=d,g<d?E_(M,null,A(g),r,n):E_(M,null,{scaleX:0,scaleY:0},r,n,function(){i.remove(M)}),g++});g<d;g++){var y=GJ(r);y.__pictorialAnimationIndex=g,y.__pictorialRepeatTimes=d,i.add(y);var x=A(g);E_(y,{x:x.x,y:x.y,scaleX:0,scaleY:0},{scaleX:x.scaleX,scaleY:x.scaleY,rotation:x.rotation},r,n)}function A(M){var D=c.slice(),P=r.pxSign,O=M;return(r.symbolRepeatDirection==="start"?P>0:P<0)&&(O=d-1-M),D[o.index]=m*(O-d/2+.5)+c[o.index],{x:D[0],y:D[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation}}}function $J(t,e,r,n){var i=t.__pictorialBundle,a=t.__pictorialMainPath;a?E_(a,null,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation},r,n):(a=t.__pictorialMainPath=GJ(r),i.add(a),E_(a,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:0,scaleY:0,rotation:r.rotation},{scaleX:r.symbolScale[0],scaleY:r.symbolScale[1]},r,n))}function HJ(t,e,r){var n=Lt({},e.barRectShape),i=t.__pictorialBarRect;i?E_(i,null,{shape:n},e,r):(i=t.__pictorialBarRect=new Kn({z2:2,shape:n,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),i.disableMorphing=!0,t.add(i))}function jJ(t,e,r,n){if(r.symbolClip){var i=t.__pictorialClipPath,a=Lt({},r.clipShape),l=e.valueDim,c=r.animationModel,o=r.dataIndex;if(i)li(i,{shape:a},c,o);else{a[l.wh]=0,i=new Kn({shape:a}),t.__pictorialBundle.setClipPath(i),t.__pictorialClipPath=i;var d={};d[l.wh]=r.clipShape[l.wh],fv[n?"updateProps":"initProps"](i,{shape:d},c,o)}}}function hj(t,e){var r=t.getItemModel(e);return r.getAnimationDelayParams=kRe,r.isAnimationEnabled=ORe,r}function kRe(t){return{index:t.__pictorialAnimationIndex,count:t.__pictorialRepeatTimes}}function ORe(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function fj(t,e,r,n){var i=new jr,a=new jr;return i.add(a),i.__pictorialBundle=a,a.x=r.bundlePosition[0],a.y=r.bundlePosition[1],r.symbolRepeat?UJ(i,e,r):$J(i,e,r),HJ(i,r,n),jJ(i,e,r,n),i.__pictorialShapeStr=WJ(t,r),i.__pictorialSymbolMeta=r,i}function zRe(t,e,r){var n=r.animationModel,i=r.dataIndex,a=t.__pictorialBundle;li(a,{x:r.bundlePosition[0],y:r.bundlePosition[1]},n,i),r.symbolRepeat?UJ(t,e,r,!0):$J(t,e,r,!0),HJ(t,r,!0),jJ(t,e,r,!0)}function dj(t,e,r,n){var i=n.__pictorialBarRect;i&&i.removeTextContent();var a=[];KB(n,function(l){a.push(l)}),n.__pictorialMainPath&&a.push(n.__pictorialMainPath),n.__pictorialClipPath&&(r=null),fe(a,function(l){md(l,{scaleX:0,scaleY:0},r,e,function(){n.parent&&n.parent.remove(n)})}),t.setItemGraphicEl(e,null)}function WJ(t,e){return[t.getItemVisual(e.dataIndex,"symbol")||"none",!!e.symbolRepeat,!!e.symbolClip].join(":")}function KB(t,e,r){fe(t.__pictorialBundle.children(),function(n){n!==t.__pictorialBarRect&&e.call(r,n)})}function E_(t,e,r,n,i,a){e&&t.attr(e),n.symbolClip&&!i?r&&t.attr(r):r&&fv[i?"updateProps":"initProps"](t,r,n.animationModel,n.dataIndex,a)}function pj(t,e,r){var n=r.dataIndex,i=r.itemModel,a=i.getModel("emphasis"),l=a.getModel("itemStyle").getItemStyle(),c=i.getModel(["blur","itemStyle"]).getItemStyle(),o=i.getModel(["select","itemStyle"]).getItemStyle(),d=i.getShallow("cursor"),g=a.get("focus"),m=a.get("blurScope"),y=a.get("scale");KB(t,function(M){if(M instanceof fo){var D=M.style;M.useStyle(Lt({image:D.image,x:D.x,y:D.y,width:D.width,height:D.height},r.style))}else M.useStyle(r.style);var P=M.ensureState("emphasis");P.style=l,y&&(P.scaleX=M.scaleX*1.1,P.scaleY=M.scaleY*1.1),M.ensureState("blur").style=c,M.ensureState("select").style=o,d&&(M.cursor=d),M.z2=r.z2});var x=e.valueDim.posDesc[+(r.boundingLength>0)],A=t.__pictorialBarRect;A.ignoreClip=!0,Ao(A,to(i),{labelFetcher:e.seriesModel,labelDataIndex:n,defaultText:Z_(e.seriesModel.getData(),n),inheritColor:r.style.fill,defaultOpacity:r.style.opacity,defaultOutsidePosition:x}),da(t,g,m,a.get("disabled"))}function gj(t){var e=Math.round(t);return Math.abs(t-e)<1e-4?e:Math.ceil(t)}var BRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.hasSymbolVisual=!0,r.defaultSymbol="roundRect",r}return e.prototype.getInitialData=function(r){return r.stack=null,t.prototype.getInitialData.apply(this,arguments)},e.type="series.pictorialBar",e.dependencies=["grid"],e.defaultOption=Ed(rb.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",clip:!1,progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:"#212121"}}}),e}(rb);function FRe(t){t.registerChartView(ERe),t.registerSeriesModel(BRe),t.registerLayout(t.PRIORITY.VISUAL.LAYOUT,on(DQ,"pictorialBar")),t.registerLayout(t.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,PQ("pictorialBar"))}var NRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._layers=[],r}return e.prototype.render=function(r,n,i){var a=r.getData(),l=this,c=this.group,o=r.getLayerSeries(),d=a.getLayout("layoutInfo"),g=d.rect,m=d.boundaryGap;c.x=0,c.y=g.y+m[0];function y(D){return D.name}var x=new mh(this._layersSeries||[],o,y,y),A=[];x.add(wr(M,this,"add")).update(wr(M,this,"update")).remove(wr(M,this,"remove")).execute();function M(D,P,O){var z=l._layers;if(D==="remove"){c.remove(z[P]);return}for(var V=[],H=[],$,X=o[P].indices,W=0;W<X.length;W++){var Y=a.getItemLayout(X[W]),J=Y.x,re=Y.y0,ae=Y.y;V.push(J,re),H.push(J,re+ae),$=a.getItemVisual(X[W],"style")}var pe,de=a.getItemLayout(X[0]),ve=r.getModel("label"),me=ve.get("margin"),Ie=r.getModel("emphasis");if(D==="add"){var Le=A[P]=new jr;pe=new _K({shape:{points:V,stackedOnPoints:H,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),Le.add(pe),c.add(Le),r.isAnimationEnabled()&&pe.setClipPath(VRe(pe.getBoundingRect(),r,function(){pe.removeClipPath()}))}else{var Le=z[O];pe=Le.childAt(0),c.add(Le),A[P]=Le,li(pe,{shape:{points:V,stackedOnPoints:H}},r),xu(pe)}Ao(pe,to(r),{labelDataIndex:X[W-1],defaultText:a.getName(X[W-1]),inheritColor:$.fill},{normal:{verticalAlign:"middle"}}),pe.setTextConfig({position:null,local:!0});var Ee=pe.getTextContent();Ee&&(Ee.x=de.x-me,Ee.y=de.y0+de.y/2),pe.useStyle($),a.setItemGraphicEl(P,pe),To(pe,r),da(pe,Ie.get("focus"),Ie.get("blurScope"),Ie.get("disabled"))}this._layersSeries=o,this._layers=A},e.type="themeRiver",e}(Oi);function VRe(t,e,r){var n=new Kn({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return Qi(n,{shape:{x:t.x-50,width:t.width+100,height:t.height+20}},e,r),n}var lR=2,GRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new Vb(wr(this.getData,this),wr(this.getRawData,this))},e.prototype.fixData=function(r){var n=r.length,i={},a=Gk(r,function(y){return i.hasOwnProperty(y[0]+"")||(i[y[0]+""]=-1),y[2]}),l=[];a.buckets.each(function(y,x){l.push({name:x,dataList:y})});for(var c=l.length,o=0;o<c;++o){for(var d=l[o].name,g=0;g<l[o].dataList.length;++g){var m=l[o].dataList[g][0]+"";i[m]=o}for(var m in i)i.hasOwnProperty(m)&&i[m]!==o&&(i[m]=o,r[n]=[m,0,d],n++)}return r},e.prototype.getInitialData=function(r,n){for(var i=this.getReferringComponents("singleAxis",Ma).models[0],a=i.get("type"),l=Ei(r.data,function(A){return A[2]!==void 0}),c=this.fixData(l||[]),o=[],d=this.nameMap=Ir(),g=0,m=0;m<c.length;++m)o.push(c[m][lR]),d.get(c[m][lR])||(d.set(c[m][lR],g),g++);var y=Lb(c,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:WC(a)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}).dimensions,x=new ts(y,this);return x.initData(c),x},e.prototype.getLayerSeries=function(){for(var r=this.getData(),n=r.count(),i=[],a=0;a<n;++a)i[a]=a;var l=r.mapDimension("single"),c=Gk(i,function(d){return r.get("name",d)}),o=[];return c.buckets.each(function(d,g){d.sort(function(m,y){return r.get(l,m)-r.get(l,y)}),o.push({name:g,indices:d})}),o},e.prototype.getAxisTooltipData=function(r,n,i){Ht(r)||(r=r?[r]:[]);for(var a=this.getData(),l=this.getLayerSeries(),c=[],o=l.length,d,g=0;g<o;++g){for(var m=Number.MAX_VALUE,y=-1,x=l[g].indices.length,A=0;A<x;++A){var M=a.get(r[0],l[g].indices[A]),D=Math.abs(M-n);D<=m&&(d=M,m=D,y=l[g].indices[A])}c.push(y)}return{dataIndices:c,nestestValue:d}},e.prototype.formatTooltip=function(r,n,i){var a=this.getData(),l=a.getName(r),c=a.get(a.mapDimension("value"),r);return ro("nameValue",{name:l,value:c})},e.type="series.themeRiver",e.dependencies=["singleAxis"],e.defaultOption={z:2,colorBy:"data",coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",fontSize:11},emphasis:{label:{show:!0}}},e}(Wi);function URe(t,e){t.eachSeriesByType("themeRiver",function(r){var n=r.getData(),i=r.coordinateSystem,a={},l=i.getRect();a.rect=l;var c=r.get("boundaryGap"),o=i.getAxis();if(a.boundaryGap=c,o.orient==="horizontal"){c[0]=dr(c[0],l.height),c[1]=dr(c[1],l.height);var d=l.height-c[0]-c[1];vj(n,r,d)}else{c[0]=dr(c[0],l.width),c[1]=dr(c[1],l.width);var g=l.width-c[0]-c[1];vj(n,r,g)}n.setLayout("layoutInfo",a)})}function vj(t,e,r){if(t.count())for(var n=e.coordinateSystem,i=e.getLayerSeries(),a=t.mapDimension("single"),l=t.mapDimension("value"),c=Zt(i,function(D){return Zt(D.indices,function(P){var O=n.dataToPoint(t.get(a,P));return O[1]=t.get(l,P),O})}),o=$Re(c),d=o.y0,g=r/o.max,m=i.length,y=i[0].indices.length,x,A=0;A<y;++A){x=d[A]*g,t.setItemLayout(i[0].indices[A],{layerIndex:0,x:c[0][A][0],y0:x,y:c[0][A][1]*g});for(var M=1;M<m;++M)x+=c[M-1][A][1]*g,t.setItemLayout(i[M].indices[A],{layerIndex:M,x:c[M][A][0],y0:x,y:c[M][A][1]*g})}}function $Re(t){for(var e=t.length,r=t[0].length,n=[],i=[],a=0,l=0;l<r;++l){for(var c=0,o=0;o<e;++o)c+=t[o][l][1];c>a&&(a=c),n.push(c)}for(var d=0;d<r;++d)i[d]=(a-n[d])/2;a=0;for(var g=0;g<r;++g){var m=n[g]+i[g];m>a&&(a=m)}return{y0:i,max:a}}function HRe(t){t.registerChartView(NRe),t.registerSeriesModel(GRe),t.registerLayout(URe),t.registerProcessor(Nb("themeRiver"))}var jRe=2,WRe=4,mj=function(t){et(e,t);function e(r,n,i,a){var l=t.call(this)||this;l.z2=jRe,l.textConfig={inside:!0},Yr(l).seriesIndex=n.seriesIndex;var c=new ti({z2:WRe,silent:r.getModel().get(["label","silent"])});return l.setTextContent(c),l.updateData(!0,r,n,i,a),l}return e.prototype.updateData=function(r,n,i,a,l){this.node=n,n.piece=this,i=i||this._seriesModel,a=a||this._ecModel;var c=this;Yr(c).dataIndex=n.dataIndex;var o=n.getModel(),d=o.getModel("emphasis"),g=n.getLayout(),m=Lt({},g);m.label=null;var y=n.getVisual("style");y.lineJoin="bevel";var x=n.getVisual("decal");x&&(y.decal=j_(x,l));var A=Pg(o.getModel("itemStyle"),m,!0);Lt(m,A),fe(is,function(O){var z=c.ensureState(O),V=o.getModel([O,"itemStyle"]);z.style=V.getItemStyle();var H=Pg(V,m);H&&(z.shape=H)}),r?(c.setShape(m),c.shape.r=g.r0,Qi(c,{shape:{r:g.r}},i,n.dataIndex)):(li(c,{shape:m},i),xu(c)),c.useStyle(y),this._updateLabel(i);var M=o.getShallow("cursor");M&&c.attr("cursor",M),this._seriesModel=i||this._seriesModel,this._ecModel=a||this._ecModel;var D=d.get("focus"),P=D==="ancestor"?n.getAncestorsIndices():D==="descendant"?n.getDescendantIndices():D;da(this,P,d.get("blurScope"),d.get("disabled"))},e.prototype._updateLabel=function(r){var n=this,i=this.node.getModel(),a=i.getModel("label"),l=this.node.getLayout(),c=l.endAngle-l.startAngle,o=(l.startAngle+l.endAngle)/2,d=Math.cos(o),g=Math.sin(o),m=this,y=m.getTextContent(),x=this.node.dataIndex,A=a.get("minAngle")/180*Math.PI,M=a.get("show")&&!(A!=null&&Math.abs(c)<A);y.ignore=!M,fe(H1,function(P){var O=P==="normal"?i.getModel("label"):i.getModel([P,"label"]),z=P==="normal",V=z?y:y.ensureState(P),H=r.getFormattedLabel(x,P);z&&(H=H||n.node.name),V.style=Hi(O,{},null,P!=="normal",!0),H&&(V.style.text=H);var $=O.get("show");$!=null&&!z&&(V.ignore=!$);var X=D(O,"position"),W=z?m:m.states[P],Y=W.style.fill;W.textConfig={outsideFill:O.get("color")==="inherit"?Y:null,inside:X!=="outside"};var J,re=D(O,"distance")||0,ae=D(O,"align"),pe=D(O,"rotate"),de=Math.PI*.5,ve=Math.PI*1.5,me=Xs(pe==="tangential"?Math.PI/2-o:o),Ie=me>de&&!U1(me-de)&&me<ve;X==="outside"?(J=l.r+re,ae=Ie?"right":"left"):!ae||ae==="center"?(c===2*Math.PI&&l.r0===0?J=0:J=(l.r+l.r0)/2,ae="center"):ae==="left"?(J=l.r0+re,ae=Ie?"right":"left"):ae==="right"&&(J=l.r-re,ae=Ie?"left":"right"),V.style.align=ae,V.style.verticalAlign=D(O,"verticalAlign")||"middle",V.x=J*d+l.cx,V.y=J*g+l.cy;var Le=0;pe==="radial"?Le=Xs(-o)+(Ie?Math.PI:0):pe==="tangential"?Le=Xs(Math.PI/2-o)+(Ie?Math.PI:0):ii(pe)&&(Le=pe*Math.PI/180),V.rotation=Xs(Le)});function D(P,O){var z=P.get(O);return z??a.get(O)}y.dirtyStyle()},e}(as),VO="sunburstRootToNode",_j="sunburstHighlight",ZRe="sunburstUnhighlight";function qRe(t){t.registerAction({type:VO,update:"updateView"},function(e,r){r.eachComponent({mainType:"series",subType:"sunburst",query:e},n);function n(i,a){var l=ib(e,[VO],i);if(l){var c=i.getViewRoot();c&&(e.direction=FB(c,l.node)?"rollUp":"drillDown"),i.resetViewRoot(l.node)}}}),t.registerAction({type:_j,update:"none"},function(e,r,n){e=Lt({},e),r.eachComponent({mainType:"series",subType:"sunburst",query:e},i);function i(a){var l=ib(e,[_j],a);l&&(e.dataIndex=l.node.dataIndex)}n.dispatchAction(Lt(e,{type:"highlight"}))}),t.registerAction({type:ZRe,update:"updateView"},function(e,r,n){e=Lt({},e),n.dispatchAction(Lt(e,{type:"downplay"}))})}var YRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i,a){var l=this;this.seriesModel=r,this.api=i,this.ecModel=n;var c=r.getData(),o=c.tree.root,d=r.getViewRoot(),g=this.group,m=r.get("renderLabelForZeroData"),y=[];d.eachNode(function(O){y.push(O)});var x=this._oldChildren||[];A(y,x),P(o,d),this._initEvents(),this._oldChildren=y;function A(O,z){if(O.length===0&&z.length===0)return;new mh(z,O,V,V).add(H).update(H).remove(on(H,null)).execute();function V($){return $.getId()}function H($,X){var W=$==null?null:O[$],Y=X==null?null:z[X];M(W,Y)}}function M(O,z){if(!m&&O&&!O.getValue()&&(O=null),O!==o&&z!==o){if(z&&z.piece)O?(z.piece.updateData(!1,O,r,n,i),c.setItemGraphicEl(O.dataIndex,z.piece)):D(z);else if(O){var V=new mj(O,r,n,i);g.add(V),c.setItemGraphicEl(O.dataIndex,V)}}}function D(O){O&&O.piece&&(g.remove(O.piece),O.piece=null)}function P(O,z){z.depth>0?(l.virtualPiece?l.virtualPiece.updateData(!1,O,r,n,i):(l.virtualPiece=new mj(O,r,n,i),g.add(l.virtualPiece)),z.piece.off("click"),l.virtualPiece.on("click",function(V){l._rootToNode(z.parentNode)})):l.virtualPiece&&(g.remove(l.virtualPiece),l.virtualPiece=null)}},e.prototype._initEvents=function(){var r=this;this.group.off("click"),this.group.on("click",function(n){var i=!1,a=r.seriesModel.getViewRoot();a.eachNode(function(l){if(!i&&l.piece&&l.piece===n.target){var c=l.getModel().get("nodeClick");if(c==="rootToNode")r._rootToNode(l);else if(c==="link"){var o=l.getModel(),d=o.get("link");if(d){var g=o.get("target",!0)||"_blank";FC(d,g)}}i=!0}})})},e.prototype._rootToNode=function(r){r!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:VO,from:this.uid,seriesId:this.seriesModel.id,targetNode:r})},e.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var l=r[0]-a.cx,c=r[1]-a.cy,o=Math.sqrt(l*l+c*c);return o<=a.r&&o>=a.r0}},e.type="sunburst",e}(Oi),XRe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.ignoreStyleOnData=!0,r}return e.prototype.getInitialData=function(r,n){var i={name:r.name,children:r.data};ZJ(i);var a=this._levelModels=Zt(r.levels||[],function(o){return new bi(o,this,n)},this),l=BB.createTree(i,this,c);function c(o){o.wrapMethod("getItemModel",function(d,g){var m=l.getNodeByDataIndex(g),y=a[m.depth];return y&&(d.parentModel=y),d})}return l.data},e.prototype.optionUpdated=function(){this.resetViewRoot()},e.prototype.getDataParams=function(r){var n=t.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(r);return n.treePathInfo=LI(i,this),n},e.prototype.getLevelModel=function(r){return this._levelModels&&this._levelModels[r.depth]},e.prototype.getViewRoot=function(){return this._viewRoot},e.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var n=this.getRawData().tree.root;(!r||r!==n&&!n.contains(r))&&(this._viewRoot=n)},e.prototype.enableAriaDecal=function(){KK(this)},e.type="series.sunburst",e.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},e}(Wi);function ZJ(t){var e=0;fe(t.children,function(n){ZJ(n);var i=n.value;Ht(i)&&(i=i[0]),e+=i});var r=t.value;Ht(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=e),r<0&&(r=0),Ht(t.value)?t.value[0]=r:t.value=r}var yj=Math.PI/180;function QRe(t,e,r){e.eachSeriesByType(t,function(n){var i=n.get("center"),a=n.get("radius");Ht(a)||(a=[0,a]),Ht(i)||(i=[i,i]);var l=r.getWidth(),c=r.getHeight(),o=Math.min(l,c),d=dr(i[0],l),g=dr(i[1],c),m=dr(a[0],o/2),y=dr(a[1],o/2),x=-n.get("startAngle")*yj,A=n.get("minAngle")*yj,M=n.getData().tree.root,D=n.getViewRoot(),P=D.depth,O=n.get("sort");O!=null&&qJ(D,O);var z=0;fe(D.children,function(me){!isNaN(me.getValue())&&z++});var V=D.getValue(),H=Math.PI/(V||z)*2,$=D.depth>0,X=D.height-($?-1:1),W=(y-m)/(X||1),Y=n.get("clockwise"),J=n.get("stillShowZeroSum"),re=Y?1:-1,ae=function(me,Ie){if(me){var Le=Ie;if(me!==M){var Ee=me.getValue(),Ue=V===0&&J?H:Ee*H;Ue<A&&(Ue=A),Le=Ie+re*Ue;var Ke=me.depth-P-($?-1:1),We=m+W*Ke,Rt=m+W*(Ke+1),Et=n.getLevelModel(me);if(Et){var ar=Et.get("r0",!0),ur=Et.get("r",!0),cr=Et.get("radius",!0);cr!=null&&(ar=cr[0],ur=cr[1]),ar!=null&&(We=dr(ar,o/2)),ur!=null&&(Rt=dr(ur,o/2))}me.setLayout({angle:Ue,startAngle:Ie,endAngle:Le,clockwise:Y,cx:d,cy:g,r0:We,r:Rt})}if(me.children&&me.children.length){var lt=0;fe(me.children,function(qt){lt+=ae(qt,Ie+lt)})}return Le-Ie}};if($){var pe=m,de=m+W,ve=Math.PI*2;M.setLayout({angle:ve,startAngle:x,endAngle:x+ve,clockwise:Y,cx:d,cy:g,r0:pe,r:de})}ae(D,x)})}function qJ(t,e){var r=t.children||[];t.children=KRe(r,e),r.length&&fe(t.children,function(n){qJ(n,e)})}function KRe(t,e){if(zr(e)){var r=Zt(t,function(i,a){var l=i.getValue();return{params:{depth:i.depth,height:i.height,dataIndex:i.dataIndex,getValue:function(){return l}},index:a}});return r.sort(function(i,a){return e(i.params,a.params)}),Zt(r,function(i){return t[i.index]})}else{var n=e==="asc";return t.sort(function(i,a){var l=(i.getValue()-a.getValue())*(n?1:-1);return l===0?(i.dataIndex-a.dataIndex)*(n?-1:1):l})}}function JRe(t){var e={};function r(n,i,a){for(var l=n;l&&l.depth>1;)l=l.parentNode;var c=i.getColorFromPalette(l.name||l.dataIndex+"",e);return n.depth>1&&yr(c)&&(c=Ek(c,(n.depth-1)/(a-1)*.5)),c}t.eachSeriesByType("sunburst",function(n){var i=n.getData(),a=i.tree;a.eachNode(function(l){var c=l.getModel(),o=c.getModel("itemStyle").getItemStyle();o.fill||(o.fill=r(l,n,a.root.height));var d=i.ensureUniqueItemVisual(l.dataIndex,"style");Lt(d,o)})})}function eke(t){t.registerChartView(YRe),t.registerSeriesModel(XRe),t.registerLayout(on(QRe,"sunburst")),t.registerProcessor(on(Nb,"sunburst")),t.registerVisual(JRe),qRe(t)}var xj={color:"fill",borderColor:"stroke"},tke={symbol:1,symbolSize:1,symbolKeepAspect:1,legendIcon:1,visualMeta:1,liftZ:1,decal:1},lh=ri(),rke=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.optionUpdated=function(){this.currentZLevel=this.get("zlevel",!0),this.currentZ=this.get("z",!0)},e.prototype.getInitialData=function(r,n){return Mh(null,this)},e.prototype.getDataParams=function(r,n,i){var a=t.prototype.getDataParams.call(this,r,n);return i&&(a.info=lh(i).info),a},e.type="series.custom",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,clip:!1},e}(Wi);function nke(t,e){return e=e||[0,0],Zt(["x","y"],function(r,n){var i=this.getAxis(r),a=e[n],l=t[n]/2;return i.type==="category"?i.getBandWidth():Math.abs(i.dataToCoord(a-l)-i.dataToCoord(a+l))},this)}function ike(t){var e=t.master.getRect();return{coordSys:{type:"cartesian2d",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:function(r){return t.dataToPoint(r)},size:wr(nke,t)}}}function ake(t,e){return e=e||[0,0],Zt([0,1],function(r){var n=e[r],i=t[r]/2,a=[],l=[];return a[r]=n-i,l[r]=n+i,a[1-r]=l[1-r]=e[1-r],Math.abs(this.dataToPoint(a)[r]-this.dataToPoint(l)[r])},this)}function oke(t){var e=t.getBoundingRect();return{coordSys:{type:"geo",x:e.x,y:e.y,width:e.width,height:e.height,zoom:t.getZoom()},api:{coord:function(r){return t.dataToPoint(r)},size:wr(ake,t)}}}function ske(t,e){var r=this.getAxis(),n=e instanceof Array?e[0]:e,i=(t instanceof Array?t[0]:t)/2;return r.type==="category"?r.getBandWidth():Math.abs(r.dataToCoord(n-i)-r.dataToCoord(n+i))}function lke(t){var e=t.getRect();return{coordSys:{type:"singleAxis",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:function(r){return t.dataToPoint(r)},size:wr(ske,t)}}}function uke(t,e){return e=e||[0,0],Zt(["Radius","Angle"],function(r,n){var i="get"+r+"Axis",a=this[i](),l=e[n],c=t[n]/2,o=a.type==="category"?a.getBandWidth():Math.abs(a.dataToCoord(l-c)-a.dataToCoord(l+c));return r==="Angle"&&(o=o*Math.PI/180),o},this)}function cke(t){var e=t.getRadiusAxis(),r=t.getAngleAxis(),n=e.getExtent();return n[0]>n[1]&&n.reverse(),{coordSys:{type:"polar",cx:t.cx,cy:t.cy,r:n[1],r0:n[0]},api:{coord:function(i){var a=e.dataToRadius(i[0]),l=r.dataToAngle(i[1]),c=t.coordToPoint([a,l]);return c.push(a,l*Math.PI/180),c},size:wr(uke,t)}}}function hke(t){var e=t.getRect(),r=t.getRangeInfo();return{coordSys:{type:"calendar",x:e.x,y:e.y,width:e.width,height:e.height,cellWidth:t.getCellWidth(),cellHeight:t.getCellHeight(),rangeInfo:{start:r.start,end:r.end,weeks:r.weeks,dayCount:r.allDay}},api:{coord:function(n,i){return t.dataToPoint(n,i)}}}}function YJ(t,e,r,n){return t&&(t.legacy||t.legacy!==!1&&!r&&!n&&e!=="tspan"&&(e==="text"||Cr(t,"text")))}function XJ(t,e,r){var n=t,i,a,l;if(e==="text")l=n;else{l={},Cr(n,"text")&&(l.text=n.text),Cr(n,"rich")&&(l.rich=n.rich),Cr(n,"textFill")&&(l.fill=n.textFill),Cr(n,"textStroke")&&(l.stroke=n.textStroke),Cr(n,"fontFamily")&&(l.fontFamily=n.fontFamily),Cr(n,"fontSize")&&(l.fontSize=n.fontSize),Cr(n,"fontStyle")&&(l.fontStyle=n.fontStyle),Cr(n,"fontWeight")&&(l.fontWeight=n.fontWeight),a={type:"text",style:l,silent:!0},i={};var c=Cr(n,"textPosition");r?i.position=c?n.textPosition:"inside":c&&(i.position=n.textPosition),Cr(n,"textPosition")&&(i.position=n.textPosition),Cr(n,"textOffset")&&(i.offset=n.textOffset),Cr(n,"textRotation")&&(i.rotation=n.textRotation),Cr(n,"textDistance")&&(i.distance=n.textDistance)}return bj(l,t),fe(l.rich,function(o){bj(o,o)}),{textConfig:i,textContent:a}}function bj(t,e){e&&(e.font=e.textFont||e.font,Cr(e,"textStrokeWidth")&&(t.lineWidth=e.textStrokeWidth),Cr(e,"textAlign")&&(t.align=e.textAlign),Cr(e,"textVerticalAlign")&&(t.verticalAlign=e.textVerticalAlign),Cr(e,"textLineHeight")&&(t.lineHeight=e.textLineHeight),Cr(e,"textWidth")&&(t.width=e.textWidth),Cr(e,"textHeight")&&(t.height=e.textHeight),Cr(e,"textBackgroundColor")&&(t.backgroundColor=e.textBackgroundColor),Cr(e,"textPadding")&&(t.padding=e.textPadding),Cr(e,"textBorderColor")&&(t.borderColor=e.textBorderColor),Cr(e,"textBorderWidth")&&(t.borderWidth=e.textBorderWidth),Cr(e,"textBorderRadius")&&(t.borderRadius=e.textBorderRadius),Cr(e,"textBoxShadowColor")&&(t.shadowColor=e.textBoxShadowColor),Cr(e,"textBoxShadowBlur")&&(t.shadowBlur=e.textBoxShadowBlur),Cr(e,"textBoxShadowOffsetX")&&(t.shadowOffsetX=e.textBoxShadowOffsetX),Cr(e,"textBoxShadowOffsetY")&&(t.shadowOffsetY=e.textBoxShadowOffsetY))}function wj(t,e,r){var n=t;n.textPosition=n.textPosition||r.position||"inside",r.offset!=null&&(n.textOffset=r.offset),r.rotation!=null&&(n.textRotation=r.rotation),r.distance!=null&&(n.textDistance=r.distance);var i=n.textPosition.indexOf("inside")>=0,a=t.fill||"#000";Sj(n,e);var l=n.textFill==null;return i?l&&(n.textFill=r.insideFill||"#fff",!n.textStroke&&r.insideStroke&&(n.textStroke=r.insideStroke),!n.textStroke&&(n.textStroke=a),n.textStrokeWidth==null&&(n.textStrokeWidth=2)):(l&&(n.textFill=t.fill||r.outsideFill||"#000"),!n.textStroke&&r.outsideStroke&&(n.textStroke=r.outsideStroke)),n.text=e.text,n.rich=e.rich,fe(e.rich,function(c){Sj(c,c)}),n}function Sj(t,e){e&&(Cr(e,"fill")&&(t.textFill=e.fill),Cr(e,"stroke")&&(t.textStroke=e.fill),Cr(e,"lineWidth")&&(t.textStrokeWidth=e.lineWidth),Cr(e,"font")&&(t.font=e.font),Cr(e,"fontStyle")&&(t.fontStyle=e.fontStyle),Cr(e,"fontWeight")&&(t.fontWeight=e.fontWeight),Cr(e,"fontSize")&&(t.fontSize=e.fontSize),Cr(e,"fontFamily")&&(t.fontFamily=e.fontFamily),Cr(e,"align")&&(t.textAlign=e.align),Cr(e,"verticalAlign")&&(t.textVerticalAlign=e.verticalAlign),Cr(e,"lineHeight")&&(t.textLineHeight=e.lineHeight),Cr(e,"width")&&(t.textWidth=e.width),Cr(e,"height")&&(t.textHeight=e.height),Cr(e,"backgroundColor")&&(t.textBackgroundColor=e.backgroundColor),Cr(e,"padding")&&(t.textPadding=e.padding),Cr(e,"borderColor")&&(t.textBorderColor=e.borderColor),Cr(e,"borderWidth")&&(t.textBorderWidth=e.borderWidth),Cr(e,"borderRadius")&&(t.textBorderRadius=e.borderRadius),Cr(e,"shadowColor")&&(t.textBoxShadowColor=e.shadowColor),Cr(e,"shadowBlur")&&(t.textBoxShadowBlur=e.shadowBlur),Cr(e,"shadowOffsetX")&&(t.textBoxShadowOffsetX=e.shadowOffsetX),Cr(e,"shadowOffsetY")&&(t.textBoxShadowOffsetY=e.shadowOffsetY),Cr(e,"textShadowColor")&&(t.textShadowColor=e.textShadowColor),Cr(e,"textShadowBlur")&&(t.textShadowBlur=e.textShadowBlur),Cr(e,"textShadowOffsetX")&&(t.textShadowOffsetX=e.textShadowOffsetX),Cr(e,"textShadowOffsetY")&&(t.textShadowOffsetY=e.textShadowOffsetY))}var QJ={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]},Tj=Hn(QJ);cc(fc,function(t,e){return t[e]=1,t},{});fc.join(", ");var iM=["","style","shape","extra"],X_=ri();function JB(t,e,r,n,i){var a=t+"Animation",l=ly(t,n,i)||{},c=X_(e).userDuring;return l.duration>0&&(l.during=c?wr(vke,{el:e,userDuring:c}):null,l.setToFinal=!0,l.scope=t),Lt(l,r[a]),l}function QA(t,e,r,n){n=n||{};var i=n.dataIndex,a=n.isInit,l=n.clearStyle,c=r.isAnimationEnabled(),o=X_(t),d=e.style;o.userDuring=e.during;var g={},m={};if(_ke(t,e,m),Cj("shape",e,m),Cj("extra",e,m),!a&&c&&(mke(t,e,g),Aj("shape",t,e,g),Aj("extra",t,e,g),yke(t,e,d,g)),m.style=d,fke(t,m,l),pke(t,e),c)if(a){var y={};fe(iM,function(A){var M=A?e[A]:e;M&&M.enterFrom&&(A&&(y[A]=y[A]||{}),Lt(A?y[A]:y,M.enterFrom))});var x=JB("enter",t,e,r,i);x.duration>0&&t.animateFrom(y,x)}else dke(t,e,i||0,r,g);KJ(t,e),d?t.dirty():t.markRedraw()}function KJ(t,e){for(var r=X_(t).leaveToProps,n=0;n<iM.length;n++){var i=iM[n],a=i?e[i]:e;a&&a.leaveTo&&(r||(r=X_(t).leaveToProps={}),i&&(r[i]=r[i]||{}),Lt(i?r[i]:r,a.leaveTo))}}function OI(t,e,r,n){if(t){var i=t.parent,a=X_(t).leaveToProps;if(a){var l=JB("update",t,e,r,0);l.done=function(){i.remove(t)},t.animateTo(a,l)}else i.remove(t)}}function jg(t){return t==="all"}function fke(t,e,r){var n=e.style;if(!t.isGroup&&n){if(r){t.useStyle({});for(var i=t.animators,a=0;a<i.length;a++){var l=i[a];l.targetName==="style"&&l.changeTarget(t.style)}}t.setStyle(n)}e&&(e.style=null,e&&t.attr(e),e.style=n)}function dke(t,e,r,n,i){if(i){var a=JB("update",t,e,n,r);a.duration>0&&t.animateFrom(i,a)}}function pke(t,e){Cr(e,"silent")&&(t.silent=e.silent),Cr(e,"ignore")&&(t.ignore=e.ignore),t instanceof zl&&Cr(e,"invisible")&&(t.invisible=e.invisible),t instanceof kn&&Cr(e,"autoBatch")&&(t.autoBatch=e.autoBatch)}var Wu={},gke={setTransform:function(t,e){return Wu.el[t]=e,this},getTransform:function(t){return Wu.el[t]},setShape:function(t,e){var r=Wu.el,n=r.shape||(r.shape={});return n[t]=e,r.dirtyShape&&r.dirtyShape(),this},getShape:function(t){var e=Wu.el.shape;if(e)return e[t]},setStyle:function(t,e){var r=Wu.el,n=r.style;return n&&(n[t]=e,r.dirtyStyle&&r.dirtyStyle()),this},getStyle:function(t){var e=Wu.el.style;if(e)return e[t]},setExtra:function(t,e){var r=Wu.el.extra||(Wu.el.extra={});return r[t]=e,this},getExtra:function(t){var e=Wu.el.extra;if(e)return e[t]}};function vke(){var t=this,e=t.el;if(e){var r=X_(e).userDuring,n=t.userDuring;if(r!==n){t.el=t.userDuring=null;return}Wu.el=e,n(gke)}}function Aj(t,e,r,n){var i=r[t];if(i){var a=e[t],l;if(a){var c=r.transition,o=i.transition;if(o)if(!l&&(l=n[t]={}),jg(o))Lt(l,a);else for(var d=Pi(o),g=0;g<d.length;g++){var m=d[g],y=a[m];l[m]=y}else if(jg(c)||An(c,t)>=0){!l&&(l=n[t]={});for(var x=Hn(a),g=0;g<x.length;g++){var m=x[g],y=a[m];xke(i[m],y)&&(l[m]=y)}}}}}function Cj(t,e,r){var n=e[t];if(n)for(var i=r[t]={},a=Hn(n),l=0;l<a.length;l++){var c=a[l];i[c]=h1(n[c])}}function mke(t,e,r){for(var n=e.transition,i=jg(n)?fc:Pi(n||[]),a=0;a<i.length;a++){var l=i[a];if(!(l==="style"||l==="shape"||l==="extra")){var c=t[l];r[l]=c}}}function _ke(t,e,r){for(var n=0;n<Tj.length;n++){var i=Tj[n],a=QJ[i],l=e[i];l&&(r[a[0]]=l[0],r[a[1]]=l[1])}for(var n=0;n<fc.length;n++){var c=fc[n];e[c]!=null&&(r[c]=e[c])}}function yke(t,e,r,n){if(r){var i=t.style,a;if(i){var l=r.transition,c=e.transition;if(l&&!jg(l)){var o=Pi(l);!a&&(a=n.style={});for(var d=0;d<o.length;d++){var g=o[d],m=i[g];a[g]=m}}else if(t.getAnimationStyleProps&&(jg(c)||jg(l)||An(c,"style")>=0)){var y=t.getAnimationStyleProps(),x=y?y.style:null;if(x){!a&&(a=n.style={});for(var A=Hn(r),d=0;d<A.length;d++){var g=A[d];if(x[g]){var m=i[g];a[g]=m}}}}}}}function xke(t,e){return Vo(t)?t!==e:t!=null&&isFinite(t)}var JJ=ri(),bke=["percent","easing","shape","style","extra"];function eee(t){t.stopAnimation("keyframe"),t.attr(JJ(t))}function aM(t,e,r){if(!(!r.isAnimationEnabled()||!e)){if(Ht(e)){fe(e,function(c){aM(t,c,r)});return}var n=e.keyframes,i=e.duration;if(r&&i==null){var a=ly("enter",r,0);i=a&&a.duration}if(!(!n||!i)){var l=JJ(t);fe(iM,function(c){if(!(c&&!t[c])){var o;n.sort(function(d,g){return d.percent-g.percent}),fe(n,function(d){var g=t.animators,m=c?d[c]:d;if(m){var y=Hn(m);if(c||(y=Ei(y,function(M){return An(bke,M)<0})),!!y.length){o||(o=t.animate(c,e.loop,!0),o.scope="keyframe");for(var x=0;x<g.length;x++)g[x]!==o&&g[x].targetName===o.targetName&&g[x].stopTracks(y);c&&(l[c]=l[c]||{});var A=c?l[c]:l;fe(y,function(M){A[M]=((c?t[c]:t)||{})[M]}),o.whenWithKeys(i*d.percent,m,y,d.easing)}}}),o&&o.delay(e.delay||0).duration(i).start(e.easing)}})}}}var uh="emphasis",rd="normal",e5="blur",t5="select",bd=[rd,uh,e5,t5],uR={normal:["itemStyle"],emphasis:[uh,"itemStyle"],blur:[e5,"itemStyle"],select:[t5,"itemStyle"]},cR={normal:["label"],emphasis:[uh,"label"],blur:[e5,"label"],select:[t5,"label"]},wke=["x","y"],Ske="e\0\0",ml={normal:{},emphasis:{},blur:{},select:{}},Tke={cartesian2d:ike,geo:oke,single:lke,polar:cke,calendar:hke};function GO(t){return t instanceof kn}function UO(t){return t instanceof zl}function Ake(t,e){e.copyTransform(t),UO(e)&&UO(t)&&(e.setStyle(t.style),e.z=t.z,e.z2=t.z2,e.zlevel=t.zlevel,e.invisible=t.invisible,e.ignore=t.ignore,GO(e)&&GO(t)&&e.setShape(t.shape))}var Cke=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i,a){this._progressiveEls=null;var l=this._data,c=r.getData(),o=this.group,d=Mj(r,c,n,i);l||o.removeAll(),c.diff(l).add(function(m){hR(i,null,m,d(m,a),r,o,c)}).remove(function(m){var y=l.getItemGraphicEl(m);y&&OI(y,lh(y).option,r)}).update(function(m,y){var x=l.getItemGraphicEl(y);hR(i,x,m,d(m,a),r,o,c)}).execute();var g=r.get("clip",!0)?Bb(r.coordinateSystem,!1,r):null;g?o.setClipPath(g):o.removeClipPath(),this._data=c},e.prototype.incrementalPrepareRender=function(r,n,i){this.group.removeAll(),this._data=null},e.prototype.incrementalRender=function(r,n,i,a,l){var c=n.getData(),o=Mj(n,c,i,a),d=this._progressiveEls=[];function g(x){x.isGroup||(x.incremental=!0,x.ensureState("emphasis").hoverLayer=!0)}for(var m=r.start;m<r.end;m++){var y=hR(null,null,m,o(m,l),n,this.group,c);y&&(y.traverse(g),d.push(y))}},e.prototype.eachRendered=function(r){Id(this._progressiveEls||this.group,r)},e.prototype.filterForExposedEvent=function(r,n,i,a){var l=n.element;if(l==null||i.name===l)return!0;for(;(i=i.__hostTarget||i.parent)&&i!==this.group;)if(i.name===l)return!0;return!1},e.type="custom",e}(Oi);function r5(t){var e=t.type,r;if(e==="path"){var n=t.shape,i=n.width!=null&&n.height!=null?{x:n.x||0,y:n.y||0,width:n.width,height:n.height}:null,a=nee(n);r=fI(a,null,i,n.layout||"center"),lh(r).customPathData=a}else if(e==="image")r=new fo({}),lh(r).customImagePath=t.style.image;else if(e==="text")r=new ti({});else if(e==="group")r=new jr;else{if(e==="compoundPath")throw new Error('"compoundPath" is not supported yet.');var l=Hz(e);if(!l){var c="";vi(c)}r=new l}return lh(r).customGraphicType=e,r.name=t.name,r.z2EmphasisLift=1,r.z2SelectLift=1,r}function n5(t,e,r,n,i,a,l){eee(e);var c=i&&i.normal.cfg;c&&e.setTextConfig(c),n&&n.transition==null&&(n.transition=wke);var o=n&&n.style;if(o){if(e.type==="text"){var d=o;Cr(d,"textFill")&&(d.fill=d.textFill),Cr(d,"textStroke")&&(d.stroke=d.textStroke)}var g=void 0,m=GO(e)?o.decal:null;t&&m&&(m.dirty=!0,g=j_(m,t)),o.__decalPattern=g}if(UO(e)&&o){var g=o.__decalPattern;g&&(o.decal=g)}QA(e,n,a,{dataIndex:r,isInit:l,clearStyle:!0}),aM(e,n.keyframeAnimation,a)}function tee(t,e,r,n,i){var a=e.isGroup?null:e,l=i&&i[t].cfg;if(a){var c=a.ensureState(t);if(n===!1){var o=a.getState(t);o&&(o.style=null)}else c.style=n||null;l&&(c.textConfig=l),rv(a)}}function Mke(t,e,r){if(!t.isGroup){var n=t,i=r.currentZ,a=r.currentZLevel;n.z=i,n.zlevel=a;var l=e.z2;l!=null&&(n.z2=l||0);for(var c=0;c<bd.length;c++)Ike(n,e,bd[c])}}function Ike(t,e,r){var n=r===rd,i=n?e:oM(e,r),a=i?i.z2:null,l;a!=null&&(l=n?t:t.ensureState(r),l.z2=a||0)}function Mj(t,e,r,n){var i=t.get("renderItem"),a=t.coordinateSystem,l={};a&&(l=a.prepareCustoms?a.prepareCustoms(a):Tke[a.type](a));for(var c=Fr({getWidth:n.getWidth,getHeight:n.getHeight,getZr:n.getZr,getDevicePixelRatio:n.getDevicePixelRatio,value:V,style:$,ordinalRawValue:H,styleEmphasis:X,visual:J,barLayout:re,currentSeriesIndices:ae,font:pe},l.api||{}),o={context:{},seriesId:t.id,seriesName:t.name,seriesIndex:t.seriesIndex,coordSys:l.coordSys,dataInsideLength:e.count(),encode:Eke(t.getData())},d,g,m={},y={},x={},A={},M=0;M<bd.length;M++){var D=bd[M];x[D]=t.getModel(uR[D]),A[D]=t.getModel(cR[D])}function P(de){return de===d?g||(g=e.getItemModel(de)):e.getItemModel(de)}function O(de,ve){return e.hasItemOption?de===d?m[ve]||(m[ve]=P(de).getModel(uR[ve])):P(de).getModel(uR[ve]):x[ve]}function z(de,ve){return e.hasItemOption?de===d?y[ve]||(y[ve]=P(de).getModel(cR[ve])):P(de).getModel(cR[ve]):A[ve]}return function(de,ve){return d=de,g=null,m={},y={},i&&i(Fr({dataIndexInside:de,dataIndex:e.getRawIndex(de),actionType:ve?ve.type:null},o),c)};function V(de,ve){return ve==null&&(ve=d),e.getStore().get(e.getDimensionIndex(de||0),ve)}function H(de,ve){ve==null&&(ve=d),de=de||0;var me=e.getDimensionInfo(de);if(!me){var Ie=e.getDimensionIndex(de);return Ie>=0?e.getStore().get(Ie,ve):void 0}var Le=e.get(me.name,ve),Ee=me&&me.ordinalMeta;return Ee?Ee.categories[Le]:Le}function $(de,ve){ve==null&&(ve=d);var me=e.getItemVisual(ve,"style"),Ie=me&&me.fill,Le=me&&me.opacity,Ee=O(ve,rd).getItemStyle();Ie!=null&&(Ee.fill=Ie),Le!=null&&(Ee.opacity=Le);var Ue={inheritColor:yr(Ie)?Ie:"#000"},Ke=z(ve,rd),We=Hi(Ke,null,Ue,!1,!0);We.text=Ke.getShallow("show")?tn(t.getFormattedLabel(ve,rd),Z_(e,ve)):null;var Rt=zC(Ke,Ue,!1);return Y(de,Ee),Ee=wj(Ee,We,Rt),de&&W(Ee,de),Ee.legacy=!0,Ee}function X(de,ve){ve==null&&(ve=d);var me=O(ve,uh).getItemStyle(),Ie=z(ve,uh),Le=Hi(Ie,null,null,!0,!0);Le.text=Ie.getShallow("show")?ac(t.getFormattedLabel(ve,uh),t.getFormattedLabel(ve,rd),Z_(e,ve)):null;var Ee=zC(Ie,null,!0);return Y(de,me),me=wj(me,Le,Ee),de&&W(me,de),me.legacy=!0,me}function W(de,ve){for(var me in ve)Cr(ve,me)&&(de[me]=ve[me])}function Y(de,ve){de&&(de.textFill&&(ve.textFill=de.textFill),de.textPosition&&(ve.textPosition=de.textPosition))}function J(de,ve){if(ve==null&&(ve=d),Cr(xj,de)){var me=e.getItemVisual(ve,"style");return me?me[xj[de]]:null}if(Cr(tke,de))return e.getItemVisual(ve,de)}function re(de){if(a.type==="cartesian2d"){var ve=a.getBaseAxis();return _Ae(Fr({axis:ve},de))}}function ae(){return r.getCurrentSeriesIndices()}function pe(de){return jz(de,r)}}function Eke(t){var e={};return fe(t.dimensions,function(r){var n=t.getDimensionInfo(r);if(!n.isExtraCoord){var i=n.coordDim,a=e[i]=e[i]||[];a[n.coordDimIndex]=t.getDimensionIndex(r)}}),e}function hR(t,e,r,n,i,a,l){if(!n){a.remove(e);return}var c=i5(t,e,r,n,i,a);return c&&l.setItemGraphicEl(r,c),c&&da(c,n.focus,n.blurScope,n.emphasisDisabled),c}function i5(t,e,r,n,i,a){var l=-1,c=e;e&&ree(e,n,i)&&(l=An(a.childrenRef(),e),e=null);var o=!e,d=e;d?d.clearStates():(d=r5(n),c&&Ake(c,d)),n.morph===!1?d.disableMorphing=!0:d.disableMorphing&&(d.disableMorphing=!1),ml.normal.cfg=ml.normal.conOpt=ml.emphasis.cfg=ml.emphasis.conOpt=ml.blur.cfg=ml.blur.conOpt=ml.select.cfg=ml.select.conOpt=null,ml.isLegacy=!1,Pke(d,r,n,i,o,ml),Dke(d,r,n,i,o),n5(t,d,r,n,ml,i,o),Cr(n,"info")&&(lh(d).info=n.info);for(var g=0;g<bd.length;g++){var m=bd[g];if(m!==rd){var y=oM(n,m),x=a5(n,y,m);tee(m,d,y,x,ml)}}return Mke(d,n,i),n.type==="group"&&Lke(t,d,r,n,i),l>=0?a.replaceAt(d,l):a.add(d),d}function ree(t,e,r){var n=lh(t),i=e.type,a=e.shape,l=e.style;return r.isUniversalTransitionEnabled()||i!=null&&i!==n.customGraphicType||i==="path"&&zke(a)&&nee(a)!==n.customPathData||i==="image"&&Cr(l,"image")&&l.image!==n.customImagePath}function Dke(t,e,r,n,i){var a=r.clipPath;if(a===!1)t&&t.getClipPath()&&t.removeClipPath();else if(a){var l=t.getClipPath();l&&ree(l,a,n)&&(l=null),l||(l=r5(a),t.setClipPath(l)),n5(null,l,e,a,null,n,i)}}function Pke(t,e,r,n,i,a){if(!t.isGroup){Ij(r,null,a),Ij(r,uh,a);var l=a.normal.conOpt,c=a.emphasis.conOpt,o=a.blur.conOpt,d=a.select.conOpt;if(l!=null||c!=null||d!=null||o!=null){var g=t.getTextContent();if(l===!1)g&&t.removeTextContent();else{l=a.normal.conOpt=l||{type:"text"},g?g.clearStates():(g=r5(l),t.setTextContent(g)),n5(null,g,e,l,null,n,i);for(var m=l&&l.style,y=0;y<bd.length;y++){var x=bd[y];if(x!==rd){var A=a[x].conOpt;tee(x,g,A,a5(l,A,x),null)}}m?g.dirty():g.markRedraw()}}}}function Ij(t,e,r){var n=e?oM(t,e):t,i=e?a5(t,n,uh):t.style,a=t.type,l=n?n.textConfig:null,c=t.textContent,o=c?e?oM(c,e):c:null;if(i&&(r.isLegacy||YJ(i,a,!!l,!!o))){r.isLegacy=!0;var d=XJ(i,a,!e);!l&&d.textConfig&&(l=d.textConfig),!o&&d.textContent&&(o=d.textContent)}if(!e&&o){var g=o;!g.type&&(g.type="text")}var m=e?r[e]:r.normal;m.cfg=l,m.conOpt=o}function oM(t,e){return e?t?t[e]:null:t}function a5(t,e,r){var n=e&&e.style;return n==null&&r===uh&&t&&(n=t.styleEmphasis),n}function Lke(t,e,r,n,i){var a=n.children,l=a?a.length:0,c=n.$mergeChildren,o=c==="byName"||n.diffChildrenByName,d=c===!1;if(!(!l&&!o&&!d)){if(o){kke({api:t,oldChildren:e.children()||[],newChildren:a||[],dataIndex:r,seriesModel:i,group:e});return}d&&e.removeAll();for(var g=0;g<l;g++){var m=a[g],y=e.childAt(g);m?(m.ignore==null&&(m.ignore=!1),i5(t,y,r,m,i,e)):y.ignore=!0}for(var x=e.childCount()-1;x>=g;x--){var A=e.childAt(x);Rke(e,A,i)}}}function Rke(t,e,r){e&&OI(e,lh(t).option,r)}function kke(t){new mh(t.oldChildren,t.newChildren,Ej,Ej,t).add(Dj).update(Dj).remove(Oke).execute()}function Ej(t,e){var r=t&&t.name;return r??Ske+e}function Dj(t,e){var r=this.context,n=t!=null?r.newChildren[t]:null,i=e!=null?r.oldChildren[e]:null;i5(r.api,i,r.dataIndex,n,r.seriesModel,r.group)}function Oke(t){var e=this.context,r=e.oldChildren[t];r&&OI(r,lh(r).option,e.seriesModel)}function nee(t){return t&&(t.pathData||t.d)}function zke(t){return t&&(Cr(t,"pathData")||Cr(t,"d"))}function Bke(t){t.registerChartView(Cke),t.registerSeriesModel(rke)}var yg=ri(),Pj=$r,fR=wr,o5=function(){function t(){this._dragging=!1,this.animationThreshold=15}return t.prototype.render=function(e,r,n,i){var a=r.get("value"),l=r.get("status");if(this._axisModel=e,this._axisPointerModel=r,this._api=n,!(!i&&this._lastValue===a&&this._lastStatus===l)){this._lastValue=a,this._lastStatus=l;var c=this._group,o=this._handle;if(!l||l==="hide"){c&&c.hide(),o&&o.hide();return}c&&c.show(),o&&o.show();var d={};this.makeElOption(d,a,e,r,n);var g=d.graphicKey;g!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=g;var m=this._moveAnimation=this.determineAnimation(e,r);if(!c)c=this._group=new jr,this.createPointerEl(c,d,e,r),this.createLabelEl(c,d,e,r),n.getZr().add(c);else{var y=on(Lj,r,m);this.updatePointerEl(c,d,y),this.updateLabelEl(c,d,y,r)}kj(c,r,!0),this._renderHandle(a)}},t.prototype.remove=function(e){this.clear(e)},t.prototype.dispose=function(e){this.clear(e)},t.prototype.determineAnimation=function(e,r){var n=r.get("animation"),i=e.axis,a=i.type==="category",l=r.get("snap");if(!l&&!a)return!1;if(n==="auto"||n==null){var c=this.animationThreshold;if(a&&i.getBandWidth()>c)return!0;if(l){var o=DB(e).seriesDataCount,d=i.getExtent();return Math.abs(d[0]-d[1])/o>c}return!1}return n===!0},t.prototype.makeElOption=function(e,r,n,i,a){},t.prototype.createPointerEl=function(e,r,n,i){var a=r.pointer;if(a){var l=yg(e).pointerEl=new fv[a.type](Pj(r.pointer));e.add(l)}},t.prototype.createLabelEl=function(e,r,n,i){if(r.label){var a=yg(e).labelEl=new ti(Pj(r.label));e.add(a),Rj(a,i)}},t.prototype.updatePointerEl=function(e,r,n){var i=yg(e).pointerEl;i&&r.pointer&&(i.setStyle(r.pointer.style),n(i,{shape:r.pointer.shape}))},t.prototype.updateLabelEl=function(e,r,n,i){var a=yg(e).labelEl;a&&(a.setStyle(r.label.style),n(a,{x:r.label.x,y:r.label.y}),Rj(a,i))},t.prototype._renderHandle=function(e){if(!(this._dragging||!this.updateHandleTransform)){var r=this._axisPointerModel,n=this._api.getZr(),i=this._handle,a=r.getModel("handle"),l=r.get("status");if(!a.get("show")||!l||l==="hide"){i&&n.remove(i),this._handle=null;return}var c;this._handle||(c=!0,i=this._handle=Eb(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(d){dh(d.event)},onmousedown:fR(this._onHandleDragMove,this,0,0),drift:fR(this._onHandleDragMove,this),ondragend:fR(this._onHandleDragEnd,this)}),n.add(i)),kj(i,r,!1),i.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var o=a.get("size");Ht(o)||(o=[o,o]),i.scaleX=o[0]/2,i.scaleY=o[1]/2,vy(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,c)}},t.prototype._moveHandleToValue=function(e,r){Lj(this._axisPointerModel,!r&&this._moveAnimation,this._handle,dR(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},t.prototype._onHandleDragMove=function(e,r){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(dR(n),[e,r],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(dR(i)),yg(n).lastProp=null,this._doDispatchAxisPointer()}},t.prototype._doDispatchAxisPointer=function(){var e=this._handle;if(e){var r=this._payloadInfo,n=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:r.cursorPoint[0],y:r.cursorPoint[1],tooltipOption:r.tooltipOption,axesInfo:[{axisDim:n.axis.dim,axisIndex:n.componentIndex}]})}},t.prototype._onHandleDragEnd=function(){this._dragging=!1;var e=this._handle;if(e){var r=this._axisPointerModel.get("value");this._moveHandleToValue(r),this._api.dispatchAction({type:"hideTip"})}},t.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var r=e.getZr(),n=this._group,i=this._handle;r&&n&&(this._lastGraphicKey=null,n&&r.remove(n),i&&r.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),X1(this,"_doDispatchAxisPointer")},t.prototype.doClear=function(){},t.prototype.buildLabel=function(e,r,n){return n=n||0,{x:e[n],y:e[1-n],width:r[n],height:r[1-n]}},t}();function Lj(t,e,r,n){iee(yg(r).lastProp,n)||(yg(r).lastProp=n,e?li(r,n,t):(r.stopAnimation(),r.attr(n)))}function iee(t,e){if(Ur(t)&&Ur(e)){var r=!0;return fe(e,function(n,i){r=r&&iee(t[i],n)}),!!r}else return t===e}function Rj(t,e){t[e.get(["label","show"])?"show":"hide"]()}function dR(t){return{x:t.x||0,y:t.y||0,rotation:t.rotation||0}}function kj(t,e,r){var n=e.get("z"),i=e.get("zlevel");t&&t.traverse(function(a){a.type!=="group"&&(n!=null&&(a.z=n),i!=null&&(a.zlevel=i),a.silent=r)})}function s5(t){var e=t.get("type"),r=t.getModel(e+"Style"),n;return e==="line"?(n=r.getLineStyle(),n.fill=null):e==="shadow"&&(n=r.getAreaStyle(),n.stroke=null),n}function aee(t,e,r,n,i){var a=r.get("value"),l=oee(a,e.axis,e.ecModel,r.get("seriesDataIndices"),{precision:r.get(["label","precision"]),formatter:r.get(["label","formatter"])}),c=r.getModel("label"),o=fy(c.get("padding")||0),d=c.getFont(),g=Sb(l,d),m=i.position,y=g.width+o[1]+o[3],x=g.height+o[0]+o[2],A=i.align;A==="right"&&(m[0]-=y),A==="center"&&(m[0]-=y/2);var M=i.verticalAlign;M==="bottom"&&(m[1]-=x),M==="middle"&&(m[1]-=x/2),Fke(m,y,x,n);var D=c.get("backgroundColor");(!D||D==="auto")&&(D=e.get(["axisLine","lineStyle","color"])),t.label={x:m[0],y:m[1],style:Hi(c,{text:l,font:d,fill:c.getTextColor(),padding:o,backgroundColor:D}),z2:10}}function Fke(t,e,r,n){var i=n.getWidth(),a=n.getHeight();t[0]=Math.min(t[0]+e,i)-e,t[1]=Math.min(t[1]+r,a)-r,t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0)}function oee(t,e,r,n,i){t=e.scale.parse(t);var a=e.scale.getLabel({value:t},{precision:i.precision}),l=i.formatter;if(l){var c={value:yB(e,{value:t}),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};fe(n,function(o){var d=r.getSeriesByIndex(o.seriesIndex),g=o.dataIndexInside,m=d&&d.getDataParams(g);m&&c.seriesData.push(m)}),yr(l)?a=l.replace("{value}",a):zr(l)&&(a=l(c))}return a}function l5(t,e,r){var n=Qs();return hv(n,n,r.rotation),hc(n,n,r.position),vu([t.dataToCoord(e),(r.labelOffset||0)+(r.labelDirection||1)*(r.labelMargin||0)],n)}function see(t,e,r,n,i,a){var l=rs.innerTextLayout(r.rotation,0,r.labelDirection);r.labelMargin=i.get(["label","margin"]),aee(e,n,i,a,{position:l5(n.axis,t,r),align:l.textAlign,verticalAlign:l.textVerticalAlign})}function u5(t,e,r){return r=r||0,{x1:t[r],y1:t[1-r],x2:e[r],y2:e[1-r]}}function lee(t,e,r){return r=r||0,{x:t[r],y:t[1-r],width:e[r],height:e[1-r]}}function Oj(t,e,r,n,i,a){return{cx:t,cy:e,r0:r,r:n,startAngle:i,endAngle:a,clockwise:!0}}var Nke=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.makeElOption=function(r,n,i,a,l){var c=i.axis,o=c.grid,d=a.get("type"),g=zj(o,c).getOtherAxis(c).getGlobalExtent(),m=c.toGlobalCoord(c.dataToCoord(n,!0));if(d&&d!=="none"){var y=s5(a),x=Vke[d](c,m,g);x.style=y,r.graphicKey=x.type,r.pointer=x}var A=SO(o.model,i);see(n,r,A,i,a,l)},e.prototype.getHandleTransform=function(r,n,i){var a=SO(n.axis.grid.model,n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var l=l5(n.axis,r,a);return{x:l[0],y:l[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(r,n,i,a){var l=i.axis,c=l.grid,o=l.getGlobalExtent(!0),d=zj(c,l).getOtherAxis(l).getGlobalExtent(),g=l.dim==="x"?0:1,m=[r.x,r.y];m[g]+=n[g],m[g]=Math.min(o[1],m[g]),m[g]=Math.max(o[0],m[g]);var y=(d[1]+d[0])/2,x=[y,y];x[g]=m[g];var A=[{verticalAlign:"middle"},{align:"center"}];return{x:m[0],y:m[1],rotation:r.rotation,cursorPoint:x,tooltipOption:A[g]}},e}(o5);function zj(t,e){var r={};return r[e.dim+"AxisIndex"]=e.index,t.getCartesian(r)}var Vke={line:function(t,e,r){var n=u5([e,r[0]],[e,r[1]],Bj(t));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(t,e,r){var n=Math.max(1,t.getBandWidth()),i=r[1]-r[0];return{type:"Rect",shape:lee([e-n/2,r[0]],[n,i],Bj(t))}}};function Bj(t){return t.dim==="x"?0:1}var Gke=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="axisPointer",e.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},e}($n),rh=ri(),Uke=fe;function uee(t,e,r){if(!Nn.node){var n=e.getZr();rh(n).records||(rh(n).records={}),$ke(n,e);var i=rh(n).records[t]||(rh(n).records[t]={});i.handler=r}}function $ke(t,e){if(rh(t).initialized)return;rh(t).initialized=!0,r("click",on(Fj,"click")),r("mousemove",on(Fj,"mousemove")),r("globalout",jke);function r(n,i){t.on(n,function(a){var l=Wke(e);Uke(rh(t).records,function(c){c&&i(c,a,l.dispatchAction)}),Hke(l.pendings,e)})}}function Hke(t,e){var r=t.showTip.length,n=t.hideTip.length,i;r?i=t.showTip[r-1]:n&&(i=t.hideTip[n-1]),i&&(i.dispatchAction=null,e.dispatchAction(i))}function jke(t,e,r){t.handler("leave",null,r)}function Fj(t,e,r,n){e.handler(t,r,n)}function Wke(t){var e={showTip:[],hideTip:[]},r=function(n){var i=e[n.type];i?i.push(n):(n.dispatchAction=r,t.dispatchAction(n))};return{dispatchAction:r,pendings:e}}function $O(t,e){if(!Nn.node){var r=e.getZr(),n=(rh(r).records||{})[t];n&&(rh(r).records[t]=null)}}var Zke=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=n.getComponent("tooltip"),l=r.get("triggerOn")||a&&a.get("triggerOn")||"mousemove|click";uee("axisPointer",i,function(c,o,d){l!=="none"&&(c==="leave"||l.indexOf(c)>=0)&&d({type:"updateAxisPointer",currTrigger:c,x:o&&o.offsetX,y:o&&o.offsetY})})},e.prototype.remove=function(r,n){$O("axisPointer",n)},e.prototype.dispose=function(r,n){$O("axisPointer",n)},e.type="axisPointer",e}(ra);function cee(t,e){var r=[],n=t.seriesIndex,i;if(n==null||!(i=e.getSeriesByIndex(n)))return{point:[]};var a=i.getData(),l=ev(a,t);if(l==null||l<0||Ht(l))return{point:[]};var c=a.getItemGraphicEl(l),o=i.coordinateSystem;if(i.getTooltipPosition)r=i.getTooltipPosition(l)||[];else if(o&&o.dataToPoint)if(t.isStacked){var d=o.getBaseAxis(),g=o.getOtherAxis(d),m=g.dim,y=d.dim,x=m==="x"||m==="radius"?1:0,A=a.mapDimension(y),M=[];M[x]=a.get(A,l),M[1-x]=a.get(a.getCalculationInfo("stackResultDimension"),l),r=o.dataToPoint(M)||[]}else r=o.dataToPoint(a.getValues(Zt(o.dimensions,function(P){return a.mapDimension(P)}),l))||[];else if(c){var D=c.getBoundingRect().clone();D.applyTransform(c.transform),r=[D.x+D.width/2,D.y+D.height/2]}return{point:r,el:c}}var Nj=ri();function qke(t,e,r){var n=t.currTrigger,i=[t.x,t.y],a=t,l=t.dispatchAction||wr(r.dispatchAction,r),c=e.getComponent("axisPointer").coordSysAxesInfo;if(c){KA(i)&&(i=cee({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},e).point);var o=KA(i),d=a.axesInfo,g=c.axesInfo,m=n==="leave"||KA(i),y={},x={},A={list:[],map:{}},M={showPointer:on(Xke,x),showTooltip:on(Qke,A)};fe(c.coordSysMap,function(P,O){var z=o||P.containPoint(i);fe(c.coordSysAxesInfo[O],function(V,H){var $=V.axis,X=tOe(d,V);if(!m&&z&&(!d||X)){var W=X&&X.value;W==null&&!o&&(W=$.pointToData(i)),W!=null&&Vj(V,W,M,!1,y)}})});var D={};return fe(g,function(P,O){var z=P.linkGroup;z&&!x[O]&&fe(z.axesInfo,function(V,H){var $=x[H];if(V!==P&&$){var X=$.value;z.mapper&&(X=P.axis.scale.parse(z.mapper(X,Gj(V),Gj(P)))),D[P.key]=X}})}),fe(D,function(P,O){Vj(g[O],P,M,!0,y)}),Kke(x,g,y),Jke(A,i,t,l),eOe(g,l,r),y}}function Vj(t,e,r,n,i){var a=t.axis;if(!(a.scale.isBlank()||!a.containData(e))){if(!t.involveSeries){r.showPointer(t,e);return}var l=Yke(e,t),c=l.payloadBatch,o=l.snapToValue;c[0]&&i.seriesIndex==null&&Lt(i,c[0]),!n&&t.snap&&a.containData(o)&&o!=null&&(e=o),r.showPointer(t,e,c),r.showTooltip(t,l,o)}}function Yke(t,e){var r=e.axis,n=r.dim,i=t,a=[],l=Number.MAX_VALUE,c=-1;return fe(e.seriesModels,function(o,d){var g=o.getData().mapDimensionsAll(n),m,y;if(o.getAxisTooltipData){var x=o.getAxisTooltipData(g,t,r);y=x.dataIndices,m=x.nestestValue}else{if(y=o.getData().indicesOfNearest(g[0],t,r.type==="category"?.5:null),!y.length)return;m=o.getData().get(g[0],y[0])}if(!(m==null||!isFinite(m))){var A=t-m,M=Math.abs(A);M<=l&&((M<l||A>=0&&c<0)&&(l=M,c=A,i=m,a.length=0),fe(y,function(D){a.push({seriesIndex:o.seriesIndex,dataIndexInside:D,dataIndex:o.getData().getRawIndex(D)})}))}}),{payloadBatch:a,snapToValue:i}}function Xke(t,e,r,n){t[e.key]={value:r,payloadBatch:n}}function Qke(t,e,r,n){var i=r.payloadBatch,a=e.axis,l=a.model,c=e.axisPointerModel;if(!(!e.triggerTooltip||!i.length)){var o=e.coordSys.model,d=nb(o),g=t.map[d];g||(g=t.map[d]={coordSysId:o.id,coordSysIndex:o.componentIndex,coordSysType:o.type,coordSysMainType:o.mainType,dataByAxis:[]},t.list.push(g)),g.dataByAxis.push({axisDim:a.dim,axisIndex:l.componentIndex,axisType:l.type,axisId:l.id,value:n,valueLabelOpt:{precision:c.get(["label","precision"]),formatter:c.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function Kke(t,e,r){var n=r.axesInfo=[];fe(e,function(i,a){var l=i.axisPointerModel.option,c=t[a];c?(!i.useHandle&&(l.status="show"),l.value=c.value,l.seriesDataIndices=(c.payloadBatch||[]).slice()):!i.useHandle&&(l.status="hide"),l.status==="show"&&n.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:l.value})})}function Jke(t,e,r,n){if(KA(e)||!t.list.length){n({type:"hideTip"});return}var i=((t.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:r.tooltipOption,position:r.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:t.list})}function eOe(t,e,r){var n=r.getZr(),i="axisPointerLastHighlights",a=Nj(n)[i]||{},l=Nj(n)[i]={};fe(t,function(d,g){var m=d.axisPointerModel.option;m.status==="show"&&d.triggerEmphasis&&fe(m.seriesDataIndices,function(y){var x=y.seriesIndex+" | "+y.dataIndex;l[x]=y})});var c=[],o=[];fe(a,function(d,g){!l[g]&&o.push(d)}),fe(l,function(d,g){!a[g]&&c.push(d)}),o.length&&r.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:o}),c.length&&r.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:c})}function tOe(t,e){for(var r=0;r<(t||[]).length;r++){var n=t[r];if(e.axis.dim===n.axisDim&&e.axis.model.componentIndex===n.axisIndex)return n}}function Gj(t){var e=t.axis.model,r={},n=r.axisDim=t.axis.dim;return r.axisIndex=r[n+"AxisIndex"]=e.componentIndex,r.axisName=r[n+"AxisName"]=e.name,r.axisId=r[n+"AxisId"]=e.id,r}function KA(t){return!t||t[0]==null||isNaN(t[0])||t[1]==null||isNaN(t[1])}function $b(t){vv.registerAxisPointerClass("CartesianAxisPointer",Nke),t.registerComponentModel(Gke),t.registerComponentView(Zke),t.registerPreprocessor(function(e){if(e){(!e.axisPointer||e.axisPointer.length===0)&&(e.axisPointer={});var r=e.axisPointer.link;r&&!Ht(r)&&(e.axisPointer.link=[r])}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,function(e,r){e.getComponent("axisPointer").coordSysAxesInfo=hIe(e,r)}),t.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},qke)}function rOe(t){En(BK),En($b)}var nOe=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.makeElOption=function(r,n,i,a,l){var c=i.axis;c.dim==="angle"&&(this.animationThreshold=Math.PI/18);var o=c.polar,d=o.getOtherAxis(c),g=d.getExtent(),m=c.dataToCoord(n),y=a.get("type");if(y&&y!=="none"){var x=s5(a),A=aOe[y](c,o,m,g);A.style=x,r.graphicKey=A.type,r.pointer=A}var M=a.get(["label","margin"]),D=iOe(n,i,a,o,M);aee(r,i,a,l,D)},e}(o5);function iOe(t,e,r,n,i){var a=e.axis,l=a.dataToCoord(t),c=n.getAngleAxis().getExtent()[0];c=c/180*Math.PI;var o=n.getRadiusAxis().getExtent(),d,g,m;if(a.dim==="radius"){var y=Qs();hv(y,y,c),hc(y,y,[n.cx,n.cy]),d=vu([l,-i],y);var x=e.getModel("axisLabel").get("rotate")||0,A=rs.innerTextLayout(c,x*Math.PI/180,-1);g=A.textAlign,m=A.textVerticalAlign}else{var M=o[1];d=n.coordToPoint([M+i,l]);var D=n.cx,P=n.cy;g=Math.abs(d[0]-D)/M<.3?"center":d[0]>D?"left":"right",m=Math.abs(d[1]-P)/M<.3?"middle":d[1]>P?"top":"bottom"}return{position:d,align:g,verticalAlign:m}}var aOe={line:function(t,e,r,n){return t.dim==="angle"?{type:"Line",shape:u5(e.coordToPoint([n[0],r]),e.coordToPoint([n[1],r]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r}}},shadow:function(t,e,r,n){var i=Math.max(1,t.getBandWidth()),a=Math.PI/180;return t.dim==="angle"?{type:"Sector",shape:Oj(e.cx,e.cy,n[0],n[1],(-r-i/2)*a,(-r+i/2)*a)}:{type:"Sector",shape:Oj(e.cx,e.cy,r-i/2,r+i/2,0,Math.PI*2)}}},oOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.findAxisModel=function(r){var n,i=this.ecModel;return i.eachComponent(r,function(a){a.getCoordSysModel()===this&&(n=a)},this),n},e.type="polar",e.dependencies=["radiusAxis","angleAxis"],e.defaultOption={z:0,center:["50%","50%"],radius:"80%"},e}($n),c5=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",Ma).models[0]},e.type="polarAxis",e}($n);Ea(c5,kb);var sOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="angleAxis",e}(c5),lOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="radiusAxis",e}(c5),h5=function(t){et(e,t);function e(r,n){return t.call(this,"radius",r,n)||this}return e.prototype.pointToData=function(r,n){return this.polar.pointToData(r,n)[this.dim==="radius"?0:1]},e}(Tu);h5.prototype.dataToRadius=Tu.prototype.dataToCoord;h5.prototype.radiusToData=Tu.prototype.coordToData;var uOe=ri(),f5=function(t){et(e,t);function e(r,n){return t.call(this,"angle",r,n||[0,360])||this}return e.prototype.pointToData=function(r,n){return this.polar.pointToData(r,n)[this.dim==="radius"?0:1]},e.prototype.calculateCategoryInterval=function(){var r=this,n=r.getLabelModel(),i=r.scale,a=i.getExtent(),l=i.count();if(a[1]-a[0]<1)return 0;var c=a[0],o=r.dataToCoord(c+1)-r.dataToCoord(c),d=Math.abs(o),g=Sb(c==null?"":c+"",n.getFont(),"center","top"),m=Math.max(g.height,7),y=m/d;isNaN(y)&&(y=1/0);var x=Math.max(0,Math.floor(y)),A=uOe(r.model),M=A.lastAutoInterval,D=A.lastTickCount;return M!=null&&D!=null&&Math.abs(M-x)<=1&&Math.abs(D-l)<=1&&M>x?x=M:(A.lastTickCount=l,A.lastAutoInterval=x),x},e}(Tu);f5.prototype.dataToAngle=Tu.prototype.dataToCoord;f5.prototype.angleToData=Tu.prototype.coordToData;var hee=["radius","angle"],cOe=function(){function t(e){this.dimensions=hee,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new h5,this._angleAxis=new f5,this.axisPointerEnabled=!0,this.name=e||"",this._radiusAxis.polar=this._angleAxis.polar=this}return t.prototype.containPoint=function(e){var r=this.pointToCoord(e);return this._radiusAxis.contain(r[0])&&this._angleAxis.contain(r[1])},t.prototype.containData=function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},t.prototype.getAxis=function(e){var r="_"+e+"Axis";return this[r]},t.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},t.prototype.getAxesByScale=function(e){var r=[],n=this._angleAxis,i=this._radiusAxis;return n.scale.type===e&&r.push(n),i.scale.type===e&&r.push(i),r},t.prototype.getAngleAxis=function(){return this._angleAxis},t.prototype.getRadiusAxis=function(){return this._radiusAxis},t.prototype.getOtherAxis=function(e){var r=this._angleAxis;return e===r?this._radiusAxis:r},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},t.prototype.getTooltipAxes=function(e){var r=e!=null&&e!=="auto"?this.getAxis(e):this.getBaseAxis();return{baseAxes:[r],otherAxes:[this.getOtherAxis(r)]}},t.prototype.dataToPoint=function(e,r){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],r),this._angleAxis.dataToAngle(e[1],r)])},t.prototype.pointToData=function(e,r){var n=this.pointToCoord(e);return[this._radiusAxis.radiusToData(n[0],r),this._angleAxis.angleToData(n[1],r)]},t.prototype.pointToCoord=function(e){var r=e[0]-this.cx,n=e[1]-this.cy,i=this.getAngleAxis(),a=i.getExtent(),l=Math.min(a[0],a[1]),c=Math.max(a[0],a[1]);i.inverse?l=c-360:c=l+360;var o=Math.sqrt(r*r+n*n);r/=o,n/=o;for(var d=Math.atan2(-n,r)/Math.PI*180,g=d<l?1:-1;d<l||d>c;)d+=g*360;return[o,d]},t.prototype.coordToPoint=function(e){var r=e[0],n=e[1]/180*Math.PI,i=Math.cos(n)*r+this.cx,a=-Math.sin(n)*r+this.cy;return[i,a]},t.prototype.getArea=function(){var e=this.getAngleAxis(),r=this.getRadiusAxis(),n=r.getExtent().slice();n[0]>n[1]&&n.reverse();var i=e.getExtent(),a=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:n[0],r:n[1],startAngle:-i[0]*a,endAngle:-i[1]*a,clockwise:e.inverse,contain:function(l,c){var o=l-this.cx,d=c-this.cy,g=o*o+d*d-1e-4,m=this.r,y=this.r0;return g<=m*m&&g>=y*y}}},t.prototype.convertToPixel=function(e,r,n){var i=Uj(r);return i===this?this.dataToPoint(n):null},t.prototype.convertFromPixel=function(e,r,n){var i=Uj(r);return i===this?this.pointToData(n):null},t}();function Uj(t){var e=t.seriesModel,r=t.polarModel;return r&&r.coordinateSystem||e&&e.coordinateSystem}const hOe=cOe;function fOe(t,e,r){var n=e.get("center"),i=r.getWidth(),a=r.getHeight();t.cx=dr(n[0],i),t.cy=dr(n[1],a);var l=t.getRadiusAxis(),c=Math.min(i,a)/2,o=e.get("radius");o==null?o=[0,"100%"]:Ht(o)||(o=[0,o]);var d=[dr(o[0],c),dr(o[1],c)];l.inverse?l.setExtent(d[1],d[0]):l.setExtent(d[0],d[1])}function dOe(t,e){var r=this,n=r.getAngleAxis(),i=r.getRadiusAxis();if(n.scale.setExtent(1/0,-1/0),i.scale.setExtent(1/0,-1/0),t.eachSeries(function(c){if(c.coordinateSystem===r){var o=c.getData();fe(ZC(o,"radius"),function(d){i.scale.unionExtentFromData(o,d)}),fe(ZC(o,"angle"),function(d){n.scale.unionExtentFromData(o,d)})}}),W_(n.scale,n.model),W_(i.scale,i.model),n.type==="category"&&!n.onBand){var a=n.getExtent(),l=360/n.scale.count();n.inverse?a[1]+=l:a[1]-=l,n.setExtent(a[0],a[1])}}function pOe(t){return t.mainType==="angleAxis"}function $j(t,e){var r;if(t.type=e.get("type"),t.scale=II(e),t.onBand=e.get("boundaryGap")&&t.type==="category",t.inverse=e.get("inverse"),pOe(e)){t.inverse=t.inverse!==e.get("clockwise");var n=e.get("startAngle"),i=(r=e.get("endAngle"))!==null&&r!==void 0?r:n+(t.inverse?-360:360);t.setExtent(n,i)}e.axis=t,t.model=e}var gOe={dimensions:hee,create:function(t,e){var r=[];return t.eachComponent("polar",function(n,i){var a=new hOe(i+"");a.update=dOe;var l=a.getRadiusAxis(),c=a.getAngleAxis(),o=n.findAxisModel("radiusAxis"),d=n.findAxisModel("angleAxis");$j(l,o),$j(c,d),fOe(a,n,e),r.push(a),n.coordinateSystem=a,a.model=n}),t.eachSeries(function(n){if(n.get("coordinateSystem")==="polar"){var i=n.getReferringComponents("polar",Ma).models[0];n.coordinateSystem=i.coordinateSystem}}),r}},vOe=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function hA(t,e,r){e[1]>e[0]&&(e=e.slice().reverse());var n=t.coordToPoint([e[0],r]),i=t.coordToPoint([e[1],r]);return{x1:n[0],y1:n[1],x2:i[0],y2:i[1]}}function fA(t){var e=t.getRadiusAxis();return e.inverse?0:1}function Hj(t){var e=t[0],r=t[t.length-1];e&&r&&Math.abs(Math.abs(e.coord-r.coord)-360)<1e-4&&t.pop()}var mOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.axisPointerClass="PolarAxisPointer",r}return e.prototype.render=function(r,n){if(this.group.removeAll(),!!r.get("show")){var i=r.axis,a=i.polar,l=a.getRadiusAxis().getExtent(),c=i.getTicksCoords(),o=i.getMinorTicksCoords(),d=Zt(i.getViewLabels(),function(g){g=$r(g);var m=i.scale,y=m.type==="ordinal"?m.getRawOrdinalNumber(g.tickValue):g.tickValue;return g.coord=i.dataToCoord(y),g});Hj(d),Hj(c),fe(vOe,function(g){r.get([g,"show"])&&(!i.scale.isBlank()||g==="axisLine")&&_Oe[g](this.group,r,a,c,o,l,d)},this)}},e.type="angleAxis",e}(vv),_Oe={axisLine:function(t,e,r,n,i,a){var l=e.getModel(["axisLine","lineStyle"]),c=r.getAngleAxis(),o=Math.PI/180,d=c.getExtent(),g=fA(r),m=g?0:1,y,x=Math.abs(d[1]-d[0])===360?"Circle":"Arc";a[m]===0?y=new fv[x]({shape:{cx:r.cx,cy:r.cy,r:a[g],startAngle:-d[0]*o,endAngle:-d[1]*o,clockwise:c.inverse},style:l.getLineStyle(),z2:1,silent:!0}):y=new cI({shape:{cx:r.cx,cy:r.cy,r:a[g],r0:a[m]},style:l.getLineStyle(),z2:1,silent:!0}),y.style.fill=null,t.add(y)},axisTick:function(t,e,r,n,i,a){var l=e.getModel("axisTick"),c=(l.get("inside")?-1:1)*l.get("length"),o=a[fA(r)],d=Zt(n,function(g){return new Ka({shape:hA(r,[o,o+c],g.coord)})});t.add(Cl(d,{style:Fr(l.getModel("lineStyle").getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])})}))},minorTick:function(t,e,r,n,i,a){if(i.length){for(var l=e.getModel("axisTick"),c=e.getModel("minorTick"),o=(l.get("inside")?-1:1)*c.get("length"),d=a[fA(r)],g=[],m=0;m<i.length;m++)for(var y=0;y<i[m].length;y++)g.push(new Ka({shape:hA(r,[d,d+o],i[m][y].coord)}));t.add(Cl(g,{style:Fr(c.getModel("lineStyle").getLineStyle(),Fr(l.getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(t,e,r,n,i,a,l){var c=e.getCategories(!0),o=e.getModel("axisLabel"),d=o.get("margin"),g=e.get("triggerEvent");fe(l,function(m,y){var x=o,A=m.tickValue,M=a[fA(r)],D=r.coordToPoint([M+d,m.coord]),P=r.cx,O=r.cy,z=Math.abs(D[0]-P)/M<.3?"center":D[0]>P?"left":"right",V=Math.abs(D[1]-O)/M<.3?"middle":D[1]>O?"top":"bottom";if(c&&c[A]){var H=c[A];Ur(H)&&H.textStyle&&(x=new bi(H.textStyle,o,o.ecModel))}var $=new ti({silent:rs.isLabelSilent(e),style:Hi(x,{x:D[0],y:D[1],fill:x.getTextColor()||e.get(["axisLine","lineStyle","color"]),text:m.formattedLabel,align:z,verticalAlign:V})});if(t.add($),g){var X=rs.makeAxisEventDataBase(e);X.targetType="axisLabel",X.value=m.rawLabel,Yr($).eventData=X}},this)},splitLine:function(t,e,r,n,i,a){var l=e.getModel("splitLine"),c=l.getModel("lineStyle"),o=c.get("color"),d=0;o=o instanceof Array?o:[o];for(var g=[],m=0;m<n.length;m++){var y=d++%o.length;g[y]=g[y]||[],g[y].push(new Ka({shape:hA(r,a,n[m].coord)}))}for(var m=0;m<g.length;m++)t.add(Cl(g[m],{style:Fr({stroke:o[m%o.length]},c.getLineStyle()),silent:!0,z:e.get("z")}))},minorSplitLine:function(t,e,r,n,i,a){if(i.length){for(var l=e.getModel("minorSplitLine"),c=l.getModel("lineStyle"),o=[],d=0;d<i.length;d++)for(var g=0;g<i[d].length;g++)o.push(new Ka({shape:hA(r,a,i[d][g].coord)}));t.add(Cl(o,{style:c.getLineStyle(),silent:!0,z:e.get("z")}))}},splitArea:function(t,e,r,n,i,a){if(n.length){var l=e.getModel("splitArea"),c=l.getModel("areaStyle"),o=c.get("color"),d=0;o=o instanceof Array?o:[o];for(var g=[],m=Math.PI/180,y=-n[0].coord*m,x=Math.min(a[0],a[1]),A=Math.max(a[0],a[1]),M=e.get("clockwise"),D=1,P=n.length;D<=P;D++){var O=D===P?n[0].coord:n[D].coord,z=d++%o.length;g[z]=g[z]||[],g[z].push(new as({shape:{cx:r.cx,cy:r.cy,r0:x,r:A,startAngle:y,endAngle:-O*m,clockwise:M},silent:!0})),y=-O*m}for(var D=0;D<g.length;D++)t.add(Cl(g[D],{style:Fr({fill:o[D%o.length]},c.getAreaStyle()),silent:!0}))}}},yOe=["axisLine","axisTickLabel","axisName"],xOe=["splitLine","splitArea","minorSplitLine"],bOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.axisPointerClass="PolarAxisPointer",r}return e.prototype.render=function(r,n){if(this.group.removeAll(),!!r.get("show")){var i=this._axisGroup,a=this._axisGroup=new jr;this.group.add(a);var l=r.axis,c=l.polar,o=c.getAngleAxis(),d=l.getTicksCoords(),g=l.getMinorTicksCoords(),m=o.getExtent()[0],y=l.getExtent(),x=SOe(c,r,m),A=new rs(r,x);fe(yOe,A.add,A),a.add(A.getGroup()),Ib(i,a,r),fe(xOe,function(M){r.get([M,"show"])&&!l.scale.isBlank()&&wOe[M](this.group,r,c,m,y,d,g)},this)}},e.type="radiusAxis",e}(vv),wOe={splitLine:function(t,e,r,n,i,a){var l=e.getModel("splitLine"),c=l.getModel("lineStyle"),o=c.get("color"),d=0,g=r.getAngleAxis(),m=Math.PI/180,y=g.getExtent(),x=Math.abs(y[1]-y[0])===360?"Circle":"Arc";o=o instanceof Array?o:[o];for(var A=[],M=0;M<a.length;M++){var D=d++%o.length;A[D]=A[D]||[],A[D].push(new fv[x]({shape:{cx:r.cx,cy:r.cy,r:Math.max(a[M].coord,0),startAngle:-y[0]*m,endAngle:-y[1]*m,clockwise:g.inverse}}))}for(var M=0;M<A.length;M++)t.add(Cl(A[M],{style:Fr({stroke:o[M%o.length],fill:null},c.getLineStyle()),silent:!0}))},minorSplitLine:function(t,e,r,n,i,a,l){if(l.length){for(var c=e.getModel("minorSplitLine"),o=c.getModel("lineStyle"),d=[],g=0;g<l.length;g++)for(var m=0;m<l[g].length;m++)d.push(new Ch({shape:{cx:r.cx,cy:r.cy,r:l[g][m].coord}}));t.add(Cl(d,{style:Fr({fill:null},o.getLineStyle()),silent:!0}))}},splitArea:function(t,e,r,n,i,a){if(a.length){var l=e.getModel("splitArea"),c=l.getModel("areaStyle"),o=c.get("color"),d=0;o=o instanceof Array?o:[o];for(var g=[],m=a[0].coord,y=1;y<a.length;y++){var x=d++%o.length;g[x]=g[x]||[],g[x].push(new as({shape:{cx:r.cx,cy:r.cy,r0:m,r:a[y].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),m=a[y].coord}for(var y=0;y<g.length;y++)t.add(Cl(g[y],{style:Fr({fill:o[y%o.length]},c.getAreaStyle()),silent:!0}))}}};function SOe(t,e,r){return{position:[t.cx,t.cy],rotation:r/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1}}function fee(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex}function dee(t,e){return e.dim+t.model.componentIndex}function TOe(t,e,r){var n={},i=AOe(Ei(e.getSeriesByType(t),function(a){return!e.isSeriesFiltered(a)&&a.coordinateSystem&&a.coordinateSystem.type==="polar"}));e.eachSeriesByType(t,function(a){if(a.coordinateSystem.type==="polar"){var l=a.getData(),c=a.coordinateSystem,o=c.getBaseAxis(),d=dee(c,o),g=fee(a),m=i[d][g],y=m.offset,x=m.width,A=c.getOtherAxis(o),M=a.coordinateSystem.cx,D=a.coordinateSystem.cy,P=a.get("barMinHeight")||0,O=a.get("barMinAngle")||0;n[g]=n[g]||[];for(var z=l.mapDimension(A.dim),V=l.mapDimension(o.dim),H=yd(l,z),$=o.dim!=="radius"||!a.get("roundCap",!0),X=A.dataToCoord(0),W=0,Y=l.count();W<Y;W++){var J=l.get(z,W),re=l.get(V,W),ae=J>=0?"p":"n",pe=X;H&&(n[g][re]||(n[g][re]={p:X,n:X}),pe=n[g][re][ae]);var de=void 0,ve=void 0,me=void 0,Ie=void 0;if(A.dim==="radius"){var Le=A.dataToCoord(J)-X,Ee=o.dataToCoord(re);Math.abs(Le)<P&&(Le=(Le<0?-1:1)*P),de=pe,ve=pe+Le,me=Ee-y,Ie=me-x,H&&(n[g][re][ae]=ve)}else{var Ue=A.dataToCoord(J,$)-X,Ke=o.dataToCoord(re);Math.abs(Ue)<O&&(Ue=(Ue<0?-1:1)*O),de=Ke+y,ve=de+x,me=pe,Ie=pe+Ue,H&&(n[g][re][ae]=Ie)}l.setItemLayout(W,{cx:M,cy:D,r0:de,r:ve,startAngle:-me*Math.PI/180,endAngle:-Ie*Math.PI/180,clockwise:me>=Ie})}}})}function AOe(t){var e={};fe(t,function(n,i){var a=n.getData(),l=n.coordinateSystem,c=l.getBaseAxis(),o=dee(l,c),d=c.getExtent(),g=c.type==="category"?c.getBandWidth():Math.abs(d[1]-d[0])/a.count(),m=e[o]||{bandWidth:g,remainedWidth:g,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},y=m.stacks;e[o]=m;var x=fee(n);y[x]||m.autoWidthCount++,y[x]=y[x]||{width:0,maxWidth:0};var A=dr(n.get("barWidth"),g),M=dr(n.get("barMaxWidth"),g),D=n.get("barGap"),P=n.get("barCategoryGap");A&&!y[x].width&&(A=Math.min(m.remainedWidth,A),y[x].width=A,m.remainedWidth-=A),M&&(y[x].maxWidth=M),D!=null&&(m.gap=D),P!=null&&(m.categoryGap=P)});var r={};return fe(e,function(n,i){r[i]={};var a=n.stacks,l=n.bandWidth,c=dr(n.categoryGap,l),o=dr(n.gap,1),d=n.remainedWidth,g=n.autoWidthCount,m=(d-c)/(g+(g-1)*o);m=Math.max(m,0),fe(a,function(M,D){var P=M.maxWidth;P&&P<m&&(P=Math.min(P,d),M.width&&(P=Math.min(P,M.width)),d-=P,M.width=P,g--)}),m=(d-c)/(g+(g-1)*o),m=Math.max(m,0);var y=0,x;fe(a,function(M,D){M.width||(M.width=m),x=M,y+=M.width*(1+o)}),x&&(y-=x.width*o);var A=-y/2;fe(a,function(M,D){r[i][D]=r[i][D]||{offset:A,width:M.width},A+=M.width*(1+o)})}),r}var COe={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},MOe={splitNumber:5},IOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="polar",e}(ra);function EOe(t){En($b),vv.registerAxisPointerClass("PolarAxisPointer",nOe),t.registerCoordinateSystem("polar",gOe),t.registerComponentModel(oOe),t.registerComponentView(IOe),q_(t,"angle",sOe,COe),q_(t,"radius",lOe,MOe),t.registerComponentView(mOe),t.registerComponentView(bOe),t.registerLayout(on(TOe,"bar"))}function HO(t,e){e=e||{};var r=t.coordinateSystem,n=t.axis,i={},a=n.position,l=n.orient,c=r.getRect(),o=[c.x,c.x+c.width,c.y,c.y+c.height],d={horizontal:{top:o[2],bottom:o[3]},vertical:{left:o[0],right:o[1]}};i.position=[l==="vertical"?d.vertical[a]:o[0],l==="horizontal"?d.horizontal[a]:o[3]];var g={horizontal:0,vertical:1};i.rotation=Math.PI/2*g[l];var m={top:-1,bottom:1,right:1,left:-1};i.labelDirection=i.tickDirection=i.nameDirection=m[a],t.get(["axisTick","inside"])&&(i.tickDirection=-i.tickDirection),ho(e.labelInside,t.get(["axisLabel","inside"]))&&(i.labelDirection=-i.labelDirection);var y=e.rotate;return y==null&&(y=t.get(["axisLabel","rotate"])),i.labelRotation=a==="top"?-y:y,i.z2=1,i}var DOe=["axisLine","axisTickLabel","axisName"],POe=["splitArea","splitLine"],LOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.axisPointerClass="SingleAxisPointer",r}return e.prototype.render=function(r,n,i,a){var l=this.group;l.removeAll();var c=this._axisGroup;this._axisGroup=new jr;var o=HO(r),d=new rs(r,o);fe(DOe,d.add,d),l.add(this._axisGroup),l.add(d.getGroup()),fe(POe,function(g){r.get([g,"show"])&&ROe[g](this,this.group,this._axisGroup,r)},this),Ib(c,this._axisGroup,r),t.prototype.render.call(this,r,n,i,a)},e.prototype.remove=function(){kK(this)},e.type="singleAxis",e}(vv),ROe={splitLine:function(t,e,r,n){var i=n.axis;if(!i.scale.isBlank()){var a=n.getModel("splitLine"),l=a.getModel("lineStyle"),c=l.get("color");c=c instanceof Array?c:[c];for(var o=l.get("width"),d=n.coordinateSystem.getRect(),g=i.isHorizontal(),m=[],y=0,x=i.getTicksCoords({tickModel:a}),A=[],M=[],D=0;D<x.length;++D){var P=i.toGlobalCoord(x[D].coord);g?(A[0]=P,A[1]=d.y,M[0]=P,M[1]=d.y+d.height):(A[0]=d.x,A[1]=P,M[0]=d.x+d.width,M[1]=P);var O=new Ka({shape:{x1:A[0],y1:A[1],x2:M[0],y2:M[1]},silent:!0});$_(O.shape,o);var z=y++%c.length;m[z]=m[z]||[],m[z].push(O)}for(var V=l.getLineStyle(["color"]),D=0;D<m.length;++D)e.add(Cl(m[D],{style:Fr({stroke:c[D%c.length]},V),silent:!0}))}},splitArea:function(t,e,r,n){RK(t,r,n,n)}},JA=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.getCoordSysModel=function(){return this},e.type="singleAxis",e.layoutMode="box",e.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},e}($n);Ea(JA,kb.prototype);var kOe=function(t){et(e,t);function e(r,n,i,a,l){var c=t.call(this,r,n,i)||this;return c.type=a||"value",c.position=l||"bottom",c}return e.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},e.prototype.pointToData=function(r,n){return this.coordinateSystem.pointToData(r)[0]},e}(Tu),pee=["single"],OOe=function(){function t(e,r,n){this.type="single",this.dimension="single",this.dimensions=pee,this.axisPointerEnabled=!0,this.model=e,this._init(e,r,n)}return t.prototype._init=function(e,r,n){var i=this.dimension,a=new kOe(i,II(e),[0,0],e.get("type"),e.get("position")),l=a.type==="category";a.onBand=l&&e.get("boundaryGap"),a.inverse=e.get("inverse"),a.orient=e.get("orient"),e.axis=a,a.model=e,a.coordinateSystem=this,this._axis=a},t.prototype.update=function(e,r){e.eachSeries(function(n){if(n.coordinateSystem===this){var i=n.getData();fe(i.mapDimensionsAll(this.dimension),function(a){this._axis.scale.unionExtentFromData(i,a)},this),W_(this._axis.scale,this._axis.model)}},this)},t.prototype.resize=function(e,r){this._rect=Na({left:e.get("left"),top:e.get("top"),right:e.get("right"),bottom:e.get("bottom"),width:e.get("width"),height:e.get("height")},{width:r.getWidth(),height:r.getHeight()}),this._adjustAxis()},t.prototype.getRect=function(){return this._rect},t.prototype._adjustAxis=function(){var e=this._rect,r=this._axis,n=r.isHorizontal(),i=n?[0,e.width]:[0,e.height],a=r.inverse?1:0;r.setExtent(i[a],i[1-a]),this._updateAxisTransform(r,n?e.x:e.y)},t.prototype._updateAxisTransform=function(e,r){var n=e.getExtent(),i=n[0]+n[1],a=e.isHorizontal();e.toGlobalCoord=a?function(l){return l+r}:function(l){return i-l+r},e.toLocalCoord=a?function(l){return l-r}:function(l){return i-l+r}},t.prototype.getAxis=function(){return this._axis},t.prototype.getBaseAxis=function(){return this._axis},t.prototype.getAxes=function(){return[this._axis]},t.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},t.prototype.containPoint=function(e){var r=this.getRect(),n=this.getAxis(),i=n.orient;return i==="horizontal"?n.contain(n.toLocalCoord(e[0]))&&e[1]>=r.y&&e[1]<=r.y+r.height:n.contain(n.toLocalCoord(e[1]))&&e[0]>=r.y&&e[0]<=r.y+r.height},t.prototype.pointToData=function(e){var r=this.getAxis();return[r.coordToData(r.toLocalCoord(e[r.orient==="horizontal"?0:1]))]},t.prototype.dataToPoint=function(e){var r=this.getAxis(),n=this.getRect(),i=[],a=r.orient==="horizontal"?0:1;return e instanceof Array&&(e=e[0]),i[a]=r.toGlobalCoord(r.dataToCoord(+e)),i[1-a]=a===0?n.y+n.height/2:n.x+n.width/2,i},t.prototype.convertToPixel=function(e,r,n){var i=jj(r);return i===this?this.dataToPoint(n):null},t.prototype.convertFromPixel=function(e,r,n){var i=jj(r);return i===this?this.pointToData(n):null},t}();function jj(t){var e=t.seriesModel,r=t.singleAxisModel;return r&&r.coordinateSystem||e&&e.coordinateSystem}function zOe(t,e){var r=[];return t.eachComponent("singleAxis",function(n,i){var a=new OOe(n,t,e);a.name="single_"+i,a.resize(n,e),n.coordinateSystem=a,r.push(a)}),t.eachSeries(function(n){if(n.get("coordinateSystem")==="singleAxis"){var i=n.getReferringComponents("singleAxis",Ma).models[0];n.coordinateSystem=i&&i.coordinateSystem}}),r}var BOe={create:zOe,dimensions:pee},Wj=["x","y"],FOe=["width","height"],NOe=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.makeElOption=function(r,n,i,a,l){var c=i.axis,o=c.coordinateSystem,d=pR(o,1-sM(c)),g=o.dataToPoint(n)[0],m=a.get("type");if(m&&m!=="none"){var y=s5(a),x=VOe[m](c,g,d);x.style=y,r.graphicKey=x.type,r.pointer=x}var A=HO(i);see(n,r,A,i,a,l)},e.prototype.getHandleTransform=function(r,n,i){var a=HO(n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var l=l5(n.axis,r,a);return{x:l[0],y:l[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(r,n,i,a){var l=i.axis,c=l.coordinateSystem,o=sM(l),d=pR(c,o),g=[r.x,r.y];g[o]+=n[o],g[o]=Math.min(d[1],g[o]),g[o]=Math.max(d[0],g[o]);var m=pR(c,1-o),y=(m[1]+m[0])/2,x=[y,y];return x[o]=g[o],{x:g[0],y:g[1],rotation:r.rotation,cursorPoint:x,tooltipOption:{verticalAlign:"middle"}}},e}(o5),VOe={line:function(t,e,r){var n=u5([e,r[0]],[e,r[1]],sM(t));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(t,e,r){var n=t.getBandWidth(),i=r[1]-r[0];return{type:"Rect",shape:lee([e-n/2,r[0]],[n,i],sM(t))}}};function sM(t){return t.isHorizontal()?0:1}function pR(t,e){var r=t.getRect();return[r[Wj[e]],r[Wj[e]]+r[FOe[e]]]}var GOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="single",e}(ra);function UOe(t){En($b),vv.registerAxisPointerClass("SingleAxisPointer",NOe),t.registerComponentView(GOe),t.registerComponentView(LOe),t.registerComponentModel(JA),q_(t,"single",JA,JA.defaultOption),t.registerCoordinateSystem("single",BOe)}var $Oe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r,n,i){var a=dy(r);t.prototype.init.apply(this,arguments),Zj(r,a)},e.prototype.mergeOption=function(r){t.prototype.mergeOption.apply(this,arguments),Zj(this.option,r)},e.prototype.getCellSize=function(){return this.option.cellSize},e.type="calendar",e.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},e}($n);function Zj(t,e){var r=t.cellSize,n;Ht(r)?n=r:n=t.cellSize=[r,r],n.length===1&&(n[1]=n[0]);var i=Zt([0,1],function(a){return cwe(e,a)&&(n[a]="auto"),n[a]!=null&&n[a]!=="auto"});_d(t,e,{type:"box",ignoreSize:i})}var HOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){var a=this.group;a.removeAll();var l=r.coordinateSystem,c=l.getRangeInfo(),o=l.getOrient(),d=n.getLocaleModel();this._renderDayRect(r,c,a),this._renderLines(r,c,o,a),this._renderYearText(r,c,o,a),this._renderMonthText(r,d,o,a),this._renderWeekText(r,d,c,o,a)},e.prototype._renderDayRect=function(r,n,i){for(var a=r.coordinateSystem,l=r.getModel("itemStyle").getItemStyle(),c=a.getCellWidth(),o=a.getCellHeight(),d=n.start.time;d<=n.end.time;d=a.getNextNDay(d,1).time){var g=a.dataToRect([d],!1).tl,m=new Kn({shape:{x:g[0],y:g[1],width:c,height:o},cursor:"default",style:l});i.add(m)}},e.prototype._renderLines=function(r,n,i,a){var l=this,c=r.coordinateSystem,o=r.getModel(["splitLine","lineStyle"]).getLineStyle(),d=r.get(["splitLine","show"]),g=o.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var m=n.start,y=0;m.time<=n.end.time;y++){A(m.formatedDate),y===0&&(m=c.getDateInfo(n.start.y+"-"+n.start.m));var x=m.date;x.setMonth(x.getMonth()+1),m=c.getDateInfo(x)}A(c.getNextNDay(n.end.time,1).formatedDate);function A(M){l._firstDayOfMonth.push(c.getDateInfo(M)),l._firstDayPoints.push(c.dataToRect([M],!1).tl);var D=l._getLinePointsOfOneWeek(r,M,i);l._tlpoints.push(D[0]),l._blpoints.push(D[D.length-1]),d&&l._drawSplitline(D,o,a)}d&&this._drawSplitline(l._getEdgesPoints(l._tlpoints,g,i),o,a),d&&this._drawSplitline(l._getEdgesPoints(l._blpoints,g,i),o,a)},e.prototype._getEdgesPoints=function(r,n,i){var a=[r[0].slice(),r[r.length-1].slice()],l=i==="horizontal"?0:1;return a[0][l]=a[0][l]-n/2,a[1][l]=a[1][l]+n/2,a},e.prototype._drawSplitline=function(r,n,i){var a=new ls({z2:20,shape:{points:r},style:n});i.add(a)},e.prototype._getLinePointsOfOneWeek=function(r,n,i){for(var a=r.coordinateSystem,l=a.getDateInfo(n),c=[],o=0;o<7;o++){var d=a.getNextNDay(l.time,o),g=a.dataToRect([d.time],!1);c[2*d.day]=g.tl,c[2*d.day+1]=g[i==="horizontal"?"bl":"tr"]}return c},e.prototype._formatterLabel=function(r,n){return yr(r)&&r?swe(r,n):zr(r)?r(n):n.nameMap},e.prototype._yearTextPositionControl=function(r,n,i,a,l){var c=n[0],o=n[1],d=["center","bottom"];a==="bottom"?(o+=l,d=["center","top"]):a==="left"?c-=l:a==="right"?(c+=l,d=["center","top"]):o-=l;var g=0;return(a==="left"||a==="right")&&(g=Math.PI/2),{rotation:g,x:c,y:o,style:{align:d[0],verticalAlign:d[1]}}},e.prototype._renderYearText=function(r,n,i,a){var l=r.getModel("yearLabel");if(l.get("show")){var c=l.get("margin"),o=l.get("position");o||(o=i!=="horizontal"?"top":"left");var d=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],g=(d[0][0]+d[1][0])/2,m=(d[0][1]+d[1][1])/2,y=i==="horizontal"?0:1,x={top:[g,d[y][1]],bottom:[g,d[1-y][1]],left:[d[1-y][0],m],right:[d[y][0],m]},A=n.start.y;+n.end.y>+n.start.y&&(A=A+"-"+n.end.y);var M=l.get("formatter"),D={start:n.start.y,end:n.end.y,nameMap:A},P=this._formatterLabel(M,D),O=new ti({z2:30,style:Hi(l,{text:P})});O.attr(this._yearTextPositionControl(O,x[o],i,o,c)),a.add(O)}},e.prototype._monthTextPositionControl=function(r,n,i,a,l){var c="left",o="top",d=r[0],g=r[1];return i==="horizontal"?(g=g+l,n&&(c="center"),a==="start"&&(o="bottom")):(d=d+l,n&&(o="middle"),a==="start"&&(c="right")),{x:d,y:g,align:c,verticalAlign:o}},e.prototype._renderMonthText=function(r,n,i,a){var l=r.getModel("monthLabel");if(l.get("show")){var c=l.get("nameMap"),o=l.get("margin"),d=l.get("position"),g=l.get("align"),m=[this._tlpoints,this._blpoints];(!c||yr(c))&&(c&&(n=Jk(c)||n),c=n.get(["time","monthAbbr"])||[]);var y=d==="start"?0:1,x=i==="horizontal"?0:1;o=d==="start"?-o:o;for(var A=g==="center",M=0;M<m[y].length-1;M++){var D=m[y][M].slice(),P=this._firstDayOfMonth[M];if(A){var O=this._firstDayPoints[M];D[x]=(O[x]+m[0][M+1][x])/2}var z=l.get("formatter"),V=c[+P.m-1],H={yyyy:P.y,yy:(P.y+"").slice(2),MM:P.m,M:+P.m,nameMap:V},$=this._formatterLabel(z,H),X=new ti({z2:30,style:Lt(Hi(l,{text:$}),this._monthTextPositionControl(D,A,i,d,o))});a.add(X)}}},e.prototype._weekTextPositionControl=function(r,n,i,a,l){var c="center",o="middle",d=r[0],g=r[1],m=i==="start";return n==="horizontal"?(d=d+a+(m?1:-1)*l[0]/2,c=m?"right":"left"):(g=g+a+(m?1:-1)*l[1]/2,o=m?"bottom":"top"),{x:d,y:g,align:c,verticalAlign:o}},e.prototype._renderWeekText=function(r,n,i,a,l){var c=r.getModel("dayLabel");if(c.get("show")){var o=r.coordinateSystem,d=c.get("position"),g=c.get("nameMap"),m=c.get("margin"),y=o.getFirstDayOfWeek();if(!g||yr(g)){g&&(n=Jk(g)||n);var x=n.get(["time","dayOfWeekShort"]);g=x||Zt(n.get(["time","dayOfWeekAbbr"]),function(H){return H[0]})}var A=o.getNextNDay(i.end.time,7-i.lweek).time,M=[o.getCellWidth(),o.getCellHeight()];m=dr(m,Math.min(M[1],M[0])),d==="start"&&(A=o.getNextNDay(i.start.time,-(7+i.fweek)).time,m=-m);for(var D=0;D<7;D++){var P=o.getNextNDay(A,D),O=o.dataToRect([P.time],!1).center,z=D;z=Math.abs((D+y)%7);var V=new ti({z2:30,style:Lt(Hi(c,{text:g[z]}),this._weekTextPositionControl(O,a,d,m,M))});l.add(V)}}},e.type="calendar",e}(ra),gR=864e5,jOe=function(){function t(e,r,n){this.type="calendar",this.dimensions=t.dimensions,this.getDimensionsInfo=t.getDimensionsInfo,this._model=e}return t.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},t.prototype.getRangeInfo=function(){return this._rangeInfo},t.prototype.getModel=function(){return this._model},t.prototype.getRect=function(){return this._rect},t.prototype.getCellWidth=function(){return this._sw},t.prototype.getCellHeight=function(){return this._sh},t.prototype.getOrient=function(){return this._orient},t.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},t.prototype.getDateInfo=function(e){e=dc(e);var r=e.getFullYear(),n=e.getMonth()+1,i=n<10?"0"+n:""+n,a=e.getDate(),l=a<10?"0"+a:""+a,c=e.getDay();return c=Math.abs((c+7-this.getFirstDayOfWeek())%7),{y:r+"",m:i,d:l,day:c,time:e.getTime(),formatedDate:r+"-"+i+"-"+l,date:e}},t.prototype.getNextNDay=function(e,r){return r=r||0,r===0?this.getDateInfo(e):(e=new Date(this.getDateInfo(e).time),e.setDate(e.getDate()+r),this.getDateInfo(e))},t.prototype.update=function(e,r){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,i=["width","height"],a=this._model.getCellSize().slice(),l=this._model.getBoxLayoutParams(),c=this._orient==="horizontal"?[n,7]:[7,n];fe([0,1],function(m){g(a,m)&&(l[i[m]]=a[m]*c[m])});var o={width:r.getWidth(),height:r.getHeight()},d=this._rect=Na(l,o);fe([0,1],function(m){g(a,m)||(a[m]=d[i[m]]/c[m])});function g(m,y){return m[y]!=null&&m[y]!=="auto"}this._sw=a[0],this._sh=a[1]},t.prototype.dataToPoint=function(e,r){Ht(e)&&(e=e[0]),r==null&&(r=!0);var n=this.getDateInfo(e),i=this._rangeInfo,a=n.formatedDate;if(r&&!(n.time>=i.start.time&&n.time<i.end.time+gR))return[NaN,NaN];var l=n.day,c=this._getRangeInfo([i.start.time,a]).nthWeek;return this._orient==="vertical"?[this._rect.x+l*this._sw+this._sw/2,this._rect.y+c*this._sh+this._sh/2]:[this._rect.x+c*this._sw+this._sw/2,this._rect.y+l*this._sh+this._sh/2]},t.prototype.pointToData=function(e){var r=this.pointToDate(e);return r&&r.time},t.prototype.dataToRect=function(e,r){var n=this.dataToPoint(e,r);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},t.prototype.pointToDate=function(e){var r=Math.floor((e[0]-this._rect.x)/this._sw)+1,n=Math.floor((e[1]-this._rect.y)/this._sh)+1,i=this._rangeInfo.range;return this._orient==="vertical"?this._getDateByWeeksAndDay(n,r-1,i):this._getDateByWeeksAndDay(r,n-1,i)},t.prototype.convertToPixel=function(e,r,n){var i=qj(r);return i===this?i.dataToPoint(n):null},t.prototype.convertFromPixel=function(e,r,n){var i=qj(r);return i===this?i.pointToData(n):null},t.prototype.containPoint=function(e){return console.warn("Not implemented."),!1},t.prototype._initRangeOption=function(){var e=this._model.get("range"),r;if(Ht(e)&&e.length===1&&(e=e[0]),Ht(e))r=e;else{var n=e.toString();if(/^\d{4}$/.test(n)&&(r=[n+"-01-01",n+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(n)){var i=this.getDateInfo(n),a=i.date;a.setMonth(a.getMonth()+1);var l=this.getNextNDay(a,-1);r=[i.formatedDate,l.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(n)&&(r=[n,n])}if(!r)return e;var c=this._getRangeInfo(r);return c.start.time>c.end.time&&r.reverse(),r},t.prototype._getRangeInfo=function(e){var r=[this.getDateInfo(e[0]),this.getDateInfo(e[1])],n;r[0].time>r[1].time&&(n=!0,r.reverse());var i=Math.floor(r[1].time/gR)-Math.floor(r[0].time/gR)+1,a=new Date(r[0].time),l=a.getDate(),c=r[1].date.getDate();a.setDate(l+i-1);var o=a.getDate();if(o!==c)for(var d=a.getTime()-r[1].time>0?1:-1;(o=a.getDate())!==c&&(a.getTime()-r[1].time)*d>0;)i-=d,a.setDate(o-d);var g=Math.floor((i+r[0].day+6)/7),m=n?-g+1:g-1;return n&&r.reverse(),{range:[r[0].formatedDate,r[1].formatedDate],start:r[0],end:r[1],allDay:i,weeks:g,nthWeek:m,fweek:r[0].day,lweek:r[1].day}},t.prototype._getDateByWeeksAndDay=function(e,r,n){var i=this._getRangeInfo(n);if(e>i.weeks||e===0&&r<i.fweek||e===i.weeks&&r>i.lweek)return null;var a=(e-1)*7-i.fweek+r,l=new Date(i.start.time);return l.setDate(+i.start.d+a),this.getDateInfo(l)},t.create=function(e,r){var n=[];return e.eachComponent("calendar",function(i){var a=new t(i);n.push(a),i.coordinateSystem=a}),e.eachSeries(function(i){i.get("coordinateSystem")==="calendar"&&(i.coordinateSystem=n[i.get("calendarIndex")||0])}),n},t.dimensions=["time","value"],t}();function qj(t){var e=t.calendarModel,r=t.seriesModel,n=e?e.coordinateSystem:r?r.coordinateSystem:null;return n}function WOe(t){t.registerComponentModel($Oe),t.registerComponentView(HOe),t.registerCoordinateSystem("calendar",jOe)}function ZOe(t,e){var r=t.existing;if(e.id=t.keyInfo.id,!e.type&&r&&(e.type=r.type),e.parentId==null){var n=e.parentOption;n?e.parentId=n.id:r&&(e.parentId=r.parentId)}e.parentOption=null}function Yj(t,e){var r;return fe(e,function(n){t[n]!=null&&t[n]!=="auto"&&(r=!0)}),r}function qOe(t,e,r){var n=Lt({},r),i=t[e],a=r.$action||"merge";a==="merge"?i?(pn(i,n,!0),_d(i,n,{ignoreSize:!0}),sX(r,i),dA(r,i),dA(r,i,"shape"),dA(r,i,"style"),dA(r,i,"extra"),r.clipPath=i.clipPath):t[e]=n:a==="replace"?t[e]=n:a==="remove"&&i&&(t[e]=null)}var gee=["transition","enterFrom","leaveTo"],YOe=gee.concat(["enterAnimation","updateAnimation","leaveAnimation"]);function dA(t,e,r){if(r&&(!t[r]&&e[r]&&(t[r]={}),t=t[r],e=e[r]),!(!t||!e))for(var n=r?gee:YOe,i=0;i<n.length;i++){var a=n[i];t[a]==null&&e[a]!=null&&(t[a]=e[a])}}function XOe(t,e){if(t&&(t.hv=e.hv=[Yj(e,["left","right"]),Yj(e,["top","bottom"])],t.type==="group")){var r=t,n=e;r.width==null&&(r.width=n.width=0),r.height==null&&(r.height=n.height=0)}}var QOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.preventAutoZ=!0,r}return e.prototype.mergeOption=function(r,n){var i=this.option.elements;this.option.elements=null,t.prototype.mergeOption.call(this,r,n),this.option.elements=i},e.prototype.optionUpdated=function(r,n){var i=this.option,a=(n?i:r).elements,l=i.elements=n?[]:i.elements,c=[];this._flatten(a,c,null);var o=tY(l,c,"normalMerge"),d=this._elOptionsToUpdate=[];fe(o,function(g,m){var y=g.newOption;y&&(d.push(y),ZOe(g,y),qOe(l,m,y),XOe(l[m],y))},this),i.elements=Ei(l,function(g){return g&&delete g.$action,g!=null})},e.prototype._flatten=function(r,n,i){fe(r,function(a){if(a){i&&(a.parentOption=i),n.push(a);var l=a.children;l&&l.length&&this._flatten(l,n,a),delete a.children}},this)},e.prototype.useElOptionsToUpdate=function(){var r=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,r},e.type="graphic",e.defaultOption={elements:[]},e}($n),Xj={path:null,compoundPath:null,group:jr,image:fo,text:ti},Sl=ri(),KOe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(){this._elMap=Ir()},e.prototype.render=function(r,n,i){r!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=r,this._updateElements(r),this._relocate(r,i)},e.prototype._updateElements=function(r){var n=r.useElOptionsToUpdate();if(n){var i=this._elMap,a=this.group,l=r.get("z"),c=r.get("zlevel");fe(n,function(o){var d=za(o.id,null),g=d!=null?i.get(d):null,m=za(o.parentId,null),y=m!=null?i.get(m):a,x=o.type,A=o.style;x==="text"&&A&&o.hv&&o.hv[1]&&(A.textVerticalAlign=A.textBaseline=A.verticalAlign=A.align=null);var M=o.textContent,D=o.textConfig;if(A&&YJ(A,x,!!D,!!M)){var P=XJ(A,x,!0);!D&&P.textConfig&&(D=o.textConfig=P.textConfig),!M&&P.textContent&&(M=P.textContent)}var O=JOe(o),z=o.$action||"merge",V=z==="merge",H=z==="replace";if(V){var $=!g,X=g;$?X=Qj(d,y,o.type,i):(X&&(Sl(X).isNew=!1),eee(X)),X&&(QA(X,O,r,{isInit:$}),Kj(X,o,l,c))}else if(H){eC(g,o,i,r);var W=Qj(d,y,o.type,i);W&&(QA(W,O,r,{isInit:!0}),Kj(W,o,l,c))}else z==="remove"&&(KJ(g,o),eC(g,o,i,r));var Y=i.get(d);if(Y&&M)if(V){var J=Y.getTextContent();J?J.attr(M):Y.setTextContent(new ti(M))}else H&&Y.setTextContent(new ti(M));if(Y){var re=o.clipPath;if(re){var ae=re.type,pe=void 0,$=!1;if(V){var de=Y.getClipPath();$=!de||Sl(de).type!==ae,pe=$?jO(ae):de}else H&&($=!0,pe=jO(ae));Y.setClipPath(pe),QA(pe,re,r,{isInit:$}),aM(pe,re.keyframeAnimation,r)}var ve=Sl(Y);Y.setTextConfig(D),ve.option=o,e3e(Y,r,o),uy({el:Y,componentModel:r,itemName:Y.name,itemTooltipOption:o.tooltip}),aM(Y,o.keyframeAnimation,r)}})}},e.prototype._relocate=function(r,n){for(var i=r.option.elements,a=this.group,l=this._elMap,c=n.getWidth(),o=n.getHeight(),d=["x","y"],g=0;g<i.length;g++){var m=i[g],y=za(m.id,null),x=y!=null?l.get(y):null;if(!(!x||!x.isGroup)){var A=x.parent,M=A===a,D=Sl(x),P=Sl(A);D.width=dr(D.option.width,M?c:P.width)||0,D.height=dr(D.option.height,M?o:P.height)||0}}for(var g=i.length-1;g>=0;g--){var m=i[g],y=za(m.id,null),x=y!=null?l.get(y):null;if(x){var A=x.parent,P=Sl(A),O=A===a?{width:c,height:o}:{width:P.width,height:P.height},z={},V=xI(x,m,O,null,{hv:m.hv,boundingMode:m.bounding},z);if(!Sl(x).isNew&&V){for(var H=m.transition,$={},X=0;X<d.length;X++){var W=d[X],Y=z[W];H&&(jg(H)||An(H,W)>=0)?$[W]=Y:x[W]=Y}li(x,$,r,0)}else x.attr(z)}}},e.prototype._clear=function(){var r=this,n=this._elMap;n.each(function(i){eC(i,Sl(i).option,n,r._lastGraphicModel)}),this._elMap=Ir()},e.prototype.dispose=function(){this._clear()},e.type="graphic",e}(ra);function jO(t){var e=Cr(Xj,t)?Xj[t]:Hz(t),r=new e({});return Sl(r).type=t,r}function Qj(t,e,r,n){var i=jO(r);return e.add(i),n.set(t,i),Sl(i).id=t,Sl(i).isNew=!0,i}function eC(t,e,r,n){var i=t&&t.parent;i&&(t.type==="group"&&t.traverse(function(a){eC(a,e,r,n)}),OI(t,e,n),r.removeKey(Sl(t).id))}function Kj(t,e,r,n){t.isGroup||fe([["cursor",zl.prototype.cursor],["zlevel",n||0],["z",r||0],["z2",0]],function(i){var a=i[0];Cr(e,a)?t[a]=tn(e[a],i[1]):t[a]==null&&(t[a]=i[1])}),fe(Hn(e),function(i){if(i.indexOf("on")===0){var a=e[i];t[i]=zr(a)?a:null}}),Cr(e,"draggable")&&(t.draggable=e.draggable),e.name!=null&&(t.name=e.name),e.id!=null&&(t.id=e.id)}function JOe(t){return t=Lt({},t),fe(["id","parentId","$action","hv","bounding","textContent","clipPath"].concat(oX),function(e){delete t[e]}),t}function e3e(t,e,r){var n=Yr(t).eventData;!t.silent&&!t.ignore&&!n&&(n=Yr(t).eventData={componentType:"graphic",componentIndex:e.componentIndex,name:t.name}),n&&(n.info=r.info)}function t3e(t){t.registerComponentModel(QOe),t.registerComponentView(KOe),t.registerPreprocessor(function(e){var r=e.graphic;Ht(r)?!r[0]||!r[0].elements?e.graphic=[{elements:r}]:e.graphic=[e.graphic[0]]:r&&!r.elements&&(e.graphic=[{elements:[r]}])})}var Jj=["x","y","radius","angle","single"],r3e=["cartesian2d","polar","singleAxis"];function n3e(t){var e=t.get("coordinateSystem");return An(r3e,e)>=0}function nd(t){return t+"Axis"}function i3e(t,e){var r=Ir(),n=[],i=Ir();t.eachComponent({mainType:"dataZoom",query:e},function(g){i.get(g.uid)||c(g)});var a;do a=!1,t.eachComponent("dataZoom",l);while(a);function l(g){!i.get(g.uid)&&o(g)&&(c(g),a=!0)}function c(g){i.set(g.uid,!0),n.push(g),d(g)}function o(g){var m=!1;return g.eachTargetAxis(function(y,x){var A=r.get(y);A&&A[x]&&(m=!0)}),m}function d(g){g.eachTargetAxis(function(m,y){(r.get(m)||r.set(m,[]))[y]=!0})}return n}function vee(t){var e=t.ecModel,r={infoList:[],infoMap:Ir()};return t.eachTargetAxis(function(n,i){var a=e.getComponent(nd(n),i);if(a){var l=a.getCoordSysModel();if(l){var c=l.uid,o=r.infoMap.get(c);o||(o={model:l,axisModels:[]},r.infoList.push(o),r.infoMap.set(c,o)),o.axisModels.push(a)}}}),r}var vR=function(){function t(){this.indexList=[],this.indexMap=[]}return t.prototype.add=function(e){this.indexMap[e]||(this.indexList.push(e),this.indexMap[e]=!0)},t}(),ub=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._autoThrottle=!0,r._noTarget=!0,r._rangePropMode=["percent","percent"],r}return e.prototype.init=function(r,n,i){var a=e9(r);this.settledOption=a,this.mergeDefaultAndTheme(r,i),this._doInit(a)},e.prototype.mergeOption=function(r){var n=e9(r);pn(this.option,r,!0),pn(this.settledOption,n,!0),this._doInit(n)},e.prototype._doInit=function(r){var n=this.option;this._setDefaultThrottle(r),this._updateRangeUse(r);var i=this.settledOption;fe([["start","startValue"],["end","endValue"]],function(a,l){this._rangePropMode[l]==="value"&&(n[a[0]]=i[a[0]]=null)},this),this._resetTarget()},e.prototype._resetTarget=function(){var r=this.get("orient",!0),n=this._targetAxisInfoMap=Ir(),i=this._fillSpecifiedTargetAxis(n);i?this._orient=r||this._makeAutoOrientByTargetAxis():(this._orient=r||"horizontal",this._fillAutoTargetAxisByOrient(n,this._orient)),this._noTarget=!0,n.each(function(a){a.indexList.length&&(this._noTarget=!1)},this)},e.prototype._fillSpecifiedTargetAxis=function(r){var n=!1;return fe(Jj,function(i){var a=this.getReferringComponents(nd(i),Wxe);if(a.specified){n=!0;var l=new vR;fe(a.models,function(c){l.add(c.componentIndex)}),r.set(i,l)}},this),n},e.prototype._fillAutoTargetAxisByOrient=function(r,n){var i=this.ecModel,a=!0;if(a){var l=n==="vertical"?"y":"x",c=i.findComponents({mainType:l+"Axis"});o(c,l)}if(a){var c=i.findComponents({mainType:"singleAxis",filter:function(g){return g.get("orient",!0)===n}});o(c,"single")}function o(d,g){var m=d[0];if(m){var y=new vR;if(y.add(m.componentIndex),r.set(g,y),a=!1,g==="x"||g==="y"){var x=m.getReferringComponents("grid",Ma).models[0];x&&fe(d,function(A){m.componentIndex!==A.componentIndex&&x===A.getReferringComponents("grid",Ma).models[0]&&y.add(A.componentIndex)})}}}a&&fe(Jj,function(d){if(a){var g=i.findComponents({mainType:nd(d),filter:function(y){return y.get("type",!0)==="category"}});if(g[0]){var m=new vR;m.add(g[0].componentIndex),r.set(d,m),a=!1}}},this)},e.prototype._makeAutoOrientByTargetAxis=function(){var r;return this.eachTargetAxis(function(n){!r&&(r=n)},this),r==="y"?"vertical":"horizontal"},e.prototype._setDefaultThrottle=function(r){if(r.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var n=this.ecModel.option;this.option.throttle=n.animation&&n.animationDurationUpdate>0?100:20}},e.prototype._updateRangeUse=function(r){var n=this._rangePropMode,i=this.get("rangeMode");fe([["start","startValue"],["end","endValue"]],function(a,l){var c=r[a[0]]!=null,o=r[a[1]]!=null;c&&!o?n[l]="percent":!c&&o?n[l]="value":i?n[l]=i[l]:c&&(n[l]="percent")})},e.prototype.noTarget=function(){return this._noTarget},e.prototype.getFirstTargetAxisModel=function(){var r;return this.eachTargetAxis(function(n,i){r==null&&(r=this.ecModel.getComponent(nd(n),i))},this),r},e.prototype.eachTargetAxis=function(r,n){this._targetAxisInfoMap.each(function(i,a){fe(i.indexList,function(l){r.call(n,a,l)})})},e.prototype.getAxisProxy=function(r,n){var i=this.getAxisModel(r,n);if(i)return i.__dzAxisProxy},e.prototype.getAxisModel=function(r,n){var i=this._targetAxisInfoMap.get(r);if(i&&i.indexMap[n])return this.ecModel.getComponent(nd(r),n)},e.prototype.setRawRange=function(r){var n=this.option,i=this.settledOption;fe([["start","startValue"],["end","endValue"]],function(a){(r[a[0]]!=null||r[a[1]]!=null)&&(n[a[0]]=i[a[0]]=r[a[0]],n[a[1]]=i[a[1]]=r[a[1]])},this),this._updateRangeUse(r)},e.prototype.setCalculatedRange=function(r){var n=this.option;fe(["start","startValue","end","endValue"],function(i){n[i]=r[i]})},e.prototype.getPercentRange=function(){var r=this.findRepresentativeAxisProxy();if(r)return r.getDataPercentWindow()},e.prototype.getValueRange=function(r,n){if(r==null&&n==null){var i=this.findRepresentativeAxisProxy();if(i)return i.getDataValueWindow()}else return this.getAxisProxy(r,n).getDataValueWindow()},e.prototype.findRepresentativeAxisProxy=function(r){if(r)return r.__dzAxisProxy;for(var n,i=this._targetAxisInfoMap.keys(),a=0;a<i.length;a++)for(var l=i[a],c=this._targetAxisInfoMap.get(l),o=0;o<c.indexList.length;o++){var d=this.getAxisProxy(l,c.indexList[o]);if(d.hostedBy(this))return d;n||(n=d)}return n},e.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},e.prototype.getOrient=function(){return this._orient},e.type="dataZoom",e.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],e.defaultOption={z:4,filterMode:"filter",start:0,end:100},e}($n);function e9(t){var e={};return fe(["start","end","startValue","endValue","throttle"],function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e}var a3e=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="dataZoom.select",e}(ub),d5=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i,a){this.dataZoomModel=r,this.ecModel=n,this.api=i},e.type="dataZoom",e}(ra),o3e=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="dataZoom.select",e}(d5),p_=fe,t9=El,s3e=function(){function t(e,r,n,i){this._dimName=e,this._axisIndex=r,this.ecModel=i,this._dataZoomModel=n}return t.prototype.hostedBy=function(e){return this._dataZoomModel===e},t.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},t.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},t.prototype.getTargetSeriesModels=function(){var e=[];return this.ecModel.eachSeries(function(r){if(n3e(r)){var n=nd(this._dimName),i=r.getReferringComponents(n,Ma).models[0];i&&this._axisIndex===i.componentIndex&&e.push(r)}},this),e},t.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},t.prototype.getMinMaxSpan=function(){return $r(this._minMaxSpan)},t.prototype.calculateDataWindow=function(e){var r=this._dataExtent,n=this.getAxisModel(),i=n.axis.scale,a=this._dataZoomModel.getRangePropMode(),l=[0,100],c=[],o=[],d;p_(["start","end"],function(y,x){var A=e[y],M=e[y+"Value"];a[x]==="percent"?(A==null&&(A=l[x]),M=i.parse(Ci(A,l,r))):(d=!0,M=M==null?r[x]:i.parse(M),A=Ci(M,r,l)),o[x]=M==null||isNaN(M)?r[x]:M,c[x]=A==null||isNaN(A)?l[x]:A}),t9(o),t9(c);var g=this._minMaxSpan;d?m(o,c,r,l,!1):m(c,o,l,r,!0);function m(y,x,A,M,D){var P=D?"Span":"ValueSpan";mv(0,y,A,"all",g["min"+P],g["max"+P]);for(var O=0;O<2;O++)x[O]=Ci(y[O],A,M,!0),D&&(x[O]=i.parse(x[O]))}return{valueWindow:o,percentWindow:c}},t.prototype.reset=function(e){if(e===this._dataZoomModel){var r=this.getTargetSeriesModels();this._dataExtent=l3e(this,this._dimName,r),this._updateMinMaxSpan();var n=this.calculateDataWindow(e.settledOption);this._valueWindow=n.valueWindow,this._percentWindow=n.percentWindow,this._setAxisModel()}},t.prototype.filterData=function(e,r){if(e!==this._dataZoomModel)return;var n=this._dimName,i=this.getTargetSeriesModels(),a=e.get("filterMode"),l=this._valueWindow;if(a==="none")return;p_(i,function(o){var d=o.getData(),g=d.mapDimensionsAll(n);if(g.length){if(a==="weakFilter"){var m=d.getStore(),y=Zt(g,function(x){return d.getDimensionIndex(x)},d);d.filterSelf(function(x){for(var A,M,D,P=0;P<g.length;P++){var O=m.get(y[P],x),z=!isNaN(O),V=O<l[0],H=O>l[1];if(z&&!V&&!H)return!0;z&&(D=!0),V&&(A=!0),H&&(M=!0)}return D&&A&&M})}else p_(g,function(x){if(a==="empty")o.setData(d=d.map(x,function(M){return c(M)?M:NaN}));else{var A={};A[x]=l,d.selectRange(A)}});p_(g,function(x){d.setApproximateExtent(l,x)})}});function c(o){return o>=l[0]&&o<=l[1]}},t.prototype._updateMinMaxSpan=function(){var e=this._minMaxSpan={},r=this._dataZoomModel,n=this._dataExtent;p_(["min","max"],function(i){var a=r.get(i+"Span"),l=r.get(i+"ValueSpan");l!=null&&(l=this.getAxisModel().axis.scale.parse(l)),l!=null?a=Ci(n[0]+l,n,[0,100],!0):a!=null&&(l=Ci(a,[0,100],n,!0)-n[0]),e[i+"Span"]=a,e[i+"ValueSpan"]=l},this)},t.prototype._setAxisModel=function(){var e=this.getAxisModel(),r=this._percentWindow,n=this._valueWindow;if(r){var i=Z2(n,[0,500]);i=Math.min(i,20);var a=e.axis.scale.rawExtentInfo;r[0]!==0&&a.setDeterminedMinMax("min",+n[0].toFixed(i)),r[1]!==100&&a.setDeterminedMinMax("max",+n[1].toFixed(i)),a.freeze()}},t}();function l3e(t,e,r){var n=[1/0,-1/0];p_(r,function(l){VAe(n,l.getData(),e)});var i=t.getAxisModel(),a=OQ(i.axis.scale,i,n).calculate();return[a.min,a.max]}var u3e={getTargetSeries:function(t){function e(i){t.eachComponent("dataZoom",function(a){a.eachTargetAxis(function(l,c){var o=t.getComponent(nd(l),c);i(l,c,o,a)})})}e(function(i,a,l,c){l.__dzAxisProxy=null});var r=[];e(function(i,a,l,c){l.__dzAxisProxy||(l.__dzAxisProxy=new s3e(i,a,c,t),r.push(l.__dzAxisProxy))});var n=Ir();return fe(r,function(i){fe(i.getTargetSeriesModels(),function(a){n.set(a.uid,a)})}),n},overallReset:function(t,e){t.eachComponent("dataZoom",function(r){r.eachTargetAxis(function(n,i){r.getAxisProxy(n,i).reset(r)}),r.eachTargetAxis(function(n,i){r.getAxisProxy(n,i).filterData(r,e)})}),t.eachComponent("dataZoom",function(r){var n=r.findRepresentativeAxisProxy();if(n){var i=n.getDataPercentWindow(),a=n.getDataValueWindow();r.setCalculatedRange({start:i[0],end:i[1],startValue:a[0],endValue:a[1]})}})}};function c3e(t){t.registerAction("dataZoom",function(e,r){var n=i3e(r,e);fe(n,function(i){i.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})})}var r9=!1;function p5(t){r9||(r9=!0,t.registerProcessor(t.PRIORITY.PROCESSOR.FILTER,u3e),c3e(t),t.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function h3e(t){t.registerComponentModel(a3e),t.registerComponentView(o3e),p5(t)}var Al=function(){function t(){}return t}(),mee={};function g_(t,e){mee[t]=e}function _ee(t){return mee[t]}var f3e=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.optionUpdated=function(){t.prototype.optionUpdated.apply(this,arguments);var r=this.ecModel;fe(this.option.feature,function(n,i){var a=_ee(i);a&&(a.getDefaultOption&&(a.defaultOption=a.getDefaultOption(r)),pn(n,a.defaultOption))})},e.type="toolbox",e.layoutMode={type:"box",ignoreSize:!0},e.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},e}($n);function d3e(t,e,r){var n=e.getBoxLayoutParams(),i=e.get("padding"),a={width:r.getWidth(),height:r.getHeight()},l=Na(n,a,i);$g(e.get("orient"),t,e.get("itemGap"),l.width,l.height),xI(t,n,a,i)}function yee(t,e){var r=fy(e.get("padding")),n=e.getItemStyle(["color","opacity"]);return n.fill=e.get("backgroundColor"),t=new Kn({shape:{x:t.x-r[3],y:t.y-r[0],width:t.width+r[1]+r[3],height:t.height+r[0]+r[2],r:e.get("borderRadius")},style:n,silent:!0,z2:-1}),t}var p3e=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(r,n,i,a){var l=this.group;if(l.removeAll(),!r.get("show"))return;var c=+r.get("itemSize"),o=r.get("orient")==="vertical",d=r.get("feature")||{},g=this._features||(this._features={}),m=[];fe(d,function(A,M){m.push(M)}),new mh(this._featureNames||[],m).add(y).update(y).remove(on(y,null)).execute(),this._featureNames=m;function y(A,M){var D=m[A],P=m[M],O=d[D],z=new bi(O,r,r.ecModel),V;if(a&&a.newTitle!=null&&a.featureName===D&&(O.title=a.newTitle),D&&!P){if(g3e(D))V={onclick:z.option.onclick,featureName:D};else{var H=_ee(D);if(!H)return;V=new H}g[D]=V}else if(V=g[P],!V)return;V.uid=hy("toolbox-feature"),V.model=z,V.ecModel=n,V.api=i;var $=V instanceof Al;if(!D&&P){$&&V.dispose&&V.dispose(n,i);return}if(!z.get("show")||$&&V.unusable){$&&V.remove&&V.remove(n,i);return}x(z,V,D),z.setIconStatus=function(X,W){var Y=this.option,J=this.iconPaths;Y.iconStatus=Y.iconStatus||{},Y.iconStatus[X]=W,J[X]&&(W==="emphasis"?gh:vh)(J[X])},V instanceof Al&&V.render&&V.render(z,n,i,a)}function x(A,M,D){var P=A.getModel("iconStyle"),O=A.getModel(["emphasis","iconStyle"]),z=M instanceof Al&&M.getIcons?M.getIcons():A.get("icon"),V=A.get("title")||{},H,$;yr(z)?(H={},H[D]=z):H=z,yr(V)?($={},$[D]=V):$=V;var X=A.iconPaths={};fe(H,function(W,Y){var J=Eb(W,{},{x:-c/2,y:-c/2,width:c,height:c});J.setStyle(P.getItemStyle());var re=J.ensureState("emphasis");re.style=O.getItemStyle();var ae=new ti({style:{text:$[Y],align:O.get("textAlign"),borderRadius:O.get("textBorderRadius"),padding:O.get("textPadding"),fill:null,font:jz({fontStyle:O.get("textFontStyle"),fontFamily:O.get("textFontFamily"),fontSize:O.get("textFontSize"),fontWeight:O.get("textFontWeight")},n)},ignore:!0});J.setTextContent(ae),uy({el:J,componentModel:r,itemName:Y,formatterParamsExtra:{title:$[Y]}}),J.__title=$[Y],J.on("mouseover",function(){var pe=O.getItemStyle(),de=o?r.get("right")==null&&r.get("left")!=="right"?"right":"left":r.get("bottom")==null&&r.get("top")!=="bottom"?"bottom":"top";ae.setStyle({fill:O.get("textFill")||pe.fill||pe.stroke||"#000",backgroundColor:O.get("textBackgroundColor")}),J.setTextConfig({position:O.get("textPosition")||de}),ae.ignore=!r.get("showTitle"),i.enterEmphasis(this)}).on("mouseout",function(){A.get(["iconStatus",Y])!=="emphasis"&&i.leaveEmphasis(this),ae.hide()}),(A.get(["iconStatus",Y])==="emphasis"?gh:vh)(J),l.add(J),J.on("click",wr(M.onclick,M,n,i,Y)),X[Y]=J})}d3e(l,r,i),l.add(yee(l.getBoundingRect(),r)),o||l.eachChild(function(A){var M=A.__title,D=A.ensureState("emphasis"),P=D.textConfig||(D.textConfig={}),O=A.getTextContent(),z=O&&O.ensureState("emphasis");if(z&&!zr(z)&&M){var V=z.style||(z.style={}),H=Sb(M,ti.makeFont(V)),$=A.x+l.x,X=A.y+l.y+c,W=!1;X+H.height>i.getHeight()&&(P.position="top",W=!0);var Y=W?-5-H.height:c+10;$+H.width/2>i.getWidth()?(P.position=["100%",Y],V.align="right"):$-H.width/2<0&&(P.position=[0,Y],V.align="left")}})},e.prototype.updateView=function(r,n,i,a){fe(this._features,function(l){l instanceof Al&&l.updateView&&l.updateView(l.model,n,i,a)})},e.prototype.remove=function(r,n){fe(this._features,function(i){i instanceof Al&&i.remove&&i.remove(r,n)}),this.group.removeAll()},e.prototype.dispose=function(r,n){fe(this._features,function(i){i instanceof Al&&i.dispose&&i.dispose(r,n)})},e.type="toolbox",e}(ra);function g3e(t){return t.indexOf("my")===0}var v3e=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.onclick=function(r,n){var i=this.model,a=i.get("name")||r.get("title.0.text")||"echarts",l=n.getZr().painter.getType()==="svg",c=l?"svg":i.get("type",!0)||"png",o=n.getConnectedDataURL({type:c,backgroundColor:i.get("backgroundColor",!0)||r.get("backgroundColor")||"#fff",connectedBackgroundColor:i.get("connectedBackgroundColor"),excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")}),d=Nn.browser;if(zr(MouseEvent)&&(d.newEdge||!d.ie&&!d.edge)){var g=document.createElement("a");g.download=a+"."+c,g.target="_blank",g.href=o;var m=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});g.dispatchEvent(m)}else if(window.navigator.msSaveOrOpenBlob||l){var y=o.split(","),x=y[0].indexOf("base64")>-1,A=l?decodeURIComponent(y[1]):y[1];x&&(A=window.atob(A));var M=a+"."+c;if(window.navigator.msSaveOrOpenBlob){for(var D=A.length,P=new Uint8Array(D);D--;)P[D]=A.charCodeAt(D);var O=new Blob([P]);window.navigator.msSaveOrOpenBlob(O,M)}else{var z=document.createElement("iframe");document.body.appendChild(z);var V=z.contentWindow,H=V.document;H.open("image/svg+xml","replace"),H.write(A),H.close(),V.focus(),H.execCommand("SaveAs",!0,M),document.body.removeChild(z)}}else{var $=i.get("lang"),X='<body style="margin:0;"><img src="'+o+'" style="max-width:100%;" title="'+($&&$[0]||"")+'" /></body>',W=window.open();W.document.write(X),W.document.title=a}},e.getDefaultOption=function(r){var n={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:r.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:r.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return n},e}(Al),n9="__ec_magicType_stack__",m3e=[["line","bar"],["stack"]],_3e=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getIcons=function(){var r=this.model,n=r.get("icon"),i={};return fe(r.get("type"),function(a){n[a]&&(i[a]=n[a])}),i},e.getDefaultOption=function(r){var n={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:r.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return n},e.prototype.onclick=function(r,n,i){var a=this.model,l=a.get(["seriesIndex",i]);if(i9[i]){var c={series:[]},o=function(m){var y=m.subType,x=m.id,A=i9[i](y,x,m,a);A&&(Fr(A,m.option),c.series.push(A));var M=m.coordinateSystem;if(M&&M.type==="cartesian2d"&&(i==="line"||i==="bar")){var D=M.getAxesByScale("ordinal")[0];if(D){var P=D.dim,O=P+"Axis",z=m.getReferringComponents(O,Ma).models[0],V=z.componentIndex;c[O]=c[O]||[];for(var H=0;H<=V;H++)c[O][V]=c[O][V]||{};c[O][V].boundaryGap=i==="bar"}}};fe(m3e,function(m){An(m,i)>=0&&fe(m,function(y){a.setIconStatus(y,"normal")})}),a.setIconStatus(i,"emphasis"),r.eachComponent({mainType:"series",query:l==null?null:{seriesIndex:l}},o);var d,g=i;i==="stack"&&(d=pn({stack:a.option.title.tiled,tiled:a.option.title.stack},a.option.title),a.get(["iconStatus",i])!=="emphasis"&&(g="tiled")),n.dispatchAction({type:"changeMagicType",currentType:g,newOption:c,newTitle:d,featureName:"magicType"})}},e}(Al),i9={line:function(t,e,r,n){if(t==="bar")return pn({id:e,type:"line",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},n.get(["option","line"])||{},!0)},bar:function(t,e,r,n){if(t==="line")return pn({id:e,type:"bar",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},n.get(["option","bar"])||{},!0)},stack:function(t,e,r,n){var i=r.get("stack")===n9;if(t==="line"||t==="bar")return n.setIconStatus("stack",i?"normal":"emphasis"),pn({id:e,stack:i?"":n9},n.get(["option","stack"])||{},!0)}};_c({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(t,e){e.mergeOption(t.newOption)});var zI=new Array(60).join("-"),Q_="	";function y3e(t){var e={},r=[],n=[];return t.eachRawSeries(function(i){var a=i.coordinateSystem;if(a&&(a.type==="cartesian2d"||a.type==="polar")){var l=a.getBaseAxis();if(l.type==="category"){var c=l.dim+"_"+l.index;e[c]||(e[c]={categoryAxis:l,valueAxis:a.getOtherAxis(l),series:[]},n.push({axisDim:l.dim,axisIndex:l.index})),e[c].series.push(i)}else r.push(i)}else r.push(i)}),{seriesGroupByCategoryAxis:e,other:r,meta:n}}function x3e(t){var e=[];return fe(t,function(r,n){var i=r.categoryAxis,a=r.valueAxis,l=a.dim,c=[" "].concat(Zt(r.series,function(x){return x.name})),o=[i.model.getCategories()];fe(r.series,function(x){var A=x.getRawData();o.push(x.getRawData().mapArray(A.mapDimension(l),function(M){return M}))});for(var d=[c.join(Q_)],g=0;g<o[0].length;g++){for(var m=[],y=0;y<o.length;y++)m.push(o[y][g]);d.push(m.join(Q_))}e.push(d.join(`
`))}),e.join(`

`+zI+`

`)}function b3e(t){return Zt(t,function(e){var r=e.getRawData(),n=[e.name],i=[];return r.each(r.dimensions,function(){for(var a=arguments.length,l=arguments[a-1],c=r.getName(l),o=0;o<a-1;o++)i[o]=arguments[o];n.push((c?c+Q_:"")+i.join(Q_))}),n.join(`
`)}).join(`

`+zI+`

`)}function w3e(t){var e=y3e(t);return{value:Ei([x3e(e.seriesGroupByCategoryAxis),b3e(e.other)],function(r){return!!r.replace(/[\n\t\s]/g,"")}).join(`

`+zI+`

`),meta:e.meta}}function lM(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function S3e(t){var e=t.slice(0,t.indexOf(`
`));if(e.indexOf(Q_)>=0)return!0}var WO=new RegExp("["+Q_+"]+","g");function T3e(t){for(var e=t.split(/\n+/g),r=lM(e.shift()).split(WO),n=[],i=Zt(r,function(o){return{name:o,data:[]}}),a=0;a<e.length;a++){var l=lM(e[a]).split(WO);n.push(l.shift());for(var c=0;c<l.length;c++)i[c]&&(i[c].data[a]=l[c])}return{series:i,categories:n}}function A3e(t){for(var e=t.split(/\n+/g),r=lM(e.shift()),n=[],i=0;i<e.length;i++){var a=lM(e[i]);if(a){var l=a.split(WO),c="",o=void 0,d=!1;isNaN(l[0])?(d=!0,c=l[0],l=l.slice(1),n[i]={name:c,value:[]},o=n[i].value):o=n[i]=[];for(var g=0;g<l.length;g++)o.push(+l[g]);o.length===1&&(d?n[i].value=o[0]:n[i]=o[0])}}return{name:r,data:n}}function C3e(t,e){var r=t.split(new RegExp(`
*`+zI+`
*`,"g")),n={series:[]};return fe(r,function(i,a){if(S3e(i)){var l=T3e(i),c=e[a],o=c.axisDim+"Axis";c&&(n[o]=n[o]||[],n[o][c.axisIndex]={data:l.categories},n.series=n.series.concat(l.series))}else{var l=A3e(i);n.series.push(l)}}),n}var M3e=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.onclick=function(r,n){setTimeout(function(){n.dispatchAction({type:"hideTip"})});var i=n.getDom(),a=this.model;this._dom&&i.removeChild(this._dom);var l=document.createElement("div");l.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",l.style.backgroundColor=a.get("backgroundColor")||"#fff";var c=document.createElement("h4"),o=a.get("lang")||[];c.innerHTML=o[0]||a.get("title"),c.style.cssText="margin:10px 20px",c.style.color=a.get("textColor");var d=document.createElement("div"),g=document.createElement("textarea");d.style.cssText="overflow:auto";var m=a.get("optionToContent"),y=a.get("contentToOption"),x=w3e(r);if(zr(m)){var A=m(n.getOption());yr(A)?d.innerHTML=A:G_(A)&&d.appendChild(A)}else{g.readOnly=a.get("readOnly");var M=g.style;M.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",M.color=a.get("textColor"),M.borderColor=a.get("textareaBorderColor"),M.backgroundColor=a.get("textareaColor"),g.value=x.value,d.appendChild(g)}var D=x.meta,P=document.createElement("div");P.style.cssText="position:absolute;bottom:5px;left:0;right:0";var O="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",z=document.createElement("div"),V=document.createElement("div");O+=";background-color:"+a.get("buttonColor"),O+=";color:"+a.get("buttonTextColor");var H=this;function $(){i.removeChild(l),H._dom=null}Ak(z,"click",$),Ak(V,"click",function(){if(y==null&&m!=null||y!=null&&m==null){$();return}var X;try{zr(y)?X=y(d,n.getOption()):X=C3e(g.value,D)}catch(W){throw $(),new Error("Data view format error "+W)}X&&n.dispatchAction({type:"changeDataView",newOption:X}),$()}),z.innerHTML=o[1],V.innerHTML=o[2],V.style.cssText=z.style.cssText=O,!a.get("readOnly")&&P.appendChild(V),P.appendChild(z),l.appendChild(c),l.appendChild(d),l.appendChild(P),d.style.height=i.clientHeight-80+"px",i.appendChild(l),this._dom=l},e.prototype.remove=function(r,n){this._dom&&n.getDom().removeChild(this._dom)},e.prototype.dispose=function(r,n){this.remove(r,n)},e.getDefaultOption=function(r){var n={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:r.getLocaleModel().get(["toolbox","dataView","title"]),lang:r.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return n},e}(Al);function I3e(t,e){return Zt(t,function(r,n){var i=e&&e[n];if(Ur(i)&&!Ht(i)){var a=Ur(r)&&!Ht(r);a||(r={value:r});var l=i.name!=null&&r.name==null;return r=Fr(r,i),l&&delete r.name,r}else return r})}_c({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(t,e){var r=[];fe(t.newOption.series,function(n){var i=e.getSeriesByName(n.name)[0];if(!i)r.push(Lt({type:"scatter"},n));else{var a=i.get("data");r.push({name:n.name,data:I3e(n.data,a)})}}),e.mergeOption(Fr({series:r},t.newOption))});var xee=fe,bee=ri();function E3e(t,e){var r=g5(t);xee(e,function(n,i){for(var a=r.length-1;a>=0;a--){var l=r[a];if(l[i])break}if(a<0){var c=t.queryComponents({mainType:"dataZoom",subType:"select",id:i})[0];if(c){var o=c.getPercentRange();r[0][i]={dataZoomId:i,start:o[0],end:o[1]}}}}),r.push(e)}function D3e(t){var e=g5(t),r=e[e.length-1];e.length>1&&e.pop();var n={};return xee(r,function(i,a){for(var l=e.length-1;l>=0;l--)if(i=e[l][a],i){n[a]=i;break}}),n}function P3e(t){bee(t).snapshots=null}function L3e(t){return g5(t).length}function g5(t){var e=bee(t);return e.snapshots||(e.snapshots=[{}]),e.snapshots}var R3e=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.onclick=function(r,n){P3e(r),n.dispatchAction({type:"restore",from:this.uid})},e.getDefaultOption=function(r){var n={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:r.getLocaleModel().get(["toolbox","restore","title"])};return n},e}(Al);_c({type:"restore",event:"restore",update:"prepareAndUpdate"},function(t,e){e.resetOption("recreate")});var k3e=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],v5=function(){function t(e,r,n){var i=this;this._targetInfoList=[];var a=a9(r,e);fe(O3e,function(l,c){(!n||!n.include||An(n.include,c)>=0)&&l(a,i._targetInfoList)})}return t.prototype.setOutputRanges=function(e,r){return this.matchOutputRanges(e,r,function(n,i,a){if((n.coordRanges||(n.coordRanges=[])).push(i),!n.coordRange){n.coordRange=i;var l=mR[n.brushType](0,a,i);n.__rangeOffset={offset:u9[n.brushType](l.values,n.range,[1,1]),xyMinMax:l.xyMinMax}}}),e},t.prototype.matchOutputRanges=function(e,r,n){fe(e,function(i){var a=this.findTargetInfo(i,r);a&&a!==!0&&fe(a.coordSyses,function(l){var c=mR[i.brushType](1,l,i.range,!0);n(i,c.values,l,r)})},this)},t.prototype.setInputRanges=function(e,r){fe(e,function(n){var i=this.findTargetInfo(n,r);if(n.range=n.range||[],i&&i!==!0){n.panelId=i.panelId;var a=mR[n.brushType](0,i.coordSys,n.coordRange),l=n.__rangeOffset;n.range=l?u9[n.brushType](a.values,l.offset,z3e(a.xyMinMax,l.xyMinMax)):a.values}},this)},t.prototype.makePanelOpts=function(e,r){return Zt(this._targetInfoList,function(n){var i=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:r?r(n):null,clipPath:EJ(i),isTargetByCursor:PJ(i,e,n.coordSysModel),getLinearBrushOtherExtent:DJ(i)}})},t.prototype.controlSeries=function(e,r,n){var i=this.findTargetInfo(e,n);return i===!0||i&&An(i.coordSyses,r.coordinateSystem)>=0},t.prototype.findTargetInfo=function(e,r){for(var n=this._targetInfoList,i=a9(r,e),a=0;a<n.length;a++){var l=n[a],c=e.panelId;if(c){if(l.panelId===c)return l}else for(var o=0;o<o9.length;o++)if(o9[o](i,l))return l}return!0},t}();function ZO(t){return t[0]>t[1]&&t.reverse(),t}function a9(t,e){return d1(t,e,{includeMainTypes:k3e})}var O3e={grid:function(t,e){var r=t.xAxisModels,n=t.yAxisModels,i=t.gridModels,a=Ir(),l={},c={};!r&&!n&&!i||(fe(r,function(o){var d=o.axis.grid.model;a.set(d.id,d),l[d.id]=!0}),fe(n,function(o){var d=o.axis.grid.model;a.set(d.id,d),c[d.id]=!0}),fe(i,function(o){a.set(o.id,o),l[o.id]=!0,c[o.id]=!0}),a.each(function(o){var d=o.coordinateSystem,g=[];fe(d.getCartesians(),function(m,y){(An(r,m.getAxis("x").model)>=0||An(n,m.getAxis("y").model)>=0)&&g.push(m)}),e.push({panelId:"grid--"+o.id,gridModel:o,coordSysModel:o,coordSys:g[0],coordSyses:g,getPanelRect:s9.grid,xAxisDeclared:l[o.id],yAxisDeclared:c[o.id]})}))},geo:function(t,e){fe(t.geoModels,function(r){var n=r.coordinateSystem;e.push({panelId:"geo--"+r.id,geoModel:r,coordSysModel:r,coordSys:n,coordSyses:[n],getPanelRect:s9.geo})})}},o9=[function(t,e){var r=t.xAxisModel,n=t.yAxisModel,i=t.gridModel;return!i&&r&&(i=r.axis.grid.model),!i&&n&&(i=n.axis.grid.model),i&&i===e.gridModel},function(t,e){var r=t.geoModel;return r&&r===e.geoModel}],s9={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var t=this.coordSys,e=t.getBoundingRect().clone();return e.applyTransform(Ug(t)),e}},mR={lineX:on(l9,0),lineY:on(l9,1),rect:function(t,e,r,n){var i=t?e.pointToData([r[0][0],r[1][0]],n):e.dataToPoint([r[0][0],r[1][0]],n),a=t?e.pointToData([r[0][1],r[1][1]],n):e.dataToPoint([r[0][1],r[1][1]],n),l=[ZO([i[0],a[0]]),ZO([i[1],a[1]])];return{values:l,xyMinMax:l}},polygon:function(t,e,r,n){var i=[[1/0,-1/0],[1/0,-1/0]],a=Zt(r,function(l){var c=t?e.pointToData(l,n):e.dataToPoint(l,n);return i[0][0]=Math.min(i[0][0],c[0]),i[1][0]=Math.min(i[1][0],c[1]),i[0][1]=Math.max(i[0][1],c[0]),i[1][1]=Math.max(i[1][1],c[1]),c});return{values:a,xyMinMax:i}}};function l9(t,e,r,n){var i=r.getAxis(["x","y"][t]),a=ZO(Zt([0,1],function(c){return e?i.coordToData(i.toLocalCoord(n[c]),!0):i.toGlobalCoord(i.dataToCoord(n[c]))})),l=[];return l[t]=a,l[1-t]=[NaN,NaN],{values:a,xyMinMax:l}}var u9={lineX:on(c9,0),lineY:on(c9,1),rect:function(t,e,r){return[[t[0][0]-r[0]*e[0][0],t[0][1]-r[0]*e[0][1]],[t[1][0]-r[1]*e[1][0],t[1][1]-r[1]*e[1][1]]]},polygon:function(t,e,r){return Zt(t,function(n,i){return[n[0]-r[0]*e[i][0],n[1]-r[1]*e[i][1]]})}};function c9(t,e,r,n){return[e[0]-n[t]*r[0],e[1]-n[t]*r[1]]}function z3e(t,e){var r=h9(t),n=h9(e),i=[r[0]/n[0],r[1]/n[1]];return isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i}function h9(t){return t?[t[0][1]-t[0][0],t[1][1]-t[1][0]]:[NaN,NaN]}var qO=fe,B3e=Gxe("toolbox-dataZoom_"),F3e=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(r,n,i,a){this._brushController||(this._brushController=new jB(i.getZr()),this._brushController.on("brush",wr(this._onBrush,this)).mount()),G3e(r,n,this,a,i),V3e(r,n)},e.prototype.onclick=function(r,n,i){N3e[i].call(this)},e.prototype.remove=function(r,n){this._brushController&&this._brushController.unmount()},e.prototype.dispose=function(r,n){this._brushController&&this._brushController.dispose()},e.prototype._onBrush=function(r){var n=r.areas;if(!r.isEnd||!n.length)return;var i={},a=this.ecModel;this._brushController.updateCovers([]);var l=new v5(m5(this.model),a,{include:["grid"]});l.matchOutputRanges(n,a,function(d,g,m){if(m.type==="cartesian2d"){var y=d.brushType;y==="rect"?(c("x",m,g[0]),c("y",m,g[1])):c({lineX:"x",lineY:"y"}[y],m,g)}}),E3e(a,i),this._dispatchZoomAction(i);function c(d,g,m){var y=g.getAxis(d),x=y.model,A=o(d,x,a),M=A.findRepresentativeAxisProxy(x).getMinMaxSpan();(M.minValueSpan!=null||M.maxValueSpan!=null)&&(m=mv(0,m.slice(),y.scale.getExtent(),0,M.minValueSpan,M.maxValueSpan)),A&&(i[A.id]={dataZoomId:A.id,startValue:m[0],endValue:m[1]})}function o(d,g,m){var y;return m.eachComponent({mainType:"dataZoom",subType:"select"},function(x){var A=x.getAxisModel(d,g.componentIndex);A&&(y=x)}),y}},e.prototype._dispatchZoomAction=function(r){var n=[];qO(r,function(i,a){n.push($r(i))}),n.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:n})},e.getDefaultOption=function(r){var n={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:r.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return n},e}(Al),N3e={zoom:function(){var t=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:t})},back:function(){this._dispatchZoomAction(D3e(this.ecModel))}};function m5(t){var e={xAxisIndex:t.get("xAxisIndex",!0),yAxisIndex:t.get("yAxisIndex",!0),xAxisId:t.get("xAxisId",!0),yAxisId:t.get("yAxisId",!0)};return e.xAxisIndex==null&&e.xAxisId==null&&(e.xAxisIndex="all"),e.yAxisIndex==null&&e.yAxisId==null&&(e.yAxisIndex="all"),e}function V3e(t,e){t.setIconStatus("back",L3e(e)>1?"emphasis":"normal")}function G3e(t,e,r,n,i){var a=r._isZoomActive;n&&n.type==="takeGlobalCursor"&&(a=n.key==="dataZoomSelect"?n.dataZoomSelectActive:!1),r._isZoomActive=a,t.setIconStatus("zoom",a?"emphasis":"normal");var l=new v5(m5(t),e,{include:["grid"]}),c=l.makePanelOpts(i,function(o){return o.xAxisDeclared&&!o.yAxisDeclared?"lineX":!o.xAxisDeclared&&o.yAxisDeclared?"lineY":"rect"});r._brushController.setPanels(c).enableBrush(a&&c.length?{brushType:"auto",brushStyle:t.getModel("brushStyle").getItemStyle()}:!1)}vwe("dataZoom",function(t){var e=t.getComponent("toolbox",0),r=["feature","dataZoom"];if(!e||e.get(r)==null)return;var n=e.getModel(r),i=[],a=m5(n),l=d1(t,a);qO(l.xAxisModels,function(o){return c(o,"xAxis","xAxisIndex")}),qO(l.yAxisModels,function(o){return c(o,"yAxis","yAxisIndex")});function c(o,d,g){var m=o.componentIndex,y={type:"select",$fromToolbox:!0,filterMode:n.get("filterMode",!0)||"filter",id:B3e+d+m};y[g]=m,i.push(y)}return i});function U3e(t){t.registerComponentModel(f3e),t.registerComponentView(p3e),g_("saveAsImage",v3e),g_("magicType",_3e),g_("dataView",M3e),g_("dataZoom",F3e),g_("restore",R3e),En(h3e)}var $3e=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},e}($n);function wee(t){var e=t.get("confine");return e!=null?!!e:t.get("renderMode")==="richText"}function See(t){if(Nn.domSupported){for(var e=document.documentElement.style,r=0,n=t.length;r<n;r++)if(t[r]in e)return t[r]}}var Tee=See(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),H3e=See(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function Aee(t,e){if(!t)return e;e=iX(e,!0);var r=t.indexOf(e);return t=r===-1?e:"-"+t.slice(0,r)+"-"+e,t.toLowerCase()}function j3e(t,e){var r=t.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(t);return r?r[e]:null}var W3e=Aee(H3e,"transition"),_5=Aee(Tee,"transform"),Z3e="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(Nn.transform3dSupported?"will-change:transform;":"");function q3e(t){return t=t==="left"?"right":t==="right"?"left":t==="top"?"bottom":"top",t}function Y3e(t,e,r){if(!yr(r)||r==="inside")return"";var n=t.get("backgroundColor"),i=t.get("borderWidth");e=nv(e);var a=q3e(r),l=Math.max(Math.round(i)*1.5,6),c="",o=_5+":",d;An(["left","right"],a)>-1?(c+="top:50%",o+="translateY(-50%) rotate("+(d=a==="left"?-225:-45)+"deg)"):(c+="left:50%",o+="translateX(-50%) rotate("+(d=a==="top"?225:45)+"deg)");var g=d*Math.PI/180,m=l+i,y=m*Math.abs(Math.cos(g))+m*Math.abs(Math.sin(g)),x=Math.round(((y-Math.SQRT2*i)/2+Math.SQRT2*i-(y-m)/2)*100)/100;c+=";"+a+":-"+x+"px";var A=e+" solid "+i+"px;",M=["position:absolute;width:"+l+"px;height:"+l+"px;z-index:-1;",c+";"+o+";","border-bottom:"+A,"border-right:"+A,"background-color:"+n+";"];return'<div style="'+M.join("")+'"></div>'}function X3e(t,e){var r="cubic-bezier(0.23,1,0.32,1)",n=" "+t/2+"s "+r,i="opacity"+n+",visibility"+n;return e||(n=" "+t+"s "+r,i+=Nn.transformSupported?","+_5+n:",left"+n+",top"+n),W3e+":"+i}function f9(t,e,r){var n=t.toFixed(0)+"px",i=e.toFixed(0)+"px";if(!Nn.transformSupported)return r?"top:"+i+";left:"+n+";":[["top",i],["left",n]];var a=Nn.transform3dSupported,l="translate"+(a?"3d":"")+"("+n+","+i+(a?",0":"")+")";return r?"top:0;left:0;"+_5+":"+l+";":[["top",0],["left",0],[Tee,l]]}function Q3e(t){var e=[],r=t.get("fontSize"),n=t.getTextColor();n&&e.push("color:"+n),e.push("font:"+t.getFont()),r&&e.push("line-height:"+Math.round(r*3/2)+"px");var i=t.get("textShadowColor"),a=t.get("textShadowBlur")||0,l=t.get("textShadowOffsetX")||0,c=t.get("textShadowOffsetY")||0;return i&&a&&e.push("text-shadow:"+l+"px "+c+"px "+a+"px "+i),fe(["decoration","align"],function(o){var d=t.get(o);d&&e.push("text-"+o+":"+d)}),e.join(";")}function K3e(t,e,r){var n=[],i=t.get("transitionDuration"),a=t.get("backgroundColor"),l=t.get("shadowBlur"),c=t.get("shadowColor"),o=t.get("shadowOffsetX"),d=t.get("shadowOffsetY"),g=t.getModel("textStyle"),m=FX(t,"html"),y=o+"px "+d+"px "+l+"px "+c;return n.push("box-shadow:"+y),e&&i&&n.push(X3e(i,r)),a&&n.push("background-color:"+a),fe(["width","color","radius"],function(x){var A="border-"+x,M=iX(A),D=t.get(M);D!=null&&n.push(A+":"+D+(x==="color"?"":"px"))}),n.push(Q3e(g)),m!=null&&n.push("padding:"+fy(m).join("px ")+"px"),n.join(";")+";"}function d9(t,e,r,n,i){var a=e&&e.painter;if(r){var l=a&&a.getViewportRoot();l&&y0e(t,l,r,n,i)}else{t[0]=n,t[1]=i;var c=a&&a.getViewportRootOffset();c&&(t[0]+=c.offsetLeft,t[1]+=c.offsetTop)}t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}var J3e=function(){function t(e,r){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,Nn.wxa)return null;var n=document.createElement("div");n.domBelongToZr=!0,this.el=n;var i=this._zr=e.getZr(),a=r.appendTo,l=a&&(yr(a)?document.querySelector(a):G_(a)?a:zr(a)&&a(e.getDom()));d9(this._styleCoord,i,l,e.getWidth()/2,e.getHeight()/2),(l||e.getDom()).appendChild(n),this._api=e,this._container=l;var c=this;n.onmouseenter=function(){c._enterable&&(clearTimeout(c._hideTimeout),c._show=!0),c._inContent=!0},n.onmousemove=function(o){if(o=o||window.event,!c._enterable){var d=i.handler,g=i.painter.getViewportRoot();xl(g,o,!0),d.dispatch("mousemove",o)}},n.onmouseleave=function(){c._inContent=!1,c._enterable&&c._show&&c.hideLater(c._hideDelay)}}return t.prototype.update=function(e){if(!this._container){var r=this._api.getDom(),n=j3e(r,"position"),i=r.style;i.position!=="absolute"&&n!=="absolute"&&(i.position="relative")}var a=e.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=e.get("className")||""},t.prototype.show=function(e,r){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var n=this.el,i=n.style,a=this._styleCoord;n.innerHTML?i.cssText=Z3e+K3e(e,!this._firstShow,this._longHide)+f9(a[0],a[1],!0)+("border-color:"+nv(r)+";")+(e.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},t.prototype.setContent=function(e,r,n,i,a){var l=this.el;if(e==null){l.innerHTML="";return}var c="";if(yr(a)&&n.get("trigger")==="item"&&!wee(n)&&(c=Y3e(n,i,a)),yr(e))l.innerHTML=e+c;else if(e){l.innerHTML="",Ht(e)||(e=[e]);for(var o=0;o<e.length;o++)G_(e[o])&&e[o].parentNode!==l&&l.appendChild(e[o]);if(c&&l.childNodes.length){var d=document.createElement("div");d.innerHTML=c,l.appendChild(d)}}},t.prototype.setEnterable=function(e){this._enterable=e},t.prototype.getSize=function(){var e=this.el;return[e.offsetWidth,e.offsetHeight]},t.prototype.moveTo=function(e,r){var n=this._styleCoord;if(d9(n,this._zr,this._container,e,r),n[0]!=null&&n[1]!=null){var i=this.el.style,a=f9(n[0],n[1]);fe(a,function(l){i[l[0]]=l[1]})}},t.prototype._moveIfResized=function(){var e=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),r*this._zr.getHeight())},t.prototype.hide=function(){var e=this,r=this.el.style;r.visibility="hidden",r.opacity="0",Nn.transform3dSupported&&(r.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return e._longHide=!0},500)},t.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(wr(this.hide,this),e)):this.hide())},t.prototype.isShow=function(){return this._show},t.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var e=this.el.parentNode;e&&e.removeChild(this.el),this.el=this._container=null},t}(),eze=function(){function t(e){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=e.getZr(),g9(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return t.prototype.update=function(e){var r=e.get("alwaysShowContent");r&&this._moveIfResized(),this._alwaysShowContent=r},t.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},t.prototype.setContent=function(e,r,n,i,a){var l=this;Ur(e)&&vi(""),this.el&&this._zr.remove(this.el);var c=n.getModel("textStyle");this.el=new ti({style:{rich:r.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:c.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:FX(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),fe(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(d){l.el.style[d]=n.get(d)}),fe(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(d){l.el.style[d]=c.get(d)||0}),this._zr.add(this.el);var o=this;this.el.on("mouseover",function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0}),this.el.on("mouseout",function(){o._enterable&&o._show&&o.hideLater(o._hideDelay),o._inContent=!1})},t.prototype.setEnterable=function(e){this._enterable=e},t.prototype.getSize=function(){var e=this.el,r=this.el.getBoundingRect(),n=p9(e.style);return[r.width+n.left+n.right,r.height+n.top+n.bottom]},t.prototype.moveTo=function(e,r){var n=this.el;if(n){var i=this._styleCoord;g9(i,this._zr,e,r),e=i[0],r=i[1];var a=n.style,l=zf(a.borderWidth||0),c=p9(a);n.x=e+l+c.left,n.y=r+l+c.top,n.markRedraw()}},t.prototype._moveIfResized=function(){var e=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),r*this._zr.getHeight())},t.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},t.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(wr(this.hide,this),e)):this.hide())},t.prototype.isShow=function(){return this._show},t.prototype.dispose=function(){this._zr.remove(this.el)},t}();function zf(t){return Math.max(0,t)}function p9(t){var e=zf(t.shadowBlur||0),r=zf(t.shadowOffsetX||0),n=zf(t.shadowOffsetY||0);return{left:zf(e-r),right:zf(e+r),top:zf(e-n),bottom:zf(e+n)}}function g9(t,e,r,n){t[0]=r,t[1]=n,t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}var tze=new Kn({shape:{x:-1,y:-1,width:2,height:2}}),rze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r,n){if(!(Nn.node||!n.getDom())){var i=r.getComponent("tooltip"),a=this._renderMode=qxe(i.get("renderMode"));this._tooltipContent=a==="richText"?new eze(n):new J3e(n,{appendTo:i.get("appendToBody",!0)?"body":i.get("appendTo",!0)})}},e.prototype.render=function(r,n,i){if(!(Nn.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=r,this._ecModel=n,this._api=i;var a=this._tooltipContent;a.update(r),a.setEnterable(r.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&r.get("transitionDuration")?vy(this,"_updatePosition",50,"fixRate"):X1(this,"_updatePosition")}},e.prototype._initGlobalListener=function(){var r=this._tooltipModel,n=r.get("triggerOn");uee("itemTooltip",this._api,wr(function(i,a,l){n!=="none"&&(n.indexOf(i)>=0?this._tryShow(a,l):i==="leave"&&this._hide(l))},this))},e.prototype._keepShow=function(){var r=this._tooltipModel,n=this._ecModel,i=this._api,a=r.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var l=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&l.manuallyShowTip(r,n,i,{x:l._lastX,y:l._lastY,dataByCoordSys:l._lastDataByCoordSys})})}},e.prototype.manuallyShowTip=function(r,n,i,a){if(!(a.from===this.uid||Nn.node||!i.getDom())){var l=v9(a,i);this._ticket="";var c=a.dataByCoordSys,o=oze(a,n,i);if(o){var d=o.el.getBoundingRect().clone();d.applyTransform(o.el.transform),this._tryShow({offsetX:d.x+d.width/2,offsetY:d.y+d.height/2,target:o.el,position:a.position,positionDefault:"bottom"},l)}else if(a.tooltip&&a.x!=null&&a.y!=null){var g=tze;g.x=a.x,g.y=a.y,g.update(),Yr(g).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:g},l)}else if(c)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:c,tooltipOption:a.tooltipOption},l);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(r,n,i,a))return;var m=cee(a,n),y=m.point[0],x=m.point[1];y!=null&&x!=null&&this._tryShow({offsetX:y,offsetY:x,target:m.el,position:a.position,positionDefault:"bottom"},l)}else a.x!=null&&a.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:i.getZr().findHover(a.x,a.y).target},l))}},e.prototype.manuallyHideTip=function(r,n,i,a){var l=this._tooltipContent;this._tooltipModel&&l.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(v9(a,i))},e.prototype._manuallyAxisShowTip=function(r,n,i,a){var l=a.seriesIndex,c=a.dataIndex,o=n.getComponent("axisPointer").coordSysAxesInfo;if(!(l==null||c==null||o==null)){var d=n.getSeriesByIndex(l);if(d){var g=d.getData(),m=Px([g.getItemModel(c),d,(d.coordinateSystem||{}).model],this._tooltipModel);if(m.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:l,dataIndex:c,position:a.position}),!0}}},e.prototype._tryShow=function(r,n){var i=r.target,a=this._tooltipModel;if(a){this._lastX=r.offsetX,this._lastY=r.offsetY;var l=r.dataByCoordSys;if(l&&l.length)this._showAxisTooltip(l,r);else if(i){var c=Yr(i);if(c.ssrType==="legend")return;this._lastDataByCoordSys=null;var o,d;Ig(i,function(g){if(Yr(g).dataIndex!=null)return o=g,!0;if(Yr(g).tooltipConfig!=null)return d=g,!0},!0),o?this._showSeriesItemTooltip(r,o,n):d?this._showComponentItemTooltip(r,d,n):this._hide(n)}else this._lastDataByCoordSys=null,this._hide(n)}},e.prototype._showOrMove=function(r,n){var i=r.get("showDelay");n=wr(n,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(n,i):n()},e.prototype._showAxisTooltip=function(r,n){var i=this._ecModel,a=this._tooltipModel,l=[n.offsetX,n.offsetY],c=Px([n.tooltipOption],a),o=this._renderMode,d=[],g=ro("section",{blocks:[],noHeader:!0}),m=[],y=new rL;fe(r,function(O){fe(O.dataByAxis,function(z){var V=i.getComponent(z.axisDim+"Axis",z.axisIndex),H=z.value;if(!(!V||H==null)){var $=oee(H,V.axis,i,z.seriesDataIndices,z.valueLabelOpt),X=ro("section",{header:$,noHeader:!fu($),sortBlocks:!0,blocks:[]});g.blocks.push(X),fe(z.seriesDataIndices,function(W){var Y=i.getSeriesByIndex(W.seriesIndex),J=W.dataIndexInside,re=Y.getDataParams(J);if(!(re.dataIndex<0)){re.axisDim=z.axisDim,re.axisIndex=z.axisIndex,re.axisType=z.axisType,re.axisId=z.axisId,re.axisValue=yB(V.axis,{value:H}),re.axisValueLabel=$,re.marker=y.makeTooltipMarker("item",nv(re.color),o);var ae=t8(Y.formatTooltip(J,!0,null)),pe=ae.frag;if(pe){var de=Px([Y],a).get("valueFormatter");X.blocks.push(de?Lt({valueFormatter:de},pe):pe)}ae.text&&m.push(ae.text),d.push(re)}})}})}),g.blocks.reverse(),m.reverse();var x=n.position,A=c.get("order"),M=s8(g,y,o,A,i.get("useUTC"),c.get("textStyle"));M&&m.unshift(M);var D=o==="richText"?`

`:"<br/>",P=m.join(D);this._showOrMove(c,function(){this._updateContentNotChangedOnAxis(r,d)?this._updatePosition(c,x,l[0],l[1],this._tooltipContent,d):this._showTooltipContent(c,P,d,Math.random()+"",l[0],l[1],x,null,y)})},e.prototype._showSeriesItemTooltip=function(r,n,i){var a=this._ecModel,l=Yr(n),c=l.seriesIndex,o=a.getSeriesByIndex(c),d=l.dataModel||o,g=l.dataIndex,m=l.dataType,y=d.getData(m),x=this._renderMode,A=r.positionDefault,M=Px([y.getItemModel(g),d,o&&(o.coordinateSystem||{}).model],this._tooltipModel,A?{position:A}:null),D=M.get("trigger");if(!(D!=null&&D!=="item")){var P=d.getDataParams(g,m),O=new rL;P.marker=O.makeTooltipMarker("item",nv(P.color),x);var z=t8(d.formatTooltip(g,!1,m)),V=M.get("order"),H=M.get("valueFormatter"),$=z.frag,X=$?s8(H?Lt({valueFormatter:H},$):$,O,x,V,a.get("useUTC"),M.get("textStyle")):z.text,W="item_"+d.name+"_"+g;this._showOrMove(M,function(){this._showTooltipContent(M,X,P,W,r.offsetX,r.offsetY,r.position,r.target,O)}),i({type:"showTip",dataIndexInside:g,dataIndex:y.getRawIndex(g),seriesIndex:c,from:this.uid})}},e.prototype._showComponentItemTooltip=function(r,n,i){var a=Yr(n),l=a.tooltipConfig,c=l.option||{};if(yr(c)){var o=c;c={content:o,formatter:o}}var d=[c],g=this._ecModel.getComponent(a.componentMainType,a.componentIndex);g&&d.push(g),d.push({formatter:c.content});var m=r.positionDefault,y=Px(d,this._tooltipModel,m?{position:m}:null),x=y.get("content"),A=Math.random()+"",M=new rL;this._showOrMove(y,function(){var D=$r(y.get("formatterParams")||{});this._showTooltipContent(y,x,D,A,r.offsetX,r.offsetY,r.position,n,M)}),i({type:"showTip",from:this.uid})},e.prototype._showTooltipContent=function(r,n,i,a,l,c,o,d,g){if(this._ticket="",!(!r.get("showContent")||!r.get("show"))){var m=this._tooltipContent;m.setEnterable(r.get("enterable"));var y=r.get("formatter");o=o||r.get("position");var x=n,A=this._getNearestPoint([l,c],i,r.get("trigger"),r.get("borderColor")),M=A.color;if(y)if(yr(y)){var D=r.ecModel.get("useUTC"),P=Ht(i)?i[0]:i,O=P&&P.axisType&&P.axisType.indexOf("time")>=0;x=y,O&&(x=gI(P.axisValue,x,D)),x=aX(x,i,!0)}else if(zr(y)){var z=wr(function(V,H){V===this._ticket&&(m.setContent(H,g,r,M,o),this._updatePosition(r,o,l,c,m,i,d))},this);this._ticket=a,x=y(i,a,z)}else x=y;m.setContent(x,g,r,M,o),m.show(r,M),this._updatePosition(r,o,l,c,m,i,d)}},e.prototype._getNearestPoint=function(r,n,i,a){if(i==="axis"||Ht(n))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!Ht(n))return{color:a||n.color||n.borderColor}},e.prototype._updatePosition=function(r,n,i,a,l,c,o){var d=this._api.getWidth(),g=this._api.getHeight();n=n||r.get("position");var m=l.getSize(),y=r.get("align"),x=r.get("verticalAlign"),A=o&&o.getBoundingRect().clone();if(o&&A.applyTransform(o.transform),zr(n)&&(n=n([i,a],c,l.el,A,{viewSize:[d,g],contentSize:m.slice()})),Ht(n))i=dr(n[0],d),a=dr(n[1],g);else if(Ur(n)){var M=n;M.width=m[0],M.height=m[1];var D=Na(M,{width:d,height:g});i=D.x,a=D.y,y=null,x=null}else if(yr(n)&&o){var P=aze(n,A,m,r.get("borderWidth"));i=P[0],a=P[1]}else{var P=nze(i,a,l,d,g,y?null:20,x?null:20);i=P[0],a=P[1]}if(y&&(i-=m9(y)?m[0]/2:y==="right"?m[0]:0),x&&(a-=m9(x)?m[1]/2:x==="bottom"?m[1]:0),wee(r)){var P=ize(i,a,l,d,g);i=P[0],a=P[1]}l.moveTo(i,a)},e.prototype._updateContentNotChangedOnAxis=function(r,n){var i=this._lastDataByCoordSys,a=this._cbParamsList,l=!!i&&i.length===r.length;return l&&fe(i,function(c,o){var d=c.dataByAxis||[],g=r[o]||{},m=g.dataByAxis||[];l=l&&d.length===m.length,l&&fe(d,function(y,x){var A=m[x]||{},M=y.seriesDataIndices||[],D=A.seriesDataIndices||[];l=l&&y.value===A.value&&y.axisType===A.axisType&&y.axisId===A.axisId&&M.length===D.length,l&&fe(M,function(P,O){var z=D[O];l=l&&P.seriesIndex===z.seriesIndex&&P.dataIndex===z.dataIndex}),a&&fe(y.seriesDataIndices,function(P){var O=P.seriesIndex,z=n[O],V=a[O];z&&V&&V.data!==z.data&&(l=!1)})})}),this._lastDataByCoordSys=r,this._cbParamsList=n,!!l},e.prototype._hide=function(r){this._lastDataByCoordSys=null,r({type:"hideTip",from:this.uid})},e.prototype.dispose=function(r,n){Nn.node||!n.getDom()||(X1(this,"_updatePosition"),this._tooltipContent.dispose(),$O("itemTooltip",n))},e.type="tooltip",e}(ra);function Px(t,e,r){var n=e.ecModel,i;r?(i=new bi(r,n,n),i=new bi(e.option,i,n)):i=e;for(var a=t.length-1;a>=0;a--){var l=t[a];l&&(l instanceof bi&&(l=l.get("tooltip",!0)),yr(l)&&(l={formatter:l}),l&&(i=new bi(l,i,n)))}return i}function v9(t,e){return t.dispatchAction||wr(e.dispatchAction,e)}function nze(t,e,r,n,i,a,l){var c=r.getSize(),o=c[0],d=c[1];return a!=null&&(t+o+a+2>n?t-=o+a:t+=a),l!=null&&(e+d+l>i?e-=d+l:e+=l),[t,e]}function ize(t,e,r,n,i){var a=r.getSize(),l=a[0],c=a[1];return t=Math.min(t+l,n)-l,e=Math.min(e+c,i)-c,t=Math.max(t,0),e=Math.max(e,0),[t,e]}function aze(t,e,r,n){var i=r[0],a=r[1],l=Math.ceil(Math.SQRT2*n)+8,c=0,o=0,d=e.width,g=e.height;switch(t){case"inside":c=e.x+d/2-i/2,o=e.y+g/2-a/2;break;case"top":c=e.x+d/2-i/2,o=e.y-a-l;break;case"bottom":c=e.x+d/2-i/2,o=e.y+g+l;break;case"left":c=e.x-i-l,o=e.y+g/2-a/2;break;case"right":c=e.x+d+l,o=e.y+g/2-a/2}return[c,o]}function m9(t){return t==="center"||t==="middle"}function oze(t,e,r){var n=Pz(t).queryOptionMap,i=n.keys()[0];if(!(!i||i==="series")){var a=Tb(e,i,n.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),l=a.models[0];if(l){var c=r.getViewOfComponentModel(l),o;if(c.group.traverse(function(d){var g=Yr(d).tooltipConfig;if(g&&g.name===t.name)return o=d,!0}),o)return{componentMainType:i,componentIndex:l.componentIndex,el:o}}}}function sze(t){En($b),t.registerComponentModel($3e),t.registerComponentView(rze),t.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Sa),t.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Sa)}var lze=["rect","polygon","keep","clear"];function uze(t,e){var r=Pi(t?t.brush:[]);if(r.length){var n=[];fe(r,function(o){var d=o.hasOwnProperty("toolbox")?o.toolbox:[];d instanceof Array&&(n=n.concat(d))});var i=t&&t.toolbox;Ht(i)&&(i=i[0]),i||(i={feature:{}},t.toolbox=[i]);var a=i.feature||(i.feature={}),l=a.brush||(a.brush={}),c=l.type||(l.type=[]);c.push.apply(c,n),cze(c),e&&!c.length&&c.push.apply(c,lze)}}function cze(t){var e={};fe(t,function(r){e[r]=1}),t.length=0,fe(e,function(r,n){t.push(n)})}var _9=fe;function y9(t){if(t){for(var e in t)if(t.hasOwnProperty(e))return!0}}function YO(t,e,r){var n={};return _9(e,function(a){var l=n[a]=i();_9(t[a],function(c,o){if(eo.isValidType(o)){var d={type:o,visual:c};r&&r(d,a),l[o]=new eo(d),o==="opacity"&&(d=$r(d),d.type="colorAlpha",l.__hidden.__alphaForOpacity=new eo(d))}})}),n;function i(){var a=function(){};a.prototype.__hidden=a.prototype;var l=new a;return l}}function Cee(t,e,r){var n;fe(r,function(i){e.hasOwnProperty(i)&&y9(e[i])&&(n=!0)}),n&&fe(r,function(i){e.hasOwnProperty(i)&&y9(e[i])?t[i]=$r(e[i]):delete t[i]})}function hze(t,e,r,n,i,a){var l={};fe(t,function(m){var y=eo.prepareVisualTypes(e[m]);l[m]=y});var c;function o(m){return lB(r,c,m)}function d(m,y){qX(r,c,m,y)}r.each(g);function g(m,y){c=m;var x=r.getRawDataItem(c);if(!(x&&x.visualMap===!1))for(var A=n.call(i,m),M=e[A],D=l[A],P=0,O=D.length;P<O;P++){var z=D[P];M[z]&&M[z].applyVisual(m,o,d)}}}function fze(t,e,r,n){var i={};return fe(t,function(a){var l=eo.prepareVisualTypes(e[a]);i[a]=l}),{progress:function(l,c){var o;n!=null&&(o=c.getDimensionIndex(n));function d(H){return lB(c,m,H)}function g(H,$){qX(c,m,H,$)}for(var m,y=c.getStore();(m=l.next())!=null;){var x=c.getRawDataItem(m);if(!(x&&x.visualMap===!1))for(var A=n!=null?y.get(o,m):m,M=r(A),D=e[M],P=i[M],O=0,z=P.length;O<z;O++){var V=P[O];D[V]&&D[V].applyVisual(A,d,g)}}}}}function dze(t){var e=t.brushType,r={point:function(n){return x9[e].point(n,r,t)},rect:function(n){return x9[e].rect(n,r,t)}};return r}var x9={lineX:b9(0),lineY:b9(1),rect:{point:function(t,e,r){return t&&r.boundingRect.contain(t[0],t[1])},rect:function(t,e,r){return t&&r.boundingRect.intersect(t)}},polygon:{point:function(t,e,r){return t&&r.boundingRect.contain(t[0],t[1])&&mg(r.range,t[0],t[1])},rect:function(t,e,r){var n=r.range;if(!t||n.length<=1)return!1;var i=t.x,a=t.y,l=t.width,c=t.height,o=n[0];if(mg(n,i,a)||mg(n,i+l,a)||mg(n,i,a+c)||mg(n,i+l,a+c)||gn.create(t).contain(o[0],o[1])||Ux(i,a,i+l,a,n)||Ux(i,a,i,a+c,n)||Ux(i+l,a,i+l,a+c,n)||Ux(i,a+c,i+l,a+c,n))return!0}}};function b9(t){var e=["x","y"],r=["width","height"];return{point:function(n,i,a){if(n){var l=a.range,c=n[t];return Lx(c,l)}},rect:function(n,i,a){if(n){var l=a.range,c=[n[e[t]],n[e[t]]+n[r[t]]];return c[1]<c[0]&&c.reverse(),Lx(c[0],l)||Lx(c[1],l)||Lx(l[0],c)||Lx(l[1],c)}}}}function Lx(t,e){return e[0]<=t&&t<=e[1]}var w9=["inBrush","outOfBrush"],_R="__ecBrushSelect",XO="__ecInBrushSelectEvent";function Mee(t){t.eachComponent({mainType:"brush"},function(e){var r=e.brushTargetManager=new v5(e.option,t);r.setInputRanges(e.areas,t)})}function pze(t,e,r){var n=[],i,a;t.eachComponent({mainType:"brush"},function(l){r&&r.type==="takeGlobalCursor"&&l.setBrushOption(r.key==="brush"?r.brushOption:{brushType:!1})}),Mee(t),t.eachComponent({mainType:"brush"},function(l,c){var o={brushId:l.id,brushIndex:c,brushName:l.name,areas:$r(l.areas),selected:[]};n.push(o);var d=l.option,g=d.brushLink,m=[],y=[],x=[],A=!1;c||(i=d.throttleType,a=d.throttleDelay);var M=Zt(l.areas,function(H){var $=_ze[H.brushType],X=Fr({boundingRect:$?$(H):void 0},H);return X.selectors=dze(X),X}),D=YO(l.option,w9,function(H){H.mappingMethod="fixed"});Ht(g)&&fe(g,function(H){m[H]=1});function P(H){return g==="all"||!!m[H]}function O(H){return!!H.length}t.eachSeries(function(H,$){var X=x[$]=[];H.subType==="parallel"?z(H,$):V(H,$,X)});function z(H,$){var X=H.coordinateSystem;A=A||X.hasAxisBrushed(),P($)&&X.eachActiveState(H.getData(),function(W,Y){W==="active"&&(y[Y]=1)})}function V(H,$,X){if(!(!H.brushSelector||mze(l,$))&&(fe(M,function(Y){l.brushTargetManager.controlSeries(Y,H,t)&&X.push(Y),A=A||O(X)}),P($)&&O(X))){var W=H.getData();W.each(function(Y){S9(H,X,W,Y)&&(y[Y]=1)})}}t.eachSeries(function(H,$){var X={seriesId:H.id,seriesIndex:$,seriesName:H.name,dataIndex:[]};o.selected.push(X);var W=x[$],Y=H.getData(),J=P($)?function(re){return y[re]?(X.dataIndex.push(Y.getRawIndex(re)),"inBrush"):"outOfBrush"}:function(re){return S9(H,W,Y,re)?(X.dataIndex.push(Y.getRawIndex(re)),"inBrush"):"outOfBrush"};(P($)?A:O(W))&&hze(w9,D,Y,J)})}),gze(e,i,a,n,r)}function gze(t,e,r,n,i){if(i){var a=t.getZr();if(!a[XO]){a[_R]||(a[_R]=vze);var l=vy(a,_R,r,e);l(t,n)}}}function vze(t,e){if(!t.isDisposed()){var r=t.getZr();r[XO]=!0,t.dispatchAction({type:"brushSelect",batch:e}),r[XO]=!1}}function S9(t,e,r,n){for(var i=0,a=e.length;i<a;i++){var l=e[i];if(t.brushSelector(n,r,l.selectors,l))return!0}}function mze(t,e){var r=t.option.seriesIndex;return r!=null&&r!=="all"&&(Ht(r)?An(r,e)<0:e!==r)}var _ze={rect:function(t){return T9(t.range)},polygon:function(t){for(var e,r=t.range,n=0,i=r.length;n<i;n++){e=e||[[1/0,-1/0],[1/0,-1/0]];var a=r[n];a[0]<e[0][0]&&(e[0][0]=a[0]),a[0]>e[0][1]&&(e[0][1]=a[0]),a[1]<e[1][0]&&(e[1][0]=a[1]),a[1]>e[1][1]&&(e[1][1]=a[1])}return e&&T9(e)}};function T9(t){return new gn(t[0][0],t[1][0],t[0][1]-t[0][0],t[1][1]-t[1][0])}var yze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r,n){this.ecModel=r,this.api=n,this.model,(this._brushController=new jB(n.getZr())).on("brush",wr(this._onBrush,this)).mount()},e.prototype.render=function(r,n,i,a){this.model=r,this._updateController(r,n,i,a)},e.prototype.updateTransform=function(r,n,i,a){Mee(n),this._updateController(r,n,i,a)},e.prototype.updateVisual=function(r,n,i,a){this.updateTransform(r,n,i,a)},e.prototype.updateView=function(r,n,i,a){this._updateController(r,n,i,a)},e.prototype._updateController=function(r,n,i,a){(!a||a.$from!==r.id)&&this._brushController.setPanels(r.brushTargetManager.makePanelOpts(i)).enableBrush(r.brushOption).updateCovers(r.areas.slice())},e.prototype.dispose=function(){this._brushController.dispose()},e.prototype._onBrush=function(r){var n=this.model.id,i=this.model.brushTargetManager.setOutputRanges(r.areas,this.ecModel);(!r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:n,areas:$r(i),$from:n}),r.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:n,areas:$r(i),$from:n})},e.type="brush",e}(ra),xze="#ddd",bze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.areas=[],r.brushOption={},r}return e.prototype.optionUpdated=function(r,n){var i=this.option;!n&&Cee(i,r,["inBrush","outOfBrush"]);var a=i.inBrush=i.inBrush||{};i.outOfBrush=i.outOfBrush||{color:xze},a.hasOwnProperty("liftZ")||(a.liftZ=5)},e.prototype.setAreas=function(r){r&&(this.areas=Zt(r,function(n){return A9(this.option,n)},this))},e.prototype.setBrushOption=function(r){this.brushOption=A9(this.option,r),this.brushType=this.brushOption.brushType},e.type="brush",e.dependencies=["geo","grid","xAxis","yAxis","parallel","series"],e.defaultOption={seriesIndex:"all",brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(210,219,238,0.3)",borderColor:"#D2DBEE"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},e}($n);function A9(t,e){return pn({brushType:t.brushType,brushMode:t.brushMode,transformable:t.transformable,brushStyle:new bi(t.brushStyle).getItemStyle(),removeOnClick:t.removeOnClick,z:t.z},e,!0)}var wze=["rect","polygon","lineX","lineY","keep","clear"],Sze=function(t){et(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.render=function(r,n,i){var a,l,c;n.eachComponent({mainType:"brush"},function(o){a=o.brushType,l=o.brushOption.brushMode||"single",c=c||!!o.areas.length}),this._brushType=a,this._brushMode=l,fe(r.get("type",!0),function(o){r.setIconStatus(o,(o==="keep"?l==="multiple":o==="clear"?c:o===a)?"emphasis":"normal")})},e.prototype.updateView=function(r,n,i){this.render(r,n,i)},e.prototype.getIcons=function(){var r=this.model,n=r.get("icon",!0),i={};return fe(r.get("type",!0),function(a){n[a]&&(i[a]=n[a])}),i},e.prototype.onclick=function(r,n,i){var a=this._brushType,l=this._brushMode;i==="clear"?(n.dispatchAction({type:"axisAreaSelect",intervals:[]}),n.dispatchAction({type:"brush",command:"clear",areas:[]})):n.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:i==="keep"?a:a===i?!1:i,brushMode:i==="keep"?l==="multiple"?"single":"multiple":l}})},e.getDefaultOption=function(r){var n={show:!0,type:wze.slice(),icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:r.getLocaleModel().get(["toolbox","brush","title"])};return n},e}(Al);function Tze(t){t.registerComponentView(yze),t.registerComponentModel(bze),t.registerPreprocessor(uze),t.registerVisual(t.PRIORITY.VISUAL.BRUSH,pze),t.registerAction({type:"brush",event:"brush",update:"updateVisual"},function(e,r){r.eachComponent({mainType:"brush",query:e},function(n){n.setAreas(e.areas)})}),t.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},Sa),t.registerAction({type:"brushEnd",event:"brushEnd",update:"none"},Sa),g_("brush",Sze)}var Aze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.layoutMode={type:"box",ignoreSize:!0},r}return e.type="title",e.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},e}($n),Cze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.render=function(r,n,i){if(this.group.removeAll(),!!r.get("show")){var a=this.group,l=r.getModel("textStyle"),c=r.getModel("subtextStyle"),o=r.get("textAlign"),d=tn(r.get("textBaseline"),r.get("textVerticalAlign")),g=new ti({style:Hi(l,{text:r.get("text"),fill:l.getTextColor()},{disableBox:!0}),z2:10}),m=g.getBoundingRect(),y=r.get("subtext"),x=new ti({style:Hi(c,{text:y,fill:c.getTextColor(),y:m.height+r.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),A=r.get("link"),M=r.get("sublink"),D=r.get("triggerEvent",!0);g.silent=!A&&!D,x.silent=!M&&!D,A&&g.on("click",function(){FC(A,"_"+r.get("target"))}),M&&x.on("click",function(){FC(M,"_"+r.get("subtarget"))}),Yr(g).eventData=Yr(x).eventData=D?{componentType:"title",componentIndex:r.componentIndex}:null,a.add(g),y&&a.add(x);var P=a.getBoundingRect(),O=r.getBoxLayoutParams();O.width=P.width,O.height=P.height;var z=Na(O,{width:i.getWidth(),height:i.getHeight()},r.get("padding"));o||(o=r.get("left")||r.get("right"),o==="middle"&&(o="center"),o==="right"?z.x+=z.width:o==="center"&&(z.x+=z.width/2)),d||(d=r.get("top")||r.get("bottom"),d==="center"&&(d="middle"),d==="bottom"?z.y+=z.height:d==="middle"&&(z.y+=z.height/2),d=d||"top"),a.x=z.x,a.y=z.y,a.markRedraw();var V={align:o,verticalAlign:d};g.setStyle(V),x.setStyle(V),P=a.getBoundingRect();var H=z.margin,$=r.getItemStyle(["color","opacity"]);$.fill=r.get("backgroundColor");var X=new Kn({shape:{x:P.x-H[3],y:P.y-H[0],width:P.width+H[1]+H[3],height:P.height+H[0]+H[2],r:r.get("borderRadius")},style:$,subPixelOptimize:!0,silent:!0});a.add(X)}},e.type="title",e}(ra);function Mze(t){t.registerComponentModel(Aze),t.registerComponentView(Cze)}var C9=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.layoutMode="box",r}return e.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),this._initData()},e.prototype.mergeOption=function(r){t.prototype.mergeOption.apply(this,arguments),this._initData()},e.prototype.setCurrentIndex=function(r){r==null&&(r=this.option.currentIndex);var n=this._data.count();this.option.loop?r=(r%n+n)%n:(r>=n&&(r=n-1),r<0&&(r=0)),this.option.currentIndex=r},e.prototype.getCurrentIndex=function(){return this.option.currentIndex},e.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},e.prototype.setPlayState=function(r){this.option.autoPlay=!!r},e.prototype.getPlayState=function(){return!!this.option.autoPlay},e.prototype._initData=function(){var r=this.option,n=r.data||[],i=r.axisType,a=this._names=[],l;i==="category"?(l=[],fe(n,function(d,g){var m=za(oy(d),""),y;Ur(d)?(y=$r(d),y.value=g):y=g,l.push(y),a.push(m)})):l=n;var c={category:"ordinal",time:"time",value:"number"}[i]||"number",o=this._data=new ts([{name:"value",type:c}],this);o.initData(l,a)},e.prototype.getData=function(){return this._data},e.prototype.getCategories=function(){if(this.get("axisType")==="category")return this._names.slice()},e.type="timeline",e.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},e}($n),Iee=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="timeline.slider",e.defaultOption=Ed(C9.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),e}(C9);Ea(Iee,aB.prototype);var Ize=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="timeline",e}(ra),Eze=function(t){et(e,t);function e(r,n,i,a){var l=t.call(this,r,n,i)||this;return l.type=a||"value",l}return e.prototype.getLabelModel=function(){return this.model.getModel("label")},e.prototype.isHorizontal=function(){return this.model.get("orient")==="horizontal"},e}(Tu),yR=Math.PI,M9=ri(),Dze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(r,n){this.api=n},e.prototype.render=function(r,n,i){if(this.model=r,this.api=i,this.ecModel=n,this.group.removeAll(),r.get("show",!0)){var a=this._layout(r,i),l=this._createGroup("_mainGroup"),c=this._createGroup("_labelGroup"),o=this._axis=this._createAxis(a,r);r.formatTooltip=function(d){var g=o.scale.getLabel({value:d});return ro("nameValue",{noName:!0,value:g})},fe(["AxisLine","AxisTick","Control","CurrentPointer"],function(d){this["_render"+d](a,l,o,r)},this),this._renderAxisLabel(a,c,o,r),this._position(a,r)}this._doPlayStop(),this._updateTicksStatus()},e.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},e.prototype.dispose=function(){this._clearTimer()},e.prototype._layout=function(r,n){var i=r.get(["label","position"]),a=r.get("orient"),l=Lze(r,n),c;i==null||i==="auto"?c=a==="horizontal"?l.y+l.height/2<n.getHeight()/2?"-":"+":l.x+l.width/2<n.getWidth()/2?"+":"-":yr(i)?c={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[a][i]:c=i;var o={horizontal:"center",vertical:c>=0||c==="+"?"left":"right"},d={horizontal:c>=0||c==="+"?"top":"bottom",vertical:"middle"},g={horizontal:0,vertical:yR/2},m=a==="vertical"?l.height:l.width,y=r.getModel("controlStyle"),x=y.get("show",!0),A=x?y.get("itemSize"):0,M=x?y.get("itemGap"):0,D=A+M,P=r.get(["label","rotate"])||0;P=P*yR/180;var O,z,V,H=y.get("position",!0),$=x&&y.get("showPlayBtn",!0),X=x&&y.get("showPrevBtn",!0),W=x&&y.get("showNextBtn",!0),Y=0,J=m;H==="left"||H==="bottom"?($&&(O=[0,0],Y+=D),X&&(z=[Y,0],Y+=D),W&&(V=[J-A,0],J-=D)):($&&(O=[J-A,0],J-=D),X&&(z=[0,0],Y+=D),W&&(V=[J-A,0],J-=D));var re=[Y,J];return r.get("inverse")&&re.reverse(),{viewRect:l,mainLength:m,orient:a,rotation:g[a],labelRotation:P,labelPosOpt:c,labelAlign:r.get(["label","align"])||o[a],labelBaseline:r.get(["label","verticalAlign"])||r.get(["label","baseline"])||d[a],playPosition:O,prevBtnPosition:z,nextBtnPosition:V,axisExtent:re,controlSize:A,controlGap:M}},e.prototype._position=function(r,n){var i=this._mainGroup,a=this._labelGroup,l=r.viewRect;if(r.orient==="vertical"){var c=Qs(),o=l.x,d=l.y+l.height;hc(c,c,[-o,-d]),hv(c,c,-yR/2),hc(c,c,[o,d]),l=l.clone(),l.applyTransform(c)}var g=O(l),m=O(i.getBoundingRect()),y=O(a.getBoundingRect()),x=[i.x,i.y],A=[a.x,a.y];A[0]=x[0]=g[0][0];var M=r.labelPosOpt;if(M==null||yr(M)){var D=M==="+"?0:1;z(x,m,g,1,D),z(A,y,g,1,1-D)}else{var D=M>=0?0:1;z(x,m,g,1,D),A[1]=x[1]+M}i.setPosition(x),a.setPosition(A),i.rotation=a.rotation=r.rotation,P(i),P(a);function P(V){V.originX=g[0][0]-V.x,V.originY=g[1][0]-V.y}function O(V){return[[V.x,V.x+V.width],[V.y,V.y+V.height]]}function z(V,H,$,X,W){V[X]+=$[X][W]-H[X][W]}},e.prototype._createAxis=function(r,n){var i=n.getData(),a=n.get("axisType"),l=Pze(n,a);l.getTicks=function(){return i.mapArray(["value"],function(d){return{value:d}})};var c=i.getDataExtent("value");l.setExtent(c[0],c[1]),l.calcNiceTicks();var o=new Eze("value",l,r.axisExtent,a);return o.model=n,o},e.prototype._createGroup=function(r){var n=this[r]=new jr;return this.group.add(n),n},e.prototype._renderAxisLine=function(r,n,i,a){var l=i.getExtent();if(a.get(["lineStyle","show"])){var c=new Ka({shape:{x1:l[0],y1:0,x2:l[1],y2:0},style:Lt({lineCap:"round"},a.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});n.add(c);var o=this._progressLine=new Ka({shape:{x1:l[0],x2:this._currentPointer?this._currentPointer.x:l[0],y1:0,y2:0},style:Fr({lineCap:"round",lineWidth:c.style.lineWidth},a.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});n.add(o)}},e.prototype._renderAxisTick=function(r,n,i,a){var l=this,c=a.getData(),o=i.scale.getTicks();this._tickSymbols=[],fe(o,function(d){var g=i.dataToCoord(d.value),m=c.getItemModel(d.value),y=m.getModel("itemStyle"),x=m.getModel(["emphasis","itemStyle"]),A=m.getModel(["progress","itemStyle"]),M={x:g,y:0,onclick:wr(l._changeTimeline,l,d.value)},D=I9(m,y,n,M);D.ensureState("emphasis").style=x.getItemStyle(),D.ensureState("progress").style=A.getItemStyle(),Gg(D);var P=Yr(D);m.get("tooltip")?(P.dataIndex=d.value,P.dataModel=a):P.dataIndex=P.dataModel=null,l._tickSymbols.push(D)})},e.prototype._renderAxisLabel=function(r,n,i,a){var l=this,c=i.getLabelModel();if(c.get("show")){var o=a.getData(),d=i.getViewLabels();this._tickLabels=[],fe(d,function(g){var m=g.tickValue,y=o.getItemModel(m),x=y.getModel("label"),A=y.getModel(["emphasis","label"]),M=y.getModel(["progress","label"]),D=i.dataToCoord(g.tickValue),P=new ti({x:D,y:0,rotation:r.labelRotation-r.rotation,onclick:wr(l._changeTimeline,l,m),silent:!1,style:Hi(x,{text:g.formattedLabel,align:r.labelAlign,verticalAlign:r.labelBaseline})});P.ensureState("emphasis").style=Hi(A),P.ensureState("progress").style=Hi(M),n.add(P),Gg(P),M9(P).dataIndex=m,l._tickLabels.push(P)})}},e.prototype._renderControl=function(r,n,i,a){var l=r.controlSize,c=r.rotation,o=a.getModel("controlStyle").getItemStyle(),d=a.getModel(["emphasis","controlStyle"]).getItemStyle(),g=a.getPlayState(),m=a.get("inverse",!0);y(r.nextBtnPosition,"next",wr(this._changeTimeline,this,m?"-":"+")),y(r.prevBtnPosition,"prev",wr(this._changeTimeline,this,m?"+":"-")),y(r.playPosition,g?"stop":"play",wr(this._handlePlayClick,this,!g),!0);function y(x,A,M,D){if(x){var P=yu(tn(a.get(["controlStyle",A+"BtnSize"]),l),l),O=[0,-P/2,P,P],z=Rze(a,A+"Icon",O,{x:x[0],y:x[1],originX:l/2,originY:0,rotation:D?-c:0,rectHover:!0,style:o,onclick:M});z.ensureState("emphasis").style=d,n.add(z),Gg(z)}}},e.prototype._renderCurrentPointer=function(r,n,i,a){var l=a.getData(),c=a.getCurrentIndex(),o=l.getItemModel(c).getModel("checkpointStyle"),d=this,g={onCreate:function(m){m.draggable=!0,m.drift=wr(d._handlePointerDrag,d),m.ondragend=wr(d._handlePointerDragend,d),E9(m,d._progressLine,c,i,a,!0)},onUpdate:function(m){E9(m,d._progressLine,c,i,a)}};this._currentPointer=I9(o,o,this._mainGroup,{},this._currentPointer,g)},e.prototype._handlePlayClick=function(r){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:r,from:this.uid})},e.prototype._handlePointerDrag=function(r,n,i){this._clearTimer(),this._pointerChangeTimeline([i.offsetX,i.offsetY])},e.prototype._handlePointerDragend=function(r){this._pointerChangeTimeline([r.offsetX,r.offsetY],!0)},e.prototype._pointerChangeTimeline=function(r,n){var i=this._toAxisCoord(r)[0],a=this._axis,l=El(a.getExtent().slice());i>l[1]&&(i=l[1]),i<l[0]&&(i=l[0]),this._currentPointer.x=i,this._currentPointer.markRedraw();var c=this._progressLine;c&&(c.shape.x2=i,c.dirty());var o=this._findNearestTick(i),d=this.model;(n||o!==d.getCurrentIndex()&&d.get("realtime"))&&this._changeTimeline(o)},e.prototype._doPlayStop=function(){var r=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var n=r.model;r._changeTimeline(n.getCurrentIndex()+(n.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},e.prototype._toAxisCoord=function(r){var n=this._mainGroup.getLocalTransform();return vu(r,n,!0)},e.prototype._findNearestTick=function(r){var n=this.model.getData(),i=1/0,a,l=this._axis;return n.each(["value"],function(c,o){var d=l.dataToCoord(c),g=Math.abs(d-r);g<i&&(i=g,a=o)}),a},e.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},e.prototype._changeTimeline=function(r){var n=this.model.getCurrentIndex();r==="+"?r=n+1:r==="-"&&(r=n-1),this.api.dispatchAction({type:"timelineChange",currentIndex:r,from:this.uid})},e.prototype._updateTicksStatus=function(){var r=this.model.getCurrentIndex(),n=this._tickSymbols,i=this._tickLabels;if(n)for(var a=0;a<n.length;a++)n&&n[a]&&n[a].toggleState("progress",a<r);if(i)for(var a=0;a<i.length;a++)i&&i[a]&&i[a].toggleState("progress",M9(i[a]).dataIndex<=r)},e.type="timeline.slider",e}(Ize);function Pze(t,e){if(e=e||t.get("type"),e)switch(e){case"category":return new MI({ordinalMeta:t.getCategories(),extent:[1/0,-1/0]});case"time":return new mB({locale:t.ecModel.getLocaleModel(),useUTC:t.ecModel.get("useUTC")});default:return new _h}}function Lze(t,e){return Na(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()},t.get("padding"))}function Rze(t,e,r,n){var i=n.style,a=Eb(t.get(["controlStyle",e]),n||{},new gn(r[0],r[1],r[2],r[3]));return i&&a.setStyle(i),a}function I9(t,e,r,n,i,a){var l=e.get("color");if(i)i.setColor(l),r.add(i),a&&a.onUpdate(i);else{var c=t.get("symbol");i=Ia(c,-1,-1,2,2,l),i.setStyle("strokeNoScale",!0),r.add(i),a&&a.onCreate(i)}var o=e.getItemStyle(["color"]);i.setStyle(o),n=pn({rectHover:!0,z2:100},n,!0);var d=my(t.get("symbolSize"));n.scaleX=d[0]/2,n.scaleY=d[1]/2;var g=dv(t.get("symbolOffset"),d);g&&(n.x=(n.x||0)+g[0],n.y=(n.y||0)+g[1]);var m=t.get("symbolRotate");return n.rotation=(m||0)*Math.PI/180||0,i.attr(n),i.updateTransform(),i}function E9(t,e,r,n,i,a){if(!t.dragging){var l=i.getModel("checkpointStyle"),c=n.dataToCoord(i.getData().get("value",r));if(a||!l.get("animation",!0))t.attr({x:c,y:0}),e&&e.attr({shape:{x2:c}});else{var o={duration:l.get("animationDuration",!0),easing:l.get("animationEasing",!0)};t.stopAnimation(null,!0),t.animateTo({x:c,y:0},o),e&&e.animateTo({shape:{x2:c}},o)}}}function kze(t){t.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(e,r,n){var i=r.getComponent("timeline");return i&&e.currentIndex!=null&&(i.setCurrentIndex(e.currentIndex),!i.get("loop",!0)&&i.isIndexMax()&&i.getPlayState()&&(i.setPlayState(!1),n.dispatchAction({type:"timelinePlayChange",playState:!1,from:e.from}))),r.resetOption("timeline",{replaceMerge:i.get("replaceMerge",!0)}),Fr({currentIndex:i.option.currentIndex},e)}),t.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(e,r){var n=r.getComponent("timeline");n&&e.playState!=null&&n.setPlayState(e.playState)})}function Oze(t){var e=t&&t.timeline;Ht(e)||(e=e?[e]:[]),fe(e,function(r){r&&zze(r)})}function zze(t){var e=t.type,r={number:"value",time:"time"};if(r[e]&&(t.axisType=r[e],delete t.type),D9(t),xg(t,"controlPosition")){var n=t.controlStyle||(t.controlStyle={});xg(n,"position")||(n.position=t.controlPosition),n.position==="none"&&!xg(n,"show")&&(n.show=!1,delete n.position),delete t.controlPosition}fe(t.data||[],function(i){Ur(i)&&!Ht(i)&&(!xg(i,"value")&&xg(i,"name")&&(i.value=i.name),D9(i))})}function D9(t){var e=t.itemStyle||(t.itemStyle={}),r=e.emphasis||(e.emphasis={}),n=t.label||t.label||{},i=n.normal||(n.normal={}),a={normal:1,emphasis:1};fe(n,function(l,c){!a[c]&&!xg(i,c)&&(i[c]=l)}),r.label&&!xg(n,"emphasis")&&(n.emphasis=r.label,delete r.label)}function xg(t,e){return t.hasOwnProperty(e)}function Bze(t){t.registerComponentModel(Iee),t.registerComponentView(Dze),t.registerSubTypeDefaulter("timeline",function(){return"slider"}),kze(t),t.registerPreprocessor(Oze)}function y5(t,e){if(!t)return!1;for(var r=Ht(t)?t:[t],n=0;n<r.length;n++)if(r[n]&&r[n][e])return!0;return!1}function pA(t){Jg(t,"label",["show"])}var gA=ri(),xh=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.createdBySelf=!1,r}return e.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),this._mergeOption(r,i,!1,!0)},e.prototype.isAnimationEnabled=function(){if(Nn.node)return!1;var r=this.__hostSeries;return this.getShallow("animation")&&r&&r.isAnimationEnabled()},e.prototype.mergeOption=function(r,n){this._mergeOption(r,n,!1,!1)},e.prototype._mergeOption=function(r,n,i,a){var l=this.mainType;i||n.eachSeries(function(c){var o=c.get(this.mainType,!0),d=gA(c)[l];if(!o||!o.data){gA(c)[l]=null;return}d?d._mergeOption(o,n,!0):(a&&pA(o),fe(o.data,function(g){g instanceof Array?(pA(g[0]),pA(g[1])):pA(g)}),d=this.createMarkerModelFromSeries(o,this,n),Lt(d,{mainType:this.mainType,seriesIndex:c.seriesIndex,name:c.name,createdBySelf:!0}),d.__hostSeries=c),gA(c)[l]=d},this)},e.prototype.formatTooltip=function(r,n,i){var a=this.getData(),l=this.getRawValue(r),c=a.getName(r);return ro("section",{header:this.name,blocks:[ro("nameValue",{name:c,value:l,noName:!c,noValue:l==null})]})},e.prototype.getData=function(){return this._data},e.prototype.setData=function(r){this._data=r},e.getMarkerModelFromSeries=function(r,n){return gA(r)[n]},e.type="marker",e.dependencies=["series","grid","polar","geo"],e}($n);Ea(xh,aB.prototype);var Fze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.createMarkerModelFromSeries=function(r,n,i){return new e(r,n,i)},e.type="markPoint",e.defaultOption={z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}},e}(xh);function QO(t){return!(isNaN(parseFloat(t.x))&&isNaN(parseFloat(t.y)))}function Nze(t){return!isNaN(parseFloat(t.x))&&!isNaN(parseFloat(t.y))}function vA(t,e,r,n,i,a){var l=[],c=yd(e,n),o=c?e.getCalculationInfo("stackResultDimension"):n,d=x5(e,o,t),g=e.indicesOfNearest(o,d)[0];l[i]=e.get(r,g),l[a]=e.get(o,g);var m=e.get(n,g),y=Ju(e.get(n,g));return y=Math.min(y,20),y>=0&&(l[a]=+l[a].toFixed(y)),[l,m]}var xR={min:on(vA,"min"),max:on(vA,"max"),average:on(vA,"average"),median:on(vA,"median")};function cb(t,e){if(e){var r=t.getData(),n=t.coordinateSystem,i=n&&n.dimensions;if(!Nze(e)&&!Ht(e.coord)&&Ht(i)){var a=Eee(e,r,n,t);if(e=$r(e),e.type&&xR[e.type]&&a.baseAxis&&a.valueAxis){var l=An(i,a.baseAxis.dim),c=An(i,a.valueAxis.dim),o=xR[e.type](r,a.baseDataDim,a.valueDataDim,l,c);e.coord=o[0],e.value=o[1]}else e.coord=[e.xAxis!=null?e.xAxis:e.radiusAxis,e.yAxis!=null?e.yAxis:e.angleAxis]}if(e.coord==null||!Ht(i))e.coord=[];else for(var d=e.coord,g=0;g<2;g++)xR[d[g]]&&(d[g]=x5(r,r.mapDimension(i[g]),d[g]));return e}}function Eee(t,e,r,n){var i={};return t.valueIndex!=null||t.valueDim!=null?(i.valueDataDim=t.valueIndex!=null?e.getDimension(t.valueIndex):t.valueDim,i.valueAxis=r.getAxis(Vze(n,i.valueDataDim)),i.baseAxis=r.getOtherAxis(i.valueAxis),i.baseDataDim=e.mapDimension(i.baseAxis.dim)):(i.baseAxis=n.getBaseAxis(),i.valueAxis=r.getOtherAxis(i.baseAxis),i.baseDataDim=e.mapDimension(i.baseAxis.dim),i.valueDataDim=e.mapDimension(i.valueAxis.dim)),i}function Vze(t,e){var r=t.getData().getDimensionInfo(e);return r&&r.coordDim}function hb(t,e){return t&&t.containData&&e.coord&&!QO(e)?t.containData(e.coord):!0}function Gze(t,e,r){return t&&t.containZone&&e.coord&&r.coord&&!QO(e)&&!QO(r)?t.containZone(e.coord,r.coord):!0}function Dee(t,e){return t?function(r,n,i,a){var l=a<2?r.coord&&r.coord[a]:r.value;return cd(l,e[a])}:function(r,n,i,a){return cd(r.value,e[a])}}function x5(t,e,r){if(r==="average"){var n=0,i=0;return t.each(e,function(a,l){isNaN(a)||(n+=a,i++)}),n/i}else return r==="median"?t.getMedian(e):t.getDataExtent(e)[r==="max"?1:0]}var bR=ri(),b5=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.init=function(){this.markerGroupMap=Ir()},e.prototype.render=function(r,n,i){var a=this,l=this.markerGroupMap;l.each(function(c){bR(c).keep=!1}),n.eachSeries(function(c){var o=xh.getMarkerModelFromSeries(c,a.type);o&&a.renderSeries(c,o,n,i)}),l.each(function(c){!bR(c).keep&&a.group.remove(c.group)})},e.prototype.markKeep=function(r){bR(r).keep=!0},e.prototype.toggleBlurSeries=function(r,n){var i=this;fe(r,function(a){var l=xh.getMarkerModelFromSeries(a,i.type);if(l){var c=l.getData();c.eachItemGraphicEl(function(o){o&&(n?xY(o):Fz(o))})}})},e.type="marker",e}(ra);function P9(t,e,r){var n=e.coordinateSystem;t.each(function(i){var a=t.getItemModel(i),l,c=dr(a.get("x"),r.getWidth()),o=dr(a.get("y"),r.getHeight());if(!isNaN(c)&&!isNaN(o))l=[c,o];else if(e.getMarkerPosition)l=e.getMarkerPosition(t.getValues(t.dimensions,i));else if(n){var d=t.get(n.dimensions[0],i),g=t.get(n.dimensions[1],i);l=n.dataToPoint([d,g])}isNaN(c)||(l[0]=c),isNaN(o)||(l[1]=o),t.setItemLayout(i,l)})}var Uze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.updateTransform=function(r,n,i){n.eachSeries(function(a){var l=xh.getMarkerModelFromSeries(a,"markPoint");l&&(P9(l.getData(),a,i),this.markerGroupMap.get(a.id).updateLayout())},this)},e.prototype.renderSeries=function(r,n,i,a){var l=r.coordinateSystem,c=r.id,o=r.getData(),d=this.markerGroupMap,g=d.get(c)||d.set(c,new zb),m=$ze(l,r,n);n.setData(m),P9(n.getData(),r,a),m.each(function(y){var x=m.getItemModel(y),A=x.getShallow("symbol"),M=x.getShallow("symbolSize"),D=x.getShallow("symbolRotate"),P=x.getShallow("symbolOffset"),O=x.getShallow("symbolKeepAspect");if(zr(A)||zr(M)||zr(D)||zr(P)){var z=n.getRawValue(y),V=n.getDataParams(y);zr(A)&&(A=A(z,V)),zr(M)&&(M=M(z,V)),zr(D)&&(D=D(z,V)),zr(P)&&(P=P(z,V))}var H=x.getModel("itemStyle").getItemStyle(),$=Pb(o,"color");H.fill||(H.fill=$),m.setItemVisual(y,{symbol:A,symbolSize:M,symbolRotate:D,symbolOffset:P,symbolKeepAspect:O,style:H})}),g.updateData(m),this.group.add(g.group),m.eachItemGraphicEl(function(y){y.traverse(function(x){Yr(x).dataModel=n})}),this.markKeep(g),g.group.silent=n.get("silent")||r.get("silent")},e.type="markPoint",e}(b5);function $ze(t,e,r){var n;t?n=Zt(t&&t.dimensions,function(c){var o=e.getData().getDimensionInfo(e.getData().mapDimension(c))||{};return Lt(Lt({},o),{name:c,ordinalMeta:null})}):n=[{name:"value",type:"float"}];var i=new ts(n,r),a=Zt(r.get("data"),on(cb,e));t&&(a=Ei(a,on(hb,t)));var l=Dee(!!t,n);return i.initData(a,null,l),i}function Hze(t){t.registerComponentModel(Fze),t.registerComponentView(Uze),t.registerPreprocessor(function(e){y5(e.series,"markPoint")&&(e.markPoint=e.markPoint||{})})}var jze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.createMarkerModelFromSeries=function(r,n,i){return new e(r,n,i)},e.type="markLine",e.defaultOption={z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},e}(xh),mA=ri(),Wze=function(t,e,r,n){var i=t.getData(),a;if(Ht(n))a=n;else{var l=n.type;if(l==="min"||l==="max"||l==="average"||l==="median"||n.xAxis!=null||n.yAxis!=null){var c=void 0,o=void 0;if(n.yAxis!=null||n.xAxis!=null)c=e.getAxis(n.yAxis!=null?"y":"x"),o=ho(n.yAxis,n.xAxis);else{var d=Eee(n,i,e,t);c=d.valueAxis;var g=TQ(i,d.valueDataDim);o=x5(i,g,l)}var m=c.dim==="x"?0:1,y=1-m,x=$r(n),A={coord:[]};x.type=null,x.coord=[],x.coord[y]=-1/0,A.coord[y]=1/0;var M=r.get("precision");M>=0&&ii(o)&&(o=+o.toFixed(Math.min(M,20))),x.coord[m]=A.coord[m]=o,a=[x,A,{type:l,valueIndex:n.valueIndex,value:o}]}else a=[]}var D=[cb(t,a[0]),cb(t,a[1]),Lt({},a[2])];return D[2].type=D[2].type||null,pn(D[2],D[0]),pn(D[2],D[1]),D};function uM(t){return!isNaN(t)&&!isFinite(t)}function L9(t,e,r,n){var i=1-t,a=n.dimensions[t];return uM(e[i])&&uM(r[i])&&e[t]===r[t]&&n.getAxis(a).containData(e[t])}function Zze(t,e){if(t.type==="cartesian2d"){var r=e[0].coord,n=e[1].coord;if(r&&n&&(L9(1,r,n,t)||L9(0,r,n,t)))return!0}return hb(t,e[0])&&hb(t,e[1])}function wR(t,e,r,n,i){var a=n.coordinateSystem,l=t.getItemModel(e),c,o=dr(l.get("x"),i.getWidth()),d=dr(l.get("y"),i.getHeight());if(!isNaN(o)&&!isNaN(d))c=[o,d];else{if(n.getMarkerPosition)c=n.getMarkerPosition(t.getValues(t.dimensions,e));else{var g=a.dimensions,m=t.get(g[0],e),y=t.get(g[1],e);c=a.dataToPoint([m,y])}if(gv(a,"cartesian2d")){var x=a.getAxis("x"),A=a.getAxis("y"),g=a.dimensions;uM(t.get(g[0],e))?c[0]=x.toGlobalCoord(x.getExtent()[r?0:1]):uM(t.get(g[1],e))&&(c[1]=A.toGlobalCoord(A.getExtent()[r?0:1]))}isNaN(o)||(c[0]=o),isNaN(d)||(c[1]=d)}t.setItemLayout(e,c)}var qze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.updateTransform=function(r,n,i){n.eachSeries(function(a){var l=xh.getMarkerModelFromSeries(a,"markLine");if(l){var c=l.getData(),o=mA(l).from,d=mA(l).to;o.each(function(g){wR(o,g,!0,a,i),wR(d,g,!1,a,i)}),c.each(function(g){c.setItemLayout(g,[o.getItemLayout(g),d.getItemLayout(g)])}),this.markerGroupMap.get(a.id).updateLayout()}},this)},e.prototype.renderSeries=function(r,n,i,a){var l=r.coordinateSystem,c=r.id,o=r.getData(),d=this.markerGroupMap,g=d.get(c)||d.set(c,new HB);this.group.add(g.group);var m=Yze(l,r,n),y=m.from,x=m.to,A=m.line;mA(n).from=y,mA(n).to=x,n.setData(A);var M=n.get("symbol"),D=n.get("symbolSize"),P=n.get("symbolRotate"),O=n.get("symbolOffset");Ht(M)||(M=[M,M]),Ht(D)||(D=[D,D]),Ht(P)||(P=[P,P]),Ht(O)||(O=[O,O]),m.from.each(function(V){z(y,V,!0),z(x,V,!1)}),A.each(function(V){var H=A.getItemModel(V).getModel("lineStyle").getLineStyle();A.setItemLayout(V,[y.getItemLayout(V),x.getItemLayout(V)]),H.stroke==null&&(H.stroke=y.getItemVisual(V,"style").fill),A.setItemVisual(V,{fromSymbolKeepAspect:y.getItemVisual(V,"symbolKeepAspect"),fromSymbolOffset:y.getItemVisual(V,"symbolOffset"),fromSymbolRotate:y.getItemVisual(V,"symbolRotate"),fromSymbolSize:y.getItemVisual(V,"symbolSize"),fromSymbol:y.getItemVisual(V,"symbol"),toSymbolKeepAspect:x.getItemVisual(V,"symbolKeepAspect"),toSymbolOffset:x.getItemVisual(V,"symbolOffset"),toSymbolRotate:x.getItemVisual(V,"symbolRotate"),toSymbolSize:x.getItemVisual(V,"symbolSize"),toSymbol:x.getItemVisual(V,"symbol"),style:H})}),g.updateData(A),m.line.eachItemGraphicEl(function(V){Yr(V).dataModel=n,V.traverse(function(H){Yr(H).dataModel=n})});function z(V,H,$){var X=V.getItemModel(H);wR(V,H,$,r,a);var W=X.getModel("itemStyle").getItemStyle();W.fill==null&&(W.fill=Pb(o,"color")),V.setItemVisual(H,{symbolKeepAspect:X.get("symbolKeepAspect"),symbolOffset:tn(X.get("symbolOffset",!0),O[$?0:1]),symbolRotate:tn(X.get("symbolRotate",!0),P[$?0:1]),symbolSize:tn(X.get("symbolSize"),D[$?0:1]),symbol:tn(X.get("symbol",!0),M[$?0:1]),style:W})}this.markKeep(g),g.group.silent=n.get("silent")||r.get("silent")},e.type="markLine",e}(b5);function Yze(t,e,r){var n;t?n=Zt(t&&t.dimensions,function(d){var g=e.getData().getDimensionInfo(e.getData().mapDimension(d))||{};return Lt(Lt({},g),{name:d,ordinalMeta:null})}):n=[{name:"value",type:"float"}];var i=new ts(n,r),a=new ts(n,r),l=new ts([],r),c=Zt(r.get("data"),on(Wze,e,t,r));t&&(c=Ei(c,on(Zze,t)));var o=Dee(!!t,n);return i.initData(Zt(c,function(d){return d[0]}),null,o),a.initData(Zt(c,function(d){return d[1]}),null,o),l.initData(Zt(c,function(d){return d[2]})),l.hasItemOption=!0,{from:i,to:a,line:l}}function Xze(t){t.registerComponentModel(jze),t.registerComponentView(qze),t.registerPreprocessor(function(e){y5(e.series,"markLine")&&(e.markLine=e.markLine||{})})}var Qze=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.createMarkerModelFromSeries=function(r,n,i){return new e(r,n,i)},e.type="markArea",e.defaultOption={z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},e}(xh),_A=ri(),Kze=function(t,e,r,n){var i=n[0],a=n[1];if(!(!i||!a)){var l=cb(t,i),c=cb(t,a),o=l.coord,d=c.coord;o[0]=ho(o[0],-1/0),o[1]=ho(o[1],-1/0),d[0]=ho(d[0],1/0),d[1]=ho(d[1],1/0);var g=xz([{},l,c]);return g.coord=[l.coord,c.coord],g.x0=l.x,g.y0=l.y,g.x1=c.x,g.y1=c.y,g}};function cM(t){return!isNaN(t)&&!isFinite(t)}function R9(t,e,r,n){var i=1-t;return cM(e[i])&&cM(r[i])}function Jze(t,e){var r=e.coord[0],n=e.coord[1],i={coord:r,x:e.x0,y:e.y0},a={coord:n,x:e.x1,y:e.y1};return gv(t,"cartesian2d")?r&&n&&(R9(1,r,n)||R9(0,r,n))?!0:Gze(t,i,a):hb(t,i)||hb(t,a)}function k9(t,e,r,n,i){var a=n.coordinateSystem,l=t.getItemModel(e),c,o=dr(l.get(r[0]),i.getWidth()),d=dr(l.get(r[1]),i.getHeight());if(!isNaN(o)&&!isNaN(d))c=[o,d];else{if(n.getMarkerPosition){var g=t.getValues(["x0","y0"],e),m=t.getValues(["x1","y1"],e),y=a.clampData(g),x=a.clampData(m),A=[];r[0]==="x0"?A[0]=y[0]>x[0]?m[0]:g[0]:A[0]=y[0]>x[0]?g[0]:m[0],r[1]==="y0"?A[1]=y[1]>x[1]?m[1]:g[1]:A[1]=y[1]>x[1]?g[1]:m[1],c=n.getMarkerPosition(A,r,!0)}else{var M=t.get(r[0],e),D=t.get(r[1],e),P=[M,D];a.clampData&&a.clampData(P,P),c=a.dataToPoint(P,!0)}if(gv(a,"cartesian2d")){var O=a.getAxis("x"),z=a.getAxis("y"),M=t.get(r[0],e),D=t.get(r[1],e);cM(M)?c[0]=O.toGlobalCoord(O.getExtent()[r[0]==="x0"?0:1]):cM(D)&&(c[1]=z.toGlobalCoord(z.getExtent()[r[1]==="y0"?0:1]))}isNaN(o)||(c[0]=o),isNaN(d)||(c[1]=d)}return c}var O9=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]],eBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.updateTransform=function(r,n,i){n.eachSeries(function(a){var l=xh.getMarkerModelFromSeries(a,"markArea");if(l){var c=l.getData();c.each(function(o){var d=Zt(O9,function(m){return k9(c,o,m,a,i)});c.setItemLayout(o,d);var g=c.getItemGraphicEl(o);g.setShape("points",d)})}},this)},e.prototype.renderSeries=function(r,n,i,a){var l=r.coordinateSystem,c=r.id,o=r.getData(),d=this.markerGroupMap,g=d.get(c)||d.set(c,{group:new jr});this.group.add(g.group),this.markKeep(g);var m=tBe(l,r,n);n.setData(m),m.each(function(y){var x=Zt(O9,function(W){return k9(m,y,W,r,a)}),A=l.getAxis("x").scale,M=l.getAxis("y").scale,D=A.getExtent(),P=M.getExtent(),O=[A.parse(m.get("x0",y)),A.parse(m.get("x1",y))],z=[M.parse(m.get("y0",y)),M.parse(m.get("y1",y))];El(O),El(z);var V=!(D[0]>O[1]||D[1]<O[0]||P[0]>z[1]||P[1]<z[0]),H=!V;m.setItemLayout(y,{points:x,allClipped:H});var $=m.getItemModel(y).getModel("itemStyle").getItemStyle(),X=Pb(o,"color");$.fill||($.fill=X,yr($.fill)&&($.fill=CC($.fill,.4))),$.stroke||($.stroke=X),m.setItemVisual(y,"style",$)}),m.diff(_A(g).data).add(function(y){var x=m.getItemLayout(y);if(!x.allClipped){var A=new os({shape:{points:x.points}});m.setItemGraphicEl(y,A),g.group.add(A)}}).update(function(y,x){var A=_A(g).data.getItemGraphicEl(x),M=m.getItemLayout(y);M.allClipped?A&&g.group.remove(A):(A?li(A,{shape:{points:M.points}},n,y):A=new os({shape:{points:M.points}}),m.setItemGraphicEl(y,A),g.group.add(A))}).remove(function(y){var x=_A(g).data.getItemGraphicEl(y);g.group.remove(x)}).execute(),m.eachItemGraphicEl(function(y,x){var A=m.getItemModel(x),M=m.getItemVisual(x,"style");y.useStyle(m.getItemVisual(x,"style")),Ao(y,to(A),{labelFetcher:n,labelDataIndex:x,defaultText:m.getName(x)||"",inheritColor:yr(M.fill)?CC(M.fill,1):"#000"}),To(y,A),da(y,null,null,A.get(["emphasis","disabled"])),Yr(y).dataModel=n}),_A(g).data=m,g.group.silent=n.get("silent")||r.get("silent")},e.type="markArea",e}(b5);function tBe(t,e,r){var n,i,a=["x0","y0","x1","y1"];if(t){var l=Zt(t&&t.dimensions,function(d){var g=e.getData(),m=g.getDimensionInfo(g.mapDimension(d))||{};return Lt(Lt({},m),{name:d,ordinalMeta:null})});i=Zt(a,function(d,g){return{name:d,type:l[g%2].type}}),n=new ts(i,r)}else i=[{name:"value",type:"float"}],n=new ts(i,r);var c=Zt(r.get("data"),on(Kze,e,t,r));t&&(c=Ei(c,on(Jze,t)));var o=t?function(d,g,m,y){var x=d.coord[Math.floor(y/2)][y%2];return cd(x,i[y])}:function(d,g,m,y){return cd(d.value,i[y])};return n.initData(c,null,o),n.hasItemOption=!0,n}function rBe(t){t.registerComponentModel(Qze),t.registerComponentView(eBe),t.registerPreprocessor(function(e){y5(e.series,"markArea")&&(e.markArea=e.markArea||{})})}var nBe=function(t,e){if(e==="all")return{type:"all",title:t.getLocaleModel().get(["legend","selector","all"])};if(e==="inverse")return{type:"inverse",title:t.getLocaleModel().get(["legend","selector","inverse"])}},KO=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.layoutMode={type:"box",ignoreSize:!0},r}return e.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),r.selected=r.selected||{},this._updateSelector(r)},e.prototype.mergeOption=function(r,n){t.prototype.mergeOption.call(this,r,n),this._updateSelector(r)},e.prototype._updateSelector=function(r){var n=r.selector,i=this.ecModel;n===!0&&(n=r.selector=["all","inverse"]),Ht(n)&&fe(n,function(a,l){yr(a)&&(a={type:a}),n[l]=pn(a,nBe(i,a.type))})},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var r=this._data;if(r[0]&&this.get("selectedMode")==="single"){for(var n=!1,i=0;i<r.length;i++){var a=r[i].get("name");if(this.isSelected(a)){this.select(a),n=!0;break}}!n&&this.select(r[0].get("name"))}},e.prototype._updateData=function(r){var n=[],i=[];r.eachRawSeries(function(o){var d=o.name;i.push(d);var g;if(o.legendVisualProvider){var m=o.legendVisualProvider,y=m.getAllNames();r.isSeriesFiltered(o)||(i=i.concat(y)),y.length?n=n.concat(y):g=!0}else g=!0;g&&Dz(o)&&n.push(o.name)}),this._availableNames=i;var a=this.get("data")||n,l=Ir(),c=Zt(a,function(o){return(yr(o)||ii(o))&&(o={name:o}),l.get(o.name)?null:(l.set(o.name,!0),new bi(o,this,this.ecModel))},this);this._data=Ei(c,function(o){return!!o})},e.prototype.getData=function(){return this._data},e.prototype.select=function(r){var n=this.option.selected,i=this.get("selectedMode");if(i==="single"){var a=this._data;fe(a,function(l){n[l.get("name")]=!1})}n[r]=!0},e.prototype.unSelect=function(r){this.get("selectedMode")!=="single"&&(this.option.selected[r]=!1)},e.prototype.toggleSelected=function(r){var n=this.option.selected;n.hasOwnProperty(r)||(n[r]=!0),this[n[r]?"unSelect":"select"](r)},e.prototype.allSelect=function(){var r=this._data,n=this.option.selected;fe(r,function(i){n[i.get("name",!0)]=!0})},e.prototype.inverseSelect=function(){var r=this._data,n=this.option.selected;fe(r,function(i){var a=i.get("name",!0);n.hasOwnProperty(a)||(n[a]=!0),n[a]=!n[a]})},e.prototype.isSelected=function(r){var n=this.option.selected;return!(n.hasOwnProperty(r)&&!n[r])&&An(this._availableNames,r)>=0},e.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}($n),o_=on,JO=fe,yA=jr,Pee=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.newlineDisabled=!1,r}return e.prototype.init=function(){this.group.add(this._contentGroup=new yA),this.group.add(this._selectorGroup=new yA),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(r,n,i){var a=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!r.get("show",!0)){var l=r.get("align"),c=r.get("orient");(!l||l==="auto")&&(l=r.get("left")==="right"&&c==="vertical"?"right":"left");var o=r.get("selector",!0),d=r.get("selectorPosition",!0);o&&(!d||d==="auto")&&(d=c==="horizontal"?"end":"start"),this.renderInner(l,r,n,i,o,c,d);var g=r.getBoxLayoutParams(),m={width:i.getWidth(),height:i.getHeight()},y=r.get("padding"),x=Na(g,m,y),A=this.layoutInner(r,l,x,a,o,d),M=Na(Fr({width:A.width,height:A.height},g),m,y);this.group.x=M.x-A.x,this.group.y=M.y-A.y,this.group.markRedraw(),this.group.add(this._backgroundEl=yee(A,r))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(r,n,i,a,l,c,o){var d=this.getContentGroup(),g=Ir(),m=n.get("selectedMode"),y=[];i.eachRawSeries(function(x){!x.get("legendHoverLink")&&y.push(x.id)}),JO(n.getData(),function(x,A){var M=x.get("name");if(!this.newlineDisabled&&(M===""||M===`
`)){var D=new yA;D.newline=!0,d.add(D);return}var P=i.getSeriesByName(M)[0];if(!g.get(M))if(P){var O=P.getData(),z=O.getVisual("legendLineStyle")||{},V=O.getVisual("legendIcon"),H=O.getVisual("style"),$=this._createItem(P,M,A,x,n,r,z,H,V,m,a);$.on("click",o_(z9,M,null,a,y)).on("mouseover",o_(e3,P.name,null,a,y)).on("mouseout",o_(t3,P.name,null,a,y)),i.ssr&&$.eachChild(function(X){var W=Yr(X);W.seriesIndex=P.seriesIndex,W.dataIndex=A,W.ssrType="legend"}),g.set(M,!0)}else i.eachRawSeries(function(X){if(!g.get(M)&&X.legendVisualProvider){var W=X.legendVisualProvider;if(!W.containName(M))return;var Y=W.indexOfName(M),J=W.getItemVisual(Y,"style"),re=W.getItemVisual(Y,"legendIcon"),ae=Ks(J.fill);ae&&ae[3]===0&&(ae[3]=.2,J=Lt(Lt({},J),{fill:sh(ae,"rgba")}));var pe=this._createItem(X,M,A,x,n,r,{},J,re,m,a);pe.on("click",o_(z9,null,M,a,y)).on("mouseover",o_(e3,null,M,a,y)).on("mouseout",o_(t3,null,M,a,y)),i.ssr&&pe.eachChild(function(de){var ve=Yr(de);ve.seriesIndex=X.seriesIndex,ve.dataIndex=A,ve.ssrType="legend"}),g.set(M,!0)}},this)},this),l&&this._createSelector(l,n,a,c,o)},e.prototype._createSelector=function(r,n,i,a,l){var c=this.getSelectorGroup();JO(r,function(d){var g=d.type,m=new ti({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:g==="all"?"legendAllSelect":"legendInverseSelect"})}});c.add(m);var y=n.getModel("selectorLabel"),x=n.getModel(["emphasis","selectorLabel"]);Ao(m,{normal:y,emphasis:x},{defaultText:d.title}),Gg(m)})},e.prototype._createItem=function(r,n,i,a,l,c,o,d,g,m,y){var x=r.visualDrawType,A=l.get("itemWidth"),M=l.get("itemHeight"),D=l.isSelected(n),P=a.get("symbolRotate"),O=a.get("symbolKeepAspect"),z=a.get("icon");g=z||g||"roundRect";var V=iBe(g,a,o,d,x,D,y),H=new yA,$=a.getModel("textStyle");if(zr(r.getLegendIcon)&&(!z||z==="inherit"))H.add(r.getLegendIcon({itemWidth:A,itemHeight:M,icon:g,iconRotate:P,itemStyle:V.itemStyle,lineStyle:V.lineStyle,symbolKeepAspect:O}));else{var X=z==="inherit"&&r.getData().getVisual("symbol")?P==="inherit"?r.getData().getVisual("symbolRotate"):P:0;H.add(aBe({itemWidth:A,itemHeight:M,icon:g,iconRotate:X,itemStyle:V.itemStyle,lineStyle:V.lineStyle,symbolKeepAspect:O}))}var W=c==="left"?A+5:-5,Y=c,J=l.get("formatter"),re=n;yr(J)&&J?re=J.replace("{name}",n??""):zr(J)&&(re=J(n));var ae=D?$.getTextColor():a.get("inactiveColor");H.add(new ti({style:Hi($,{text:re,x:W,y:M/2,fill:ae,align:Y,verticalAlign:"middle"},{inheritColor:ae})}));var pe=new Kn({shape:H.getBoundingRect(),style:{fill:"transparent"}}),de=a.getModel("tooltip");return de.get("show")&&uy({el:pe,componentModel:l,itemName:n,itemTooltipOption:de.option}),H.add(pe),H.eachChild(function(ve){ve.silent=!0}),pe.silent=!m,this.getContentGroup().add(H),Gg(H),H.__legendDataIndex=i,H},e.prototype.layoutInner=function(r,n,i,a,l,c){var o=this.getContentGroup(),d=this.getSelectorGroup();$g(r.get("orient"),o,r.get("itemGap"),i.width,i.height);var g=o.getBoundingRect(),m=[-g.x,-g.y];if(d.markRedraw(),o.markRedraw(),l){$g("horizontal",d,r.get("selectorItemGap",!0));var y=d.getBoundingRect(),x=[-y.x,-y.y],A=r.get("selectorButtonGap",!0),M=r.getOrient().index,D=M===0?"width":"height",P=M===0?"height":"width",O=M===0?"y":"x";c==="end"?x[M]+=g[D]+A:m[M]+=y[D]+A,x[1-M]+=g[P]/2-y[P]/2,d.x=x[0],d.y=x[1],o.x=m[0],o.y=m[1];var z={x:0,y:0};return z[D]=g[D]+A+y[D],z[P]=Math.max(g[P],y[P]),z[O]=Math.min(0,y[O]+x[1-M]),z}else return o.x=m[0],o.y=m[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}(ra);function iBe(t,e,r,n,i,a,l){function c(D,P){D.lineWidth==="auto"&&(D.lineWidth=P.lineWidth>0?2:0),JO(D,function(O,z){D[z]==="inherit"&&(D[z]=P[z])})}var o=e.getModel("itemStyle"),d=o.getItemStyle(),g=t.lastIndexOf("empty",0)===0?"fill":"stroke",m=o.getShallow("decal");d.decal=!m||m==="inherit"?n.decal:j_(m,l),d.fill==="inherit"&&(d.fill=n[i]),d.stroke==="inherit"&&(d.stroke=n[g]),d.opacity==="inherit"&&(d.opacity=(i==="fill"?n:r).opacity),c(d,n);var y=e.getModel("lineStyle"),x=y.getLineStyle();if(c(x,r),d.fill==="auto"&&(d.fill=n.fill),d.stroke==="auto"&&(d.stroke=n.fill),x.stroke==="auto"&&(x.stroke=n.fill),!a){var A=e.get("inactiveBorderWidth"),M=d[g];d.lineWidth=A==="auto"?n.lineWidth>0&&M?2:0:d.lineWidth,d.fill=e.get("inactiveColor"),d.stroke=e.get("inactiveBorderColor"),x.stroke=y.get("inactiveColor"),x.lineWidth=y.get("inactiveWidth")}return{itemStyle:d,lineStyle:x}}function aBe(t){var e=t.icon||"roundRect",r=Ia(e,0,0,t.itemWidth,t.itemHeight,t.itemStyle.fill,t.symbolKeepAspect);return r.setStyle(t.itemStyle),r.rotation=(t.iconRotate||0)*Math.PI/180,r.setOrigin([t.itemWidth/2,t.itemHeight/2]),e.indexOf("empty")>-1&&(r.style.stroke=r.style.fill,r.style.fill="#fff",r.style.lineWidth=2),r}function z9(t,e,r,n){t3(t,e,r,n),r.dispatchAction({type:"legendToggleSelect",name:t??e}),e3(t,e,r,n)}function Lee(t){for(var e=t.getZr().storage.getDisplayList(),r,n=0,i=e.length;n<i&&!(r=e[n].states.emphasis);)n++;return r&&r.hoverLayer}function e3(t,e,r,n){Lee(r)||r.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:n})}function t3(t,e,r,n){Lee(r)||r.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:n})}function oBe(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries(function(r){for(var n=0;n<e.length;n++)if(!e[n].isSelected(r.name))return!1;return!0})}function Rx(t,e,r){var n={},i=t==="toggleSelected",a;return r.eachComponent("legend",function(l){i&&a!=null?l[a?"select":"unSelect"](e.name):t==="allSelect"||t==="inverseSelect"?l[t]():(l[t](e.name),a=l.isSelected(e.name));var c=l.getData();fe(c,function(o){var d=o.get("name");if(!(d===`
`||d==="")){var g=l.isSelected(d);n.hasOwnProperty(d)?n[d]=n[d]&&g:n[d]=g}})}),t==="allSelect"||t==="inverseSelect"?{selected:n}:{name:e.name,selected:n}}function sBe(t){t.registerAction("legendToggleSelect","legendselectchanged",on(Rx,"toggleSelected")),t.registerAction("legendAllSelect","legendselectall",on(Rx,"allSelect")),t.registerAction("legendInverseSelect","legendinverseselect",on(Rx,"inverseSelect")),t.registerAction("legendSelect","legendselected",on(Rx,"select")),t.registerAction("legendUnSelect","legendunselected",on(Rx,"unSelect"))}function Ree(t){t.registerComponentModel(KO),t.registerComponentView(Pee),t.registerProcessor(t.PRIORITY.PROCESSOR.SERIES_FILTER,oBe),t.registerSubTypeDefaulter("legend",function(){return"plain"}),sBe(t)}var lBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.setScrollDataIndex=function(r){this.option.scrollDataIndex=r},e.prototype.init=function(r,n,i){var a=dy(r);t.prototype.init.call(this,r,n,i),B9(this,r,a)},e.prototype.mergeOption=function(r,n){t.prototype.mergeOption.call(this,r,n),B9(this,this.option,r)},e.type="legend.scroll",e.defaultOption=Ed(KO.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(KO);function B9(t,e,r){var n=t.getOrient(),i=[1,1];i[n.index]=0,_d(e,r,{type:"box",ignoreSize:!!i})}var F9=jr,SR=["width","height"],TR=["x","y"],uBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.newlineDisabled=!0,r._currentIndex=0,r}return e.prototype.init=function(){t.prototype.init.call(this),this.group.add(this._containerGroup=new F9),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new F9)},e.prototype.resetInner=function(){t.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(r,n,i,a,l,c,o){var d=this;t.prototype.renderInner.call(this,r,n,i,a,l,c,o);var g=this._controllerGroup,m=n.get("pageIconSize",!0),y=Ht(m)?m:[m,m];A("pagePrev",0);var x=n.getModel("pageTextStyle");g.add(new ti({name:"pageText",style:{text:"xx/xx",fill:x.getTextColor(),font:x.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),A("pageNext",1);function A(M,D){var P=M+"DataIndex",O=Eb(n.get("pageIcons",!0)[n.getOrient().name][D],{onclick:wr(d._pageGo,d,P,n,a)},{x:-y[0]/2,y:-y[1]/2,width:y[0],height:y[1]});O.name=M,g.add(O)}},e.prototype.layoutInner=function(r,n,i,a,l,c){var o=this.getSelectorGroup(),d=r.getOrient().index,g=SR[d],m=TR[d],y=SR[1-d],x=TR[1-d];l&&$g("horizontal",o,r.get("selectorItemGap",!0));var A=r.get("selectorButtonGap",!0),M=o.getBoundingRect(),D=[-M.x,-M.y],P=$r(i);l&&(P[g]=i[g]-M[g]-A);var O=this._layoutContentAndController(r,a,P,d,g,y,x,m);if(l){if(c==="end")D[d]+=O[g]+A;else{var z=M[g]+A;D[d]-=z,O[m]-=z}O[g]+=M[g]+A,D[1-d]+=O[x]+O[y]/2-M[y]/2,O[y]=Math.max(O[y],M[y]),O[x]=Math.min(O[x],M[x]+D[1-d]),o.x=D[0],o.y=D[1],o.markRedraw()}return O},e.prototype._layoutContentAndController=function(r,n,i,a,l,c,o,d){var g=this.getContentGroup(),m=this._containerGroup,y=this._controllerGroup;$g(r.get("orient"),g,r.get("itemGap"),a?i.width:null,a?null:i.height),$g("horizontal",y,r.get("pageButtonItemGap",!0));var x=g.getBoundingRect(),A=y.getBoundingRect(),M=this._showController=x[l]>i[l],D=[-x.x,-x.y];n||(D[a]=g[d]);var P=[0,0],O=[-A.x,-A.y],z=tn(r.get("pageButtonGap",!0),r.get("itemGap",!0));if(M){var V=r.get("pageButtonPosition",!0);V==="end"?O[a]+=i[l]-A[l]:P[a]+=A[l]+z}O[1-a]+=x[c]/2-A[c]/2,g.setPosition(D),m.setPosition(P),y.setPosition(O);var H={x:0,y:0};if(H[l]=M?i[l]:x[l],H[c]=Math.max(x[c],A[c]),H[o]=Math.min(0,A[o]+O[1-a]),m.__rectSize=i[l],M){var $={x:0,y:0};$[l]=Math.max(i[l]-A[l]-z,0),$[c]=H[c],m.setClipPath(new Kn({shape:$})),m.__rectSize=$[l]}else y.eachChild(function(W){W.attr({invisible:!0,silent:!0})});var X=this._getPageInfo(r);return X.pageIndex!=null&&li(g,{x:X.contentPosition[0],y:X.contentPosition[1]},M?r:null),this._updatePageInfoView(r,X),H},e.prototype._pageGo=function(r,n,i){var a=this._getPageInfo(n)[r];a!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:a,legendId:n.id})},e.prototype._updatePageInfoView=function(r,n){var i=this._controllerGroup;fe(["pagePrev","pageNext"],function(g){var m=g+"DataIndex",y=n[m]!=null,x=i.childOfName(g);x&&(x.setStyle("fill",y?r.get("pageIconColor",!0):r.get("pageIconInactiveColor",!0)),x.cursor=y?"pointer":"default")});var a=i.childOfName("pageText"),l=r.get("pageFormatter"),c=n.pageIndex,o=c!=null?c+1:0,d=n.pageCount;a&&l&&a.setStyle("text",yr(l)?l.replace("{current}",o==null?"":o+"").replace("{total}",d==null?"":d+""):l({current:o,total:d}))},e.prototype._getPageInfo=function(r){var n=r.get("scrollDataIndex",!0),i=this.getContentGroup(),a=this._containerGroup.__rectSize,l=r.getOrient().index,c=SR[l],o=TR[l],d=this._findTargetItemIndex(n),g=i.children(),m=g[d],y=g.length,x=y?1:0,A={contentPosition:[i.x,i.y],pageCount:x,pageIndex:x-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!m)return A;var M=V(m);A.contentPosition[l]=-M.s;for(var D=d+1,P=M,O=M,z=null;D<=y;++D)z=V(g[D]),(!z&&O.e>P.s+a||z&&!H(z,P.s))&&(O.i>P.i?P=O:P=z,P&&(A.pageNextDataIndex==null&&(A.pageNextDataIndex=P.i),++A.pageCount)),O=z;for(var D=d-1,P=M,O=M,z=null;D>=-1;--D)z=V(g[D]),(!z||!H(O,z.s))&&P.i<O.i&&(O=P,A.pagePrevDataIndex==null&&(A.pagePrevDataIndex=P.i),++A.pageCount,++A.pageIndex),P=z;return A;function V($){if($){var X=$.getBoundingRect(),W=X[o]+$[o];return{s:W,e:W+X[c],i:$.__legendDataIndex}}}function H($,X){return $.e>=X&&$.s<=X+a}},e.prototype._findTargetItemIndex=function(r){if(!this._showController)return 0;var n,i=this.getContentGroup(),a;return i.eachChild(function(l,c){var o=l.__legendDataIndex;a==null&&o!=null&&(a=c),o===r&&(n=c)}),n??a},e.type="legend.scroll",e}(Pee);function cBe(t){t.registerAction("legendScroll","legendscroll",function(e,r){var n=e.scrollDataIndex;n!=null&&r.eachComponent({mainType:"legend",subType:"scroll",query:e},function(i){i.setScrollDataIndex(n)})})}function hBe(t){En(Ree),t.registerComponentModel(lBe),t.registerComponentView(uBe),cBe(t)}function fBe(t){En(Ree),En(hBe)}var dBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="dataZoom.inside",e.defaultOption=Ed(ub.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),e}(ub),w5=ri();function pBe(t,e,r){w5(t).coordSysRecordMap.each(function(n){var i=n.dataZoomInfoMap.get(e.uid);i&&(i.getRange=r)})}function gBe(t,e){for(var r=w5(t).coordSysRecordMap,n=r.keys(),i=0;i<n.length;i++){var a=n[i],l=r.get(a),c=l.dataZoomInfoMap;if(c){var o=e.uid,d=c.get(o);d&&(c.removeKey(o),c.keys().length||kee(r,l))}}}function kee(t,e){if(e){t.removeKey(e.model.uid);var r=e.controller;r&&r.dispose()}}function vBe(t,e){var r={model:e,containsPoint:on(_Be,e),dispatchAction:on(mBe,t),dataZoomInfoMap:null,controller:null},n=r.controller=new Gb(t.getZr());return fe(["pan","zoom","scrollMove"],function(i){n.on(i,function(a){var l=[];r.dataZoomInfoMap.each(function(c){if(a.isAvailableBehavior(c.model.option)){var o=(c.getRange||{})[i],d=o&&o(c.dzReferCoordSysInfo,r.model.mainType,r.controller,a);!c.model.get("disabled",!0)&&d&&l.push({dataZoomId:c.model.id,start:d[0],end:d[1]})}}),l.length&&r.dispatchAction(l)})}),r}function mBe(t,e){t.isDisposed()||t.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:e})}function _Be(t,e,r,n){return t.coordinateSystem.containPoint([r,n])}function yBe(t){var e,r="type_",n={type_true:2,type_move:1,type_false:0,type_undefined:-1},i=!0;return t.each(function(a){var l=a.model,c=l.get("disabled",!0)?!1:l.get("zoomLock",!0)?"move":!0;n[r+c]>n[r+e]&&(e=c),i=i&&l.get("preventDefaultMouseMove",!0)}),{controlType:e,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!i}}}function xBe(t){t.registerProcessor(t.PRIORITY.PROCESSOR.FILTER,function(e,r){var n=w5(r),i=n.coordSysRecordMap||(n.coordSysRecordMap=Ir());i.each(function(a){a.dataZoomInfoMap=null}),e.eachComponent({mainType:"dataZoom",subType:"inside"},function(a){var l=vee(a);fe(l.infoList,function(c){var o=c.model.uid,d=i.get(o)||i.set(o,vBe(r,c.model)),g=d.dataZoomInfoMap||(d.dataZoomInfoMap=Ir());g.set(a.uid,{dzReferCoordSysInfo:c,model:a,getRange:null})})}),i.each(function(a){var l=a.controller,c,o=a.dataZoomInfoMap;if(o){var d=o.keys()[0];d!=null&&(c=o.get(d))}if(!c){kee(i,a);return}var g=yBe(o);l.enable(g.controlType,g.opt),l.setPointerChecker(a.containsPoint),vy(a,"dispatchAction",c.model.get("throttle",!0),"fixRate")})})}var bBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="dataZoom.inside",r}return e.prototype.render=function(r,n,i){if(t.prototype.render.apply(this,arguments),r.noTarget()){this._clear();return}this.range=r.getPercentRange(),pBe(i,r,{pan:wr(AR.pan,this),zoom:wr(AR.zoom,this),scrollMove:wr(AR.scrollMove,this)})},e.prototype.dispose=function(){this._clear(),t.prototype.dispose.apply(this,arguments)},e.prototype._clear=function(){gBe(this.api,this.dataZoomModel),this.range=null},e.type="dataZoom.inside",e}(d5),AR={zoom:function(t,e,r,n){var i=this.range,a=i.slice(),l=t.axisModels[0];if(l){var c=CR[e](null,[n.originX,n.originY],l,r,t),o=(c.signal>0?c.pixelStart+c.pixelLength-c.pixel:c.pixel-c.pixelStart)/c.pixelLength*(a[1]-a[0])+a[0],d=Math.max(1/n.scale,0);a[0]=(a[0]-o)*d+o,a[1]=(a[1]-o)*d+o;var g=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(mv(0,a,[0,100],0,g.minSpan,g.maxSpan),this.range=a,i[0]!==a[0]||i[1]!==a[1])return a}},pan:N9(function(t,e,r,n,i,a){var l=CR[n]([a.oldX,a.oldY],[a.newX,a.newY],e,i,r);return l.signal*(t[1]-t[0])*l.pixel/l.pixelLength}),scrollMove:N9(function(t,e,r,n,i,a){var l=CR[n]([0,0],[a.scrollDelta,a.scrollDelta],e,i,r);return l.signal*(t[1]-t[0])*a.scrollDelta})};function N9(t){return function(e,r,n,i){var a=this.range,l=a.slice(),c=e.axisModels[0];if(c){var o=t(l,c,e,r,n,i);if(mv(o,l,[0,100],"all"),this.range=l,a[0]!==l[0]||a[1]!==l[1])return l}}}var CR={grid:function(t,e,r,n,i){var a=r.axis,l={},c=i.model.coordinateSystem.getRect();return t=t||[0,0],a.dim==="x"?(l.pixel=e[0]-t[0],l.pixelLength=c.width,l.pixelStart=c.x,l.signal=a.inverse?1:-1):(l.pixel=e[1]-t[1],l.pixelLength=c.height,l.pixelStart=c.y,l.signal=a.inverse?-1:1),l},polar:function(t,e,r,n,i){var a=r.axis,l={},c=i.model.coordinateSystem,o=c.getRadiusAxis().getExtent(),d=c.getAngleAxis().getExtent();return t=t?c.pointToCoord(t):[0,0],e=c.pointToCoord(e),r.mainType==="radiusAxis"?(l.pixel=e[0]-t[0],l.pixelLength=o[1]-o[0],l.pixelStart=o[0],l.signal=a.inverse?1:-1):(l.pixel=e[1]-t[1],l.pixelLength=d[1]-d[0],l.pixelStart=d[0],l.signal=a.inverse?-1:1),l},singleAxis:function(t,e,r,n,i){var a=r.axis,l=i.model.coordinateSystem.getRect(),c={};return t=t||[0,0],a.orient==="horizontal"?(c.pixel=e[0]-t[0],c.pixelLength=l.width,c.pixelStart=l.x,c.signal=a.inverse?1:-1):(c.pixel=e[1]-t[1],c.pixelLength=l.height,c.pixelStart=l.y,c.signal=a.inverse?-1:1),c}};function Oee(t){p5(t),t.registerComponentModel(dBe),t.registerComponentView(bBe),xBe(t)}var wBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.type="dataZoom.slider",e.layoutMode="box",e.defaultOption=Ed(ub.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),e}(ub),kx=Kn,V9=7,SBe=1,MR=30,TBe=7,Ox="horizontal",G9="vertical",ABe=5,CBe=["line","bar","candlestick","scatter"],MBe={easing:"cubicOut",duration:100,delay:0},IBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._displayables={},r}return e.prototype.init=function(r,n){this.api=n,this._onBrush=wr(this._onBrush,this),this._onBrushEnd=wr(this._onBrushEnd,this)},e.prototype.render=function(r,n,i,a){if(t.prototype.render.apply(this,arguments),vy(this,"_dispatchZoomAction",r.get("throttle"),"fixRate"),this._orient=r.getOrient(),r.get("show")===!1){this.group.removeAll();return}if(r.noTarget()){this._clear(),this.group.removeAll();return}(!a||a.type!=="dataZoom"||a.from!==this.uid)&&this._buildView(),this._updateView()},e.prototype.dispose=function(){this._clear(),t.prototype.dispose.apply(this,arguments)},e.prototype._clear=function(){X1(this,"_dispatchZoomAction");var r=this.api.getZr();r.off("mousemove",this._onBrush),r.off("mouseup",this._onBrushEnd)},e.prototype._buildView=function(){var r=this.group;r.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var n=this._displayables.sliderGroup=new jr;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),r.add(n),this._positionGroup()},e.prototype._resetLocation=function(){var r=this.dataZoomModel,n=this.api,i=r.get("brushSelect"),a=i?TBe:0,l=this._findCoordRect(),c={width:n.getWidth(),height:n.getHeight()},o=this._orient===Ox?{right:c.width-l.x-l.width,top:c.height-MR-V9-a,width:l.width,height:MR}:{right:V9,top:l.y,width:MR,height:l.height},d=dy(r.option);fe(["right","top","width","height"],function(m){d[m]==="ph"&&(d[m]=o[m])});var g=Na(d,c);this._location={x:g.x,y:g.y},this._size=[g.width,g.height],this._orient===G9&&this._size.reverse()},e.prototype._positionGroup=function(){var r=this.group,n=this._location,i=this._orient,a=this.dataZoomModel.getFirstTargetAxisModel(),l=a&&a.get("inverse"),c=this._displayables.sliderGroup,o=(this._dataShadowInfo||{}).otherAxisInverse;c.attr(i===Ox&&!l?{scaleY:o?1:-1,scaleX:1}:i===Ox&&l?{scaleY:o?1:-1,scaleX:-1}:i===G9&&!l?{scaleY:o?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:o?-1:1,scaleX:-1,rotation:Math.PI/2});var d=r.getBoundingRect([c]);r.x=n.x-d.x,r.y=n.y-d.y,r.markRedraw()},e.prototype._getViewExtent=function(){return[0,this._size[0]]},e.prototype._renderBackground=function(){var r=this.dataZoomModel,n=this._size,i=this._displayables.sliderGroup,a=r.get("brushSelect");i.add(new kx({silent:!0,shape:{x:0,y:0,width:n[0],height:n[1]},style:{fill:r.get("backgroundColor")},z2:-40}));var l=new kx({shape:{x:0,y:0,width:n[0],height:n[1]},style:{fill:"transparent"},z2:0,onclick:wr(this._onClickPanel,this)}),c=this.api.getZr();a?(l.on("mousedown",this._onBrushStart,this),l.cursor="crosshair",c.on("mousemove",this._onBrush),c.on("mouseup",this._onBrushEnd)):(c.off("mousemove",this._onBrush),c.off("mouseup",this._onBrushEnd)),i.add(l)},e.prototype._renderDataShadow=function(){var r=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!r)return;var n=this._size,i=this._shadowSize||[],a=r.series,l=a.getRawData(),c=a.getShadowDim&&a.getShadowDim(),o=c&&l.getDimensionInfo(c)?a.getShadowDim():r.otherDim;if(o==null)return;var d=this._shadowPolygonPts,g=this._shadowPolylinePts;if(l!==this._shadowData||o!==this._shadowDim||n[0]!==i[0]||n[1]!==i[1]){var m=l.getDataExtent(o),y=(m[1]-m[0])*.3;m=[m[0]-y,m[1]+y];var x=[0,n[1]],A=[0,n[0]],M=[[n[0],0],[0,0]],D=[],P=A[1]/(l.count()-1),O=0,z=Math.round(l.count()/n[0]),V;l.each([o],function(Y,J){if(z>0&&J%z){O+=P;return}var re=Y==null||isNaN(Y)||Y==="",ae=re?0:Ci(Y,m,x,!0);re&&!V&&J?(M.push([M[M.length-1][0],0]),D.push([D[D.length-1][0],0])):!re&&V&&(M.push([O,0]),D.push([O,0])),M.push([O,ae]),D.push([O,ae]),O+=P,V=re}),d=this._shadowPolygonPts=M,g=this._shadowPolylinePts=D}this._shadowData=l,this._shadowDim=o,this._shadowSize=[n[0],n[1]];var H=this.dataZoomModel;function $(Y){var J=H.getModel(Y?"selectedDataBackground":"dataBackground"),re=new jr,ae=new os({shape:{points:d},segmentIgnoreThreshold:1,style:J.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),pe=new ls({shape:{points:g},segmentIgnoreThreshold:1,style:J.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return re.add(ae),re.add(pe),re}for(var X=0;X<3;X++){var W=$(X===1);this._displayables.sliderGroup.add(W),this._displayables.dataShadowSegs.push(W)}},e.prototype._prepareDataShadowInfo=function(){var r=this.dataZoomModel,n=r.get("showDataShadow");if(n!==!1){var i,a=this.ecModel;return r.eachTargetAxis(function(l,c){var o=r.getAxisProxy(l,c).getTargetSeriesModels();fe(o,function(d){if(!i&&!(n!==!0&&An(CBe,d.get("type"))<0)){var g=a.getComponent(nd(l),c).axis,m=EBe(l),y,x=d.coordinateSystem;m!=null&&x.getOtherAxis&&(y=x.getOtherAxis(g).inverse),m=d.getData().mapDimension(m),i={thisAxis:g,series:d,thisDim:l,otherDim:m,otherAxisInverse:y}}},this)},this),i}},e.prototype._renderHandle=function(){var r=this.group,n=this._displayables,i=n.handles=[null,null],a=n.handleLabels=[null,null],l=this._displayables.sliderGroup,c=this._size,o=this.dataZoomModel,d=this.api,g=o.get("borderRadius")||0,m=o.get("brushSelect"),y=n.filler=new kx({silent:m,style:{fill:o.get("fillerColor")},textConfig:{position:"inside"}});l.add(y),l.add(new kx({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:c[0],height:c[1],r:g},style:{stroke:o.get("dataBackgroundColor")||o.get("borderColor"),lineWidth:SBe,fill:"rgba(0,0,0,0)"}})),fe([0,1],function(z){var V=o.get("handleIcon");!GC[V]&&V.indexOf("path://")<0&&V.indexOf("image://")<0&&(V="path://"+V);var H=Ia(V,-1,0,2,2,null,!0);H.attr({cursor:U9(this._orient),draggable:!0,drift:wr(this._onDragMove,this,z),ondragend:wr(this._onDragEnd,this),onmouseover:wr(this._showDataInfo,this,!0),onmouseout:wr(this._showDataInfo,this,!1),z2:5});var $=H.getBoundingRect(),X=o.get("handleSize");this._handleHeight=dr(X,this._size[1]),this._handleWidth=$.width/$.height*this._handleHeight,H.setStyle(o.getModel("handleStyle").getItemStyle()),H.style.strokeNoScale=!0,H.rectHover=!0,H.ensureState("emphasis").style=o.getModel(["emphasis","handleStyle"]).getItemStyle(),Gg(H);var W=o.get("handleColor");W!=null&&(H.style.fill=W),l.add(i[z]=H);var Y=o.getModel("textStyle");r.add(a[z]=new ti({silent:!0,invisible:!0,style:Hi(Y,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:Y.getTextColor(),font:Y.getFont()}),z2:10}))},this);var x=y;if(m){var A=dr(o.get("moveHandleSize"),c[1]),M=n.moveHandle=new Kn({style:o.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:c[1]-.5,height:A}}),D=A*.8,P=n.moveHandleIcon=Ia(o.get("moveHandleIcon"),-D/2,-D/2,D,D,"#fff",!0);P.silent=!0,P.y=c[1]+A/2-.5,M.ensureState("emphasis").style=o.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var O=Math.min(c[1]/2,Math.max(A,10));x=n.moveZone=new Kn({invisible:!0,shape:{y:c[1]-O,height:A+O}}),x.on("mouseover",function(){d.enterEmphasis(M)}).on("mouseout",function(){d.leaveEmphasis(M)}),l.add(M),l.add(P),l.add(x)}x.attr({draggable:!0,cursor:U9(this._orient),drift:wr(this._onDragMove,this,"all"),ondragstart:wr(this._showDataInfo,this,!0),ondragend:wr(this._onDragEnd,this),onmouseover:wr(this._showDataInfo,this,!0),onmouseout:wr(this._showDataInfo,this,!1)})},e.prototype._resetInterval=function(){var r=this._range=this.dataZoomModel.getPercentRange(),n=this._getViewExtent();this._handleEnds=[Ci(r[0],[0,100],n,!0),Ci(r[1],[0,100],n,!0)]},e.prototype._updateInterval=function(r,n){var i=this.dataZoomModel,a=this._handleEnds,l=this._getViewExtent(),c=i.findRepresentativeAxisProxy().getMinMaxSpan(),o=[0,100];mv(n,a,l,i.get("zoomLock")?"all":r,c.minSpan!=null?Ci(c.minSpan,o,l,!0):null,c.maxSpan!=null?Ci(c.maxSpan,o,l,!0):null);var d=this._range,g=this._range=El([Ci(a[0],l,o,!0),Ci(a[1],l,o,!0)]);return!d||d[0]!==g[0]||d[1]!==g[1]},e.prototype._updateView=function(r){var n=this._displayables,i=this._handleEnds,a=El(i.slice()),l=this._size;fe([0,1],function(x){var A=n.handles[x],M=this._handleHeight;A.attr({scaleX:M/2,scaleY:M/2,x:i[x]+(x?-1:1),y:l[1]/2-M/2})},this),n.filler.setShape({x:a[0],y:0,width:a[1]-a[0],height:l[1]});var c={x:a[0],width:a[1]-a[0]};n.moveHandle&&(n.moveHandle.setShape(c),n.moveZone.setShape(c),n.moveZone.getBoundingRect(),n.moveHandleIcon&&n.moveHandleIcon.attr("x",c.x+c.width/2));for(var o=n.dataShadowSegs,d=[0,a[0],a[1],l[0]],g=0;g<o.length;g++){var m=o[g],y=m.getClipPath();y||(y=new Kn,m.setClipPath(y)),y.setShape({x:d[g],y:0,width:d[g+1]-d[g],height:l[1]})}this._updateDataInfo(r)},e.prototype._updateDataInfo=function(r){var n=this.dataZoomModel,i=this._displayables,a=i.handleLabels,l=this._orient,c=["",""];if(n.get("showDetail")){var o=n.findRepresentativeAxisProxy();if(o){var d=o.getAxisModel().axis,g=this._range,m=r?o.calculateDataWindow({start:g[0],end:g[1]}).valueWindow:o.getDataValueWindow();c=[this._formatLabel(m[0],d),this._formatLabel(m[1],d)]}}var y=El(this._handleEnds.slice());x.call(this,0),x.call(this,1);function x(A){var M=Ug(i.handles[A].parent,this.group),D=dI(A===0?"right":"left",M),P=this._handleWidth/2+ABe,O=vu([y[A]+(A===0?-P:P),this._size[1]/2],M);a[A].setStyle({x:O[0],y:O[1],verticalAlign:l===Ox?"middle":D,align:l===Ox?D:"center",text:c[A]})}},e.prototype._formatLabel=function(r,n){var i=this.dataZoomModel,a=i.get("labelFormatter"),l=i.get("labelPrecision");(l==null||l==="auto")&&(l=n.getPixelPrecision());var c=r==null||isNaN(r)?"":n.type==="category"||n.type==="time"?n.scale.getLabel({value:Math.round(r)}):r.toFixed(Math.min(l,20));return zr(a)?a(r,c):yr(a)?a.replace("{value}",c):c},e.prototype._showDataInfo=function(r){r=this._dragging||r;var n=this._displayables,i=n.handleLabels;i[0].attr("invisible",!r),i[1].attr("invisible",!r),n.moveHandle&&this.api[r?"enterEmphasis":"leaveEmphasis"](n.moveHandle,1)},e.prototype._onDragMove=function(r,n,i,a){this._dragging=!0,dh(a.event);var l=this._displayables.sliderGroup.getLocalTransform(),c=vu([n,i],l,!0),o=this._updateInterval(r,c[0]),d=this.dataZoomModel.get("realtime");this._updateView(!d),o&&d&&this._dispatchZoomAction(!0)},e.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var r=this.dataZoomModel.get("realtime");!r&&this._dispatchZoomAction(!1)},e.prototype._onClickPanel=function(r){var n=this._size,i=this._displayables.sliderGroup.transformCoordToLocal(r.offsetX,r.offsetY);if(!(i[0]<0||i[0]>n[0]||i[1]<0||i[1]>n[1])){var a=this._handleEnds,l=(a[0]+a[1])/2,c=this._updateInterval("all",i[0]-l);this._updateView(),c&&this._dispatchZoomAction(!1)}},e.prototype._onBrushStart=function(r){var n=r.offsetX,i=r.offsetY;this._brushStart=new hn(n,i),this._brushing=!0,this._brushStartTime=+new Date},e.prototype._onBrushEnd=function(r){if(this._brushing){var n=this._displayables.brushRect;if(this._brushing=!1,!!n){n.attr("ignore",!0);var i=n.shape,a=+new Date;if(!(a-this._brushStartTime<200&&Math.abs(i.width)<5)){var l=this._getViewExtent(),c=[0,100];this._range=El([Ci(i.x,l,c,!0),Ci(i.x+i.width,l,c,!0)]),this._handleEnds=[i.x,i.x+i.width],this._updateView(),this._dispatchZoomAction(!1)}}}},e.prototype._onBrush=function(r){this._brushing&&(dh(r.event),this._updateBrushRect(r.offsetX,r.offsetY))},e.prototype._updateBrushRect=function(r,n){var i=this._displayables,a=this.dataZoomModel,l=i.brushRect;l||(l=i.brushRect=new kx({silent:!0,style:a.getModel("brushStyle").getItemStyle()}),i.sliderGroup.add(l)),l.attr("ignore",!1);var c=this._brushStart,o=this._displayables.sliderGroup,d=o.transformCoordToLocal(r,n),g=o.transformCoordToLocal(c.x,c.y),m=this._size;d[0]=Math.max(Math.min(m[0],d[0]),0),l.setShape({x:g[0],y:0,width:d[0]-g[0],height:m[1]})},e.prototype._dispatchZoomAction=function(r){var n=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:r?MBe:null,start:n[0],end:n[1]})},e.prototype._findCoordRect=function(){var r,n=vee(this.dataZoomModel).infoList;if(!r&&n.length){var i=n[0].model.coordinateSystem;r=i.getRect&&i.getRect()}if(!r){var a=this.api.getWidth(),l=this.api.getHeight();r={x:a*.2,y:l*.2,width:a*.6,height:l*.6}}return r},e.type="dataZoom.slider",e}(d5);function EBe(t){var e={x:"y",y:"x",radius:"angle",angle:"radius"};return e[t]}function U9(t){return t==="vertical"?"ns-resize":"ew-resize"}function zee(t){t.registerComponentModel(wBe),t.registerComponentView(IBe),p5(t)}function DBe(t){En(Oee),En(zee)}var Bee={get:function(t,e,r){var n=$r((PBe[t]||{})[e]);return r&&Ht(n)?n[n.length-1]:n}},PBe={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},$9=eo.mapVisual,LBe=eo.eachVisual,RBe=Ht,H9=fe,kBe=El,OBe=Ci,hM=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.stateList=["inRange","outOfRange"],r.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],r.layoutMode={type:"box",ignoreSize:!0},r.dataBound=[-1/0,1/0],r.targetVisuals={},r.controllerVisuals={},r}return e.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},e.prototype.optionUpdated=function(r,n){var i=this.option;!n&&Cee(i,r,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},e.prototype.resetVisual=function(r){var n=this.stateList;r=wr(r,this),this.controllerVisuals=YO(this.option.controller,n,r),this.targetVisuals=YO(this.option.target,n,r)},e.prototype.getItemSymbol=function(){return null},e.prototype.getTargetSeriesIndices=function(){var r=this.option.seriesIndex,n=[];return r==null||r==="all"?this.ecModel.eachSeries(function(i,a){n.push(a)}):n=Pi(r),n},e.prototype.eachTargetSeries=function(r,n){fe(this.getTargetSeriesIndices(),function(i){var a=this.ecModel.getSeriesByIndex(i);a&&r.call(n,a)},this)},e.prototype.isTargetSeries=function(r){var n=!1;return this.eachTargetSeries(function(i){i===r&&(n=!0)}),n},e.prototype.formatValueText=function(r,n,i){var a=this.option,l=a.precision,c=this.dataBound,o=a.formatter,d;i=i||["<",">"],Ht(r)&&(r=r.slice(),d=!0);var g=n?r:d?[m(r[0]),m(r[1])]:m(r);if(yr(o))return o.replace("{value}",d?g[0]:g).replace("{value2}",d?g[1]:g);if(zr(o))return d?o(r[0],r[1]):o(r);if(d)return r[0]===c[0]?i[0]+" "+g[1]:r[1]===c[1]?i[1]+" "+g[0]:g[0]+" - "+g[1];return g;function m(y){return y===c[0]?"min":y===c[1]?"max":(+y).toFixed(Math.min(l,20))}},e.prototype.resetExtent=function(){var r=this.option,n=kBe([r.min,r.max]);this._dataExtent=n},e.prototype.getDataDimensionIndex=function(r){var n=this.option.dimension;if(n!=null)return r.getDimensionIndex(n);for(var i=r.dimensions,a=i.length-1;a>=0;a--){var l=i[a],c=r.getDimensionInfo(l);if(!c.isCalculationCoord)return c.storeDimIndex}},e.prototype.getExtent=function(){return this._dataExtent.slice()},e.prototype.completeVisualOption=function(){var r=this.ecModel,n=this.option,i={inRange:n.inRange,outOfRange:n.outOfRange},a=n.target||(n.target={}),l=n.controller||(n.controller={});pn(a,i),pn(l,i);var c=this.isCategory();o.call(this,a),o.call(this,l),d.call(this,a,"inRange","outOfRange"),g.call(this,l);function o(m){RBe(n.color)&&!m.inRange&&(m.inRange={color:n.color.slice().reverse()}),m.inRange=m.inRange||{color:r.get("gradientColor")}}function d(m,y,x){var A=m[y],M=m[x];A&&!M&&(M=m[x]={},H9(A,function(D,P){if(eo.isValidType(P)){var O=Bee.get(P,"inactive",c);O!=null&&(M[P]=O,P==="color"&&!M.hasOwnProperty("opacity")&&!M.hasOwnProperty("colorAlpha")&&(M.opacity=[0,0]))}}))}function g(m){var y=(m.inRange||{}).symbol||(m.outOfRange||{}).symbol,x=(m.inRange||{}).symbolSize||(m.outOfRange||{}).symbolSize,A=this.get("inactiveColor"),M=this.getItemSymbol(),D=M||"roundRect";H9(this.stateList,function(P){var O=this.itemSize,z=m[P];z||(z=m[P]={color:c?A:[A]}),z.symbol==null&&(z.symbol=y&&$r(y)||(c?D:[D])),z.symbolSize==null&&(z.symbolSize=x&&$r(x)||(c?O[0]:[O[0],O[0]])),z.symbol=$9(z.symbol,function($){return $==="none"?D:$});var V=z.symbolSize;if(V!=null){var H=-1/0;LBe(V,function($){$>H&&(H=$)}),z.symbolSize=$9(V,function($){return OBe($,[0,H],[0,O[0]],!0)})}},this)}},e.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},e.prototype.isCategory=function(){return!!this.option.categories},e.prototype.setSelected=function(r){},e.prototype.getSelected=function(){return null},e.prototype.getValueState=function(r){return null},e.prototype.getVisualMeta=function(r){return null},e.type="visualMap",e.dependencies=["series"],e.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},e}($n),j9=[20,140],zBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.optionUpdated=function(r,n){t.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(i){i.mappingMethod="linear",i.dataExtent=this.getExtent()}),this._resetRange()},e.prototype.resetItemSize=function(){t.prototype.resetItemSize.apply(this,arguments);var r=this.itemSize;(r[0]==null||isNaN(r[0]))&&(r[0]=j9[0]),(r[1]==null||isNaN(r[1]))&&(r[1]=j9[1])},e.prototype._resetRange=function(){var r=this.getExtent(),n=this.option.range;!n||n.auto?(r.auto=1,this.option.range=r):Ht(n)&&(n[0]>n[1]&&n.reverse(),n[0]=Math.max(n[0],r[0]),n[1]=Math.min(n[1],r[1]))},e.prototype.completeVisualOption=function(){t.prototype.completeVisualOption.apply(this,arguments),fe(this.stateList,function(r){var n=this.option.controller[r].symbolSize;n&&n[0]!==n[1]&&(n[0]=n[1]/3)},this)},e.prototype.setSelected=function(r){this.option.range=r.slice(),this._resetRange()},e.prototype.getSelected=function(){var r=this.getExtent(),n=El((this.get("range")||[]).slice());return n[0]>r[1]&&(n[0]=r[1]),n[1]>r[1]&&(n[1]=r[1]),n[0]<r[0]&&(n[0]=r[0]),n[1]<r[0]&&(n[1]=r[0]),n},e.prototype.getValueState=function(r){var n=this.option.range,i=this.getExtent();return(n[0]<=i[0]||n[0]<=r)&&(n[1]>=i[1]||r<=n[1])?"inRange":"outOfRange"},e.prototype.findTargetDataIndices=function(r){var n=[];return this.eachTargetSeries(function(i){var a=[],l=i.getData();l.each(this.getDataDimensionIndex(l),function(c,o){r[0]<=c&&c<=r[1]&&a.push(o)},this),n.push({seriesId:i.id,dataIndex:a})},this),n},e.prototype.getVisualMeta=function(r){var n=W9(this,"outOfRange",this.getExtent()),i=W9(this,"inRange",this.option.range.slice()),a=[];function l(x,A){a.push({value:x,color:r(x,A)})}for(var c=0,o=0,d=i.length,g=n.length;o<g&&(!i.length||n[o]<=i[0]);o++)n[o]<i[c]&&l(n[o],"outOfRange");for(var m=1;c<d;c++,m=0)m&&a.length&&l(i[c],"outOfRange"),l(i[c],"inRange");for(var m=1;o<g;o++)(!i.length||i[i.length-1]<n[o])&&(m&&(a.length&&l(a[a.length-1].value,"outOfRange"),m=0),l(n[o],"outOfRange"));var y=a.length;return{stops:a,outerColors:[y?a[0].color:"transparent",y?a[y-1].color:"transparent"]}},e.type="visualMap.continuous",e.defaultOption=Ed(hM.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),e}(hM);function W9(t,e,r){if(r[0]===r[1])return r.slice();for(var n=200,i=(r[1]-r[0])/n,a=r[0],l=[],c=0;c<=n&&a<r[1];c++)l.push(a),a+=i;return l.push(r[1]),l}var Fee=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r.autoPositionValues={left:1,right:1,top:1,bottom:1},r}return e.prototype.init=function(r,n){this.ecModel=r,this.api=n},e.prototype.render=function(r,n,i,a){if(this.visualMapModel=r,r.get("show")===!1){this.group.removeAll();return}this.doRender(r,n,i,a)},e.prototype.renderBackground=function(r){var n=this.visualMapModel,i=fy(n.get("padding")||0),a=r.getBoundingRect();r.add(new Kn({z2:-1,silent:!0,shape:{x:a.x-i[3],y:a.y-i[0],width:a.width+i[3]+i[1],height:a.height+i[0]+i[2]},style:{fill:n.get("backgroundColor"),stroke:n.get("borderColor"),lineWidth:n.get("borderWidth")}}))},e.prototype.getControllerVisual=function(r,n,i){i=i||{};var a=i.forceState,l=this.visualMapModel,c={};if(n==="color"){var o=l.get("contentColor");c.color=o}function d(x){return c[x]}function g(x,A){c[x]=A}var m=l.controllerVisuals[a||l.getValueState(r)],y=eo.prepareVisualTypes(m);return fe(y,function(x){var A=m[x];i.convertOpacityToAlpha&&x==="opacity"&&(x="colorAlpha",A=m.__alphaForOpacity),eo.dependsOn(x,n)&&A&&A.applyVisual(r,d,g)}),c[n]},e.prototype.positionGroup=function(r){var n=this.visualMapModel,i=this.api;xI(r,n.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()})},e.prototype.doRender=function(r,n,i,a){},e.type="visualMap",e}(ra),Z9=[["left","right","width"],["top","bottom","height"]];function Nee(t,e,r){var n=t.option,i=n.align;if(i!=null&&i!=="auto")return i;for(var a={width:e.getWidth(),height:e.getHeight()},l=n.orient==="horizontal"?1:0,c=Z9[l],o=[0,null,10],d={},g=0;g<3;g++)d[Z9[1-l][g]]=o[g],d[c[g]]=g===2?r[0]:n[c[g]];var m=[["x","width",3],["y","height",0]][l],y=Na(d,a,n.padding);return c[(y.margin[m[2]]||0)+y[m[0]]+y[m[1]]*.5<a[m[1]]*.5?0:1]}function tC(t,e){return fe(t||[],function(r){r.dataIndex!=null&&(r.dataIndexInside=r.dataIndex,r.dataIndex=null),r.highlightKey="visualMap"+(e?e.componentIndex:"")}),t}var Zu=Ci,BBe=fe,q9=Math.min,IR=Math.max,FBe=12,NBe=6,VBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._shapes={},r._dataInterval=[],r._handleEnds=[],r._hoverLinkDataIndices=[],r}return e.prototype.init=function(r,n){t.prototype.init.call(this,r,n),this._hoverLinkFromSeriesMouseOver=wr(this._hoverLinkFromSeriesMouseOver,this),this._hideIndicator=wr(this._hideIndicator,this)},e.prototype.doRender=function(r,n,i,a){(!a||a.type!=="selectDataRange"||a.from!==this.uid)&&this._buildView()},e.prototype._buildView=function(){this.group.removeAll();var r=this.visualMapModel,n=this.group;this._orient=r.get("orient"),this._useHandle=r.get("calculable"),this._resetInterval(),this._renderBar(n);var i=r.get("text");this._renderEndsText(n,i,0),this._renderEndsText(n,i,1),this._updateView(!0),this.renderBackground(n),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(n)},e.prototype._renderEndsText=function(r,n,i){if(n){var a=n[1-i];a=a!=null?a+"":"";var l=this.visualMapModel,c=l.get("textGap"),o=l.itemSize,d=this._shapes.mainGroup,g=this._applyTransform([o[0]/2,i===0?-c:o[1]+c],d),m=this._applyTransform(i===0?"bottom":"top",d),y=this._orient,x=this.visualMapModel.textStyleModel;this.group.add(new ti({style:Hi(x,{x:g[0],y:g[1],verticalAlign:y==="horizontal"?"middle":m,align:y==="horizontal"?m:"center",text:a})}))}},e.prototype._renderBar=function(r){var n=this.visualMapModel,i=this._shapes,a=n.itemSize,l=this._orient,c=this._useHandle,o=Nee(n,this.api,a),d=i.mainGroup=this._createBarGroup(o),g=new jr;d.add(g),g.add(i.outOfRange=Y9()),g.add(i.inRange=Y9(null,c?Q9(this._orient):null,wr(this._dragHandle,this,"all",!1),wr(this._dragHandle,this,"all",!0))),g.setClipPath(new Kn({shape:{x:0,y:0,width:a[0],height:a[1],r:3}}));var m=n.textStyleModel.getTextRect(""),y=IR(m.width,m.height);c&&(i.handleThumbs=[],i.handleLabels=[],i.handleLabelPoints=[],this._createHandle(n,d,0,a,y,l),this._createHandle(n,d,1,a,y,l)),this._createIndicator(n,d,a,y,l),r.add(d)},e.prototype._createHandle=function(r,n,i,a,l,c){var o=wr(this._dragHandle,this,i,!1),d=wr(this._dragHandle,this,i,!0),g=yu(r.get("handleSize"),a[0]),m=Ia(r.get("handleIcon"),-g/2,-g/2,g,g,null,!0),y=Q9(this._orient);m.attr({cursor:y,draggable:!0,drift:o,ondragend:d,onmousemove:function(P){dh(P.event)}}),m.x=a[0]/2,m.useStyle(r.getModel("handleStyle").getItemStyle()),m.setStyle({strokeNoScale:!0,strokeFirst:!0}),m.style.lineWidth*=2,m.ensureState("emphasis").style=r.getModel(["emphasis","handleStyle"]).getItemStyle(),Cg(m,!0),n.add(m);var x=this.visualMapModel.textStyleModel,A=new ti({cursor:y,draggable:!0,drift:o,onmousemove:function(P){dh(P.event)},ondragend:d,style:Hi(x,{x:0,y:0,text:""})});A.ensureState("blur").style={opacity:.1},A.stateTransition={duration:200},this.group.add(A);var M=[g,0],D=this._shapes;D.handleThumbs[i]=m,D.handleLabelPoints[i]=M,D.handleLabels[i]=A},e.prototype._createIndicator=function(r,n,i,a,l){var c=yu(r.get("indicatorSize"),i[0]),o=Ia(r.get("indicatorIcon"),-c/2,-c/2,c,c,null,!0);o.attr({cursor:"move",invisible:!0,silent:!0,x:i[0]/2});var d=r.getModel("indicatorStyle").getItemStyle();if(o instanceof fo){var g=o.style;o.useStyle(Lt({image:g.image,x:g.x,y:g.y,width:g.width,height:g.height},d))}else o.useStyle(d);n.add(o);var m=this.visualMapModel.textStyleModel,y=new ti({silent:!0,invisible:!0,style:Hi(m,{x:0,y:0,text:""})});this.group.add(y);var x=[(l==="horizontal"?a/2:NBe)+i[0]/2,0],A=this._shapes;A.indicator=o,A.indicatorLabel=y,A.indicatorLabelPoint=x,this._firstShowIndicator=!0},e.prototype._dragHandle=function(r,n,i,a){if(this._useHandle){if(this._dragging=!n,!n){var l=this._applyTransform([i,a],this._shapes.mainGroup,!0);this._updateInterval(r,l[1]),this._hideIndicator(),this._updateView()}n===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),n?!this._hovering&&this._clearHoverLinkToSeries():X9(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[r],!1)}},e.prototype._resetInterval=function(){var r=this.visualMapModel,n=this._dataInterval=r.getSelected(),i=r.getExtent(),a=[0,r.itemSize[1]];this._handleEnds=[Zu(n[0],i,a,!0),Zu(n[1],i,a,!0)]},e.prototype._updateInterval=function(r,n){n=n||0;var i=this.visualMapModel,a=this._handleEnds,l=[0,i.itemSize[1]];mv(n,a,l,r,0);var c=i.getExtent();this._dataInterval=[Zu(a[0],l,c,!0),Zu(a[1],l,c,!0)]},e.prototype._updateView=function(r){var n=this.visualMapModel,i=n.getExtent(),a=this._shapes,l=[0,n.itemSize[1]],c=r?l:this._handleEnds,o=this._createBarVisual(this._dataInterval,i,c,"inRange"),d=this._createBarVisual(i,i,l,"outOfRange");a.inRange.setStyle({fill:o.barColor}).setShape("points",o.barPoints),a.outOfRange.setStyle({fill:d.barColor}).setShape("points",d.barPoints),this._updateHandle(c,o)},e.prototype._createBarVisual=function(r,n,i,a){var l={forceState:a,convertOpacityToAlpha:!0},c=this._makeColorGradient(r,l),o=[this.getControllerVisual(r[0],"symbolSize",l),this.getControllerVisual(r[1],"symbolSize",l)],d=this._createBarPoints(i,o);return{barColor:new Mb(0,0,0,1,c),barPoints:d,handlesColor:[c[0].color,c[c.length-1].color]}},e.prototype._makeColorGradient=function(r,n){var i=100,a=[],l=(r[1]-r[0])/i;a.push({color:this.getControllerVisual(r[0],"color",n),offset:0});for(var c=1;c<i;c++){var o=r[0]+l*c;if(o>r[1])break;a.push({color:this.getControllerVisual(o,"color",n),offset:c/i})}return a.push({color:this.getControllerVisual(r[1],"color",n),offset:1}),a},e.prototype._createBarPoints=function(r,n){var i=this.visualMapModel.itemSize;return[[i[0]-n[0],r[0]],[i[0],r[0]],[i[0],r[1]],[i[0]-n[1],r[1]]]},e.prototype._createBarGroup=function(r){var n=this._orient,i=this.visualMapModel.get("inverse");return new jr(n==="horizontal"&&!i?{scaleX:r==="bottom"?1:-1,rotation:Math.PI/2}:n==="horizontal"&&i?{scaleX:r==="bottom"?-1:1,rotation:-Math.PI/2}:n==="vertical"&&!i?{scaleX:r==="left"?1:-1,scaleY:-1}:{scaleX:r==="left"?1:-1})},e.prototype._updateHandle=function(r,n){if(this._useHandle){var i=this._shapes,a=this.visualMapModel,l=i.handleThumbs,c=i.handleLabels,o=a.itemSize,d=a.getExtent();BBe([0,1],function(g){var m=l[g];m.setStyle("fill",n.handlesColor[g]),m.y=r[g];var y=Zu(r[g],[0,o[1]],d,!0),x=this.getControllerVisual(y,"symbolSize");m.scaleX=m.scaleY=x/o[0],m.x=o[0]-x/2;var A=vu(i.handleLabelPoints[g],Ug(m,this.group));c[g].setStyle({x:A[0],y:A[1],text:a.formatValueText(this._dataInterval[g]),verticalAlign:"middle",align:this._orient==="vertical"?this._applyTransform("left",i.mainGroup):"center"})},this)}},e.prototype._showIndicator=function(r,n,i,a){var l=this.visualMapModel,c=l.getExtent(),o=l.itemSize,d=[0,o[1]],g=this._shapes,m=g.indicator;if(m){m.attr("invisible",!1);var y={convertOpacityToAlpha:!0},x=this.getControllerVisual(r,"color",y),A=this.getControllerVisual(r,"symbolSize"),M=Zu(r,c,d,!0),D=o[0]-A/2,P={x:m.x,y:m.y};m.y=M,m.x=D;var O=vu(g.indicatorLabelPoint,Ug(m,this.group)),z=g.indicatorLabel;z.attr("invisible",!1);var V=this._applyTransform("left",g.mainGroup),H=this._orient,$=H==="horizontal";z.setStyle({text:(i||"")+l.formatValueText(n),verticalAlign:$?V:"middle",align:$?"center":V});var X={x:D,y:M,style:{fill:x}},W={style:{x:O[0],y:O[1]}};if(l.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var Y={duration:100,easing:"cubicInOut",additive:!0};m.x=P.x,m.y=P.y,m.animateTo(X,Y),z.animateTo(W,Y)}else m.attr(X),z.attr(W);this._firstShowIndicator=!1;var J=this._shapes.handleLabels;if(J)for(var re=0;re<J.length;re++)this.api.enterBlur(J[re])}},e.prototype._enableHoverLinkToSeries=function(){var r=this;this._shapes.mainGroup.on("mousemove",function(n){if(r._hovering=!0,!r._dragging){var i=r.visualMapModel.itemSize,a=r._applyTransform([n.offsetX,n.offsetY],r._shapes.mainGroup,!0,!0);a[1]=q9(IR(0,a[1]),i[1]),r._doHoverLinkToSeries(a[1],0<=a[0]&&a[0]<=i[0])}}).on("mouseout",function(){r._hovering=!1,!r._dragging&&r._clearHoverLinkToSeries()})},e.prototype._enableHoverLinkFromSeries=function(){var r=this.api.getZr();this.visualMapModel.option.hoverLink?(r.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),r.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},e.prototype._doHoverLinkToSeries=function(r,n){var i=this.visualMapModel,a=i.itemSize;if(i.option.hoverLink){var l=[0,a[1]],c=i.getExtent();r=q9(IR(l[0],r),l[1]);var o=GBe(i,c,l),d=[r-o,r+o],g=Zu(r,l,c,!0),m=[Zu(d[0],l,c,!0),Zu(d[1],l,c,!0)];d[0]<l[0]&&(m[0]=-1/0),d[1]>l[1]&&(m[1]=1/0),n&&(m[0]===-1/0?this._showIndicator(g,m[1],"< ",o):m[1]===1/0?this._showIndicator(g,m[0],"> ",o):this._showIndicator(g,g," ",o));var y=this._hoverLinkDataIndices,x=[];(n||X9(i))&&(x=this._hoverLinkDataIndices=i.findTargetDataIndices(m));var A=Hxe(y,x);this._dispatchHighDown("downplay",tC(A[0],i)),this._dispatchHighDown("highlight",tC(A[1],i))}},e.prototype._hoverLinkFromSeriesMouseOver=function(r){var n;if(Ig(r.target,function(o){var d=Yr(o);if(d.dataIndex!=null)return n=d,!0},!0),!!n){var i=this.ecModel.getSeriesByIndex(n.seriesIndex),a=this.visualMapModel;if(a.isTargetSeries(i)){var l=i.getData(n.dataType),c=l.getStore().get(a.getDataDimensionIndex(l),n.dataIndex);isNaN(c)||this._showIndicator(c,c)}}},e.prototype._hideIndicator=function(){var r=this._shapes;r.indicator&&r.indicator.attr("invisible",!0),r.indicatorLabel&&r.indicatorLabel.attr("invisible",!0);var n=this._shapes.handleLabels;if(n)for(var i=0;i<n.length;i++)this.api.leaveBlur(n[i])},e.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var r=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",tC(r,this.visualMapModel)),r.length=0},e.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var r=this.api.getZr();r.off("mouseover",this._hoverLinkFromSeriesMouseOver),r.off("mouseout",this._hideIndicator)},e.prototype._applyTransform=function(r,n,i,a){var l=Ug(n,a?null:this.group);return Ht(r)?vu(r,l,i):dI(r,l,i)},e.prototype._dispatchHighDown=function(r,n){n&&n.length&&this.api.dispatchAction({type:r,batch:n})},e.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},e.type="visualMap.continuous",e}(Fee);function Y9(t,e,r,n){return new os({shape:{points:t},draggable:!!r,cursor:e,drift:r,onmousemove:function(i){dh(i.event)},ondragend:n})}function GBe(t,e,r){var n=FBe/2,i=t.get("hoverLinkDataSize");return i&&(n=Zu(i,e,r,!0)/2),n}function X9(t){var e=t.get("hoverLinkOnHandle");return!!(e??t.get("realtime"))}function Q9(t){return t==="vertical"?"ns-resize":"ew-resize"}var UBe={type:"selectDataRange",event:"dataRangeSelected",update:"update"},$Be=function(t,e){e.eachComponent({mainType:"visualMap",query:t},function(r){r.setSelected(t.selected)})},HBe=[{createOnAllSeries:!0,reset:function(t,e){var r=[];return e.eachComponent("visualMap",function(n){var i=t.pipelineContext;!n.isTargetSeries(t)||i&&i.large||r.push(fze(n.stateList,n.targetVisuals,wr(n.getValueState,n),n.getDataDimensionIndex(t.getData())))}),r}},{createOnAllSeries:!0,reset:function(t,e){var r=t.getData(),n=[];e.eachComponent("visualMap",function(i){if(i.isTargetSeries(t)){var a=i.getVisualMeta(wr(jBe,null,t,i))||{stops:[],outerColors:[]},l=i.getDataDimensionIndex(r);l>=0&&(a.dimension=l,n.push(a))}}),t.getData().setVisual("visualMeta",n)}}];function jBe(t,e,r,n){for(var i=e.targetVisuals[n],a=eo.prepareVisualTypes(i),l={color:Pb(t.getData(),"color")},c=0,o=a.length;c<o;c++){var d=a[c],g=i[d==="opacity"?"__alphaForOpacity":d];g&&g.applyVisual(r,m,y)}return l.color;function m(x){return l[x]}function y(x,A){l[x]=A}}var K9=fe;function WBe(t){var e=t&&t.visualMap;Ht(e)||(e=e?[e]:[]),K9(e,function(r){if(r){s_(r,"splitList")&&!s_(r,"pieces")&&(r.pieces=r.splitList,delete r.splitList);var n=r.pieces;n&&Ht(n)&&K9(n,function(i){Ur(i)&&(s_(i,"start")&&!s_(i,"min")&&(i.min=i.start),s_(i,"end")&&!s_(i,"max")&&(i.max=i.end))})}})}function s_(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e)}var J9=!1;function Vee(t){J9||(J9=!0,t.registerSubTypeDefaulter("visualMap",function(e){return!e.categories&&(!(e.pieces?e.pieces.length>0:e.splitNumber>0)||e.calculable)?"continuous":"piecewise"}),t.registerAction(UBe,$Be),fe(HBe,function(e){t.registerVisual(t.PRIORITY.VISUAL.COMPONENT,e)}),t.registerPreprocessor(WBe))}function Gee(t){t.registerComponentModel(zBe),t.registerComponentView(VBe),Vee(t)}var ZBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r._pieceList=[],r}return e.prototype.optionUpdated=function(r,n){t.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var i=this._mode=this._determineMode();this._pieceList=[],qBe[this._mode].call(this,this._pieceList),this._resetSelected(r,n);var a=this.option.categories;this.resetVisual(function(l,c){i==="categories"?(l.mappingMethod="category",l.categories=$r(a)):(l.dataExtent=this.getExtent(),l.mappingMethod="piecewise",l.pieceList=Zt(this._pieceList,function(o){return o=$r(o),c!=="inRange"&&(o.visual=null),o}))})},e.prototype.completeVisualOption=function(){var r=this.option,n={},i=eo.listVisualTypes(),a=this.isCategory();fe(r.pieces,function(c){fe(i,function(o){c.hasOwnProperty(o)&&(n[o]=1)})}),fe(n,function(c,o){var d=!1;fe(this.stateList,function(g){d=d||l(r,g,o)||l(r.target,g,o)},this),!d&&fe(this.stateList,function(g){(r[g]||(r[g]={}))[o]=Bee.get(o,g==="inRange"?"active":"inactive",a)})},this);function l(c,o,d){return c&&c[o]&&c[o].hasOwnProperty(d)}t.prototype.completeVisualOption.apply(this,arguments)},e.prototype._resetSelected=function(r,n){var i=this.option,a=this._pieceList,l=(n?i:r).selected||{};if(i.selected=l,fe(a,function(o,d){var g=this.getSelectedMapKey(o);l.hasOwnProperty(g)||(l[g]=!0)},this),i.selectedMode==="single"){var c=!1;fe(a,function(o,d){var g=this.getSelectedMapKey(o);l[g]&&(c?l[g]=!1:c=!0)},this)}},e.prototype.getItemSymbol=function(){return this.get("itemSymbol")},e.prototype.getSelectedMapKey=function(r){return this._mode==="categories"?r.value+"":r.index+""},e.prototype.getPieceList=function(){return this._pieceList},e.prototype._determineMode=function(){var r=this.option;return r.pieces&&r.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},e.prototype.setSelected=function(r){this.option.selected=$r(r)},e.prototype.getValueState=function(r){var n=eo.findPieceIndex(r,this._pieceList);return n!=null&&this.option.selected[this.getSelectedMapKey(this._pieceList[n])]?"inRange":"outOfRange"},e.prototype.findTargetDataIndices=function(r){var n=[],i=this._pieceList;return this.eachTargetSeries(function(a){var l=[],c=a.getData();c.each(this.getDataDimensionIndex(c),function(o,d){var g=eo.findPieceIndex(o,i);g===r&&l.push(d)},this),n.push({seriesId:a.id,dataIndex:l})},this),n},e.prototype.getRepresentValue=function(r){var n;if(this.isCategory())n=r.value;else if(r.value!=null)n=r.value;else{var i=r.interval||[];n=i[0]===-1/0&&i[1]===1/0?0:(i[0]+i[1])/2}return n},e.prototype.getVisualMeta=function(r){if(this.isCategory())return;var n=[],i=["",""],a=this;function l(g,m){var y=a.getRepresentValue({interval:g});m||(m=a.getValueState(y));var x=r(y,m);g[0]===-1/0?i[0]=x:g[1]===1/0?i[1]=x:n.push({value:g[0],color:x},{value:g[1],color:x})}var c=this._pieceList.slice();if(!c.length)c.push({interval:[-1/0,1/0]});else{var o=c[0].interval[0];o!==-1/0&&c.unshift({interval:[-1/0,o]}),o=c[c.length-1].interval[1],o!==1/0&&c.push({interval:[o,1/0]})}var d=-1/0;return fe(c,function(g){var m=g.interval;m&&(m[0]>d&&l([d,m[0]],"outOfRange"),l(m.slice()),d=m[1])},this),{stops:n,outerColors:i}},e.type="visualMap.piecewise",e.defaultOption=Ed(hM.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),e}(hM),qBe={splitNumber:function(t){var e=this.option,r=Math.min(e.precision,20),n=this.getExtent(),i=e.splitNumber;i=Math.max(parseInt(i,10),1),e.splitNumber=i;for(var a=(n[1]-n[0])/i;+a.toFixed(r)!==a&&r<5;)r++;e.precision=r,a=+a.toFixed(r),e.minOpen&&t.push({interval:[-1/0,n[0]],close:[0,0]});for(var l=0,c=n[0];l<i;c+=a,l++){var o=l===i-1?n[1]:c+a;t.push({interval:[c,o],close:[1,1]})}e.maxOpen&&t.push({interval:[n[1],1/0],close:[0,0]}),ZG(t),fe(t,function(d,g){d.index=g,d.text=this.formatValueText(d.interval)},this)},categories:function(t){var e=this.option;fe(e.categories,function(r){t.push({text:this.formatValueText(r,!0),value:r})},this),eW(e,t)},pieces:function(t){var e=this.option;fe(e.pieces,function(r,n){Ur(r)||(r={value:r});var i={text:"",index:n};if(r.label!=null&&(i.text=r.label),r.hasOwnProperty("value")){var a=i.value=r.value;i.interval=[a,a],i.close=[1,1]}else{for(var l=i.interval=[],c=i.close=[0,0],o=[1,0,1],d=[-1/0,1/0],g=[],m=0;m<2;m++){for(var y=[["gte","gt","min"],["lte","lt","max"]][m],x=0;x<3&&l[m]==null;x++)l[m]=r[y[x]],c[m]=o[x],g[m]=x===2;l[m]==null&&(l[m]=d[m])}g[0]&&l[1]===1/0&&(c[0]=0),g[1]&&l[0]===-1/0&&(c[1]=0),l[0]===l[1]&&c[0]&&c[1]&&(i.value=l[0])}i.visual=eo.retrieveVisuals(r),t.push(i)},this),eW(e,t),ZG(t),fe(t,function(r){var n=r.close,i=[["<",""][n[1]],[">",""][n[0]]];r.text=r.text||this.formatValueText(r.value!=null?r.value:r.interval,!1,i)},this)}};function eW(t,e){var r=t.inverse;(t.orient==="vertical"?!r:r)&&e.reverse()}var YBe=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type=e.type,r}return e.prototype.doRender=function(){var r=this.group;r.removeAll();var n=this.visualMapModel,i=n.get("textGap"),a=n.textStyleModel,l=a.getFont(),c=a.getTextColor(),o=this._getItemAlign(),d=n.itemSize,g=this._getViewData(),m=g.endsText,y=ho(n.get("showLabel",!0),!m);m&&this._renderEndsText(r,m[0],d,y,o),fe(g.viewPieceList,function(x){var A=x.piece,M=new jr;M.onclick=wr(this._onItemClick,this,A),this._enableHoverLink(M,x.indexInModelPieceList);var D=n.getRepresentValue(A);if(this._createItemSymbol(M,D,[0,0,d[0],d[1]]),y){var P=this.visualMapModel.getValueState(D);M.add(new ti({style:{x:o==="right"?-i:d[0]+i,y:d[1]/2,text:A.text,verticalAlign:"middle",align:o,font:l,fill:c,opacity:P==="outOfRange"?.5:1}}))}r.add(M)},this),m&&this._renderEndsText(r,m[1],d,y,o),$g(n.get("orient"),r,n.get("itemGap")),this.renderBackground(r),this.positionGroup(r)},e.prototype._enableHoverLink=function(r,n){var i=this;r.on("mouseover",function(){return a("highlight")}).on("mouseout",function(){return a("downplay")});var a=function(l){var c=i.visualMapModel;c.option.hoverLink&&i.api.dispatchAction({type:l,batch:tC(c.findTargetDataIndices(n),c)})}},e.prototype._getItemAlign=function(){var r=this.visualMapModel,n=r.option;if(n.orient==="vertical")return Nee(r,this.api,r.itemSize);var i=n.align;return(!i||i==="auto")&&(i="left"),i},e.prototype._renderEndsText=function(r,n,i,a,l){if(n){var c=new jr,o=this.visualMapModel.textStyleModel;c.add(new ti({style:Hi(o,{x:a?l==="right"?i[0]:0:i[0]/2,y:i[1]/2,verticalAlign:"middle",align:a?l:"center",text:n})})),r.add(c)}},e.prototype._getViewData=function(){var r=this.visualMapModel,n=Zt(r.getPieceList(),function(c,o){return{piece:c,indexInModelPieceList:o}}),i=r.get("text"),a=r.get("orient"),l=r.get("inverse");return(a==="horizontal"?l:!l)?n.reverse():i&&(i=i.slice().reverse()),{viewPieceList:n,endsText:i}},e.prototype._createItemSymbol=function(r,n,i){r.add(Ia(this.getControllerVisual(n,"symbol"),i[0],i[1],i[2],i[3],this.getControllerVisual(n,"color")))},e.prototype._onItemClick=function(r){var n=this.visualMapModel,i=n.option,a=i.selectedMode;if(a){var l=$r(i.selected),c=n.getSelectedMapKey(r);a==="single"||a===!0?(l[c]=!0,fe(l,function(o,d){l[d]=d===c})):l[c]=!l[c],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:l})}},e.type="visualMap.piecewise",e}(Fee);function Uee(t){t.registerComponentModel(ZBe),t.registerComponentView(YBe),Vee(t)}function XBe(t){En(Gee),En(Uee)}var QBe={label:{enabled:!0},decal:{show:!1}},tW=ri(),KBe={};function JBe(t,e){var r=t.getModel("aria");if(!r.get("enabled"))return;var n=$r(QBe);pn(n.label,t.getLocaleModel().get("aria"),!1),pn(r.option,n,!1),i(),a();function i(){var d=r.getModel("decal"),g=d.get("show");if(g){var m=Ir();t.eachSeries(function(y){if(!y.isColorBySeries()){var x=m.get(y.type);x||(x={},m.set(y.type,x)),tW(y).scope=x}}),t.eachRawSeries(function(y){if(t.isSeriesFiltered(y))return;if(zr(y.enableAriaDecal)){y.enableAriaDecal();return}var x=y.getData();if(y.isColorBySeries()){var O=rO(y.ecModel,y.name,KBe,t.getSeriesCount()),z=x.getVisual("decal");x.setVisual("decal",V(z,O))}else{var A=y.getRawData(),M={},D=tW(y).scope;x.each(function(H){var $=x.getRawIndex(H);M[$]=H});var P=A.count();A.each(function(H){var $=M[H],X=A.getName(H)||H+"",W=rO(y.ecModel,X,D,P),Y=x.getItemVisual($,"decal");x.setItemVisual($,"decal",V(Y,W))})}function V(H,$){var X=H?Lt(Lt({},$),H):$;return X.dirty=!0,X}})}}function a(){var d=t.getLocaleModel().get("aria"),g=r.getModel("label");if(g.option=Fr(g.option,d),!!g.get("enabled")){var m=e.getZr().dom;if(g.get("description")){m.setAttribute("aria-label",g.get("description"));return}var y=t.getSeriesCount(),x=g.get(["data","maxCount"])||10,A=g.get(["series","maxCount"])||10,M=Math.min(y,A),D;if(!(y<1)){var P=c();if(P){var O=g.get(["general","withTitle"]);D=l(O,{title:P})}else D=g.get(["general","withoutTitle"]);var z=[],V=y>1?g.get(["series","multiple","prefix"]):g.get(["series","single","prefix"]);D+=l(V,{seriesCount:y}),t.eachSeries(function(W,Y){if(Y<M){var J=void 0,re=W.get("name"),ae=re?"withName":"withoutName";J=y>1?g.get(["series","multiple",ae]):g.get(["series","single",ae]),J=l(J,{seriesId:W.seriesIndex,seriesName:W.get("name"),seriesType:o(W.subType)});var pe=W.getData();if(pe.count()>x){var de=g.get(["data","partialData"]);J+=l(de,{displayCnt:x})}else J+=g.get(["data","allData"]);for(var ve=g.get(["data","separator","middle"]),me=g.get(["data","separator","end"]),Ie=[],Le=0;Le<pe.count();Le++)if(Le<x){var Ee=pe.getName(Le),Ue=pe.getValues(Le),Ke=g.get(["data",Ee?"withName":"withoutName"]);Ie.push(l(Ke,{name:Ee,value:Ue.join(ve)}))}J+=Ie.join(ve)+me,z.push(J)}});var H=g.getModel(["series","multiple","separator"]),$=H.get("middle"),X=H.get("end");D+=z.join($)+X,m.setAttribute("aria-label",D)}}}function l(d,g){if(!yr(d))return d;var m=d;return fe(g,function(y,x){m=m.replace(new RegExp("\\{\\s*"+x+"\\s*\\}","g"),y)}),m}function c(){var d=t.get("title");return d&&d.length&&(d=d[0]),d&&d.text}function o(d){var g=t.getLocaleModel().get(["series","typeNames"]);return g[d]||g.chart}}function e5e(t){if(!(!t||!t.aria)){var e=t.aria;e.show!=null&&(e.enabled=e.show),e.label=e.label||{},fe(["description","general","series","data"],function(r){e[r]!=null&&(e.label[r]=e[r])})}}function t5e(t){t.registerPreprocessor(e5e),t.registerVisual(t.PRIORITY.VISUAL.ARIA,JBe)}var rW={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},r5e=function(){function t(e){var r=this._condVal=yr(e)?new RegExp(e):c0e(e)?e:null;if(r==null){var n="";vi(n)}}return t.prototype.evaluate=function(e){var r=typeof e;return yr(r)?this._condVal.test(e):ii(r)?this._condVal.test(e+""):!1},t}(),n5e=function(){function t(){}return t.prototype.evaluate=function(){return this.value},t}(),i5e=function(){function t(){}return t.prototype.evaluate=function(){for(var e=this.children,r=0;r<e.length;r++)if(!e[r].evaluate())return!1;return!0},t}(),a5e=function(){function t(){}return t.prototype.evaluate=function(){for(var e=this.children,r=0;r<e.length;r++)if(e[r].evaluate())return!0;return!1},t}(),o5e=function(){function t(){}return t.prototype.evaluate=function(){return!this.child.evaluate()},t}(),s5e=function(){function t(){}return t.prototype.evaluate=function(){for(var e=!!this.valueParser,r=this.getValue,n=r(this.valueGetterParam),i=e?this.valueParser(n):null,a=0;a<this.subCondList.length;a++)if(!this.subCondList[a].evaluate(e?i:n))return!1;return!0},t}();function S5(t,e){if(t===!0||t===!1){var r=new n5e;return r.value=t,r}var n="";return $ee(t)||vi(n),t.and?nW("and",t,e):t.or?nW("or",t,e):t.not?l5e(t,e):u5e(t,e)}function nW(t,e,r){var n=e[t],i="";Ht(n)||vi(i),n.length||vi(i);var a=t==="and"?new i5e:new a5e;return a.children=Zt(n,function(l){return S5(l,r)}),a.children.length||vi(i),a}function l5e(t,e){var r=t.not,n="";$ee(r)||vi(n);var i=new o5e;return i.child=S5(r,e),i.child||vi(n),i}function u5e(t,e){for(var r="",n=e.prepareGetValue(t),i=[],a=Hn(t),l=t.parser,c=l?AX(l):null,o=0;o<a.length;o++){var d=a[o];if(!(d==="parser"||e.valueGetterAttrMap.get(d))){var g=Cr(rW,d)?rW[d]:d,m=t[d],y=c?c(m):m,x=Qwe(g,y)||g==="reg"&&new r5e(y);x||vi(r),i.push(x)}}i.length||vi(r);var A=new s5e;return A.valueGetterParam=n,A.valueParser=c,A.getValue=e.getValue,A.subCondList=i,A}function $ee(t){return Ur(t)&&!Vo(t)}var c5e=function(){function t(e,r){this._cond=S5(e,r)}return t.prototype.evaluate=function(){return this._cond.evaluate()},t}();function h5e(t,e){return new c5e(t,e)}var f5e={type:"echarts:filter",transform:function(t){for(var e=t.upstream,r,n=h5e(t.config,{valueGetterAttrMap:Ir({dimension:!0}),prepareGetValue:function(c){var o="",d=c.dimension;Cr(c,"dimension")||vi(o);var g=e.getDimensionInfo(d);return g||vi(o),{dimIdx:g.index}},getValue:function(c){return e.retrieveValueFromItem(r,c.dimIdx)}}),i=[],a=0,l=e.count();a<l;a++)r=e.getRawDataItem(a),n.evaluate()&&i.push(r);return{data:i}}},d5e={type:"echarts:sort",transform:function(t){var e=t.upstream,r=t.config,n="",i=Pi(r);i.length||vi(n);var a=[];fe(i,function(g){var m=g.dimension,y=g.order,x=g.parser,A=g.incomparable;if(m==null&&vi(n),y!=="asc"&&y!=="desc"&&vi(n),A&&A!=="min"&&A!=="max"){var M="";vi(M)}if(y!=="asc"&&y!=="desc"){var D="";vi(D)}var P=e.getDimensionInfo(m);P||vi(n);var O=x?AX(x):null;x&&!O&&vi(n),a.push({dimIdx:P.index,parser:O,comparator:new MX(y,A)})});var l=e.sourceFormat;l!==Go&&l!==Vl&&vi(n);for(var c=[],o=0,d=e.count();o<d;o++)c.push(e.getRawDataItem(o));return c.sort(function(g,m){for(var y=0;y<a.length;y++){var x=a[y],A=e.retrieveValueFromItem(g,x.dimIdx),M=e.retrieveValueFromItem(m,x.dimIdx);x.parser&&(A=x.parser(A),M=x.parser(M));var D=x.comparator.evaluate(A,M);if(D!==0)return D}return 0}),{data:c}}};function p5e(t){t.registerTransform(f5e),t.registerTransform(d5e)}var g5e=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="dataset",r}return e.prototype.init=function(r,n,i){t.prototype.init.call(this,r,n,i),this._sourceManager=new PX(this),a8(this)},e.prototype.mergeOption=function(r,n){t.prototype.mergeOption.call(this,r,n),a8(this)},e.prototype.optionUpdated=function(){this._sourceManager.dirty()},e.prototype.getSourceManager=function(){return this._sourceManager},e.type="dataset",e.defaultOption={seriesLayoutBy:oc},e}($n),v5e=function(t){et(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="dataset",r}return e.type="dataset",e}(ra);function m5e(t){t.registerComponentModel(g5e),t.registerComponentView(v5e)}var ju=pc.CMD;function y_(t,e){return Math.abs(t-e)<1e-5}function r3(t){var e=t.data,r=t.len(),n=[],i,a=0,l=0,c=0,o=0;function d(pe,de){i&&i.length>2&&n.push(i),i=[pe,de]}function g(pe,de,ve,me){y_(pe,ve)&&y_(de,me)||i.push(pe,de,ve,me,ve,me)}function m(pe,de,ve,me,Ie,Le){var Ee=Math.abs(de-pe),Ue=Math.tan(Ee/4)*4/3,Ke=de<pe?-1:1,We=Math.cos(pe),Rt=Math.sin(pe),Et=Math.cos(de),ar=Math.sin(de),ur=We*Ie+ve,cr=Rt*Le+me,lt=Et*Ie+ve,qt=ar*Le+me,Ut=Ie*Ue*Ke,rr=Le*Ue*Ke;i.push(ur-Ut*Rt,cr+rr*We,lt+Ut*ar,qt-rr*Et,lt,qt)}for(var y,x,A,M,D=0;D<r;){var P=e[D++],O=D===1;switch(O&&(a=e[D],l=e[D+1],c=a,o=l,(P===ju.L||P===ju.C||P===ju.Q)&&(i=[c,o])),P){case ju.M:a=c=e[D++],l=o=e[D++],d(c,o);break;case ju.L:y=e[D++],x=e[D++],g(a,l,y,x),a=y,l=x;break;case ju.C:i.push(e[D++],e[D++],e[D++],e[D++],a=e[D++],l=e[D++]);break;case ju.Q:y=e[D++],x=e[D++],A=e[D++],M=e[D++],i.push(a+2/3*(y-a),l+2/3*(x-l),A+2/3*(y-A),M+2/3*(x-M),A,M),a=A,l=M;break;case ju.A:var z=e[D++],V=e[D++],H=e[D++],$=e[D++],X=e[D++],W=e[D++]+X;D+=1;var Y=!e[D++];y=Math.cos(X)*H+z,x=Math.sin(X)*$+V,O?(c=y,o=x,d(c,o)):g(a,l,y,x),a=Math.cos(W)*H+z,l=Math.sin(W)*$+V;for(var J=(Y?-1:1)*Math.PI/2,re=X;Y?re>W:re<W;re+=J){var ae=Y?Math.max(re+J,W):Math.min(re+J,W);m(re,ae,z,V,H,$)}break;case ju.R:c=a=e[D++],o=l=e[D++],y=c+e[D++],x=o+e[D++],d(y,o),g(y,o,y,x),g(y,x,c,x),g(c,x,c,o),g(c,o,y,o);break;case ju.Z:i&&g(a,l,c,o),a=c,l=o;break}}return i&&i.length>2&&n.push(i),n}function n3(t,e,r,n,i,a,l,c,o,d){if(y_(t,r)&&y_(e,n)&&y_(i,l)&&y_(a,c)){o.push(l,c);return}var g=2/d,m=g*g,y=l-t,x=c-e,A=Math.sqrt(y*y+x*x);y/=A,x/=A;var M=r-t,D=n-e,P=i-l,O=a-c,z=M*M+D*D,V=P*P+O*O;if(z<m&&V<m){o.push(l,c);return}var H=y*M+x*D,$=-y*P-x*O,X=z-H*H,W=V-$*$;if(X<m&&H>=0&&W<m&&$>=0){o.push(l,c);return}var Y=[],J=[];vd(t,r,i,l,.5,Y),vd(e,n,a,c,.5,J),n3(Y[0],J[0],Y[1],J[1],Y[2],J[2],Y[3],J[3],o,d),n3(Y[4],J[4],Y[5],J[5],Y[6],J[6],Y[7],J[7],o,d)}function _5e(t,e){var r=r3(t),n=[];e=e||1;for(var i=0;i<r.length;i++){var a=r[i],l=[],c=a[0],o=a[1];l.push(c,o);for(var d=2;d<a.length;){var g=a[d++],m=a[d++],y=a[d++],x=a[d++],A=a[d++],M=a[d++];n3(c,o,g,m,y,x,A,M,l,e),c=A,o=M}n.push(l)}return n}function Hee(t,e,r){var n=t[e],i=t[1-e],a=Math.abs(n/i),l=Math.ceil(Math.sqrt(a*r)),c=Math.floor(r/l);c===0&&(c=1,l=r);for(var o=[],d=0;d<l;d++)o.push(c);var g=l*c,m=r-g;if(m>0)for(var d=0;d<m;d++)o[d%l]+=1;return o}function iW(t,e,r){for(var n=t.r0,i=t.r,a=t.startAngle,l=t.endAngle,c=Math.abs(l-a),o=c*i,d=i-n,g=o>Math.abs(d),m=Hee([o,d],g?0:1,e),y=(g?c:d)/m.length,x=0;x<m.length;x++)for(var A=(g?d:c)/m[x],M=0;M<m[x];M++){var D={};g?(D.startAngle=a+y*x,D.endAngle=a+y*(x+1),D.r0=n+A*M,D.r=n+A*(M+1)):(D.startAngle=a+A*M,D.endAngle=a+A*(M+1),D.r0=n+y*x,D.r=n+y*(x+1)),D.clockwise=t.clockwise,D.cx=t.cx,D.cy=t.cy,r.push(D)}}function y5e(t,e,r){for(var n=t.width,i=t.height,a=n>i,l=Hee([n,i],a?0:1,e),c=a?"width":"height",o=a?"height":"width",d=a?"x":"y",g=a?"y":"x",m=t[c]/l.length,y=0;y<l.length;y++)for(var x=t[o]/l[y],A=0;A<l[y];A++){var M={};M[d]=y*m,M[g]=A*x,M[c]=m,M[o]=x,M.x+=t.x,M.y+=t.y,r.push(M)}}function aW(t,e,r,n){return t*n-r*e}function x5e(t,e,r,n,i,a,l,c){var o=r-t,d=n-e,g=l-i,m=c-a,y=aW(g,m,o,d);if(Math.abs(y)<1e-6)return null;var x=t-i,A=e-a,M=aW(x,A,g,m)/y;return M<0||M>1?null:new hn(M*o+t,M*d+e)}function b5e(t,e,r){var n=new hn;hn.sub(n,r,e),n.normalize();var i=new hn;hn.sub(i,t,e);var a=i.dot(n);return a}function l_(t,e){var r=t[t.length-1];r&&r[0]===e[0]&&r[1]===e[1]||t.push(e)}function w5e(t,e,r){for(var n=t.length,i=[],a=0;a<n;a++){var l=t[a],c=t[(a+1)%n],o=x5e(l[0],l[1],c[0],c[1],e.x,e.y,r.x,r.y);o&&i.push({projPt:b5e(o,e,r),pt:o,idx:a})}if(i.length<2)return[{points:t},{points:t}];i.sort(function(D,P){return D.projPt-P.projPt});var d=i[0],g=i[i.length-1];if(g.idx<d.idx){var m=d;d=g,g=m}for(var y=[d.pt.x,d.pt.y],x=[g.pt.x,g.pt.y],A=[y],M=[x],a=d.idx+1;a<=g.idx;a++)l_(A,t[a].slice());l_(A,x),l_(A,y);for(var a=g.idx+1;a<=d.idx+n;a++)l_(M,t[a%n].slice());return l_(M,y),l_(M,x),[{points:A},{points:M}]}function oW(t){var e=t.points,r=[],n=[];sI(e,r,n);var i=new gn(r[0],r[1],n[0]-r[0],n[1]-r[1]),a=i.width,l=i.height,c=i.x,o=i.y,d=new hn,g=new hn;return a>l?(d.x=g.x=c+a/2,d.y=o,g.y=o+l):(d.y=g.y=o+l/2,d.x=c,g.x=c+a),w5e(e,d,g)}function fM(t,e,r,n){if(r===1)n.push(e);else{var i=Math.floor(r/2),a=t(e);fM(t,a[0],i,n),fM(t,a[1],r-i,n)}return n}function S5e(t,e){for(var r=[],n=0;n<e;n++)r.push(Vz(t));return r}function T5e(t,e){e.setStyle(t.style),e.z=t.z,e.z2=t.z2,e.zlevel=t.zlevel}function A5e(t){for(var e=[],r=0;r<t.length;)e.push([t[r++],t[r++]]);return e}function C5e(t,e){var r=[],n=t.shape,i;switch(t.type){case"rect":y5e(n,e,r),i=Kn;break;case"sector":iW(n,e,r),i=as;break;case"circle":iW({r0:0,r:n.r,startAngle:0,endAngle:Math.PI*2,cx:n.cx,cy:n.cy},e,r),i=as;break;default:var a=t.getComputedTransform(),l=a?Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1],a[2]*a[2]+a[3]*a[3])):1,c=Zt(_5e(t.getUpdatedPathProxy(),l),function(P){return A5e(P)}),o=c.length;if(o===0)fM(oW,{points:c[0]},e,r);else if(o===e)for(var d=0;d<o;d++)r.push({points:c[d]});else{var g=0,m=Zt(c,function(P){var O=[],z=[];sI(P,O,z);var V=(z[1]-O[1])*(z[0]-O[0]);return g+=V,{poly:P,area:V}});m.sort(function(P,O){return O.area-P.area});for(var y=e,d=0;d<o;d++){var x=m[d];if(y<=0)break;var A=d===o-1?y:Math.ceil(x.area/g*e);A<0||(fM(oW,{points:x.poly},A,r),y-=A)}}i=os;break}if(!i)return S5e(t,e);for(var M=[],d=0;d<r.length;d++){var D=new i;D.setShape(r[d]),T5e(t,D),M.push(D)}return M}function M5e(t,e){var r=t.length,n=e.length;if(r===n)return[t,e];for(var i=[],a=[],l=r<n?t:e,c=Math.min(r,n),o=Math.abs(n-r)/6,d=(c-2)/6,g=Math.ceil(o/d)+1,m=[l[0],l[1]],y=o,x=2;x<c;){var A=l[x-2],M=l[x-1],D=l[x++],P=l[x++],O=l[x++],z=l[x++],V=l[x++],H=l[x++];if(y<=0){m.push(D,P,O,z,V,H);continue}for(var $=Math.min(y,g-1)+1,X=1;X<=$;X++){var W=X/$;vd(A,D,O,V,W,i),vd(M,P,z,H,W,a),A=i[3],M=a[3],m.push(i[1],a[1],i[2],a[2],A,M),D=i[5],P=a[5],O=i[6],z=a[6]}y-=$-1}return l===t?[m,e]:[t,m]}function sW(t,e){for(var r=t.length,n=t[r-2],i=t[r-1],a=[],l=0;l<e.length;)a[l++]=n,a[l++]=i;return a}function I5e(t,e){for(var r,n,i,a=[],l=[],c=0;c<Math.max(t.length,e.length);c++){var o=t[c],d=e[c],g=void 0,m=void 0;o?d?(r=M5e(o,d),g=r[0],m=r[1],n=g,i=m):(m=sW(i||o,o),g=o):(g=sW(n||d,d),m=d),a.push(g),l.push(m)}return[a,l]}function lW(t){for(var e=0,r=0,n=0,i=t.length,a=0,l=i-2;a<i;l=a,a+=2){var c=t[l],o=t[l+1],d=t[a],g=t[a+1],m=c*g-d*o;e+=m,r+=(c+d)*m,n+=(o+g)*m}return e===0?[t[0]||0,t[1]||0]:[r/e/3,n/e/3,e]}function E5e(t,e,r,n){for(var i=(t.length-2)/6,a=1/0,l=0,c=t.length,o=c-2,d=0;d<i;d++){for(var g=d*6,m=0,y=0;y<c;y+=2){var x=y===0?g:(g+y-2)%o+2,A=t[x]-r[0],M=t[x+1]-r[1],D=e[y]-n[0],P=e[y+1]-n[1],O=D-A,z=P-M;m+=O*O+z*z}m<a&&(a=m,l=d)}return l}function D5e(t){for(var e=[],r=t.length,n=0;n<r;n+=2)e[n]=t[r-n-2],e[n+1]=t[r-n-1];return e}function P5e(t,e,r,n){for(var i=[],a,l=0;l<t.length;l++){var c=t[l],o=e[l],d=lW(c),g=lW(o);a==null&&(a=d[2]<0!=g[2]<0);var m=[],y=[],x=0,A=1/0,M=[],D=c.length;a&&(c=D5e(c));for(var P=E5e(c,o,d,g)*6,O=D-2,z=0;z<O;z+=2){var V=(P+z)%O+2;m[z+2]=c[V]-d[0],m[z+3]=c[V+1]-d[1]}m[0]=c[P]-d[0],m[1]=c[P+1]-d[1];for(var H=n/r,$=-n/2;$<=n/2;$+=H){for(var X=Math.sin($),W=Math.cos($),Y=0,z=0;z<c.length;z+=2){var J=m[z],re=m[z+1],ae=o[z]-g[0],pe=o[z+1]-g[1],de=ae*W-pe*X,ve=ae*X+pe*W;M[z]=de,M[z+1]=ve;var me=de-J,Ie=ve-re;Y+=me*me+Ie*Ie}if(Y<A){A=Y,x=$;for(var Le=0;Le<M.length;Le++)y[Le]=M[Le]}}i.push({from:m,to:y,fromCp:d,toCp:g,rotation:-x})}return i}function dM(t){return t.__isCombineMorphing}var jee="__mOriginal_";function pM(t,e,r){var n=jee+e,i=t[n]||t[e];t[n]||(t[n]=t[e]);var a=r.replace,l=r.after,c=r.before;t[e]=function(){var o=arguments,d;return c&&c.apply(this,o),a?d=a.apply(this,o):d=i.apply(this,o),l&&l.apply(this,o),d}}function S1(t,e){var r=jee+e;t[r]&&(t[e]=t[r],t[r]=null)}function uW(t,e){for(var r=0;r<t.length;r++)for(var n=t[r],i=0;i<n.length;){var a=n[i],l=n[i+1];n[i++]=e[0]*a+e[2]*l+e[4],n[i++]=e[1]*a+e[3]*l+e[5]}}function Wee(t,e){var r=t.getUpdatedPathProxy(),n=e.getUpdatedPathProxy(),i=I5e(r3(r),r3(n)),a=i[0],l=i[1],c=t.getComputedTransform(),o=e.getComputedTransform();function d(){this.transform=null}c&&uW(a,c),o&&uW(l,o),pM(e,"updateTransform",{replace:d}),e.transform=null;var g=P5e(a,l,10,Math.PI),m=[];pM(e,"buildPath",{replace:function(y){for(var x=e.__morphT,A=1-x,M=[],D=0;D<g.length;D++){var P=g[D],O=P.from,z=P.to,V=P.rotation*x,H=P.fromCp,$=P.toCp,X=Math.sin(V),W=Math.cos(V);BA(M,H,$,x);for(var Y=0;Y<O.length;Y+=2){var J=O[Y],re=O[Y+1],ae=z[Y],pe=z[Y+1],de=J*A+ae*x,ve=re*A+pe*x;m[Y]=de*W-ve*X+M[0],m[Y+1]=de*X+ve*W+M[1]}var me=m[0],Ie=m[1];y.moveTo(me,Ie);for(var Y=2;Y<O.length;){var ae=m[Y++],pe=m[Y++],Le=m[Y++],Ee=m[Y++],Ue=m[Y++],Ke=m[Y++];me===ae&&Ie===pe&&Le===Ue&&Ee===Ke?y.lineTo(Ue,Ke):y.bezierCurveTo(ae,pe,Le,Ee,Ue,Ke),me=Ue,Ie=Ke}}}})}function T5(t,e,r){if(!t||!e)return e;var n=r.done,i=r.during;Wee(t,e),e.__morphT=0;function a(){S1(e,"buildPath"),S1(e,"updateTransform"),e.__morphT=-1,e.createPathProxy(),e.dirtyShape()}return e.animateTo({__morphT:1},Fr({during:function(l){e.dirtyShape(),i&&i(l)},done:function(){a(),n&&n()}},r)),e}function L5e(t,e,r,n,i,a){var l=16;t=i===r?0:Math.round(32767*(t-r)/(i-r)),e=a===n?0:Math.round(32767*(e-n)/(a-n));for(var c=0,o,d=(1<<l)/2;d>0;d/=2){var g=0,m=0;(t&d)>0&&(g=1),(e&d)>0&&(m=1),c+=d*d*(3*g^m),m===0&&(g===1&&(t=d-1-t,e=d-1-e),o=t,t=e,e=o)}return c}function gM(t){var e=1/0,r=1/0,n=-1/0,i=-1/0,a=Zt(t,function(c){var o=c.getBoundingRect(),d=c.getComputedTransform(),g=o.x+o.width/2+(d?d[4]:0),m=o.y+o.height/2+(d?d[5]:0);return e=Math.min(g,e),r=Math.min(m,r),n=Math.max(g,n),i=Math.max(m,i),[g,m]}),l=Zt(a,function(c,o){return{cp:c,z:L5e(c[0],c[1],e,r,n,i),path:t[o]}});return l.sort(function(c,o){return c.z-o.z}).map(function(c){return c.path})}function Zee(t){return C5e(t.path,t.count)}function i3(){return{fromIndividuals:[],toIndividuals:[],count:0}}function R5e(t,e,r){var n=[];function i(H){for(var $=0;$<H.length;$++){var X=H[$];dM(X)?i(X.childrenRef()):X instanceof kn&&n.push(X)}}i(t);var a=n.length;if(!a)return i3();var l=r.dividePath||Zee,c=l({path:e,count:a});if(c.length!==a)return console.error("Invalid morphing: unmatched splitted path"),i3();n=gM(n),c=gM(c);for(var o=r.done,d=r.during,g=r.individualDelay,m=new th,y=0;y<a;y++){var x=n[y],A=c[y];A.parent=e,A.copyTransform(m),g||Wee(x,A)}e.__isCombineMorphing=!0,e.childrenRef=function(){return c};function M(H){for(var $=0;$<c.length;$++)c[$].addSelfToZr(H)}pM(e,"addSelfToZr",{after:function(H){M(H)}}),pM(e,"removeSelfFromZr",{after:function(H){for(var $=0;$<c.length;$++)c[$].removeSelfFromZr(H)}});function D(){e.__isCombineMorphing=!1,e.__morphT=-1,e.childrenRef=null,S1(e,"addSelfToZr"),S1(e,"removeSelfFromZr")}var P=c.length;if(g)for(var O=P,z=function(){O--,O===0&&(D(),o&&o())},y=0;y<P;y++){var V=g?Fr({delay:(r.delay||0)+g(y,P,n[y],c[y]),done:z},r):r;T5(n[y],c[y],V)}else e.__morphT=0,e.animateTo({__morphT:1},Fr({during:function(H){for(var $=0;$<P;$++){var X=c[$];X.__morphT=e.__morphT,X.dirtyShape()}d&&d(H)},done:function(){D();for(var H=0;H<t.length;H++)S1(t[H],"updateTransform");o&&o()}},r));return e.__zr&&M(e.__zr),{fromIndividuals:n,toIndividuals:c,count:P}}function k5e(t,e,r){var n=e.length,i=[],a=r.dividePath||Zee;function l(x){for(var A=0;A<x.length;A++){var M=x[A];dM(M)?l(M.childrenRef()):M instanceof kn&&i.push(M)}}if(dM(t)){l(t.childrenRef());var c=i.length;if(c<n)for(var o=0,d=c;d<n;d++)i.push(Vz(i[o++%c]));i.length=n}else{i=a({path:t,count:n});for(var g=t.getComputedTransform(),d=0;d<i.length;d++)i[d].setLocalTransform(g);if(i.length!==n)return console.error("Invalid morphing: unmatched splitted path"),i3()}i=gM(i),e=gM(e);for(var m=r.individualDelay,d=0;d<n;d++){var y=m?Fr({delay:(r.delay||0)+m(d,n,i[d],e[d])},r):r;T5(i[d],e[d],y)}return{fromIndividuals:i,toIndividuals:e,count:e.length}}function cW(t){return Ht(t[0])}function hW(t,e){for(var r=[],n=t.length,i=0;i<n;i++)r.push({one:t[i],many:[]});for(var i=0;i<e.length;i++){var a=e[i].length,l=void 0;for(l=0;l<a;l++)r[l%n].many.push(e[i][l])}for(var c=0,i=n-1;i>=0;i--)if(!r[i].many.length){var o=r[c].many;if(o.length<=1)if(c)c=0;else return r;var a=o.length,d=Math.ceil(a/2);r[i].many=o.slice(d,a),r[c].many=o.slice(0,d),c++}return r}var O5e={clone:function(t){for(var e=[],r=1-Math.pow(1-t.path.style.opacity,1/t.count),n=0;n<t.count;n++){var i=Vz(t.path);i.setStyle("opacity",r),e.push(i)}return e},split:null};function ER(t,e,r,n,i,a){if(!t.length||!e.length)return;var l=ly("update",n,i);if(!(l&&l.duration>0))return;var c=n.getModel("universalTransition").get("delay"),o=Object.assign({setToFinal:!0},l),d,g;cW(t)&&(d=t,g=e),cW(e)&&(d=e,g=t);function m(P,O,z,V,H){var $=P.many,X=P.one;if($.length===1&&!H){var W=O?$[0]:X,Y=O?X:$[0];if(dM(W))m({many:[W],one:Y},!0,z,V,!0);else{var J=c?Fr({delay:c(z,V)},o):o;T5(W,Y,J),a(W,Y,W,Y,J)}}else for(var re=Fr({dividePath:O5e[r],individualDelay:c&&function(Ie,Le,Ee,Ue){return c(Ie+z,V)}},o),ae=O?R5e($,X,re):k5e(X,$,re),pe=ae.fromIndividuals,de=ae.toIndividuals,ve=pe.length,me=0;me<ve;me++){var J=c?Fr({delay:c(me,ve)},o):o;a(pe[me],de[me],O?$[me]:P.one,O?P.one:$[me],J)}}for(var y=d?d===t:t.length>e.length,x=d?hW(g,d):hW(y?e:t,[y?t:e]),A=0,M=0;M<x.length;M++)A+=x[M].many.length;for(var D=0,M=0;M<x.length;M++)m(x[M],y,D,A),D+=x[M].many.length}function dg(t){if(!t)return[];if(Ht(t)){for(var e=[],r=0;r<t.length;r++)e.push(dg(t[r]));return e}var n=[];return t.traverse(function(i){i instanceof kn&&!i.disableMorphing&&!i.invisible&&!i.ignore&&n.push(i)}),n}var qee=1e4,z5e=0,fW=1,dW=2,B5e=ri();function F5e(t,e){for(var r=t.dimensions,n=0;n<r.length;n++){var i=t.getDimensionInfo(r[n]);if(i&&i.otherDims[e]===0)return r[n]}}function N5e(t,e,r){var n=t.getDimensionInfo(r),i=n&&n.ordinalMeta;if(n){var a=t.get(n.name,e);return i&&i.categories[a]||a+""}}function pW(t,e,r,n){var i=n?"itemChildGroupId":"itemGroupId",a=F5e(t,i);if(a){var l=N5e(t,e,a);return l}var c=t.getRawDataItem(e),o=n?"childGroupId":"groupId";if(c&&c[o])return c[o]+"";if(!n)return r||t.getId(e)}function gW(t){var e=[];return fe(t,function(r){var n=r.data,i=r.dataGroupId;if(!(n.count()>qee))for(var a=n.getIndices(),l=0;l<a.length;l++)e.push({data:n,groupId:pW(n,l,i,!1),childGroupId:pW(n,l,i,!0),divide:r.divide,dataIndex:l})}),e}function DR(t,e,r){t.traverse(function(n){n instanceof kn&&Qi(n,{style:{opacity:0}},e,{dataIndex:r,isFrom:!0})})}function PR(t){if(t.parent){var e=t.getComputedTransform();t.setLocalTransform(e),t.parent.remove(t)}}function u_(t){t.stopAnimation(),t.isGroup&&t.traverse(function(e){e.stopAnimation()})}function V5e(t,e,r){var n=ly("update",r,e);n&&t.traverse(function(i){if(i instanceof zl){var a=kbe(i);a&&i.animateFrom({style:a},n)}})}function G5e(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++){var i=t[n],a=e[n];if(i.data.getId(i.dataIndex)!==a.data.getId(a.dataIndex))return!1}return!0}function Yee(t,e,r){var n=gW(t),i=gW(e);function a(z,V,H,$,X){(H||z)&&V.animateFrom({style:H&&H!==z?Lt(Lt({},H.style),z.style):z.style},X)}var l=!1,c=z5e,o=Ir(),d=Ir();n.forEach(function(z){z.groupId&&o.set(z.groupId,!0),z.childGroupId&&d.set(z.childGroupId,!0)});for(var g=0;g<i.length;g++){var m=i[g].groupId;if(d.get(m)){c=fW;break}var y=i[g].childGroupId;if(y&&o.get(y)){c=dW;break}}function x(z,V){return function(H){var $=H.data,X=H.dataIndex;return V?$.getId(X):z?c===fW?H.childGroupId:H.groupId:c===dW?H.childGroupId:H.groupId}}var A=G5e(n,i),M={};if(!A)for(var g=0;g<i.length;g++){var D=i[g],P=D.data.getItemGraphicEl(D.dataIndex);P&&(M[P.id]=!0)}function O(z,V){var H=n[V],$=i[z],X=$.data.hostModel,W=H.data.getItemGraphicEl(H.dataIndex),Y=$.data.getItemGraphicEl($.dataIndex);if(W===Y){Y&&V5e(Y,$.dataIndex,X);return}W&&M[W.id]||Y&&(u_(Y),W?(u_(W),PR(W),l=!0,ER(dg(W),dg(Y),$.divide,X,z,a)):DR(Y,X,z))}new mh(n,i,x(!0,A),x(!1,A),null,"multiple").update(O).updateManyToOne(function(z,V){var H=i[z],$=H.data,X=$.hostModel,W=$.getItemGraphicEl(H.dataIndex),Y=Ei(Zt(V,function(J){return n[J].data.getItemGraphicEl(n[J].dataIndex)}),function(J){return J&&J!==W&&!M[J.id]});W&&(u_(W),Y.length?(fe(Y,function(J){u_(J),PR(J)}),l=!0,ER(dg(Y),dg(W),H.divide,X,z,a)):DR(W,X,H.dataIndex))}).updateOneToMany(function(z,V){var H=n[V],$=H.data.getItemGraphicEl(H.dataIndex);if(!($&&M[$.id])){var X=Ei(Zt(z,function(Y){return i[Y].data.getItemGraphicEl(i[Y].dataIndex)}),function(Y){return Y&&Y!==$}),W=i[z[0]].data.hostModel;X.length&&(fe(X,function(Y){return u_(Y)}),$?(u_($),PR($),l=!0,ER(dg($),dg(X),H.divide,W,z[0],a)):fe(X,function(Y){return DR(Y,W,z[0])}))}}).updateManyToMany(function(z,V){new mh(V,z,function(H){return n[H].data.getId(n[H].dataIndex)},function(H){return i[H].data.getId(i[H].dataIndex)}).update(function(H,$){O(z[H],V[$])}).execute()}).execute(),l&&fe(e,function(z){var V=z.data,H=V.hostModel,$=H&&r.getViewOfSeriesModel(H),X=ly("update",H,0);$&&H.isAnimationEnabled()&&X&&X.duration>0&&$.group.traverse(function(W){W instanceof kn&&!W.animators.length&&W.animateFrom({style:{opacity:0}},X)})})}function vW(t){var e=t.getModel("universalTransition").get("seriesKey");return e||t.id}function mW(t){return Ht(t)?t.sort().join(","):t}function Uf(t){if(t.hostModel)return t.hostModel.getModel("universalTransition").get("divideShape")}function U5e(t,e){var r=Ir(),n=Ir(),i=Ir();return fe(t.oldSeries,function(a,l){var c=t.oldDataGroupIds[l],o=t.oldData[l],d=vW(a),g=mW(d);n.set(g,{dataGroupId:c,data:o}),Ht(d)&&fe(d,function(m){i.set(m,{key:g,dataGroupId:c,data:o})})}),fe(e.updatedSeries,function(a){if(a.isUniversalTransitionEnabled()&&a.isAnimationEnabled()){var l=a.get("dataGroupId"),c=a.getData(),o=vW(a),d=mW(o),g=n.get(d);if(g)r.set(d,{oldSeries:[{dataGroupId:g.dataGroupId,divide:Uf(g.data),data:g.data}],newSeries:[{dataGroupId:l,divide:Uf(c),data:c}]});else if(Ht(o)){var m=[];fe(o,function(A){var M=n.get(A);M.data&&m.push({dataGroupId:M.dataGroupId,divide:Uf(M.data),data:M.data})}),m.length&&r.set(d,{oldSeries:m,newSeries:[{dataGroupId:l,data:c,divide:Uf(c)}]})}else{var y=i.get(o);if(y){var x=r.get(y.key);x||(x={oldSeries:[{dataGroupId:y.dataGroupId,data:y.data,divide:Uf(y.data)}],newSeries:[]},r.set(y.key,x)),x.newSeries.push({dataGroupId:l,data:c,divide:Uf(c)})}}}}),r}function _W(t,e){for(var r=0;r<t.length;r++){var n=e.seriesIndex!=null&&e.seriesIndex===t[r].seriesIndex||e.seriesId!=null&&e.seriesId===t[r].id;if(n)return r}}function $5e(t,e,r,n){var i=[],a=[];fe(Pi(t.from),function(l){var c=_W(e.oldSeries,l);c>=0&&i.push({dataGroupId:e.oldDataGroupIds[c],data:e.oldData[c],divide:Uf(e.oldData[c]),groupIdDim:l.dimension})}),fe(Pi(t.to),function(l){var c=_W(r.updatedSeries,l);if(c>=0){var o=r.updatedSeries[c].getData();a.push({dataGroupId:e.oldDataGroupIds[c],data:o,divide:Uf(o),groupIdDim:l.dimension})}}),i.length>0&&a.length>0&&Yee(i,a,n)}function H5e(t){t.registerUpdateLifecycle("series:beforeupdate",function(e,r,n){fe(Pi(n.seriesTransition),function(i){fe(Pi(i.to),function(a){for(var l=n.updatedSeries,c=0;c<l.length;c++)(a.seriesIndex!=null&&a.seriesIndex===l[c].seriesIndex||a.seriesId!=null&&a.seriesId===l[c].id)&&(l[c][qA]=!0)})})}),t.registerUpdateLifecycle("series:transition",function(e,r,n){var i=B5e(r);if(i.oldSeries&&n.updatedSeries&&n.optionChanged){var a=n.seriesTransition;if(a)fe(Pi(a),function(x){$5e(x,i,n,r)});else{var l=U5e(i,n);fe(l.keys(),function(x){var A=l.get(x);Yee(A.oldSeries,A.newSeries,r)})}fe(n.updatedSeries,function(x){x[qA]&&(x[qA]=!1)})}for(var c=e.getSeries(),o=i.oldSeries=[],d=i.oldDataGroupIds=[],g=i.oldData=[],m=0;m<c.length;m++){var y=c[m].getData();y.count()<qee&&(o.push(c[m]),d.push(c[m].get("dataGroupId")),g.push(y))}})}En([JCe]);En([qCe]);En([yMe,kMe,HMe,SIe,kIe,xEe,qEe,PDe,JDe,aPe,pPe,lLe,RLe,HLe,oRe,cRe,xRe,MRe,FRe,HRe,eke,Bke]);En(rOe);En(EOe);En(ZK);En(UOe);En(LJ);En(WOe);En(t3e);En(U3e);En(sze);En($b);En(Tze);En(Mze);En(Bze);En(Hze);En(Xze);En(rBe);En(fBe);En(DBe);En(Oee);En(zee);En(XBe);En(Gee);En(Uee);En(t5e);En(p5e);En(m5e);En(H5e);En(pCe);const j5e={id:"main"},W5e={__name:"RatingChange",setup(t){const e=["Arsenal","Aston Villa","Bournemouth","Brentford","Brighton","Burnley","Chelsea","Crystal Palace","Everton","Fulham","Liverpool","Luton Town","Man City","Man United","Newcastle","Nottingham","Sheffield United","Hotspur","West Ham","Wolve"],r=()=>{const a=new Map,l={Arsenal:[4,3,5,5,4,5,3,2,3,2,4,3,1,1,1,2,1,1,2,4,3,3,3,3,3,3,3,1,2,2,1,2,1,1,1,2,2,2],"Man City":[3,2,1,1,1,1,1,3,2,3,1,1,2,3,4,4,4,4,3,2,2,2,2,2,2,2,3,3,3,3,1,2,2,2,1,1,1,1],Liverpool:[12,5,4,3,3,2,4,4,4,4,3,2,3,2,2,1,2,2,1,1,1,1,1,1,1,1,1,2,1,1,2,3,3,3,3,3,3,3],"Aston Villa":[20,9,7,10,7,6,5,5,5,5,5,5,4,4,3,3,3,3,3,2,4,5,4,5,4,4,4,4,4,4,4,5,4,4,4,4,4,4],Bournemouth:[10,14,16,16,15,17,19,19,19,17,18,17,17,17,16,15,13,13,13,13,13,13,14,14,15,14,13,13,12,12,13,10,10,10,13,13,12,12],Hotspur:[9,6,3,2,2,4,2,1,1,1,2,4,5,5,5,5,5,4,5,5,5,4,5,4,5,5,5,5,5,5,4,5,5,5,5,5,5,5],Chelsea:[11,15,10,12,14,14,11,11,10,11,10,10,10,10,11,13,11,11,11,10,9,10,11,10,10,11,11,11,10,9,9,9,8,8,7,7,6,6],Newcastle:[1,8,13,14,12,8,8,8,6,6,6,7,7,6,7,7,6,7,9,9,10,8,9,7,8,10,8,10,8,8,8,6,7,7,6,7,7,7],"Man United":[7,12,8,11,13,9,10,10,8,8,8,6,6,7,6,6,7,8,7,8,8,7,6,6,6,6,6,6,6,6,6,7,6,6,8,8,8,8],"West Ham":[13,7,2,4,6,7,7,7,9,9,12,9,9,9,9,9,8,6,6,6,6,6,7,8,9,8,7,7,7,7,7,7,8,8,9,9,9,9],"Crystal Palace":[5,11,11,7,8,9,8,8,11,13,11,13,13,13,15,16,16,16,16,15,16,15,15,16,16,14,15,15,15,15,15,15,15,15,15,15,13,10],Brighton:[2,1,6,6,5,3,6,6,7,7,7,8,8,8,8,8,9,9,8,7,7,9,8,9,7,7,9,8,9,9,10,10,11,12,11,10,11,11],Fulham:[6,13,12,13,10,11,13,12,13,14,15,16,14,15,13,11,12,14,14,14,14,14,14,12,13,12,12,12,12,12,13,13,12,13,14,14,14,13],Wolve:[17,19,15,15,16,16,15,14,12,12,14,12,12,14,14,14,14,12,12,11,11,11,10,11,11,9,10,9,10,11,11,11,12,11,12,14,15,14],Everton:[15,20,20,18,18,15,16,16,16,15,16,14,18,17,17,16,15,15,15,17,17,16,16,16,17,17,17,17,17,17,17,17,16,15,15,15,15,15],Brentford:[8,4,9,8,11,13,14,15,14,10,9,11,11,11,12,12,13,15,17,15,16,16,15,15,16,16,16,16,16,17,16,16,16,16,16,16,16,16],Nottingham:[14,10,14,9,8,12,12,13,15,16,13,15,16,16,17,17,17,17,17,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17],"Luton Town":[18,19,19,20,18,17,17,17,18,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18],Burnley:[19,18,20,19,19,18,18,18,19,19,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19],Sheffield:[16,16,17,17,17,20,20,20,20,20,20,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20]};for(const[c,o]of Object.entries(l))a.set(c,o);return a},n=()=>{const a=[],l=r(),c=["red","rgb(25, 138, 179)","rgb(240, 37, 37)","rgb(93, 17, 93)","rgb(205, 7, 7)","rgb(155, 155, 155)","blue","rgb(16, 12, 12)","rgb(240, 37, 37)","rgb(93, 45, 45)","rgb(20, 39, 186)","rgb(8, 82, 241)","rgb(155, 155, 155)","rgb(222, 168, 4)","rgb(30, 6, 239)","rgb(222, 4, 4)","rgb(191, 2, 94)","rgb(207, 93, 5)","rgb(63, 13, 63)","rgb(158, 59, 89)"];let o=0;return l.forEach((d,g)=>{const m={name:g,symbolSize:20,type:"line",smooth:!0,emphasis:{focus:"series"},endLabel:{show:!0,formatter:"{a}",distance:20},lineStyle:{width:4,color:c[o%c.length]},itemStyle:{color:c[o%c.length]},data:d};a.push(m),o++}),a},i=()=>{const a=document.getElementById("main"),l=pQ(a),c={title:{text:"Premier League Club Ranking Changes"},tooltip:{trigger:"item"},grid:{left:30,right:110,bottom:30,containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",splitLine:{show:!0},axisLabel:{margin:30,fontSize:16},boundaryGap:!1,data:Array.from({length:38},(o,d)=>d+1)},yAxis:{type:"value",axisLabel:{margin:30,fontSize:16,formatter:"#{value}"},inverse:!0,interval:1,min:1,max:e.length},series:n()};l.setOption(c)};return Vn(()=>{i()}),(a,l)=>(Nt(),Gr("div",j5e))}},Z5e=na(W5e,[["__scopeId","data-v-815de4e7"]]),q5e={id:"goal-pie",class:"chart"},Y5e={__name:"GoalPie",setup(t){const e=[{value:91,name:"Arsenal"},{value:76,name:"Aston Villa"},{value:54,name:"Bournemouth"},{value:56,name:"Brentford"},{value:55,name:"Brighton"},{value:41,name:"Burnley"},{value:77,name:"Chelsea"},{value:57,name:"Crystal Palace"},{value:40,name:"Everton"},{value:55,name:"Fulham"},{value:86,name:"Liverpool"},{value:52,name:"Luton Town"},{value:96,name:"Manchester City"},{value:67,name:"Manchester United"},{value:85,name:"Newcastle United"},{value:49,name:"Nottingham Forest"},{value:35,name:"Sheffield United"},{value:74,name:"Tottenham Hotspur"},{value:60,name:"West Ham United"},{value:50,name:"Wolverhampton Wanderers"}];return Vn(()=>{var r=document.getElementById("goal-pie"),n=pQ(r),i;i={tooltip:{trigger:"item"},series:[{name:"",type:"pie",radius:["20%","70%"],roseType:"radius",avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},data:e}]},n.setOption(i)}),(r,n)=>(Nt(),Gr("div",q5e))}},X5e=na(Y5e,[["__scopeId","data-v-e65125dc"]]),Xee=t=>(c7("data-v-b6374710"),t=t(),h7(),t),Q5e=Xee(()=>wt("img",{style:{width:"50px"},src:Wye,alt:"Element logo"},null,-1)),K5e=Xee(()=>wt("div",{class:"flex-grow"},null,-1)),J5e=["innerHTML"],eFe={class:"chart-container"},tFe={__name:"Menu",setup(t){at("1");function e(m,y){console.log(m,y)}const r=at(!1),n=at("<iframe src='https://www.aiscore.com/zht/tournament-english-premier-league/mo07dni2vfxknxy/standings/4ndqmliezotlkve?isplugin=true'  height='1176' width='100%' scrolling='auto' border='0' frameborder='0'></iframe>"),i=Ta(),{selectedClub:a}=X7(i),l=gz(),c=()=>{a.value=null,l.flyToOverview()},o=at(!1),d=at("first"),g=(m,y)=>{console.log(m,y)};return(m,y)=>{const x=T_e,A=S_e,M=ZM,D=Tme,P=Uye,O=n_e,z=Gye;return Nt(),Gr(ha,null,[He(A,{class:"header-menu",mode:"horizontal",ellipsis:!1,onSelect:e},{default:pt(()=>[He(x,{index:"0",onClick:c},{default:pt(()=>[Q5e,ji("  ")]),_:1}),K5e,He(x,{index:"1",onClick:y[0]||(y[0]=V=>r.value=!0)},{default:pt(()=>[ji("")]),_:1}),He(x,{index:"2",onClick:y[1]||(y[1]=V=>o.value=!0)},{default:pt(()=>[ji("")]),_:1})]),_:1}),He(D,{modelValue:r.value,"onUpdate:modelValue":y[2]||(y[2]=V=>r.value=V),"with-header":!1,direction:"ltr",size:"45%"},{default:pt(()=>[He(M,null,{default:pt(()=>[wt("div",{id:"tour_standings",innerHTML:n.value,height:"100%"},null,8,J5e)]),_:1})]),_:1},8,["modelValue"]),He(D,{modelValue:o.value,"onUpdate:modelValue":y[4]||(y[4]=V=>o.value=V),"with-header":!1,direction:"btt",size:"80%"},{default:pt(()=>[He(z,{modelValue:d.value,"onUpdate:modelValue":y[3]||(y[3]=V=>d.value=V),class:"chart-tabs",onTabClick:g},{default:pt(()=>[He(P,{label:"",name:"first"},{default:pt(()=>[wt("div",eFe,[He(Z5e)])]),_:1}),He(P,{label:"",name:"second"},{default:pt(()=>[wt("div",null,[He(X5e)])]),_:1}),He(P,{label:"..",name:"third"},{default:pt(()=>[He(O,{description:""})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])],64)}}},rFe=na(tFe,[["__scopeId","data-v-b6374710"]]);function Qee(t,e){return function(){return t.apply(e,arguments)}}const{toString:nFe}=Object.prototype,{getPrototypeOf:A5}=Object,BI=(t=>e=>{const r=nFe.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Au=t=>(t=t.toLowerCase(),e=>BI(e)===t),FI=t=>e=>typeof e===t,{isArray:yy}=Array,fb=FI("undefined");function iFe(t){return t!==null&&!fb(t)&&t.constructor!==null&&!fb(t.constructor)&&Rl(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Kee=Au("ArrayBuffer");function aFe(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Kee(t.buffer),e}const oFe=FI("string"),Rl=FI("function"),Jee=FI("number"),NI=t=>t!==null&&typeof t=="object",sFe=t=>t===!0||t===!1,rC=t=>{if(BI(t)!=="object")return!1;const e=A5(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},lFe=Au("Date"),uFe=Au("File"),cFe=Au("Blob"),hFe=Au("FileList"),fFe=t=>NI(t)&&Rl(t.pipe),dFe=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Rl(t.append)&&((e=BI(t))==="formdata"||e==="object"&&Rl(t.toString)&&t.toString()==="[object FormData]"))},pFe=Au("URLSearchParams"),[gFe,vFe,mFe,_Fe]=["ReadableStream","Request","Response","Headers"].map(Au),yFe=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Hb(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,i;if(typeof t!="object"&&(t=[t]),yy(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{const a=r?Object.getOwnPropertyNames(t):Object.keys(t),l=a.length;let c;for(n=0;n<l;n++)c=a[n],e.call(null,t[c],c,t)}}function ete(t,e){e=e.toLowerCase();const r=Object.keys(t);let n=r.length,i;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const tte=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,rte=t=>!fb(t)&&t!==tte;function a3(){const{caseless:t}=rte(this)&&this||{},e={},r=(n,i)=>{const a=t&&ete(e,i)||i;rC(e[a])&&rC(n)?e[a]=a3(e[a],n):rC(n)?e[a]=a3({},n):yy(n)?e[a]=n.slice():e[a]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Hb(arguments[n],r);return e}const xFe=(t,e,r,{allOwnKeys:n}={})=>(Hb(e,(i,a)=>{r&&Rl(i)?t[a]=Qee(i,r):t[a]=i},{allOwnKeys:n}),t),bFe=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),wFe=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},SFe=(t,e,r,n)=>{let i,a,l;const c={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),a=i.length;a-- >0;)l=i[a],(!n||n(l,t,e))&&!c[l]&&(e[l]=t[l],c[l]=!0);t=r!==!1&&A5(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},TFe=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},AFe=t=>{if(!t)return null;if(yy(t))return t;let e=t.length;if(!Jee(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},CFe=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&A5(Uint8Array)),MFe=(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=n.next())&&!i.done;){const a=i.value;e.call(t,a[0],a[1])}},IFe=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},EFe=Au("HTMLFormElement"),DFe=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),yW=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),PFe=Au("RegExp"),nte=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Hb(r,(i,a)=>{let l;(l=e(i,a,t))!==!1&&(n[a]=l||i)}),Object.defineProperties(t,n)},LFe=t=>{nte(t,(e,r)=>{if(Rl(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(Rl(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},RFe=(t,e)=>{const r={},n=i=>{i.forEach(a=>{r[a]=!0})};return yy(t)?n(t):n(String(t).split(e)),r},kFe=()=>{},OFe=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,LR="abcdefghijklmnopqrstuvwxyz",xW="0123456789",ite={DIGIT:xW,ALPHA:LR,ALPHA_DIGIT:LR+LR.toUpperCase()+xW},zFe=(t=16,e=ite.ALPHA_DIGIT)=>{let r="";const{length:n}=e;for(;t--;)r+=e[Math.random()*n|0];return r};function BFe(t){return!!(t&&Rl(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const FFe=t=>{const e=new Array(10),r=(n,i)=>{if(NI(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[i]=n;const a=yy(n)?[]:{};return Hb(n,(l,c)=>{const o=r(l,i+1);!fb(o)&&(a[c]=o)}),e[i]=void 0,a}}return n};return r(t,0)},NFe=Au("AsyncFunction"),VFe=t=>t&&(NI(t)||Rl(t))&&Rl(t.then)&&Rl(t.catch),Wt={isArray:yy,isArrayBuffer:Kee,isBuffer:iFe,isFormData:dFe,isArrayBufferView:aFe,isString:oFe,isNumber:Jee,isBoolean:sFe,isObject:NI,isPlainObject:rC,isReadableStream:gFe,isRequest:vFe,isResponse:mFe,isHeaders:_Fe,isUndefined:fb,isDate:lFe,isFile:uFe,isBlob:cFe,isRegExp:PFe,isFunction:Rl,isStream:fFe,isURLSearchParams:pFe,isTypedArray:CFe,isFileList:hFe,forEach:Hb,merge:a3,extend:xFe,trim:yFe,stripBOM:bFe,inherits:wFe,toFlatObject:SFe,kindOf:BI,kindOfTest:Au,endsWith:TFe,toArray:AFe,forEachEntry:MFe,matchAll:IFe,isHTMLForm:EFe,hasOwnProperty:yW,hasOwnProp:yW,reduceDescriptors:nte,freezeMethods:LFe,toObjectSet:RFe,toCamelCase:DFe,noop:kFe,toFiniteNumber:OFe,findKey:ete,global:tte,isContextDefined:rte,ALPHABET:ite,generateString:zFe,isSpecCompliantForm:BFe,toJSONObject:FFe,isAsyncFn:NFe,isThenable:VFe};function Xn(t,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}Wt.inherits(Xn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Wt.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const ate=Xn.prototype,ote={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{ote[t]={value:t}});Object.defineProperties(Xn,ote);Object.defineProperty(ate,"isAxiosError",{value:!0});Xn.from=(t,e,r,n,i,a)=>{const l=Object.create(ate);return Wt.toFlatObject(t,l,function(o){return o!==Error.prototype},c=>c!=="isAxiosError"),Xn.call(l,t.message,e,r,n,i),l.cause=t,l.name=t.name,a&&Object.assign(l,a),l};const GFe=null;function o3(t){return Wt.isPlainObject(t)||Wt.isArray(t)}function ste(t){return Wt.endsWith(t,"[]")?t.slice(0,-2):t}function bW(t,e,r){return t?t.concat(e).map(function(i,a){return i=ste(i),!r&&a?"["+i+"]":i}).join(r?".":""):e}function UFe(t){return Wt.isArray(t)&&!t.some(o3)}const $Fe=Wt.toFlatObject(Wt,{},null,function(e){return/^is[A-Z]/.test(e)});function VI(t,e,r){if(!Wt.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=Wt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(M,D){return!Wt.isUndefined(D[M])});const n=r.metaTokens,i=r.visitor||g,a=r.dots,l=r.indexes,o=(r.Blob||typeof Blob<"u"&&Blob)&&Wt.isSpecCompliantForm(e);if(!Wt.isFunction(i))throw new TypeError("visitor must be a function");function d(A){if(A===null)return"";if(Wt.isDate(A))return A.toISOString();if(!o&&Wt.isBlob(A))throw new Xn("Blob is not supported. Use a Buffer instead.");return Wt.isArrayBuffer(A)||Wt.isTypedArray(A)?o&&typeof Blob=="function"?new Blob([A]):Buffer.from(A):A}function g(A,M,D){let P=A;if(A&&!D&&typeof A=="object"){if(Wt.endsWith(M,"{}"))M=n?M:M.slice(0,-2),A=JSON.stringify(A);else if(Wt.isArray(A)&&UFe(A)||(Wt.isFileList(A)||Wt.endsWith(M,"[]"))&&(P=Wt.toArray(A)))return M=ste(M),P.forEach(function(z,V){!(Wt.isUndefined(z)||z===null)&&e.append(l===!0?bW([M],V,a):l===null?M:M+"[]",d(z))}),!1}return o3(A)?!0:(e.append(bW(D,M,a),d(A)),!1)}const m=[],y=Object.assign($Fe,{defaultVisitor:g,convertValue:d,isVisitable:o3});function x(A,M){if(!Wt.isUndefined(A)){if(m.indexOf(A)!==-1)throw Error("Circular reference detected in "+M.join("."));m.push(A),Wt.forEach(A,function(P,O){(!(Wt.isUndefined(P)||P===null)&&i.call(e,P,Wt.isString(O)?O.trim():O,M,y))===!0&&x(P,M?M.concat(O):[O])}),m.pop()}}if(!Wt.isObject(t))throw new TypeError("data must be an object");return x(t),e}function wW(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function C5(t,e){this._pairs=[],t&&VI(t,this,e)}const lte=C5.prototype;lte.append=function(e,r){this._pairs.push([e,r])};lte.toString=function(e){const r=e?function(n){return e.call(this,n,wW)}:wW;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function HFe(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ute(t,e,r){if(!e)return t;const n=r&&r.encode||HFe,i=r&&r.serialize;let a;if(i?a=i(e,r):a=Wt.isURLSearchParams(e)?e.toString():new C5(e,r).toString(n),a){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class SW{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Wt.forEach(this.handlers,function(n){n!==null&&e(n)})}}const cte={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jFe=typeof URLSearchParams<"u"?URLSearchParams:C5,WFe=typeof FormData<"u"?FormData:null,ZFe=typeof Blob<"u"?Blob:null,qFe={isBrowser:!0,classes:{URLSearchParams:jFe,FormData:WFe,Blob:ZFe},protocols:["http","https","file","blob","url","data"]},M5=typeof window<"u"&&typeof document<"u",YFe=(t=>M5&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),XFe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",QFe=M5&&window.location.href||"http://localhost",KFe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:M5,hasStandardBrowserEnv:YFe,hasStandardBrowserWebWorkerEnv:XFe,origin:QFe},Symbol.toStringTag,{value:"Module"})),mu={...KFe,...qFe};function JFe(t,e){return VI(t,new mu.classes.URLSearchParams,Object.assign({visitor:function(r,n,i,a){return mu.isNode&&Wt.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function eNe(t){return Wt.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function tNe(t){const e={},r=Object.keys(t);let n;const i=r.length;let a;for(n=0;n<i;n++)a=r[n],e[a]=t[a];return e}function hte(t){function e(r,n,i,a){let l=r[a++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),o=a>=r.length;return l=!l&&Wt.isArray(i)?i.length:l,o?(Wt.hasOwnProp(i,l)?i[l]=[i[l],n]:i[l]=n,!c):((!i[l]||!Wt.isObject(i[l]))&&(i[l]=[]),e(r,n,i[l],a)&&Wt.isArray(i[l])&&(i[l]=tNe(i[l])),!c)}if(Wt.isFormData(t)&&Wt.isFunction(t.entries)){const r={};return Wt.forEachEntry(t,(n,i)=>{e(eNe(n),i,r,0)}),r}return null}function rNe(t,e,r){if(Wt.isString(t))try{return(e||JSON.parse)(t),Wt.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const jb={transitional:cte,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,a=Wt.isObject(e);if(a&&Wt.isHTMLForm(e)&&(e=new FormData(e)),Wt.isFormData(e))return i?JSON.stringify(hte(e)):e;if(Wt.isArrayBuffer(e)||Wt.isBuffer(e)||Wt.isStream(e)||Wt.isFile(e)||Wt.isBlob(e)||Wt.isReadableStream(e))return e;if(Wt.isArrayBufferView(e))return e.buffer;if(Wt.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return JFe(e,this.formSerializer).toString();if((c=Wt.isFileList(e))||n.indexOf("multipart/form-data")>-1){const o=this.env&&this.env.FormData;return VI(c?{"files[]":e}:e,o&&new o,this.formSerializer)}}return a||i?(r.setContentType("application/json",!1),rNe(e)):e}],transformResponse:[function(e){const r=this.transitional||jb.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(Wt.isResponse(e)||Wt.isReadableStream(e))return e;if(e&&Wt.isString(e)&&(n&&!this.responseType||i)){const l=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(c){if(l)throw c.name==="SyntaxError"?Xn.from(c,Xn.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:mu.classes.FormData,Blob:mu.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Wt.forEach(["delete","get","head","post","put","patch"],t=>{jb.headers[t]={}});const nNe=Wt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),iNe=t=>{const e={};let r,n,i;return t&&t.split(`
`).forEach(function(l){i=l.indexOf(":"),r=l.substring(0,i).trim().toLowerCase(),n=l.substring(i+1).trim(),!(!r||e[r]&&nNe[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},TW=Symbol("internals");function zx(t){return t&&String(t).trim().toLowerCase()}function nC(t){return t===!1||t==null?t:Wt.isArray(t)?t.map(nC):String(t)}function aNe(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const oNe=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function RR(t,e,r,n,i){if(Wt.isFunction(n))return n.call(this,e,r);if(i&&(e=r),!!Wt.isString(e)){if(Wt.isString(n))return e.indexOf(n)!==-1;if(Wt.isRegExp(n))return n.test(e)}}function sNe(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function lNe(t,e){const r=Wt.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(i,a,l){return this[n].call(this,e,i,a,l)},configurable:!0})})}class Cs{constructor(e){e&&this.set(e)}set(e,r,n){const i=this;function a(c,o,d){const g=zx(o);if(!g)throw new Error("header name must be a non-empty string");const m=Wt.findKey(i,g);(!m||i[m]===void 0||d===!0||d===void 0&&i[m]!==!1)&&(i[m||o]=nC(c))}const l=(c,o)=>Wt.forEach(c,(d,g)=>a(d,g,o));if(Wt.isPlainObject(e)||e instanceof this.constructor)l(e,r);else if(Wt.isString(e)&&(e=e.trim())&&!oNe(e))l(iNe(e),r);else if(Wt.isHeaders(e))for(const[c,o]of e.entries())a(o,c,n);else e!=null&&a(r,e,n);return this}get(e,r){if(e=zx(e),e){const n=Wt.findKey(this,e);if(n){const i=this[n];if(!r)return i;if(r===!0)return aNe(i);if(Wt.isFunction(r))return r.call(this,i,n);if(Wt.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=zx(e),e){const n=Wt.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||RR(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let i=!1;function a(l){if(l=zx(l),l){const c=Wt.findKey(n,l);c&&(!r||RR(n,n[c],c,r))&&(delete n[c],i=!0)}}return Wt.isArray(e)?e.forEach(a):a(e),i}clear(e){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const a=r[n];(!e||RR(this,this[a],a,e,!0))&&(delete this[a],i=!0)}return i}normalize(e){const r=this,n={};return Wt.forEach(this,(i,a)=>{const l=Wt.findKey(n,a);if(l){r[l]=nC(i),delete r[a];return}const c=e?sNe(a):String(a).trim();c!==a&&delete r[a],r[c]=nC(i),n[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return Wt.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=e&&Wt.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[TW]=this[TW]={accessors:{}}).accessors,i=this.prototype;function a(l){const c=zx(l);n[c]||(lNe(i,l),n[c]=!0)}return Wt.isArray(e)?e.forEach(a):a(e),this}}Cs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Wt.reduceDescriptors(Cs.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});Wt.freezeMethods(Cs);function kR(t,e){const r=this||jb,n=e||r,i=Cs.from(n.headers);let a=n.data;return Wt.forEach(t,function(c){a=c.call(r,a,i.normalize(),e?e.status:void 0)}),i.normalize(),a}function fte(t){return!!(t&&t.__CANCEL__)}function xy(t,e,r){Xn.call(this,t??"canceled",Xn.ERR_CANCELED,e,r),this.name="CanceledError"}Wt.inherits(xy,Xn,{__CANCEL__:!0});function dte(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new Xn("Request failed with status code "+r.status,[Xn.ERR_BAD_REQUEST,Xn.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function uNe(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function cNe(t,e){t=t||10;const r=new Array(t),n=new Array(t);let i=0,a=0,l;return e=e!==void 0?e:1e3,function(o){const d=Date.now(),g=n[a];l||(l=d),r[i]=o,n[i]=d;let m=a,y=0;for(;m!==i;)y+=r[m++],m=m%t;if(i=(i+1)%t,i===a&&(a=(a+1)%t),d-l<e)return;const x=g&&d-g;return x?Math.round(y*1e3/x):void 0}}function hNe(t,e){let r=0;const n=1e3/e;let i=null;return function(){const l=this===!0,c=Date.now();if(l||c-r>n)return i&&(clearTimeout(i),i=null),r=c,t.apply(null,arguments);i||(i=setTimeout(()=>(i=null,r=Date.now(),t.apply(null,arguments)),n-(c-r)))}}const vM=(t,e,r=3)=>{let n=0;const i=cNe(50,250);return hNe(a=>{const l=a.loaded,c=a.lengthComputable?a.total:void 0,o=l-n,d=i(o),g=l<=c;n=l;const m={loaded:l,total:c,progress:c?l/c:void 0,bytes:o,rate:d||void 0,estimated:d&&c&&g?(c-l)/d:void 0,event:a,lengthComputable:c!=null};m[e?"download":"upload"]=!0,t(m)},r)},fNe=mu.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");let n;function i(a){let l=a;return e&&(r.setAttribute("href",l),l=r.href),r.setAttribute("href",l),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=i(window.location.href),function(l){const c=Wt.isString(l)?i(l):l;return c.protocol===n.protocol&&c.host===n.host}}():function(){return function(){return!0}}(),dNe=mu.hasStandardBrowserEnv?{write(t,e,r,n,i,a){const l=[t+"="+encodeURIComponent(e)];Wt.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),Wt.isString(n)&&l.push("path="+n),Wt.isString(i)&&l.push("domain="+i),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pNe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function gNe(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function pte(t,e){return t&&!pNe(e)?gNe(t,e):e}const AW=t=>t instanceof Cs?{...t}:t;function ov(t,e){e=e||{};const r={};function n(d,g,m){return Wt.isPlainObject(d)&&Wt.isPlainObject(g)?Wt.merge.call({caseless:m},d,g):Wt.isPlainObject(g)?Wt.merge({},g):Wt.isArray(g)?g.slice():g}function i(d,g,m){if(Wt.isUndefined(g)){if(!Wt.isUndefined(d))return n(void 0,d,m)}else return n(d,g,m)}function a(d,g){if(!Wt.isUndefined(g))return n(void 0,g)}function l(d,g){if(Wt.isUndefined(g)){if(!Wt.isUndefined(d))return n(void 0,d)}else return n(void 0,g)}function c(d,g,m){if(m in e)return n(d,g);if(m in t)return n(void 0,d)}const o={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(d,g)=>i(AW(d),AW(g),!0)};return Wt.forEach(Object.keys(Object.assign({},t,e)),function(g){const m=o[g]||i,y=m(t[g],e[g],g);Wt.isUndefined(y)&&m!==c||(r[g]=y)}),r}const gte=t=>{const e=ov({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:a,headers:l,auth:c}=e;e.headers=l=Cs.from(l),e.url=ute(pte(e.baseURL,e.url),t.params,t.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let o;if(Wt.isFormData(r)){if(mu.hasStandardBrowserEnv||mu.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((o=l.getContentType())!==!1){const[d,...g]=o?o.split(";").map(m=>m.trim()).filter(Boolean):[];l.setContentType([d||"multipart/form-data",...g].join("; "))}}if(mu.hasStandardBrowserEnv&&(n&&Wt.isFunction(n)&&(n=n(e)),n||n!==!1&&fNe(e.url))){const d=i&&a&&dNe.read(a);d&&l.set(i,d)}return e},vNe=typeof XMLHttpRequest<"u",mNe=vNe&&function(t){return new Promise(function(r,n){const i=gte(t);let a=i.data;const l=Cs.from(i.headers).normalize();let{responseType:c}=i,o;function d(){i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let g=new XMLHttpRequest;g.open(i.method.toUpperCase(),i.url,!0),g.timeout=i.timeout;function m(){if(!g)return;const x=Cs.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),M={data:!c||c==="text"||c==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:x,config:t,request:g};dte(function(P){r(P),d()},function(P){n(P),d()},M),g=null}"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(m)},g.onabort=function(){g&&(n(new Xn("Request aborted",Xn.ECONNABORTED,i,g)),g=null)},g.onerror=function(){n(new Xn("Network Error",Xn.ERR_NETWORK,i,g)),g=null},g.ontimeout=function(){let A=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const M=i.transitional||cte;i.timeoutErrorMessage&&(A=i.timeoutErrorMessage),n(new Xn(A,M.clarifyTimeoutError?Xn.ETIMEDOUT:Xn.ECONNABORTED,i,g)),g=null},a===void 0&&l.setContentType(null),"setRequestHeader"in g&&Wt.forEach(l.toJSON(),function(A,M){g.setRequestHeader(M,A)}),Wt.isUndefined(i.withCredentials)||(g.withCredentials=!!i.withCredentials),c&&c!=="json"&&(g.responseType=i.responseType),typeof i.onDownloadProgress=="function"&&g.addEventListener("progress",vM(i.onDownloadProgress,!0)),typeof i.onUploadProgress=="function"&&g.upload&&g.upload.addEventListener("progress",vM(i.onUploadProgress)),(i.cancelToken||i.signal)&&(o=x=>{g&&(n(!x||x.type?new xy(null,t,g):x),g.abort(),g=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const y=uNe(i.url);if(y&&mu.protocols.indexOf(y)===-1){n(new Xn("Unsupported protocol "+y+":",Xn.ERR_BAD_REQUEST,t));return}g.send(a||null)})},_Ne=(t,e)=>{let r=new AbortController,n;const i=function(o){if(!n){n=!0,l();const d=o instanceof Error?o:this.reason;r.abort(d instanceof Xn?d:new xy(d instanceof Error?d.message:d))}};let a=e&&setTimeout(()=>{i(new Xn(`timeout ${e} of ms exceeded`,Xn.ETIMEDOUT))},e);const l=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(o=>{o&&(o.removeEventListener?o.removeEventListener("abort",i):o.unsubscribe(i))}),t=null)};t.forEach(o=>o&&o.addEventListener&&o.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=l,[c,()=>{a&&clearTimeout(a),a=null}]},yNe=function*(t,e){let r=t.byteLength;if(!e||r<e){yield t;return}let n=0,i;for(;n<r;)i=n+e,yield t.slice(n,i),n=i},xNe=async function*(t,e,r){for await(const n of t)yield*yNe(ArrayBuffer.isView(n)?n:await r(String(n)),e)},CW=(t,e,r,n,i)=>{const a=xNe(t,e,i);let l=0;return new ReadableStream({type:"bytes",async pull(c){const{done:o,value:d}=await a.next();if(o){c.close(),n();return}let g=d.byteLength;r&&r(l+=g),c.enqueue(new Uint8Array(d))},cancel(c){return n(c),a.return()}},{highWaterMark:2})},MW=(t,e)=>{const r=t!=null;return n=>setTimeout(()=>e({lengthComputable:r,total:t,loaded:n}))},GI=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",vte=GI&&typeof ReadableStream=="function",s3=GI&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),bNe=vte&&(()=>{let t=!1;const e=new Request(mu.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e})(),IW=64*1024,l3=vte&&!!(()=>{try{return Wt.isReadableStream(new Response("").body)}catch{}})(),mM={stream:l3&&(t=>t.body)};GI&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!mM[e]&&(mM[e]=Wt.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new Xn(`Response type '${e}' is not supported`,Xn.ERR_NOT_SUPPORT,n)})})})(new Response);const wNe=async t=>{if(t==null)return 0;if(Wt.isBlob(t))return t.size;if(Wt.isSpecCompliantForm(t))return(await new Request(t).arrayBuffer()).byteLength;if(Wt.isArrayBufferView(t))return t.byteLength;if(Wt.isURLSearchParams(t)&&(t=t+""),Wt.isString(t))return(await s3(t)).byteLength},SNe=async(t,e)=>{const r=Wt.toFiniteNumber(t.getContentLength());return r??wNe(e)},TNe=GI&&(async t=>{let{url:e,method:r,data:n,signal:i,cancelToken:a,timeout:l,onDownloadProgress:c,onUploadProgress:o,responseType:d,headers:g,withCredentials:m="same-origin",fetchOptions:y}=gte(t);d=d?(d+"").toLowerCase():"text";let[x,A]=i||a||l?_Ne([i,a],l):[],M,D;const P=()=>{!M&&setTimeout(()=>{x&&x.unsubscribe()}),M=!0};let O;try{if(o&&bNe&&r!=="get"&&r!=="head"&&(O=await SNe(g,n))!==0){let $=new Request(e,{method:"POST",body:n,duplex:"half"}),X;Wt.isFormData(n)&&(X=$.headers.get("content-type"))&&g.setContentType(X),$.body&&(n=CW($.body,IW,MW(O,vM(o)),null,s3))}Wt.isString(m)||(m=m?"cors":"omit"),D=new Request(e,{...y,signal:x,method:r.toUpperCase(),headers:g.normalize().toJSON(),body:n,duplex:"half",withCredentials:m});let z=await fetch(D);const V=l3&&(d==="stream"||d==="response");if(l3&&(c||V)){const $={};["status","statusText","headers"].forEach(W=>{$[W]=z[W]});const X=Wt.toFiniteNumber(z.headers.get("content-length"));z=new Response(CW(z.body,IW,c&&MW(X,vM(c,!0)),V&&P,s3),$)}d=d||"text";let H=await mM[Wt.findKey(mM,d)||"text"](z,t);return!V&&P(),A&&A(),await new Promise(($,X)=>{dte($,X,{data:H,headers:Cs.from(z.headers),status:z.status,statusText:z.statusText,config:t,request:D})})}catch(z){throw P(),z&&z.name==="TypeError"&&/fetch/i.test(z.message)?Object.assign(new Xn("Network Error",Xn.ERR_NETWORK,t,D),{cause:z.cause||z}):Xn.from(z,z&&z.code,t,D)}}),u3={http:GFe,xhr:mNe,fetch:TNe};Wt.forEach(u3,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const EW=t=>`- ${t}`,ANe=t=>Wt.isFunction(t)||t===null||t===!1,mte={getAdapter:t=>{t=Wt.isArray(t)?t:[t];const{length:e}=t;let r,n;const i={};for(let a=0;a<e;a++){r=t[a];let l;if(n=r,!ANe(r)&&(n=u3[(l=String(r)).toLowerCase()],n===void 0))throw new Xn(`Unknown adapter '${l}'`);if(n)break;i[l||"#"+a]=n}if(!n){const a=Object.entries(i).map(([c,o])=>`adapter ${c} `+(o===!1?"is not supported by the environment":"is not available in the build"));let l=e?a.length>1?`since :
`+a.map(EW).join(`
`):" "+EW(a[0]):"as no adapter specified";throw new Xn("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:u3};function OR(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new xy(null,t)}function DW(t){return OR(t),t.headers=Cs.from(t.headers),t.data=kR.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),mte.getAdapter(t.adapter||jb.adapter)(t).then(function(n){return OR(t),n.data=kR.call(t,t.transformResponse,n),n.headers=Cs.from(n.headers),n},function(n){return fte(n)||(OR(t),n&&n.response&&(n.response.data=kR.call(t,t.transformResponse,n.response),n.response.headers=Cs.from(n.response.headers))),Promise.reject(n)})}const _te="1.7.2",I5={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{I5[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const PW={};I5.transitional=function(e,r,n){function i(a,l){return"[Axios v"+_te+"] Transitional option '"+a+"'"+l+(n?". "+n:"")}return(a,l,c)=>{if(e===!1)throw new Xn(i(l," has been removed"+(r?" in "+r:"")),Xn.ERR_DEPRECATED);return r&&!PW[l]&&(PW[l]=!0,console.warn(i(l," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(a,l,c):!0}};function CNe(t,e,r){if(typeof t!="object")throw new Xn("options must be an object",Xn.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const a=n[i],l=e[a];if(l){const c=t[a],o=c===void 0||l(c,a,t);if(o!==!0)throw new Xn("option "+a+" must be "+o,Xn.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Xn("Unknown option "+a,Xn.ERR_BAD_OPTION)}}const c3={assertOptions:CNe,validators:I5},Pf=c3.validators;class Wg{constructor(e){this.defaults=e,this.interceptors={request:new SW,response:new SW}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=ov(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:a}=r;n!==void 0&&c3.assertOptions(n,{silentJSONParsing:Pf.transitional(Pf.boolean),forcedJSONParsing:Pf.transitional(Pf.boolean),clarifyTimeoutError:Pf.transitional(Pf.boolean)},!1),i!=null&&(Wt.isFunction(i)?r.paramsSerializer={serialize:i}:c3.assertOptions(i,{encode:Pf.function,serialize:Pf.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=a&&Wt.merge(a.common,a[r.method]);a&&Wt.forEach(["delete","get","head","post","put","patch","common"],A=>{delete a[A]}),r.headers=Cs.concat(l,a);const c=[];let o=!0;this.interceptors.request.forEach(function(M){typeof M.runWhen=="function"&&M.runWhen(r)===!1||(o=o&&M.synchronous,c.unshift(M.fulfilled,M.rejected))});const d=[];this.interceptors.response.forEach(function(M){d.push(M.fulfilled,M.rejected)});let g,m=0,y;if(!o){const A=[DW.bind(this),void 0];for(A.unshift.apply(A,c),A.push.apply(A,d),y=A.length,g=Promise.resolve(r);m<y;)g=g.then(A[m++],A[m++]);return g}y=c.length;let x=r;for(m=0;m<y;){const A=c[m++],M=c[m++];try{x=A(x)}catch(D){M.call(this,D);break}}try{g=DW.call(this,x)}catch(A){return Promise.reject(A)}for(m=0,y=d.length;m<y;)g=g.then(d[m++],d[m++]);return g}getUri(e){e=ov(this.defaults,e);const r=pte(e.baseURL,e.url);return ute(r,e.params,e.paramsSerializer)}}Wt.forEach(["delete","get","head","options"],function(e){Wg.prototype[e]=function(r,n){return this.request(ov(n||{},{method:e,url:r,data:(n||{}).data}))}});Wt.forEach(["post","put","patch"],function(e){function r(n){return function(a,l,c){return this.request(ov(c||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Wg.prototype[e]=r(),Wg.prototype[e+"Form"]=r(!0)});class E5{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(i=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](i);n._listeners=null}),this.promise.then=i=>{let a;const l=new Promise(c=>{n.subscribe(c),a=c}).then(i);return l.cancel=function(){n.unsubscribe(a)},l},e(function(a,l,c){n.reason||(n.reason=new xy(a,l,c),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}static source(){let e;return{token:new E5(function(i){e=i}),cancel:e}}}function MNe(t){return function(r){return t.apply(null,r)}}function INe(t){return Wt.isObject(t)&&t.isAxiosError===!0}const h3={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(h3).forEach(([t,e])=>{h3[e]=t});function yte(t){const e=new Wg(t),r=Qee(Wg.prototype.request,e);return Wt.extend(r,Wg.prototype,e,{allOwnKeys:!0}),Wt.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return yte(ov(t,i))},r}const ui=yte(jb);ui.Axios=Wg;ui.CanceledError=xy;ui.CancelToken=E5;ui.isCancel=fte;ui.VERSION=_te;ui.toFormData=VI;ui.AxiosError=Xn;ui.Cancel=ui.CanceledError;ui.all=function(e){return Promise.all(e)};ui.spread=MNe;ui.isAxiosError=INe;ui.mergeConfig=ov;ui.AxiosHeaders=Cs;ui.formToJSON=t=>hte(Wt.isHTMLForm(t)?new FormData(t):t);ui.getAdapter=mte.getAdapter;ui.HttpStatusCode=h3;ui.default=ui;const ENe={__name:"Arsenal",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Arsenal";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},DNe=na(ENe,[["__scopeId","data-v-2e3e5061"]]),PNe={__name:"Astonvilla",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/AstonVilla";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},LNe=na(PNe,[["__scopeId","data-v-5a992705"]]),RNe={__name:"Bournemouth",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Bournemouth";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},kNe=na(RNe,[["__scopeId","data-v-761a71cb"]]),ONe={__name:"Brentford",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Brentford";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},zNe=na(ONe,[["__scopeId","data-v-2e3bbe0e"]]),BNe={__name:"Brighton",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/BrightonandHoveAlbion";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},FNe=na(BNe,[["__scopeId","data-v-e8cf6576"]]),NNe={__name:"Burnley",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Burnley";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},VNe=na(NNe,[["__scopeId","data-v-d4391b58"]]),GNe={__name:"Chelsea",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Chelsea";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},UNe=na(GNe,[["__scopeId","data-v-3354ea9e"]]),$Ne={__name:"Crystal",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/CrystalPalace";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},HNe=na($Ne,[["__scopeId","data-v-59795e22"]]),jNe={__name:"Everton",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Everton";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},WNe=na(jNe,[["__scopeId","data-v-10573ace"]]),ZNe={__name:"Fulham",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Fulham";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},qNe=na(ZNe,[["__scopeId","data-v-309b4116"]]),YNe={__name:"Liverpool",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/Liverpool";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},XNe=na(YNe,[["__scopeId","data-v-54960d8b"]]),QNe={__name:"Luton",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/LutonTown";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},KNe=na(QNe,[["__scopeId","data-v-f2a80680"]]),JNe={__name:"Mancity",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/ManchesterCity";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},e4e=na(JNe,[["__scopeId","data-v-7da35fb9"]]),t4e={__name:"ManUnited",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/ManchesterUnited";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},r4e=na(t4e,[["__scopeId","data-v-1683fd06"]]),n4e={__name:"Newcastle",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/NewcastleUnited";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},i4e=na(n4e,[["__scopeId","data-v-ed45e608"]]),a4e={__name:"Nottingham",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/NottinghamForest";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},o4e=na(a4e,[["__scopeId","data-v-bf818aca"]]),s4e={__name:"Sheffield",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/SheffieldUnited";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},l4e=na(s4e,[["__scopeId","data-v-75cae158"]]),u4e={__name:"Hotspur",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/TottenhamHotspur";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},c4e=na(u4e,[["__scopeId","data-v-140adbe1"]]),h4e={__name:"Westham",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/WestHamUnited";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},f4e=na(h4e,[["__scopeId","data-v-3e9bca08"]]),d4e={__name:"Wolve",setup(t){Ta();const e=at([]);Vn(async()=>{const a="http://localhost:5000/api/matchesdata/WolverhamptonWanderers";try{const l=await ui.get(a);e.value=l.data,console.log("",e.value)}catch(l){console.error(l)}});const n=gt(()=>e.value.map(a=>a.Venue==="Home"?{Date:a.Date,HomeTeam:a.Team,Score:`${a.GF} - ${a.GA}`,AwayTeam:a.Opponent,Result:a.Result}:{Date:a.Date,HomeTeam:a.Opponent,Score:`${a.GA} - ${a.GF}`,AwayTeam:a.Team,Result:a.Result})),i=a=>a==="W"?"danger":a==="L"?"info":"success";return(a,l)=>{const c=Ua,o=Va,d=Ga;return Nt(),kr(d,{data:n.value},{default:pt(()=>[He(c,{prop:"Date",label:""}),He(c,{prop:"HomeTeam",label:""}),He(c,{label:"",width:"180"},{default:pt(({row:g})=>[He(o,{type:i(g.Result),effect:"dark"},{default:pt(()=>[ji(_n(g.Score),1)]),_:2},1032,["type"])]),_:1}),He(c,{prop:"AwayTeam",label:""})]),_:1},8,["data"])}}},p4e=na(d4e,[["__scopeId","data-v-78fb106d"]]),$a=t=>(c7("data-v-458403ff"),t=t(),h7(),t),g4e={key:0},v4e={class:"button-content"},m4e=["src"],_4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),y4e={class:"button-content"},x4e=["src"],b4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),w4e={class:"button-content"},S4e=["src"],T4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),A4e={class:"button-content"},C4e=["src"],M4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),I4e={class:"button-content"},E4e=["src"],D4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),P4e={class:"button-content"},L4e=["src"],R4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),k4e={class:"button-content"},O4e=["src"],z4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),B4e={class:"button-content"},F4e=["src"],N4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),V4e={class:"button-content"},G4e=["src"],U4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),$4e={class:"button-content"},H4e=["src"],j4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),W4e={class:"button-content"},Z4e=["src"],q4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),Y4e={class:"button-content"},X4e=["src"],Q4e=$a(()=>wt("h1",{class:"button-text"},"",-1)),K4e={class:"button-content"},J4e=["src"],eVe=$a(()=>wt("h1",{class:"button-text"},"",-1)),tVe={class:"button-content"},rVe=["src"],nVe=$a(()=>wt("h1",{class:"button-text"},"",-1)),iVe={class:"button-content"},aVe=["src"],oVe=$a(()=>wt("h1",{class:"button-text"},"",-1)),sVe={class:"button-content"},lVe=["src"],uVe=$a(()=>wt("h1",{class:"button-text"},"",-1)),cVe={class:"button-content"},hVe=["src"],fVe=$a(()=>wt("h1",{class:"button-text"},"",-1)),dVe={class:"button-content"},pVe=["src"],gVe=$a(()=>wt("h1",{class:"button-text"},"",-1)),vVe={class:"button-content"},mVe=["src"],_Ve=$a(()=>wt("h1",{class:"button-text"},"",-1)),yVe={class:"button-content"},xVe=["src"],bVe=$a(()=>wt("h1",{class:"button-text"},"",-1)),wVe={style:{"font-size":"30px"}},SVe={style:{"font-size":"30px"}},TVe={style:{"font-size":"30px"}},AVe={style:{"font-size":"30px"}},CVe={style:{"font-size":"30px"}},MVe={style:{"font-size":"30px"}},IVe={style:{"font-size":"30px"}},EVe={style:{"font-size":"30px"}},DVe={style:{"font-size":"30px"}},PVe={style:{"font-size":"30px"}},LVe={style:{"font-size":"30px"}},RVe={style:{"font-size":"30px"}},kVe={style:{"font-size":"30px"}},OVe={style:{"font-size":"30px"}},zVe={style:{"font-size":"30px"}},BVe={style:{"font-size":"30px"}},FVe={style:{"font-size":"30px"}},NVe={style:{"font-size":"30px"}},VVe={style:{"font-size":"30px"}},GVe={style:{"font-size":"30px"}},UVe={__name:"ClubList",setup(t){const e=Ta(),{selectedClub:r}=X7(e),n=gz(),i=(a,l)=>{r.value=a,n.flyToStadium(l)};return(a,l)=>{const c=Jge,o=Gve,d=zve,g=ZM;return Nt(),Gr(ha,null,[Pe(r)===null?(Nt(),Gr("div",g4e,[He(d,{gutter:30},{default:pt(()=>[He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-arsenal",onClick:l[0]||(l[0]=m=>i("Arsenal",[-.108611,51.555]))},{default:pt(()=>[wt("div",v4e,[wt("img",{src:Pe(qq),alt:"Arsenal",class:"button-image"},null,8,m4e),_4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-astonvilla",onClick:l[1]||(l[1]=m=>i("Aston Villa",[-1.884722,52.509167]))},{default:pt(()=>[wt("div",y4e,[wt("img",{src:Pe(Yq),alt:"astonvilla",class:"button-image"},null,8,x4e),b4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-bournemouth",onClick:l[2]||(l[2]=m=>i("Bournemouth",[-1.8386,50.7353]))},{default:pt(()=>[wt("div",w4e,[wt("img",{src:Pe(Xq),alt:"bournemouth",class:"button-image"},null,8,S4e),T4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-brentford",onClick:l[3]||(l[3]=m=>i("Brentford",[-.289048,51.490715]))},{default:pt(()=>[wt("div",A4e,[wt("img",{src:Pe(Qq),alt:"brentford",class:"button-image"},null,8,C4e),M4e])]),_:1})]),_:1})]),_:1}),He(d,{gutter:30},{default:pt(()=>[He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-brighton",onClick:l[4]||(l[4]=m=>i("Brighton & Hove Albion",[-.083278,50.861822]))},{default:pt(()=>[wt("div",I4e,[wt("img",{src:Pe(Kq),alt:"brighton",class:"button-image"},null,8,E4e),D4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-burnley",onClick:l[5]||(l[5]=m=>i("Burnley",[-2.230278,53.789167]))},{default:pt(()=>[wt("div",P4e,[wt("img",{src:Pe(Jq),alt:"burnley",class:"button-image"},null,8,L4e),R4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-chelsea",onClick:l[6]||(l[6]=m=>i("Chelsea",[-.191111,51.481667]))},{default:pt(()=>[wt("div",k4e,[wt("img",{src:Pe(e2),alt:"chelsea",class:"button-image"},null,8,O4e),z4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-crystalpalace",onClick:l[7]||(l[7]=m=>i("Crystal Palace",[-.085556,51.398333]))},{default:pt(()=>[wt("div",B4e,[wt("img",{src:Pe(t2),alt:"crystalpalace",class:"button-image"},null,8,F4e),N4e])]),_:1})]),_:1})]),_:1}),He(d,{gutter:30},{default:pt(()=>[He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-everton",onClick:l[8]||(l[8]=m=>i("Everton",[-2.966389,53.438889]))},{default:pt(()=>[wt("div",V4e,[wt("img",{src:Pe(r2),alt:"everton",class:"button-image"},null,8,G4e),U4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-fulham",onClick:l[9]||(l[9]=m=>i("Fulham",[-.221667,51.475]))},{default:pt(()=>[wt("div",$4e,[wt("img",{src:Pe(n2),alt:"Arsenal",class:"button-image"},null,8,H4e),j4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-liverpool",onClick:l[10]||(l[10]=m=>i("Liverpool",[-2.96,53.430819]))},{default:pt(()=>[wt("div",W4e,[wt("img",{src:Pe(i2),alt:"Arsenal",class:"button-image"},null,8,Z4e),q4e])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-luton",onClick:l[11]||(l[11]=m=>i("Luton Town",[-.430573,51.883479]))},{default:pt(()=>[wt("div",Y4e,[wt("img",{src:Pe(a2),alt:"Arsenal",class:"button-image"},null,8,X4e),Q4e])]),_:1})]),_:1})]),_:1}),He(d,{gutter:30},{default:pt(()=>[He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-mancity",onClick:l[12]||(l[12]=m=>i("Manchester City",[-2.200292,53.482989]))},{default:pt(()=>[wt("div",K4e,[wt("img",{src:Pe(o2),alt:"Arsenal",class:"button-image"},null,8,J4e),eVe])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-manunited",onClick:l[13]||(l[13]=m=>i("Manchester United",[-2.291389,53.463056]))},{default:pt(()=>[wt("div",tVe,[wt("img",{src:Pe(s2),alt:"Arsenal",class:"button-image"},null,8,rVe),nVe])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-newcastle",onClick:l[14]||(l[14]=m=>i("Newcastle United",[-1.621667,54.975]))},{default:pt(()=>[wt("div",iVe,[wt("img",{src:Pe(l2),alt:"Arsenal",class:"button-image"},null,8,aVe),oVe])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-nottingham",onClick:l[15]||(l[15]=m=>i("Nottingham Forest",[-1.132778,52.94]))},{default:pt(()=>[wt("div",sVe,[wt("img",{src:Pe(u2),alt:"Arsenal",class:"button-image"},null,8,lVe),uVe])]),_:1})]),_:1})]),_:1}),He(d,{gutter:30},{default:pt(()=>[He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-sheffield",onClick:l[16]||(l[16]=m=>i("Sheffield United",[-1.469697,53.370348]))},{default:pt(()=>[wt("div",cVe,[wt("img",{src:Pe(c2),alt:"Arsenal",class:"button-image"},null,8,hVe),fVe])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-hotspur",onClick:l[17]||(l[17]=m=>i("Tottenham Hotspur",[-.067007,51.604252]))},{default:pt(()=>[wt("div",dVe,[wt("img",{src:Pe(h2),alt:"Arsenal",class:"button-image"},null,8,pVe),gVe])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-westham",onClick:l[18]||(l[18]=m=>i("West Ham United",[-.017136,51.538811]))},{default:pt(()=>[wt("div",vVe,[wt("img",{src:Pe(f2),alt:"Arsenal",class:"button-image"},null,8,mVe),_Ve])]),_:1})]),_:1}),He(o,{span:6},{default:pt(()=>[He(c,{class:"grid-button button-wolve",onClick:l[19]||(l[19]=m=>i("Wolvehampton Wanderers",[-2.130278,52.590278]))},{default:pt(()=>[wt("div",yVe,[wt("img",{src:Pe(d2),alt:"Arsenal",class:"button-image"},null,8,xVe),bVe])]),_:1})]),_:1})]),_:1})])):In("",!0),Pe(r)==="Arsenal"?(Nt(),kr(g,{key:1,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",wVe,_n(Pe(r)),1),wt("div",null,[He(DNe)])]),_:1})):In("",!0),Pe(r)==="Aston Villa"?(Nt(),kr(g,{key:2,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",SVe,_n(Pe(r)),1),wt("div",null,[He(LNe)])]),_:1})):In("",!0),Pe(r)==="Bournemouth"?(Nt(),kr(g,{key:3,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",TVe,_n(Pe(r)),1),wt("div",null,[He(kNe)])]),_:1})):In("",!0),Pe(r)==="Brentford"?(Nt(),kr(g,{key:4,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",AVe,_n(Pe(r)),1),wt("div",null,[He(zNe)])]),_:1})):In("",!0),Pe(r)==="Brighton & Hove Albion"?(Nt(),kr(g,{key:5,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",CVe,_n(Pe(r)),1),wt("div",null,[He(FNe)])]),_:1})):In("",!0),Pe(r)==="Burnley"?(Nt(),kr(g,{key:6,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",MVe,_n(Pe(r)),1),wt("div",null,[He(VNe)])]),_:1})):In("",!0),Pe(r)==="Chelsea"?(Nt(),kr(g,{key:7,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",IVe,_n(Pe(r)),1),wt("div",null,[He(UNe)])]),_:1})):In("",!0),Pe(r)==="Crystal Palace"?(Nt(),kr(g,{key:8,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",EVe,_n(Pe(r)),1),wt("div",null,[He(HNe)])]),_:1})):In("",!0),Pe(r)==="Everton"?(Nt(),kr(g,{key:9,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",DVe,_n(Pe(r)),1),wt("div",null,[He(WNe)])]),_:1})):In("",!0),Pe(r)==="Fulham"?(Nt(),kr(g,{key:10,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",PVe,_n(Pe(r)),1),wt("div",null,[He(qNe)])]),_:1})):In("",!0),Pe(r)==="Liverpool"?(Nt(),kr(g,{key:11,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",LVe,_n(Pe(r)),1),wt("div",null,[He(XNe)])]),_:1})):In("",!0),Pe(r)==="Luton Town"?(Nt(),kr(g,{key:12,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",RVe,_n(Pe(r)),1),wt("div",null,[He(KNe)])]),_:1})):In("",!0),Pe(r)==="Manchester City"?(Nt(),kr(g,{key:13,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",kVe,_n(Pe(r)),1),wt("div",null,[He(e4e)])]),_:1})):In("",!0),Pe(r)==="Manchester United"?(Nt(),kr(g,{key:14,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",OVe,_n(Pe(r)),1),wt("div",null,[He(r4e)])]),_:1})):In("",!0),Pe(r)==="Newcastle United"?(Nt(),kr(g,{key:15,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",zVe,_n(Pe(r)),1),wt("div",null,[He(i4e)])]),_:1})):In("",!0),Pe(r)==="Nottingham Forest"?(Nt(),kr(g,{key:16,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",BVe,_n(Pe(r)),1),wt("div",null,[He(o4e)])]),_:1})):In("",!0),Pe(r)==="Sheffield United"?(Nt(),kr(g,{key:17,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",FVe,_n(Pe(r)),1),wt("div",null,[He(l4e)])]),_:1})):In("",!0),Pe(r)==="Tottenham Hotspur"?(Nt(),kr(g,{key:18,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",NVe,_n(Pe(r)),1),wt("div",null,[He(c4e)])]),_:1})):In("",!0),Pe(r)==="West Ham United"?(Nt(),kr(g,{key:19,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",VVe,_n(Pe(r)),1),wt("div",null,[He(f4e)])]),_:1})):In("",!0),Pe(r)==="Wolvehampton Wanderers"?(Nt(),kr(g,{key:20,style:{width:"100%",height:"90%"}},{default:pt(()=>[wt("h1",GVe,_n(Pe(r)),1),wt("div",null,[He(p4e)])]),_:1})):In("",!0)],64)}}},$Ve=na(UVe,[["__scopeId","data-v-458403ff"]]),HVe={class:"layout"},jVe={__name:"App",setup(t){return(e,r)=>{const n=ime,i=nme,a=ame,l=rme;return Nt(),Gr("div",HVe,[He(l,null,{default:pt(()=>[He(n,{height:"8vh"},{default:pt(()=>[He(rFe)]),_:1}),He(l,{class:"upper-container"},{default:pt(()=>[He(i,{width:"45vw",class:"map-aside"},{default:pt(()=>[He(jye)]),_:1}),He(a,null,{default:pt(()=>[He($Ve)]),_:1})]),_:1})]),_:1})])}}},WVe=na(jVe,[["__scopeId","data-v-6381fc67"]]),xte=Tse(WVe);xte.use(Ise());xte.mount("#app");
